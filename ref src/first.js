function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core/emoji/auto_complete",["exports","core/emoji/data","core/templates","core/utils","core/localstorage","core/key_codes"],function(a,b,c,d,e,f){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=i(b);e=g(e);f=g(f);function g(a){return a&&a.__esModule?a:{default:a}}function h(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;h=function(){return a};return a}function i(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=h();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function j(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function k(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){j(h,d,e,f,g,"next",a)}function g(a){j(h,d,e,f,g,"throw",a)}f(void 0)})}}function l(a){return p(a)||o(a)||n(a)||m()}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(a,b){if(!a)return;if("string"==typeof a)return q(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return q(a,b)}function o(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function p(a){if(Array.isArray(a))return q(a)}function q(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}var r="moodle-recent-emojis",s={EMOJI_BUTTON:"[data-region=\"emoji-button\"]",ACTIVE_EMOJI_BUTTON:"[data-region=\"emoji-button\"].active"},t=function(){var a=e.default.get(r);return a?JSON.parse(a):[]},u=function(a,b){var c={unified:a,shortnames:[b]},d=t(),f=[c].concat(l(d.filter(function(a){return a.unified!=c.unified})));f=f.slice(0,27);e.default.set(r,JSON.stringify(f))},v=function(a){var c=b.byShortName[a];if(c){var d=c.split("-").map(function(a){return"0x".concat(a)});return String.fromCodePoint.apply(null,d)}else{return null}},w=function(){var a=k(regeneratorRuntime.mark(function a(d,e){var f,g;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:f={emojis:e.map(function(a,c){return{active:0===c,emojitext:v(a),displayshortname:":".concat(a,":"),shortname:a,unified:b.byShortName[a]}})};a.next=3;return(0,c.render)("core/emoji/auto_complete",f);case 3:g=a.sent;d.innerHTML=g;case 5:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),x=function(a,c){if(""===a){return t().map(function(a){return a.shortnames[0]}).slice(0,c)}else{a=a.toLowerCase();return Object.keys(b.byShortName).filter(function(b){return b.includes(a)}).slice(0,c)}},y=function(a,b){var c=a.slice(0,b).match(/(\S*)$/),d=a.slice(b).match(/^(\S*)/),e="",f="";if(c){e=c[c.length-1]}if(d){f=d[d.length-1]}return"".concat(e).concat(f)},z=function(a){return /^:[^:\s]+:$/.test(a)},A=function(a){return /^:[^:\s]*$/.test(a)},B=function(a){return a.replace(/:/g,"")},C=function(a){return a.querySelector(s.ACTIVE_EMOJI_BUTTON)},D=function(a){var b=C(a),c=b.previousElementSibling;if(c){b.classList.remove("active");c.classList.add("active");c.scrollIntoView({behaviour:"smooth",inline:"center"})}},E=function(a){var b=C(a),c=b.nextElementSibling;if(c){b.classList.remove("active");c.classList.add("active");c.scrollIntoView({behaviour:"smooth",inline:"center"})}},F=function(a,b){var c=a.getAttribute("data-short-name"),d=a.getAttribute("data-unified");u(d,c);b(a.innerHTML.trim())};a.default=function(a,c,g,h){var i=!1,j="";c.addEventListener("keyup",(0,d.debounce)(function(){var d=c.value,e=c.selectionStart,f=y(d,e);if(f===j){return}else{j=f}if(z(f)){var k=B(f),l=v(k);i=!1;if(l){u(b.byShortName[k],k);h(l)}}else if(A(f)){var m=x(B(f),50);if(m.length){w(a,m);i=!0}else{i=!1}}else{i=!1}g(i)},200));c.addEventListener("keydown",function(b){if(i){var c=b.shiftKey||b.metaKey||b.altKey||b.ctrlKey;if(!c){switch(b.which){case f.default.escape:i=!1;g(!1);break;case f.default.arrowLeft:D(a);b.preventDefault();break;case f.default.arrowRight:E(a);b.preventDefault();break;case f.default.enter:F(C(a),h);b.preventDefault();b.stopPropagation();break;}}}});a.addEventListener("click",function(a){var b=a.target;if(b.matches(s.EMOJI_BUTTON)){F(b,h)}})};return a.default});
define ("core/emoji/data",["exports"],function(F){"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.byShortName=F.byCategory=void 0;F.byCategory=[{name:"Smileys & People",emojis:[{unified:"1F600",shortnames:["grinning"]},{unified:"1F601",shortnames:["grin"]},{unified:"1F602",shortnames:["joy"]},{unified:"1F923",shortnames:["rolling_on_the_floor_laughing"]},{unified:"1F603",shortnames:["smiley"]},{unified:"1F604",shortnames:["smile"]},{unified:"1F605",shortnames:["sweat_smile"]},{unified:"1F606",shortnames:["laughing"]},{unified:"1F609",shortnames:["wink"]},{unified:"1F60A",shortnames:["blush"]},{unified:"1F60B",shortnames:["yum"]},{unified:"1F60E",shortnames:["sunglasses"]},{unified:"1F60D",shortnames:["heart_eyes"]},{unified:"1F618",shortnames:["kissing_heart"]},{unified:"1F617",shortnames:["kissing"]},{unified:"1F619",shortnames:["kissing_smiling_eyes"]},{unified:"1F61A",shortnames:["kissing_closed_eyes"]},{unified:"263A-FE0F",shortnames:["relaxed"]},{unified:"1F642",shortnames:["slightly_smiling_face"]},{unified:"1F917",shortnames:["hugging_face"]},{unified:"1F929",shortnames:["star-struck"]},{unified:"1F914",shortnames:["thinking_face"]},{unified:"1F928",shortnames:["face_with_raised_eyebrow"]},{unified:"1F610",shortnames:["neutral_face"]},{unified:"1F611",shortnames:["expressionless"]},{unified:"1F636",shortnames:["no_mouth"]},{unified:"1F644",shortnames:["face_with_rolling_eyes"]},{unified:"1F60F",shortnames:["smirk"]},{unified:"1F623",shortnames:["persevere"]},{unified:"1F625",shortnames:["disappointed_relieved"]},{unified:"1F62E",shortnames:["open_mouth"]},{unified:"1F910",shortnames:["zipper_mouth_face"]},{unified:"1F62F",shortnames:["hushed"]},{unified:"1F62A",shortnames:["sleepy"]},{unified:"1F62B",shortnames:["tired_face"]},{unified:"1F634",shortnames:["sleeping"]},{unified:"1F60C",shortnames:["relieved"]},{unified:"1F61B",shortnames:["stuck_out_tongue"]},{unified:"1F61C",shortnames:["stuck_out_tongue_winking_eye"]},{unified:"1F61D",shortnames:["stuck_out_tongue_closed_eyes"]},{unified:"1F924",shortnames:["drooling_face"]},{unified:"1F612",shortnames:["unamused"]},{unified:"1F613",shortnames:["sweat"]},{unified:"1F614",shortnames:["pensive"]},{unified:"1F615",shortnames:["confused"]},{unified:"1F643",shortnames:["upside_down_face"]},{unified:"1F911",shortnames:["money_mouth_face"]},{unified:"1F632",shortnames:["astonished"]},{unified:"2639-FE0F",shortnames:["white_frowning_face"]},{unified:"1F641",shortnames:["slightly_frowning_face"]},{unified:"1F616",shortnames:["confounded"]},{unified:"1F61E",shortnames:["disappointed"]},{unified:"1F61F",shortnames:["worried"]},{unified:"1F624",shortnames:["triumph"]},{unified:"1F622",shortnames:["cry"]},{unified:"1F62D",shortnames:["sob"]},{unified:"1F626",shortnames:["frowning"]},{unified:"1F627",shortnames:["anguished"]},{unified:"1F628",shortnames:["fearful"]},{unified:"1F629",shortnames:["weary"]},{unified:"1F92F",shortnames:["exploding_head"]},{unified:"1F62C",shortnames:["grimacing"]},{unified:"1F630",shortnames:["cold_sweat"]},{unified:"1F631",shortnames:["scream"]},{unified:"1F633",shortnames:["flushed"]},{unified:"1F92A",shortnames:["zany_face"]},{unified:"1F635",shortnames:["dizzy_face"]},{unified:"1F621",shortnames:["rage"]},{unified:"1F620",shortnames:["angry"]},{unified:"1F92C",shortnames:["face_with_symbols_on_mouth"]},{unified:"1F637",shortnames:["mask"]},{unified:"1F912",shortnames:["face_with_thermometer"]},{unified:"1F915",shortnames:["face_with_head_bandage"]},{unified:"1F922",shortnames:["nauseated_face"]},{unified:"1F92E",shortnames:["face_vomiting"]},{unified:"1F927",shortnames:["sneezing_face"]},{unified:"1F607",shortnames:["innocent"]},{unified:"1F920",shortnames:["face_with_cowboy_hat"]},{unified:"1F921",shortnames:["clown_face"]},{unified:"1F925",shortnames:["lying_face"]},{unified:"1F92B",shortnames:["shushing_face"]},{unified:"1F92D",shortnames:["face_with_hand_over_mouth"]},{unified:"1F9D0",shortnames:["face_with_monocle"]},{unified:"1F913",shortnames:["nerd_face"]},{unified:"1F608",shortnames:["smiling_imp"]},{unified:"1F47F",shortnames:["imp"]},{unified:"1F479",shortnames:["japanese_ogre"]},{unified:"1F47A",shortnames:["japanese_goblin"]},{unified:"1F480",shortnames:["skull"]},{unified:"2620-FE0F",shortnames:["skull_and_crossbones"]},{unified:"1F47B",shortnames:["ghost"]},{unified:"1F47D",shortnames:["alien"]},{unified:"1F47E",shortnames:["space_invader"]},{unified:"1F916",shortnames:["robot_face"]},{unified:"1F4A9",shortnames:["hankey"]},{unified:"1F63A",shortnames:["smiley_cat"]},{unified:"1F638",shortnames:["smile_cat"]},{unified:"1F639",shortnames:["joy_cat"]},{unified:"1F63B",shortnames:["heart_eyes_cat"]},{unified:"1F63C",shortnames:["smirk_cat"]},{unified:"1F63D",shortnames:["kissing_cat"]},{unified:"1F640",shortnames:["scream_cat"]},{unified:"1F63F",shortnames:["crying_cat_face"]},{unified:"1F63E",shortnames:["pouting_cat"]},{unified:"1F648",shortnames:["see_no_evil"]},{unified:"1F649",shortnames:["hear_no_evil"]},{unified:"1F64A",shortnames:["speak_no_evil"]},{unified:"1F476",shortnames:["baby"]},{unified:"1F9D2",shortnames:["child"]},{unified:"1F466",shortnames:["boy"]},{unified:"1F467",shortnames:["girl"]},{unified:"1F9D1",shortnames:["adult"]},{unified:"1F468",shortnames:["man"]},{unified:"1F469",shortnames:["woman"]},{unified:"1F9D3",shortnames:["older_adult"]},{unified:"1F474",shortnames:["older_man"]},{unified:"1F475",shortnames:["older_woman"]},{unified:"1F468-200D-2695-FE0F",shortnames:["male-doctor"]},{unified:"1F469-200D-2695-FE0F",shortnames:["female-doctor"]},{unified:"1F468-200D-1F393",shortnames:["male-student"]},{unified:"1F469-200D-1F393",shortnames:["female-student"]},{unified:"1F468-200D-1F3EB",shortnames:["male-teacher"]},{unified:"1F469-200D-1F3EB",shortnames:["female-teacher"]},{unified:"1F468-200D-2696-FE0F",shortnames:["male-judge"]},{unified:"1F469-200D-2696-FE0F",shortnames:["female-judge"]},{unified:"1F468-200D-1F33E",shortnames:["male-farmer"]},{unified:"1F469-200D-1F33E",shortnames:["female-farmer"]},{unified:"1F468-200D-1F373",shortnames:["male-cook"]},{unified:"1F469-200D-1F373",shortnames:["female-cook"]},{unified:"1F468-200D-1F527",shortnames:["male-mechanic"]},{unified:"1F469-200D-1F527",shortnames:["female-mechanic"]},{unified:"1F468-200D-1F3ED",shortnames:["male-factory-worker"]},{unified:"1F469-200D-1F3ED",shortnames:["female-factory-worker"]},{unified:"1F468-200D-1F4BC",shortnames:["male-office-worker"]},{unified:"1F469-200D-1F4BC",shortnames:["female-office-worker"]},{unified:"1F468-200D-1F52C",shortnames:["male-scientist"]},{unified:"1F469-200D-1F52C",shortnames:["female-scientist"]},{unified:"1F468-200D-1F4BB",shortnames:["male-technologist"]},{unified:"1F469-200D-1F4BB",shortnames:["female-technologist"]},{unified:"1F468-200D-1F3A4",shortnames:["male-singer"]},{unified:"1F469-200D-1F3A4",shortnames:["female-singer"]},{unified:"1F468-200D-1F3A8",shortnames:["male-artist"]},{unified:"1F469-200D-1F3A8",shortnames:["female-artist"]},{unified:"1F468-200D-2708-FE0F",shortnames:["male-pilot"]},{unified:"1F469-200D-2708-FE0F",shortnames:["female-pilot"]},{unified:"1F468-200D-1F680",shortnames:["male-astronaut"]},{unified:"1F469-200D-1F680",shortnames:["female-astronaut"]},{unified:"1F468-200D-1F692",shortnames:["male-firefighter"]},{unified:"1F469-200D-1F692",shortnames:["female-firefighter"]},{unified:"1F46E-200D-2642-FE0F",shortnames:["male-police-officer","cop"]},{unified:"1F46E-200D-2640-FE0F",shortnames:["female-police-officer"]},{unified:"1F575-FE0F-200D-2642-FE0F",shortnames:["male-detective","sleuth_or_spy"]},{unified:"1F575-FE0F-200D-2640-FE0F",shortnames:["female-detective"]},{unified:"1F482-200D-2642-FE0F",shortnames:["male-guard","guardsman"]},{unified:"1F482-200D-2640-FE0F",shortnames:["female-guard"]},{unified:"1F477-200D-2642-FE0F",shortnames:["male-construction-worker","construction_worker"]},{unified:"1F477-200D-2640-FE0F",shortnames:["female-construction-worker"]},{unified:"1F934",shortnames:["prince"]},{unified:"1F478",shortnames:["princess"]},{unified:"1F473-200D-2642-FE0F",shortnames:["man-wearing-turban","man_with_turban"]},{unified:"1F473-200D-2640-FE0F",shortnames:["woman-wearing-turban"]},{unified:"1F472",shortnames:["man_with_gua_pi_mao"]},{unified:"1F9D5",shortnames:["person_with_headscarf"]},{unified:"1F9D4",shortnames:["bearded_person"]},{unified:"1F471-200D-2642-FE0F",shortnames:["blond-haired-man","person_with_blond_hair"]},{unified:"1F471-200D-2640-FE0F",shortnames:["blond-haired-woman"]},{unified:"1F935",shortnames:["man_in_tuxedo"]},{unified:"1F470",shortnames:["bride_with_veil"]},{unified:"1F930",shortnames:["pregnant_woman"]},{unified:"1F931",shortnames:["breast-feeding"]},{unified:"1F47C",shortnames:["angel"]},{unified:"1F385",shortnames:["santa"]},{unified:"1F936",shortnames:["mrs_claus"]},{unified:"1F9D9-200D-2640-FE0F",shortnames:["female_mage","mage"]},{unified:"1F9D9-200D-2642-FE0F",shortnames:["male_mage"]},{unified:"1F9DA-200D-2640-FE0F",shortnames:["female_fairy","fairy"]},{unified:"1F9DA-200D-2642-FE0F",shortnames:["male_fairy"]},{unified:"1F9DB-200D-2640-FE0F",shortnames:["female_vampire","vampire"]},{unified:"1F9DB-200D-2642-FE0F",shortnames:["male_vampire"]},{unified:"1F9DC-200D-2640-FE0F",shortnames:["mermaid"]},{unified:"1F9DC-200D-2642-FE0F",shortnames:["merman","merperson"]},{unified:"1F9DD-200D-2640-FE0F",shortnames:["female_elf"]},{unified:"1F9DD-200D-2642-FE0F",shortnames:["male_elf","elf"]},{unified:"1F9DE-200D-2640-FE0F",shortnames:["female_genie"]},{unified:"1F9DE-200D-2642-FE0F",shortnames:["male_genie","genie"]},{unified:"1F9DF-200D-2640-FE0F",shortnames:["female_zombie"]},{unified:"1F9DF-200D-2642-FE0F",shortnames:["male_zombie","zombie"]},{unified:"1F64D-200D-2642-FE0F",shortnames:["man-frowning"]},{unified:"1F64D-200D-2640-FE0F",shortnames:["woman-frowning","person_frowning"]},{unified:"1F64E-200D-2642-FE0F",shortnames:["man-pouting"]},{unified:"1F64E-200D-2640-FE0F",shortnames:["woman-pouting","person_with_pouting_face"]},{unified:"1F645-200D-2642-FE0F",shortnames:["man-gesturing-no"]},{unified:"1F645-200D-2640-FE0F",shortnames:["woman-gesturing-no","no_good"]},{unified:"1F646-200D-2642-FE0F",shortnames:["man-gesturing-ok"]},{unified:"1F646-200D-2640-FE0F",shortnames:["woman-gesturing-ok","ok_woman"]},{unified:"1F481-200D-2642-FE0F",shortnames:["man-tipping-hand"]},{unified:"1F481-200D-2640-FE0F",shortnames:["woman-tipping-hand","information_desk_person"]},{unified:"1F64B-200D-2642-FE0F",shortnames:["man-raising-hand"]},{unified:"1F64B-200D-2640-FE0F",shortnames:["woman-raising-hand","raising_hand"]},{unified:"1F647-200D-2642-FE0F",shortnames:["man-bowing","bow"]},{unified:"1F647-200D-2640-FE0F",shortnames:["woman-bowing"]},{unified:"1F926",shortnames:["face_palm"]},{unified:"1F926-200D-2642-FE0F",shortnames:["man-facepalming"]},{unified:"1F926-200D-2640-FE0F",shortnames:["woman-facepalming"]},{unified:"1F937",shortnames:["shrug"]},{unified:"1F937-200D-2642-FE0F",shortnames:["man-shrugging"]},{unified:"1F937-200D-2640-FE0F",shortnames:["woman-shrugging"]},{unified:"1F486-200D-2642-FE0F",shortnames:["man-getting-massage"]},{unified:"1F486-200D-2640-FE0F",shortnames:["woman-getting-massage","massage"]},{unified:"1F487-200D-2642-FE0F",shortnames:["man-getting-haircut"]},{unified:"1F487-200D-2640-FE0F",shortnames:["woman-getting-haircut","haircut"]},{unified:"1F6B6-200D-2642-FE0F",shortnames:["man-walking","walking"]},{unified:"1F6B6-200D-2640-FE0F",shortnames:["woman-walking"]},{unified:"1F3C3-200D-2642-FE0F",shortnames:["man-running","runner"]},{unified:"1F3C3-200D-2640-FE0F",shortnames:["woman-running"]},{unified:"1F483",shortnames:["dancer"]},{unified:"1F57A",shortnames:["man_dancing"]},{unified:"1F46F-200D-2642-FE0F",shortnames:["man-with-bunny-ears-partying"]},{unified:"1F46F-200D-2640-FE0F",shortnames:["woman-with-bunny-ears-partying","dancers"]},{unified:"1F9D6-200D-2640-FE0F",shortnames:["woman_in_steamy_room"]},{unified:"1F9D6-200D-2642-FE0F",shortnames:["man_in_steamy_room","person_in_steamy_room"]},{unified:"1F9D7-200D-2640-FE0F",shortnames:["woman_climbing","person_climbing"]},{unified:"1F9D7-200D-2642-FE0F",shortnames:["man_climbing"]},{unified:"1F9D8-200D-2640-FE0F",shortnames:["woman_in_lotus_position","person_in_lotus_position"]},{unified:"1F9D8-200D-2642-FE0F",shortnames:["man_in_lotus_position"]},{unified:"1F6C0",shortnames:["bath"]},{unified:"1F6CC",shortnames:["sleeping_accommodation"]},{unified:"1F574-FE0F",shortnames:["man_in_business_suit_levitating"]},{unified:"1F5E3-FE0F",shortnames:["speaking_head_in_silhouette"]},{unified:"1F464",shortnames:["bust_in_silhouette"]},{unified:"1F465",shortnames:["busts_in_silhouette"]},{unified:"1F93A",shortnames:["fencer"]},{unified:"1F3C7",shortnames:["horse_racing"]},{unified:"26F7-FE0F",shortnames:["skier"]},{unified:"1F3C2",shortnames:["snowboarder"]},{unified:"1F3CC-FE0F-200D-2642-FE0F",shortnames:["man-golfing","golfer"]},{unified:"1F3CC-FE0F-200D-2640-FE0F",shortnames:["woman-golfing"]},{unified:"1F3C4-200D-2642-FE0F",shortnames:["man-surfing","surfer"]},{unified:"1F3C4-200D-2640-FE0F",shortnames:["woman-surfing"]},{unified:"1F6A3-200D-2642-FE0F",shortnames:["man-rowing-boat","rowboat"]},{unified:"1F6A3-200D-2640-FE0F",shortnames:["woman-rowing-boat"]},{unified:"1F3CA-200D-2642-FE0F",shortnames:["man-swimming","swimmer"]},{unified:"1F3CA-200D-2640-FE0F",shortnames:["woman-swimming"]},{unified:"26F9-FE0F-200D-2642-FE0F",shortnames:["man-bouncing-ball","person_with_ball"]},{unified:"26F9-FE0F-200D-2640-FE0F",shortnames:["woman-bouncing-ball"]},{unified:"1F3CB-FE0F-200D-2642-FE0F",shortnames:["man-lifting-weights","weight_lifter"]},{unified:"1F3CB-FE0F-200D-2640-FE0F",shortnames:["woman-lifting-weights"]},{unified:"1F6B4-200D-2642-FE0F",shortnames:["man-biking","bicyclist"]},{unified:"1F6B4-200D-2640-FE0F",shortnames:["woman-biking"]},{unified:"1F6B5-200D-2642-FE0F",shortnames:["man-mountain-biking","mountain_bicyclist"]},{unified:"1F6B5-200D-2640-FE0F",shortnames:["woman-mountain-biking"]},{unified:"1F3CE-FE0F",shortnames:["racing_car"]},{unified:"1F3CD-FE0F",shortnames:["racing_motorcycle"]},{unified:"1F938",shortnames:["person_doing_cartwheel"]},{unified:"1F938-200D-2642-FE0F",shortnames:["man-cartwheeling"]},{unified:"1F938-200D-2640-FE0F",shortnames:["woman-cartwheeling"]},{unified:"1F93C",shortnames:["wrestlers"]},{unified:"1F93C-200D-2642-FE0F",shortnames:["man-wrestling"]},{unified:"1F93C-200D-2640-FE0F",shortnames:["woman-wrestling"]},{unified:"1F93D",shortnames:["water_polo"]},{unified:"1F93D-200D-2642-FE0F",shortnames:["man-playing-water-polo"]},{unified:"1F93D-200D-2640-FE0F",shortnames:["woman-playing-water-polo"]},{unified:"1F93E",shortnames:["handball"]},{unified:"1F93E-200D-2642-FE0F",shortnames:["man-playing-handball"]},{unified:"1F93E-200D-2640-FE0F",shortnames:["woman-playing-handball"]},{unified:"1F939",shortnames:["juggling"]},{unified:"1F939-200D-2642-FE0F",shortnames:["man-juggling"]},{unified:"1F939-200D-2640-FE0F",shortnames:["woman-juggling"]},{unified:"1F46B",shortnames:["couple"]},{unified:"1F46C",shortnames:["two_men_holding_hands"]},{unified:"1F46D",shortnames:["two_women_holding_hands"]},{unified:"1F469-200D-2764-FE0F-200D-1F48B-200D-1F468",shortnames:["woman-kiss-man","couplekiss"]},{unified:"1F468-200D-2764-FE0F-200D-1F48B-200D-1F468",shortnames:["man-kiss-man"]},{unified:"1F469-200D-2764-FE0F-200D-1F48B-200D-1F469",shortnames:["woman-kiss-woman"]},{unified:"1F469-200D-2764-FE0F-200D-1F468",shortnames:["woman-heart-man","couple_with_heart"]},{unified:"1F468-200D-2764-FE0F-200D-1F468",shortnames:["man-heart-man"]},{unified:"1F469-200D-2764-FE0F-200D-1F469",shortnames:["woman-heart-woman"]},{unified:"1F468-200D-1F469-200D-1F466",shortnames:["man-woman-boy","family"]},{unified:"1F468-200D-1F469-200D-1F467",shortnames:["man-woman-girl"]},{unified:"1F468-200D-1F469-200D-1F467-200D-1F466",shortnames:["man-woman-girl-boy"]},{unified:"1F468-200D-1F469-200D-1F466-200D-1F466",shortnames:["man-woman-boy-boy"]},{unified:"1F468-200D-1F469-200D-1F467-200D-1F467",shortnames:["man-woman-girl-girl"]},{unified:"1F468-200D-1F468-200D-1F466",shortnames:["man-man-boy"]},{unified:"1F468-200D-1F468-200D-1F467",shortnames:["man-man-girl"]},{unified:"1F468-200D-1F468-200D-1F467-200D-1F466",shortnames:["man-man-girl-boy"]},{unified:"1F468-200D-1F468-200D-1F466-200D-1F466",shortnames:["man-man-boy-boy"]},{unified:"1F468-200D-1F468-200D-1F467-200D-1F467",shortnames:["man-man-girl-girl"]},{unified:"1F469-200D-1F469-200D-1F466",shortnames:["woman-woman-boy"]},{unified:"1F469-200D-1F469-200D-1F467",shortnames:["woman-woman-girl"]},{unified:"1F469-200D-1F469-200D-1F467-200D-1F466",shortnames:["woman-woman-girl-boy"]},{unified:"1F469-200D-1F469-200D-1F466-200D-1F466",shortnames:["woman-woman-boy-boy"]},{unified:"1F469-200D-1F469-200D-1F467-200D-1F467",shortnames:["woman-woman-girl-girl"]},{unified:"1F468-200D-1F466",shortnames:["man-boy"]},{unified:"1F468-200D-1F466-200D-1F466",shortnames:["man-boy-boy"]},{unified:"1F468-200D-1F467",shortnames:["man-girl"]},{unified:"1F468-200D-1F467-200D-1F466",shortnames:["man-girl-boy"]},{unified:"1F468-200D-1F467-200D-1F467",shortnames:["man-girl-girl"]},{unified:"1F469-200D-1F466",shortnames:["woman-boy"]},{unified:"1F469-200D-1F466-200D-1F466",shortnames:["woman-boy-boy"]},{unified:"1F469-200D-1F467",shortnames:["woman-girl"]},{unified:"1F469-200D-1F467-200D-1F466",shortnames:["woman-girl-boy"]},{unified:"1F469-200D-1F467-200D-1F467",shortnames:["woman-girl-girl"]},{unified:"1F933",shortnames:["selfie"]},{unified:"1F4AA",shortnames:["muscle"]},{unified:"1F448",shortnames:["point_left"]},{unified:"1F449",shortnames:["point_right"]},{unified:"261D-FE0F",shortnames:["point_up"]},{unified:"1F446",shortnames:["point_up_2"]},{unified:"1F595",shortnames:["middle_finger"]},{unified:"1F447",shortnames:["point_down"]},{unified:"270C-FE0F",shortnames:["v"]},{unified:"1F91E",shortnames:["crossed_fingers"]},{unified:"1F596",shortnames:["spock-hand"]},{unified:"1F918",shortnames:["the_horns"]},{unified:"1F919",shortnames:["call_me_hand"]},{unified:"1F590-FE0F",shortnames:["raised_hand_with_fingers_splayed"]},{unified:"270B",shortnames:["hand"]},{unified:"1F44C",shortnames:["ok_hand"]},{unified:"1F44D",shortnames:["+1"]},{unified:"1F44E",shortnames:["-1"]},{unified:"270A",shortnames:["fist"]},{unified:"1F44A",shortnames:["facepunch"]},{unified:"1F91B",shortnames:["left-facing_fist"]},{unified:"1F91C",shortnames:["right-facing_fist"]},{unified:"1F91A",shortnames:["raised_back_of_hand"]},{unified:"1F44B",shortnames:["wave"]},{unified:"1F91F",shortnames:["i_love_you_hand_sign"]},{unified:"270D-FE0F",shortnames:["writing_hand"]},{unified:"1F44F",shortnames:["clap"]},{unified:"1F450",shortnames:["open_hands"]},{unified:"1F64C",shortnames:["raised_hands"]},{unified:"1F932",shortnames:["palms_up_together"]},{unified:"1F64F",shortnames:["pray"]},{unified:"1F91D",shortnames:["handshake"]},{unified:"1F485",shortnames:["nail_care"]},{unified:"1F442",shortnames:["ear"]},{unified:"1F443",shortnames:["nose"]},{unified:"1F463",shortnames:["footprints"]},{unified:"1F440",shortnames:["eyes"]},{unified:"1F441-FE0F",shortnames:["eye"]},{unified:"1F441-FE0F-200D-1F5E8-FE0F",shortnames:["eye-in-speech-bubble"]},{unified:"1F9E0",shortnames:["brain"]},{unified:"1F445",shortnames:["tongue"]},{unified:"1F444",shortnames:["lips"]},{unified:"1F48B",shortnames:["kiss"]},{unified:"1F498",shortnames:["cupid"]},{unified:"2764-FE0F",shortnames:["heart"]},{unified:"1F493",shortnames:["heartbeat"]},{unified:"1F494",shortnames:["broken_heart"]},{unified:"1F495",shortnames:["two_hearts"]},{unified:"1F496",shortnames:["sparkling_heart"]},{unified:"1F497",shortnames:["heartpulse"]},{unified:"1F499",shortnames:["blue_heart"]},{unified:"1F49A",shortnames:["green_heart"]},{unified:"1F49B",shortnames:["yellow_heart"]},{unified:"1F9E1",shortnames:["orange_heart"]},{unified:"1F49C",shortnames:["purple_heart"]},{unified:"1F5A4",shortnames:["black_heart"]},{unified:"1F49D",shortnames:["gift_heart"]},{unified:"1F49E",shortnames:["revolving_hearts"]},{unified:"1F49F",shortnames:["heart_decoration"]},{unified:"2763-FE0F",shortnames:["heavy_heart_exclamation_mark_ornament"]},{unified:"1F48C",shortnames:["love_letter"]},{unified:"1F4A4",shortnames:["zzz"]},{unified:"1F4A2",shortnames:["anger"]},{unified:"1F4A3",shortnames:["bomb"]},{unified:"1F4A5",shortnames:["boom"]},{unified:"1F4A6",shortnames:["sweat_drops"]},{unified:"1F4A8",shortnames:["dash"]},{unified:"1F4AB",shortnames:["dizzy"]},{unified:"1F4AC",shortnames:["speech_balloon"]},{unified:"1F5E8-FE0F",shortnames:["left_speech_bubble"]},{unified:"1F5EF-FE0F",shortnames:["right_anger_bubble"]},{unified:"1F4AD",shortnames:["thought_balloon"]},{unified:"1F573-FE0F",shortnames:["hole"]},{unified:"1F453",shortnames:["eyeglasses"]},{unified:"1F576-FE0F",shortnames:["dark_sunglasses"]},{unified:"1F454",shortnames:["necktie"]},{unified:"1F455",shortnames:["shirt"]},{unified:"1F456",shortnames:["jeans"]},{unified:"1F9E3",shortnames:["scarf"]},{unified:"1F9E4",shortnames:["gloves"]},{unified:"1F9E5",shortnames:["coat"]},{unified:"1F9E6",shortnames:["socks"]},{unified:"1F457",shortnames:["dress"]},{unified:"1F458",shortnames:["kimono"]},{unified:"1F459",shortnames:["bikini"]},{unified:"1F45A",shortnames:["womans_clothes"]},{unified:"1F45B",shortnames:["purse"]},{unified:"1F45C",shortnames:["handbag"]},{unified:"1F45D",shortnames:["pouch"]},{unified:"1F6CD-FE0F",shortnames:["shopping_bags"]},{unified:"1F392",shortnames:["school_satchel"]},{unified:"1F45E",shortnames:["mans_shoe"]},{unified:"1F45F",shortnames:["athletic_shoe"]},{unified:"1F460",shortnames:["high_heel"]},{unified:"1F461",shortnames:["sandal"]},{unified:"1F462",shortnames:["boot"]},{unified:"1F451",shortnames:["crown"]},{unified:"1F452",shortnames:["womans_hat"]},{unified:"1F3A9",shortnames:["tophat"]},{unified:"1F393",shortnames:["mortar_board"]},{unified:"1F9E2",shortnames:["billed_cap"]},{unified:"26D1-FE0F",shortnames:["helmet_with_white_cross"]},{unified:"1F4FF",shortnames:["prayer_beads"]},{unified:"1F484",shortnames:["lipstick"]},{unified:"1F48D",shortnames:["ring"]},{unified:"1F48E",shortnames:["gem"]}]},{name:"Animals & Nature",emojis:[{unified:"1F435",shortnames:["monkey_face"]},{unified:"1F412",shortnames:["monkey"]},{unified:"1F98D",shortnames:["gorilla"]},{unified:"1F436",shortnames:["dog"]},{unified:"1F415",shortnames:["dog2"]},{unified:"1F429",shortnames:["poodle"]},{unified:"1F43A",shortnames:["wolf"]},{unified:"1F98A",shortnames:["fox_face"]},{unified:"1F431",shortnames:["cat"]},{unified:"1F408",shortnames:["cat2"]},{unified:"1F981",shortnames:["lion_face"]},{unified:"1F42F",shortnames:["tiger"]},{unified:"1F405",shortnames:["tiger2"]},{unified:"1F406",shortnames:["leopard"]},{unified:"1F434",shortnames:["horse"]},{unified:"1F40E",shortnames:["racehorse"]},{unified:"1F984",shortnames:["unicorn_face"]},{unified:"1F993",shortnames:["zebra_face"]},{unified:"1F98C",shortnames:["deer"]},{unified:"1F42E",shortnames:["cow"]},{unified:"1F402",shortnames:["ox"]},{unified:"1F403",shortnames:["water_buffalo"]},{unified:"1F404",shortnames:["cow2"]},{unified:"1F437",shortnames:["pig"]},{unified:"1F416",shortnames:["pig2"]},{unified:"1F417",shortnames:["boar"]},{unified:"1F43D",shortnames:["pig_nose"]},{unified:"1F40F",shortnames:["ram"]},{unified:"1F411",shortnames:["sheep"]},{unified:"1F410",shortnames:["goat"]},{unified:"1F42A",shortnames:["dromedary_camel"]},{unified:"1F42B",shortnames:["camel"]},{unified:"1F992",shortnames:["giraffe_face"]},{unified:"1F418",shortnames:["elephant"]},{unified:"1F98F",shortnames:["rhinoceros"]},{unified:"1F42D",shortnames:["mouse"]},{unified:"1F401",shortnames:["mouse2"]},{unified:"1F400",shortnames:["rat"]},{unified:"1F439",shortnames:["hamster"]},{unified:"1F430",shortnames:["rabbit"]},{unified:"1F407",shortnames:["rabbit2"]},{unified:"1F43F-FE0F",shortnames:["chipmunk"]},{unified:"1F994",shortnames:["hedgehog"]},{unified:"1F987",shortnames:["bat"]},{unified:"1F43B",shortnames:["bear"]},{unified:"1F428",shortnames:["koala"]},{unified:"1F43C",shortnames:["panda_face"]},{unified:"1F43E",shortnames:["feet"]},{unified:"1F983",shortnames:["turkey"]},{unified:"1F414",shortnames:["chicken"]},{unified:"1F413",shortnames:["rooster"]},{unified:"1F423",shortnames:["hatching_chick"]},{unified:"1F424",shortnames:["baby_chick"]},{unified:"1F425",shortnames:["hatched_chick"]},{unified:"1F426",shortnames:["bird"]},{unified:"1F427",shortnames:["penguin"]},{unified:"1F54A-FE0F",shortnames:["dove_of_peace"]},{unified:"1F985",shortnames:["eagle"]},{unified:"1F986",shortnames:["duck"]},{unified:"1F989",shortnames:["owl"]},{unified:"1F438",shortnames:["frog"]},{unified:"1F40A",shortnames:["crocodile"]},{unified:"1F422",shortnames:["turtle"]},{unified:"1F98E",shortnames:["lizard"]},{unified:"1F40D",shortnames:["snake"]},{unified:"1F432",shortnames:["dragon_face"]},{unified:"1F409",shortnames:["dragon"]},{unified:"1F995",shortnames:["sauropod"]},{unified:"1F996",shortnames:["t-rex"]},{unified:"1F433",shortnames:["whale"]},{unified:"1F40B",shortnames:["whale2"]},{unified:"1F42C",shortnames:["dolphin"]},{unified:"1F41F",shortnames:["fish"]},{unified:"1F420",shortnames:["tropical_fish"]},{unified:"1F421",shortnames:["blowfish"]},{unified:"1F988",shortnames:["shark"]},{unified:"1F419",shortnames:["octopus"]},{unified:"1F41A",shortnames:["shell"]},{unified:"1F980",shortnames:["crab"]},{unified:"1F990",shortnames:["shrimp"]},{unified:"1F991",shortnames:["squid"]},{unified:"1F40C",shortnames:["snail"]},{unified:"1F98B",shortnames:["butterfly"]},{unified:"1F41B",shortnames:["bug"]},{unified:"1F41C",shortnames:["ant"]},{unified:"1F41D",shortnames:["bee"]},{unified:"1F41E",shortnames:["beetle"]},{unified:"1F997",shortnames:["cricket"]},{unified:"1F577-FE0F",shortnames:["spider"]},{unified:"1F578-FE0F",shortnames:["spider_web"]},{unified:"1F982",shortnames:["scorpion"]},{unified:"1F490",shortnames:["bouquet"]},{unified:"1F338",shortnames:["cherry_blossom"]},{unified:"1F4AE",shortnames:["white_flower"]},{unified:"1F3F5-FE0F",shortnames:["rosette"]},{unified:"1F339",shortnames:["rose"]},{unified:"1F940",shortnames:["wilted_flower"]},{unified:"1F33A",shortnames:["hibiscus"]},{unified:"1F33B",shortnames:["sunflower"]},{unified:"1F33C",shortnames:["blossom"]},{unified:"1F337",shortnames:["tulip"]},{unified:"1F331",shortnames:["seedling"]},{unified:"1F332",shortnames:["evergreen_tree"]},{unified:"1F333",shortnames:["deciduous_tree"]},{unified:"1F334",shortnames:["palm_tree"]},{unified:"1F335",shortnames:["cactus"]},{unified:"1F33E",shortnames:["ear_of_rice"]},{unified:"1F33F",shortnames:["herb"]},{unified:"2618-FE0F",shortnames:["shamrock"]},{unified:"1F340",shortnames:["four_leaf_clover"]},{unified:"1F341",shortnames:["maple_leaf"]},{unified:"1F342",shortnames:["fallen_leaf"]},{unified:"1F343",shortnames:["leaves"]}]},{name:"Food & Drink",emojis:[{unified:"1F347",shortnames:["grapes"]},{unified:"1F348",shortnames:["melon"]},{unified:"1F349",shortnames:["watermelon"]},{unified:"1F34A",shortnames:["tangerine"]},{unified:"1F34B",shortnames:["lemon"]},{unified:"1F34C",shortnames:["banana"]},{unified:"1F34D",shortnames:["pineapple"]},{unified:"1F34E",shortnames:["apple"]},{unified:"1F34F",shortnames:["green_apple"]},{unified:"1F350",shortnames:["pear"]},{unified:"1F351",shortnames:["peach"]},{unified:"1F352",shortnames:["cherries"]},{unified:"1F353",shortnames:["strawberry"]},{unified:"1F95D",shortnames:["kiwifruit"]},{unified:"1F345",shortnames:["tomato"]},{unified:"1F965",shortnames:["coconut"]},{unified:"1F951",shortnames:["avocado"]},{unified:"1F346",shortnames:["eggplant"]},{unified:"1F954",shortnames:["potato"]},{unified:"1F955",shortnames:["carrot"]},{unified:"1F33D",shortnames:["corn"]},{unified:"1F336-FE0F",shortnames:["hot_pepper"]},{unified:"1F952",shortnames:["cucumber"]},{unified:"1F966",shortnames:["broccoli"]},{unified:"1F344",shortnames:["mushroom"]},{unified:"1F95C",shortnames:["peanuts"]},{unified:"1F330",shortnames:["chestnut"]},{unified:"1F35E",shortnames:["bread"]},{unified:"1F950",shortnames:["croissant"]},{unified:"1F956",shortnames:["baguette_bread"]},{unified:"1F968",shortnames:["pretzel"]},{unified:"1F95E",shortnames:["pancakes"]},{unified:"1F9C0",shortnames:["cheese_wedge"]},{unified:"1F356",shortnames:["meat_on_bone"]},{unified:"1F357",shortnames:["poultry_leg"]},{unified:"1F969",shortnames:["cut_of_meat"]},{unified:"1F953",shortnames:["bacon"]},{unified:"1F354",shortnames:["hamburger"]},{unified:"1F35F",shortnames:["fries"]},{unified:"1F355",shortnames:["pizza"]},{unified:"1F32D",shortnames:["hotdog"]},{unified:"1F96A",shortnames:["sandwich"]},{unified:"1F32E",shortnames:["taco"]},{unified:"1F32F",shortnames:["burrito"]},{unified:"1F959",shortnames:["stuffed_flatbread"]},{unified:"1F95A",shortnames:["egg"]},{unified:"1F373",shortnames:["fried_egg"]},{unified:"1F958",shortnames:["shallow_pan_of_food"]},{unified:"1F372",shortnames:["stew"]},{unified:"1F963",shortnames:["bowl_with_spoon"]},{unified:"1F957",shortnames:["green_salad"]},{unified:"1F37F",shortnames:["popcorn"]},{unified:"1F96B",shortnames:["canned_food"]},{unified:"1F371",shortnames:["bento"]},{unified:"1F358",shortnames:["rice_cracker"]},{unified:"1F359",shortnames:["rice_ball"]},{unified:"1F35A",shortnames:["rice"]},{unified:"1F35B",shortnames:["curry"]},{unified:"1F35C",shortnames:["ramen"]},{unified:"1F35D",shortnames:["spaghetti"]},{unified:"1F360",shortnames:["sweet_potato"]},{unified:"1F362",shortnames:["oden"]},{unified:"1F363",shortnames:["sushi"]},{unified:"1F364",shortnames:["fried_shrimp"]},{unified:"1F365",shortnames:["fish_cake"]},{unified:"1F361",shortnames:["dango"]},{unified:"1F95F",shortnames:["dumpling"]},{unified:"1F960",shortnames:["fortune_cookie"]},{unified:"1F961",shortnames:["takeout_box"]},{unified:"1F366",shortnames:["icecream"]},{unified:"1F367",shortnames:["shaved_ice"]},{unified:"1F368",shortnames:["ice_cream"]},{unified:"1F369",shortnames:["doughnut"]},{unified:"1F36A",shortnames:["cookie"]},{unified:"1F382",shortnames:["birthday"]},{unified:"1F370",shortnames:["cake"]},{unified:"1F967",shortnames:["pie"]},{unified:"1F36B",shortnames:["chocolate_bar"]},{unified:"1F36C",shortnames:["candy"]},{unified:"1F36D",shortnames:["lollipop"]},{unified:"1F36E",shortnames:["custard"]},{unified:"1F36F",shortnames:["honey_pot"]},{unified:"1F37C",shortnames:["baby_bottle"]},{unified:"1F95B",shortnames:["glass_of_milk"]},{unified:"2615",shortnames:["coffee"]},{unified:"1F375",shortnames:["tea"]},{unified:"1F376",shortnames:["sake"]},{unified:"1F37E",shortnames:["champagne"]},{unified:"1F377",shortnames:["wine_glass"]},{unified:"1F378",shortnames:["cocktail"]},{unified:"1F379",shortnames:["tropical_drink"]},{unified:"1F37A",shortnames:["beer"]},{unified:"1F37B",shortnames:["beers"]},{unified:"1F942",shortnames:["clinking_glasses"]},{unified:"1F943",shortnames:["tumbler_glass"]},{unified:"1F964",shortnames:["cup_with_straw"]},{unified:"1F962",shortnames:["chopsticks"]},{unified:"1F37D-FE0F",shortnames:["knife_fork_plate"]},{unified:"1F374",shortnames:["fork_and_knife"]},{unified:"1F944",shortnames:["spoon"]},{unified:"1F52A",shortnames:["hocho"]},{unified:"1F3FA",shortnames:["amphora"]}]},{name:"Travel & Places",emojis:[{unified:"1F30D",shortnames:["earth_africa"]},{unified:"1F30E",shortnames:["earth_americas"]},{unified:"1F30F",shortnames:["earth_asia"]},{unified:"1F310",shortnames:["globe_with_meridians"]},{unified:"1F5FA-FE0F",shortnames:["world_map"]},{unified:"1F5FE",shortnames:["japan"]},{unified:"1F3D4-FE0F",shortnames:["snow_capped_mountain"]},{unified:"26F0-FE0F",shortnames:["mountain"]},{unified:"1F30B",shortnames:["volcano"]},{unified:"1F5FB",shortnames:["mount_fuji"]},{unified:"1F3D5-FE0F",shortnames:["camping"]},{unified:"1F3D6-FE0F",shortnames:["beach_with_umbrella"]},{unified:"1F3DC-FE0F",shortnames:["desert"]},{unified:"1F3DD-FE0F",shortnames:["desert_island"]},{unified:"1F3DE-FE0F",shortnames:["national_park"]},{unified:"1F3DF-FE0F",shortnames:["stadium"]},{unified:"1F3DB-FE0F",shortnames:["classical_building"]},{unified:"1F3D7-FE0F",shortnames:["building_construction"]},{unified:"1F3D8-FE0F",shortnames:["house_buildings"]},{unified:"1F3D9-FE0F",shortnames:["cityscape"]},{unified:"1F3DA-FE0F",shortnames:["derelict_house_building"]},{unified:"1F3E0",shortnames:["house"]},{unified:"1F3E1",shortnames:["house_with_garden"]},{unified:"1F3E2",shortnames:["office"]},{unified:"1F3E3",shortnames:["post_office"]},{unified:"1F3E4",shortnames:["european_post_office"]},{unified:"1F3E5",shortnames:["hospital"]},{unified:"1F3E6",shortnames:["bank"]},{unified:"1F3E8",shortnames:["hotel"]},{unified:"1F3E9",shortnames:["love_hotel"]},{unified:"1F3EA",shortnames:["convenience_store"]},{unified:"1F3EB",shortnames:["school"]},{unified:"1F3EC",shortnames:["department_store"]},{unified:"1F3ED",shortnames:["factory"]},{unified:"1F3EF",shortnames:["japanese_castle"]},{unified:"1F3F0",shortnames:["european_castle"]},{unified:"1F492",shortnames:["wedding"]},{unified:"1F5FC",shortnames:["tokyo_tower"]},{unified:"1F5FD",shortnames:["statue_of_liberty"]},{unified:"26EA",shortnames:["church"]},{unified:"1F54C",shortnames:["mosque"]},{unified:"1F54D",shortnames:["synagogue"]},{unified:"26E9-FE0F",shortnames:["shinto_shrine"]},{unified:"1F54B",shortnames:["kaaba"]},{unified:"26F2",shortnames:["fountain"]},{unified:"26FA",shortnames:["tent"]},{unified:"1F301",shortnames:["foggy"]},{unified:"1F303",shortnames:["night_with_stars"]},{unified:"1F304",shortnames:["sunrise_over_mountains"]},{unified:"1F305",shortnames:["sunrise"]},{unified:"1F306",shortnames:["city_sunset"]},{unified:"1F307",shortnames:["city_sunrise"]},{unified:"1F309",shortnames:["bridge_at_night"]},{unified:"2668-FE0F",shortnames:["hotsprings"]},{unified:"1F30C",shortnames:["milky_way"]},{unified:"1F3A0",shortnames:["carousel_horse"]},{unified:"1F3A1",shortnames:["ferris_wheel"]},{unified:"1F3A2",shortnames:["roller_coaster"]},{unified:"1F488",shortnames:["barber"]},{unified:"1F3AA",shortnames:["circus_tent"]},{unified:"1F3AD",shortnames:["performing_arts"]},{unified:"1F5BC-FE0F",shortnames:["frame_with_picture"]},{unified:"1F3A8",shortnames:["art"]},{unified:"1F3B0",shortnames:["slot_machine"]},{unified:"1F682",shortnames:["steam_locomotive"]},{unified:"1F683",shortnames:["railway_car"]},{unified:"1F684",shortnames:["bullettrain_side"]},{unified:"1F685",shortnames:["bullettrain_front"]},{unified:"1F686",shortnames:["train2"]},{unified:"1F687",shortnames:["metro"]},{unified:"1F688",shortnames:["light_rail"]},{unified:"1F689",shortnames:["station"]},{unified:"1F68A",shortnames:["tram"]},{unified:"1F69D",shortnames:["monorail"]},{unified:"1F69E",shortnames:["mountain_railway"]},{unified:"1F68B",shortnames:["train"]},{unified:"1F68C",shortnames:["bus"]},{unified:"1F68D",shortnames:["oncoming_bus"]},{unified:"1F68E",shortnames:["trolleybus"]},{unified:"1F690",shortnames:["minibus"]},{unified:"1F691",shortnames:["ambulance"]},{unified:"1F692",shortnames:["fire_engine"]},{unified:"1F693",shortnames:["police_car"]},{unified:"1F694",shortnames:["oncoming_police_car"]},{unified:"1F695",shortnames:["taxi"]},{unified:"1F696",shortnames:["oncoming_taxi"]},{unified:"1F697",shortnames:["car"]},{unified:"1F698",shortnames:["oncoming_automobile"]},{unified:"1F699",shortnames:["blue_car"]},{unified:"1F69A",shortnames:["truck"]},{unified:"1F69B",shortnames:["articulated_lorry"]},{unified:"1F69C",shortnames:["tractor"]},{unified:"1F6B2",shortnames:["bike"]},{unified:"1F6F4",shortnames:["scooter"]},{unified:"1F6F5",shortnames:["motor_scooter"]},{unified:"1F68F",shortnames:["busstop"]},{unified:"1F6E3-FE0F",shortnames:["motorway"]},{unified:"1F6E4-FE0F",shortnames:["railway_track"]},{unified:"26FD",shortnames:["fuelpump"]},{unified:"1F6A8",shortnames:["rotating_light"]},{unified:"1F6A5",shortnames:["traffic_light"]},{unified:"1F6A6",shortnames:["vertical_traffic_light"]},{unified:"1F6A7",shortnames:["construction"]},{unified:"1F6D1",shortnames:["octagonal_sign"]},{unified:"2693",shortnames:["anchor"]},{unified:"26F5",shortnames:["boat"]},{unified:"1F6F6",shortnames:["canoe"]},{unified:"1F6A4",shortnames:["speedboat"]},{unified:"1F6F3-FE0F",shortnames:["passenger_ship"]},{unified:"26F4-FE0F",shortnames:["ferry"]},{unified:"1F6E5-FE0F",shortnames:["motor_boat"]},{unified:"1F6A2",shortnames:["ship"]},{unified:"2708-FE0F",shortnames:["airplane"]},{unified:"1F6E9-FE0F",shortnames:["small_airplane"]},{unified:"1F6EB",shortnames:["airplane_departure"]},{unified:"1F6EC",shortnames:["airplane_arriving"]},{unified:"1F4BA",shortnames:["seat"]},{unified:"1F681",shortnames:["helicopter"]},{unified:"1F69F",shortnames:["suspension_railway"]},{unified:"1F6A0",shortnames:["mountain_cableway"]},{unified:"1F6A1",shortnames:["aerial_tramway"]},{unified:"1F6F0-FE0F",shortnames:["satellite"]},{unified:"1F680",shortnames:["rocket"]},{unified:"1F6F8",shortnames:["flying_saucer"]},{unified:"1F6CE-FE0F",shortnames:["bellhop_bell"]},{unified:"1F6AA",shortnames:["door"]},{unified:"1F6CF-FE0F",shortnames:["bed"]},{unified:"1F6CB-FE0F",shortnames:["couch_and_lamp"]},{unified:"1F6BD",shortnames:["toilet"]},{unified:"1F6BF",shortnames:["shower"]},{unified:"1F6C1",shortnames:["bathtub"]},{unified:"231B",shortnames:["hourglass"]},{unified:"23F3",shortnames:["hourglass_flowing_sand"]},{unified:"231A",shortnames:["watch"]},{unified:"23F0",shortnames:["alarm_clock"]},{unified:"23F1-FE0F",shortnames:["stopwatch"]},{unified:"23F2-FE0F",shortnames:["timer_clock"]},{unified:"1F570-FE0F",shortnames:["mantelpiece_clock"]},{unified:"1F55B",shortnames:["clock12"]},{unified:"1F567",shortnames:["clock1230"]},{unified:"1F550",shortnames:["clock1"]},{unified:"1F55C",shortnames:["clock130"]},{unified:"1F551",shortnames:["clock2"]},{unified:"1F55D",shortnames:["clock230"]},{unified:"1F552",shortnames:["clock3"]},{unified:"1F55E",shortnames:["clock330"]},{unified:"1F553",shortnames:["clock4"]},{unified:"1F55F",shortnames:["clock430"]},{unified:"1F554",shortnames:["clock5"]},{unified:"1F560",shortnames:["clock530"]},{unified:"1F555",shortnames:["clock6"]},{unified:"1F561",shortnames:["clock630"]},{unified:"1F556",shortnames:["clock7"]},{unified:"1F562",shortnames:["clock730"]},{unified:"1F557",shortnames:["clock8"]},{unified:"1F563",shortnames:["clock830"]},{unified:"1F558",shortnames:["clock9"]},{unified:"1F564",shortnames:["clock930"]},{unified:"1F559",shortnames:["clock10"]},{unified:"1F565",shortnames:["clock1030"]},{unified:"1F55A",shortnames:["clock11"]},{unified:"1F566",shortnames:["clock1130"]},{unified:"1F311",shortnames:["new_moon"]},{unified:"1F312",shortnames:["waxing_crescent_moon"]},{unified:"1F313",shortnames:["first_quarter_moon"]},{unified:"1F314",shortnames:["moon"]},{unified:"1F315",shortnames:["full_moon"]},{unified:"1F316",shortnames:["waning_gibbous_moon"]},{unified:"1F317",shortnames:["last_quarter_moon"]},{unified:"1F318",shortnames:["waning_crescent_moon"]},{unified:"1F319",shortnames:["crescent_moon"]},{unified:"1F31A",shortnames:["new_moon_with_face"]},{unified:"1F31B",shortnames:["first_quarter_moon_with_face"]},{unified:"1F31C",shortnames:["last_quarter_moon_with_face"]},{unified:"1F321-FE0F",shortnames:["thermometer"]},{unified:"2600-FE0F",shortnames:["sunny"]},{unified:"1F31D",shortnames:["full_moon_with_face"]},{unified:"1F31E",shortnames:["sun_with_face"]},{unified:"2B50",shortnames:["star"]},{unified:"1F31F",shortnames:["star2"]},{unified:"1F320",shortnames:["stars"]},{unified:"2601-FE0F",shortnames:["cloud"]},{unified:"26C5",shortnames:["partly_sunny"]},{unified:"26C8-FE0F",shortnames:["thunder_cloud_and_rain"]},{unified:"1F324-FE0F",shortnames:["mostly_sunny"]},{unified:"1F325-FE0F",shortnames:["barely_sunny"]},{unified:"1F326-FE0F",shortnames:["partly_sunny_rain"]},{unified:"1F327-FE0F",shortnames:["rain_cloud"]},{unified:"1F328-FE0F",shortnames:["snow_cloud"]},{unified:"1F329-FE0F",shortnames:["lightning"]},{unified:"1F32A-FE0F",shortnames:["tornado"]},{unified:"1F32B-FE0F",shortnames:["fog"]},{unified:"1F32C-FE0F",shortnames:["wind_blowing_face"]},{unified:"1F300",shortnames:["cyclone"]},{unified:"1F308",shortnames:["rainbow"]},{unified:"1F302",shortnames:["closed_umbrella"]},{unified:"2602-FE0F",shortnames:["umbrella"]},{unified:"2614",shortnames:["umbrella_with_rain_drops"]},{unified:"26F1-FE0F",shortnames:["umbrella_on_ground"]},{unified:"26A1",shortnames:["zap"]},{unified:"2744-FE0F",shortnames:["snowflake"]},{unified:"2603-FE0F",shortnames:["snowman"]},{unified:"26C4",shortnames:["snowman_without_snow"]},{unified:"2604-FE0F",shortnames:["comet"]},{unified:"1F525",shortnames:["fire"]},{unified:"1F4A7",shortnames:["droplet"]},{unified:"1F30A",shortnames:["ocean"]}]},{name:"Activities",emojis:[{unified:"1F383",shortnames:["jack_o_lantern"]},{unified:"1F384",shortnames:["christmas_tree"]},{unified:"1F386",shortnames:["fireworks"]},{unified:"1F387",shortnames:["sparkler"]},{unified:"2728",shortnames:["sparkles"]},{unified:"1F388",shortnames:["balloon"]},{unified:"1F389",shortnames:["tada"]},{unified:"1F38A",shortnames:["confetti_ball"]},{unified:"1F38B",shortnames:["tanabata_tree"]},{unified:"1F38D",shortnames:["bamboo"]},{unified:"1F38E",shortnames:["dolls"]},{unified:"1F38F",shortnames:["flags"]},{unified:"1F390",shortnames:["wind_chime"]},{unified:"1F391",shortnames:["rice_scene"]},{unified:"1F380",shortnames:["ribbon"]},{unified:"1F381",shortnames:["gift"]},{unified:"1F397-FE0F",shortnames:["reminder_ribbon"]},{unified:"1F39F-FE0F",shortnames:["admission_tickets"]},{unified:"1F3AB",shortnames:["ticket"]},{unified:"1F396-FE0F",shortnames:["medal"]},{unified:"1F3C6",shortnames:["trophy"]},{unified:"1F3C5",shortnames:["sports_medal"]},{unified:"1F947",shortnames:["first_place_medal"]},{unified:"1F948",shortnames:["second_place_medal"]},{unified:"1F949",shortnames:["third_place_medal"]},{unified:"26BD",shortnames:["soccer"]},{unified:"26BE",shortnames:["baseball"]},{unified:"1F3C0",shortnames:["basketball"]},{unified:"1F3D0",shortnames:["volleyball"]},{unified:"1F3C8",shortnames:["football"]},{unified:"1F3C9",shortnames:["rugby_football"]},{unified:"1F3BE",shortnames:["tennis"]},{unified:"1F3B1",shortnames:["8ball"]},{unified:"1F3B3",shortnames:["bowling"]},{unified:"1F3CF",shortnames:["cricket_bat_and_ball"]},{unified:"1F3D1",shortnames:["field_hockey_stick_and_ball"]},{unified:"1F3D2",shortnames:["ice_hockey_stick_and_puck"]},{unified:"1F3D3",shortnames:["table_tennis_paddle_and_ball"]},{unified:"1F3F8",shortnames:["badminton_racquet_and_shuttlecock"]},{unified:"1F94A",shortnames:["boxing_glove"]},{unified:"1F94B",shortnames:["martial_arts_uniform"]},{unified:"1F945",shortnames:["goal_net"]},{unified:"1F3AF",shortnames:["dart"]},{unified:"26F3",shortnames:["golf"]},{unified:"26F8-FE0F",shortnames:["ice_skate"]},{unified:"1F3A3",shortnames:["fishing_pole_and_fish"]},{unified:"1F3BD",shortnames:["running_shirt_with_sash"]},{unified:"1F3BF",shortnames:["ski"]},{unified:"1F6F7",shortnames:["sled"]},{unified:"1F94C",shortnames:["curling_stone"]},{unified:"1F3AE",shortnames:["video_game"]},{unified:"1F579-FE0F",shortnames:["joystick"]},{unified:"1F3B2",shortnames:["game_die"]},{unified:"2660-FE0F",shortnames:["spades"]},{unified:"2665-FE0F",shortnames:["hearts"]},{unified:"2666-FE0F",shortnames:["diamonds"]},{unified:"2663-FE0F",shortnames:["clubs"]},{unified:"1F0CF",shortnames:["black_joker"]},{unified:"1F004",shortnames:["mahjong"]},{unified:"1F3B4",shortnames:["flower_playing_cards"]}]},{name:"Objects",emojis:[{unified:"1F507",shortnames:["mute"]},{unified:"1F508",shortnames:["speaker"]},{unified:"1F509",shortnames:["sound"]},{unified:"1F50A",shortnames:["loud_sound"]},{unified:"1F4E2",shortnames:["loudspeaker"]},{unified:"1F4E3",shortnames:["mega"]},{unified:"1F4EF",shortnames:["postal_horn"]},{unified:"1F514",shortnames:["bell"]},{unified:"1F515",shortnames:["no_bell"]},{unified:"1F3BC",shortnames:["musical_score"]},{unified:"1F3B5",shortnames:["musical_note"]},{unified:"1F3B6",shortnames:["notes"]},{unified:"1F399-FE0F",shortnames:["studio_microphone"]},{unified:"1F39A-FE0F",shortnames:["level_slider"]},{unified:"1F39B-FE0F",shortnames:["control_knobs"]},{unified:"1F3A4",shortnames:["microphone"]},{unified:"1F3A7",shortnames:["headphones"]},{unified:"1F4FB",shortnames:["radio"]},{unified:"1F3B7",shortnames:["saxophone"]},{unified:"1F3B8",shortnames:["guitar"]},{unified:"1F3B9",shortnames:["musical_keyboard"]},{unified:"1F3BA",shortnames:["trumpet"]},{unified:"1F3BB",shortnames:["violin"]},{unified:"1F941",shortnames:["drum_with_drumsticks"]},{unified:"1F4F1",shortnames:["iphone"]},{unified:"1F4F2",shortnames:["calling"]},{unified:"260E-FE0F",shortnames:["phone"]},{unified:"1F4DE",shortnames:["telephone_receiver"]},{unified:"1F4DF",shortnames:["pager"]},{unified:"1F4E0",shortnames:["fax"]},{unified:"1F50B",shortnames:["battery"]},{unified:"1F50C",shortnames:["electric_plug"]},{unified:"1F4BB",shortnames:["computer"]},{unified:"1F5A5-FE0F",shortnames:["desktop_computer"]},{unified:"1F5A8-FE0F",shortnames:["printer"]},{unified:"2328-FE0F",shortnames:["keyboard"]},{unified:"1F5B1-FE0F",shortnames:["three_button_mouse"]},{unified:"1F5B2-FE0F",shortnames:["trackball"]},{unified:"1F4BD",shortnames:["minidisc"]},{unified:"1F4BE",shortnames:["floppy_disk"]},{unified:"1F4BF",shortnames:["cd"]},{unified:"1F4C0",shortnames:["dvd"]},{unified:"1F3A5",shortnames:["movie_camera"]},{unified:"1F39E-FE0F",shortnames:["film_frames"]},{unified:"1F4FD-FE0F",shortnames:["film_projector"]},{unified:"1F3AC",shortnames:["clapper"]},{unified:"1F4FA",shortnames:["tv"]},{unified:"1F4F7",shortnames:["camera"]},{unified:"1F4F8",shortnames:["camera_with_flash"]},{unified:"1F4F9",shortnames:["video_camera"]},{unified:"1F4FC",shortnames:["vhs"]},{unified:"1F50D",shortnames:["mag"]},{unified:"1F50E",shortnames:["mag_right"]},{unified:"1F52C",shortnames:["microscope"]},{unified:"1F52D",shortnames:["telescope"]},{unified:"1F4E1",shortnames:["satellite_antenna"]},{unified:"1F56F-FE0F",shortnames:["candle"]},{unified:"1F4A1",shortnames:["bulb"]},{unified:"1F526",shortnames:["flashlight"]},{unified:"1F3EE",shortnames:["izakaya_lantern"]},{unified:"1F4D4",shortnames:["notebook_with_decorative_cover"]},{unified:"1F4D5",shortnames:["closed_book"]},{unified:"1F4D6",shortnames:["book"]},{unified:"1F4D7",shortnames:["green_book"]},{unified:"1F4D8",shortnames:["blue_book"]},{unified:"1F4D9",shortnames:["orange_book"]},{unified:"1F4DA",shortnames:["books"]},{unified:"1F4D3",shortnames:["notebook"]},{unified:"1F4D2",shortnames:["ledger"]},{unified:"1F4C3",shortnames:["page_with_curl"]},{unified:"1F4DC",shortnames:["scroll"]},{unified:"1F4C4",shortnames:["page_facing_up"]},{unified:"1F4F0",shortnames:["newspaper"]},{unified:"1F5DE-FE0F",shortnames:["rolled_up_newspaper"]},{unified:"1F4D1",shortnames:["bookmark_tabs"]},{unified:"1F516",shortnames:["bookmark"]},{unified:"1F3F7-FE0F",shortnames:["label"]},{unified:"1F4B0",shortnames:["moneybag"]},{unified:"1F4B4",shortnames:["yen"]},{unified:"1F4B5",shortnames:["dollar"]},{unified:"1F4B6",shortnames:["euro"]},{unified:"1F4B7",shortnames:["pound"]},{unified:"1F4B8",shortnames:["money_with_wings"]},{unified:"1F4B3",shortnames:["credit_card"]},{unified:"1F4B9",shortnames:["chart"]},{unified:"1F4B1",shortnames:["currency_exchange"]},{unified:"1F4B2",shortnames:["heavy_dollar_sign"]},{unified:"2709-FE0F",shortnames:["email"]},{unified:"1F4E7",shortnames:["e-mail"]},{unified:"1F4E8",shortnames:["incoming_envelope"]},{unified:"1F4E9",shortnames:["envelope_with_arrow"]},{unified:"1F4E4",shortnames:["outbox_tray"]},{unified:"1F4E5",shortnames:["inbox_tray"]},{unified:"1F4E6",shortnames:["package"]},{unified:"1F4EB",shortnames:["mailbox"]},{unified:"1F4EA",shortnames:["mailbox_closed"]},{unified:"1F4EC",shortnames:["mailbox_with_mail"]},{unified:"1F4ED",shortnames:["mailbox_with_no_mail"]},{unified:"1F4EE",shortnames:["postbox"]},{unified:"1F5F3-FE0F",shortnames:["ballot_box_with_ballot"]},{unified:"270F-FE0F",shortnames:["pencil2"]},{unified:"2712-FE0F",shortnames:["black_nib"]},{unified:"1F58B-FE0F",shortnames:["lower_left_fountain_pen"]},{unified:"1F58A-FE0F",shortnames:["lower_left_ballpoint_pen"]},{unified:"1F58C-FE0F",shortnames:["lower_left_paintbrush"]},{unified:"1F58D-FE0F",shortnames:["lower_left_crayon"]},{unified:"1F4DD",shortnames:["memo"]},{unified:"1F4BC",shortnames:["briefcase"]},{unified:"1F4C1",shortnames:["file_folder"]},{unified:"1F4C2",shortnames:["open_file_folder"]},{unified:"1F5C2-FE0F",shortnames:["card_index_dividers"]},{unified:"1F4C5",shortnames:["date"]},{unified:"1F4C6",shortnames:["calendar"]},{unified:"1F5D2-FE0F",shortnames:["spiral_note_pad"]},{unified:"1F5D3-FE0F",shortnames:["spiral_calendar_pad"]},{unified:"1F4C7",shortnames:["card_index"]},{unified:"1F4C8",shortnames:["chart_with_upwards_trend"]},{unified:"1F4C9",shortnames:["chart_with_downwards_trend"]},{unified:"1F4CA",shortnames:["bar_chart"]},{unified:"1F4CB",shortnames:["clipboard"]},{unified:"1F4CC",shortnames:["pushpin"]},{unified:"1F4CD",shortnames:["round_pushpin"]},{unified:"1F4CE",shortnames:["paperclip"]},{unified:"1F587-FE0F",shortnames:["linked_paperclips"]},{unified:"1F4CF",shortnames:["straight_ruler"]},{unified:"1F4D0",shortnames:["triangular_ruler"]},{unified:"2702-FE0F",shortnames:["scissors"]},{unified:"1F5C3-FE0F",shortnames:["card_file_box"]},{unified:"1F5C4-FE0F",shortnames:["file_cabinet"]},{unified:"1F5D1-FE0F",shortnames:["wastebasket"]},{unified:"1F512",shortnames:["lock"]},{unified:"1F513",shortnames:["unlock"]},{unified:"1F50F",shortnames:["lock_with_ink_pen"]},{unified:"1F510",shortnames:["closed_lock_with_key"]},{unified:"1F511",shortnames:["key"]},{unified:"1F5DD-FE0F",shortnames:["old_key"]},{unified:"1F528",shortnames:["hammer"]},{unified:"26CF-FE0F",shortnames:["pick"]},{unified:"2692-FE0F",shortnames:["hammer_and_pick"]},{unified:"1F6E0-FE0F",shortnames:["hammer_and_wrench"]},{unified:"1F5E1-FE0F",shortnames:["dagger_knife"]},{unified:"2694-FE0F",shortnames:["crossed_swords"]},{unified:"1F52B",shortnames:["gun"]},{unified:"1F3F9",shortnames:["bow_and_arrow"]},{unified:"1F6E1-FE0F",shortnames:["shield"]},{unified:"1F527",shortnames:["wrench"]},{unified:"1F529",shortnames:["nut_and_bolt"]},{unified:"2699-FE0F",shortnames:["gear"]},{unified:"1F5DC-FE0F",shortnames:["compression"]},{unified:"2697-FE0F",shortnames:["alembic"]},{unified:"2696-FE0F",shortnames:["scales"]},{unified:"1F517",shortnames:["link"]},{unified:"26D3-FE0F",shortnames:["chains"]},{unified:"1F489",shortnames:["syringe"]},{unified:"1F48A",shortnames:["pill"]},{unified:"1F6AC",shortnames:["smoking"]},{unified:"26B0-FE0F",shortnames:["coffin"]},{unified:"26B1-FE0F",shortnames:["funeral_urn"]},{unified:"1F5FF",shortnames:["moyai"]},{unified:"1F6E2-FE0F",shortnames:["oil_drum"]},{unified:"1F52E",shortnames:["crystal_ball"]},{unified:"1F6D2",shortnames:["shopping_trolley"]}]},{name:"Symbols",emojis:[{unified:"1F3E7",shortnames:["atm"]},{unified:"1F6AE",shortnames:["put_litter_in_its_place"]},{unified:"1F6B0",shortnames:["potable_water"]},{unified:"267F",shortnames:["wheelchair"]},{unified:"1F6B9",shortnames:["mens"]},{unified:"1F6BA",shortnames:["womens"]},{unified:"1F6BB",shortnames:["restroom"]},{unified:"1F6BC",shortnames:["baby_symbol"]},{unified:"1F6BE",shortnames:["wc"]},{unified:"1F6C2",shortnames:["passport_control"]},{unified:"1F6C3",shortnames:["customs"]},{unified:"1F6C4",shortnames:["baggage_claim"]},{unified:"1F6C5",shortnames:["left_luggage"]},{unified:"26A0-FE0F",shortnames:["warning"]},{unified:"1F6B8",shortnames:["children_crossing"]},{unified:"26D4",shortnames:["no_entry"]},{unified:"1F6AB",shortnames:["no_entry_sign"]},{unified:"1F6B3",shortnames:["no_bicycles"]},{unified:"1F6AD",shortnames:["no_smoking"]},{unified:"1F6AF",shortnames:["do_not_litter"]},{unified:"1F6B1",shortnames:["non-potable_water"]},{unified:"1F6B7",shortnames:["no_pedestrians"]},{unified:"1F4F5",shortnames:["no_mobile_phones"]},{unified:"1F51E",shortnames:["underage"]},{unified:"2622-FE0F",shortnames:["radioactive_sign"]},{unified:"2623-FE0F",shortnames:["biohazard_sign"]},{unified:"2B06-FE0F",shortnames:["arrow_up"]},{unified:"2197-FE0F",shortnames:["arrow_upper_right"]},{unified:"27A1-FE0F",shortnames:["arrow_right"]},{unified:"2198-FE0F",shortnames:["arrow_lower_right"]},{unified:"2B07-FE0F",shortnames:["arrow_down"]},{unified:"2199-FE0F",shortnames:["arrow_lower_left"]},{unified:"2B05-FE0F",shortnames:["arrow_left"]},{unified:"2196-FE0F",shortnames:["arrow_upper_left"]},{unified:"2195-FE0F",shortnames:["arrow_up_down"]},{unified:"2194-FE0F",shortnames:["left_right_arrow"]},{unified:"21A9-FE0F",shortnames:["leftwards_arrow_with_hook"]},{unified:"21AA-FE0F",shortnames:["arrow_right_hook"]},{unified:"2934-FE0F",shortnames:["arrow_heading_up"]},{unified:"2935-FE0F",shortnames:["arrow_heading_down"]},{unified:"1F503",shortnames:["arrows_clockwise"]},{unified:"1F504",shortnames:["arrows_counterclockwise"]},{unified:"1F519",shortnames:["back"]},{unified:"1F51A",shortnames:["end"]},{unified:"1F51B",shortnames:["on"]},{unified:"1F51C",shortnames:["soon"]},{unified:"1F51D",shortnames:["top"]},{unified:"1F6D0",shortnames:["place_of_worship"]},{unified:"269B-FE0F",shortnames:["atom_symbol"]},{unified:"1F549-FE0F",shortnames:["om_symbol"]},{unified:"2721-FE0F",shortnames:["star_of_david"]},{unified:"2638-FE0F",shortnames:["wheel_of_dharma"]},{unified:"262F-FE0F",shortnames:["yin_yang"]},{unified:"271D-FE0F",shortnames:["latin_cross"]},{unified:"2626-FE0F",shortnames:["orthodox_cross"]},{unified:"262A-FE0F",shortnames:["star_and_crescent"]},{unified:"262E-FE0F",shortnames:["peace_symbol"]},{unified:"1F54E",shortnames:["menorah_with_nine_branches"]},{unified:"1F52F",shortnames:["six_pointed_star"]},{unified:"2648",shortnames:["aries"]},{unified:"2649",shortnames:["taurus"]},{unified:"264A",shortnames:["gemini"]},{unified:"264B",shortnames:["cancer"]},{unified:"264C",shortnames:["leo"]},{unified:"264D",shortnames:["virgo"]},{unified:"264E",shortnames:["libra"]},{unified:"264F",shortnames:["scorpius"]},{unified:"2650",shortnames:["sagittarius"]},{unified:"2651",shortnames:["capricorn"]},{unified:"2652",shortnames:["aquarius"]},{unified:"2653",shortnames:["pisces"]},{unified:"26CE",shortnames:["ophiuchus"]},{unified:"1F500",shortnames:["twisted_rightwards_arrows"]},{unified:"1F501",shortnames:["repeat"]},{unified:"1F502",shortnames:["repeat_one"]},{unified:"25B6-FE0F",shortnames:["arrow_forward"]},{unified:"23E9",shortnames:["fast_forward"]},{unified:"23ED-FE0F",shortnames:["black_right_pointing_double_triangle_with_vertical_bar"]},{unified:"23EF-FE0F",shortnames:["black_right_pointing_triangle_with_double_vertical_bar"]},{unified:"25C0-FE0F",shortnames:["arrow_backward"]},{unified:"23EA",shortnames:["rewind"]},{unified:"23EE-FE0F",shortnames:["black_left_pointing_double_triangle_with_vertical_bar"]},{unified:"1F53C",shortnames:["arrow_up_small"]},{unified:"23EB",shortnames:["arrow_double_up"]},{unified:"1F53D",shortnames:["arrow_down_small"]},{unified:"23EC",shortnames:["arrow_double_down"]},{unified:"23F8-FE0F",shortnames:["double_vertical_bar"]},{unified:"23F9-FE0F",shortnames:["black_square_for_stop"]},{unified:"23FA-FE0F",shortnames:["black_circle_for_record"]},{unified:"23CF-FE0F",shortnames:["eject"]},{unified:"1F3A6",shortnames:["cinema"]},{unified:"1F505",shortnames:["low_brightness"]},{unified:"1F506",shortnames:["high_brightness"]},{unified:"1F4F6",shortnames:["signal_strength"]},{unified:"1F4F3",shortnames:["vibration_mode"]},{unified:"1F4F4",shortnames:["mobile_phone_off"]},{unified:"2640-FE0F",shortnames:["female_sign"]},{unified:"2642-FE0F",shortnames:["male_sign"]},{unified:"2695-FE0F",shortnames:["medical_symbol"]},{unified:"267B-FE0F",shortnames:["recycle"]},{unified:"269C-FE0F",shortnames:["fleur_de_lis"]},{unified:"1F531",shortnames:["trident"]},{unified:"1F4DB",shortnames:["name_badge"]},{unified:"1F530",shortnames:["beginner"]},{unified:"2B55",shortnames:["o"]},{unified:"2705",shortnames:["white_check_mark"]},{unified:"2611-FE0F",shortnames:["ballot_box_with_check"]},{unified:"2714-FE0F",shortnames:["heavy_check_mark"]},{unified:"2716-FE0F",shortnames:["heavy_multiplication_x"]},{unified:"274C",shortnames:["x"]},{unified:"274E",shortnames:["negative_squared_cross_mark"]},{unified:"2795",shortnames:["heavy_plus_sign"]},{unified:"2796",shortnames:["heavy_minus_sign"]},{unified:"2797",shortnames:["heavy_division_sign"]},{unified:"27B0",shortnames:["curly_loop"]},{unified:"27BF",shortnames:["loop"]},{unified:"303D-FE0F",shortnames:["part_alternation_mark"]},{unified:"2733-FE0F",shortnames:["eight_spoked_asterisk"]},{unified:"2734-FE0F",shortnames:["eight_pointed_black_star"]},{unified:"2747-FE0F",shortnames:["sparkle"]},{unified:"203C-FE0F",shortnames:["bangbang"]},{unified:"2049-FE0F",shortnames:["interrobang"]},{unified:"2753",shortnames:["question"]},{unified:"2754",shortnames:["grey_question"]},{unified:"2755",shortnames:["grey_exclamation"]},{unified:"2757",shortnames:["exclamation"]},{unified:"3030-FE0F",shortnames:["wavy_dash"]},{unified:"00A9-FE0F",shortnames:["copyright"]},{unified:"00AE-FE0F",shortnames:["registered"]},{unified:"2122-FE0F",shortnames:["tm"]},{unified:"0023-FE0F-20E3",shortnames:["hash"]},{unified:"002A-FE0F-20E3",shortnames:["keycap_star"]},{unified:"0030-FE0F-20E3",shortnames:["zero"]},{unified:"0031-FE0F-20E3",shortnames:["one"]},{unified:"0032-FE0F-20E3",shortnames:["two"]},{unified:"0033-FE0F-20E3",shortnames:["three"]},{unified:"0034-FE0F-20E3",shortnames:["four"]},{unified:"0035-FE0F-20E3",shortnames:["five"]},{unified:"0036-FE0F-20E3",shortnames:["six"]},{unified:"0037-FE0F-20E3",shortnames:["seven"]},{unified:"0038-FE0F-20E3",shortnames:["eight"]},{unified:"0039-FE0F-20E3",shortnames:["nine"]},{unified:"1F51F",shortnames:["keycap_ten"]},{unified:"1F4AF",shortnames:["100"]},{unified:"1F520",shortnames:["capital_abcd"]},{unified:"1F521",shortnames:["abcd"]},{unified:"1F522",shortnames:["1234"]},{unified:"1F523",shortnames:["symbols"]},{unified:"1F524",shortnames:["abc"]},{unified:"1F170-FE0F",shortnames:["a"]},{unified:"1F18E",shortnames:["ab"]},{unified:"1F171-FE0F",shortnames:["b"]},{unified:"1F191",shortnames:["cl"]},{unified:"1F192",shortnames:["cool"]},{unified:"1F193",shortnames:["free"]},{unified:"2139-FE0F",shortnames:["information_source"]},{unified:"1F194",shortnames:["id"]},{unified:"24C2-FE0F",shortnames:["m"]},{unified:"1F195",shortnames:["new"]},{unified:"1F196",shortnames:["ng"]},{unified:"1F17E-FE0F",shortnames:["o2"]},{unified:"1F197",shortnames:["ok"]},{unified:"1F17F-FE0F",shortnames:["parking"]},{unified:"1F198",shortnames:["sos"]},{unified:"1F199",shortnames:["up"]},{unified:"1F19A",shortnames:["vs"]},{unified:"1F201",shortnames:["koko"]},{unified:"1F202-FE0F",shortnames:["sa"]},{unified:"1F237-FE0F",shortnames:["u6708"]},{unified:"1F236",shortnames:["u6709"]},{unified:"1F22F",shortnames:["u6307"]},{unified:"1F250",shortnames:["ideograph_advantage"]},{unified:"1F239",shortnames:["u5272"]},{unified:"1F21A",shortnames:["u7121"]},{unified:"1F232",shortnames:["u7981"]},{unified:"1F251",shortnames:["accept"]},{unified:"1F238",shortnames:["u7533"]},{unified:"1F234",shortnames:["u5408"]},{unified:"1F233",shortnames:["u7a7a"]},{unified:"3297-FE0F",shortnames:["congratulations"]},{unified:"3299-FE0F",shortnames:["secret"]},{unified:"1F23A",shortnames:["u55b6"]},{unified:"1F235",shortnames:["u6e80"]},{unified:"25AA-FE0F",shortnames:["black_small_square"]},{unified:"25AB-FE0F",shortnames:["white_small_square"]},{unified:"25FB-FE0F",shortnames:["white_medium_square"]},{unified:"25FC-FE0F",shortnames:["black_medium_square"]},{unified:"25FD",shortnames:["white_medium_small_square"]},{unified:"25FE",shortnames:["black_medium_small_square"]},{unified:"2B1B",shortnames:["black_large_square"]},{unified:"2B1C",shortnames:["white_large_square"]},{unified:"1F536",shortnames:["large_orange_diamond"]},{unified:"1F537",shortnames:["large_blue_diamond"]},{unified:"1F538",shortnames:["small_orange_diamond"]},{unified:"1F539",shortnames:["small_blue_diamond"]},{unified:"1F53A",shortnames:["small_red_triangle"]},{unified:"1F53B",shortnames:["small_red_triangle_down"]},{unified:"1F4A0",shortnames:["diamond_shape_with_a_dot_inside"]},{unified:"1F518",shortnames:["radio_button"]},{unified:"1F532",shortnames:["black_square_button"]},{unified:"1F533",shortnames:["white_square_button"]},{unified:"26AA",shortnames:["white_circle"]},{unified:"26AB",shortnames:["black_circle"]},{unified:"1F534",shortnames:["red_circle"]},{unified:"1F535",shortnames:["large_blue_circle"]}]},{name:"Flags",emojis:[{unified:"1F3C1",shortnames:["checkered_flag"]},{unified:"1F6A9",shortnames:["triangular_flag_on_post"]},{unified:"1F38C",shortnames:["crossed_flags"]},{unified:"1F3F4",shortnames:["waving_black_flag"]},{unified:"1F3F3-FE0F",shortnames:["waving_white_flag"]},{unified:"1F3F3-FE0F-200D-1F308",shortnames:["rainbow-flag"]},{unified:"1F1E6-1F1E8",shortnames:["flag-ac"]},{unified:"1F1E6-1F1E9",shortnames:["flag-ad"]},{unified:"1F1E6-1F1EA",shortnames:["flag-ae"]},{unified:"1F1E6-1F1EB",shortnames:["flag-af"]},{unified:"1F1E6-1F1EC",shortnames:["flag-ag"]},{unified:"1F1E6-1F1EE",shortnames:["flag-ai"]},{unified:"1F1E6-1F1F1",shortnames:["flag-al"]},{unified:"1F1E6-1F1F2",shortnames:["flag-am"]},{unified:"1F1E6-1F1F4",shortnames:["flag-ao"]},{unified:"1F1E6-1F1F6",shortnames:["flag-aq"]},{unified:"1F1E6-1F1F7",shortnames:["flag-ar"]},{unified:"1F1E6-1F1F8",shortnames:["flag-as"]},{unified:"1F1E6-1F1F9",shortnames:["flag-at"]},{unified:"1F1E6-1F1FA",shortnames:["flag-au"]},{unified:"1F1E6-1F1FC",shortnames:["flag-aw"]},{unified:"1F1E6-1F1FD",shortnames:["flag-ax"]},{unified:"1F1E6-1F1FF",shortnames:["flag-az"]},{unified:"1F1E7-1F1E6",shortnames:["flag-ba"]},{unified:"1F1E7-1F1E7",shortnames:["flag-bb"]},{unified:"1F1E7-1F1E9",shortnames:["flag-bd"]},{unified:"1F1E7-1F1EA",shortnames:["flag-be"]},{unified:"1F1E7-1F1EB",shortnames:["flag-bf"]},{unified:"1F1E7-1F1EC",shortnames:["flag-bg"]},{unified:"1F1E7-1F1ED",shortnames:["flag-bh"]},{unified:"1F1E7-1F1EE",shortnames:["flag-bi"]},{unified:"1F1E7-1F1EF",shortnames:["flag-bj"]},{unified:"1F1E7-1F1F1",shortnames:["flag-bl"]},{unified:"1F1E7-1F1F2",shortnames:["flag-bm"]},{unified:"1F1E7-1F1F3",shortnames:["flag-bn"]},{unified:"1F1E7-1F1F4",shortnames:["flag-bo"]},{unified:"1F1E7-1F1F6",shortnames:["flag-bq"]},{unified:"1F1E7-1F1F7",shortnames:["flag-br"]},{unified:"1F1E7-1F1F8",shortnames:["flag-bs"]},{unified:"1F1E7-1F1F9",shortnames:["flag-bt"]},{unified:"1F1E7-1F1FB",shortnames:["flag-bv"]},{unified:"1F1E7-1F1FC",shortnames:["flag-bw"]},{unified:"1F1E7-1F1FE",shortnames:["flag-by"]},{unified:"1F1E7-1F1FF",shortnames:["flag-bz"]},{unified:"1F1E8-1F1E6",shortnames:["flag-ca"]},{unified:"1F1E8-1F1E8",shortnames:["flag-cc"]},{unified:"1F1E8-1F1E9",shortnames:["flag-cd"]},{unified:"1F1E8-1F1EB",shortnames:["flag-cf"]},{unified:"1F1E8-1F1EC",shortnames:["flag-cg"]},{unified:"1F1E8-1F1ED",shortnames:["flag-ch"]},{unified:"1F1E8-1F1EE",shortnames:["flag-ci"]},{unified:"1F1E8-1F1F0",shortnames:["flag-ck"]},{unified:"1F1E8-1F1F1",shortnames:["flag-cl"]},{unified:"1F1E8-1F1F2",shortnames:["flag-cm"]},{unified:"1F1E8-1F1F3",shortnames:["cn"]},{unified:"1F1E8-1F1F4",shortnames:["flag-co"]},{unified:"1F1E8-1F1F5",shortnames:["flag-cp"]},{unified:"1F1E8-1F1F7",shortnames:["flag-cr"]},{unified:"1F1E8-1F1FA",shortnames:["flag-cu"]},{unified:"1F1E8-1F1FB",shortnames:["flag-cv"]},{unified:"1F1E8-1F1FC",shortnames:["flag-cw"]},{unified:"1F1E8-1F1FD",shortnames:["flag-cx"]},{unified:"1F1E8-1F1FE",shortnames:["flag-cy"]},{unified:"1F1E8-1F1FF",shortnames:["flag-cz"]},{unified:"1F1E9-1F1EA",shortnames:["de"]},{unified:"1F1E9-1F1EC",shortnames:["flag-dg"]},{unified:"1F1E9-1F1EF",shortnames:["flag-dj"]},{unified:"1F1E9-1F1F0",shortnames:["flag-dk"]},{unified:"1F1E9-1F1F2",shortnames:["flag-dm"]},{unified:"1F1E9-1F1F4",shortnames:["flag-do"]},{unified:"1F1E9-1F1FF",shortnames:["flag-dz"]},{unified:"1F1EA-1F1E6",shortnames:["flag-ea"]},{unified:"1F1EA-1F1E8",shortnames:["flag-ec"]},{unified:"1F1EA-1F1EA",shortnames:["flag-ee"]},{unified:"1F1EA-1F1EC",shortnames:["flag-eg"]},{unified:"1F1EA-1F1ED",shortnames:["flag-eh"]},{unified:"1F1EA-1F1F7",shortnames:["flag-er"]},{unified:"1F1EA-1F1F8",shortnames:["es"]},{unified:"1F1EA-1F1F9",shortnames:["flag-et"]},{unified:"1F1EA-1F1FA",shortnames:["flag-eu"]},{unified:"1F1EB-1F1EE",shortnames:["flag-fi"]},{unified:"1F1EB-1F1EF",shortnames:["flag-fj"]},{unified:"1F1EB-1F1F0",shortnames:["flag-fk"]},{unified:"1F1EB-1F1F2",shortnames:["flag-fm"]},{unified:"1F1EB-1F1F4",shortnames:["flag-fo"]},{unified:"1F1EB-1F1F7",shortnames:["fr"]},{unified:"1F1EC-1F1E6",shortnames:["flag-ga"]},{unified:"1F1EC-1F1E7",shortnames:["gb"]},{unified:"1F1EC-1F1E9",shortnames:["flag-gd"]},{unified:"1F1EC-1F1EA",shortnames:["flag-ge"]},{unified:"1F1EC-1F1EB",shortnames:["flag-gf"]},{unified:"1F1EC-1F1EC",shortnames:["flag-gg"]},{unified:"1F1EC-1F1ED",shortnames:["flag-gh"]},{unified:"1F1EC-1F1EE",shortnames:["flag-gi"]},{unified:"1F1EC-1F1F1",shortnames:["flag-gl"]},{unified:"1F1EC-1F1F2",shortnames:["flag-gm"]},{unified:"1F1EC-1F1F3",shortnames:["flag-gn"]},{unified:"1F1EC-1F1F5",shortnames:["flag-gp"]},{unified:"1F1EC-1F1F6",shortnames:["flag-gq"]},{unified:"1F1EC-1F1F7",shortnames:["flag-gr"]},{unified:"1F1EC-1F1F8",shortnames:["flag-gs"]},{unified:"1F1EC-1F1F9",shortnames:["flag-gt"]},{unified:"1F1EC-1F1FA",shortnames:["flag-gu"]},{unified:"1F1EC-1F1FC",shortnames:["flag-gw"]},{unified:"1F1EC-1F1FE",shortnames:["flag-gy"]},{unified:"1F1ED-1F1F0",shortnames:["flag-hk"]},{unified:"1F1ED-1F1F2",shortnames:["flag-hm"]},{unified:"1F1ED-1F1F3",shortnames:["flag-hn"]},{unified:"1F1ED-1F1F7",shortnames:["flag-hr"]},{unified:"1F1ED-1F1F9",shortnames:["flag-ht"]},{unified:"1F1ED-1F1FA",shortnames:["flag-hu"]},{unified:"1F1EE-1F1E8",shortnames:["flag-ic"]},{unified:"1F1EE-1F1E9",shortnames:["flag-id"]},{unified:"1F1EE-1F1EA",shortnames:["flag-ie"]},{unified:"1F1EE-1F1F1",shortnames:["flag-il"]},{unified:"1F1EE-1F1F2",shortnames:["flag-im"]},{unified:"1F1EE-1F1F3",shortnames:["flag-in"]},{unified:"1F1EE-1F1F4",shortnames:["flag-io"]},{unified:"1F1EE-1F1F6",shortnames:["flag-iq"]},{unified:"1F1EE-1F1F7",shortnames:["flag-ir"]},{unified:"1F1EE-1F1F8",shortnames:["flag-is"]},{unified:"1F1EE-1F1F9",shortnames:["it"]},{unified:"1F1EF-1F1EA",shortnames:["flag-je"]},{unified:"1F1EF-1F1F2",shortnames:["flag-jm"]},{unified:"1F1EF-1F1F4",shortnames:["flag-jo"]},{unified:"1F1EF-1F1F5",shortnames:["jp"]},{unified:"1F1F0-1F1EA",shortnames:["flag-ke"]},{unified:"1F1F0-1F1EC",shortnames:["flag-kg"]},{unified:"1F1F0-1F1ED",shortnames:["flag-kh"]},{unified:"1F1F0-1F1EE",shortnames:["flag-ki"]},{unified:"1F1F0-1F1F2",shortnames:["flag-km"]},{unified:"1F1F0-1F1F3",shortnames:["flag-kn"]},{unified:"1F1F0-1F1F5",shortnames:["flag-kp"]},{unified:"1F1F0-1F1F7",shortnames:["kr"]},{unified:"1F1F0-1F1FC",shortnames:["flag-kw"]},{unified:"1F1F0-1F1FE",shortnames:["flag-ky"]},{unified:"1F1F0-1F1FF",shortnames:["flag-kz"]},{unified:"1F1F1-1F1E6",shortnames:["flag-la"]},{unified:"1F1F1-1F1E7",shortnames:["flag-lb"]},{unified:"1F1F1-1F1E8",shortnames:["flag-lc"]},{unified:"1F1F1-1F1EE",shortnames:["flag-li"]},{unified:"1F1F1-1F1F0",shortnames:["flag-lk"]},{unified:"1F1F1-1F1F7",shortnames:["flag-lr"]},{unified:"1F1F1-1F1F8",shortnames:["flag-ls"]},{unified:"1F1F1-1F1F9",shortnames:["flag-lt"]},{unified:"1F1F1-1F1FA",shortnames:["flag-lu"]},{unified:"1F1F1-1F1FB",shortnames:["flag-lv"]},{unified:"1F1F1-1F1FE",shortnames:["flag-ly"]},{unified:"1F1F2-1F1E6",shortnames:["flag-ma"]},{unified:"1F1F2-1F1E8",shortnames:["flag-mc"]},{unified:"1F1F2-1F1E9",shortnames:["flag-md"]},{unified:"1F1F2-1F1EA",shortnames:["flag-me"]},{unified:"1F1F2-1F1EB",shortnames:["flag-mf"]},{unified:"1F1F2-1F1EC",shortnames:["flag-mg"]},{unified:"1F1F2-1F1ED",shortnames:["flag-mh"]},{unified:"1F1F2-1F1F0",shortnames:["flag-mk"]},{unified:"1F1F2-1F1F1",shortnames:["flag-ml"]},{unified:"1F1F2-1F1F2",shortnames:["flag-mm"]},{unified:"1F1F2-1F1F3",shortnames:["flag-mn"]},{unified:"1F1F2-1F1F4",shortnames:["flag-mo"]},{unified:"1F1F2-1F1F5",shortnames:["flag-mp"]},{unified:"1F1F2-1F1F6",shortnames:["flag-mq"]},{unified:"1F1F2-1F1F7",shortnames:["flag-mr"]},{unified:"1F1F2-1F1F8",shortnames:["flag-ms"]},{unified:"1F1F2-1F1F9",shortnames:["flag-mt"]},{unified:"1F1F2-1F1FA",shortnames:["flag-mu"]},{unified:"1F1F2-1F1FB",shortnames:["flag-mv"]},{unified:"1F1F2-1F1FC",shortnames:["flag-mw"]},{unified:"1F1F2-1F1FD",shortnames:["flag-mx"]},{unified:"1F1F2-1F1FE",shortnames:["flag-my"]},{unified:"1F1F2-1F1FF",shortnames:["flag-mz"]},{unified:"1F1F3-1F1E6",shortnames:["flag-na"]},{unified:"1F1F3-1F1E8",shortnames:["flag-nc"]},{unified:"1F1F3-1F1EA",shortnames:["flag-ne"]},{unified:"1F1F3-1F1EB",shortnames:["flag-nf"]},{unified:"1F1F3-1F1EC",shortnames:["flag-ng"]},{unified:"1F1F3-1F1EE",shortnames:["flag-ni"]},{unified:"1F1F3-1F1F1",shortnames:["flag-nl"]},{unified:"1F1F3-1F1F4",shortnames:["flag-no"]},{unified:"1F1F3-1F1F5",shortnames:["flag-np"]},{unified:"1F1F3-1F1F7",shortnames:["flag-nr"]},{unified:"1F1F3-1F1FA",shortnames:["flag-nu"]},{unified:"1F1F3-1F1FF",shortnames:["flag-nz"]},{unified:"1F1F4-1F1F2",shortnames:["flag-om"]},{unified:"1F1F5-1F1E6",shortnames:["flag-pa"]},{unified:"1F1F5-1F1EA",shortnames:["flag-pe"]},{unified:"1F1F5-1F1EB",shortnames:["flag-pf"]},{unified:"1F1F5-1F1EC",shortnames:["flag-pg"]},{unified:"1F1F5-1F1ED",shortnames:["flag-ph"]},{unified:"1F1F5-1F1F0",shortnames:["flag-pk"]},{unified:"1F1F5-1F1F1",shortnames:["flag-pl"]},{unified:"1F1F5-1F1F2",shortnames:["flag-pm"]},{unified:"1F1F5-1F1F3",shortnames:["flag-pn"]},{unified:"1F1F5-1F1F7",shortnames:["flag-pr"]},{unified:"1F1F5-1F1F8",shortnames:["flag-ps"]},{unified:"1F1F5-1F1F9",shortnames:["flag-pt"]},{unified:"1F1F5-1F1FC",shortnames:["flag-pw"]},{unified:"1F1F5-1F1FE",shortnames:["flag-py"]},{unified:"1F1F6-1F1E6",shortnames:["flag-qa"]},{unified:"1F1F7-1F1EA",shortnames:["flag-re"]},{unified:"1F1F7-1F1F4",shortnames:["flag-ro"]},{unified:"1F1F7-1F1F8",shortnames:["flag-rs"]},{unified:"1F1F7-1F1FA",shortnames:["ru"]},{unified:"1F1F7-1F1FC",shortnames:["flag-rw"]},{unified:"1F1F8-1F1E6",shortnames:["flag-sa"]},{unified:"1F1F8-1F1E7",shortnames:["flag-sb"]},{unified:"1F1F8-1F1E8",shortnames:["flag-sc"]},{unified:"1F1F8-1F1E9",shortnames:["flag-sd"]},{unified:"1F1F8-1F1EA",shortnames:["flag-se"]},{unified:"1F1F8-1F1EC",shortnames:["flag-sg"]},{unified:"1F1F8-1F1ED",shortnames:["flag-sh"]},{unified:"1F1F8-1F1EE",shortnames:["flag-si"]},{unified:"1F1F8-1F1EF",shortnames:["flag-sj"]},{unified:"1F1F8-1F1F0",shortnames:["flag-sk"]},{unified:"1F1F8-1F1F1",shortnames:["flag-sl"]},{unified:"1F1F8-1F1F2",shortnames:["flag-sm"]},{unified:"1F1F8-1F1F3",shortnames:["flag-sn"]},{unified:"1F1F8-1F1F4",shortnames:["flag-so"]},{unified:"1F1F8-1F1F7",shortnames:["flag-sr"]},{unified:"1F1F8-1F1F8",shortnames:["flag-ss"]},{unified:"1F1F8-1F1F9",shortnames:["flag-st"]},{unified:"1F1F8-1F1FB",shortnames:["flag-sv"]},{unified:"1F1F8-1F1FD",shortnames:["flag-sx"]},{unified:"1F1F8-1F1FE",shortnames:["flag-sy"]},{unified:"1F1F8-1F1FF",shortnames:["flag-sz"]},{unified:"1F1F9-1F1E6",shortnames:["flag-ta"]},{unified:"1F1F9-1F1E8",shortnames:["flag-tc"]},{unified:"1F1F9-1F1E9",shortnames:["flag-td"]},{unified:"1F1F9-1F1EB",shortnames:["flag-tf"]},{unified:"1F1F9-1F1EC",shortnames:["flag-tg"]},{unified:"1F1F9-1F1ED",shortnames:["flag-th"]},{unified:"1F1F9-1F1EF",shortnames:["flag-tj"]},{unified:"1F1F9-1F1F0",shortnames:["flag-tk"]},{unified:"1F1F9-1F1F1",shortnames:["flag-tl"]},{unified:"1F1F9-1F1F2",shortnames:["flag-tm"]},{unified:"1F1F9-1F1F3",shortnames:["flag-tn"]},{unified:"1F1F9-1F1F4",shortnames:["flag-to"]},{unified:"1F1F9-1F1F7",shortnames:["flag-tr"]},{unified:"1F1F9-1F1F9",shortnames:["flag-tt"]},{unified:"1F1F9-1F1FB",shortnames:["flag-tv"]},{unified:"1F1F9-1F1FC",shortnames:["flag-tw"]},{unified:"1F1F9-1F1FF",shortnames:["flag-tz"]},{unified:"1F1FA-1F1E6",shortnames:["flag-ua"]},{unified:"1F1FA-1F1EC",shortnames:["flag-ug"]},{unified:"1F1FA-1F1F2",shortnames:["flag-um"]},{unified:"1F1FA-1F1F3",shortnames:["flag-un"]},{unified:"1F1FA-1F1F8",shortnames:["us"]},{unified:"1F1FA-1F1FE",shortnames:["flag-uy"]},{unified:"1F1FA-1F1FF",shortnames:["flag-uz"]},{unified:"1F1FB-1F1E6",shortnames:["flag-va"]},{unified:"1F1FB-1F1E8",shortnames:["flag-vc"]},{unified:"1F1FB-1F1EA",shortnames:["flag-ve"]},{unified:"1F1FB-1F1EC",shortnames:["flag-vg"]},{unified:"1F1FB-1F1EE",shortnames:["flag-vi"]},{unified:"1F1FB-1F1F3",shortnames:["flag-vn"]},{unified:"1F1FB-1F1FA",shortnames:["flag-vu"]},{unified:"1F1FC-1F1EB",shortnames:["flag-wf"]},{unified:"1F1FC-1F1F8",shortnames:["flag-ws"]},{unified:"1F1FD-1F1F0",shortnames:["flag-xk"]},{unified:"1F1FE-1F1EA",shortnames:["flag-ye"]},{unified:"1F1FE-1F1F9",shortnames:["flag-yt"]},{unified:"1F1FF-1F1E6",shortnames:["flag-za"]},{unified:"1F1FF-1F1F2",shortnames:["flag-zm"]},{unified:"1F1FF-1F1FC",shortnames:["flag-zw"]},{unified:"1F3F4-E0067-E0062-E0065-E006E-E0067-E007F",shortnames:["flag-england"]},{unified:"1F3F4-E0067-E0062-E0073-E0063-E0074-E007F",shortnames:["flag-scotland"]},{unified:"1F3F4-E0067-E0062-E0077-E006C-E0073-E007F",shortnames:["flag-wales"]}]}];F.byShortName={hash:"0023-FE0F-20E3",keycap_star:"002A-FE0F-20E3",zero:"0030-FE0F-20E3",one:"0031-FE0F-20E3",two:"0032-FE0F-20E3",three:"0033-FE0F-20E3",four:"0034-FE0F-20E3",five:"0035-FE0F-20E3",six:"0036-FE0F-20E3",seven:"0037-FE0F-20E3",eight:"0038-FE0F-20E3",nine:"0039-FE0F-20E3",copyright:"00A9-FE0F",registered:"00AE-FE0F",mahjong:"1F004",black_joker:"1F0CF",a:"1F170-FE0F",b:"1F171-FE0F",o2:"1F17E-FE0F",parking:"1F17F-FE0F",ab:"1F18E",cl:"1F191",cool:"1F192",free:"1F193",id:"1F194",new:"1F195",ng:"1F196",ok:"1F197",sos:"1F198",up:"1F199",vs:"1F19A","flag-ac":"1F1E6-1F1E8","flag-ad":"1F1E6-1F1E9","flag-ae":"1F1E6-1F1EA","flag-af":"1F1E6-1F1EB","flag-ag":"1F1E6-1F1EC","flag-ai":"1F1E6-1F1EE","flag-al":"1F1E6-1F1F1","flag-am":"1F1E6-1F1F2","flag-ao":"1F1E6-1F1F4","flag-aq":"1F1E6-1F1F6","flag-ar":"1F1E6-1F1F7","flag-as":"1F1E6-1F1F8","flag-at":"1F1E6-1F1F9","flag-au":"1F1E6-1F1FA","flag-aw":"1F1E6-1F1FC","flag-ax":"1F1E6-1F1FD","flag-az":"1F1E6-1F1FF","flag-ba":"1F1E7-1F1E6","flag-bb":"1F1E7-1F1E7","flag-bd":"1F1E7-1F1E9","flag-be":"1F1E7-1F1EA","flag-bf":"1F1E7-1F1EB","flag-bg":"1F1E7-1F1EC","flag-bh":"1F1E7-1F1ED","flag-bi":"1F1E7-1F1EE","flag-bj":"1F1E7-1F1EF","flag-bl":"1F1E7-1F1F1","flag-bm":"1F1E7-1F1F2","flag-bn":"1F1E7-1F1F3","flag-bo":"1F1E7-1F1F4","flag-bq":"1F1E7-1F1F6","flag-br":"1F1E7-1F1F7","flag-bs":"1F1E7-1F1F8","flag-bt":"1F1E7-1F1F9","flag-bv":"1F1E7-1F1FB","flag-bw":"1F1E7-1F1FC","flag-by":"1F1E7-1F1FE","flag-bz":"1F1E7-1F1FF","flag-ca":"1F1E8-1F1E6","flag-cc":"1F1E8-1F1E8","flag-cd":"1F1E8-1F1E9","flag-cf":"1F1E8-1F1EB","flag-cg":"1F1E8-1F1EC","flag-ch":"1F1E8-1F1ED","flag-ci":"1F1E8-1F1EE","flag-ck":"1F1E8-1F1F0","flag-cl":"1F1E8-1F1F1","flag-cm":"1F1E8-1F1F2",cn:"1F1E8-1F1F3","flag-co":"1F1E8-1F1F4","flag-cp":"1F1E8-1F1F5","flag-cr":"1F1E8-1F1F7","flag-cu":"1F1E8-1F1FA","flag-cv":"1F1E8-1F1FB","flag-cw":"1F1E8-1F1FC","flag-cx":"1F1E8-1F1FD","flag-cy":"1F1E8-1F1FE","flag-cz":"1F1E8-1F1FF",de:"1F1E9-1F1EA","flag-dg":"1F1E9-1F1EC","flag-dj":"1F1E9-1F1EF","flag-dk":"1F1E9-1F1F0","flag-dm":"1F1E9-1F1F2","flag-do":"1F1E9-1F1F4","flag-dz":"1F1E9-1F1FF","flag-ea":"1F1EA-1F1E6","flag-ec":"1F1EA-1F1E8","flag-ee":"1F1EA-1F1EA","flag-eg":"1F1EA-1F1EC","flag-eh":"1F1EA-1F1ED","flag-er":"1F1EA-1F1F7",es:"1F1EA-1F1F8","flag-et":"1F1EA-1F1F9","flag-eu":"1F1EA-1F1FA","flag-fi":"1F1EB-1F1EE","flag-fj":"1F1EB-1F1EF","flag-fk":"1F1EB-1F1F0","flag-fm":"1F1EB-1F1F2","flag-fo":"1F1EB-1F1F4",fr:"1F1EB-1F1F7","flag-ga":"1F1EC-1F1E6",gb:"1F1EC-1F1E7","flag-gd":"1F1EC-1F1E9","flag-ge":"1F1EC-1F1EA","flag-gf":"1F1EC-1F1EB","flag-gg":"1F1EC-1F1EC","flag-gh":"1F1EC-1F1ED","flag-gi":"1F1EC-1F1EE","flag-gl":"1F1EC-1F1F1","flag-gm":"1F1EC-1F1F2","flag-gn":"1F1EC-1F1F3","flag-gp":"1F1EC-1F1F5","flag-gq":"1F1EC-1F1F6","flag-gr":"1F1EC-1F1F7","flag-gs":"1F1EC-1F1F8","flag-gt":"1F1EC-1F1F9","flag-gu":"1F1EC-1F1FA","flag-gw":"1F1EC-1F1FC","flag-gy":"1F1EC-1F1FE","flag-hk":"1F1ED-1F1F0","flag-hm":"1F1ED-1F1F2","flag-hn":"1F1ED-1F1F3","flag-hr":"1F1ED-1F1F7","flag-ht":"1F1ED-1F1F9","flag-hu":"1F1ED-1F1FA","flag-ic":"1F1EE-1F1E8","flag-id":"1F1EE-1F1E9","flag-ie":"1F1EE-1F1EA","flag-il":"1F1EE-1F1F1","flag-im":"1F1EE-1F1F2","flag-in":"1F1EE-1F1F3","flag-io":"1F1EE-1F1F4","flag-iq":"1F1EE-1F1F6","flag-ir":"1F1EE-1F1F7","flag-is":"1F1EE-1F1F8",it:"1F1EE-1F1F9","flag-je":"1F1EF-1F1EA","flag-jm":"1F1EF-1F1F2","flag-jo":"1F1EF-1F1F4",jp:"1F1EF-1F1F5","flag-ke":"1F1F0-1F1EA","flag-kg":"1F1F0-1F1EC","flag-kh":"1F1F0-1F1ED","flag-ki":"1F1F0-1F1EE","flag-km":"1F1F0-1F1F2","flag-kn":"1F1F0-1F1F3","flag-kp":"1F1F0-1F1F5",kr:"1F1F0-1F1F7","flag-kw":"1F1F0-1F1FC","flag-ky":"1F1F0-1F1FE","flag-kz":"1F1F0-1F1FF","flag-la":"1F1F1-1F1E6","flag-lb":"1F1F1-1F1E7","flag-lc":"1F1F1-1F1E8","flag-li":"1F1F1-1F1EE","flag-lk":"1F1F1-1F1F0","flag-lr":"1F1F1-1F1F7","flag-ls":"1F1F1-1F1F8","flag-lt":"1F1F1-1F1F9","flag-lu":"1F1F1-1F1FA","flag-lv":"1F1F1-1F1FB","flag-ly":"1F1F1-1F1FE","flag-ma":"1F1F2-1F1E6","flag-mc":"1F1F2-1F1E8","flag-md":"1F1F2-1F1E9","flag-me":"1F1F2-1F1EA","flag-mf":"1F1F2-1F1EB","flag-mg":"1F1F2-1F1EC","flag-mh":"1F1F2-1F1ED","flag-mk":"1F1F2-1F1F0","flag-ml":"1F1F2-1F1F1","flag-mm":"1F1F2-1F1F2","flag-mn":"1F1F2-1F1F3","flag-mo":"1F1F2-1F1F4","flag-mp":"1F1F2-1F1F5","flag-mq":"1F1F2-1F1F6","flag-mr":"1F1F2-1F1F7","flag-ms":"1F1F2-1F1F8","flag-mt":"1F1F2-1F1F9","flag-mu":"1F1F2-1F1FA","flag-mv":"1F1F2-1F1FB","flag-mw":"1F1F2-1F1FC","flag-mx":"1F1F2-1F1FD","flag-my":"1F1F2-1F1FE","flag-mz":"1F1F2-1F1FF","flag-na":"1F1F3-1F1E6","flag-nc":"1F1F3-1F1E8","flag-ne":"1F1F3-1F1EA","flag-nf":"1F1F3-1F1EB","flag-ng":"1F1F3-1F1EC","flag-ni":"1F1F3-1F1EE","flag-nl":"1F1F3-1F1F1","flag-no":"1F1F3-1F1F4","flag-np":"1F1F3-1F1F5","flag-nr":"1F1F3-1F1F7","flag-nu":"1F1F3-1F1FA","flag-nz":"1F1F3-1F1FF","flag-om":"1F1F4-1F1F2","flag-pa":"1F1F5-1F1E6","flag-pe":"1F1F5-1F1EA","flag-pf":"1F1F5-1F1EB","flag-pg":"1F1F5-1F1EC","flag-ph":"1F1F5-1F1ED","flag-pk":"1F1F5-1F1F0","flag-pl":"1F1F5-1F1F1","flag-pm":"1F1F5-1F1F2","flag-pn":"1F1F5-1F1F3","flag-pr":"1F1F5-1F1F7","flag-ps":"1F1F5-1F1F8","flag-pt":"1F1F5-1F1F9","flag-pw":"1F1F5-1F1FC","flag-py":"1F1F5-1F1FE","flag-qa":"1F1F6-1F1E6","flag-re":"1F1F7-1F1EA","flag-ro":"1F1F7-1F1F4","flag-rs":"1F1F7-1F1F8",ru:"1F1F7-1F1FA","flag-rw":"1F1F7-1F1FC","flag-sa":"1F1F8-1F1E6","flag-sb":"1F1F8-1F1E7","flag-sc":"1F1F8-1F1E8","flag-sd":"1F1F8-1F1E9","flag-se":"1F1F8-1F1EA","flag-sg":"1F1F8-1F1EC","flag-sh":"1F1F8-1F1ED","flag-si":"1F1F8-1F1EE","flag-sj":"1F1F8-1F1EF","flag-sk":"1F1F8-1F1F0","flag-sl":"1F1F8-1F1F1","flag-sm":"1F1F8-1F1F2","flag-sn":"1F1F8-1F1F3","flag-so":"1F1F8-1F1F4","flag-sr":"1F1F8-1F1F7","flag-ss":"1F1F8-1F1F8","flag-st":"1F1F8-1F1F9","flag-sv":"1F1F8-1F1FB","flag-sx":"1F1F8-1F1FD","flag-sy":"1F1F8-1F1FE","flag-sz":"1F1F8-1F1FF","flag-ta":"1F1F9-1F1E6","flag-tc":"1F1F9-1F1E8","flag-td":"1F1F9-1F1E9","flag-tf":"1F1F9-1F1EB","flag-tg":"1F1F9-1F1EC","flag-th":"1F1F9-1F1ED","flag-tj":"1F1F9-1F1EF","flag-tk":"1F1F9-1F1F0","flag-tl":"1F1F9-1F1F1","flag-tm":"1F1F9-1F1F2","flag-tn":"1F1F9-1F1F3","flag-to":"1F1F9-1F1F4","flag-tr":"1F1F9-1F1F7","flag-tt":"1F1F9-1F1F9","flag-tv":"1F1F9-1F1FB","flag-tw":"1F1F9-1F1FC","flag-tz":"1F1F9-1F1FF","flag-ua":"1F1FA-1F1E6","flag-ug":"1F1FA-1F1EC","flag-um":"1F1FA-1F1F2","flag-un":"1F1FA-1F1F3",us:"1F1FA-1F1F8","flag-uy":"1F1FA-1F1FE","flag-uz":"1F1FA-1F1FF","flag-va":"1F1FB-1F1E6","flag-vc":"1F1FB-1F1E8","flag-ve":"1F1FB-1F1EA","flag-vg":"1F1FB-1F1EC","flag-vi":"1F1FB-1F1EE","flag-vn":"1F1FB-1F1F3","flag-vu":"1F1FB-1F1FA","flag-wf":"1F1FC-1F1EB","flag-ws":"1F1FC-1F1F8","flag-xk":"1F1FD-1F1F0","flag-ye":"1F1FE-1F1EA","flag-yt":"1F1FE-1F1F9","flag-za":"1F1FF-1F1E6","flag-zm":"1F1FF-1F1F2","flag-zw":"1F1FF-1F1FC",koko:"1F201",sa:"1F202-FE0F",u7121:"1F21A",u6307:"1F22F",u7981:"1F232",u7a7a:"1F233",u5408:"1F234",u6e80:"1F235",u6709:"1F236",u6708:"1F237-FE0F",u7533:"1F238",u5272:"1F239",u55b6:"1F23A",ideograph_advantage:"1F250",accept:"1F251",cyclone:"1F300",foggy:"1F301",closed_umbrella:"1F302",night_with_stars:"1F303",sunrise_over_mountains:"1F304",sunrise:"1F305",city_sunset:"1F306",city_sunrise:"1F307",rainbow:"1F308",bridge_at_night:"1F309",ocean:"1F30A",volcano:"1F30B",milky_way:"1F30C",earth_africa:"1F30D",earth_americas:"1F30E",earth_asia:"1F30F",globe_with_meridians:"1F310",new_moon:"1F311",waxing_crescent_moon:"1F312",first_quarter_moon:"1F313",moon:"1F314",full_moon:"1F315",waning_gibbous_moon:"1F316",last_quarter_moon:"1F317",waning_crescent_moon:"1F318",crescent_moon:"1F319",new_moon_with_face:"1F31A",first_quarter_moon_with_face:"1F31B",last_quarter_moon_with_face:"1F31C",full_moon_with_face:"1F31D",sun_with_face:"1F31E",star2:"1F31F",stars:"1F320",thermometer:"1F321-FE0F",mostly_sunny:"1F324-FE0F",barely_sunny:"1F325-FE0F",partly_sunny_rain:"1F326-FE0F",rain_cloud:"1F327-FE0F",snow_cloud:"1F328-FE0F",lightning:"1F329-FE0F",tornado:"1F32A-FE0F",fog:"1F32B-FE0F",wind_blowing_face:"1F32C-FE0F",hotdog:"1F32D",taco:"1F32E",burrito:"1F32F",chestnut:"1F330",seedling:"1F331",evergreen_tree:"1F332",deciduous_tree:"1F333",palm_tree:"1F334",cactus:"1F335",hot_pepper:"1F336-FE0F",tulip:"1F337",cherry_blossom:"1F338",rose:"1F339",hibiscus:"1F33A",sunflower:"1F33B",blossom:"1F33C",corn:"1F33D",ear_of_rice:"1F33E",herb:"1F33F",four_leaf_clover:"1F340",maple_leaf:"1F341",fallen_leaf:"1F342",leaves:"1F343",mushroom:"1F344",tomato:"1F345",eggplant:"1F346",grapes:"1F347",melon:"1F348",watermelon:"1F349",tangerine:"1F34A",lemon:"1F34B",banana:"1F34C",pineapple:"1F34D",apple:"1F34E",green_apple:"1F34F",pear:"1F350",peach:"1F351",cherries:"1F352",strawberry:"1F353",hamburger:"1F354",pizza:"1F355",meat_on_bone:"1F356",poultry_leg:"1F357",rice_cracker:"1F358",rice_ball:"1F359",rice:"1F35A",curry:"1F35B",ramen:"1F35C",spaghetti:"1F35D",bread:"1F35E",fries:"1F35F",sweet_potato:"1F360",dango:"1F361",oden:"1F362",sushi:"1F363",fried_shrimp:"1F364",fish_cake:"1F365",icecream:"1F366",shaved_ice:"1F367",ice_cream:"1F368",doughnut:"1F369",cookie:"1F36A",chocolate_bar:"1F36B",candy:"1F36C",lollipop:"1F36D",custard:"1F36E",honey_pot:"1F36F",cake:"1F370",bento:"1F371",stew:"1F372",fried_egg:"1F373",fork_and_knife:"1F374",tea:"1F375",sake:"1F376",wine_glass:"1F377",cocktail:"1F378",tropical_drink:"1F379",beer:"1F37A",beers:"1F37B",baby_bottle:"1F37C",knife_fork_plate:"1F37D-FE0F",champagne:"1F37E",popcorn:"1F37F",ribbon:"1F380",gift:"1F381",birthday:"1F382",jack_o_lantern:"1F383",christmas_tree:"1F384",santa:"1F385",fireworks:"1F386",sparkler:"1F387",balloon:"1F388",tada:"1F389",confetti_ball:"1F38A",tanabata_tree:"1F38B",crossed_flags:"1F38C",bamboo:"1F38D",dolls:"1F38E",flags:"1F38F",wind_chime:"1F390",rice_scene:"1F391",school_satchel:"1F392",mortar_board:"1F393",medal:"1F396-FE0F",reminder_ribbon:"1F397-FE0F",studio_microphone:"1F399-FE0F",level_slider:"1F39A-FE0F",control_knobs:"1F39B-FE0F",film_frames:"1F39E-FE0F",admission_tickets:"1F39F-FE0F",carousel_horse:"1F3A0",ferris_wheel:"1F3A1",roller_coaster:"1F3A2",fishing_pole_and_fish:"1F3A3",microphone:"1F3A4",movie_camera:"1F3A5",cinema:"1F3A6",headphones:"1F3A7",art:"1F3A8",tophat:"1F3A9",circus_tent:"1F3AA",ticket:"1F3AB",clapper:"1F3AC",performing_arts:"1F3AD",video_game:"1F3AE",dart:"1F3AF",slot_machine:"1F3B0","8ball":"1F3B1",game_die:"1F3B2",bowling:"1F3B3",flower_playing_cards:"1F3B4",musical_note:"1F3B5",notes:"1F3B6",saxophone:"1F3B7",guitar:"1F3B8",musical_keyboard:"1F3B9",trumpet:"1F3BA",violin:"1F3BB",musical_score:"1F3BC",running_shirt_with_sash:"1F3BD",tennis:"1F3BE",ski:"1F3BF",basketball:"1F3C0",checkered_flag:"1F3C1",snowboarder:"1F3C2","woman-running":"1F3C3-200D-2640-FE0F","man-running":"1F3C3-200D-2642-FE0F",runner:"1F3C3-200D-2642-FE0F","woman-surfing":"1F3C4-200D-2640-FE0F","man-surfing":"1F3C4-200D-2642-FE0F",surfer:"1F3C4-200D-2642-FE0F",sports_medal:"1F3C5",trophy:"1F3C6",horse_racing:"1F3C7",football:"1F3C8",rugby_football:"1F3C9","woman-swimming":"1F3CA-200D-2640-FE0F","man-swimming":"1F3CA-200D-2642-FE0F",swimmer:"1F3CA-200D-2642-FE0F","woman-lifting-weights":"1F3CB-FE0F-200D-2640-FE0F","man-lifting-weights":"1F3CB-FE0F-200D-2642-FE0F",weight_lifter:"1F3CB-FE0F-200D-2642-FE0F","woman-golfing":"1F3CC-FE0F-200D-2640-FE0F","man-golfing":"1F3CC-FE0F-200D-2642-FE0F",golfer:"1F3CC-FE0F-200D-2642-FE0F",racing_motorcycle:"1F3CD-FE0F",racing_car:"1F3CE-FE0F",cricket_bat_and_ball:"1F3CF",volleyball:"1F3D0",field_hockey_stick_and_ball:"1F3D1",ice_hockey_stick_and_puck:"1F3D2",table_tennis_paddle_and_ball:"1F3D3",snow_capped_mountain:"1F3D4-FE0F",camping:"1F3D5-FE0F",beach_with_umbrella:"1F3D6-FE0F",building_construction:"1F3D7-FE0F",house_buildings:"1F3D8-FE0F",cityscape:"1F3D9-FE0F",derelict_house_building:"1F3DA-FE0F",classical_building:"1F3DB-FE0F",desert:"1F3DC-FE0F",desert_island:"1F3DD-FE0F",national_park:"1F3DE-FE0F",stadium:"1F3DF-FE0F",house:"1F3E0",house_with_garden:"1F3E1",office:"1F3E2",post_office:"1F3E3",european_post_office:"1F3E4",hospital:"1F3E5",bank:"1F3E6",atm:"1F3E7",hotel:"1F3E8",love_hotel:"1F3E9",convenience_store:"1F3EA",school:"1F3EB",department_store:"1F3EC",factory:"1F3ED",izakaya_lantern:"1F3EE",japanese_castle:"1F3EF",european_castle:"1F3F0","rainbow-flag":"1F3F3-FE0F-200D-1F308",waving_white_flag:"1F3F3-FE0F","flag-england":"1F3F4-E0067-E0062-E0065-E006E-E0067-E007F","flag-scotland":"1F3F4-E0067-E0062-E0073-E0063-E0074-E007F","flag-wales":"1F3F4-E0067-E0062-E0077-E006C-E0073-E007F",waving_black_flag:"1F3F4",rosette:"1F3F5-FE0F",label:"1F3F7-FE0F",badminton_racquet_and_shuttlecock:"1F3F8",bow_and_arrow:"1F3F9",amphora:"1F3FA","skin-tone-2":"1F3FB","skin-tone-3":"1F3FC","skin-tone-4":"1F3FD","skin-tone-5":"1F3FE","skin-tone-6":"1F3FF",rat:"1F400",mouse2:"1F401",ox:"1F402",water_buffalo:"1F403",cow2:"1F404",tiger2:"1F405",leopard:"1F406",rabbit2:"1F407",cat2:"1F408",dragon:"1F409",crocodile:"1F40A",whale2:"1F40B",snail:"1F40C",snake:"1F40D",racehorse:"1F40E",ram:"1F40F",goat:"1F410",sheep:"1F411",monkey:"1F412",rooster:"1F413",chicken:"1F414",dog2:"1F415",pig2:"1F416",boar:"1F417",elephant:"1F418",octopus:"1F419",shell:"1F41A",bug:"1F41B",ant:"1F41C",bee:"1F41D",beetle:"1F41E",fish:"1F41F",tropical_fish:"1F420",blowfish:"1F421",turtle:"1F422",hatching_chick:"1F423",baby_chick:"1F424",hatched_chick:"1F425",bird:"1F426",penguin:"1F427",koala:"1F428",poodle:"1F429",dromedary_camel:"1F42A",camel:"1F42B",dolphin:"1F42C",mouse:"1F42D",cow:"1F42E",tiger:"1F42F",rabbit:"1F430",cat:"1F431",dragon_face:"1F432",whale:"1F433",horse:"1F434",monkey_face:"1F435",dog:"1F436",pig:"1F437",frog:"1F438",hamster:"1F439",wolf:"1F43A",bear:"1F43B",panda_face:"1F43C",pig_nose:"1F43D",feet:"1F43E",chipmunk:"1F43F-FE0F",eyes:"1F440","eye-in-speech-bubble":"1F441-FE0F-200D-1F5E8-FE0F",eye:"1F441-FE0F",ear:"1F442",nose:"1F443",lips:"1F444",tongue:"1F445",point_up_2:"1F446",point_down:"1F447",point_left:"1F448",point_right:"1F449",facepunch:"1F44A",wave:"1F44B",ok_hand:"1F44C","+1":"1F44D","-1":"1F44E",clap:"1F44F",open_hands:"1F450",crown:"1F451",womans_hat:"1F452",eyeglasses:"1F453",necktie:"1F454",shirt:"1F455",jeans:"1F456",dress:"1F457",kimono:"1F458",bikini:"1F459",womans_clothes:"1F45A",purse:"1F45B",handbag:"1F45C",pouch:"1F45D",mans_shoe:"1F45E",athletic_shoe:"1F45F",high_heel:"1F460",sandal:"1F461",boot:"1F462",footprints:"1F463",bust_in_silhouette:"1F464",busts_in_silhouette:"1F465",boy:"1F466",girl:"1F467","male-farmer":"1F468-200D-1F33E","male-cook":"1F468-200D-1F373","male-student":"1F468-200D-1F393","male-singer":"1F468-200D-1F3A4","male-artist":"1F468-200D-1F3A8","male-teacher":"1F468-200D-1F3EB","male-factory-worker":"1F468-200D-1F3ED","man-boy-boy":"1F468-200D-1F466-200D-1F466","man-boy":"1F468-200D-1F466","man-girl-boy":"1F468-200D-1F467-200D-1F466","man-girl-girl":"1F468-200D-1F467-200D-1F467","man-girl":"1F468-200D-1F467","man-man-boy":"1F468-200D-1F468-200D-1F466","man-man-boy-boy":"1F468-200D-1F468-200D-1F466-200D-1F466","man-man-girl":"1F468-200D-1F468-200D-1F467","man-man-girl-boy":"1F468-200D-1F468-200D-1F467-200D-1F466","man-man-girl-girl":"1F468-200D-1F468-200D-1F467-200D-1F467","man-woman-boy":"1F468-200D-1F469-200D-1F466","man-woman-boy-boy":"1F468-200D-1F469-200D-1F466-200D-1F466","man-woman-girl":"1F468-200D-1F469-200D-1F467","man-woman-girl-boy":"1F468-200D-1F469-200D-1F467-200D-1F466","man-woman-girl-girl":"1F468-200D-1F469-200D-1F467-200D-1F467","male-technologist":"1F468-200D-1F4BB","male-office-worker":"1F468-200D-1F4BC","male-mechanic":"1F468-200D-1F527","male-scientist":"1F468-200D-1F52C","male-astronaut":"1F468-200D-1F680","male-firefighter":"1F468-200D-1F692","male-doctor":"1F468-200D-2695-FE0F","male-judge":"1F468-200D-2696-FE0F","male-pilot":"1F468-200D-2708-FE0F","man-heart-man":"1F468-200D-2764-FE0F-200D-1F468","man-kiss-man":"1F468-200D-2764-FE0F-200D-1F48B-200D-1F468",man:"1F468","female-farmer":"1F469-200D-1F33E","female-cook":"1F469-200D-1F373","female-student":"1F469-200D-1F393","female-singer":"1F469-200D-1F3A4","female-artist":"1F469-200D-1F3A8","female-teacher":"1F469-200D-1F3EB","female-factory-worker":"1F469-200D-1F3ED","woman-boy-boy":"1F469-200D-1F466-200D-1F466","woman-boy":"1F469-200D-1F466","woman-girl-boy":"1F469-200D-1F467-200D-1F466","woman-girl-girl":"1F469-200D-1F467-200D-1F467","woman-girl":"1F469-200D-1F467","woman-woman-boy":"1F469-200D-1F469-200D-1F466","woman-woman-boy-boy":"1F469-200D-1F469-200D-1F466-200D-1F466","woman-woman-girl":"1F469-200D-1F469-200D-1F467","woman-woman-girl-boy":"1F469-200D-1F469-200D-1F467-200D-1F466","woman-woman-girl-girl":"1F469-200D-1F469-200D-1F467-200D-1F467","female-technologist":"1F469-200D-1F4BB","female-office-worker":"1F469-200D-1F4BC","female-mechanic":"1F469-200D-1F527","female-scientist":"1F469-200D-1F52C","female-astronaut":"1F469-200D-1F680","female-firefighter":"1F469-200D-1F692","female-doctor":"1F469-200D-2695-FE0F","female-judge":"1F469-200D-2696-FE0F","female-pilot":"1F469-200D-2708-FE0F","woman-heart-man":"1F469-200D-2764-FE0F-200D-1F468","woman-heart-woman":"1F469-200D-2764-FE0F-200D-1F469","woman-kiss-man":"1F469-200D-2764-FE0F-200D-1F48B-200D-1F468","woman-kiss-woman":"1F469-200D-2764-FE0F-200D-1F48B-200D-1F469",woman:"1F469",family:"1F468-200D-1F469-200D-1F466",couple:"1F46B",two_men_holding_hands:"1F46C",two_women_holding_hands:"1F46D","female-police-officer":"1F46E-200D-2640-FE0F","male-police-officer":"1F46E-200D-2642-FE0F",cop:"1F46E-200D-2642-FE0F","woman-with-bunny-ears-partying":"1F46F-200D-2640-FE0F","man-with-bunny-ears-partying":"1F46F-200D-2642-FE0F",dancers:"1F46F-200D-2640-FE0F",bride_with_veil:"1F470","blond-haired-woman":"1F471-200D-2640-FE0F","blond-haired-man":"1F471-200D-2642-FE0F",person_with_blond_hair:"1F471-200D-2642-FE0F",man_with_gua_pi_mao:"1F472","woman-wearing-turban":"1F473-200D-2640-FE0F","man-wearing-turban":"1F473-200D-2642-FE0F",man_with_turban:"1F473-200D-2642-FE0F",older_man:"1F474",older_woman:"1F475",baby:"1F476","female-construction-worker":"1F477-200D-2640-FE0F","male-construction-worker":"1F477-200D-2642-FE0F",construction_worker:"1F477-200D-2642-FE0F",princess:"1F478",japanese_ogre:"1F479",japanese_goblin:"1F47A",ghost:"1F47B",angel:"1F47C",alien:"1F47D",space_invader:"1F47E",imp:"1F47F",skull:"1F480","woman-tipping-hand":"1F481-200D-2640-FE0F","man-tipping-hand":"1F481-200D-2642-FE0F",information_desk_person:"1F481-200D-2640-FE0F","female-guard":"1F482-200D-2640-FE0F","male-guard":"1F482-200D-2642-FE0F",guardsman:"1F482-200D-2642-FE0F",dancer:"1F483",lipstick:"1F484",nail_care:"1F485","woman-getting-massage":"1F486-200D-2640-FE0F","man-getting-massage":"1F486-200D-2642-FE0F",massage:"1F486-200D-2640-FE0F","woman-getting-haircut":"1F487-200D-2640-FE0F","man-getting-haircut":"1F487-200D-2642-FE0F",haircut:"1F487-200D-2640-FE0F",barber:"1F488",syringe:"1F489",pill:"1F48A",kiss:"1F48B",love_letter:"1F48C",ring:"1F48D",gem:"1F48E",couplekiss:"1F469-200D-2764-FE0F-200D-1F48B-200D-1F468",bouquet:"1F490",couple_with_heart:"1F469-200D-2764-FE0F-200D-1F468",wedding:"1F492",heartbeat:"1F493",broken_heart:"1F494",two_hearts:"1F495",sparkling_heart:"1F496",heartpulse:"1F497",cupid:"1F498",blue_heart:"1F499",green_heart:"1F49A",yellow_heart:"1F49B",purple_heart:"1F49C",gift_heart:"1F49D",revolving_hearts:"1F49E",heart_decoration:"1F49F",diamond_shape_with_a_dot_inside:"1F4A0",bulb:"1F4A1",anger:"1F4A2",bomb:"1F4A3",zzz:"1F4A4",boom:"1F4A5",sweat_drops:"1F4A6",droplet:"1F4A7",dash:"1F4A8",hankey:"1F4A9",muscle:"1F4AA",dizzy:"1F4AB",speech_balloon:"1F4AC",thought_balloon:"1F4AD",white_flower:"1F4AE",100:"1F4AF",moneybag:"1F4B0",currency_exchange:"1F4B1",heavy_dollar_sign:"1F4B2",credit_card:"1F4B3",yen:"1F4B4",dollar:"1F4B5",euro:"1F4B6",pound:"1F4B7",money_with_wings:"1F4B8",chart:"1F4B9",seat:"1F4BA",computer:"1F4BB",briefcase:"1F4BC",minidisc:"1F4BD",floppy_disk:"1F4BE",cd:"1F4BF",dvd:"1F4C0",file_folder:"1F4C1",open_file_folder:"1F4C2",page_with_curl:"1F4C3",page_facing_up:"1F4C4",date:"1F4C5",calendar:"1F4C6",card_index:"1F4C7",chart_with_upwards_trend:"1F4C8",chart_with_downwards_trend:"1F4C9",bar_chart:"1F4CA",clipboard:"1F4CB",pushpin:"1F4CC",round_pushpin:"1F4CD",paperclip:"1F4CE",straight_ruler:"1F4CF",triangular_ruler:"1F4D0",bookmark_tabs:"1F4D1",ledger:"1F4D2",notebook:"1F4D3",notebook_with_decorative_cover:"1F4D4",closed_book:"1F4D5",book:"1F4D6",green_book:"1F4D7",blue_book:"1F4D8",orange_book:"1F4D9",books:"1F4DA",name_badge:"1F4DB",scroll:"1F4DC",memo:"1F4DD",telephone_receiver:"1F4DE",pager:"1F4DF",fax:"1F4E0",satellite_antenna:"1F4E1",loudspeaker:"1F4E2",mega:"1F4E3",outbox_tray:"1F4E4",inbox_tray:"1F4E5",package:"1F4E6","e-mail":"1F4E7",incoming_envelope:"1F4E8",envelope_with_arrow:"1F4E9",mailbox_closed:"1F4EA",mailbox:"1F4EB",mailbox_with_mail:"1F4EC",mailbox_with_no_mail:"1F4ED",postbox:"1F4EE",postal_horn:"1F4EF",newspaper:"1F4F0",iphone:"1F4F1",calling:"1F4F2",vibration_mode:"1F4F3",mobile_phone_off:"1F4F4",no_mobile_phones:"1F4F5",signal_strength:"1F4F6",camera:"1F4F7",camera_with_flash:"1F4F8",video_camera:"1F4F9",tv:"1F4FA",radio:"1F4FB",vhs:"1F4FC",film_projector:"1F4FD-FE0F",prayer_beads:"1F4FF",twisted_rightwards_arrows:"1F500",repeat:"1F501",repeat_one:"1F502",arrows_clockwise:"1F503",arrows_counterclockwise:"1F504",low_brightness:"1F505",high_brightness:"1F506",mute:"1F507",speaker:"1F508",sound:"1F509",loud_sound:"1F50A",battery:"1F50B",electric_plug:"1F50C",mag:"1F50D",mag_right:"1F50E",lock_with_ink_pen:"1F50F",closed_lock_with_key:"1F510",key:"1F511",lock:"1F512",unlock:"1F513",bell:"1F514",no_bell:"1F515",bookmark:"1F516",link:"1F517",radio_button:"1F518",back:"1F519",end:"1F51A",on:"1F51B",soon:"1F51C",top:"1F51D",underage:"1F51E",keycap_ten:"1F51F",capital_abcd:"1F520",abcd:"1F521",1234:"1F522",symbols:"1F523",abc:"1F524",fire:"1F525",flashlight:"1F526",wrench:"1F527",hammer:"1F528",nut_and_bolt:"1F529",hocho:"1F52A",gun:"1F52B",microscope:"1F52C",telescope:"1F52D",crystal_ball:"1F52E",six_pointed_star:"1F52F",beginner:"1F530",trident:"1F531",black_square_button:"1F532",white_square_button:"1F533",red_circle:"1F534",large_blue_circle:"1F535",large_orange_diamond:"1F536",large_blue_diamond:"1F537",small_orange_diamond:"1F538",small_blue_diamond:"1F539",small_red_triangle:"1F53A",small_red_triangle_down:"1F53B",arrow_up_small:"1F53C",arrow_down_small:"1F53D",om_symbol:"1F549-FE0F",dove_of_peace:"1F54A-FE0F",kaaba:"1F54B",mosque:"1F54C",synagogue:"1F54D",menorah_with_nine_branches:"1F54E",clock1:"1F550",clock2:"1F551",clock3:"1F552",clock4:"1F553",clock5:"1F554",clock6:"1F555",clock7:"1F556",clock8:"1F557",clock9:"1F558",clock10:"1F559",clock11:"1F55A",clock12:"1F55B",clock130:"1F55C",clock230:"1F55D",clock330:"1F55E",clock430:"1F55F",clock530:"1F560",clock630:"1F561",clock730:"1F562",clock830:"1F563",clock930:"1F564",clock1030:"1F565",clock1130:"1F566",clock1230:"1F567",candle:"1F56F-FE0F",mantelpiece_clock:"1F570-FE0F",hole:"1F573-FE0F",man_in_business_suit_levitating:"1F574-FE0F","female-detective":"1F575-FE0F-200D-2640-FE0F","male-detective":"1F575-FE0F-200D-2642-FE0F",sleuth_or_spy:"1F575-FE0F-200D-2642-FE0F",dark_sunglasses:"1F576-FE0F",spider:"1F577-FE0F",spider_web:"1F578-FE0F",joystick:"1F579-FE0F",man_dancing:"1F57A",linked_paperclips:"1F587-FE0F",lower_left_ballpoint_pen:"1F58A-FE0F",lower_left_fountain_pen:"1F58B-FE0F",lower_left_paintbrush:"1F58C-FE0F",lower_left_crayon:"1F58D-FE0F",raised_hand_with_fingers_splayed:"1F590-FE0F",middle_finger:"1F595","spock-hand":"1F596",black_heart:"1F5A4",desktop_computer:"1F5A5-FE0F",printer:"1F5A8-FE0F",three_button_mouse:"1F5B1-FE0F",trackball:"1F5B2-FE0F",frame_with_picture:"1F5BC-FE0F",card_index_dividers:"1F5C2-FE0F",card_file_box:"1F5C3-FE0F",file_cabinet:"1F5C4-FE0F",wastebasket:"1F5D1-FE0F",spiral_note_pad:"1F5D2-FE0F",spiral_calendar_pad:"1F5D3-FE0F",compression:"1F5DC-FE0F",old_key:"1F5DD-FE0F",rolled_up_newspaper:"1F5DE-FE0F",dagger_knife:"1F5E1-FE0F",speaking_head_in_silhouette:"1F5E3-FE0F",left_speech_bubble:"1F5E8-FE0F",right_anger_bubble:"1F5EF-FE0F",ballot_box_with_ballot:"1F5F3-FE0F",world_map:"1F5FA-FE0F",mount_fuji:"1F5FB",tokyo_tower:"1F5FC",statue_of_liberty:"1F5FD",japan:"1F5FE",moyai:"1F5FF",grinning:"1F600",grin:"1F601",joy:"1F602",smiley:"1F603",smile:"1F604",sweat_smile:"1F605",laughing:"1F606",innocent:"1F607",smiling_imp:"1F608",wink:"1F609",blush:"1F60A",yum:"1F60B",relieved:"1F60C",heart_eyes:"1F60D",sunglasses:"1F60E",smirk:"1F60F",neutral_face:"1F610",expressionless:"1F611",unamused:"1F612",sweat:"1F613",pensive:"1F614",confused:"1F615",confounded:"1F616",kissing:"1F617",kissing_heart:"1F618",kissing_smiling_eyes:"1F619",kissing_closed_eyes:"1F61A",stuck_out_tongue:"1F61B",stuck_out_tongue_winking_eye:"1F61C",stuck_out_tongue_closed_eyes:"1F61D",disappointed:"1F61E",worried:"1F61F",angry:"1F620",rage:"1F621",cry:"1F622",persevere:"1F623",triumph:"1F624",disappointed_relieved:"1F625",frowning:"1F626",anguished:"1F627",fearful:"1F628",weary:"1F629",sleepy:"1F62A",tired_face:"1F62B",grimacing:"1F62C",sob:"1F62D",open_mouth:"1F62E",hushed:"1F62F",cold_sweat:"1F630",scream:"1F631",astonished:"1F632",flushed:"1F633",sleeping:"1F634",dizzy_face:"1F635",no_mouth:"1F636",mask:"1F637",smile_cat:"1F638",joy_cat:"1F639",smiley_cat:"1F63A",heart_eyes_cat:"1F63B",smirk_cat:"1F63C",kissing_cat:"1F63D",pouting_cat:"1F63E",crying_cat_face:"1F63F",scream_cat:"1F640",slightly_frowning_face:"1F641",slightly_smiling_face:"1F642",upside_down_face:"1F643",face_with_rolling_eyes:"1F644","woman-gesturing-no":"1F645-200D-2640-FE0F","man-gesturing-no":"1F645-200D-2642-FE0F",no_good:"1F645-200D-2640-FE0F","woman-gesturing-ok":"1F646-200D-2640-FE0F","man-gesturing-ok":"1F646-200D-2642-FE0F",ok_woman:"1F646-200D-2640-FE0F","woman-bowing":"1F647-200D-2640-FE0F","man-bowing":"1F647-200D-2642-FE0F",bow:"1F647-200D-2642-FE0F",see_no_evil:"1F648",hear_no_evil:"1F649",speak_no_evil:"1F64A","woman-raising-hand":"1F64B-200D-2640-FE0F","man-raising-hand":"1F64B-200D-2642-FE0F",raising_hand:"1F64B-200D-2640-FE0F",raised_hands:"1F64C","woman-frowning":"1F64D-200D-2640-FE0F","man-frowning":"1F64D-200D-2642-FE0F",person_frowning:"1F64D-200D-2640-FE0F","woman-pouting":"1F64E-200D-2640-FE0F","man-pouting":"1F64E-200D-2642-FE0F",person_with_pouting_face:"1F64E-200D-2640-FE0F",pray:"1F64F",rocket:"1F680",helicopter:"1F681",steam_locomotive:"1F682",railway_car:"1F683",bullettrain_side:"1F684",bullettrain_front:"1F685",train2:"1F686",metro:"1F687",light_rail:"1F688",station:"1F689",tram:"1F68A",train:"1F68B",bus:"1F68C",oncoming_bus:"1F68D",trolleybus:"1F68E",busstop:"1F68F",minibus:"1F690",ambulance:"1F691",fire_engine:"1F692",police_car:"1F693",oncoming_police_car:"1F694",taxi:"1F695",oncoming_taxi:"1F696",car:"1F697",oncoming_automobile:"1F698",blue_car:"1F699",truck:"1F69A",articulated_lorry:"1F69B",tractor:"1F69C",monorail:"1F69D",mountain_railway:"1F69E",suspension_railway:"1F69F",mountain_cableway:"1F6A0",aerial_tramway:"1F6A1",ship:"1F6A2","woman-rowing-boat":"1F6A3-200D-2640-FE0F","man-rowing-boat":"1F6A3-200D-2642-FE0F",rowboat:"1F6A3-200D-2642-FE0F",speedboat:"1F6A4",traffic_light:"1F6A5",vertical_traffic_light:"1F6A6",construction:"1F6A7",rotating_light:"1F6A8",triangular_flag_on_post:"1F6A9",door:"1F6AA",no_entry_sign:"1F6AB",smoking:"1F6AC",no_smoking:"1F6AD",put_litter_in_its_place:"1F6AE",do_not_litter:"1F6AF",potable_water:"1F6B0","non-potable_water":"1F6B1",bike:"1F6B2",no_bicycles:"1F6B3","woman-biking":"1F6B4-200D-2640-FE0F","man-biking":"1F6B4-200D-2642-FE0F",bicyclist:"1F6B4-200D-2642-FE0F","woman-mountain-biking":"1F6B5-200D-2640-FE0F","man-mountain-biking":"1F6B5-200D-2642-FE0F",mountain_bicyclist:"1F6B5-200D-2642-FE0F","woman-walking":"1F6B6-200D-2640-FE0F","man-walking":"1F6B6-200D-2642-FE0F",walking:"1F6B6-200D-2642-FE0F",no_pedestrians:"1F6B7",children_crossing:"1F6B8",mens:"1F6B9",womens:"1F6BA",restroom:"1F6BB",baby_symbol:"1F6BC",toilet:"1F6BD",wc:"1F6BE",shower:"1F6BF",bath:"1F6C0",bathtub:"1F6C1",passport_control:"1F6C2",customs:"1F6C3",baggage_claim:"1F6C4",left_luggage:"1F6C5",couch_and_lamp:"1F6CB-FE0F",sleeping_accommodation:"1F6CC",shopping_bags:"1F6CD-FE0F",bellhop_bell:"1F6CE-FE0F",bed:"1F6CF-FE0F",place_of_worship:"1F6D0",octagonal_sign:"1F6D1",shopping_trolley:"1F6D2",hammer_and_wrench:"1F6E0-FE0F",shield:"1F6E1-FE0F",oil_drum:"1F6E2-FE0F",motorway:"1F6E3-FE0F",railway_track:"1F6E4-FE0F",motor_boat:"1F6E5-FE0F",small_airplane:"1F6E9-FE0F",airplane_departure:"1F6EB",airplane_arriving:"1F6EC",satellite:"1F6F0-FE0F",passenger_ship:"1F6F3-FE0F",scooter:"1F6F4",motor_scooter:"1F6F5",canoe:"1F6F6",sled:"1F6F7",flying_saucer:"1F6F8",zipper_mouth_face:"1F910",money_mouth_face:"1F911",face_with_thermometer:"1F912",nerd_face:"1F913",thinking_face:"1F914",face_with_head_bandage:"1F915",robot_face:"1F916",hugging_face:"1F917",the_horns:"1F918",call_me_hand:"1F919",raised_back_of_hand:"1F91A","left-facing_fist":"1F91B","right-facing_fist":"1F91C",handshake:"1F91D",crossed_fingers:"1F91E",i_love_you_hand_sign:"1F91F",face_with_cowboy_hat:"1F920",clown_face:"1F921",nauseated_face:"1F922",rolling_on_the_floor_laughing:"1F923",drooling_face:"1F924",lying_face:"1F925","woman-facepalming":"1F926-200D-2640-FE0F","man-facepalming":"1F926-200D-2642-FE0F",face_palm:"1F926",sneezing_face:"1F927",face_with_raised_eyebrow:"1F928","star-struck":"1F929",zany_face:"1F92A",shushing_face:"1F92B",face_with_symbols_on_mouth:"1F92C",face_with_hand_over_mouth:"1F92D",face_vomiting:"1F92E",exploding_head:"1F92F",pregnant_woman:"1F930","breast-feeding":"1F931",palms_up_together:"1F932",selfie:"1F933",prince:"1F934",man_in_tuxedo:"1F935",mrs_claus:"1F936","woman-shrugging":"1F937-200D-2640-FE0F","man-shrugging":"1F937-200D-2642-FE0F",shrug:"1F937","woman-cartwheeling":"1F938-200D-2640-FE0F","man-cartwheeling":"1F938-200D-2642-FE0F",person_doing_cartwheel:"1F938","woman-juggling":"1F939-200D-2640-FE0F","man-juggling":"1F939-200D-2642-FE0F",juggling:"1F939",fencer:"1F93A","woman-wrestling":"1F93C-200D-2640-FE0F","man-wrestling":"1F93C-200D-2642-FE0F",wrestlers:"1F93C","woman-playing-water-polo":"1F93D-200D-2640-FE0F","man-playing-water-polo":"1F93D-200D-2642-FE0F",water_polo:"1F93D","woman-playing-handball":"1F93E-200D-2640-FE0F","man-playing-handball":"1F93E-200D-2642-FE0F",handball:"1F93E",wilted_flower:"1F940",drum_with_drumsticks:"1F941",clinking_glasses:"1F942",tumbler_glass:"1F943",spoon:"1F944",goal_net:"1F945",first_place_medal:"1F947",second_place_medal:"1F948",third_place_medal:"1F949",boxing_glove:"1F94A",martial_arts_uniform:"1F94B",curling_stone:"1F94C",croissant:"1F950",avocado:"1F951",cucumber:"1F952",bacon:"1F953",potato:"1F954",carrot:"1F955",baguette_bread:"1F956",green_salad:"1F957",shallow_pan_of_food:"1F958",stuffed_flatbread:"1F959",egg:"1F95A",glass_of_milk:"1F95B",peanuts:"1F95C",kiwifruit:"1F95D",pancakes:"1F95E",dumpling:"1F95F",fortune_cookie:"1F960",takeout_box:"1F961",chopsticks:"1F962",bowl_with_spoon:"1F963",cup_with_straw:"1F964",coconut:"1F965",broccoli:"1F966",pie:"1F967",pretzel:"1F968",cut_of_meat:"1F969",sandwich:"1F96A",canned_food:"1F96B",crab:"1F980",lion_face:"1F981",scorpion:"1F982",turkey:"1F983",unicorn_face:"1F984",eagle:"1F985",duck:"1F986",bat:"1F987",shark:"1F988",owl:"1F989",fox_face:"1F98A",butterfly:"1F98B",deer:"1F98C",gorilla:"1F98D",lizard:"1F98E",rhinoceros:"1F98F",shrimp:"1F990",squid:"1F991",giraffe_face:"1F992",zebra_face:"1F993",hedgehog:"1F994",sauropod:"1F995","t-rex":"1F996",cricket:"1F997",cheese_wedge:"1F9C0",face_with_monocle:"1F9D0",adult:"1F9D1",child:"1F9D2",older_adult:"1F9D3",bearded_person:"1F9D4",person_with_headscarf:"1F9D5",woman_in_steamy_room:"1F9D6-200D-2640-FE0F",man_in_steamy_room:"1F9D6-200D-2642-FE0F",person_in_steamy_room:"1F9D6-200D-2642-FE0F",woman_climbing:"1F9D7-200D-2640-FE0F",man_climbing:"1F9D7-200D-2642-FE0F",person_climbing:"1F9D7-200D-2640-FE0F",woman_in_lotus_position:"1F9D8-200D-2640-FE0F",man_in_lotus_position:"1F9D8-200D-2642-FE0F",person_in_lotus_position:"1F9D8-200D-2640-FE0F",female_mage:"1F9D9-200D-2640-FE0F",male_mage:"1F9D9-200D-2642-FE0F",mage:"1F9D9-200D-2640-FE0F",female_fairy:"1F9DA-200D-2640-FE0F",male_fairy:"1F9DA-200D-2642-FE0F",fairy:"1F9DA-200D-2640-FE0F",female_vampire:"1F9DB-200D-2640-FE0F",male_vampire:"1F9DB-200D-2642-FE0F",vampire:"1F9DB-200D-2640-FE0F",mermaid:"1F9DC-200D-2640-FE0F",merman:"1F9DC-200D-2642-FE0F",merperson:"1F9DC-200D-2642-FE0F",female_elf:"1F9DD-200D-2640-FE0F",male_elf:"1F9DD-200D-2642-FE0F",elf:"1F9DD-200D-2642-FE0F",female_genie:"1F9DE-200D-2640-FE0F",male_genie:"1F9DE-200D-2642-FE0F",genie:"1F9DE-200D-2642-FE0F",female_zombie:"1F9DF-200D-2640-FE0F",male_zombie:"1F9DF-200D-2642-FE0F",zombie:"1F9DF-200D-2642-FE0F",brain:"1F9E0",orange_heart:"1F9E1",billed_cap:"1F9E2",scarf:"1F9E3",gloves:"1F9E4",coat:"1F9E5",socks:"1F9E6",bangbang:"203C-FE0F",interrobang:"2049-FE0F",tm:"2122-FE0F",information_source:"2139-FE0F",left_right_arrow:"2194-FE0F",arrow_up_down:"2195-FE0F",arrow_upper_left:"2196-FE0F",arrow_upper_right:"2197-FE0F",arrow_lower_right:"2198-FE0F",arrow_lower_left:"2199-FE0F",leftwards_arrow_with_hook:"21A9-FE0F",arrow_right_hook:"21AA-FE0F",watch:"231A",hourglass:"231B",keyboard:"2328-FE0F",eject:"23CF-FE0F",fast_forward:"23E9",rewind:"23EA",arrow_double_up:"23EB",arrow_double_down:"23EC",black_right_pointing_double_triangle_with_vertical_bar:"23ED-FE0F",black_left_pointing_double_triangle_with_vertical_bar:"23EE-FE0F",black_right_pointing_triangle_with_double_vertical_bar:"23EF-FE0F",alarm_clock:"23F0",stopwatch:"23F1-FE0F",timer_clock:"23F2-FE0F",hourglass_flowing_sand:"23F3",double_vertical_bar:"23F8-FE0F",black_square_for_stop:"23F9-FE0F",black_circle_for_record:"23FA-FE0F",m:"24C2-FE0F",black_small_square:"25AA-FE0F",white_small_square:"25AB-FE0F",arrow_forward:"25B6-FE0F",arrow_backward:"25C0-FE0F",white_medium_square:"25FB-FE0F",black_medium_square:"25FC-FE0F",white_medium_small_square:"25FD",black_medium_small_square:"25FE",sunny:"2600-FE0F",cloud:"2601-FE0F",umbrella:"2602-FE0F",snowman:"2603-FE0F",comet:"2604-FE0F",phone:"260E-FE0F",ballot_box_with_check:"2611-FE0F",umbrella_with_rain_drops:"2614",coffee:"2615",shamrock:"2618-FE0F",point_up:"261D-FE0F",skull_and_crossbones:"2620-FE0F",radioactive_sign:"2622-FE0F",biohazard_sign:"2623-FE0F",orthodox_cross:"2626-FE0F",star_and_crescent:"262A-FE0F",peace_symbol:"262E-FE0F",yin_yang:"262F-FE0F",wheel_of_dharma:"2638-FE0F",white_frowning_face:"2639-FE0F",relaxed:"263A-FE0F",female_sign:"2640-FE0F",male_sign:"2642-FE0F",aries:"2648",taurus:"2649",gemini:"264A",cancer:"264B",leo:"264C",virgo:"264D",libra:"264E",scorpius:"264F",sagittarius:"2650",capricorn:"2651",aquarius:"2652",pisces:"2653",spades:"2660-FE0F",clubs:"2663-FE0F",hearts:"2665-FE0F",diamonds:"2666-FE0F",hotsprings:"2668-FE0F",recycle:"267B-FE0F",wheelchair:"267F",hammer_and_pick:"2692-FE0F",anchor:"2693",crossed_swords:"2694-FE0F",medical_symbol:"2695-FE0F",scales:"2696-FE0F",alembic:"2697-FE0F",gear:"2699-FE0F",atom_symbol:"269B-FE0F",fleur_de_lis:"269C-FE0F",warning:"26A0-FE0F",zap:"26A1",white_circle:"26AA",black_circle:"26AB",coffin:"26B0-FE0F",funeral_urn:"26B1-FE0F",soccer:"26BD",baseball:"26BE",snowman_without_snow:"26C4",partly_sunny:"26C5",thunder_cloud_and_rain:"26C8-FE0F",ophiuchus:"26CE",pick:"26CF-FE0F",helmet_with_white_cross:"26D1-FE0F",chains:"26D3-FE0F",no_entry:"26D4",shinto_shrine:"26E9-FE0F",church:"26EA",mountain:"26F0-FE0F",umbrella_on_ground:"26F1-FE0F",fountain:"26F2",golf:"26F3",ferry:"26F4-FE0F",boat:"26F5",skier:"26F7-FE0F",ice_skate:"26F8-FE0F","woman-bouncing-ball":"26F9-FE0F-200D-2640-FE0F","man-bouncing-ball":"26F9-FE0F-200D-2642-FE0F",person_with_ball:"26F9-FE0F-200D-2642-FE0F",tent:"26FA",fuelpump:"26FD",scissors:"2702-FE0F",white_check_mark:"2705",airplane:"2708-FE0F",email:"2709-FE0F",fist:"270A",hand:"270B",v:"270C-FE0F",writing_hand:"270D-FE0F",pencil2:"270F-FE0F",black_nib:"2712-FE0F",heavy_check_mark:"2714-FE0F",heavy_multiplication_x:"2716-FE0F",latin_cross:"271D-FE0F",star_of_david:"2721-FE0F",sparkles:"2728",eight_spoked_asterisk:"2733-FE0F",eight_pointed_black_star:"2734-FE0F",snowflake:"2744-FE0F",sparkle:"2747-FE0F",x:"274C",negative_squared_cross_mark:"274E",question:"2753",grey_question:"2754",grey_exclamation:"2755",exclamation:"2757",heavy_heart_exclamation_mark_ornament:"2763-FE0F",heart:"2764-FE0F",heavy_plus_sign:"2795",heavy_minus_sign:"2796",heavy_division_sign:"2797",arrow_right:"27A1-FE0F",curly_loop:"27B0",loop:"27BF",arrow_heading_up:"2934-FE0F",arrow_heading_down:"2935-FE0F",arrow_left:"2B05-FE0F",arrow_up:"2B06-FE0F",arrow_down:"2B07-FE0F",black_large_square:"2B1B",white_large_square:"2B1C",star:"2B50",o:"2B55",wavy_dash:"3030-FE0F",part_alternation_mark:"303D-FE0F",congratulations:"3297-FE0F",secret:"3299-FE0F"}});
define ("core/emoji/picker",["exports","core/localstorage","core/emoji/data","core/utils","core/str","core/templates"],function(a,b,c,d,e,f){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);c=h(c);function g(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;g=function(){return a};return a}function h(a){if(a&&a.__esModule){return a}if(null===a||"object"!==j(a)&&"function"!=typeof a){return{default:a}}var b=g();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function j(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){j=function(a){return typeof a}}else{j=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return j(a)}function k(a){return n(a)||m(a)||q(a)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function n(a){if(Array.isArray(a))return r(a)}function o(a,b){return t(a)||s(a,b)||q(a,b)||p()}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function q(a,b){if(!a)return;if("string"==typeof a)return r(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(a,b)}function r(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function s(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function t(a){if(Array.isArray(a))return a}function u(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function v(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){u(h,d,e,f,g,"next",a)}function g(a){u(h,d,e,f,g,"throw",a)}f(void 0)})}}function w(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function x(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){w(Object(c),!0).forEach(function(b){y(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{w(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function y(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}var z=5,A="moodle-recent-emojis",B=40,C=7,D={EMOJI:0,HEADER:1},E={CATEGORY_SELECTOR:"[data-action=\"show-category\"]",EMOJIS_CONTAINER:"[data-region=\"emojis-container\"]",EMOJI_PREVIEW:"[data-region=\"emoji-preview\"]",EMOJI_SHORT_NAME:"[data-region=\"emoji-short-name\"]",ROW_CONTAINER:"[data-region=\"row-container\"]",SEARCH_INPUT:"[data-region=\"search-input\"]",SEARCH_RESULTS_CONTAINER:"[data-region=\"search-results-container\"]"},F=function(a,b,c,d){var e=[];e.push({index:d+e.length,type:D.HEADER,data:{name:a,displayName:b}});for(var f=0,g;f<c.length;f+=C){g=c.slice(f,f+C);e.push({index:d+e.length,type:D.EMOJI,data:g})}return e},G=function(a){return a.map(function(a,b){return x({},a,{index:b})})},H=function(a){return a.reduce(function(a,b,c){if(b.type===D.HEADER){a[b.data.name]=c*B}return a},{})},I=function(){var a=v(regeneratorRuntime.mark(function a(b,c){var d,e,g;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:d={index:b,text:c};a.next=3;return(0,f.render)("core/emoji/header_row",d);case 3:e=a.sent;g=document.createElement("div");g.innerHTML=e;return a.abrupt("return",g.firstChild);case 7:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),J=function(){var a=v(regeneratorRuntime.mark(function a(b,c){var d,e,g;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:d={index:b,emojis:c.map(function(a){var b=a.unified.split("-").map(function(a){return"0x".concat(a)}),c=String.fromCodePoint.apply(null,b);return{shortnames:":".concat(a.shortnames.join(": :"),":"),unified:a.unified,text:c,spacer:!1}}),spacers:Array(C-c.length).fill(!0)};a.next=3;return(0,f.render)("core/emoji/emoji_row",d);case 3:e=a.sent;g=document.createElement("div");g.innerHTML=e;return a.abrupt("return",g.firstChild);case 7:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),K=function(a){return null!==a.getAttribute("data-short-names")},L=function(a){if(!a){return null}if("show-category"===a.getAttribute("data-action")){return a}else{return L(a.parentElement)}},M=function(a,b){return a.querySelector("[data-category=\"".concat(b,"\"]"))},N=function(a,b){for(var c=a.querySelectorAll(E.CATEGORY_SELECTOR),d=0,e;d<c.length;d++){e=c[d];e.classList.remove("selected")}b.classList.add("selected")},O=function(a,b,c){var d=[];if(0>b){b=0}for(var i in c){var j=c[i];d.push([j,i])}d.sort(function(c,d){var e=o(c,1),f=e[0],a=o(d,1),g=a[0];if(f<g){return-1}else if(f>g){return 1}else{return 0}});var e=d.reduce(function(a,c){var d=o(c,2),e=d[0],f=d[1];if(e<=b){a.categoryName=f;a.previousPosition=a.currentPosition;a.currentPosition=b}else if(null===a.nextPosition){a.nextPosition=e}return a},{categoryName:null,currentPosition:null,previousPosition:null,nextPosition:null}),f=e.categoryName,g=e.previousPosition,h=e.nextPosition;return[M(a,f),g,h]},P=function(){var a=b.default.get(A);return a?JSON.parse(a):[]},Q=function(a){b.default.set(A,JSON.stringify(a))},R=function(a,b,c){var d=a[0].data.name,e=a[0].data.displayName,f=P(),g=[c].concat(k(f.filter(function(a){return a.unified!=c.unified})));g=g.slice(0,3*C);var h=F(d,e,g);Q(g);return[G(h.concat(a.slice(b))),h.length]},S=function(a,b,c){var d=a>B?Math.floor(a/B):0,e=d>=z?d-z:d,f=c.slice(e,d+b+z);return f},T=function(){var a=v(regeneratorRuntime.mark(function a(b){var c;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:c=null;if(!(b.type===D.HEADER)){a.next=7;break}a.next=4;return I(b.index,b.data.displayName);case 4:c=a.sent;a.next=10;break;case 7:a.next=9;return J(b.index,b.data);case 9:c=a.sent;case 10:c.style.position="absolute";c.style.left=0;c.style.right=0;c.style.top="".concat(b.index*B,"px");return a.abrupt("return",c);case 15:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),U=function(c,a){if(c.index!==a.index){return!1}if(c.type!==a.type){return!1}if(j(c.data)!=j(a.data)){return!1}if(c.type===D.HEADER){return c.data.name===a.data.name}else{if(c.data.length!==a.data.length){return!1}for(var b=0;b<c.data.length;b++){if(c.data[b].unified!=a.data[b].unified){return!1}}}return!0},V=function(){var a=v(regeneratorRuntime.mark(function a(b,c,d){var e,f,g,h,i;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:e=d.filter(function(a){return!c.some(function(b){return U(b,a)})});f=c.filter(function(a){return d.some(function(b){return U(a,b)})});g=c.filter(function(a){return!d.some(function(b){return U(a,b)})});h=g.map(function(a){return b.querySelectorAll("[data-row=\"".concat(a.index,"\"]"))});a.next=6;return Promise.all(e.map(function(a){return T(a)}));case 6:i=a.sent;i.forEach(function(a,c){for(var d=e[c],g=null,h=0,j;h<f.length;h++){j=f[h];if(j.index>d.index){g=h;break}}if(null!==g){var k=f[g],l=b.querySelector("[data-row=\"".concat(k.index,"\"]"));b.insertBefore(a,l);f.splice(g,0,f)}else{f.push(d);b.appendChild(a)}});h.forEach(function(a){for(var c=0,d;c<a.length;c++){d=a[c];b.removeChild(d)}});case 9:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),W=function(a){var b=[],c=[],d=0,e=!1,f=function(){var d=v(regeneratorRuntime.mark(function d(){var g;return regeneratorRuntime.wrap(function(d){while(1){switch(d.prev=d.next){case 0:if(c.length){d.next=2;break}return d.abrupt("return");case 2:if(!e){d.next=4;break}return d.abrupt("return");case 4:e=!0;g=c.slice();c=[];d.next=9;return V(a,b,g);case 9:b=g;e=!1;f();case 12:case"end":return d.stop();}}},d)}));return function(){return d.apply(this,arguments)}}();return function(b,e){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:10;c=S(b,g,e);f();if(d!==e.length){a.style.height="".concat(e.length*B,"px")}d=e.length}},X=function(a,b){b.classList.remove("hidden");a.classList.add("hidden")},Y=function(a,b,c){b.classList.add("hidden");a.classList.remove("hidden");c.value=""},Z=function(a,b){return function(c){var d=c.target;if(K(d)){b.textContent=d.getAttribute("data-short-names");a.textContent=d.textContent}}},$=function(a,b){return function(c){var d=c.target;if(K(d)){b.textContent="";a.textContent=""}}},_=function(a,b,c,d,e,f){return function(g,h,i){var j=g.target,k=h,l=i;Y(b,c,d);if(K(j)){var m=j.getAttribute("data-unified"),n=j.getAttribute("data-short-names").replace(/:/g,"").split(" "),p=b.scrollTop,q=null!==b.querySelector("[data-row=\"".concat(a-1,"\"]")),r=R(h,a,{unified:m,shortnames:n}),s=o(r,2);k=s[0];a=s[1];l=H(k);if(q){f(p,k)}e(j.textContent);return[k,l]}var t=L(j);if(t){var u=t.getAttribute("data-category"),v=i[u];b.scrollTop=v}return[k,l]}},aa=function(a,b,c,d,e){var f=O(a,c.scrollTop,d),g=o(f,3),h=g[0],i=g[1],j=g[2];return function(d,f){var g=c.scrollTop,k=b+B,l=b-B,m=g>=j||g<i;if(m){var n=O(a,g,d),p=o(n,3);h=p[0];i=p[1];j=p[2];N(a,h)}if(g<l||g>k){requestAnimationFrame(function(){e(g,f);b=g})}}},ba=function(a,b,d){var f=b.querySelector(E.ROW_CONTAINER),g=W(f);b.appendChild(f);return v(regeneratorRuntime.mark(function f(){var h,i,j,k;return regeneratorRuntime.wrap(function(f){while(1){switch(f.prev=f.next){case 0:h=a.value.toLowerCase();if(!h){f.next=11;break}X(d,b);i=Object.keys(c.byShortName).reduce(function(a,b){if(b.includes(h)){a.push({shortnames:[b],unified:c.byShortName[b]})}return a},[]);f.next=6;return(0,e.get_string)("searchresults","core");case 6:j=f.sent;k=F(j,j,i,0);g(0,k,k.length);f.next=12;break;case 11:Y(d,b,a);case 12:case"end":return f.stop();}}},f)}))},ca=function(a,b,c,e,f,g,h,i){var j=a.querySelector(E.SEARCH_INPUT),k=a.querySelector(E.SEARCH_RESULTS_CONTAINER),l=a.querySelector(E.EMOJI_PREVIEW),m=a.querySelector(E.EMOJI_SHORT_NAME),n=_(i,b,k,j,f,c),p=aa(a,e,b,g,c),q=ba(j,k,b);a.addEventListener("focus",Z(l,m),!0);a.addEventListener("blur",$(l,m),!0);a.addEventListener("mouseenter",Z(l,m),!0);a.addEventListener("mouseleave",$(l,m),!0);a.addEventListener("click",function(a){var b=n(a,h,g),c=o(b,2);h=c[0];g=c[1]});b.addEventListener("scroll",(0,d.throttle)(function(){return p(g,h)},50));j.addEventListener("input",(0,d.debounce)(q,200))},da=function(a,b){var d=a.querySelector(E.EMOJIS_CONTAINER),e=d.querySelector(E.ROW_CONTAINER),f=P(),g=[{name:"Recent",emojis:f}].concat(k(c.byCategory)),h=[],i=0;g.forEach(function(b){var c=M(a,b.name),d=c.title,e=F(b.name,d,b.emojis,h.length);if("Recent"===b.name){i=e.length}h=h.concat(e)});h=G(h);var j=H(h),l=W(e);l(0,h);ca(a,d,l,0,b,j,h,i)};a.default=da;return a.default});
define ("core/local/aria/focuslock",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.untrapFocus=a.trapFocus=void 0;var b={focusable:"input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]"},c=[],d=[],e=[],f=null,g=!1,h=!1,i=function(a){if(g){return}var b=n();if(!b.parentNode){s()}if(b.contains(a.target)){f=a.target}else{j();if(f==document.activeElement){k()}f=document.activeElement}},j=function(){var a=n(),c=Array.from(a.querySelectorAll(b.focusable));c.unshift(a);return c.some(function(a){return m(a)})},k=function(){var a=n(),c=Array.from(a.querySelectorAll(b.focusable)).reverse();c.push(a);return c.some(function(a){return m(a)})},l=function(a){if(0<a.tabIndex||0===a.tabIndex&&null!==a.getAttribute("tabIndex")){return!0}if(a.disabled){return!1}switch(a.nodeName){case"A":return!!a.href&&"ignore"!=a.rel;case"INPUT":return"hidden"!=a.type&&"file"!=a.type;case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1;}},m=function(a){if(!l(a)){return!1}g=!0;try{a.focus()}catch(a){}g=!1;return document.activeElement===a},n=function(){return c[c.length-1]},o=function(a){if(a===n()){return}c.push(a);var b=n(),f=document.createElement("div");f.tabIndex=0;f.style.position="fixed";f.style.top=0;f.style.left=0;var g=f.cloneNode();b.parentNode.insertBefore(g,b);d.push(g);var h=f.cloneNode();b.parentNode.insertBefore(h,b.nextSibling);e.push(h)},p=function(){c.pop();var a=e.pop();if(a){a.remove()}var b=d.pop();if(b){b.remove()}},q=function(){return!!c.length},r=function(a){o(a);if(!h){document.addEventListener("focus",i,!0)}if(!j()){var b=n(),c=b.tabIndex;b.tabIndex=0;m(b);b.tabIndex=c}f=document.activeElement;h=!0};a.trapFocus=r;var s=function(){p();if(q()){return}document.removeEventListener("focus",i,!0);f=null;g=!1;h=!1};a.untrapFocus=s});
define ("core/local/modal/alert",["exports","core/modal"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);function c(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){c=function(a){return typeof a}}else{c=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return c(a)}function d(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function e(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function f(a,b,c){if(b)e(a.prototype,b);if(c)e(a,c);return a}function g(a,b,c){if("undefined"!=typeof Reflect&&Reflect.get){g=Reflect.get}else{g=function(a,b,c){var d=h(a,b);if(!d)return;var e=Object.getOwnPropertyDescriptor(d,b);if(e.get){return e.get.call(c)}return e.value}}return g(a,b,c||a)}function h(a,b){while(!Object.prototype.hasOwnProperty.call(a,b)){a=p(a);if(null===a)break}return a}function i(a,b){if("function"!=typeof b&&null!==b){throw new TypeError("Super expression must either be null or a function")}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});if(b)j(a,b)}function j(a,b){j=Object.setPrototypeOf||function(a,b){a.__proto__=b;return a};return j(a,b)}function k(a){return function(){var b=p(a),c;if(n()){var d=p(this).constructor;c=Reflect.construct(b,arguments,d)}else{c=b.apply(this,arguments)}return l(this,c)}}function l(a,b){if(b&&("object"===c(b)||"function"==typeof b)){return b}return m(a)}function m(a){if(void 0===a){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return a}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(a){return!1}}function p(a){p=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return p(a)}var q=function(a){i(b,a);var c=k(b);function b(){d(this,b);return c.apply(this,arguments)}f(b,[{key:"registerEventListeners",value:function registerEventListeners(){g(p(b.prototype),"registerEventListeners",this).call(this);this.registerCloseOnCancel()}}]);return b}(b.default);a.default=q;return a.default});
define ("core/inplace_editable",["jquery","core/ajax","core/templates","core/notification","core/str","core/config","core/url","core/form-autocomplete","core/pending"],function(a,b,c,d,e,f,g,h,i){a("body").on("click keypress","[data-inplaceeditable] [data-inplaceeditablelink]",function(j){if("keypress"===j.type&&13!==j.keyCode){return}var k=new i("autocomplete-start-editing");j.stopImmediatePropagation();j.preventDefault();var l=a(this),m=l.closest("[data-inplaceeditable]"),n=function(b){b.addClass("updating");var c=b.find("img.spinner");if(c.length){c.show()}else{c=a("<img/>").attr("src",g.imageUrl("i/loading_small")).addClass("spinner").addClass("smallicon");b.append(c)}},o=function(a){a.removeClass("updating");a.find("img.spinner").hide()},p=function(f,g){var h=[f.attr("data-itemid"),f.attr("data-component"),f.attr("data-itemtype")].join("-"),j=new i(h);n(f);b.call([{methodname:"core_update_inplace_editable",args:{itemid:f.attr("data-itemid"),component:f.attr("data-component"),itemtype:f.attr("data-itemtype"),value:g}}])[0].then(function(b){return c.render("core/inplace_editable",b).then(function(d,e){var g=f.attr("data-value"),h=a(d);c.replaceNode(f,h,e);h.find("[data-inplaceeditablelink]").focus();h.trigger({type:"updated",ajaxreturn:b,oldvalue:g})})}).then(function(){return j.resolve()}).fail(function(b){var c=a.Event("updatefailed",{exception:b,newvalue:g});o(f);M.util.js_complete(h);f.trigger(c);if(!c.isDefaultPrevented()){d.exception(b)}})},q=function(a){a.find("input").off();a.find("select").off();a.html(a.attr("data-oldcontent"));a.removeAttr("data-oldcontent");a.removeClass("inplaceeditingon");a.find("[data-inplaceeditablelink]").focus()},r=function(b,c){var d=b,e;for(e=0;e<c;e++){d+=Math.floor(10*Math.random())+""}if(0===a("#"+d).length){return d}return r(b,c)},s=function(b){e.get_string("edittitleinstructions").done(function(c){var d=a("<span class=\"editinstructions\">"+c+"</span>").attr("id",r("id_editinstructions_",20)),e=a("<input type=\"text\"/>").attr("id",r("id_inplacevalue_",20)).attr("value",b.attr("data-value")).attr("aria-describedby",d.attr("id")).addClass("ignoredirty").addClass("form-control"),g=a("<label class=\"accesshide\">"+m.attr("data-editlabel")+"</label>").attr("for",e.attr("id"));b.html("").append(d).append(g).append(e);e.focus();e.select();e.on("keyup keypress focusout",function(a){if(f.behatsiterunning&&"focusout"===a.type){return}if("keypress"===a.type&&13===a.keyCode){var c=e.val();q(b);p(b,c)}if("keyup"===a.type&&27===a.keyCode||"focusout"===a.type){q(b)}})})},t=function(a,b){q(a);p(a,b)},u=function(b,c){var d,e=a("<select></select>").attr("id",r("id_inplacevalue_",20)).addClass("custom-select"),g=a("<label class=\"accesshide\">"+m.attr("data-editlabel")+"</label>").attr("for",e.attr("id"));for(d in c){e.append(a("<option>").attr("value",c[d].key).html(c[d].value))}e.val(b.attr("data-value"));b.html("").append(g).append(e);e.focus();e.select();e.on("keyup change focusout",function(a){if(f.behatsiterunning&&"focusout"===a.type){return}if("change"===a.type){var c=e.val();q(b);p(b,c)}if("keyup"===a.type&&27===a.keyCode||"focusout"===a.type){q(b)}})},v=function(b,f){var g,j=a("<select></select>").attr("id",r("id_inplacevalue_",20)).addClass("form-autocomplete-original-select").addClass("custom-select"),k=a("<label class=\"accesshide\">"+m.attr("data-editlabel")+"</label>").attr("for",j.attr("id")),l=f.options,n=f.attributes,o=a("<a href=\"#\"></a>"),s=a("<a href=\"#\"></a>");for(g in l){j.append(a("<option>").attr("value",l[g].key).html(l[g].value))}if(n.multiple){j.attr("multiple","true")}j.val(JSON.parse(b.attr("data-value")));e.get_string("savechanges","core").then(function(a){return c.renderPix("e/save","core",a)}).then(function(a){o.append(a)}).fail(d.exception);e.get_string("cancel","core").then(function(a){return c.renderPix("e/cancel","core",a)}).then(function(a){s.append(a)}).fail(d.exception);b.html("").append(k).append(j).append(o).append(s);j.focus();j.select();h.enhance(j,n.tags,n.ajax,n.placeholder,n.caseSensitive,n.showSuggestions,n.noSelectionString).then(function(){b.find("[role=combobox]").focus()}).fail(d.exception);j.on("keyup",function(a){if("keyup"===a.type&&27===a.keyCode||"focusout"===a.type){q(b)}});o.on("click",function(a){var c=JSON.stringify(j.val());j.empty();q(b);p(b,c);a.preventDefault()});s.on("click",function(a){j.empty();q(b);a.preventDefault()})};(function turnEditingOffEverywhere(){a("span.inplaceeditable.inplaceeditingon").each(function(){q(a(this))})})();(function turnEditingOn(b){b.addClass("inplaceeditingon");b.attr("data-oldcontent",b.html());var c=b.attr("data-type"),d=b.attr("data-options");if("toggle"===c){t(b,d)}else if("select"===c){u(b,a.parseJSON(d))}else if("autocomplete"===c){v(b,a.parseJSON(d))}else{s(b)}})(m);k.resolve()});return{}});
function _typeof2(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof2=function(e){return typeof e}}else{_typeof2=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof2(e)}define ("core/adapter",[],function(){return function d(c,e,t){function r(i,o){if(!e[i]){if(!c[i]){var s="function"==typeof require&&require;if(!o&&s)return s(i,!0);if(n)return n(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=e[i]={exports:{}};c[i][0].call(p.exports,function(t){var e=c[i][1][t];return r(e?e:t)},p,p.exports,d,c,e,t)}return e[i].exports}for(var n="function"==typeof require&&require,a=0;a<t.length;a++){r(t[a])}return r}({1:[function(e,t){'use strict';var r=e("./adapter_factory.js"),a=(0,r.adapterFactory)({window:window});t.exports=a},{"./adapter_factory.js":2}],2:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.adapterFactory=function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},t=e.window,r=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},a=i.log,n=i.detectBrowser(t),o={browserDetails:n,commonShim:g,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(n.browser){case"chrome":if(!s||!s.shimPeerConnection||!r.shimChrome){a("Chrome shim is not included in this adapter release.");return o}a("adapter.js shimming chrome.");o.browserShim=s;s.shimGetUserMedia(t);s.shimMediaStream(t);s.shimPeerConnection(t);s.shimOnTrack(t);s.shimAddTrackRemoveTrack(t);s.shimGetSendersWithDtmf(t);s.shimGetStats(t);s.shimSenderReceiverGetStats(t);s.fixNegotiationNeeded(t);g.shimRTCIceCandidate(t);g.shimConnectionState(t);g.shimMaxMessageSize(t);g.shimSendThrowTypeError(t);g.removeAllowExtmapMixed(t);break;case"firefox":if(!l||!l.shimPeerConnection||!r.shimFirefox){a("Firefox shim is not included in this adapter release.");return o}a("adapter.js shimming firefox.");o.browserShim=l;l.shimGetUserMedia(t);l.shimPeerConnection(t);l.shimOnTrack(t);l.shimRemoveStream(t);l.shimSenderGetStats(t);l.shimReceiverGetStats(t);l.shimRTCDataChannel(t);l.shimAddTransceiver(t);l.shimCreateOffer(t);l.shimCreateAnswer(t);g.shimRTCIceCandidate(t);g.shimConnectionState(t);g.shimMaxMessageSize(t);g.shimSendThrowTypeError(t);break;case"edge":if(!c||!c.shimPeerConnection||!r.shimEdge){a("MS edge shim is not included in this adapter release.");return o}a("adapter.js shimming edge.");o.browserShim=c;c.shimGetUserMedia(t);c.shimGetDisplayMedia(t);c.shimPeerConnection(t);c.shimReplaceTrack(t);g.shimMaxMessageSize(t);g.shimSendThrowTypeError(t);break;case"safari":if(!f||!r.shimSafari){a("Safari shim is not included in this adapter release.");return o}a("adapter.js shimming safari.");o.browserShim=f;f.shimRTCIceServerUrls(t);f.shimCreateOfferLegacy(t);f.shimCallbacksAPI(t);f.shimLocalStreamsAPI(t);f.shimRemoteStreamsAPI(t);f.shimTrackEventTransceiver(t);f.shimGetUserMedia(t);g.shimRTCIceCandidate(t);g.shimMaxMessageSize(t);g.shimSendThrowTypeError(t);g.removeAllowExtmapMixed(t);break;default:a("Unsupported browser!");break;}return o};var n=e("./utils"),i=a(n),o=e("./chrome/chrome_shim"),s=a(o),d=e("./edge/edge_shim"),c=a(d),p=e("./firefox/firefox_shim"),l=a(p),m=e("./safari/safari_shim"),f=a(m),h=e("./common_shim"),g=a(h);function a(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var d="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)},c=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return c.shimGetUserMedia}});var p=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return p.shimGetDisplayMedia}});r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream};r.shimOnTrack=n;r.shimGetSendersWithDtmf=i;r.shimGetStats=function(e){if(!e.RTCPeerConnection){return}var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,r=Array.prototype.slice.call(arguments),a=r[0],n=r[1],i=r[2];if(0<arguments.length&&"function"==typeof a){return t.apply(this,arguments)}if(0===t.length&&(0===arguments.length||"function"!=typeof a)){return t.apply(this,[])}var o=function(e){var t={},r=e.result();r.forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){r[t]=e.stat(t)});t[r.id]=r});return t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(2<=arguments.length){var d=function(e){n(s(o(e)))};return t.apply(this,[d,a])}return new Promise(function(r,a){t.apply(e,[function(e){r(s(o(e)))},a])}).then(n,i)}};r.shimSenderReceiverGetStats=o;r.shimAddTrackRemoveTrackWithNative=s;r.shimAddTrackRemoveTrack=function(e){if(!e.RTCPeerConnection){return}var n=m.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&65<=n.version){return s(e)}var i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=i.apply(this);this._reverseStreams=this._reverseStreams||{};return t.map(function(t){return e._reverseStreams[t.id]})};var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};t.getTracks().forEach(function(e){var t=r.getSenders().find(function(t){return t.track===e});if(t){throw new DOMException("Track already exists.","InvalidAccessError")}});if(!this._reverseStreams[t.id]){var a=new e.MediaStream(t.getTracks());this._streams[t.id]=a;this._reverseStreams[a.id]=t;t=a}o.apply(this,[t])};var d=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};d.apply(this,[this._streams[e.id]||e]);delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id];delete this._streams[e.id]};e.RTCPeerConnection.prototype.addTrack=function(r,a){var n=this;if("closed"===this.signalingState){throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError")}var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===r})){throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError")}var o=this.getSenders().find(function(e){return e.track===r});if(o){throw new DOMException("Track already exists.","InvalidAccessError")}this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};var s=this._streams[a.id];if(s){s.addTrack(r);Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))})}else{var d=new e.MediaStream([r]);this._streams[a.id]=d;this._reverseStreams[d.id]=a;this.addStream(d)}return this.getSenders().find(function(e){return e.track===r})};function t(e,t){var r=t.sdp;Object.keys(e._reverseStreams||[]).forEach(function(t){var a=e._reverseStreams[t],n=e._streams[a.id];r=r.replace(new RegExp(n.id,"g"),a.id)});return new RTCSessionDescription({type:t.type,sdp:r})}function r(e,t){var r=t.sdp;Object.keys(e._reverseStreams||[]).forEach(function(t){var a=e._reverseStreams[t],n=e._streams[a.id];r=r.replace(new RegExp(a.id,"g"),n.id)});return new RTCSessionDescription({type:t.type,sdp:r})}["createOffer","createAnswer"].forEach(function(r){var n=e.RTCPeerConnection.prototype[r],i=a({},r,function(){var e=this,r=arguments,a=arguments.length&&"function"==typeof arguments[0];if(a){return n.apply(this,[function(a){var n=t(e,a);r[0].apply(null,[n])},function(e){if(r[1]){r[1].apply(null,e)}},arguments[2]])}return n.apply(this,arguments).then(function(r){return t(e,r)})});e.RTCPeerConnection.prototype[r]=i[r]});var c=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){if(!arguments.length||!arguments[0].type){return c.apply(this,arguments)}arguments[0]=r(this,arguments[0]);return c.apply(this,arguments)};var p=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=p.get.apply(this);if(""===e.type){return e}return t(this,e)}});e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState){throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError")}if(!e._pc){throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError")}var r=e._pc===this;if(!r){throw new DOMException("Sender was not created by this connection.","InvalidAccessError")}this._streams=this._streams||{};var a;Object.keys(this._streams).forEach(function(r){var n=t._streams[r].getTracks().find(function(t){return e.track===t});if(n){a=t._streams[r]}});if(a){if(1===a.getTracks().length){this.removeStream(this._reverseStreams[a.id])}else{a.removeTrack(e.track)}this.dispatchEvent(new Event("negotiationneeded"))}}};r.shimPeerConnection=function(e){var t=m.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection){e.RTCPeerConnection=e.webkitRTCPeerConnection}if(!e.RTCPeerConnection){return}if(53>t.version){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t],n=a({},t,function(){arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]);return r.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=n[t]})}var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){if(!arguments[0]){if(arguments[1]){arguments[1].apply(null)}return Promise.resolve()}if(78>t.version&&arguments[0]&&""===arguments[0].candidate){return Promise.resolve()}return r.apply(this,arguments)}};r.fixNegotiationNeeded=function(e){m.wrapPeerConnectionEvent(e,"negotiationneeded",function(t){var e=t.target;if("stable"!==e.signalingState){return}return t})};var l=e("../utils.js"),m=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(l);function a(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0})}else{e[t]=r}return e}function n(t){if("object"===("undefined"==typeof t?"undefined":d(t))&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){if(this._ontrack){this.removeEventListener("track",this._ontrack)}this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;if(!this._ontrackpoly){this._ontrackpoly=function(r){r.stream.addEventListener("addtrack",function(e){var n;if(t.RTCPeerConnection.prototype.getReceivers){n=a.getReceivers().find(function(t){return t.track&&t.track.id===e.track.id})}else{n={track:e.track}}var i=new Event("track");i.track=e.track;i.receiver=n;i.transceiver={receiver:n};i.streams=[r.stream];a.dispatchEvent(i)});r.stream.getTracks().forEach(function(e){var n;if(t.RTCPeerConnection.prototype.getReceivers){n=a.getReceivers().find(function(t){return t.track&&t.track.id===e.id})}else{n={track:e}}var i=new Event("track");i.track=e;i.receiver=n;i.transceiver={receiver:n};i.streams=[r.stream];a.dispatchEvent(i)})};this.addEventListener("addstream",this._ontrackpoly)}return r.apply(this,arguments)}}else{m.wrapPeerConnectionEvent(t,"track",function(t){if(!t.transceiver){Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}})}return t})}}function i(e){if("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){if(this._dtmf===void 0){if("audio"===t.kind){this._dtmf=e.createDTMFSender(t)}else{this._dtmf=null}}return this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e){var a=r.apply(this,arguments);if(!a){a=t(this,e);this._senders.push(a)}return a};var a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){a.apply(this,arguments);var t=this._senders.indexOf(e);if(-1!==t){this._senders.splice(t,1)}}}var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[];n.apply(this,[e]);e.getTracks().forEach(function(e){r._senders.push(t(r,e))})};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[];i.apply(this,[e]);e.getTracks().forEach(function(e){var r=t._senders.find(function(t){return t.track===e});if(r){t._senders.splice(t._senders.indexOf(r),1)}})}}else if("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var o=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=o.apply(this,[]);t.forEach(function(t){return t._pc=e});return t};Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){if(this._dtmf===void 0){if("audio"===this.track.kind){this._dtmf=this._pc.createDTMFSender(this.track)}else{this._dtmf=null}}return this._dtmf}})}}function o(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver)){return}if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;if(t){e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);r.forEach(function(t){return t._pc=e});return r}}var r=e.RTCPeerConnection.prototype.addTrack;if(r){e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);e._pc=this;return e}}e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return m.filterStats(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var a=e.RTCPeerConnection.prototype.getReceivers;if(a){e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=a.apply(this,[]);t.forEach(function(t){return t._pc=e});return t}}m.wrapPeerConnectionEvent(e,"track",function(t){t.receiver._pc=t.srcElement;return t});e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return m.filterStats(t,e.track,!1)})}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype)){return}var n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],r=void 0,a=void 0,i=void 0;this.getSenders().forEach(function(e){if(e.track===t){if(r){i=!0}else{r=e}}});this.getReceivers().forEach(function(e){if(e.track===t){if(a){i=!0}else{a=e}}return e.track===t});if(i||r&&a){return Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError"))}else if(r){return r.getStats()}else if(a){return a.getStats()}return Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return n.apply(this,arguments)}}function s(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r){return t.apply(this,arguments)}this._shimmedLocalStreams=this._shimmedLocalStreams||{};var a=t.apply(this,arguments);if(!this._shimmedLocalStreams[r.id]){this._shimmedLocalStreams[r.id]=[r,a]}else if(-1===this._shimmedLocalStreams[r.id].indexOf(a)){this._shimmedLocalStreams[r.id].push(a)}return a};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};e.getTracks().forEach(function(e){var r=t.getSenders().find(function(t){return t.track===e});if(r){throw new DOMException("Track already exists.","InvalidAccessError")}});var a=this.getSenders();r.apply(this,arguments);var n=this.getSenders().filter(function(e){return-1===a.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(n)};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[e.id];return a.apply(this,arguments)};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};if(e){Object.keys(this._shimmedLocalStreams).forEach(function(r){var a=t._shimmedLocalStreams[r].indexOf(e);if(-1!==a){t._shimmedLocalStreams[r].splice(a,1)}if(1===t._shimmedLocalStreams[r].length){delete t._shimmedLocalStreams[r]}})}return n.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.shimGetDisplayMedia=a;function a(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices){return}if(!e.navigator.mediaDevices){return}if("function"!=typeof t){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(function(t){var a=r.video&&r.video.width,n=r.video&&r.video.height,i=r.video&&r.video.frameRate;r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:i||3}};if(a){r.video.mandatory.maxWidth=a}if(n){r.video.mandatory.maxHeight=n}return e.navigator.mediaDevices.getUserMedia(r)})}}},{}],5:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)};r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(!t.mediaDevices){return}var r=i.detectBrowser(e),n=function(e){if("object"!==("undefined"==typeof e?"undefined":a(e))||e.mandatory||e.optional){return e}var t={};Object.keys(e).forEach(function(n){if("require"===n||"advanced"===n||"mediaSource"===n){return}var i="object"===a(e[n])?e[n]:{ideal:e[n]};if(i.exact!==void 0&&"number"==typeof i.exact){i.min=i.max=i.exact}var r=function(e,t){if(e){return e+t.charAt(0).toUpperCase()+t.slice(1)}return"deviceId"===t?"sourceId":t};if(i.ideal!==void 0){t.optional=t.optional||[];var o={};if("number"==typeof i.ideal){o[r("min",n)]=i.ideal;t.optional.push(o);o={};o[r("max",n)]=i.ideal;t.optional.push(o)}else{o[r("",n)]=i.ideal;t.optional.push(o)}}if(i.exact!==void 0&&"number"!=typeof i.exact){t.mandatory=t.mandatory||{};t.mandatory[r("",n)]=i.exact}else{["min","max"].forEach(function(e){if(i[e]!==void 0){t.mandatory=t.mandatory||{};t.mandatory[r(e,n)]=i[e]}})}});if(e.advanced){t.optional=(t.optional||[]).concat(e.advanced)}return t},s=function(e,i){if(61<=r.version){return i(e)}e=JSON.parse(JSON.stringify(e));if(e&&"object"===a(e.audio)){var s=function(e,t,r){if(t in e&&!(r in e)){e[r]=e[t];delete e[t]}};e=JSON.parse(JSON.stringify(e));s(e.audio,"autoGainControl","googAutoGainControl");s(e.audio,"noiseSuppression","googNoiseSuppression");e.audio=n(e.audio)}if(e&&"object"===a(e.video)){var d=e.video.facingMode;d=d&&("object"===("undefined"==typeof d?"undefined":a(d))?d:{ideal:d});var c=66>r.version;if(d&&("user"===d.exact||"environment"===d.exact||"user"===d.ideal||"environment"===d.ideal)&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete e.video.facingMode;var p;if("environment"===d.exact||"environment"===d.ideal){p=["back","rear"]}else if("user"===d.exact||"user"===d.ideal){p=["front"]}if(p){return t.mediaDevices.enumerateDevices().then(function(t){t=t.filter(function(e){return"videoinput"===e.kind});var r=t.find(function(e){return p.some(function(t){return e.label.toLowerCase().includes(t)})});if(!r&&t.length&&p.includes("back")){r=t[t.length-1]}if(r){e.video.deviceId=d.exact?{exact:r.deviceId}:{ideal:r.deviceId}}e.video=n(e.video);o("chrome: "+JSON.stringify(e));return i(e)})}}e.video=n(e.video)}o("chrome: "+JSON.stringify(e));return i(e)},d=function(t){if(64<=r.version){return t}return{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[t.name]||t.name,message:t.message,constraint:t.constraint||t.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};t.getUserMedia=function(e,r,a){s(e,function(e){t.webkitGetUserMedia(e,r,function(t){if(a){a(d(t))}})})}.bind(t);if(t.mediaDevices.getUserMedia){var p=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,function(e){return p(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length){t.getTracks().forEach(function(e){e.stop()});throw new DOMException("","NotFoundError")}return t},function(t){return Promise.reject(d(t))})})}}};var n=e("../utils.js"),i=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(n);var o=i.log},{"../utils.js":15}],6:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)};r.shimRTCIceCandidate=a;r.shimMaxMessageSize=n;r.shimSendThrowTypeError=i;r.shimConnectionState=o;r.removeAllowExtmapMixed=function(e){if(!e.RTCPeerConnection){return}var t=l.detectBrowser(e);if("chrome"===t.browser&&71<=t.version){return}var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){if(e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")){e.sdp=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n")}return r.apply(this,arguments)}};var d=e("sdp"),c=function(e){return e&&e.__esModule?e:{default:e}}(d),p=e("./utils"),l=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(p);function a(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype){return}var r=t.RTCIceCandidate;t.RTCIceCandidate=function(e){if("object"===("undefined"==typeof e?"undefined":s(e))&&e.candidate&&0===e.candidate.indexOf("a=")){e=JSON.parse(JSON.stringify(e));e.candidate=e.candidate.substr(2)}if(e.candidate&&e.candidate.length){var t=new r(e),a=c.default.parseCandidate(e.candidate),n=Object.assign(t,a);n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}};return n}return new r(e)};t.RTCIceCandidate.prototype=r.prototype;l.wrapPeerConnectionEvent(t,"icecandidate",function(r){if(r.candidate){Object.defineProperty(r,"candidate",{value:new t.RTCIceCandidate(r.candidate),writable:"false"})}return r})}function n(e){if(!e.RTCPeerConnection){return}var t=l.detectBrowser(e);if(!("sctp"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"==typeof this._sctp?null:this._sctp}})}var r=function(e){if(!e||!e.sdp){return!1}var t=c.default.splitSections(e.sdp);t.shift();return t.some(function(e){var t=c.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})},a=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||2>t.length){return-1}var r=parseInt(t[1],10);return r!==r?-1:r},n=function(e){var r=65536;if("firefox"===t.browser){if(57>t.version){if(-1===e){r=16384}else{r=2147483637}}else if(60>t.version){r=57===t.version?65535:65536}else{r=2147483637}}return r},i=function(e,r){var a=65536;if("firefox"===t.browser&&57===t.version){a=65535}var n=c.default.matchPrefix(e.sdp,"a=max-message-size:");if(0<n.length){a=parseInt(n[0].substr(19),10)}else if("firefox"===t.browser&&-1!==r){a=2147483637}return a},o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){this._sctp=null;if("chrome"===t.browser&&76<=t.version){var e=this.getConfiguration(),s=e.sdpSemantics;if("plan-b"===s){Object.defineProperty(this,"sctp",{get:function(){return"undefined"==typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}}if(r(arguments[0])){var d=a(arguments[0]),c=n(d),p=i(arguments[0],d),l=void 0;if(0===c&&0===p){l=Number.POSITIVE_INFINITY}else if(0===c||0===p){l=Math.max(c,p)}else{l=Math.min(c,p)}var m={};Object.defineProperty(m,"maxMessageSize",{get:function(){return l}});this._sctp=m}return o.apply(this,arguments)}}function i(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype)){return}function t(e,t){var r=e.send;e.send=function(){var a=arguments[0],n=a.length||a.size||a.byteLength;if("open"===e.readyState&&t.sctp&&n>t.sctp.maxMessageSize){throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)")}return r.apply(e,arguments)}}var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=r.apply(this,arguments);t(e,this);return e};l.wrapPeerConnectionEvent(e,"datachannel",function(r){t(r.channel,r.target);return r})}function o(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype){return}var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0});Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){if(this._onconnectionstatechange){this.removeEventListener("connectionstatechange",this._onconnectionstatechange);delete this._onconnectionstatechange}if(e){this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)}},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(e){var r=t[e];t[e]=function(){if(!this._connectionstatechangepoly){this._connectionstatechangepoly=function(t){var e=t.target;if(e._lastConnectionState!==e.connectionState){e._lastConnectionState=e.connectionState;var r=new Event("connectionstatechange",t);e.dispatchEvent(r)}return t};this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)}return r.apply(this,arguments)}})}},{"./utils":15,sdp:17}],7:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var i=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});r.shimPeerConnection=a;r.shimReplaceTrack=n;var s=e("../utils"),d=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(s),c=e("./filtericeservers"),p=e("rtcpeerconnection-shim"),l=function(e){return e&&e.__esModule?e:{default:e}}(p);function a(e){var t=d.detectBrowser(e);if(e.RTCIceGatherer){if(!e.RTCIceCandidate){e.RTCIceCandidate=function(e){return e}}if(!e.RTCSessionDescription){e.RTCSessionDescription=function(e){return e}}if(15025>t.version){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e;this.dispatchEvent(t)}})}}if(e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){if(this._dtmf===void 0){if("audio"===this.track.kind){this._dtmf=new e.RTCDtmfSender(this)}else if("video"===this.track.kind){this._dtmf=null}}return this._dtmf}})}if(e.RTCDtmfSender&&!e.RTCDTMFSender){e.RTCDTMFSender=e.RTCDtmfSender}var a=(0,l.default)(e,t.version);e.RTCPeerConnection=function(e){if(e&&e.iceServers){e.iceServers=(0,c.filterIceServers)(e.iceServers,t.version);d.log("ICE servers after filtering:",e.iceServers)}return new a(e)};e.RTCPeerConnection.prototype=a.prototype}function n(e){if(e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)){e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack}}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.filterIceServers=function(e){var t=!1;e=JSON.parse(JSON.stringify(e));return e.filter(function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;if(e.url&&!e.urls){n.deprecated("RTCIceServer.url","RTCIceServer.urls")}var a="string"==typeof r;if(a){r=[r]}r=r.filter(function(e){if(0===e.indexOf("stun:")){return!1}var r=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");if(r&&!t){t=!0;return!0}return r&&!t});delete e.url;e.urls=a?r[0]:r;return!!r.length}})};var a=e("../utils"),n=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(a)},{"../utils":15}],9:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.shimGetDisplayMedia=a;function a(e){if(!("getDisplayMedia"in e.navigator)){return}if(!e.navigator.mediaDevices){return}if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices){return}e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)}},{}],10:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.shimGetUserMedia=function(e){var t=e&&e.navigator,r=function(t){return{name:{PermissionDeniedError:"NotAllowedError"}[t.name]||t.name,message:t.message,constraint:t.constraint,toString:function(){return this.name}}},a=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return a(e).catch(function(t){return Promise.reject(r(t))})}}},{}],11:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var d="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)},c=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return c.shimGetUserMedia}});var p=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return p.shimGetDisplayMedia}});r.shimOnTrack=n;r.shimPeerConnection=function(e){var t=m.detectBrowser(e);if("object"!==("undefined"==typeof e?"undefined":d(e))||!(e.RTCPeerConnection||e.mozRTCPeerConnection)){return}if(!e.RTCPeerConnection&&e.mozRTCPeerConnection){e.RTCPeerConnection=e.mozRTCPeerConnection}if(53>t.version){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t],n=a({},t,function(){arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]);return r.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=n[t]})}if(68>t.version){var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){if(!arguments[0]){if(arguments[1]){arguments[1].apply(null)}return Promise.resolve()}if(arguments[0]&&""===arguments[0].candidate){return Promise.resolve()}return r.apply(this,arguments)}}var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),r=e[0],a=e[1],o=e[2];return i.apply(this,[r||null]).then(function(r){if(53>t.version&&!a){try{r.forEach(function(e){e.type=n[e.type]||e.type})}catch(t){if("TypeError"!==t.name){throw t}r.forEach(function(e,t){r.set(t,Object.assign({},e,{type:n[e.type]||e.type}))})}}return r}).then(a,o)}};r.shimSenderGetStats=i;r.shimReceiverGetStats=o;r.shimRemoveStream=s;r.shimRTCDataChannel=function(e){if(e.DataChannel&&!e.RTCDataChannel){e.RTCDataChannel=e.DataChannel}};r.shimAddTransceiver=function(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection)){return}var t=e.RTCPeerConnection.prototype.addTransceiver;if(t){e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],r=e&&"sendEncodings"in e;if(r){e.sendEncodings.forEach(function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid)){throw new TypeError("Invalid RID value provided.")}}if("scaleResolutionDownBy"in e){if(!(1<=parseFloat(e.scaleResolutionDownBy))){throw new RangeError("scale_resolution_down_by must be >= 1.0")}}if("maxFramerate"in e){if(!(0<=parseFloat(e.maxFramerate))){throw new RangeError("max_framerate must be >= 0.0")}}})}var a=t.apply(this,arguments);if(r){var n=a.sender,i=n.getParameters();if(!("encodings"in i)){i.encodings=e.sendEncodings;this.setParametersPromises.push(n.setParameters(i).catch(function(){}))}}return a}}};r.shimCreateOffer=function(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection)){return}var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,r=arguments;if(this.setParametersPromises&&this.setParametersPromises.length){return Promise.all(this.setParametersPromises).then(function(){return t.apply(e,r)}).finally(function(){e.setParametersPromises=[]})}return t.apply(this,arguments)}};r.shimCreateAnswer=function(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection)){return}var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,r=arguments;if(this.setParametersPromises&&this.setParametersPromises.length){return Promise.all(this.setParametersPromises).then(function(){return t.apply(e,r)}).finally(function(){e.setParametersPromises=[]})}return t.apply(this,arguments)}};var l=e("../utils"),m=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(l);function a(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0})}else{e[t]=r}return e}function n(e){if("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)){Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}}function i(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection&&e.RTCRtpSender)){return}if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype){return}var t=e.RTCPeerConnection.prototype.getSenders;if(t){e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);r.forEach(function(t){return t._pc=e});return r}}var r=e.RTCPeerConnection.prototype.addTrack;if(r){e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);e._pc=this;return e}}e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function o(e){if(!("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCPeerConnection&&e.RTCRtpSender)){return}if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype){return}var t=e.RTCPeerConnection.prototype.getReceivers;if(t){e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);r.forEach(function(t){return t._pc=e});return r}}m.wrapPeerConnectionEvent(e,"track",function(t){t.receiver._pc=t.srcElement;return t});e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function s(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype){return}e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;m.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(r){if(r.track&&e.getTracks().includes(r.track)){t.removeTrack(r)}})}}},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});r.shimGetDisplayMedia=a;function a(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices){return}if(!e.navigator.mediaDevices){return}e.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){var a=new DOMException("getDisplayMedia without video constraints is undefined");a.name="NotFoundError";a.code=8;return Promise.reject(a)}if(!0===r.video){r.video={mediaSource:t}}else{r.video.mediaSource=t}return e.navigator.mediaDevices.getUserMedia(r)}}},{}],13:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)};r.shimGetUserMedia=a;var i=e("../utils"),o=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(i);function a(e){var t=o.detectBrowser(e),r=e&&e.navigator,a=e&&e.MediaStreamTrack;r.getUserMedia=function(e,t,a){o.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");r.mediaDevices.getUserMedia(e).then(t,a)};if(!(55<t.version&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var i=function(e,t,r){if(t in e&&!(r in e)){e[r]=e[t];delete e[t]}},s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){if("object"===("undefined"==typeof e?"undefined":n(e))&&"object"===n(e.audio)){e=JSON.parse(JSON.stringify(e));i(e.audio,"autoGainControl","mozAutoGainControl");i(e.audio,"noiseSuppression","mozNoiseSuppression")}return s(e)};if(a&&a.prototype.getSettings){var d=a.prototype.getSettings;a.prototype.getSettings=function(){var e=d.apply(this,arguments);i(e,"mozAutoGainControl","autoGainControl");i(e,"mozNoiseSuppression","noiseSuppression");return e}}if(a&&a.prototype.applyConstraints){var p=a.prototype.applyConstraints;a.prototype.applyConstraints=function(e){if("audio"===this.kind&&"object"===("undefined"==typeof e?"undefined":n(e))){e=JSON.parse(JSON.stringify(e));i(e,"autoGainControl","mozAutoGainControl");i(e,"noiseSuppression","mozNoiseSuppression")}return p.apply(this,[e])}}}}},{"../utils":15}],14:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)};r.shimLocalStreamsAPI=a;r.shimRemoteStreamsAPI=n;r.shimCallbacksAPI=function(e){if("object"!==("undefined"==typeof e?"undefined":d(e))||!e.RTCPeerConnection){return}var t=e.RTCPeerConnection.prototype,r=t.createOffer,a=t.createAnswer,n=t.setLocalDescription,i=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){var a=2<=arguments.length?arguments[2]:arguments[0],n=r.apply(this,[a]);if(!t){return n}n.then(e,t);return Promise.resolve()};t.createAnswer=function(e,t){var r=2<=arguments.length?arguments[2]:arguments[0],n=a.apply(this,[r]);if(!t){return n}n.then(e,t);return Promise.resolve()};var s=function(e,t,r){var a=n.apply(this,[e]);if(!r){return a}a.then(t,r);return Promise.resolve()};t.setLocalDescription=s;s=function(e,t,r){var a=i.apply(this,[e]);if(!r){return a}a.then(t,r);return Promise.resolve()};t.setRemoteDescription=s;s=function(e,t,r){var a=o.apply(this,[e]);if(!r){return a}a.then(t,r);return Promise.resolve()};t.addIceCandidate=s};r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,a=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return a(i(e))}}if(!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia){t.getUserMedia=function(e,r,a){t.mediaDevices.getUserMedia(e).then(r,a)}.bind(t)}};r.shimConstraints=i;r.shimRTCIceServerUrls=o;r.shimTrackEventTransceiver=s;r.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){if("undefined"!=typeof e.offerToReceiveAudio){e.offerToReceiveAudio=!!e.offerToReceiveAudio}var r=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});if(!1===e.offerToReceiveAudio&&r){if("sendrecv"===r.direction){if(r.setDirection){r.setDirection("sendonly")}else{r.direction="sendonly"}}else if("recvonly"===r.direction){if(r.setDirection){r.setDirection("inactive")}else{r.direction="inactive"}}}else if(!0===e.offerToReceiveAudio&&!r){this.addTransceiver("audio")}if("undefined"!=typeof e.offerToReceiveVideo){e.offerToReceiveVideo=!!e.offerToReceiveVideo}var a=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});if(!1===e.offerToReceiveVideo&&a){if("sendrecv"===a.direction){if(a.setDirection){a.setDirection("sendonly")}else{a.direction="sendonly"}}else if("recvonly"===a.direction){if(a.setDirection){a.setDirection("inactive")}else{a.direction="inactive"}}}else if(!0===e.offerToReceiveVideo&&!a){this.addTransceiver("video")}}return t.apply(this,arguments)}};var c=e("../utils"),p=function(e){if(e&&e.__esModule){return e}else{var t={};if(null!=e){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}(c);function a(e){if("object"!==("undefined"==typeof e?"undefined":d(e))||!e.RTCPeerConnection){return}if(!("getLocalStreams"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getLocalStreams=function(){if(!this._localStreams){this._localStreams=[]}return this._localStreams}}if(!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;if(!this._localStreams){this._localStreams=[]}if(!this._localStreams.includes(e)){this._localStreams.push(e)}e.getAudioTracks().forEach(function(a){return t.call(r,a,e)});e.getVideoTracks().forEach(function(a){return t.call(r,a,e)})};e.RTCPeerConnection.prototype.addTrack=function(){var e=arguments[1];if(e){if(!this._localStreams){this._localStreams=[e]}else if(!this._localStreams.includes(e)){this._localStreams.push(e)}}return t.apply(this,arguments)}}if(!("removeStream"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;if(!this._localStreams){this._localStreams=[]}var r=this._localStreams.indexOf(e);if(-1===r){return}this._localStreams.splice(r,1);var a=e.getTracks();this.getSenders().forEach(function(e){if(a.includes(e.track)){t.removeTrack(e)}})}}}function n(e){if("object"!==("undefined"==typeof e?"undefined":d(e))||!e.RTCPeerConnection){return}if(!("getRemoteStreams"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}}if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;if(this._onaddstream){this.removeEventListener("addstream",this._onaddstream);this.removeEventListener("track",this._onaddstreampoly)}this.addEventListener("addstream",this._onaddstream=e);this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(function(e){if(!t._remoteStreams){t._remoteStreams=[]}if(t._remoteStreams.includes(e)){return}t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e;t.dispatchEvent(r)})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;if(!this._onaddstreampoly){this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(function(t){if(!e._remoteStreams){e._remoteStreams=[]}if(0<=e._remoteStreams.indexOf(t)){return}e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t;e.dispatchEvent(r)})})}return t.apply(e,arguments)}}}function i(e){if(e&&e.video!==void 0){return Object.assign({},e,{video:p.compactObject(e.video)})}return e}function o(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var a=[],n=0,o;n<e.iceServers.length;n++){o=e.iceServers[n];if(!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")){p.deprecated("RTCIceServer.url","RTCIceServer.urls");o=JSON.parse(JSON.stringify(o));o.urls=o.url;delete o.url;a.push(o)}else{a.push(e.iceServers[n])}}e.iceServers=a}return new t(e,r)};e.RTCPeerConnection.prototype=t.prototype;if("generateCertificate"in e.RTCPeerConnection){Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}}function s(e){if("object"===("undefined"==typeof e?"undefined":d(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)){Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}}},{"../utils":15}],15:[function(e,t,r){'use strict';Object.defineProperty(r,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)};r.extractVersion=n;r.wrapPeerConnectionEvent=function(e,t,r){if(!e.RTCPeerConnection){return}var a=e.RTCPeerConnection.prototype,n=a.addEventListener;a.addEventListener=function(e,a){if(e!==t){return n.apply(this,arguments)}var i=function(t){var e=r(t);if(e){a(e)}};this._eventMap=this._eventMap||{};this._eventMap[a]=i;return n.apply(this,[e,i])};var i=a.removeEventListener;a.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r]){return i.apply(this,arguments)}var a=this._eventMap[r];delete this._eventMap[r];return i.apply(this,[e,a])};Object.defineProperty(a,"on"+t,{get:function(){return this["_on"+t]},set:function(e){if(this["_on"+t]){this.removeEventListener(t,this["_on"+t]);delete this["_on"+t]}if(e){this.addEventListener(t,this["_on"+t]=e)}},enumerable:!0,configurable:!0})};r.disableLog=function(e){if("boolean"!=typeof e){return new Error("Argument type: "+("undefined"==typeof e?"undefined":l(e))+". Please use a boolean.")}m=e;return e?"adapter.js logging disabled":"adapter.js logging enabled"};r.disableWarnings=function(e){if("boolean"!=typeof e){return new Error("Argument type: "+("undefined"==typeof e?"undefined":l(e))+". Please use a boolean.")}f=!e;return"adapter.js deprecation warnings "+(e?"disabled":"enabled")};r.log=i;r.deprecated=o;r.detectBrowser=s;r.compactObject=c;r.walkStats=p;r.filterStats=function(e,t,r){var a=r?"outbound-rtp":"inbound-rtp",n=new Map;if(null===t){return n}var i=[];e.forEach(function(e){if("track"===e.type&&e.trackIdentifier===t.id){i.push(e)}});i.forEach(function(t){e.forEach(function(r){if(r.type===a&&r.trackId===t.id){p(e,r,n)}})});return n};function a(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0})}else{e[t]=r}return e}var m=!0,f=!0;function n(e,t,r){var a=e.match(t);return a&&a.length>=r&&parseInt(a[r],10)}function i(){if("object"===("undefined"==typeof window?"undefined":l(window))){if(m){return}if("undefined"!=typeof console&&"function"==typeof console.log){console.log.apply(console,arguments)}}}function o(e,t){if(!f){return}console.warn(e+" is deprecated, please use "+t+" instead.")}function s(e){var t=e.navigator,r={browser:null,version:null};if("undefined"==typeof e||!e.navigator){r.browser="Not a browser.";return r}if(t.mozGetUserMedia){r.browser="firefox";r.version=n(t.userAgent,/Firefox\/(\d+)\./,1)}else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer){r.browser="chrome";r.version=n(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2)}else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/)){r.browser="edge";r.version=n(t.userAgent,/Edge\/(\d+).(\d+)$/,2)}else if(e.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./)){r.browser="safari";r.version=n(t.userAgent,/AppleWebKit\/(\d+)\./,1);r.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}else{r.browser="Not a supported browser.";return r}return r}function d(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e){if(!d(e)){return e}return Object.keys(e).reduce(function(t,r){var n=d(e[r]),i=n?c(e[r]):e[r],o=n&&!Object.keys(i).length;if(i===void 0||o){return t}return Object.assign(t,a({},r,i))},{})}function p(e,t,r){if(!t||r.has(t.id)){return}r.set(t.id,t);Object.keys(t).forEach(function(a){if(a.endsWith("Id")){p(e,e.get(t[a]),r)}else if(a.endsWith("Ids")){t[a].forEach(function(t){p(e,e.get(t),r)})}})}},{}],16:[function(e,t){'use strict';var c=e("sdp");function r(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function a(e,t,r,a,n){var i=c.writeRtpDescription(e.kind,t);i+=c.writeIceParameters(e.iceGatherer.getLocalParameters());i+=c.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":n||"active");i+="a=mid:"+e.mid+"\r\n";if(e.rtpSender&&e.rtpReceiver){i+="a=sendrecv\r\n"}else if(e.rtpSender){i+="a=sendonly\r\n"}else if(e.rtpReceiver){i+="a=recvonly\r\n"}else{i+="a=inactive\r\n"}if(e.rtpSender){var o=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=o;var s="msid:"+(a?a.id:"-")+" "+o+"\r\n";i+="a="+s;i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s;if(e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s;i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n"}}i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+c.localCName+"\r\n";if(e.rtpSender&&e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+c.localCName+"\r\n"}return i}function n(e,t){var r=!1;e=JSON.parse(JSON.stringify(e));return e.filter(function(e){if(e&&(e.urls||e.url)){var a=e.urls||e.url;if(e.url&&!e.urls){console.warn("RTCIceServer.url is deprecated! Use urls instead.")}var n="string"==typeof a;if(n){a=[a]}a=a.filter(function(e){var a=0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!r;if(a){r=!0;return!0}return 0===e.indexOf("stun:")&&14393<=t&&-1===e.indexOf("?transport=udp")});delete e.url;e.urls=n?a[0]:a;return!!a.length}})}function i(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},a=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++){if(t[r].payloadType===e||t[r].preferredPayloadType===e){return t[r]}}},n=function(e,t,r,n){var i=a(e.parameters.apt,r),o=a(t.parameters.apt,n);return i&&o&&i.name.toLowerCase()===o.name.toLowerCase()};e.codecs.forEach(function(a){for(var o=0,s;o<t.codecs.length;o++){s=t.codecs[o];if(a.name.toLowerCase()===s.name.toLowerCase()&&a.clockRate===s.clockRate){if("rtx"===a.name.toLowerCase()&&a.parameters&&s.parameters.apt){if(!n(a,s,e.codecs,t.codecs)){continue}}s=JSON.parse(JSON.stringify(s));s.numChannels=Math.min(a.numChannels,s.numChannels);r.codecs.push(s);s.rtcpFeedback=s.rtcpFeedback.filter(function(e){for(var t=0;t<a.rtcpFeedback.length;t++){if(a.rtcpFeedback[t].type===e.type&&a.rtcpFeedback[t].parameter===e.parameter){return!0}}return!1});break}}});e.headerExtensions.forEach(function(e){for(var a=0,n;a<t.headerExtensions.length;a++){n=t.headerExtensions[a];if(e.uri===n.uri){r.headerExtensions.push(n);break}}});return r}function o(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function s(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});if(!r){e.addRemoteCandidate(t)}return!r}function d(t,r){var a=new Error(r);a.name=t;a.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[t];return a}t.exports=function(e,t){function p(t,r){r.addTrack(t);r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function l(t,r){r.removeTrack(t);r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}function m(t,r,a,n){var i=new Event("track");i.track=r;i.receiver=a;i.transceiver={receiver:a};i.streams=n;e.setTimeout(function(){t._dispatchEvent("track",i)})}var f=function(r){var a=this,o=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){a[e]=o[e].bind(o)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this._localDescription=null;this._remoteDescription=null;this.signalingState="stable";this.iceConnectionState="new";this.connectionState="new";this.iceGatheringState="new";r=JSON.parse(JSON.stringify(r||{}));this.usingBundle="max-bundle"===r.bundlePolicy;if("negotiate"===r.rtcpMuxPolicy){throw d("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported")}else if(!r.rtcpMuxPolicy){r.rtcpMuxPolicy="require"}switch(r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all";break;}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced";break;}r.iceServers=n(r.iceServers||[],t);this._iceGatherers=[];if(r.iceCandidatePoolSize){for(var s=r.iceCandidatePoolSize;0<s;s--){this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}))}}else{r.iceCandidatePoolSize=0}this._config=r;this.transceivers=[];this._sdpSessionId=c.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(f.prototype,"localDescription",{configurable:!0,get:function get(){return this._localDescription}});Object.defineProperty(f.prototype,"remoteDescription",{configurable:!0,get:function get(){return this._remoteDescription}});f.prototype.onicecandidate=null;f.prototype.onaddstream=null;f.prototype.ontrack=null;f.prototype.onremovestream=null;f.prototype.onsignalingstatechange=null;f.prototype.oniceconnectionstatechange=null;f.prototype.onconnectionstatechange=null;f.prototype.onicegatheringstatechange=null;f.prototype.onnegotiationneeded=null;f.prototype.ondatachannel=null;f.prototype._dispatchEvent=function(e,t){if(this._isClosed){return}this.dispatchEvent(t);if("function"==typeof this["on"+e]){this["on"+e](t)}};f.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)};f.prototype.getConfiguration=function(){return this._config};f.prototype.getLocalStreams=function(){return this.localStreams};f.prototype.getRemoteStreams=function(){return this.remoteStreams};f.prototype._createTransceiver=function(e,t){var r=0<this.transceivers.length,a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r){a.iceTransport=this.transceivers[0].iceTransport;a.dtlsTransport=this.transceivers[0].dtlsTransport}else{var n=this._createIceAndDtlsTransports();a.iceTransport=n.iceTransport;a.dtlsTransport=n.dtlsTransport}if(!t){this.transceivers.push(a)}return a};f.prototype.addTrack=function(t,r){if(this._isClosed){throw d("InvalidStateError","Attempted to call addTrack on a closed peerconnection.")}var a=this.transceivers.find(function(e){return e.track===t});if(a){throw d("InvalidAccessError","Track already exists.")}for(var n,o=0;o<this.transceivers.length;o++){if(!this.transceivers[o].track&&this.transceivers[o].kind===t.kind){n=this.transceivers[o]}}if(!n){n=this._createTransceiver(t.kind)}this._maybeFireNegotiationNeeded();if(-1===this.localStreams.indexOf(r)){this.localStreams.push(r)}n.track=t;n.stream=r;n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport);return n.rtpSender};f.prototype.addStream=function(e){var r=this;if(15025<=t){e.getTracks().forEach(function(t){r.addTrack(t,e)})}else{var a=e.clone();e.getTracks().forEach(function(e,t){var r=a.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})});a.getTracks().forEach(function(e){r.addTrack(e,a)})}};f.prototype.removeTrack=function(r){if(this._isClosed){throw d("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.")}if(!(r instanceof e.RTCRtpSender)){throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.")}var a=this.transceivers.find(function(e){return e.rtpSender===r});if(!a){throw d("InvalidAccessError","Sender was not created by this connection.")}var n=a.stream;a.rtpSender.stop();a.rtpSender=null;a.track=null;a.stream=null;var i=this.transceivers.map(function(e){return e.stream});if(-1===i.indexOf(n)&&-1<this.localStreams.indexOf(n)){this.localStreams.splice(this.localStreams.indexOf(n),1)}this._maybeFireNegotiationNeeded()};f.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var r=t.getSenders().find(function(t){return t.track===e});if(r){t.removeTrack(r)}})};f.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})};f.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})};f.prototype._createIceGatherer=function(t,r){var a=this;if(r&&0<t){return this.transceivers[0].iceGatherer}else if(this._iceGatherers.length){return this._iceGatherers.shift()}var n=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(n,"state",{value:"new",writable:!0});this.transceivers[t].bufferedCandidateEvents=[];this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;n.state=r?"completed":"gathering";if(null!==a.transceivers[t].bufferedCandidateEvents){a.transceivers[t].bufferedCandidateEvents.push(e)}};n.addEventListener("localcandidate",this.transceivers[t].bufferCandidates);return n};f.prototype._gather=function(t,r){var a=this,n=this.transceivers[r].iceGatherer;if(n.onlocalcandidate){return}var i=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null;n.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates);n.onlocalcandidate=function(e){if(a.usingBundle&&0<r){return}var i=new Event("icecandidate");i.candidate={sdpMid:t,sdpMLineIndex:r};var o=e.candidate,s=!o||0===Object.keys(o).length;if(s){if("new"===n.state||"gathering"===n.state){n.state="completed"}}else{if("new"===n.state){n.state="gathering"}o.component=1;o.ufrag=n.getLocalParameters().usernameFragment;var d=c.writeCandidate(o);i.candidate=Object.assign(i.candidate,c.parseCandidate(d));i.candidate.candidate=d;i.candidate.toJSON=function(){return{candidate:i.candidate.candidate,sdpMid:i.candidate.sdpMid,sdpMLineIndex:i.candidate.sdpMLineIndex,usernameFragment:i.candidate.usernameFragment}}}var p=c.getMediaSections(a._localDescription.sdp);if(!s){p[i.candidate.sdpMLineIndex]+="a="+i.candidate.candidate+"\r\n"}else{p[i.candidate.sdpMLineIndex]+="a=end-of-candidates\r\n"}a._localDescription.sdp=c.getDescription(a._localDescription.sdp)+p.join("");var l=a.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});if("gathering"!==a.iceGatheringState){a.iceGatheringState="gathering";a._emitGatheringStateChange()}if(!s){a._dispatchEvent("icecandidate",i)}if(l){a._dispatchEvent("icecandidate",new Event("icecandidate"));a.iceGatheringState="complete";a._emitGatheringStateChange()}};e.setTimeout(function(){i.forEach(function(t){n.onlocalcandidate(t)})},0)};f.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState();t._updateConnectionState()};var a=new e.RTCDtlsTransport(r);a.ondtlsstatechange=function(){t._updateConnectionState()};a.onerror=function(){Object.defineProperty(a,"state",{value:"failed",writable:!0});t._updateConnectionState()};return{iceTransport:r,dtlsTransport:a}};f.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;if(t){delete t.onlocalcandidate;delete this.transceivers[e].iceGatherer}var r=this.transceivers[e].iceTransport;if(r){delete r.onicestatechange;delete this.transceivers[e].iceTransport}var a=this.transceivers[e].dtlsTransport;if(a){delete a.ondtlsstatechange;delete a.onerror;delete this.transceivers[e].dtlsTransport}};f.prototype._transceive=function(e,r,a){var n=i(e.localCapabilities,e.remoteCapabilities);if(r&&e.rtpSender){n.encodings=e.sendEncodingParameters;n.rtcp={cname:c.localCName,compound:e.rtcpParameters.compound};if(e.recvEncodingParameters.length){n.rtcp.ssrc=e.recvEncodingParameters[0].ssrc}e.rtpSender.send(n)}if(a&&e.rtpReceiver&&0<n.codecs.length){if("video"===e.kind&&e.recvEncodingParameters&&15019>t){e.recvEncodingParameters.forEach(function(e){delete e.rtx})}if(e.recvEncodingParameters.length){n.encodings=e.recvEncodingParameters}else{n.encodings=[{}]}n.rtcp={compound:e.rtcpParameters.compound};if(e.rtcpParameters.cname){n.rtcp.cname=e.rtcpParameters.cname}if(e.sendEncodingParameters.length){n.rtcp.ssrc=e.sendEncodingParameters[0].ssrc}e.rtpReceiver.receive(n)}};f.prototype.setLocalDescription=function(e){var t=this;if(-1===["offer","answer"].indexOf(e.type)){return Promise.reject(d("TypeError","Unsupported type \""+e.type+"\""))}if(!o("setLocalDescription",e.type,t.signalingState)||t._isClosed){return Promise.reject(d("InvalidStateError","Can not set local "+e.type+" in state "+t.signalingState))}var r,a;if("offer"===e.type){r=c.splitSections(e.sdp);a=r.shift();r.forEach(function(e,r){var a=c.parseRtpParameters(e);t.transceivers[r].localCapabilities=a});t.transceivers.forEach(function(e,r){t._gather(e.mid,r)})}else if("answer"===e.type){r=c.splitSections(t._remoteDescription.sdp);a=r.shift();var n=0<c.matchPrefix(a,"a=ice-lite").length;r.forEach(function(e,r){var o=t.transceivers[r],s=o.iceGatherer,d=o.iceTransport,p=o.dtlsTransport,l=o.localCapabilities,m=o.remoteCapabilities,f=c.isRejected(e)&&0===c.matchPrefix(e,"a=bundle-only").length;if(!f&&!o.rejected){var h=c.getIceParameters(e,a),g=c.getDtlsParameters(e,a);if(n){g.role="server"}if(!t.usingBundle||0===r){t._gather(o.mid,r);if("new"===d.state){d.start(s,h,n?"controlling":"controlled")}if("new"===p.state){p.start(g)}}var u=i(l,m);t._transceive(o,0<u.codecs.length,!1)}})}t._localDescription={type:e.type,sdp:e.sdp};if("offer"===e.type){t._updateSignalingState("have-local-offer")}else{t._updateSignalingState("stable")}return Promise.resolve()};f.prototype.setRemoteDescription=function(r){var a=this;if(-1===["offer","answer"].indexOf(r.type)){return Promise.reject(d("TypeError","Unsupported type \""+r.type+"\""))}if(!o("setRemoteDescription",r.type,a.signalingState)||a._isClosed){return Promise.reject(d("InvalidStateError","Can not set remote "+r.type+" in state "+a.signalingState))}var n={};a.remoteStreams.forEach(function(e){n[e.id]=e});var f=[],h=c.splitSections(r.sdp),g=h.shift(),u=0<c.matchPrefix(g,"a=ice-lite").length,y=0<c.matchPrefix(g,"a=group:BUNDLE ").length;a.usingBundle=y;var v=c.matchPrefix(g,"a=ice-options:")[0];if(v){a.canTrickleIceCandidates=0<=v.substr(14).split(" ").indexOf("trickle")}else{a.canTrickleIceCandidates=!1}h.forEach(function(o,d){var m=c.splitLines(o),h=c.getKind(o),v=c.isRejected(o)&&0===c.matchPrefix(o,"a=bundle-only").length,C=m[0].substr(2).split(" ")[2],T=c.getDirection(o,g),S=c.parseMsid(o),R=c.getMid(o)||c.generateIdentifier();if(v||"application"===h&&("DTLS/SCTP"===C||"UDP/DTLS/SCTP"===C)){a.transceivers[d]={mid:R,kind:h,protocol:C,rejected:!0};return}if(!v&&a.transceivers[d]&&a.transceivers[d].rejected){a.transceivers[d]=a._createTransceiver(h,!0)}var P,_,E,k,b,x,M,D,I,w=c.parseRtpParameters(o),L,G;if(!v){L=c.getIceParameters(o,g);G=c.getDtlsParameters(o,g);G.role="client"}M=c.parseRtpEncodingParameters(o);var j=c.parseRtcpParameters(o),O=0<c.matchPrefix(o,"a=end-of-candidates",g).length,A=c.matchPrefix(o,"a=candidate:").map(function(e){return c.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===r.type||"answer"===r.type)&&!v&&y&&0<d&&a.transceivers[d]){a._disposeIceAndDtlsTransports(d);a.transceivers[d].iceGatherer=a.transceivers[0].iceGatherer;a.transceivers[d].iceTransport=a.transceivers[0].iceTransport;a.transceivers[d].dtlsTransport=a.transceivers[0].dtlsTransport;if(a.transceivers[d].rtpSender){a.transceivers[d].rtpSender.setTransport(a.transceivers[0].dtlsTransport)}if(a.transceivers[d].rtpReceiver){a.transceivers[d].rtpReceiver.setTransport(a.transceivers[0].dtlsTransport)}}if("offer"===r.type&&!v){P=a.transceivers[d]||a._createTransceiver(h);P.mid=R;if(!P.iceGatherer){P.iceGatherer=a._createIceGatherer(d,y)}if(A.length&&"new"===P.iceTransport.state){if(O&&(!y||0===d)){P.iceTransport.setRemoteCandidates(A)}else{A.forEach(function(e){s(P.iceTransport,e)})}}D=e.RTCRtpReceiver.getCapabilities(h);if(15019>t){D.codecs=D.codecs.filter(function(e){return"rtx"!==e.name})}x=P.sendEncodingParameters||[{ssrc:1001*(2*d+2)}];var U=!1;if("sendrecv"===T||"sendonly"===T){U=!P.rtpReceiver;b=P.rtpReceiver||new e.RTCRtpReceiver(P.dtlsTransport,h);if(U){var F;I=b.track;if(S&&"-"===S.stream){}else if(S){if(!n[S.stream]){n[S.stream]=new e.MediaStream;Object.defineProperty(n[S.stream],"id",{get:function get(){return S.stream}})}Object.defineProperty(I,"id",{get:function get(){return S.track}});F=n[S.stream]}else{if(!n.default){n.default=new e.MediaStream}F=n.default}if(F){p(I,F);P.associatedRemoteMediaStreams.push(F)}f.push([I,b,F])}}else if(P.rtpReceiver&&P.rtpReceiver.track){P.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===P.rtpReceiver.track.id});if(t){l(t,e)}});P.associatedRemoteMediaStreams=[]}P.localCapabilities=D;P.remoteCapabilities=w;P.rtpReceiver=b;P.rtcpParameters=j;P.sendEncodingParameters=x;P.recvEncodingParameters=M;a._transceive(a.transceivers[d],!1,U)}else if("answer"===r.type&&!v){P=a.transceivers[d];_=P.iceGatherer;E=P.iceTransport;k=P.dtlsTransport;b=P.rtpReceiver;x=P.sendEncodingParameters;D=P.localCapabilities;a.transceivers[d].recvEncodingParameters=M;a.transceivers[d].remoteCapabilities=w;a.transceivers[d].rtcpParameters=j;if(A.length&&"new"===E.state){if((u||O)&&(!y||0===d)){E.setRemoteCandidates(A)}else{A.forEach(function(e){s(P.iceTransport,e)})}}if(!y||0===d){if("new"===E.state){E.start(_,L,"controlling")}if("new"===k.state){k.start(G)}}var N=i(P.localCapabilities,P.remoteCapabilities),z=N.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length;if(!z&&P.sendEncodingParameters[0].rtx){delete P.sendEncodingParameters[0].rtx}a._transceive(P,"sendrecv"===T||"recvonly"===T,"sendrecv"===T||"sendonly"===T);if(b&&("sendrecv"===T||"sendonly"===T)){I=b.track;if(S){if(!n[S.stream]){n[S.stream]=new e.MediaStream}p(I,n[S.stream]);f.push([I,b,n[S.stream]])}else{if(!n.default){n.default=new e.MediaStream}p(I,n.default);f.push([I,b,n.default])}}else{delete P.rtpReceiver}}});if(a._dtlsRole===void 0){a._dtlsRole="offer"===r.type?"active":"passive"}a._remoteDescription={type:r.type,sdp:r.sdp};if("offer"===r.type){a._updateSignalingState("have-remote-offer")}else{a._updateSignalingState("stable")}Object.keys(n).forEach(function(t){var r=n[t];if(r.getTracks().length){if(-1===a.remoteStreams.indexOf(r)){a.remoteStreams.push(r);var i=new Event("addstream");i.stream=r;e.setTimeout(function(){a._dispatchEvent("addstream",i)})}f.forEach(function(e){var t=e[0],n=e[1];if(r.id!==e[2].id){return}m(a,t,n,[r])})}});f.forEach(function(e){if(e[2]){return}m(a,e[0],e[1],[])});e.setTimeout(function(){if(!(a&&a.transceivers)){return}a.transceivers.forEach(function(e){if(e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length){console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification");e.iceTransport.addRemoteCandidate({})}})},4e3);return Promise.resolve()};f.prototype.close=function(){this.transceivers.forEach(function(e){if(e.iceTransport){e.iceTransport.stop()}if(e.dtlsTransport){e.dtlsTransport.stop()}if(e.rtpSender){e.rtpSender.stop()}if(e.rtpReceiver){e.rtpReceiver.stop()}});this._isClosed=!0;this._updateSignalingState("closed")};f.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)};f.prototype._maybeFireNegotiationNeeded=function(){var t=this;if("stable"!==this.signalingState||!0===this.needNegotiation){return}this.needNegotiation=!0;e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0)};f.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){if(e.iceTransport&&!e.rejected){t[e.iceTransport.state]++}});e="new";if(0<t.failed){e="failed"}else if(0<t.checking){e="checking"}else if(0<t.disconnected){e="disconnected"}else if(0<t.new){e="new"}else if(0<t.connected){e="connected"}else if(0<t.completed){e="completed"}if(e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}};f.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){if(e.iceTransport&&e.dtlsTransport&&!e.rejected){t[e.iceTransport.state]++;t[e.dtlsTransport.state]++}});t.connected+=t.completed;e="new";if(0<t.failed){e="failed"}else if(0<t.connecting){e="connecting"}else if(0<t.disconnected){e="disconnected"}else if(0<t.new){e="new"}else if(0<t.connected){e="connected"}if(e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}};f.prototype.createOffer=function(){var r=this;if(r._isClosed){return Promise.reject(d("InvalidStateError","Can not call createOffer after close"))}var n=r.transceivers.filter(function(e){return"audio"===e.kind}).length,i=r.transceivers.filter(function(e){return"video"===e.kind}).length,o=arguments[0];if(o){if(o.mandatory||o.optional){throw new TypeError("Legacy mandatory/optional constraints not supported.")}if(o.offerToReceiveAudio!==void 0){if(!0===o.offerToReceiveAudio){n=1}else if(!1===o.offerToReceiveAudio){n=0}else{n=o.offerToReceiveAudio}}if(o.offerToReceiveVideo!==void 0){if(!0===o.offerToReceiveVideo){i=1}else if(!1===o.offerToReceiveVideo){i=0}else{i=o.offerToReceiveVideo}}}r.transceivers.forEach(function(e){if("audio"===e.kind){n--;if(0>n){e.wantReceive=!1}}else if("video"===e.kind){i--;if(0>i){e.wantReceive=!1}}});while(0<n||0<i){if(0<n){r._createTransceiver("audio");n--}if(0<i){r._createTransceiver("video");i--}}var s=c.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach(function(a,n){var i=a.track,o=a.kind,s=a.mid||c.generateIdentifier();a.mid=s;if(!a.iceGatherer){a.iceGatherer=r._createIceGatherer(n,r.usingBundle)}var d=e.RTCRtpSender.getCapabilities(o);if(15019>t){d.codecs=d.codecs.filter(function(e){return"rtx"!==e.name})}d.codecs.forEach(function(e){if("H264"===e.name&&e.parameters["level-asymmetry-allowed"]===void 0){e.parameters["level-asymmetry-allowed"]="1"}if(a.remoteCapabilities&&a.remoteCapabilities.codecs){a.remoteCapabilities.codecs.forEach(function(t){if(e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate){e.preferredPayloadType=t.payloadType}})}});d.headerExtensions.forEach(function(e){var t=a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[];t.forEach(function(t){if(e.uri===t.uri){e.id=t.id}})});var p=a.sendEncodingParameters||[{ssrc:1001*(2*n+1)}];if(i){if(15019<=t&&"video"===o&&!p[0].rtx){p[0].rtx={ssrc:p[0].ssrc+1}}}if(a.wantReceive){a.rtpReceiver=new e.RTCRtpReceiver(a.dtlsTransport,o)}a.localCapabilities=d;a.sendEncodingParameters=p});if("max-compat"!==r._config.bundlePolicy){s+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"}s+="a=ice-options:trickle\r\n";r.transceivers.forEach(function(e,t){s+=a(e,e.localCapabilities,"offer",e.stream,r._dtlsRole);s+="a=rtcp-rsize\r\n";if(e.iceGatherer&&"new"!==r.iceGatheringState&&(0===t||!r.usingBundle)){e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1;s+="a="+c.writeCandidate(e)+"\r\n"});if("completed"===e.iceGatherer.state){s+="a=end-of-candidates\r\n"}}});var p=new e.RTCSessionDescription({type:"offer",sdp:s});return Promise.resolve(p)};f.prototype.createAnswer=function(){var r=this;if(r._isClosed){return Promise.reject(d("InvalidStateError","Can not call createAnswer after close"))}if(!("have-remote-offer"===r.signalingState||"have-local-pranswer"===r.signalingState)){return Promise.reject(d("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState))}var n=c.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);if(r.usingBundle){n+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"}n+="a=ice-options:trickle\r\n";var o=c.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach(function(e,s){if(s+1>o){return}if(e.rejected){if("application"===e.kind){if("DTLS/SCTP"===e.protocol){n+="m=application 0 DTLS/SCTP 5000\r\n"}else{n+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n"}}else if("audio"===e.kind){n+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n"}else if("video"===e.kind){n+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"}n+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n";return}if(e.stream){var d;if("audio"===e.kind){d=e.stream.getAudioTracks()[0]}else if("video"===e.kind){d=e.stream.getVideoTracks()[0]}if(d){if(15019<=t&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx){e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}}}}var c=i(e.localCapabilities,e.remoteCapabilities),p=c.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length;if(!p&&e.sendEncodingParameters[0].rtx){delete e.sendEncodingParameters[0].rtx}n+=a(e,c,"answer",e.stream,r._dtlsRole);if(e.rtcpParameters&&e.rtcpParameters.reducedSize){n+="a=rtcp-rsize\r\n"}});var s=new e.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(s)};f.prototype.addIceCandidate=function(e){var t=this,r;if(e&&!(e.sdpMLineIndex!==void 0||e.sdpMid)){return Promise.reject(new TypeError("sdpMLineIndex or sdpMid required"))}return new Promise(function(a,n){if(!t._remoteDescription){return n(d("InvalidStateError","Can not add ICE candidate without a remote description"))}else if(!e||""===e.candidate){for(var o=0;o<t.transceivers.length;o++){if(t.transceivers[o].rejected){continue}t.transceivers[o].iceTransport.addRemoteCandidate({});r=c.getMediaSections(t._remoteDescription.sdp);r[o]+="a=end-of-candidates\r\n";t._remoteDescription.sdp=c.getDescription(t._remoteDescription.sdp)+r.join("");if(t.usingBundle){break}}}else{var p=e.sdpMLineIndex;if(e.sdpMid){for(var l=0;l<t.transceivers.length;l++){if(t.transceivers[l].mid===e.sdpMid){p=l;break}}}var m=t.transceivers[p];if(m){if(m.rejected){return a()}var f=0<Object.keys(e.candidate).length?c.parseCandidate(e.candidate):{};if("tcp"===f.protocol&&(0===f.port||9===f.port)){return a()}if(f.component&&1!==f.component){return a()}if(0===p||0<p&&m.iceTransport!==t.transceivers[0].iceTransport){if(!s(m.iceTransport,f)){return n(d("OperationError","Can not add ICE candidate"))}}var h=e.candidate.trim();if(0===h.indexOf("a=")){h=h.substr(2)}r=c.getMediaSections(t._remoteDescription.sdp);r[p]+="a="+(f.type?h:"end-of-candidates")+"\r\n";t._remoteDescription.sdp=c.getDescription(t._remoteDescription.sdp)+r.join("")}else{return n(d("OperationError","Can not add ICE candidate"))}}a()})};f.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;this.transceivers.forEach(function(e){if(e.rtpSender&&e.rtpSender.track===t){r=e.rtpSender}else if(e.rtpReceiver&&e.rtpReceiver.track===t){r=e.rtpReceiver}});if(!r){throw d("InvalidAccessError","Invalid selector.")}return r.getStats()}var a=[];this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){if(e[t]){a.push(e[t].getStats())}})});return Promise.all(a).then(function(e){var t=new Map;e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})});return t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){var a=e[t];if(a&&a.prototype&&a.prototype.getStats){var n=a.prototype.getStats;a.prototype.getStats=function(){return n.apply(this).then(function(e){var t=new Map;Object.keys(e).forEach(function(a){e[a].type=r(e[a]);t.set(a,e[a])});return t})}}});var h=["createOffer","createAnswer"];h.forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;if("function"==typeof e[0]||"function"==typeof e[1]){return t.apply(this,[arguments[2]]).then(function(t){if("function"==typeof e[0]){e[0].apply(null,[t])}},function(t){if("function"==typeof e[1]){e[1].apply(null,[t])}})}return t.apply(this,arguments)}});h=["setLocalDescription","setRemoteDescription","addIceCandidate"];h.forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;if("function"==typeof e[1]||"function"==typeof e[2]){return t.apply(this,arguments).then(function(){if("function"==typeof e[1]){e[1].apply(null)}},function(t){if("function"==typeof e[2]){e[2].apply(null,[t])}})}return t.apply(this,arguments)}});["getStats"].forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;if("function"==typeof e[1]){return t.apply(this,arguments).then(function(){if("function"==typeof e[1]){e[1].apply(null)}})}return t.apply(this,arguments)}});return f}},{sdp:17}],17:[function(e,t){'use strict';var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier();r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})};r.splitSections=function(e){var t=e.split("\nm=");return t.map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})};r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]};r.getMediaSections=function(e){var t=r.splitSections(e);t.shift();return t};r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})};r.parseCandidate=function(e){var t;if(0===e.indexOf("a=candidate:")){t=e.substring(12).split(" ")}else{t=e.substring(10).split(" ")}for(var r={foundation:t[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},a=8;a<t.length;a+=2){switch(t[a]){case"raddr":r.relatedAddress=t[a+1];break;case"rport":r.relatedPort=parseInt(t[a+1],10);break;case"tcptype":r.tcpType=t[a+1];break;case"ufrag":r.ufrag=t[a+1];r.usernameFragment=t[a+1];break;default:r[t[a]]=t[a+1];break;}}return r};r.writeCandidate=function(e){var t=[e.foundation,e.component,e.protocol.toUpperCase(),e.priority,e.address||e.ip,e.port],r=e.type;t.push("typ");t.push(r);if("host"!==r&&e.relatedAddress&&e.relatedPort){t.push("raddr");t.push(e.relatedAddress);t.push("rport");t.push(e.relatedPort)}if(e.tcpType&&"tcp"===e.protocol.toLowerCase()){t.push("tcptype");t.push(e.tcpType)}if(e.usernameFragment||e.ufrag){t.push("ufrag");t.push(e.usernameFragment||e.ufrag)}return"candidate:"+t.join(" ")};r.parseIceOptions=function(e){return e.substr(14).split(" ")};r.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};t=t[0].split("/");r.name=t[0];r.clockRate=parseInt(t[1],10);r.channels=3===t.length?parseInt(t[2],10):1;r.numChannels=r.channels;return r};r.writeRtpMap=function(e){var t=e.payloadType;if(e.preferredPayloadType!==void 0){t=e.preferredPayloadType}var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"};r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:0<t[0].indexOf("/")?t[0].split("/")[1]:"sendrecv",uri:t[1]}};r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"};r.parseFmtp=function(e){for(var t={},r,a=e.substr(e.indexOf(" ")+1).split(";"),n=0;n<a.length;n++){r=a[n].trim().split("=");t[r[0].trim()]=r[1]}return t};r.writeFmtp=function(e){var t="",r=e.payloadType;if(e.preferredPayloadType!==void 0){r=e.preferredPayloadType}if(e.parameters&&Object.keys(e.parameters).length){var a=[];Object.keys(e.parameters).forEach(function(t){if(e.parameters[t]){a.push(t+"="+e.parameters[t])}else{a.push(t)}});t+="a=fmtp:"+r+" "+a.join(";")+"\r\n"}return t};r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}};r.writeRtcpFb=function(e){var t="",r=e.payloadType;if(e.preferredPayloadType!==void 0){r=e.preferredPayloadType}if(e.rtcpFeedback&&e.rtcpFeedback.length){e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})}return t};r.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},a=e.indexOf(":",t);if(-1<a){r.attribute=e.substr(t+1,a-t-1);r.value=e.substr(a+1)}else{r.attribute=e.substr(t+1)}return r};r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}};r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t){return t.substr(6)}};r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}};r.getDtlsParameters=function(e,t){var a=r.matchPrefix(e+t,"a=fingerprint:");return{role:"auto",fingerprints:a.map(r.parseFingerprint)}};r.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"});return r};r.getIceParameters=function(e,t){var a=r.splitLines(e);a=a.concat(r.splitLines(t));var n={usernameFragment:a.filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:a.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)};return n};r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"};r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=r.splitLines(e),n=a[0].split(" "),o=3;o<n.length;o++){var s=n[o],d=r.matchPrefix(e,"a=rtpmap:"+s+" ")[0];if(d){var c=r.parseRtpMap(d),p=r.matchPrefix(e,"a=fmtp:"+s+" ");c.parameters=p.length?r.parseFmtp(p[0]):{};c.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+s+" ").map(r.parseRtcpFb);t.codecs.push(c);switch(c.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(c.name.toUpperCase());break;default:break;}}}r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))});return t};r.writeRtpDescription=function(e,t){var a="";a+="m="+e+" ";a+=0<t.codecs.length?"9":"0";a+=" UDP/TLS/RTP/SAVPF ";a+=t.codecs.map(function(e){if(e.preferredPayloadType!==void 0){return e.preferredPayloadType}return e.payloadType}).join(" ")+"\r\n";a+="c=IN IP4 0.0.0.0\r\n";a+="a=rtcp:9 IN IP4 0.0.0.0\r\n";t.codecs.forEach(function(e){a+=r.writeRtpMap(e);a+=r.writeFmtp(e);a+=r.writeRtcpFb(e)});var n=0;t.codecs.forEach(function(e){if(e.maxptime>n){n=e.maxptime}});if(0<n){a+="a=maxptime:"+n+"\r\n"}a+="a=rtcp-mux\r\n";if(t.headerExtensions){t.headerExtensions.forEach(function(e){a+=r.writeExtmap(e)})}return a};r.parseRtpEncodingParameters=function(e){var t=[],a=r.parseRtpParameters(e),n=-1!==a.fecMechanisms.indexOf("RED"),i=-1!==a.fecMechanisms.indexOf("ULPFEC"),o=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<o.length&&o[0].ssrc,d,c=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.substr(17).split(" ");return t.map(function(e){return parseInt(e,10)})});if(0<c.length&&1<c[0].length&&c[0][0]===s){d=c[0][1]}a.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};if(s&&d){r.rtx={ssrc:d}}t.push(r);if(n){r=JSON.parse(JSON.stringify(r));r.fec={ssrc:s,mechanism:i?"red+ulpfec":"red"};t.push(r)}}});if(0===t.length&&s){t.push({ssrc:s})}var p=r.matchPrefix(e,"b=");if(p.length){if(0===p[0].indexOf("b=TIAS:")){p=parseInt(p[0].substr(7),10)}else if(0===p[0].indexOf("b=AS:")){p=.95*(1e3*parseInt(p[0].substr(5),10))-16000}else{p=void 0}t.forEach(function(e){e.maxBitrate=p})}return t};r.parseRtcpParameters=function(e){var t={},a=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];if(a){t.cname=a.value;t.ssrc=a.ssrc}var n=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=0<n.length;t.compound=0===n.length;var i=r.matchPrefix(e,"a=rtcp-mux");t.mux=0<i.length;return t};r.parseMsid=function(e){var t,a=r.matchPrefix(e,"a=msid:");if(1===a.length){t=a[0].substr(7).split(" ");return{stream:t[0],track:t[1]}}var n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});if(0<n.length){t=n[0].value.split(" ");return{stream:t[0],track:t[1]}}};r.parseSctpDescription=function(e){var t=r.parseMLine(e),a=r.matchPrefix(e,"a=max-message-size:"),n;if(0<a.length){n=parseInt(a[0].substr(19),10)}if(isNaN(n)){n=65536}var i=r.matchPrefix(e,"a=sctp-port:");if(0<i.length){return{port:parseInt(i[0].substr(12),10),protocol:t.fmt,maxMessageSize:n}}var o=r.matchPrefix(e,"a=sctpmap:");if(0<o.length){var s=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:n}}};r.writeSctpDescription=function(e,t){var r=[];if("DTLS/SCTP"!==e.protocol){r=["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]}else{r=["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"]}if(t.maxMessageSize!==void 0){r.push("a=max-message-size:"+t.maxMessageSize+"\r\n")}return r.join("")};r.generateSessionId=function(){return Math.random().toString().substr(2,21)};r.writeSessionBoilerplate=function(e,t,a){var n,i=t!==void 0?t:2;if(e){n=e}else{n=r.generateSessionId()}return"v=0\r\no="+(a||"thisisadapterortc")+" "+n+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};r.writeMediaSection=function(e,t,a,n){var i=r.writeRtpDescription(e.kind,t);i+=r.writeIceParameters(e.iceGatherer.getLocalParameters());i+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===a?"actpass":"active");i+="a=mid:"+e.mid+"\r\n";if(e.direction){i+="a="+e.direction+"\r\n"}else if(e.rtpSender&&e.rtpReceiver){i+="a=sendrecv\r\n"}else if(e.rtpSender){i+="a=sendonly\r\n"}else if(e.rtpReceiver){i+="a=recvonly\r\n"}else{i+="a=inactive\r\n"}if(e.rtpSender){var o="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+o;i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o;if(e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o;i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n"}}i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n";if(e.rtpSender&&e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"}return i};r.getDirection=function(e,t){for(var a=r.splitLines(e),n=0;n<a.length;n++){switch(a[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[n].substr(2);default:}}if(t){return r.getDirection(t)}return"sendrecv"};r.getKind=function(e){var t=r.splitLines(e),a=t[0].split(" ");return a[0].substr(2)};r.isRejected=function(e){return"0"===e.split(" ",2)[1]};r.parseMLine=function(e){var t=r.splitLines(e),a=t[0].substr(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}};r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0],a=t.substr(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}};r.isValidSDP=function(e){if("string"!=typeof e||0===e.length){return!1}for(var t=r.splitLines(e),a=0;a<t.length;a++){if(2>t[a].length||"="!==t[a].charAt(1)){return!1}}return!0};if("object"===_typeof2(t)){t.exports=r}},{}]},{},[1])(1)});
define ("core/key_codes",function(){return{tab:9,enter:13,shift:16,ctrl:17,alt:18,escape:27,space:32,end:35,home:36,arrowLeft:37,arrowUp:38,arrowRight:39,arrowDown:40,8:56,asterix:106,pageUp:33,pageDown:34}});
define ("core/addblockmodal",["jquery","core/modal_factory","core/templates","core/str","core/notification"],function(a,b,c,d,e){return{init:function init(f){var g=a("[data-key=addblock]"),h=f.blocks.map(function(a){return{key:"pluginname",component:"block_"+a}}),i=d.get_strings(h).then(function(a){return a.map(function(a,b){return{name:f.blocks[b],title:a}})}).then(function(a){f.blocks=a;return c.render("core/add_block_body",f)}).fail(e.exception),j=d.get_string("addblock").fail(e.exception);b.create({title:j,body:i,type:"CANCEL"},g)}}});
define ("core/network",["jquery","core/ajax","core/config","core/notification","core/str"],function(a,b,c,d,e){var f=!1,g=!1,h=0,i=0,j=!1,k=!1,l=1e3*Math.min(c.sessiontimeout/10,600),m=function(){k=!0},n=function(){if(k){return e.get_strings([{key:"sessionexpired",component:"error"},{key:"sessionerroruser",component:"error"}]).then(function(a){d.alert(a[0],a[1]);return!0}).fail(d.exception)}else{return b.call([{methodname:"core_session_touch",args:{}}],!0,!0,!1,i)[0].then(function(){if(0<h){setTimeout(n,h)}return!0}).fail(function(){d.alert("",j)})}},o=function(){k=!1;return b.call([{methodname:"core_session_time_remaining",args:{}}],!0,!0,!0)[0].then(function(a){if(0>=a.userid){return!1}if(0>a.timeremaining){e.get_strings([{key:"sessionexpired",component:"error"},{key:"sessionerroruser",component:"error"}]).then(function(a){d.alert(a[0],a[1]);return!0}).fail(d.exception)}else if(1e3*a.timeremaining<2*l&&!g){setTimeout(m,1e3*a.timeremaining);g=!0;e.get_strings([{key:"norecentactivity",component:"moodle"},{key:"sessiontimeoutsoon",component:"moodle"},{key:"extendsession",component:"moodle"},{key:"cancel",component:"moodle"}]).then(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){n();g=!1;setTimeout(o,5*l);return!0},function(){g=!1;setTimeout(o,l)});return!0}).fail(d.exception)}else{setTimeout(o,l)}return!0})},p=function(){if(0<h){setTimeout(n,h)}else{setTimeout(o,5*l)}},q=function(){if(f){return}f=!0;p()},r=function(a,b,c){if(f){return}f=!0;h=1e3*a;j=c;i=1e3*b;p()};return{keepalive:r,init:q}});
define ("core/ajax",["jquery","core/config","core/log","core/url"],function(a,b,c,d){var e=!1,f=function(a){var b=this,c=null,e=0,f,g,h;if(a.error){for(;e<b.length;e++){f=b[e];f.deferred.reject(a)}return}for(e=0;e<b.length;e++){f=b[e];g=a[e];if("undefined"!=typeof g){if(!1===g.error){f.deferred.resolve(g.data)}else{c=g.exception;h=b[e].nosessionupdate;break}}else{c=new Error("missing response");break}}if(null!==c){if("servicerequireslogin"===c.errorcode&&!h){window.location=d.relativeUrl("/login/index.php")}else{b.forEach(function(a){a.deferred.reject(c)})}}},g=function(a,b,d){var f=this,g=0;for(g=0;g<f.length;g++){var h=f[g];if(e){c.error("Page unloaded.");c.error(d)}else{h.deferred.reject(d)}}};return{call:function call(c,d,h,j,k,l){a(window).bind("beforeunload",function(){e=!0});var m=[],n,o=[],p=[],q="";if("undefined"==typeof h){h=!0}if("undefined"==typeof d){d=!0}if("undefined"==typeof k){k=0}if("undefined"==typeof l){l=null}else{l=parseInt(l);if(0>=l){l=null}else if(!l){l=null}}if("undefined"==typeof j){j=!1}for(n=0;n<c.length;n++){var r=c[n];m.push({index:n,methodname:r.methodname,args:r.args});r.nosessionupdate=j;r.deferred=a.Deferred();o.push(r.deferred.promise());if("undefined"!=typeof r.done){r.deferred.done(r.done)}if("undefined"!=typeof r.fail){r.deferred.fail(r.fail)}r.index=n;p.push(r.methodname)}if(5>=p.length){q=p.sort().join()}else{q=p.length+"-method-calls"}m=JSON.stringify(m);var s={type:"POST",context:c,dataType:"json",processData:!1,async:d,contentType:"application/json",timeout:k},t="service.php",u=b.wwwroot+"/lib/ajax/";if(!h){t="service-nologin.php";u+=t+"?info="+q;if(l){u+="&cachekey="+l;s.type="GET"}}else{u+=t+"?sesskey="+b.sesskey+"&info="+q}if(j){u+="&nosessionupdate=true"}if("POST"===s.type){s.data=m}else{var v=u+"&args="+encodeURIComponent(m);if(v.length>2e3){s.type="POST";s.data=m}else{u=v}}if(d){a.ajax(u,s).done(f).fail(g)}else{s.success=f;s.error=g;a.ajax(u,s)}return o}}});
define ("core/loadingicon",["jquery","core/templates"],function(a,b){var c={LOADING:"core/loading"},d=function(){return b.render(c.LOADING,{})},e=function(b,c){return d().then(function(d){var e=a(d).hide();a(b).append(e);e.fadeIn(150);return a.when(e.promise(),c)}).then(function(a){return a.fadeOut(100).promise()}).then(function(a){a.remove()})};return{getIcon:d,addIconToContainer:function addIconToContainer(b){return d().then(function(c){var d=a(c).hide();a(b).append(d);d.fadeIn(150);return d})},addIconToContainerWithPromise:function addIconToContainerWithPromise(b){var c=a.Deferred();e(b,c);return c},addIconToContainerRemoveOnCompletion:e}});
define ("core/auto_rows",["jquery"],function(a){var b={ELEMENT:"[data-auto-rows]"},c={ROW_CHANGE:"autorows:rowchange"},d=function(a){var b=a.attr("rows"),c=a.data("min-rows"),d=a.attr("data-max-rows"),e=a.height(),f=a.innerHeight(),g=a[0].scrollHeight,h=(g-(f-e))/(e/b);a.css("height","");if(h<c){return c}else if(d&&h>=d){return d}else{return h}},e=function(b){var e=a(b.target),f=e.data("min-rows"),g=e.attr("rows");if("undefined"==typeof f){e.data("min-rows",g)}e.attr("rows",1);var h=d(e);e.attr("rows",h);if(h!=g){e.trigger(c.ROW_CHANGE)}};return{init:function init(c){if(a(c).data("auto-rows")){a(c).on("input propertychange",e.bind(this))}else{a(c).on("input propertychange",b.ELEMENT,e.bind(this))}},events:c}});
define ("core/localstorage",["core/config","core/storagewrapper"],function(a,b){var c=new b(window.localStorage);return{get:function get(a){return c.get(a)},set:function set(a,b){return c.set(a,b)}}});
define ("core/autoscroll",["jquery"],function(a){var b={SCROLL_THRESHOLD:30,SCROLL_FREQUENCY:1e3/60,SCROLL_SPEED:.5,scrollingId:null,scrollAmount:0,callback:null,start:function start(c){a(window).on("mousemove",b.mouseMove);a(window).on("touchmove",b.touchMove);b.callback=c},stop:function stop(){a(window).off("mousemove",b.mouseMove);a(window).off("touchmove",b.touchMove);if(null!==b.scrollingId){b.stopScrolling()}},touchMove:function touchMove(a){for(var c=0;c<a.changedTouches.length;c++){b.handleMove(a.changedTouches[c].clientX,a.changedTouches[c].clientY)}},mouseMove:function mouseMove(a){b.handleMove(a.clientX,a.clientY)},handleMove:function handleMove(c,d){if(d<b.SCROLL_THRESHOLD){b.scrollAmount=-Math.min(b.SCROLL_THRESHOLD-d,b.SCROLL_THRESHOLD)}else if(d>a(window).height()-b.SCROLL_THRESHOLD){b.scrollAmount=Math.min(d-(a(window).height()-b.SCROLL_THRESHOLD),b.SCROLL_THRESHOLD)}else{b.scrollAmount=0}if(b.scrollAmount&&null===b.scrollingId){b.startScrolling()}else if(!b.scrollAmount&&null!==b.scrollingId){b.stopScrolling()}},startScrolling:function startScrolling(){var c=a(document).height()-a(window).height();b.scrollingId=window.setInterval(function(){var d=a(window).scrollTop(),e=Math.round(b.scrollAmount*b.SCROLL_SPEED);if(0>d+e){e=-d}if(d+e>c){e=c-d}if(0===e){return}a(window).scrollTop(d+e);var f=a(window).scrollTop()-d;if(0==f){return}if(b.callback){b.callback(f)}},b.SCROLL_FREQUENCY)},stopScrolling:function stopScrolling(){window.clearInterval(b.scrollingId);b.scrollingId=null}};return{start:b.start,stop:b.stop}});
define ("core/log",["core/loglevel"],function(a){var b=a.methodFactory;a.methodFactory=function(a,c){var d=b(a,c);return function(a,b){if(b){d(b+": "+a)}else{d(a)}}};a.setConfig=function(b){if("undefined"!=typeof b.level){a.setLevel(b.level)}};return a});
define ("core/backoff_timer",function(){var a=function(a,b){this.callback=a;this.backOffFunction=b};a.prototype.callback=null;a.prototype.backOffFunction=null;a.prototype.time=null;a.prototype.timeout=null;a.prototype.generateNextTime=function(){var a=this.backOffFunction(this.time);this.time=a;return a};a.prototype.reset=function(){this.time=null;this.stop();return this};a.prototype.stop=function(){if(this.timeout){window.clearTimeout(this.timeout);this.timeout=null}return this};a.prototype.start=function(){if(!this.timeout){var a=this.generateNextTime();this.timeout=window.setTimeout(function(){this.callback();this.stop();this.start()}.bind(this),a)}return this};a.prototype.restart=function(){return this.reset().start()};a.getIncrementalCallback=function(a,b,c,d){return function(e){if(!e){return a}if(e+b>c){return d}return e+b}};return a});
define ("core/event",["jquery","core/yui"],function(a,b){return{Events:{FORM_FIELD_VALIDATION:"core_form-field-validation"},getLegacyEvents:function getLegacyEvents(){var c=a.Deferred();b.use("event","moodle-core-event",function(){c.resolve(window.M.core.event)});return c.promise()},notifyFilterContentUpdated:function notifyFilterContentUpdated(c){c=a(c);b.use("event","moodle-core-event",function(b){a(document).trigger(M.core.event.FILTER_CONTENT_UPDATED,[c]);var d=new b.NodeList(c.get());b.fire(M.core.event.FILTER_CONTENT_UPDATED,{nodes:d})})},notifyFormSubmitAjax:function notifyFormSubmitAjax(c,d){d=d||!1;b.use("event","moodle-core-event",function(b){if(d){window.skipClientValidation=!0}a(c).trigger(M.core.event.FORM_SUBMIT_AJAX);b.one(c).fire(M.core.event.FORM_SUBMIT_AJAX,{currentTarget:b.one(c)});if(d){window.skipClientValidation=!1}})},notifyEditorContentRestored:function notifyEditorContentRestored(){b.use("event","moodle-core-event",function(b){a(document).trigger(M.core.event.EDITOR_CONTENT_RESTORED);b.fire(M.core.event.EDITOR_CONTENT_RESTORED)})}}});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define ("core/popper",t):e.Popper=t()})(this,function(){'use strict';for(var _="undefined"!=typeof window&&"undefined"!=typeof window.document,X=["Edge","Trident","Firefox"],J=0,Q=0;Q<X.length;Q+=1){if(_&&0<=navigator.userAgent.indexOf(X[Q])){J=1;break}}var Z=_&&window.Promise,$=Z?function(e){var t=!1;return function(){if(t){return}t=!0;Promise.resolve().then(function(){t=!1;e()})}}:function(e){var t=!1;return function(){if(!t){t=!0;setTimeout(function(){t=!1;e()},J)}}};function e(e){return e&&"[object Function]"==={}.toString.call(e)}function t(e,t){if(1!==e.nodeType){return[]}var o=window.getComputedStyle(e,null);return t?o[t]:o}function o(e){if("HTML"===e.nodeName){return e}return e.parentNode||e.host}function n(e){if(!e){return window.document.body}switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body;}var i=t(e),r=i.overflow,p=i.overflowX,s=i.overflowY;if(/(auto|scroll)/.test(r+s+p)){return e}return n(o(e))}function r(e){var o=e&&e.offsetParent,i=o&&o.nodeName;if(!i||"BODY"===i||"HTML"===i){if(e){return e.ownerDocument.documentElement}return window.document.documentElement}if(-1!==["TD","TABLE"].indexOf(o.nodeName)&&"static"===t(o,"position")){return r(o)}return o}function p(e){var t=e.nodeName;if("BODY"===t){return!1}return"HTML"===t||r(e.firstElementChild)===e}function s(e){if(null!==e.parentNode){return s(e.parentNode)}return e}function d(e,t){if(!e||!e.nodeType||!t||!t.nodeType){return window.document.documentElement}var o=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,i=o?e:t,n=o?t:e,a=document.createRange();a.setStart(i,0);a.setEnd(n,0);var l=a.commonAncestorContainer;if(e!==l&&t!==l||i.contains(n)){if(p(l)){return l}return r(l)}var f=s(e);if(f.host){return d(f.host,t)}else{return d(e,s(t).host)}}function a(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"top",o="top"===t?"scrollTop":"scrollLeft",i=e.nodeName;if("BODY"===i||"HTML"===i){var n=e.ownerDocument.documentElement,r=e.ownerDocument.scrollingElement||n;return r[o]}return e[o]}function l(e,t){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!1,i=a(t,"top"),n=a(t,"left"),r=o?-1:1;e.top+=i*r;e.bottom+=i*r;e.left+=n*r;e.right+=n*r;return e}function f(e,t){var o="x"===t?"Left":"Top",i="Left"===o?"Right":"Bottom";return+e["border"+o+"Width"].split("px")[0]+ +e["border"+i+"Width"].split("px")[0]}var ee=void 0,te=function(){if(ee===void 0){ee=-1!==navigator.appVersion.indexOf("MSIE 10")}return ee};function m(e,t,o,i){return Math.max(t["offset"+e],t["scroll"+e],o["client"+e],o["offset"+e],o["scroll"+e],te()?o["offset"+e]+i["margin"+("Height"===e?"Top":"Left")]+i["margin"+("Height"===e?"Bottom":"Right")]:0)}function c(){var e=window.document.body,t=window.document.documentElement,o=te()&&window.getComputedStyle(t);return{height:m("Height",e,t,o),width:m("Width",e,t,o)}}var oe=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}},ie=function(){function e(e,t){for(var o=0,n;o<t.length;o++){n=t[o];n.enumerable=n.enumerable||!1;n.configurable=!0;if("value"in n)n.writable=!0;Object.defineProperty(e,n.key,n)}}return function(t,o,i){if(o)e(t.prototype,o);if(i)e(t,i);return t}}(),ne=function(e,t,o){if(t in e){Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0})}else{e[t]=o}return e},re=Object.assign||function(e){for(var t=1,o;t<arguments.length;t++){o=arguments[t];for(var n in o){if(Object.prototype.hasOwnProperty.call(o,n)){e[n]=o[n]}}}return e};function h(e){return re({},e,{right:e.left+e.width,bottom:e.top+e.height})}function u(e){var o={};if(te()){try{o=e.getBoundingClientRect();var i=a(e,"top"),n=a(e,"left");o.top+=i;o.left+=n;o.bottom+=i;o.right+=n}catch(e){}}else{o=e.getBoundingClientRect()}var r={left:o.left,top:o.top,width:o.right-o.left,height:o.bottom-o.top},p="HTML"===e.nodeName?c():{},s=p.width||e.clientWidth||r.right-r.left,d=p.height||e.clientHeight||r.bottom-r.top,l=e.offsetWidth-s,m=e.offsetHeight-d;if(l||m){var u=t(e);l-=f(u,"x");m-=f(u,"y");r.width-=l;r.height-=m}return h(r)}function g(e,o){var i=te(),r="HTML"===o.nodeName,p=u(e),s=u(o),d=n(e),a=t(o),f=+a.borderTopWidth.split("px")[0],m=+a.borderLeftWidth.split("px")[0],c=h({top:p.top-s.top-f,left:p.left-s.left-m,width:p.width,height:p.height});c.marginTop=0;c.marginLeft=0;if(!i&&r){var g=+a.marginTop.split("px")[0],b=+a.marginLeft.split("px")[0];c.top-=f-g;c.bottom-=f-g;c.left-=m-b;c.right-=m-b;c.marginTop=g;c.marginLeft=b}if(i?o.contains(d):o===d&&"BODY"!==d.nodeName){c=l(c,o)}return c}function b(e){var t=e.ownerDocument.documentElement,o=g(e,t),i=Math.max(t.clientWidth,window.innerWidth||0),n=Math.max(t.clientHeight,window.innerHeight||0),r=a(t),p=a(t,"left"),s={top:r-o.top+o.marginTop,left:p-o.left+o.marginLeft,width:i,height:n};return h(s)}function y(e){var i=e.nodeName;if("BODY"===i||"HTML"===i){return!1}if("fixed"===t(e,"position")){return!0}return y(o(e))}function w(e,t,i,r){var p={top:0,left:0},s=d(e,t);if("viewport"===r){p=b(s)}else{var a;if("scrollParent"===r){a=n(o(e));if("BODY"===a.nodeName){a=e.ownerDocument.documentElement}}else if("window"===r){a=e.ownerDocument.documentElement}else{a=r}var l=g(a,s);if("HTML"===a.nodeName&&!y(s)){var f=c(),m=f.height,h=f.width;p.top+=l.top-l.marginTop;p.bottom=m+l.top;p.left+=l.left-l.marginLeft;p.right=h+l.left}else{p=l}}p.left+=i;p.top+=i;p.right-=i;p.bottom-=i;return p}function E(e){var t=e.width,o=e.height;return t*o}function v(e,t,o,i,n){var r=5<arguments.length&&arguments[5]!==void 0?arguments[5]:0;if(-1===e.indexOf("auto")){return e}var p=w(o,i,r,n),s={top:{width:p.width,height:t.top-p.top},right:{width:p.right-t.right,height:p.height},bottom:{width:p.width,height:p.bottom-t.bottom},left:{width:t.left-p.left,height:p.height}},d=Object.keys(s).map(function(e){return re({key:e},s[e],{area:E(s[e])})}).sort(function(e,t){return t.area-e.area}),a=d.filter(function(e){var t=e.width,i=e.height;return t>=o.clientWidth&&i>=o.clientHeight}),l=0<a.length?a[0].key:d[0].key,f=e.split("-")[1];return l+(f?"-"+f:"")}function x(e,t,o){var i=d(t,o);return g(o,i)}function O(e){var t=window.getComputedStyle(e),o=parseFloat(t.marginTop)+parseFloat(t.marginBottom),i=parseFloat(t.marginLeft)+parseFloat(t.marginRight),n={width:e.offsetWidth+i,height:e.offsetHeight+o};return n}function L(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(e){return t[e]})}function S(e,t,o){o=o.split("-")[0];var i=O(e),n={width:i.width,height:i.height},r=-1!==["right","left"].indexOf(o),p=r?"top":"left",s=r?"left":"top",d=r?"height":"width",a=!r?"height":"width";n[p]=t[p]+t[d]/2-i[d]/2;if(o===s){n[s]=t[s]-i[a]}else{n[s]=t[L(s)]}return n}function T(e,t){if(Array.prototype.find){return e.find(t)}return e.filter(t)[0]}function C(e,t,o){if(Array.prototype.findIndex){return e.findIndex(function(e){return e[t]===o})}var i=T(e,function(e){return e[t]===o});return e.indexOf(i)}function D(t,o,i){var n=i===void 0?t:t.slice(0,C(t,"name",i));n.forEach(function(t){if(t["function"]){console.warn("`modifier.function` is deprecated, use `modifier.fn`!")}var i=t["function"]||t.fn;if(t.enabled&&e(i)){o.offsets.popper=h(o.offsets.popper);o.offsets.reference=h(o.offsets.reference);o=i(o,t)}});return o}function N(){if(this.state.isDestroyed){return}var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=x(this.state,this.popper,this.reference);e.placement=v(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding);e.originalPlacement=e.placement;e.offsets.popper=S(this.popper,e.offsets.reference,e.placement);e.offsets.popper.position="absolute";e=D(this.modifiers,e);if(!this.state.isCreated){this.state.isCreated=!0;this.options.onCreate(e)}else{this.options.onUpdate(e)}}function k(e,t){return e.some(function(e){var o=e.name,i=e.enabled;return i&&o===t})}function W(e){for(var t=[!1,"ms","Webkit","Moz","O"],o=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<t.length-1;n++){var r=t[n],p=r?""+r+o:e;if("undefined"!=typeof window.document.body.style[p]){return p}}return null}function B(){this.state.isDestroyed=!0;if(k(this.modifiers,"applyStyle")){this.popper.removeAttribute("x-placement");this.popper.style.left="";this.popper.style.position="";this.popper.style.top="";this.popper.style[W("transform")]=""}this.disableEventListeners();if(this.options.removeOnDestroy){this.popper.parentNode.removeChild(this.popper)}return this}function P(e){var t=e.ownerDocument;return t?t.defaultView:window}function H(e,t,o,i){var r="BODY"===e.nodeName,p=r?e.ownerDocument.defaultView:e;p.addEventListener(t,o,{passive:!0});if(!r){H(n(p.parentNode),t,o,i)}i.push(p)}function A(e,t,o,i){o.updateBound=i;P(e).addEventListener("resize",o.updateBound,{passive:!0});var r=n(e);H(r,"scroll",o.updateBound,o.scrollParents);o.scrollElement=r;o.eventsEnabled=!0;return o}function I(){if(!this.state.eventsEnabled){this.state=A(this.reference,this.options,this.state,this.scheduleUpdate)}}function M(e,t){P(e).removeEventListener("resize",t.updateBound);t.scrollParents.forEach(function(e){e.removeEventListener("scroll",t.updateBound)});t.updateBound=null;t.scrollParents=[];t.scrollElement=null;t.eventsEnabled=!1;return t}function R(){if(this.state.eventsEnabled){window.cancelAnimationFrame(this.scheduleUpdate);this.state=M(this.reference,this.state)}}function U(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function Y(e,t){Object.keys(t).forEach(function(o){var i="";if(-1!==["width","height","top","right","bottom","left"].indexOf(o)&&U(t[o])){i="px"}e.style[o]=t[o]+i})}function F(e,t){Object.keys(t).forEach(function(o){var i=t[o];if(!1!==i){e.setAttribute(o,t[o])}else{e.removeAttribute(o)}})}function j(e,t,o){var i=T(e,function(e){var o=e.name;return o===t}),n=!!i&&e.some(function(e){return e.name===o&&e.enabled&&e.order<i.order});if(!n){var r="`"+t+"`";console.warn("`"+o+"`"+" modifier is required by "+r+" modifier in order to work, be sure to include it before "+r+"!")}return n}function q(e){if("end"===e){return"start"}else if("start"===e){return"end"}return e}var pe=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],se=pe.slice(3);function K(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1,o=se.indexOf(e),i=se.slice(o+1).concat(se.slice(0,o));return t?i.reverse():i}var de={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function V(e,t,o,i){var n=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),r=+n[1],p=n[2];if(!r){return e}if(0===p.indexOf("%")){var s;switch(p){case"%p":s=o;break;case"%":case"%r":default:s=i;}var d=h(s);return d[t]/100*r}else if("vh"===p||"vw"===p){var a;if("vh"===p){a=Math.max(document.documentElement.clientHeight,window.innerHeight||0)}else{a=Math.max(document.documentElement.clientWidth,window.innerWidth||0)}return a/100*r}else{return r}}function z(e,t,o,i){var n=[0,0],r=-1!==["right","left"].indexOf(i),p=e.split(/(\+|\-)/).map(function(e){return e.trim()}),s=p.indexOf(T(p,function(e){return-1!==e.search(/,|\s/)}));if(p[s]&&-1===p[s].indexOf(",")){console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.")}var d=/\s*,\s*|\s+/,a=-1!==s?[p.slice(0,s).concat([p[s].split(d)[0]]),[p[s].split(d)[1]].concat(p.slice(s+1))]:[p];a=a.map(function(e,i){var n=(1===i?!r:r)?"height":"width",p=!1;return e.reduce(function(e,t){if(""===e[e.length-1]&&-1!==["+","-"].indexOf(t)){e[e.length-1]=t;p=!0;return e}else if(p){e[e.length-1]+=t;p=!1;return e}else{return e.concat(t)}},[]).map(function(e){return V(e,n,t,o)})});a.forEach(function(e,t){e.forEach(function(o,i){if(U(o)){n[t]+=o*("-"===e[i-1]?-1:1)}})});return n}function G(e,t){var o=t.offset,i=e.placement,n=e.offsets,r=n.popper,p=n.reference,s=i.split("-")[0],d=void 0;if(U(+o)){d=[+o,0]}else{d=z(o,r,p,s)}if("left"===s){r.top+=d[0];r.left-=d[1]}else if("right"===s){r.top+=d[0];r.left+=d[1]}else if("top"===s){r.left+=d[0];r.top-=d[1]}else if("bottom"===s){r.left+=d[0];r.top+=d[1]}e.popper=r;return e}var ae=function(){function t(o,i){var n=this,r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};oe(this,t);this.scheduleUpdate=function(){return requestAnimationFrame(n.update)};this.update=$(this.update.bind(this));this.options=re({},t.Defaults,r);this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]};this.reference=o&&o.jquery?o[0]:o;this.popper=i&&i.jquery?i[0]:i;this.options.modifiers={};Object.keys(re({},t.Defaults.modifiers,r.modifiers)).forEach(function(e){n.options.modifiers[e]=re({},t.Defaults.modifiers[e]||{},r.modifiers?r.modifiers[e]:{})});this.modifiers=Object.keys(this.options.modifiers).map(function(e){return re({name:e},n.options.modifiers[e])}).sort(function(e,t){return e.order-t.order});this.modifiers.forEach(function(t){if(t.enabled&&e(t.onLoad)){t.onLoad(n.reference,n.popper,n.options,t,n.state)}});this.update();var p=this.options.eventsEnabled;if(p){this.enableEventListeners()}this.state.eventsEnabled=p}ie(t,[{key:"update",value:function(){return N.call(this)}},{key:"destroy",value:function(){return B.call(this)}},{key:"enableEventListeners",value:function(){return I.call(this)}},{key:"disableEventListeners",value:function(){return R.call(this)}}]);return t}();ae.Utils=("undefined"!=typeof window?window:global).PopperUtils;ae.placements=pe;ae.Defaults={placement:"bottom",eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,o=t.split("-")[0],i=t.split("-")[1];if(i){var n=e.offsets,r=n.reference,p=n.popper,s=-1!==["bottom","top"].indexOf(o),d=s?"left":"top",a=s?"width":"height",l={start:ne({},d,r[d]),end:ne({},d,r[d]+r[a]-p[a])};e.offsets.popper=re({},p,l[i])}return e}},offset:{order:200,enabled:!0,fn:G,offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var o=t.boundariesElement||r(e.instance.popper);if(e.instance.reference===o){o=r(o)}var i=w(e.instance.popper,e.instance.reference,t.padding,o);t.boundaries=i;var n=t.priority,p=e.offsets.popper,s={primary:function(e){var o=p[e];if(p[e]<i[e]&&!t.escapeWithReference){o=Math.max(p[e],i[e])}return ne({},e,o)},secondary:function(e){var o="right"===e?"left":"top",n=p[o];if(p[e]>i[e]&&!t.escapeWithReference){n=Math.min(p[o],i[e]-("right"===e?p.width:p.height))}return ne({},o,n)}};n.forEach(function(e){var t=-1!==["left","top"].indexOf(e)?"primary":"secondary";p=re({},p,s[t](e))});e.offsets.popper=p;return e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,o=t.popper,i=t.reference,n=e.placement.split("-")[0],r=Math.floor,p=-1!==["top","bottom"].indexOf(n),s=p?"right":"bottom",d=p?"left":"top",a=p?"width":"height";if(o[s]<r(i[d])){e.offsets.popper[d]=r(i[d])-o[a]}if(o[d]>r(i[s])){e.offsets.popper[d]=r(i[s])}return e}},arrow:{order:500,enabled:!0,fn:function(e,o){if(!j(e.instance.modifiers,"arrow","keepTogether")){return e}var i=o.element;if("string"==typeof i){i=e.instance.popper.querySelector(i);if(!i){return e}}else{if(!e.instance.popper.contains(i)){console.warn("WARNING: `arrow.element` must be child of its popper element!");return e}}var n=e.placement.split("-")[0],r=e.offsets,p=r.popper,s=r.reference,d=-1!==["left","right"].indexOf(n),a=d?"height":"width",l=d?"Top":"Left",f=l.toLowerCase(),m=d?"left":"top",c=d?"bottom":"right",u=O(i)[a];if(s[c]-u<p[f]){e.offsets.popper[f]-=p[f]-(s[c]-u)}if(s[f]+u>p[c]){e.offsets.popper[f]+=s[f]+u-p[c]}var g=s[f]+s[a]/2-u/2,b=t(e.instance.popper,"margin"+l).replace("px",""),y=g-h(e.offsets.popper)[f]-b;y=Math.max(Math.min(p[a]-u,y),0);e.arrowElement=i;e.offsets.arrow={};e.offsets.arrow[f]=Math.round(y);e.offsets.arrow[m]="";return e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(k(e.instance.modifiers,"inner")){return e}if(e.flipped&&e.placement===e.originalPlacement){return e}var o=w(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement),i=e.placement.split("-")[0],n=L(i),r=e.placement.split("-")[1]||"",p=[];switch(t.behavior){case de.FLIP:p=[i,n];break;case de.CLOCKWISE:p=K(i);break;case de.COUNTERCLOCKWISE:p=K(i,!0);break;default:p=t.behavior;}p.forEach(function(s,d){if(i!==s||p.length===d+1){return e}i=e.placement.split("-")[0];n=L(i);var a=e.offsets.popper,l=e.offsets.reference,f=Math.floor,m="left"===i&&f(a.right)>f(l.left)||"right"===i&&f(a.left)<f(l.right)||"top"===i&&f(a.bottom)>f(l.top)||"bottom"===i&&f(a.top)<f(l.bottom),c=f(a.left)<f(o.left),h=f(a.right)>f(o.right),u=f(a.top)<f(o.top),g=f(a.bottom)>f(o.bottom),b="left"===i&&c||"right"===i&&h||"top"===i&&u||"bottom"===i&&g,y=-1!==["top","bottom"].indexOf(i),w=!!t.flipVariations&&(y&&"start"===r&&c||y&&"end"===r&&h||!y&&"start"===r&&u||!y&&"end"===r&&g);if(m||b||w){e.flipped=!0;if(m||b){i=p[d+1]}if(w){r=q(r)}e.placement=i+(r?"-"+r:"");e.offsets.popper=re({},e.offsets.popper,S(e.instance.popper,e.offsets.reference,e.placement));e=D(e.instance.modifiers,e,"flip")}});return e},behavior:"flip",padding:5,boundariesElement:"viewport"},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,o=t.split("-")[0],i=e.offsets,n=i.popper,r=i.reference,p=-1!==["left","right"].indexOf(o),s=-1===["top","left"].indexOf(o);n[p?"left":"top"]=r[o]-(s?n[p?"width":"height"]:0);e.placement=L(t);e.offsets.popper=h(n);return e}},hide:{order:800,enabled:!0,fn:function(e){if(!j(e.instance.modifiers,"hide","preventOverflow")){return e}var t=e.offsets.reference,o=T(e.instance.modifiers,function(e){return"preventOverflow"===e.name}).boundaries;if(t.bottom<o.top||t.left>o.right||t.top>o.bottom||t.right<o.left){if(!0===e.hide){return e}e.hide=!0;e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide){return e}e.hide=!1;e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var o=t.x,i=t.y,n=e.offsets.popper,p=T(e.instance.modifiers,function(e){return"applyStyle"===e.name}).gpuAcceleration;if(p!==void 0){console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!")}var s=p!==void 0?p:t.gpuAcceleration,d=r(e.instance.popper),a=u(d),l={position:n.position},f={left:Math.floor(n.left),top:Math.floor(n.top),bottom:Math.floor(n.bottom),right:Math.floor(n.right)},m="bottom"===o?"top":"bottom",c="right"===i?"left":"right",h=W("transform"),g=void 0,b=void 0;if("bottom"===m){b=-a.height+f.bottom}else{b=f.top}if("right"===c){g=-a.width+f.right}else{g=f.left}if(s&&h){l[h]="translate3d("+g+"px, "+b+"px, 0)";l[m]=0;l[c]=0;l.willChange="transform"}else{var y="bottom"===m?-1:1,w="right"===c?-1:1;l[m]=b*y;l[c]=g*w;l.willChange=m+", "+c}var E={"x-placement":e.placement};e.attributes=re({},E,e.attributes);e.styles=re({},l,e.styles);e.arrowStyles=re({},e.offsets.arrow,e.arrowStyles);return e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){Y(e.instance.popper,e.styles);F(e.instance.popper,e.attributes);if(e.arrowElement&&Object.keys(e.arrowStyles).length){Y(e.arrowElement,e.arrowStyles)}return e},onLoad:function(e,t,o,i,n){var r=x(n,t,e),p=v(o.placement,r,t,e,o.modifiers.flip.boundariesElement,o.modifiers.flip.padding);t.setAttribute("x-placement",p);Y(t,{position:"absolute"});return o},gpuAcceleration:void 0}}};return ae});
define ("core/chart_axis",[],function(){function a(){}a.prototype.POS_DEFAULT=null;a.prototype.POS_BOTTOM="bottom";a.prototype.POS_LEFT="left";a.prototype.POS_RIGHT="right";a.prototype.POS_TOP="top";a.prototype._label=null;a.prototype._labels=null;a.prototype._max=null;a.prototype._min=null;a.prototype._position=null;a.prototype._stepSize=null;a.prototype.create=function(b){var c=new a;c.setPosition(b.position);c.setLabel(b.label);c.setStepSize(b.stepSize);c.setMax(b.max);c.setMin(b.min);c.setLabels(b.labels);return c};a.prototype.getLabel=function(){return this._label};a.prototype.getLabels=function(){return this._labels};a.prototype.getMax=function(){return this._max};a.prototype.getMin=function(){return this._min};a.prototype.getPosition=function(){return this._position};a.prototype.getStepSize=function(){return this._stepSize};a.prototype.setLabel=function(a){this._label=a||null};a.prototype.setLabels=function(a){this._labels=a||null;if(null!==this._labels&&null===this._stepSize&&(null===this._min||0===this._min)&&null===this._max){this.setStepSize(1);this.setMin(0);this.setMax(a.length-1)}};a.prototype.setMax=function(a){this._max="undefined"!=typeof a?a:null};a.prototype.setMin=function(a){this._min="undefined"!=typeof a?a:null};a.prototype.setPosition=function(a){if(a!=this.POS_DEFAULT&&a!=this.POS_BOTTOM&&a!=this.POS_LEFT&&a!=this.POS_RIGHT&&a!=this.POS_TOP){throw new Error("Invalid axis position.")}this._position=a};a.prototype.setStepSize=function(a){if("undefined"==typeof a||null===a){a=null}else if(isNaN(+a)){throw new Error("Value for stepSize is not a number.")}else{a=+a}this._stepSize=a};return a});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a,b){"use strict";if("function"==typeof define&&define.amd){define ("core/loglevel",b)}else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){module.exports=b()}else{a.log=b()}})(this,function(){"use strict";var h=function(){},i="undefined",j=("undefined"==typeof window?"undefined":_typeof(window))!==i&&/Trident\/|MSIE /.test(window.navigator.userAgent),k=["trace","debug","info","warn","error"];function a(a,b){var c=a[b];if("function"==typeof c.bind){return c.bind(a)}else{try{return Function.prototype.bind.call(c,a)}catch(b){return function(){return Function.prototype.apply.apply(c,[a,arguments])}}}}function b(){if(console.log){if(console.log.apply){console.log.apply(console,arguments)}else{Function.prototype.apply.apply(console.log,[console,arguments])}}if(console.trace)console.trace()}function c(c){if("debug"===c){c="log"}if(("undefined"==typeof console?"undefined":_typeof(console))===i){return!1}else if("trace"===c&&j){return b}else if(console[c]!==void 0){return a(console,c)}else if(console.log!==void 0){return a(console,"log")}else{return h}}function d(a,b){for(var c=0,d;c<k.length;c++){d=k[c];this[d]=c<a?h:this.methodFactory(d,a,b)}this.log=this.debug}function e(a,b,c){return function(){if(("undefined"==typeof console?"undefined":_typeof(console))!==i){d.call(this,b,c);this[a].apply(this,arguments)}}}function f(a){return c(a)||e.apply(this,arguments)}function g(a,b,c){var h=this,j,l="loglevel";if(a){l+=":"+a}function e(a){var b=(k[a]||"silent").toUpperCase();if(("undefined"==typeof window?"undefined":_typeof(window))===i)return;try{window.localStorage[l]=b;return}catch(a){}try{window.document.cookie=encodeURIComponent(l)+"="+b+";"}catch(a){}}function g(){var a;if(("undefined"==typeof window?"undefined":_typeof(window))===i)return;try{a=window.localStorage[l]}catch(a){}if(_typeof(a)===i){try{var b=window.document.cookie,c=b.indexOf(encodeURIComponent(l)+"=");if(-1!==c){a=/^([^;]+)/.exec(b.slice(c))[1]}}catch(a){}}if(h.levels[a]===void 0){a=void 0}return a}h.name=a;h.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5};h.methodFactory=c||f;h.getLevel=function(){return j};h.setLevel=function(b,c){if("string"==typeof b&&h.levels[b.toUpperCase()]!==void 0){b=h.levels[b.toUpperCase()]}if("number"==typeof b&&0<=b&&b<=h.levels.SILENT){j=b;if(!1!==c){e(b)}d.call(h,b,a);if(("undefined"==typeof console?"undefined":_typeof(console))===i&&b<h.levels.SILENT){return"No console available for logging"}}else{throw"log.setLevel() called with invalid level: "+b}};h.setDefaultLevel=function(a){if(!g()){h.setLevel(a,!1)}};h.enableAll=function(a){h.setLevel(h.levels.TRACE,a)};h.disableAll=function(a){h.setLevel(h.levels.SILENT,a)};var m=g();if(null==m){m=null==b?"WARN":b}h.setLevel(m,!1)}var l=new g,m={};l.getLogger=function(a){if("string"!=typeof a||""===a){throw new TypeError("You must supply a name when creating a logger.")}var b=m[a];if(!b){b=m[a]=new g(a,l.getLevel(),l.methodFactory)}return b};var n=("undefined"==typeof window?"undefined":_typeof(window))!==i?window.log:void 0;l.noConflict=function(){if(("undefined"==typeof window?"undefined":_typeof(window))!==i&&window.log===l){window.log=n}return l};l.getLoggers=function(){return m};return l});
define ("core/chart_bar",["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}b.prototype=Object.create(a.prototype);b.prototype._horizontal=!1;b.prototype._stacked=!1;b.prototype.TYPE="bar";b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);d.setHorizontal(c.horizontal);d.setStacked(c.stacked);return d};b.prototype._setDefaults=function(){a.prototype._setDefaults.apply(this,arguments);var b=this.getYAxis(0,!0);b.setMin(0)};b.prototype.getHorizontal=function(){return this._horizontal};b.prototype.getStacked=function(){return this._stacked};b.prototype.setHorizontal=function(a){var b=this.getXAxis(0,!0);if(null===b.getMin()){b.setMin(0)}this._horizontal=!!a};b.prototype.setStacked=function(a){this._stacked=!!a};return b});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core/modal",["jquery","core/templates","core/notification","core/key_codes","core/custom_interaction_events","core/modal_backdrop","core/event","core/modal_events","core/local/aria/focuslock","core/pending","core/fullscreen"],function(a,b,c,d,e,f,g,h,i,j,k){var l={CONTAINER:"[data-region=\"modal-container\"]",MODAL:"[data-region=\"modal\"]",HEADER:"[data-region=\"header\"]",TITLE:"[data-region=\"title\"]",BODY:"[data-region=\"body\"]",FOOTER:"[data-region=\"footer\"]",HIDE:"[data-action=\"hide\"]",DIALOG:"[role=dialog]",FORM:"form",MENU_BAR:"[role=menubar]",HAS_Z_INDEX:".moodle-has-zindex",CAN_RECEIVE_FOCUS:"input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]"},m={LOADING:"core/loading",BACKDROP:"core/modal_backdrop"},n,o=0,p=function(b){this.root=a(b);this.modal=this.root.find(l.MODAL);this.header=this.modal.find(l.HEADER);this.headerPromise=a.Deferred();this.title=this.header.find(l.TITLE);this.titlePromise=a.Deferred();this.body=this.modal.find(l.BODY);this.bodyPromise=a.Deferred();this.footer=this.modal.find(l.FOOTER);this.footerPromise=a.Deferred();this.hiddenSiblings=[];this.isAttached=!1;this.bodyJS=null;this.footerJS=null;this.modalCount=o++;this.attachmentPoint=document.createElement("div");document.body.append(this.attachmentPoint);if(!this.root.is(l.CONTAINER)){c.exception({message:"Element is not a modal container"})}if(!this.modal.length){c.exception({message:"Container does not contain a modal"})}if(!this.header.length){c.exception({message:"Modal is missing a header region"})}if(!this.title.length){c.exception({message:"Modal header is missing a title region"})}if(!this.body.length){c.exception({message:"Modal is missing a body region"})}if(!this.footer.length){c.exception({message:"Modal is missing a footer region"})}this.registerEventListeners()};p.prototype.attachToDOM=function(){this.getAttachmentPoint().append(this.root);if(this.isAttached){return}i.trapFocus(this.root[0]);if(this.bodyJS){b.runTemplateJS(this.bodyJS);this.bodyJS=null}if(this.footerJS){b.runTemplateJS(this.footerJS);this.footerJS=null}this.isAttached=!0};p.prototype.countOtherVisibleModals=function(){var b=0;a("body").find(l.CONTAINER).each(function(c,d){d=a(d);if(!this.root.is(d)&&d.hasClass("show")){b++}}.bind(this));return b};p.prototype.getBackdrop=function(){if(!n){n=b.render(m.BACKDROP,{}).then(function(b){var c=a(b);return new f(c)}).fail(c.exception)}return n};p.prototype.getRoot=function(){return this.root};p.prototype.getModal=function(){return this.modal};p.prototype.getTitle=function(){return this.title};p.prototype.getBody=function(){return this.body};p.prototype.getFooter=function(){return this.footer};p.prototype.getTitlePromise=function(){return this.titlePromise};p.prototype.getBodyPromise=function(){return this.bodyPromise};p.prototype.getFooterPromise=function(){return this.footerPromise};p.prototype.getModalCount=function(){return this.modalCount};p.prototype.setTitle=function(b){var d=this.getTitle();this.titlePromise=a.Deferred();this.asyncSet(b,d.html.bind(d)).then(function(){this.titlePromise.resolve(d)}.bind(this)).catch(c.exception)};p.prototype.setBody=function(d){this.bodyPromise=a.Deferred();var e=this.getBody();if("string"==typeof d){e.html(d);g.notifyFilterContentUpdated(e);this.getRoot().trigger(h.bodyRendered,this);this.bodyPromise.resolve(e)}else{var f="amd-modal-js-pending-id-"+this.getModalCount();M.util.js_pending(f);var i=null;e.css("overflow","hidden");d=a.when(d);if("pending"==d.state()){var j=e.innerHeight();if(100>j){j=100}e.animate({height:j+"px"},150);e.html("");i=b.render(m.LOADING,{}).then(function(b){var c=a(b).hide();e.html(c);c.fadeIn(150);return a.when(c.promise(),d)}).then(function(a){return a.fadeOut(100).promise()}).then(function(){return d})}else{i=d}i.then(function(a,c){var d=null;if(this.isVisible()){e.css("opacity",0);var f=e.innerHeight();e.html(a);e.css("height","");var g=e.innerHeight();e.css("height",f+"px");d=e.animate({height:g+"px",opacity:1},{duration:150,queue:!1}).promise()}else{e.html(a)}if(c){if(this.isAttached){b.runTemplateJS(c)}else{this.bodyJS=c}}return d}.bind(this)).then(function(a){g.notifyFilterContentUpdated(e);this.getRoot().trigger(h.bodyRendered,this);return a}.bind(this)).then(function(){this.bodyPromise.resolve(e)}.bind(this)).fail(c.exception).always(function(){e.css("height","");e.css("overflow","");e.css("opacity","");M.util.js_complete(f)}).fail(c.exception)}};p.prototype.setFooter=function(d){this.showFooter();this.footerPromise=a.Deferred();var e=this.getFooter();if("string"==typeof d){e.html(d);this.footerPromise.resolve(e)}else{b.render(m.LOADING,{}).then(function(a){e.html(a);return d}).then(function(a,c){e.html(a);if(c){if(this.isAttached){b.runTemplateJS(c)}else{this.footerJS=c}}return e}.bind(this)).then(function(a){this.footerPromise.resolve(a)}.bind(this)).catch(c.exception)}};p.prototype.hasFooterContent=function(){return this.getFooter().children().length?!0:!1};p.prototype.hideFooter=function(){this.getFooter().addClass("hidden")};p.prototype.showFooter=function(){this.getFooter().removeClass("hidden")};p.prototype.setLarge=function(){if(this.isLarge()){return}this.getModal().addClass("modal-lg")};p.prototype.setXLarge=function(){if(this.isXLarge()){return}this.getModal().addClass("modal-xl")};p.prototype.isLarge=function(){return this.getModal().hasClass("modal-lg")};p.prototype.isXLarge=function(){return this.getModal().hasClass("modal-xl")};p.prototype.setSmall=function(){if(this.isSmall()){return}this.getModal().removeClass("modal-lg")};p.prototype.isSmall=function(){return!this.getModal().hasClass("modal-lg")};p.prototype.calculateZIndex=function(){var b=a(l.DIALOG+", "+l.MENU_BAR+", "+l.HAS_Z_INDEX),c=parseInt(this.root.css("z-index"));b.each(function(b,d){d=a(d);var e=d.css("z-index")?parseInt(d.css("z-index")):0;if(e>c){c=e}});return c};p.prototype.isVisible=function(){return this.root.hasClass("show")};p.prototype.hasFocus=function(){var b=a(document.activeElement);return this.root.is(b)||this.root.has(b).length};p.prototype.hasTransitions=function(){return this.getRoot().hasClass("fade")};p.prototype.getAttachmentPoint=function(){return a(k.getElement()||this.attachmentPoint)};p.prototype.show=function(){if(this.isVisible()){return a.Deferred().resolve()}var b=new j("core/modal:show");if(this.hasFooterContent()){this.showFooter()}else{this.hideFooter()}this.attachToDOM();return this.getBackdrop().then(function(b){var c=this.calculateZIndex(),d=c+2;this.root.css("z-index",d);b.setZIndex(d-1);b.show();this.root.removeClass("hide").addClass("show");this.accessibilityShow();this.getModal().focus();a("body").addClass("modal-open");this.root.trigger(h.shown,this)}.bind(this)).then(b.resolve)};p.prototype.hideIfNotForm=function(){var a=this.modal.find(l.FORM);if(0==a.length){this.hide()}};p.prototype.hide=function(){this.getBackdrop().done(function(b){i.untrapFocus();if(!this.countOtherVisibleModals()){b.hide();a("body").removeClass("modal-open")}var c=parseInt(this.root.css("z-index"));this.root.css("z-index","");b.setZIndex(c-3);this.accessibilityHide();if(this.hasTransitions()){this.getRoot().one("transitionend webkitTransitionEnd oTransitionEnd",function(){this.getRoot().removeClass("show").addClass("hide")}.bind(this))}else{this.getRoot().removeClass("show").addClass("hide")}if(a(document.body).find(this.getRoot()).length){a(document.body).append(this.getRoot())}this.root.trigger(h.hidden,this)}.bind(this))};p.prototype.destroy=function(){this.hide();this.root.remove();this.root.trigger(h.destroyed,this);this.attachmentPoint.remove()};p.prototype.accessibilityShow=function(){a("body").children().each(function(b,c){if(!this.root.is(c)){c=a(c);var d=c.attr("aria-hidden");if("true"!==d){c.data("previous-aria-hidden",d);this.hiddenSiblings.push(c);c.attr("aria-hidden","true")}}}.bind(this));this.root.attr("aria-hidden","false")};p.prototype.accessibilityHide=function(){this.root.attr("aria-hidden","true");a.each(this.hiddenSiblings,function(b,c){c=a(c);var d=c.data("previous-aria-hidden");if("undefined"==typeof d){c.removeAttr("aria-hidden")}else{c.attr("aria-hidden",d)}});this.hiddenSiblings=[]};p.prototype.registerEventListeners=function(){this.getRoot().on("keydown",function(a){if(!this.isVisible()){return}if(a.keyCode==d.escape){if(this.removeOnClose){this.destroy()}else{this.hide()}}}.bind(this));this.getRoot().click(function(b){if(!a(b.target).closest(l.MODAL).length){if(a(b.target).closest(l.CONTAINER).length){this.hideIfNotForm()}}}.bind(this));e.define(this.getModal(),[e.events.activate]);this.getModal().on(e.events.activate,l.HIDE,function(a,b){this.hide();b.originalEvent.preventDefault()}.bind(this))};p.prototype.registerCloseOnCancel=function(){this.getModal().on(e.events.activate,this.getActionSelector("cancel"),function(b,c){var d=a.Event(h.cancel);this.getRoot().trigger(d,this);if(!d.isDefaultPrevented()){c.originalEvent.preventDefault();if(this.removeOnClose){this.destroy()}else{this.hide()}}}.bind(this))};p.prototype.registerCloseOnSave=function(){this.getModal().on(e.events.activate,this.getActionSelector("save"),function(b,c){var d=a.Event(h.save);this.getRoot().trigger(d,this);if(!d.isDefaultPrevented()){c.originalEvent.preventDefault();if(this.removeOnClose){this.destroy()}else{this.hide()}}}.bind(this))};p.prototype.asyncSet=function(b,d){var e=b;if("object"!==_typeof(b)||!b.hasOwnProperty("then")){e=a.Deferred();e.resolve(b)}e.then(function(a){d(a)}).fail(c.exception);return e};p.prototype.setButtonText=function(a,b){var c=this.getFooter().find(this.getActionSelector(a));if(!c){throw new Error("Unable to find the '"+a+"' button")}return this.asyncSet(b,c.text.bind(c))};p.prototype.getActionSelector=function(a){return"[data-action='"+a+"']"};p.prototype.setRemoveOnClose=function(a){this.removeOnClose=a};return p});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core/chart_base",["core/chart_series","core/chart_axis"],function(a,b){function c(){this._series=[];this._labels=[];this._xaxes=[];this._yaxes=[];this._setDefaults()}c.prototype._series=null;c.prototype._labels=null;c.prototype._legendOptions=null;c.prototype._title=null;c.prototype._xaxes=null;c.prototype._yaxes=null;c.prototype.COLORSET=["#f3c300","#875692","#f38400","#a1caf1","#be0032","#c2b280","#7f180d","#008856","#e68fac","#0067a5"];c.prototype._configColorSet=null;c.prototype.TYPE=null;c.prototype.addSeries=function(a){this._validateSeries(a);this._series.push(a);if(null===a.getColor()){var b=this.getConfigColorSet()||c.prototype.COLORSET;a.setColor(b[this._series.length%b.length])}};c.prototype.create=function(c,d){var e=new c;e.setConfigColorSet(d.config_colorset);e.setLabels(d.labels);e.setTitle(d.title);if(d.legend_options){e.setLegendOptions(d.legend_options)}d.series.forEach(function(b){e.addSeries(a.prototype.create(b))});d.axes.x.forEach(function(a,c){e.setXAxis(b.prototype.create(a),c)});d.axes.y.forEach(function(a,c){e.setYAxis(b.prototype.create(a),c)});return e};c.prototype.__getAxis=function(a,c,d){var e="x"===a?this._xaxes:this._yaxes,f=("x"===a?this.setXAxis:this.setYAxis).bind(this),g;c="undefined"==typeof c?0:c;d="undefined"==typeof d?!1:d;g=e[c];if("undefined"==typeof g){if(!d){throw new Error("Unknown axis.")}g=new b;f(g,c)}return g};c.prototype.getConfigColorSet=function(){return this._configColorSet};c.prototype.getLabels=function(){return this._labels};c.prototype.getLegendOptions=function(){return this._legendOptions};c.prototype.getSeries=function(){return this._series};c.prototype.getTitle=function(){return this._title};c.prototype.getType=function(){if(!this.TYPE){throw new Error("The TYPE property has not been set.")}return this.TYPE};c.prototype.getXAxes=function(){return this._xaxes};c.prototype.getXAxis=function(a,b){return this.__getAxis("x",a,b)};c.prototype.getYAxes=function(){return this._yaxes};c.prototype.getYAxis=function(a,b){return this.__getAxis("y",a,b)};c.prototype.setConfigColorSet=function(a){this._configColorSet=a};c.prototype._setDefaults=function(){};c.prototype.setLabels=function(a){if(a.length&&this._series.length&&this._series[0].length!=a.length){throw new Error("Series must match label values.")}this._labels=a};c.prototype.setLegendOptions=function(a){if("object"!==_typeof(a)){throw new Error("Setting legend with non-object value:"+a)}this._legendOptions=a};c.prototype.setTitle=function(a){this._title=a};c.prototype.setXAxis=function(a,b){b="undefined"==typeof b?0:b;this._validateAxis("x",a,b);this._xaxes[b]=a};c.prototype.setYAxis=function(a,b){b="undefined"==typeof b?0:b;this._validateAxis("y",a,b);this._yaxes[b]=a};c.prototype._validateAxis=function(a,b,c){c="undefined"==typeof c?0:c;if(0<c){var d="x"==a?this._xaxes:this._yaxes;if("undefined"==typeof d[c-1]){throw new Error("Missing "+a+" axis at index lower than "+c)}}};c.prototype._validateSeries=function(a){if(this._series.length&&this._series[0].getCount()!=a.getCount()){throw new Error("Series do not have an equal number of values.")}else if(this._labels.length&&this._labels.length!=a.getCount()){throw new Error("Series must match label values.")}};return c});
define ("core/modal_backdrop",["jquery","core/templates","core/notification","core/fullscreen"],function(a,b,c,d){var e={ROOT:"[data-region=\"modal-backdrop\"]"},f=function(b){this.root=a(b);this.isAttached=!1;this.attachmentPoint=document.createElement("div");document.body.append(this.attachmentPoint);if(!this.root.is(e.ROOT)){c.exception({message:"Element is not a modal backdrop"})}};f.prototype.getRoot=function(){return this.root};f.prototype.getAttachmentPoint=function(){return a(d.getElement()||this.attachmentPoint)};f.prototype.attachToDOM=function(){this.getAttachmentPoint().append(this.root);if(this.isAttached){return}this.isAttached=!0};f.prototype.setZIndex=function(a){this.root.css("z-index",a)};f.prototype.isVisible=function(){return this.root.hasClass("show")};f.prototype.hasTransitions=function(){return this.getRoot().hasClass("fade")};f.prototype.show=function(){if(this.isVisible()){return}this.attachToDOM();this.root.removeClass("hide").addClass("show")};f.prototype.hide=function(){if(!this.isVisible()){return}if(this.hasTransitions()){this.getRoot().one("transitionend webkitTransitionEnd oTransitionEnd",function(){this.getRoot().removeClass("show").addClass("hide")}.bind(this))}else{this.getRoot().removeClass("show").addClass("hide")}if(a(document.body).find(this.getRoot()).length){a(document.body).append(this.getRoot())}};f.prototype.destroy=function(){this.root.remove();this.attachmentPoint.remove()};return f});
define ("core/chart_builder",["jquery"],function(a){return{make:function make(b){var c=a.Deferred();require(["core/chart_"+b.type],function(a){var d=a.prototype.create(a,b);c.resolve(d)});return c.promise()}}});
define ("core/modal_cancel",["exports","core/modal"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);function c(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){c=function(a){return typeof a}}else{c=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return c(a)}function d(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function e(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function f(a,b,c){if(b)e(a.prototype,b);if(c)e(a,c);return a}function g(a,b,c){if("undefined"!=typeof Reflect&&Reflect.get){g=Reflect.get}else{g=function(a,b,c){var d=h(a,b);if(!d)return;var e=Object.getOwnPropertyDescriptor(d,b);if(e.get){return e.get.call(c)}return e.value}}return g(a,b,c||a)}function h(a,b){while(!Object.prototype.hasOwnProperty.call(a,b)){a=p(a);if(null===a)break}return a}function i(a,b){if("function"!=typeof b&&null!==b){throw new TypeError("Super expression must either be null or a function")}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});if(b)j(a,b)}function j(a,b){j=Object.setPrototypeOf||function(a,b){a.__proto__=b;return a};return j(a,b)}function k(a){return function(){var b=p(a),c;if(n()){var d=p(this).constructor;c=Reflect.construct(b,arguments,d)}else{c=b.apply(this,arguments)}return l(this,c)}}function l(a,b){if(b&&("object"===c(b)||"function"==typeof b)){return b}return m(a)}function m(a){if(void 0===a){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return a}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(a){return!1}}function p(a){p=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return p(a)}var q=function(a){i(b,a);var c=k(b);function b(a){var e;d(this,b);e=c.call(this,a);if(!e.getFooter().find(e.getActionSelector("cancel")).length){Notification.exception({message:"No cancel button found"})}return e}f(b,[{key:"registerEventListeners",value:function registerEventListeners(){g(p(b.prototype),"registerEventListeners",this).call(this);this.registerCloseOnCancel()}}]);return b}(b.default);a.default=q;return a.default});
define ("core/chart_line",["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}b.prototype=Object.create(a.prototype);b.prototype.TYPE="line";b.prototype._smooth=!1;b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);d.setSmooth(c.smooth);return d};b.prototype.getSmooth=function(){return this._smooth};b.prototype.setSmooth=function(a){this._smooth=!!a};return b});
define ("core/modal_events",[],function(){return{shown:"modal:shown",hidden:"modal:hidden",destroyed:"modal:destroyed",bodyRendered:"modal:bodyRendered",save:"modal-save-cancel:save",cancel:"modal-save-cancel:cancel"}});
define ("core/chart_output",["core/chart_output_chartjs"],function(a){return a});
define ("core/form-course-selector",["core/ajax","jquery"],function(a,b){return{processResults:function processResults(a,c){var d=[],e=0,f=(b(a).data("exclude")+"").split(",");for(e=0;e<c.courses.length;e++){if(-1===f.indexOf(c.courses[e].id+"")){d.push({value:c.courses[e].id,label:c.courses[e].displayname})}}return d},transport:function transport(c,d,e,f){var g=b(c),h=g.data("requiredcapabilities");if(""!==h.trim()){h=h.split(",")}else{h=[]}var i=g.data("limittoenrolled"),j=g.data("includefrontpage"),k=g.data("onlywithcompletion"),l=null;if("undefined"==typeof d){d=""}var m={criterianame:"search",criteriavalue:d,page:0,perpage:100,requiredcapabilities:h,limittoenrolled:i,onlywithcompletion:k},n=[{methodname:"core_course_search_courses",args:m}];if(j){n.push({methodname:"core_course_get_courses",args:{options:{ids:[j]}}})}l=a.call(n);b.when.apply(b.when,l).done(function(a,b){if(b&&1==b.length){var c=b.pop(),f=""===d||-1<c.fullname.toUpperCase().indexOf(d.toUpperCase())||-1<c.shortname.toUpperCase().indexOf(d.toUpperCase());if(f){a.courses.splice(0,0,c)}}e(a)}).fail(f)}}});
define ("core/chart_output_base",["jquery"],function(a){function b(b,c){this._node=a(b);this._chart=c}b.prototype.update=function(){throw new Error("Not supported.")};return b});
define ("core/fragment",["jquery","core/ajax"],function(a,b){var c=function loadFragment(a,c,d,e){var f=[];for(var g in e){f.push({name:g,value:e[g]})}return b.call([{methodname:"core_get_fragment",args:{component:a,callback:c,contextid:d,args:f}}])[0]};return{loadFragment:function loadFragment(b,d,e,f){var g=a.Deferred();c(b,d,e,f).then(function(b){var c=a(b.javascript),d="";c.each(function(b,c){c=a(c);var e=c.prop("tagName");if(e&&"script"==e.toLowerCase()){if(c.attr("src")){var f=!1;a("script").each(function(b,d){if(a(d).attr("src")==c.attr("src")){f=!0}return!f});if(!f){d+=" { ";d+=" node = document.createElement(\"script\"); ";d+=" node.type = \"text/javascript\"; ";d+=" node.src = decodeURI(\""+encodeURI(c.attr("src"))+"\"); ";d+=" document.getElementsByTagName(\"head\")[0].appendChild(node); ";d+=" } "}}else{d+=" "+c.text()}}});g.resolve(b.html,d)}).fail(function(a){g.reject(a)});return g.promise()}}});
define ("core/chart_output_chartjs",["jquery","core/chartjs","core/chart_axis","core/chart_bar","core/chart_output_base","core/chart_line","core/chart_pie","core/chart_series"],function(a,b,c,d,e,f,g,h){var j=function(a,b){return"axis-"+a+"-"+b};function i(){e.prototype.constructor.apply(this,arguments);this._canvas=this._node;if("CANVAS"!=this._canvas.prop("tagName")){this._canvas=a("<canvas>");this._node.append(this._canvas)}this._build()}i.prototype=Object.create(e.prototype);i.prototype._config=null;i.prototype._chartjs=null;i.prototype._canvas=null;i.prototype._build=function(){this._config=this._makeConfig();this._chartjs=new b(this._canvas[0],this._config)};i.prototype._cleanData=function(b){if(b instanceof Array){return b.map(function(b){return a("<span>").html(b).text()})}else{return a("<span>").html(b).text()}};i.prototype._getChartType=function(){var a=this._chart.getType();if(this._chart.getType()===d.prototype.TYPE&&!0===this._chart.getHorizontal()){a="horizontalBar"}else if(this._chart.getType()===g.prototype.TYPE&&!0===this._chart.getDoughnut()){a="doughnut"}return a};i.prototype._makeAxisConfig=function(a,b,d){var e={id:j(b,d)};if(a.getPosition()!==c.prototype.POS_DEFAULT){e.position=a.getPosition()}if(null!==a.getLabel()){e.scaleLabel={display:!0,labelString:this._cleanData(a.getLabel())}}if(null!==a.getStepSize()){e.ticks=e.ticks||{};e.ticks.stepSize=a.getStepSize()}if(null!==a.getMax()){e.ticks=e.ticks||{};e.ticks.max=a.getMax()}if(null!==a.getMin()){e.ticks=e.ticks||{};e.ticks.min=a.getMin()}return e};i.prototype._makeConfig=function(){var a={type:this._getChartType(),data:{labels:this._cleanData(this._chart.getLabels()),datasets:this._makeDatasetsConfig()},options:{title:{display:null!==this._chart.getTitle(),text:this._cleanData(this._chart.getTitle())}}},b=this._chart.getLegendOptions();if(b){a.options.legend=b}this._chart.getXAxes().forEach(function(b,c){var d=b.getLabels();a.options.scales=a.options.scales||{};a.options.scales.xAxes=a.options.scales.xAxes||[];a.options.scales.xAxes[c]=this._makeAxisConfig(b,"x",c);if(null!==d){a.options.scales.xAxes[c].ticks.callback=function(a,b){return d[b]||""}}a.options.scales.xAxes[c].stacked=this._isStacked()}.bind(this));this._chart.getYAxes().forEach(function(b,c){var d=b.getLabels();a.options.scales=a.options.scales||{};a.options.scales.yAxes=a.options.scales.yAxes||[];a.options.scales.yAxes[c]=this._makeAxisConfig(b,"y",c);if(null!==d){a.options.scales.yAxes[c].ticks.callback=function(a){return d[parseInt(a,10)]||""}}a.options.scales.yAxes[c].stacked=this._isStacked()}.bind(this));a.options.tooltips={callbacks:{label:this._makeTooltip.bind(this)}};return a};i.prototype._makeDatasetsConfig=function(){var a=this._chart.getSeries().map(function(a){var b=a.hasColoredValues()?a.getColors():a.getColor(),c={label:this._cleanData(a.getLabel()),data:a.getValues(),type:a.getType(),fill:a.getFill(),backgroundColor:b,borderColor:this._chart.getType()==g.prototype.TYPE?"#fff":b,lineTension:this._isSmooth(a)?.3:0};if(null!==a.getXAxis()){c.xAxisID=j("x",a.getXAxis())}if(null!==a.getYAxis()){c.yAxisID=j("y",a.getYAxis())}return c}.bind(this));return a};i.prototype._makeTooltip=function(a,b){var c=this._chart.getSeries()[a.datasetIndex],d=c.getLabel(),e=c.getLabels(),f=b.datasets[a.datasetIndex].data,g=f[a.index],h=[];if(""==a.xLabel&&""==a.yLabel){var i=this._cleanData(this._chart.getLabels());h.push(i[a.index])}if(null!==e){h.push(this._cleanData(e[a.index]))}else{h.push(this._cleanData(d)+": "+g)}return h};i.prototype._isSmooth=function(a){var b=!1;if(this._chart.getType()===f.prototype.TYPE){b=a.getSmooth();if(null===b){b=this._chart.getSmooth()}}else if(a.getType()===h.prototype.TYPE_LINE){b=a.getSmooth()}return b};i.prototype._isStacked=function(){var a=!1;if(this._chart.getType()===d.prototype.TYPE){a=this._chart.getStacked()}return a};i.prototype.update=function(){a.extend(!0,this._config,this._makeConfig());this._chartjs.update()};return i});
define ("core/pubsub",["exports","core/pending"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.publish=a.unsubscribe=a.subscribe=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);var c={};a.subscribe=function subscribe(a,b){c[a]=c[a]||[];c[a].push(b)};a.unsubscribe=function unsubscribe(a,b){if(c[a]){for(var d=0;d<c[a].length;d++){if(c[a][d]===b){c[a].splice(d,1);break}}}};var d=function(a,d){var e=new b.default("Publishing "+a);if(c[a]){c[a].forEach(function(a){a(d)})}e.resolve()};a.publish=d});
define ("core/fullscreen",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.getElement=void 0;a.getElement=function getElement(){var a=null;if(document.fullscreenElement){a=document.fullscreenElement}else if(document.mozFullscreenElement){a=document.mozFullscreenElement}else if(document.msFullscreenElement){a=document.msFullscreenElement}else if(document.webkitFullscreenElement){a=document.webkitFullscreenElement}return a}});
define ("core/chart_output_htmltable",["jquery","core/chart_output_base"],function(a,b){function c(){b.prototype.constructor.apply(this,arguments);this._build()}c.prototype=Object.create(b.prototype);c.prototype._build=function(){this._node.empty();this._node.append(this._makeTable())};c.prototype._makeTable=function(){var b=a("<table>"),d=this._chart,c,e,f=d.getLabels(),g=0<f.length,h=d.getSeries(),i,j=h[0].getCount();b.addClass("chart-output-htmltable generaltable");if(null!==d.getTitle()){b.append(a("<caption>").text(d.getTitle()))}c=a("<tr>");if(g){c.append(a("<td>"))}h.forEach(function(b){c.append(a("<th>").text(b.getLabel()).attr("scope","col"))});b.append(c);for(var k=0;k<j;k++){c=a("<tr>");if(0<f.length){c.append(a("<th>").text(f[k]).attr("scope","row"))}for(var l=0;l<h.length;l++){e=h[l].getValues()[k];i=h[l].getLabels();if(null!==i){e=h[l].getLabels()[k]}c.append(a("<td>").text(e))}b.append(c)}return b};c.prototype.update=function(){this._build()};return c});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core/drawer",["exports","jquery","core/pubsub","core/drawer_events"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=g(b);c=f(c);d=g(d);function e(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;e=function(){return a};return a}function f(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=e();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a){if(Object.prototype.hasOwnProperty.call(a,f)){var g=d?Object.getOwnPropertyDescriptor(a,f):null;if(g&&(g.get||g.set)){Object.defineProperty(c,f,g)}else{c[f]=a[f]}}}c.default=a;if(b){b.set(a,c)}return c}function g(a){return a&&a.__esModule?a:{default:a}}var h=function(a){a.removeClass("hidden");a.attr("aria-expanded",!0);a.removeAttr("aria-hidden");a.focus();c.publish(d.default.DRAWER_SHOWN,a)},i=function(a){a.addClass("hidden");a.attr("aria-expanded",!1);a.attr("aria-hidden",!0);c.publish(d.default.DRAWER_HIDDEN,a)},j=function(a){var b=a.hasClass("hidden");return!b},k=function(a){if(j(a)){i(a)}else{h(a)}},l=function(a){a=(0,b.default)(a);return a.closest("[data-region=\"right-hand-drawer\"]")};a.default={hide:i,show:h,isVisible:j,toggle:k,registerToggles:function registerToggles(a,b){var c=null;b.attr("aria-expanded",j(a));b.on("click",function(d){d.preventDefault();var e=j(a);k(a);b.attr("aria-expanded",!e);if(!e){c=b.filter(function(a,b){return b==d.target||b.contains(d.target)})}else if(c){c.focus();c=null}})},getDrawerRoot:l};return a.default});
define ("core/chart_pie",["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}b.prototype=Object.create(a.prototype);b.prototype.TYPE="pie";b.prototype._doughnut=null;b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);d.setDoughnut(c.doughnut);return d};b.prototype.addSeries=function(b){if(null===b.getColor()){for(var c=[],d=this.getConfigColorSet()||a.prototype.COLORSET,e=0;e<b.getCount();e++){c.push(d[e%d.length])}b.setColors(c)}return a.prototype.addSeries.apply(this,arguments)};b.prototype.getDoughnut=function(){return this._doughnut};b.prototype.setDoughnut=function(a){this._doughnut=!!a};b.prototype._validateSeries=function(){if(1<=this._series.length){throw new Error("Pie charts only support one serie.")}return a.prototype._validateSeries.apply(this,arguments)};return b});
function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(!a)return;if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return _arrayLikeToArray(a,b)}function _arrayLikeToArray(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function _iterableToArrayLimit(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function _arrayWithHoles(a){if(Array.isArray(a))return a}define ("core/modal_factory",["jquery","core/modal_events","core/modal_registry","core/modal","core/modal_save_cancel","core/modal_cancel","core/local/modal/alert","core/templates","core/notification","core/custom_interaction_events","core/pending"],function(a,b,c,d,e,f,g,h,i,j,k){var l={DEFAULT:"core/modal",SAVE_CANCEL:"core/modal_save_cancel",CANCEL:"core/modal_cancel",ALERT:"core/local/modal/alert"},m={DEFAULT:"DEFAULT",SAVE_CANCEL:"SAVE_CANCEL",CANCEL:"CANCEL",ALERT:"ALERT"};c.register(m.DEFAULT,d,l.DEFAULT);c.register(m.SAVE_CANCEL,e,l.SAVE_CANCEL);c.register(m.CANCEL,f,l.CANCEL);c.register(m.ALERT,g,l.ALERT);var n=function(c,d,e){var f=null,g="function"==typeof e.preShowCallback,h=function(b,d){var h=new k("core/modal_factory:setUpTrigger:triggeredCallback");f=a(b.currentTarget);c.then(function(a){if(g){e.preShowCallback(f,a)}a.show();return a}).then(h.resolve);d.originalEvent.preventDefault()};if(Array.isArray(d)){var i=d[1];d=d[0];j.define(d,[j.events.activate]);d.on(j.events.activate,i,h)}else{j.define(d,[j.events.activate]);d.on(j.events.activate,h)}c.then(function(a){a.getRoot().on(b.hidden,function(){if(null!==f){f.focus()}});return a})},o=function(b,c){c=a(c);var d=b.module,e=new d(c);return e},p=function(b,c){var d=b.template,e=h.render(d,c).then(function(c){var d=a(c);return o(b,d)}).fail(i.exception);return e};return{create:function create(a,b){var d=a.type||m.DEFAULT,e=a.large?!0:!1,f=a.xlarge?!0:!1,g=null,h={};g=c.get(d);if(!g){i.exception({message:"Unable to find modal of type: "+d})}if("undefined"!=typeof a.templateContext){h=a.templateContext}var j=p(g,h).then(function(b){if("undefined"!=typeof a.title){b.setTitle(a.title)}if("undefined"!=typeof a.body){b.setBody(a.body)}if("undefined"!=typeof a.footer){b.setFooter(a.footer)}if(a.buttons){Object.entries(a.buttons).forEach(function(a){var c=_slicedToArray(a,2),d=c[0],e=c[1];b.setButtonText(d,e)})}if(e){b.setLarge()}if(f){b.setXLarge()}if("undefined"!=typeof a.removeOnClose){b.setRemoveOnClose(a.removeOnClose)}return b});if("undefined"!=typeof b){n(j,b,a)}return j},types:m}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core/chart_series",[],function(){function a(a,b){if("string"!=typeof a){throw new Error("Invalid label for series.")}else if("object"!==_typeof(b)){throw new Error("Values for a series must be an array.")}else if(1>b.length){throw new Error("Invalid values received for series.")}this._colors=[];this._label=a;this._values=b}a.prototype.TYPE_DEFAULT=null;a.prototype.TYPE_LINE="line";a.prototype._colors=null;a.prototype._fill=!1;a.prototype._label=null;a.prototype._labels=null;a.prototype._smooth=!1;a.prototype._type=a.prototype.TYPE_DEFAULT;a.prototype._values=null;a.prototype._xaxis=null;a.prototype._yaxis=null;a.prototype.create=function(b){var c=new a(b.label,b.values);c.setType(b.type);c.setXAxis(b.axes.x);c.setYAxis(b.axes.y);c.setLabels(b.labels);if(b.colors&&1<b.colors.length){c.setColors(b.colors)}else{c.setColor(b.colors[0])}c.setFill(b.fill);c.setSmooth(b.smooth);return c};a.prototype.getColor=function(){return this._colors[0]||null};a.prototype.getColors=function(){return this._colors};a.prototype.getCount=function(){return this._values.length};a.prototype.getFill=function(){return this._fill};a.prototype.getLabel=function(){return this._label};a.prototype.getLabels=function(){return this._labels};a.prototype.getSmooth=function(){return this._smooth};a.prototype.getType=function(){return this._type};a.prototype.getValues=function(){return this._values};a.prototype.getXAxis=function(){return this._xaxis};a.prototype.getYAxis=function(){return this._yaxis};a.prototype.hasColoredValues=function(){return this._colors.length==this.getCount()};a.prototype.setColor=function(a){this._colors=[a]};a.prototype.setColors=function(a){if(a&&a.length!=this.getCount()){throw new Error("When setting multiple colors there must be one per value.")}this._colors=a||[]};a.prototype.setFill=function(a){this._fill="undefined"==typeof a?null:a};a.prototype.setLabels=function(a){this._validateLabels(a);a="undefined"==typeof a?null:a;this._labels=a};a.prototype.setSmooth=function(a){a="undefined"==typeof a?null:a;this._smooth=a};a.prototype.setType=function(a){if(a!=this.TYPE_DEFAULT&&a!=this.TYPE_LINE){throw new Error("Invalid serie type.")}this._type=a||null};a.prototype.setXAxis=function(a){this._xaxis=a||null};a.prototype.setYAxis=function(a){this._yaxis=a||null};a.prototype._validateLabels=function(a){if(a&&0<a.length&&a.length!=this.getCount()){throw new Error("Series labels must match series values.")}};return a});
define ("core/modal_registry",["core/notification","core/prefetch"],function(a,b){var c={},d=function(a){return c[a]};return{register:function register(e,f,g){if(d(e)){a.exception({message:"Modal of  type '"+e+"' is already registered"})}if(!f||"function"!=typeof f){a.exception({message:"You must provide a modal module"})}if(!g){a.exception({message:"You must provide a modal template"})}c[e]={module:f,template:g};b.prefetchTemplate(g)},get:d}});
define ("core/icon_system",["jquery"],function(a){var b=function(){};b.prototype.init=function(){return a.when(this)};b.prototype.renderIcon=function(){throw new Error("Abstract function not implemented.")};b.prototype.getTemplateName=function(){throw new Error("Abstract function not implemented.")};return b});
define ("core/chartjs",["core/chartjs-lazy"],function(a){return a});
define ("core/modal_save_cancel",["exports","core/modal"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);function c(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){c=function(a){return typeof a}}else{c=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return c(a)}function d(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function e(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function f(a,b,c){if(b)e(a.prototype,b);if(c)e(a,c);return a}function g(a,b,c){if("undefined"!=typeof Reflect&&Reflect.get){g=Reflect.get}else{g=function(a,b,c){var d=h(a,b);if(!d)return;var e=Object.getOwnPropertyDescriptor(d,b);if(e.get){return e.get.call(c)}return e.value}}return g(a,b,c||a)}function h(a,b){while(!Object.prototype.hasOwnProperty.call(a,b)){a=p(a);if(null===a)break}return a}function i(a,b){if("function"!=typeof b&&null!==b){throw new TypeError("Super expression must either be null or a function")}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});if(b)j(a,b)}function j(a,b){j=Object.setPrototypeOf||function(a,b){a.__proto__=b;return a};return j(a,b)}function k(a){return function(){var b=p(a),c;if(n()){var d=p(this).constructor;c=Reflect.construct(b,arguments,d)}else{c=b.apply(this,arguments)}return l(this,c)}}function l(a,b){if(b&&("object"===c(b)||"function"==typeof b)){return b}return m(a)}function m(a){if(void 0===a){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return a}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(a){return!1}}function p(a){p=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return p(a)}var q=function(a){i(b,a);var c=k(b);function b(a){var e;d(this,b);e=c.call(this,a);if(!e.getFooter().find(e.getActionSelector("save")).length){Notification.exception({message:"No save button found"})}if(!e.getFooter().find(e.getActionSelector("cancel")).length){Notification.exception({message:"No cancel button found"})}return e}f(b,[{key:"registerEventListeners",value:function registerEventListeners(){g(p(b.prototype),"registerEventListeners",this).call(this);this.registerCloseOnSave();this.registerCloseOnCancel()}},{key:"setFooter",value:function setFooter(){Notification.exception({message:"Can not change the footer of a save cancel modal"})}},{key:"setSaveButtonText",value:function setSaveButtonText(a){return this.setButtonText("save",a)}}]);return b}(b.default);a.default=q;return a.default});
define ("core/checkbox-toggleall",["jquery","core/pubsub"],function(a,b){var c=!1,d={checkboxToggled:"core/checkbox-toggleall:checkboxToggled"},e=function(a,b,c){if(c){return a.find("[data-action=\"toggle\"][data-togglegroup=\""+b+"\"]")}else{return a.find("[data-action=\"toggle\"][data-togglegroup^=\""+b+"\"]")}},f=function(a,b){return e(a,b,!1).filter("[data-toggle=\"slave\"]")},g=function(a,b,c){return e(a,b,c).filter("[data-toggle=\"master\"]")},h=function(a,b){return e(a,b,!0).filter("[data-toggle=\"action\"]")},i=function(b){var c=b.data.root,d=a(b.target),e=d.data("togglegroup"),f;if(d.is(":checkbox")){f=d.is(":checked")}else{f=1===d.data("checkall")}l(c,e,f)},j=function(a,b){var c=f(a,b);if(0<c.length){var d=c.filter(":checked"),e=c.length===d.length;o(a,b,e,!0);n(a,b,!d.length)}},k=function(a){var b=a.split(" "),c=[],d="";b.forEach(function(a){d+=" "+a;c.push(d.trim())});return c},l=function(a,c,e){var g=f(a,c);g.prop("checked",e).trigger("change");var h=g.filter(":checked");o(a,c,e,!1);n(a,c,!h.length);var i=k(c).filter(function(a){return a!==c});i.forEach(function(b){j(a,b)});b.publish(d.checkboxToggled,{root:a,toggleGroupName:c,slaves:g,checkedSlaves:h,anyChecked:e})},m=function(c){var e=c.data.root,g=a(c.target),h=g.data("togglegroup"),i=f(e,h),l=i.filter(":checked"),m=k(h);m.forEach(function(a){j(e,a)});b.publish(d.checkboxToggled,{root:e,toggleGroupName:h,slaves:i,checkedSlaves:l,anyChecked:!!l.length})},n=function(a,b,c){h(a,b).prop("disabled",c)},o=function(b,c,d,e){var f=g(b,c,e);f.prop("checked",d);f.each(function(c,e){e=a(e);var f;if(d){f=e.data("toggle-deselectall")}else{f=e.data("toggle-selectall")}if(e.is(":checkbox")){var g=b.find("[for=\""+e.attr("id")+"\"]");if(g.length){if(g.html()!==f){g.html(f)}}}else{e.text(f);e.data("checkall",d?0:1)}})},p=function(){if(!c){c=!0;var b=a(document.body);b.on("click","[data-action=\"toggle\"][data-toggle=\"master\"]",{root:b},i);b.on("click","[data-action=\"toggle\"][data-toggle=\"slave\"]",{root:b},m)}};return{init:function init(){p()},events:d,setGroupState:function setGroupState(b,c,d){b=a(b);o(b,c,d,!0);l(b,c,d)},updateSlavesFromMasterState:function updateSlavesFromMasterState(b,c){b=a(b);var d=g(b,c,!1),e;if(d.is(":checkbox")){e=d.is(":checked")}else{e=1===d.data("checkall")}l(b,c,e)}}});
define ("core/icon_system_fontawesome",["core/icon_system","jquery","core/ajax","core/mustache","core/localstorage","core/url"],function(a,b,c,d,e,f){var g=null,h=null,i=function(){a.apply(this,arguments)};i.prototype=Object.create(a.prototype);i.prototype.init=function(){var a=M.cfg.theme;if(g){return b.when(this)}var d=e.get("core_iconsystem/theme/"+a+"/core/iconmap-fontawesome");if(d){d=JSON.parse(d)}if(d){g=d;return b.when(this)}if(null===h){h=c.call([{methodname:"core_output_load_fontawesome_icon_system_map",args:{themename:M.cfg.theme}}],!0,!1,!1,0,M.cfg.themerev)[0]}return h.then(function(c){g={};b.each(c,function(a,b){g[b.component+"/"+b.pix]=b.to});e.set("core_iconsystem/theme/"+a+"/core/iconmap-fontawesome",JSON.stringify(g));return this}.bind(this))};i.prototype.renderIcon=function(a,b,c,e){var h=g[b+"/"+a],i=!1;if("undefined"==typeof h){var j=f.imageUrl(a,b);i={attributes:[{name:"src",value:j},{name:"alt",value:c},{name:"title",value:c}]}}var k={key:h,title:c,alt:c,unmappedIcon:i};if("undefined"==typeof c||""===c){k["aria-hidden"]=!0}var l=d.render(e,k);return l.trim()};i.prototype.getTemplateName=function(){return"core/pix_icon_fontawesome"};return i});
define ("core/notification",["exports","core/pending","core/log"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=a.init=a.exception=a.saveCancel=a.confirm=a.alert=a.addNotification=a.fetchNotifications=void 0;b=d(b);c=d(c);var q="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){return k(a)||j(a,b)||g(a,b)||f()}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(a,b){if(!a)return;if("string"==typeof a)return h(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return h(a,b)}function h(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function j(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function k(a){if(Array.isArray(a))return a}function l(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function m(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){l(Object(c),!0).forEach(function(b){n(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{l(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function n(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function o(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function p(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){o(h,d,e,f,g,"next",a)}function g(a){o(h,d,e,f,g,"throw",a)}f(void 0)})}}var r=M.cfg.contextid,s={success:"core/notification_success",info:"core/notification_info",warning:"core/notification_warning",error:"core/notification_error"},t="user-notifications",u={notificationRegion:"#".concat(t),fallbackRegionParents:["#region-main","[role=\"main\"]","body"]},v=function(){var a=A();if(a){return!1}var b=document.createElement("span");b.id=t;return u.fallbackRegionParents.some(function(a){var c=document.querySelector(a);if(c){c.prepend(b);return!0}return!1})},w=function(){var a=p(regeneratorRuntime.mark(function a(){var b;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:a.next=2;return"function"==typeof q.define&&q.define.amd?new Promise(function(a,b){q.require(["core/ajax"],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&q.require&&"component"===q.require.loader?Promise.resolve(require(("core/ajax"))):Promise.resolve(q["core/ajax"]);case 2:b=a.sent;return a.abrupt("return",b.call([{methodname:"core_fetch_notifications",args:{contextid:r}}])[0].then(x));case 4:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.fetchNotifications=w;var x=function(a){if(!a.length){return Promise.resolve()}var c=new b.default("core/notification:addNotifications");a.forEach(function(a){return z(a.template,a.variables)});return c.resolve()},y=function(a){var c=new b.default("core/notification:addNotifications"),d=s.error;a=m({closebutton:!0,announce:!0,type:"error"},a);if(a.template){d=a.template;delete a.template}else if(a.type){if("undefined"!=typeof s[a.type]){d=s[a.type]}delete a.type}return z(d,a).then(c.resolve)};a.addNotification=y;var z=function(){var a=p(regeneratorRuntime.mark(function a(d,e){var f,g;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:if(!("undefined"==typeof e.message||!e.message)){a.next=3;break}c.default.debug("Notification received without content. Skipping.");return a.abrupt("return");case 3:f=new b.default("core/notification:renderNotification");a.next=6;return"function"==typeof q.define&&q.define.amd?new Promise(function(a,b){q.require(["core/templates"],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&q.require&&"component"===q.require.loader?Promise.resolve(require(("core/templates"))):Promise.resolve(q["core/templates"]);case 6:g=a.sent;g.renderForPromise(d,e).then(function(a){var b=a.html,c=a.js,d=void 0===c?"":c;g.prependNodeContents(A(),b,d);return}).then(f.resolve).catch(E);case 8:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),A=function(){return document.querySelector(u.notificationRegion)},B=function(){var a=p(regeneratorRuntime.mark(function a(c,d,e){var f,g;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:f=new b.default("core/notification:alert");a.next=3;return"function"==typeof q.define&&q.define.amd?new Promise(function(a,b){q.require(["core/modal_factory"],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&q.require&&"component"===q.require.loader?Promise.resolve(require(("core/modal_factory"))):Promise.resolve(q["core/modal_factory"]);case 3:g=a.sent;return a.abrupt("return",g.create({type:g.types.ALERT,body:d,title:c,buttons:{cancel:e},removeOnClose:!0}).then(function(a){a.show();f.resolve();return a}));case 5:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.alert=B;var C=function(a,b,c,d,e,f){return D(a,b,c,e,f)};a.confirm=C;var D=function(){var a=p(regeneratorRuntime.mark(function a(c,d,f,g,h){var i,j,k,l,m;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:i=new b.default("core/notification:confirm");a.next=3;return Promise.all(["function"==typeof q.define&&q.define.amd?new Promise(function(a,b){q.require(["core/modal_factory"],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&q.require&&"component"===q.require.loader?Promise.resolve(require(("core/modal_factory"))):Promise.resolve(q["core/modal_factory"]),"function"==typeof q.define&&q.define.amd?new Promise(function(a,b){q.require(["core/modal_events"],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&q.require&&"component"===q.require.loader?Promise.resolve(require(("core/modal_events"))):Promise.resolve(q["core/modal_events"])]);case 3:j=a.sent;k=e(j,2);l=k[0];m=k[1];return a.abrupt("return",l.create({type:l.types.SAVE_CANCEL,title:c,body:d,buttons:{save:f},removeOnClose:!0}).then(function(a){a.show();a.getRoot().on(m.save,g);a.getRoot().on(m.cancel,h);i.resolve();return a}));case 8:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.saveCancel=D;var E=function(){var a=p(regeneratorRuntime.mark(function a(c){var d,e,f,g;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:d=new b.default("core/notification:displayException");if(!c.stack){c.stack=""}if(c.debuginfo){c.stack+=c.debuginfo+"\n"}if(!c.backtrace&&c.stacktrace){c.backtrace=c.stacktrace}if(c.backtrace){c.stack+=c.backtrace;e=c.backtrace.match(/line ([^ ]*) of/);f=c.backtrace.match(/ of ([^:]*): /);if(e&&e[1]){c.lineNumber=e[1]}if(f&&f[1]){c.fileName=f[1];if(30<c.fileName.length){c.fileName="..."+c.fileName.substr(c.fileName.length-27)}}}if("undefined"==typeof c.name&&c.errorcode){c.name=c.errorcode}a.next=8;return"function"==typeof q.define&&q.define.amd?new Promise(function(a,b){q.require(["core/yui"],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&q.require&&"component"===q.require.loader?Promise.resolve(require(("core/yui"))):Promise.resolve(q["core/yui"]);case 8:g=a.sent;g.use("moodle-core-notification-exception",function(){var a=new M.core.exception(c);a.show();d.resolve()});case 10:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.exception=E;var F=function(a,b,c){r=a;v();x(b);if(c){w()}};a.init=F;a.default={init:F,fetchNotifications:w,addNotification:y,alert:B,confirm:C,saveCancel:D,exception:E};return a.default});
define ("core/config",function(){return M.cfg});
define ("core/str",["exports","jquery","core/ajax","core/localstorage"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.cache_strings=a.get_strings=a.get_string=void 0;b=e(b);c=e(c);d=e(d);function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function g(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){f(Object(c),!0).forEach(function(b){h(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{f(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function h(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}var i=[];a.get_string=function get_string(a,b,c,d){return j([{key:a,component:b,param:c,lang:d}]).then(function(a){return a[0]})};var j=function(a){var e=[],f=(0,b.default)("html").attr("lang").replace(/-/g,"_"),j=function(a){var b=a.key,c=a.component,d=a.lang,e=void 0===d?f:d;if(!c){c="core"}return"core_str/".concat(b,"/").concat(c,"/").concat(e)},k=a.map(function(a){var b=j(a),c=a.component,k=a.key,l=a.param,m=a.lang,n=void 0===m?f:m,o=function(a){i[b]=a;return a};if(c in M.str&&k in M.str[c]){return o(new Promise(function(a){a(M.util.get_string(k,c,l,n))}))}var p=d.default.get(b);if(p){M.str[c]=g({},M.str[c],h({},k,p));return o(new Promise(function(a){a(M.util.get_string(k,c,l,n))}))}if(b in i){return o(i[b]).then(function(){return M.util.get_string(k,c,l,n)})}else{return o(new Promise(function(a,f){e.push({methodname:"core_get_string",args:{stringid:k,stringparams:[],component:c,lang:n},done:function done(e){M.str[c]=g({},M.str[c],h({},k,e));d.default.set(b,e);a(M.util.get_string(k,c,l,n))},fail:f})}))}});if(e.length){c.default.call(e,!0,!1,!1,0,M.cfg.langrev)}return b.default.when.apply(b.default,k).then(function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++){b[c]=arguments[c]}return b})};a.get_strings=j;var k=function(a){var c=(0,b.default)("html").attr("lang").replace(/-/g,"_");a.forEach(function(a){var e=a.key,f=a.component,g=a.value,h=a.lang,j=void 0===h?c:h,k=["core_str",e,f,j].join("/");if(!(f in M.str)||!(e in M.str[f])){if(!(f in M.str)){M.str[f]={}}M.str[f][e]=g}if(!d.default.get(k)){d.default.set(k,g)}if(!(k in i)){i[k]=b.default.Deferred().resolve(g).promise()}})};a.cache_strings=k});
define ("core/custom_interaction_events",["jquery","core/key_codes"],function(a,b){var c={activate:"cie:activate",keyboardActivate:"cie:keyboardactivate",escape:"cie:escape",down:"cie:down",up:"cie:up",home:"cie:home",end:"cie:end",next:"cie:next",previous:"cie:previous",asterix:"cie:asterix",scrollLock:"cie:scrollLock",scrollTop:"cie:scrollTop",scrollBottom:"cie:scrollBottom",ctrlPageUp:"cie:ctrlPageUp",ctrlPageDown:"cie:ctrlPageDown",enter:"cie:enter",accessibleChange:"cie:accessibleChange"},d={},e=function(a,b){b=b||[];if(b.length&&-1!==b.indexOf(a)){return!0}return!1},f=function(a){return a.shiftKey||a.metaKey||a.altKey||a.ctrlKey},g=function(b,c){var e="";if(!c.hasOwnProperty("originalEvent")){e=""+b+c.type+c.timeStamp;if(!d.hasOwnProperty(e)){d[e]=!0;a(c.target).trigger(b,[{originalEvent:c}])}return}e="triggeredCustom_"+b;if(!c.originalEvent.hasOwnProperty(e)){c.originalEvent[e]=!0;a(c.target).trigger(b,[{originalEvent:c}])}},h=function(a,b,c){a.off("keydown."+b).on("keydown."+b,function(a){if(!f(a)){if(a.keyCode==c){g(b,a)}}})},i=function(a){a.off("click.cie.activate").on("click.cie.activate",function(a){g(c.activate,a)});a.off("keydown.cie.activate").on("keydown.cie.activate",function(a){if(!f(a)){if(a.keyCode==b.enter||a.keyCode==b.space){g(c.activate,a)}}})},j=function(a){a.off("keydown.cie.keyboardactivate").on("keydown.cie.keyboardactivate",function(a){if(!f(a)){if(a.keyCode==b.enter||a.keyCode==b.space){g(c.keyboardActivate,a)}}})},k=function(a){h(a,c.escape,b.escape)},l=function(a){h(a,c.down,b.arrowDown)},m=function(a){h(a,c.up,b.arrowUp)},n=function(a){h(a,c.home,b.home)},o=function(a){h(a,c.end,b.end)},p=function(d){var e="rtl"==a("html").attr("dir")?b.arrowLeft:b.arrowRight;h(d,c.next,e)},q=function(d){var e="rtl"==a("html").attr("dir")?b.arrowRight:b.arrowLeft;h(d,c.previous,e)},r=function(a){h(a,c.asterix,b.asterix)},s=function(a){a.off("scroll.cie.scrollTop").on("scroll.cie.scrollTop",function(b){var d=a.scrollTop();if(0===d){g(c.scrollTop,b)}})},t=function(a){a.off("scroll.cie.scrollBottom").on("scroll.cie.scrollBottom",function(b){var d=a.scrollTop(),e=a.innerHeight(),f=a[0].scrollHeight;if(d+e>=f){g(c.scrollBottom,b)}})},u=function(a){a.off("DOMMouseScroll.cie.DOMMouseScrollLock mousewheel.cie.mousewheelLock").on("DOMMouseScroll.cie.DOMMouseScrollLock mousewheel.cie.mousewheelLock",function(b){var d=a.scrollTop(),e=a[0].scrollHeight,f=a.height(),h="DOMMouseScroll"==b.type?-40*b.originalEvent.detail:b.originalEvent.wheelDelta,i=0<h;if(!i&&-h>e-f-d){a.scrollTop(e);b.stopPropagation();b.preventDefault();b.returnValue=!1;g(c.scrollLock,b);return!1}else if(i&&h>d){a.scrollTop(0);b.stopPropagation();b.preventDefault();b.returnValue=!1;g(c.scrollLock,b);return!1}return!0})},v=function(a){a.off("keydown.cie.ctrlpageup").on("keydown.cie.ctrlpageup",function(a){if(a.ctrlKey){if(a.keyCode==b.pageUp){g(c.ctrlPageUp,a)}}})},w=function(a){a.off("keydown.cie.ctrlpagedown").on("keydown.cie.ctrlpagedown",function(a){if(a.ctrlKey){if(a.keyCode==b.pageDown){g(c.ctrlPageDown,a)}}})},x=function(a){h(a,c.enter,b.enter)},y=function(a){var d=-1!==navigator.userAgent.indexOf("Macintosh"),e="ontouchstart"in window||"msMaxTouchPoints"in navigator&&0<navigator.msMaxTouchPoints;if(d||e){a.on("change",function(a){g(c.accessibleChange,a)})}else{var f=function(a){a.dataset.initValue=a.value},h=function(a){if("initValue"in a.dataset){a.value=a.dataset.initValue}},i=function(a){if(!("initValue"in a.target.dataset)){return}if(a.target.value!==a.target.dataset.initValue){a.target.dataset.initValue=a.target.value;g(c.accessibleChange,a)}},j=a.get()[0];j.addEventListener("focus",function(a){f(a.target)},!0);j.addEventListener("blur",function(a){i(a)},!0);a.on("keydown",function(a){if(a.which===b.enter){i(a)}else if(a.which===b.escape){h(a.target);a.target.dataset.ignoreChange=!0}else{a.target.dataset.ignoreChange=!0}});a.on("change",function(a){if(a.target.dataset.ignoreChange){return}i(a)});a.on("keyup",function(a){delete a.target.dataset.ignoreChange});a.on("click",function(a){i(a)})}},z=function(){var a={};a[c.activate]=i;a[c.keyboardActivate]=j;a[c.escape]=k;a[c.down]=l;a[c.up]=m;a[c.home]=n;a[c.end]=o;a[c.next]=p;a[c.previous]=q;a[c.asterix]=r;a[c.scrollLock]=u;a[c.scrollTop]=s;a[c.scrollBottom]=t;a[c.ctrlPageUp]=v;a[c.ctrlPageDown]=w;a[c.enter]=x;a[c.accessibleChange]=y;return a};return{define:function define(b,c){b=a(b);c=c||[];if(!b.length||!c.length){return}a.each(z(),function(a,d){if(e(a,c)){d(b)}})},events:c}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a,b){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&exports&&"string"!=typeof exports.nodeName){b(exports)}else if("function"==typeof define&&define.amd){define ("core/mustache",["exports"],b)}else{a.Mustache={};b(a.Mustache)}})(this,function(a){var o=Object.prototype.toString,p=Array.isArray||function(a){return"[object Array]"===o.call(a)};function b(a){return"function"==typeof a}function c(a){return p(a)?"array":_typeof(a)}function d(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function e(a,b){return null!=a&&"object"===_typeof(a)&&b in a}function f(a,b){return null!=a&&"object"!==_typeof(a)&&a.hasOwnProperty&&a.hasOwnProperty(b)}var q=RegExp.prototype.test;function g(a,b){return q.call(a,b)}function h(a){return!g(/\S/,a)}var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var s=/\s*=/;function i(b,c){if(!b)return[];var g=!1,m=[],n=[],o=[],q=!1,r=!1,t="",u=0;function e(){if(q&&!r){while(o.length){delete n[o.pop()]}}else{o=[]}q=!1;r=!1}var v,w,x;function f(a){if("string"==typeof a)a=a.split(/\s+/,2);if(!p(a)||2!==a.length)throw new Error("Invalid tags: "+a);v=new RegExp(d(a[0])+"\\s*");w=new RegExp("\\s*"+d(a[1]));x=new RegExp("\\s*"+d("}"+a[1]))}f(c||a.tags);var y=new l(b),z,A,B,C,D,E;while(!y.eos()){z=y.pos;B=y.scanUntil(v);if(B){for(var F=0,G=B.length;F<G;++F){C=B.charAt(F);if(h(C)){o.push(n.length);t+=C}else{r=!0;g=!0;t+=" "}n.push(["text",C,z,z+1]);z+=1;if("\n"===C){e();t="";u=0;g=!1}}}if(!y.scan(v))break;q=!0;A=y.scan(/#|\^|\/|>|\{|&|=|!|\$|</)||"name";y.scan(/\s*/);if("="===A){B=y.scanUntil(s);y.scan(s);y.scanUntil(w)}else if("{"===A){B=y.scanUntil(x);y.scan(/\s*\}/);y.scanUntil(w);A="&"}else{B=y.scanUntil(w)}if(!y.scan(w))throw new Error("Unclosed tag at "+y.pos);if(">"==A){D=[A,B,z,y.pos,t,u,g]}else{D=[A,B,z,y.pos]}u++;n.push(D);if("#"===A||"^"===A||"$"===A||"<"===A){m.push(D)}else if("/"===A){E=m.pop();if(!E)throw new Error("Unopened section \""+B+"\" at "+z);if(E[1]!==B)throw new Error("Unclosed section \""+E[1]+"\" at "+z)}else if("name"===A||"{"===A||"&"===A){r=!0}else if("="===A){f(B)}}e();E=m.pop();if(E)throw new Error("Unclosed section \""+E[1]+"\" at "+y.pos);return k(j(n))}function j(a){for(var b=[],c,d,e=0,f=a.length;e<f;++e){c=a[e];if(c){if("text"===c[0]&&d&&"text"===d[0]){d[1]+=c[1];d[3]=c[3]}else{b.push(c);d=c}}}return b}function k(a){for(var b=[],c=b,d=[],e,f,g=0,h=a.length;g<h;++g){e=a[g];switch(e[0]){case"$":case"<":case"#":case"^":c.push(e);d.push(e);c=e[4]=[];break;case"/":f=d.pop();f[5]=e[2];c=0<d.length?d[d.length-1][4]:b;break;default:c.push(e);}}return b}function l(a){this.string=a;this.tail=a;this.pos=0}l.prototype.eos=function(){return""===this.tail};l.prototype.scan=function(a){var b=this.tail.match(a);if(!b||0!==b.index)return"";var c=b[0];this.tail=this.tail.substring(c.length);this.pos+=c.length;return c};l.prototype.scanUntil=function(a){var b=this.tail.search(a),c;switch(b){case-1:c=this.tail;this.tail="";break;case 0:c="";break;default:c=this.tail.substring(0,b);this.tail=this.tail.substring(b);}this.pos+=c.length;return c};function m(a,b){this.view=a;this.blocks={};this.cache={".":this.view};this.parent=b}m.prototype.push=function(a){return new m(a,this)};m.prototype.setBlockVar=function(a,b){var c=this.blocks;c[a]=b;return b};m.prototype.clearBlockVars=function(){this.blocks={}};m.prototype.getBlockVar=function(a){var b=this.blocks,c;if(b.hasOwnProperty(a)){c=b[a]}else{if(this.parent){c=this.parent.getBlockVar(a)}}return c};m.prototype.lookup=function(a){var c=this.cache,d;if(c.hasOwnProperty(a)){d=c[a]}else{var g=this,h,i,j,k=!1;while(g){if(0<a.indexOf(".")){h=g.view;i=a.split(".");j=0;while(null!=h&&j<i.length){if(j===i.length-1)k=e(h,i[j])||f(h,i[j]);h=h[i[j++]]}}else{h=g.view[a];k=e(g.view,a)}if(k){d=h;break}g=g.parent}c[a]=d}if(b(d))d=d.call(this.view);return d};function n(){this.cache={}}n.prototype.clearCache=function(){this.cache={}};n.prototype.parse=function(b,c){var d=this.cache,e=b+":"+(c||a.tags).join(":"),f=d[e];if(null==f)f=d[e]=i(b,c);return f};n.prototype.render=function(a,b,c,d){var e=this.parse(a,d),f=b instanceof m?b:new m(b);return this.renderTokens(e,f,c,a,d)};n.prototype.renderTokens=function(a,b,c,d,e){for(var f="",g,h,j,k=0,l=a.length;k<l;++k){j=void 0;g=a[k];h=g[0];if("#"===h)j=this.renderSection(g,b,c,d);else if("^"===h)j=this.renderInverted(g,b,c,d);else if(">"===h)j=this.renderPartial(g,b,c,e);else if("<"===h)j=this.renderBlock(g,b,c,d);else if("$"===h)j=this.renderBlockVariable(g,b,c,d);else if("&"===h)j=this.unescapedValue(g,b);else if("name"===h)j=this.escapedValue(g,b);else if("text"===h)j=this.rawValue(g);if(j!==void 0)f+=j}return f};n.prototype.renderSection=function(a,c,d,e){var g=this,h="",i=c.lookup(a[1]);function f(a){return g.render(a,c,d)}if(!i)return;if(p(i)){for(var k=0,l=i.length;k<l;++k){h+=this.renderTokens(a[4],c.push(i[k]),d,e)}}else if("object"===_typeof(i)||"string"==typeof i||"number"==typeof i){h+=this.renderTokens(a[4],c.push(i),d,e)}else if(b(i)){if("string"!=typeof e)throw new Error("Cannot use higher-order sections without the original template");i=i.call(c.view,e.slice(a[3],a[5]),f);if(null!=i)h+=i}else{h+=this.renderTokens(a[4],c,d,e)}return h};n.prototype.renderInverted=function(a,b,c,d){var e=b.lookup(a[1]);if(!e||p(e)&&0===e.length)return this.renderTokens(a[4],b,c,d)};n.prototype.indentPartial=function(a,b,c){for(var d=b.replace(/[^ \t]/g,""),e=a.split("\n"),f=0;f<e.length;f++){if(e[f].length&&(0<f||!c)){e[f]=d+e[f]}}return e.join("\n")};n.prototype.renderPartial=function(a,c,d,e){if(!d)return;var f=b(d)?d(a[1]):d[a[1]];if(null!=f){var g=a[6],h=a[5],i=a[4],j=f;if(0==h&&i){j=this.indentPartial(f,i,g)}return this.renderTokens(this.parse(j,e),c,d,j)}};n.prototype.renderBlock=function(a,c,d,e){if(!d)return;var f=b(d)?d(a[1]):d[a[1]];if(null!=f)c.clearBlockVars();this.renderTokens(a[4],c,d,e);var g=this.renderTokens(this.parse(f),c,d,f);c.clearBlockVars();return g};n.prototype.renderBlockVariable=function(a,b,c,d){var e=a[1],f=b.getBlockVar(e);if(!f){b.setBlockVar(e,d.slice(a[3],a[5]));return this.renderTokens(a[4],b,c,d)}else{return this.renderTokens(this.parse(f),b,c,f)}};n.prototype.unescapedValue=function(a,b){var c=b.lookup(a[1]);if(null!=c)return c};n.prototype.escapedValue=function(b,c){var d=c.lookup(b[1]);if(null!=d)return a.escape(d)};n.prototype.rawValue=function(a){return a[1]};a.name="mustache.js";a.version="3.1.0";a.tags=["{{","}}"];var t=new n;a.clearCache=function(){return t.clearCache()};a.parse=function(a,b){return t.parse(a,b)};a.render=function(a,b,d,e){if("string"!=typeof a){throw new TypeError("Invalid template! Template should be a \"string\" but \""+c(a)+"\" was given as the first argument for mustache#render(template, view, partials)")}return t.render(a,b,d,e)};a.to_html=function(c,d,e,f){var g=a.render(c,d,e);if(b(f)){f(g)}else{return g}};a.escape=function(a){return(a+"").replace(/[&<>"'`=\/]/g,function(a){return r[a]})};a.Scanner=l;a.Context=m;a.Writer=n;return a});
define ("core/dragdrop",["jquery","core/autoscroll"],function(a,b){var c={eventCaptureOptions:{passive:!1,capture:!0},dragProxy:null,onMove:null,onDrop:null,initialPosition:null,initialX:null,initialY:null,touching:null,prepare:function prepare(a){a.preventDefault();var b;if("touchstart"===a.type){b=null===c.touching&&0<a.changedTouches.length}else{b=1===a.which}if(b){var d=c.getEventXY(a);d.start=!0;return d}else{return{start:!1}}},start:function start(a,d,e,f){var g=c.getEventXY(a);c.initialX=g.x;c.initialY=g.y;c.initialPosition=d.offset();c.dragProxy=d;c.onMove=e;c.onDrop=f;switch(a.type){case"mousedown":c.addEventSpecial("mousemove",c.mouseMove);c.addEventSpecial("mouseup",c.mouseUp);break;case"touchstart":c.addEventSpecial("touchend",c.touchEnd);c.addEventSpecial("touchcancel",c.touchEnd);c.addEventSpecial("touchmove",c.touchMove);c.touching=a.changedTouches[0].identifier;break;default:throw new Error("Unexpected event type: "+a.type);}b.start(c.scroll)},addEventSpecial:function addEventSpecial(a,b){try{window.addEventListener(a,b,c.eventCaptureOptions)}catch(d){c.eventCaptureOptions=!0;window.addEventListener(a,b,c.eventCaptureOptions)}},getEventXY:function getEventXY(a){switch(a.type){case"touchstart":return{x:a.changedTouches[0].pageX,y:a.changedTouches[0].pageY};case"mousedown":return{x:a.pageX,y:a.pageY};default:throw new Error("Unexpected event type: "+a.type);}},touchMove:function touchMove(a){a.preventDefault();for(var b=0;b<a.changedTouches.length;b++){if(a.changedTouches[b].identifier===c.touching){c.handleMove(a.changedTouches[b].pageX,a.changedTouches[b].pageY)}}},mouseMove:function mouseMove(a){c.handleMove(a.pageX,a.pageY)},handleMove:function handleMove(b,d){var e=c.dragProxy.offset(),f=e.top-parseInt(c.dragProxy.css("top")),g=e.left-parseInt(c.dragProxy.css("left")),h=a(document).height()-c.dragProxy.outerHeight()-f,i=a(document).width()-c.dragProxy.outerWidth()-g,j=c.initialPosition,k={top:Math.max(-f,Math.min(h,j.top+(d-c.initialY)-f)),left:Math.max(-g,Math.min(i,j.left+(b-c.initialX)-g))};c.dragProxy.css(k);c.onMove(b,d,c.dragProxy)},touchEnd:function touchEnd(a){a.preventDefault();for(var b=0;b<a.changedTouches.length;b++){if(a.changedTouches[b].identifier===c.touching){c.handleEnd(a.changedTouches[b].pageX,a.changedTouches[b].pageY)}}},mouseUp:function mouseUp(a){c.handleEnd(a.pageX,a.pageY)},handleEnd:function handleEnd(a,d){if(null!==c.touching){window.removeEventListener("touchend",c.touchEnd,c.eventCaptureOptions);window.removeEventListener("touchcancel",c.touchEnd,c.eventCaptureOptions);window.removeEventListener("touchmove",c.touchMove,c.eventCaptureOptions);c.touching=null}else{window.removeEventListener("mousemove",c.mouseMove,c.eventCaptureOptions);window.removeEventListener("mouseup",c.mouseUp,c.eventCaptureOptions)}b.stop();c.onDrop(a,d,c.dragProxy)},scroll:function scroll(b){var d=a(document).height()-c.dragProxy.outerHeight(),e=c.dragProxy.offset();e.top=Math.min(d,e.top+b);c.dragProxy.css(e)}};return{prepare:c.prepare,start:c.start}});
define ("core/drawer_events",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;a.default={DRAWER_SHOWN:"drawer-shown",DRAWER_HIDDEN:"drawer-hidden"};return a.default});
define ("core/page_global",["jquery","core/custom_interaction_events","core/str","core/network"],function(a,b,c,d){var e=function(){var d=a("body");b.define(d,[b.events.activate]);d.on(b.events.activate,"[data-show-active-item]",function(b){var d=a(b.target).closest(".dropdown-item"),e=d.closest("[data-show-active-item]");if(!d.hasClass("dropdown-item")){return}if(d.hasClass("active")){return}var f=e.find(".dropdown-item");f.removeClass("active");f.removeAttr("aria-current");if(!e.attr("data-skip-active-class")){d.addClass("active")}d.attr("aria-current",!0);var g=d.text(),h=e.parent().find("[data-toggle=\"dropdown\"]"),i=h.find("[data-active-item-text]");if(i.length){i.html(g)}else{h.html(g)}var j=e.attr("data-active-item-button-aria-label-components");if(j){var k=j.split(",");k.push(g);c.get_string(k[0].trim(),k[1].trim(),k[2].trim()).then(function(a){h.attr("aria-label",a);return a}).catch(function(){return!1})}})};return{init:function init(){e();d.init()}}});
define ("core/first",["jquery"],function(a){a(document).bind("ajaxStart",function(){M.util.js_pending("jq")}).bind("ajaxStop",function(){M.util.js_complete("jq")})});
define ("core/form-autocomplete",["jquery","core/log","core/str","core/templates","core/notification","core/loadingicon"],function(a,b,c,d,f,g){var h={DOWN:40,ENTER:13,SPACE:32,ESCAPE:27,COMMA:44,UP:38,LEFT:37,RIGHT:39},i=Date.now(),j=function(b,c){var d=a(document.getElementById(c.selectionId)),e=d.children("[aria-selected=true]").length;b=b%e;while(0>b){b+=e}var f=a(d.children("[aria-selected=true]").get(b)),g=c.selectionId+"-"+b;d.children().attr("data-active-selection",null).attr("id","");f.attr("data-active-selection",!0).attr("id",g);d.attr("aria-activedescendant",g);d.attr("data-active-value",f.attr("data-value"));return a.Deferred().resolve()},k=function(b){var c=a(document.getElementById(b.selectionId)),d=c.attr("aria-activedescendant");if(d){var e=a(document.getElementById(d));if(e.length){return e}}var f=c.attr("data-active-value");return c.find("[data-value=\""+f+"\"]")},l=function(b){var c=k(b),d=c.attr("data-value"),e=a(document.getElementById(b.selectionId));if(d){var f=e.find("[aria-selected=true]").index(c);if(-1!==f){j(f,b);return}}j(0,b)},m=function(b,c,e){var g="form-autocomplete-updateSelectionList-"+c.inputId;M.util.js_pending(g);var h=[],i=a(document.getElementById(c.selectionId));e.children("option").each(function(b,c){if(a(c).prop("selected")){var d;if(a(c).data("html")){d=a(c).data("html")}else{d=a(c).html()}if(""!==d){h.push({label:d,value:a(c).attr("value")})}}});if(!n(c,h)){M.util.js_complete(g);return Promise.resolve()}c.items=h;var j=a.extend(b,c);return d.render(b.templates.items,j).then(function(a,b){d.replaceNodeContents(i,a,b);l(c)}).then(function(){return M.util.js_complete(g)}).catch(f.exception)},n=function(a,b){if(a.items.length!==b.length){return!0}return 0<a.items.filter(function(a){return-1===b.indexOf(a)}).length},o=function(a){if("undefined"!=typeof M.core_formchangechecker){M.core_formchangechecker.set_form_changed()}var b;if("function"==typeof Event){b=new Event("change")}else{b=document.createEvent("Event");b.initEvent("change",!0,!0)}a[0].dispatchEvent(b)},p=function(b,c,d,e){var f=a(d).attr("data-value");e.children("option").each(function(b,c){if(a(c).attr("value")==f){a(c).prop("selected",!1);if(a(c).attr("data-iscustom")){a(c).remove()}}});return m(b,c,e).then(function(){o(e)})},q=function(b,c){var d=a(document.getElementById(c.inputId)),e=a(document.getElementById(c.suggestionsId)),f=e.children("[aria-hidden=false]").length;b=b%f;while(0>b){b+=f}var g=a(e.children("[aria-hidden=false]").get(b)),h=a(e.children("[role=option]")).index(g),i=c.suggestionsId+"-"+h;e.children().attr("aria-selected",!1).attr("id","");g.attr("aria-selected",!0).attr("id",i);d.attr("aria-activedescendant",i);var j=g.offset().top-e.offset().top+e.scrollTop()-e.height()/2;return e.animate({scrollTop:j},100).promise()},r=function(b){var c=a(document.getElementById(b.suggestionsId)),d=c.children("[aria-selected=true]"),e=c.children("[aria-hidden=false]").index(d);return q(e+1,b)},s=function(b){var c=a(document.getElementById(b.selectionId)),d=c.children("[data-active-selection]");if(!d){return j(0,b)}var e=c.children("[aria-selected=true]").index(d);return j(e-1,b)},t=function(b){var c=a(document.getElementById(b.selectionId)),d=c.children("[data-active-selection]"),e=0;if(d){e=c.children("[aria-selected=true]").index(d);e=e+1}else{e=0}return j(e,b)},u=function(b){var c=a(document.getElementById(b.suggestionsId)),d=c.children("[aria-selected=true]"),e=c.children("[aria-hidden=false]").index(d);return q(e-1,b)},v=function(b){var c=a(document.getElementById(b.inputId)),d=a(document.getElementById(b.suggestionsId));if("true"===c.attr("aria-expanded")){c.attr("aria-expanded",!1)}c.attr("aria-activedescendant",b.selectionId);d.hide().attr("aria-hidden",!0);return a.Deferred().resolve()},w=function(b,e,g,h){var i="form-autocomplete-updateSuggestions-"+e.inputId;M.util.js_pending(i);var j=a(document.getElementById(e.inputId)),k=a(document.getElementById(e.suggestionsId)),l=!1,m=[];h.children("option").each(function(b,c){if(!0!==a(c).prop("selected")){m[m.length]={label:c.innerHTML,value:a(c).attr("value")}}});var n=e.caseSensitive?g:g.toLocaleLowerCase(),o=a.extend({options:m},b,e),p=d.render("core/form_autocomplete_suggestions",o).then(function(f,g){d.replaceNode(k,f,g);k=a(document.getElementById(e.suggestionsId));k.show().attr("aria-hidden",!1);k.children().each(function(c,d){d=a(d);if(b.caseSensitive&&-1<d.text().indexOf(n)||!b.caseSensitive&&-1<d.text().toLocaleLowerCase().indexOf(n)){d.show().attr("aria-hidden",!1);l=!0}else{d.hide().attr("aria-hidden",!0)}});j.attr("aria-expanded",!0);if(h.attr("data-notice")){k.html(h.attr("data-notice"))}else if(l){if(!b.tags){q(0,e)}}else{c.get_string("nosuggestions","form").done(function(a){k.html(a)})}return k}).then(function(){return M.util.js_complete(i)}).catch(f.exception);return p},x=function(b,c,d){var e=a(document.getElementById(c.inputId)),f=e.val(),g=f.split(","),h=!1;a.each(g,function(c,e){e=e.trim();if(""!==e){if(!b.multiple){d.children("option").prop("selected",!1)}d.children("option").each(function(b,c){if(a(c).attr("value")==e){h=!0;a(c).prop("selected",!0)}});if(!h){var f=a("<option>");f.append(document.createTextNode(e));f.attr("value",e);d.append(f);f.prop("selected",!0);f.attr("data-iscustom",!0)}}});return m(b,c,d).then(function(){o(d)}).then(function(){e.val("")}).then(function(){return v(c)})},y=function(b,c,d){var e=a(document.getElementById(c.inputId)),f=a(document.getElementById(c.suggestionsId)),g=f.children("[aria-selected=true]").attr("data-value");if(!b.multiple){d.children("option").prop("selected",!1)}d.children("option").each(function(b,c){if(a(c).attr("value")==g){a(c).prop("selected",!0)}});return m(b,c,d).then(function(){o(d)}).then(function(){if(b.closeSuggestionsOnSelect){e.val("");return v(c)}else{e.focus();return w(b,c,e.val(),d)}})},z=function(b,c,d,e,f){var h=B("updateAjax"),i=a(document.getElementById(d.selectId)).parent();g.addIconToContainerRemoveOnCompletion(i,h);var j=a(b.currentTarget).val();f.transport(c.selector,j,function(b){var g=f.processResults(c.selector,b),i=[];if(!c.multiple){e.children("option").remove()}e.children("option").each(function(b,c){c=a(c);if(!c.prop("selected")){c.remove()}else{i.push(c.attr("value")+"")}});if(!c.multiple&&0===e.children("option").length){var j=a("<option>");e.append(j)}if(a.isArray(g)){a.each(g,function(b,c){if(-1===i.indexOf(c.value+"")){var d=a("<option>");d.append(c.label);d.attr("value",c.value);e.append(d)}});e.attr("data-notice","")}else{e.attr("data-notice",g)}h.resolve(w(c,d,"",e))},function(a){h.reject(a)});return h},A=function(b,c,d){var g=a(document.getElementById(c.inputId));g.on("keydown",function(f){var e=B("addNavigation-"+c.inputId+"-"+f.keyCode);switch(f.keyCode){case h.DOWN:if(!b.showSuggestions){e.resolve();return!0}else if("true"===g.attr("aria-expanded")){e.resolve(r(c))}else{if(!g.val()&&b.ajax){require([b.ajax],function(a){e.resolve(z(f,b,c,d,a))})}else{e.resolve(w(b,c,g.val(),d))}}f.preventDefault();return!1;case h.UP:e.resolve(u(c));f.preventDefault();return!1;case h.ENTER:var i=a(document.getElementById(c.suggestionsId));if("true"===g.attr("aria-expanded")&&0<i.children("[aria-selected=true]").length){e.resolve(y(b,c,d))}else if(b.tags){e.resolve(x(b,c,d))}else{e.resolve()}f.preventDefault();return!1;case h.ESCAPE:if("true"===g.attr("aria-expanded")){e.resolve(v(c))}else{e.resolve()}f.preventDefault();return!1;}e.resolve();return!0});g.on("keypress",function(a){if(a.keyCode===h.COMMA){if(b.tags){B("keypress-"+a.keyCode).resolve(x(b,c,d))}a.preventDefault();return!1}return!0});g.closest("form").on("submit",function(){if(b.tags){B("form-autocomplete-submit").resolve(x(b,c,d))}return!0});g.on("blur",function(){var e=B("form-autocomplete-blur");window.setTimeout(function(){var f=a(document.activeElement),h=a.Deferred();if(f.is(document.getElementById(c.suggestionsId))){g.focus()}else if(!f.is(g)&&a(document.getElementById(c.inputId)).length){if(b.tags){h.then(function(){return x(b,c,d)}).catch()}h.then(function(){return v(c)}).catch()}h.then(function(){return e.resolve()}).catch();h.resolve()},500)});if(b.showSuggestions){var i=a(document.getElementById(c.downArrowId));i.on("click",function(a){var e=B("form-autocomplete-show-suggestions");g.focus();if(!g.val()&&b.ajax){require([b.ajax],function(f){e.resolve(z(a,b,c,d,f))})}else{e.resolve(w(b,c,g.val(),d))}})}var j=a(document.getElementById(c.suggestionsId));j.parent().prop("onclick",null).off("click");j.parent().on("click","#".concat(c.suggestionsId," [role=option]"),function(f){var e=B("form-autocomplete-parent"),g=a(f.currentTarget).closest("[role=option]"),h=a(document.getElementById(c.suggestionsId)),i=h.children("[aria-hidden=false]").index(g);q(i,c).then(function(){return y(b,c,d)}).then(function(){return e.resolve()}).catch()});var k=a(document.getElementById(c.selectionId));k.on("click","[role=option]",function(f){var e=B("form-autocomplete-clicks");e.resolve(p(b,c,a(f.currentTarget),d))});k.on("focus",function(){l(c)});k.on("keydown",function(f){var e=B("form-autocomplete-keydown-"+f.keyCode);switch(f.keyCode){case h.RIGHT:case h.DOWN:f.preventDefault();e.resolve(t(c));return;case h.LEFT:case h.UP:f.preventDefault();e.resolve(s(c));return;case h.SPACE:case h.ENTER:var g=a(document.getElementById(c.selectionId)).children("[data-active-selection]");if(g){f.preventDefault();e.resolve(p(b,c,g,d))}return;}e.resolve()});if(b.showSuggestions){g.on("focus",function(b){var c=a(b.currentTarget).val();a(b.currentTarget).data("last-value",c)});if(b.ajax){require([b.ajax],function(h){var i=null,j=!1,k="autocomplete-throttledhandler",l=function(a){i=null;j=!0;z(a,b,c,d,h).then(function(){if(null===i){M.util.js_complete(k)}j=!1;return arguments[0]}).catch(f.exception)},m=function(a){window.clearTimeout(i);if(j){i=window.setTimeout(m.bind(this,a),100);return}if(null===i){M.util.js_pending(k)}i=window.setTimeout(l.bind(this,a),300)};g.on("input",function(b){var c=a(b.currentTarget).val(),d=a(b.currentTarget).data("last-value");if(d!==c){m(b)}a(b.currentTarget).data("last-value",c)})})}else{g.on("input",function(f){var e=a(f.currentTarget).val(),g=a(f.currentTarget).data("last-value");if(g!==e){w(b,c,e,d)}a(f.currentTarget).data("last-value",e)})}}},B=function(b){var c="form-autocomplete:"+b;M.util.js_pending(c);var d=a.Deferred();d.then(function(){M.util.js_complete(c);return arguments[0]}).catch(f.exception);return d};return{enhance:function enhance(e,g,h,j,k,l,n,o,p){var q={selector:e,tags:!1,ajax:!1,placeholder:j,caseSensitive:!1,showSuggestions:!0,noSelectionString:n,templates:a.extend({input:"core/form_autocomplete_input",items:"core/form_autocomplete_selection_items",layout:"core/form_autocomplete_layout",selection:"core/form_autocomplete_selection",suggestions:"core/form_autocomplete_suggestions"},p)},r="autocomplete-setup-"+e;M.util.js_pending(r);if("undefined"!=typeof g){q.tags=g}if("undefined"!=typeof h){q.ajax=h}if("undefined"!=typeof k){q.caseSensitive=k}if("undefined"!=typeof l){q.showSuggestions=l}if("undefined"==typeof n){c.get_string("noselection","form").done(function(a){q.noSelectionString=a}).fail(f.exception)}var s=a(e);if(!s){b.debug("Selector not found: "+e);M.util.js_complete(r);return!1}s.css("visibility","hidden").attr("aria-hidden",!0);var t={selectId:s.attr("id"),inputId:"form_autocomplete_input-"+i,suggestionsId:"form_autocomplete_suggestions-"+i,selectionId:"form_autocomplete_selection-"+i,downArrowId:"form_autocomplete_downarrow-"+i,items:[]};i++;q.multiple=s.attr("multiple");if(!q.multiple){s.prepend("<option>")}if("undefined"!=typeof o){q.closeSuggestionsOnSelect=o}else{q.closeSuggestionsOnSelect=!q.multiple}var u=a("[for="+t.selectId+"]"),v=[];s.children("option").each(function(b,c){v[b]={label:c.innerHTML,value:a(c).attr("value")}});var w=a.extend({},q,t);w.options=v;w.items=[];var x="",y=d.render(q.templates.layout,{}).then(function(b){return a(b)}),z=d.render(q.templates.input,w).then(function(b,c){x+=c;return a(b)}),B=d.render(q.templates.suggestions,w).then(function(b,c){x+=c;return a(b)}),C=d.render(q.templates.selection,w).then(function(b,c){x+=c;return a(b)});return a.when(y,z,B,C).then(function(b,c,e,f){s.hide();var g=s.parent();a(c).find("input").attr("data-fieldtype","autocomplete");g.append(b);g.find("[data-region=\"form_autocomplete-input\"]").replaceWith(c);g.find("[data-region=\"form_autocomplete-suggestions\"]").replaceWith(e);g.find("[data-region=\"form_autocomplete-selection\"]").replaceWith(f);d.runTemplateJS(x);u.attr("for",t.inputId);A(q,t,s);var h=a(document.getElementById(t.suggestionsId));h.hide().attr("aria-hidden",!0)}).then(function(){return m(q,t,s)}).then(function(){return M.util.js_complete(r)}).catch(function(a){M.util.js_complete(r);f.exception(a)})}}});
define ("core/icon_system_standard",["core/icon_system","core/url","core/mustache"],function(a,b,c){var d=function(){a.apply(this,arguments)};d.prototype=Object.create(a.prototype);d.prototype.renderIcon=function(a,d,e,f){var g=b.imageUrl(a,d),h={attributes:[{name:"src",value:g},{name:"alt",value:e},{name:"title",value:e}]};if("undefined"==typeof e||""==e){h.attributes.push({name:"aria-hidden",value:"true"})}var i=c.render(f,h);return i.trim()};d.prototype.getTemplateName=function(){return"core/pix_icon"};return d});
define ("core/form-cohort-selector",["core/ajax","jquery"],function(a,b){return{processResults:function processResults(a,c){var d=[],e=0,f=(b(a).data("exclude")+"").split(",");for(e=0;e<c.cohorts.length;e++){if(-1===f.indexOf(c.cohorts[e].id+"")){d.push({value:c.cohorts[e].id,label:c.cohorts[e].name})}}return d},transport:function transport(c,d,e,f){var g=b(c),h=null;if("undefined"==typeof d){d=""}var i=g.data("contextid"),j={query:d,includes:"parents",limitfrom:0,limitnum:100,context:{contextid:i}};h=a.call([{methodname:"core_cohort_search_cohorts",args:j}]);b.when.apply(b.when,h).done(function(a){e(a)}).fail(f)}}});
define ("core/paged_content",["jquery","core/paged_content_pages","core/paged_content_paging_bar","core/paged_content_paging_bar_limit_selector","core/paged_content_paging_dropdown"],function(a,b,c,d,e){return{init:function init(f,g,h){f=a(f);var i=f.find(b.rootSelector),j=f.find(c.rootSelector),k=f.find(e.rootSelector),l=f.find(d.rootSelector),m=f.attr("id");if(h){m=h}b.init(i,m,g);if(j.length){c.init(j,m)}if(l.length){d.init(l,m)}if(k.length){e.init(k,m)}},rootSelector:"[data-region=\"paged-content-container\"]"}});
define ("core/paged_content_events",[],function(){return{SHOW_PAGES:"core-paged-content-show-pages",PAGES_SHOWN:"core-paged-content-pages-shown",ALL_ITEMS_LOADED:"core-paged-content-all-items-loaded",SET_ITEMS_PER_PAGE_LIMIT:"core-paged-content-set-items-per-page-limit"}});
define ("core/paged_content_factory",["jquery","core/templates","core/notification","core/paged_content","core/paged_content_events","core/pubsub","core/ajax"],function(a,b,c,d,e,f,g){var h={PAGED_CONTENT:"core/paged_content"},j={ITEMS_PER_PAGE_SINGLE:25,ITEMS_PER_PAGE_ARRAY:[25,50,100,0],MAX_PAGES:3},k=function(){return{pagingbar:!1,pagingdropdown:!1,skipjs:!0,ignorecontrolwhileloading:!0,controlplacementbottom:!1}},l=function(){return{showitemsperpageselector:!1,itemsperpage:35,previous:!0,next:!0,activepagenumber:1,hidecontrolonsinglepage:!0,pages:[]}},m=function(a,b){var c=1;if(0<a){var d=a%b;if(d){a-=d;c=a/b+1}else{c=a/b}}return c},n=function(b,c){if(null===c){c=j.ITEMS_PER_PAGE_SINGLE}if(a.isArray(c)){c=c[0]}var d=l();d.itemsperpage=c;for(var e=m(b,c),f=1,g;f<=e;f++){g={number:f,page:""+f};if(1==f){g.active=!0}d.pages.push(g)}d.barsize=10;return d},o=function(b){var c=[];if(a.isArray(b)){c=b.map(function(a){if("number"==typeof a){return{value:a,active:!1}}else{return a}});var d=c.filter(function(a){return a.active});if(!d.length){c[0].active=!0}}else{c=[{value:b,active:!0}]}return c},p=function(b){if(null===b){b=j.ITEMS_PER_PAGE_ARRAY}var c=l();c.itemsperpage=o(b);c.showitemsperpageselector=a.isArray(b)&&1<b.length;return c},q=function(a,b){if(a){return n(a,b)}else{return p(b)}},r=function(b,c){if(null===b){b=j.ITEMS_PER_PAGE_SINGLE}if(a.isArray(b)){return{options:b}}var d={options:[]},e=0,f=0,g=j.MAX_PAGES;if(c.hasOwnProperty("maxPages")){g=c.maxPages}for(var h=1,k;h<=g;h++){k=0;if(2>=h){k=b;f=b}else{f=2*f;k=f}e+=k;var l={itemcount:k,content:e};if(1==h){l.active=!0}d.options.push(l)}return d},s=function(a,b,c){var d=k();if(c.hasOwnProperty("ignoreControlWhileLoading")){d.ignorecontrolwhileloading=c.ignoreControlWhileLoading}if(c.hasOwnProperty("controlPlacementBottom")){d.controlplacementbottom=c.controlPlacementBottom}if(c.hasOwnProperty("hideControlOnSinglePage")){d.hidecontrolonsinglepage=c.hideControlOnSinglePage}if(c.hasOwnProperty("ariaLabels")){d.arialabels=c.ariaLabels}if(c.hasOwnProperty("dropdown")&&c.dropdown){d.pagingdropdown=r(b,c)}else{d.pagingbar=q(a,b)}return d},t=function(e,f,g,i){i=i||{};var j=a.Deferred(),k=s(e,f,i);b.render(h.PAGED_CONTENT,k).then(function(b,c){b=a(b);var e=b.attr("id");if(i.hasOwnProperty("eventNamespace")){e=i.eventNamespace}var f=b;d.init(f,g,e);v(e,i);j.resolve(b,c)}).fail(function(a){j.reject(a)}).fail(c.exception);return j.promise()},u=function(a){return function callback(b){g.call([{methodname:"core_user_update_user_preferences",args:{preferences:[{type:a,value:b}]}}])}},v=function(a,b){if(b.hasOwnProperty("persistentLimitKey")){f.subscribe(a+e.SET_ITEMS_PER_PAGE_LIMIT,u(b.persistentLimitKey))}};return{create:function create(a,b){return t(null,null,a,b)},createWithLimit:function createWithLimit(a,b,c){return t(null,a,b,c)},createWithTotalAndLimit:t,createFromStaticList:function createFromStaticList(a,b,c,d){if("undefined"==typeof d){d={}}var e=a.length;return t(e,b,function(b){var d=[];b.forEach(function(b){var c=b.offset,f=b.limit?c+b.limit:e,g=a.slice(c,f);d.push(g)});return c(d)},d)},createFromAjax:t,resetLastPageNumber:function resetLastPageNumber(a,b){f.publish(a+e.ALL_ITEMS_LOADED,b)}}});
define ("core/paged_content_pages",["jquery","core/templates","core/notification","core/pubsub","core/paged_content_events","core/pending"],function(a,b,c,d,e,f){var g={ROOT:"[data-region=\"page-container\"]",PAGE_REGION:"[data-region=\"paged-content-page\"]",ACTIVE_PAGE_REGION:"[data-region=\"paged-content-page\"].active"},h={PAGING_CONTENT_ITEM:"core/paged_content_page",LOADING:"core/overlay_loading"},i=function(a,b){return a.find("[data-page=\""+b+"\"]")},j=function(d){var e=a.Deferred();d.attr("aria-busy",!0);var g=new f("core/paged_content_pages:startLoading");b.render(h.LOADING,{visible:!0}).then(function(b){var c=a(b),f=setTimeout(function(){d.css("position","relative");c.appendTo(d)},300);e.always(function(){clearTimeout(f);c.remove();d.css("position","");d.removeAttr("aria-busy");g.resolve()})}).fail(c.exception);return e},k=function(d,e,f){var g=a.Deferred();e.then(function(a,e){e=e||"";b.render(h.PAGING_CONTENT_ITEM,{page:f,content:a}).then(function(a){b.appendNodeContents(d,a,e);var c=i(d,f);g.resolve(c)}).fail(function(a){g.reject(a)}).fail(c.exception)}).fail(function(a){g.reject(a)}).fail(c.exception);return g.promise()},l=function(b,h,l,m){var n=new f("core/paged_content_pages:showPages"),o=[],p=[],q=a.Deferred();h.forEach(function(a){var c=a.pageNumber,d=i(b,c);if(d.length){o.push(d)}else{p.push(a)}});if(p.length&&"function"==typeof m){var r=m(p,{allItemsLoaded:function allItemsLoaded(a){d.publish(l+e.ALL_ITEMS_LOADED,a)}}),s=r.map(function(a,c){return k(b,a,p[c].pageNumber)});a.when.apply(a,s).then(function(){var a=Array.prototype.slice.call(arguments);q.resolve(a)}).fail(function(a){q.reject(a)}).fail(c.exception)}else{q.resolve([])}var t=j(b);q.then(function(a){var c=o.concat(a);b.find(g.PAGE_REGION).addClass("hidden");c.forEach(function(a){if(!0){a.removeClass("hidden")}})}).then(function(){d.publish(l+e.PAGES_SHOWN,h)}).fail(c.exception).always(function(){t.resolve();n.resolve()}).catch()};return{init:function init(b,c,f){b=a(b);d.subscribe(c+e.SHOW_PAGES,function(a){l(b,a,c,f)});d.subscribe(c+e.SET_ITEMS_PER_PAGE_LIMIT,function(){b.empty()})},rootSelector:g.ROOT}});
define ("core/paged_content_paging_bar",["jquery","core/custom_interaction_events","core/paged_content_events","core/str","core/pubsub","core/pending"],function(a,b,c,d,e,f){var g={ROOT:"[data-region=\"paging-bar\"]",PAGE:"[data-page]",PAGE_ITEM:"[data-region=\"page-item\"]",PAGE_LINK:"[data-region=\"page-link\"]",FIRST_BUTTON:"[data-control=\"first\"]",LAST_BUTTON:"[data-control=\"last\"]",NEXT_BUTTON:"[data-control=\"next\"]",PREVIOUS_BUTTON:"[data-control=\"previous\"]",DOTS_BUTTONS:"[data-dots]",BEGINNING_DOTS_BUTTON:"[data-dots=\"beginning\"]",ENDING_DOTS_BUTTON:"[data-dots=\"ending\"]"},h=function(a,b){return a.find(g.PAGE_ITEM+"[data-page-number=\""+b+"\"]")},i=function(a){return a.find(g.NEXT_BUTTON)},j=function(a,b){a.attr("data-last-page-number",b)},k=function(a){return parseInt(a.attr("data-last-page-number"),10)},l=function(a){return parseInt(a.attr("data-active-page-number"),10)},m=function(a,b){a.attr("data-active-page-number",b)},n=function(a){var b=l(a);return!isNaN(b)&&0!=b},o=function(a,b){if(b.attr("data-page")!=void 0){return parseInt(b.attr("data-page-number"),10)}var c=1,d=null;switch(b.attr("data-control")){case"first":c=1;break;case"last":c=k(a);break;case"next":d=l(a);var e=k(a);if(!e){c=d+1}else if(d&&d<e){c=d+1}else{c=e}break;case"previous":d=l(a);if(d&&1<d){c=d-1}else{c=1}break;default:c=1;break;}return parseInt(c,10)},p=function(a){return parseInt(a.attr("data-items-per-page"),10)},q=function(a,b){a.attr("data-items-per-page",b)},r=function(a){a.removeClass("hidden")},s=function(a){a.addClass("hidden")},t=function(a){var b=a.find(g.NEXT_BUTTON),c=a.find(g.LAST_BUTTON);b.addClass("disabled");b.attr("aria-disabled",!0);c.addClass("disabled");c.attr("aria-disabled",!0)},u=function(a){var b=a.find(g.NEXT_BUTTON),c=a.find(g.LAST_BUTTON);b.removeClass("disabled");b.removeAttr("aria-disabled");c.removeClass("disabled");c.removeAttr("aria-disabled")},v=function(a){var b=a.find(g.PREVIOUS_BUTTON),c=a.find(g.FIRST_BUTTON);b.addClass("disabled");b.attr("aria-disabled",!0);c.addClass("disabled");c.attr("aria-disabled",!0)},w=function(b){var c=l(b),d=k(b),e=b.find(g.DOTS_BUTTONS),f=b.find(g.BEGINNING_DOTS_BUTTON),h=b.find(g.ENDING_DOTS_BUTTON),i=b.find(g.PAGE),j=parseInt(b.attr("data-bar-size"),10);if(j&&d>j){var m=Math.max(c-Math.round(j/2),1),n=m+j-1;if(n>=d){n=d;m=n-j+1}if(1<m){r(f);m++}else{s(f)}if(n<d){r(h);n--}else{s(h)}e.addClass("disabled");e.attr("aria-disabled",!0);s(i);i.each(function(b,c){c=a(c);if(b+1>=m&&b+1<=n){r(c)}})}else{s(e)}},x=function(a){var b=a.find(g.PREVIOUS_BUTTON),c=a.find(g.FIRST_BUTTON);b.removeClass("disabled");b.removeAttr("aria-disabled");c.removeClass("disabled");c.removeAttr("aria-disabled")},y=function(a){var b=a.attr("data-aria-label-components-pagination-item"),c=b.split(",").map(function(a){return a.trim()});return c},z=function(a){var b=a.attr("data-aria-label-components-pagination-active-item"),c=b.split(",").map(function(a){return a.trim()});return c},A=function(b,c){var d=0;m(b,0);c.each(function(c,e){var f=c+1;e=a(e);e.attr("data-page-number",f);d++;if(e.hasClass("active")){m(b,f)}});j(b,d)},B=function(b){var c=y(b),e=z(b),f=l(b),h=b.find(g.PAGE_ITEM),i=h.map(function(d,g){g=a(g);var h=o(b,g);if(h===f){return{key:e[0],component:e[1],param:h}}else{return{key:c[0],component:c[1],param:h}}});d.get_strings(i).then(function(b){h.each(function(c,d){d=a(d);var e=b[c];d.attr("aria-label",e);d.find(g.PAGE_LINK).attr("aria-label",e)});return b}).catch(function(){})},C=function(a,b,d){var i=new f("core/paged_content_paging_bar:showPage"),j=k(a),n=b==l(a),o=p(a);if(!n){a.find(g.PAGE_ITEM).removeClass("active").removeAttr("aria-current");var q=h(a,b);q.addClass("active");q.attr("aria-current",!0);m(a,b);w(a)}if(j&&b>=j){t(a)}else{u(a)}if(1<b){x(a)}else{v(a)}B(a);e.publish(d+c.SHOW_PAGES,[{pageNumber:b,limit:o,offset:(b-1)*o}]);i.resolve()},D=function(d,f){var h=d.attr("data-ignore-control-while-loading"),i=!1;if(""==h){h=!0}b.define(d,[b.events.activate]);d.on(b.events.activate,g.PAGE_ITEM,function(b,c){c.originalEvent.preventDefault();c.originalEvent.stopPropagation();if(h&&i){return}var e=a(b.target).closest(g.PAGE_ITEM);if(!e.hasClass("disabled")){var j=o(d,e);C(d,j,f);i=!0}});e.subscribe(f+c.ALL_ITEMS_LOADED,function(a){i=!1;var b=k(d);if(!b||a<b){j(d,a)}if(1===a&&d.attr("data-hide-control-on-single-page")){s(d);t(d);v(d)}else{r(d);t(d)}});e.subscribe(f+c.PAGES_SHOWN,function(){i=!1});e.subscribe(f+c.SET_ITEMS_PER_PAGE_LIMIT,function(a){q(d,a);j(d,0);m(d,0);r(d);C(d,1,f)})};return{init:function init(b,c){b=a(b);var d=b.find(g.PAGE);A(b,d);D(b,c);if(n(b)){var e=l(b);h(b,e).click();if(1==e){v(b)}}else{i(b).click()}w(b)},disableNextControlButtons:t,enableNextControlButtons:u,disablePreviousControlButtons:v,enablePreviousControlButtons:x,showPage:C,rootSelector:g.ROOT}});
define ("core/paged_content_paging_bar_limit_selector",["jquery","core/custom_interaction_events","core/paged_content_events","core/pubsub"],function(a,b,c,d){var f={ROOT:"[data-region=\"paging-control-limit-container\"]",LIMIT_OPTION:"[data-limit]",LIMIT_TOGGLE:"[data-action=\"limit-toggle\"]"};return{init:function init(e,g){e=a(e);b.define(e,[b.events.activate]);e.on(b.events.activate,f.LIMIT_OPTION,function(b,e){var h=a(b.target).closest(f.LIMIT_OPTION);if(h.hasClass("active")){return}var i=parseInt(h.attr("data-limit"),10);d.publish(g+c.SET_ITEMS_PER_PAGE_LIMIT,i);e.originalEvent.preventDefault()})},rootSelector:f.ROOT}});
define ("core/paged_content_paging_dropdown",["jquery","core/custom_interaction_events","core/paged_content_events","core/pubsub"],function(a,b,c,d){var f={ROOT:"[data-region=\"paging-dropdown-container\"]",DROPDOWN_ITEM:"[data-region=\"dropdown-item\"]",DROPDOWN_TOGGLE:"[data-region=\"dropdown-toggle\"]",ACTIVE_DROPDOWN_ITEM:"[data-region=\"dropdown-item\"].active",CARET:"[data-region=\"caret\"]"},g=function(a){return parseInt(a.attr("data-page-number"),10)},h=function(a){return a.find(f.DROPDOWN_ITEM)},i=function(b,c){var d=g(c);return h(b).filter(function(b,c){return g(a(c))<d})},j=function(a){return parseInt(a.attr("data-item-count"),10)},k=function(b,c){if(c.attr("data-offset")!=void 0){return parseInt(c.attr("data-offset"),10)}var d=0;i(b,c).each(function(b,c){c=a(c);d+=j(c)});c.attr("data-offset",d);return d},l=function(a){return a.find(f.ACTIVE_DROPDOWN_ITEM)},m=function(b,c){return c.map(function(c,d){d=a(d);return{pageNumber:g(d),limit:j(d),offset:k(b,d)}}).get()},n=function(b){b.each(function(b,c){c=a(c);c.attr("data-page-number",b+1)})},o=function(a,b,e){var g=i(a,b),h=g.add(b),j=m(a,h),k=a.find(f.DROPDOWN_TOGGLE),n=k.find(f.CARET);l(a).removeClass("active");b.addClass("active");k.html(b.text());k.append(n);d.publish(e+c.SHOW_PAGES,j)};return{init:function init(c,d){c=a(c);var e=h(c);n(e);var g=l(c);if(g.length){o(c,g,d)}b.define(c,[b.events.activate]);c.on(b.events.activate,f.DROPDOWN_ITEM,function(b,e){var g=a(b.target).closest(f.DROPDOWN_ITEM);o(c,g,d);e.originalEvent.preventDefault()})},rootSelector:f.ROOT}});
define ("core/pending",["jquery"],function(a){var b=function(b){var c=a.Deferred();b=b||{};M.util.js_pending(b);c.then(function(){return M.util.js_complete(b)}).catch();return c};b.prototype.constructor=b;return b});
define ("core/permissionmanager",["jquery","core/config","core/notification","core/templates","core/yui"],function(a,b,c,d,e){var f={ADDROLE:"a.allowlink, a.prohibitlink",REMOVEROLE:"a.preventlink, a.unprohibitlink",UNPROHIBIT:"a.unprohibitlink"},g=a.Event("rolesloaded"),h,j,k,l,m=null,n=function loadOverideableRoles(){var d={contextid:h,getroles:1,sesskey:b.sesskey};a.post(k+"roles/ajax.php",d,null,"json").done(function(b){try{l=b;n=function loadOverideableRoles(){a("body").trigger(g)};n()}catch(a){c.exception(a)}}).fail(function(a,b,d){c.exception(d)})},o=function(b,e,f){var g={contextid:h,roleid:e,sesskey:M.cfg.sesskey,action:f,capability:b.data("name")};a.post(k+"roles/ajax.php",g,null,"json").done(function(f){var g=f;try{var h={rolename:l[e],roleid:e,adminurl:k,imageurl:M.util.image_url("t/delete","moodle")};switch(g){case"allow":h.spanclass="allowed";h.linkclass="preventlink";h.action="prevent";h.icon="t/delete";h.iconalt=M.util.get_string("deletexrole","core_role",l[e]);break;case"prohibit":h.spanclass="forbidden";h.linkclass="unprohibitlink";h.action="unprohibit";h.icon="t/delete";h.iconalt=M.util.get_string("deletexrole","core_role",l[e]);break;case"prevent":b.find("a[data-role-id=\""+e+"\"]").first().closest(".allowed").remove();return;case"unprohibit":b.find("a[data-role-id=\""+e+"\"]").first().closest(".forbidden").remove();return;default:return;}d.render("core/permissionmanager_role",h).done(function(c){if("allow"==g){a(c).insertBefore(b.find(".allowmore").first())}else if("prohibit"==g){a(c).insertBefore(b.find(".prohibitmore").first());var d=b.find(".allowedroles").first().find("a[data-role-id=\""+e+"\"]");if(d){d.first().closest(".allowed").remove()}}m.hide()}).fail(c.exception)}catch(a){c.exception(a)}}).fail(function(a,b,d){c.exception(d)})},p=function(b){b.preventDefault();var g=a(b.currentTarget);a("body").one("rolesloaded",function(){e.use("moodle-core-notification-dialogue",function(){var b=g.data("action"),h=g.closest("tr.rolecap"),k={cap:h.data("humanname"),context:j},n=M.util.get_string("role"+b+"info","core_role",k);if(null===m){m=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,width:"450px"})}m.set("headerContent",M.util.get_string("role"+b+"header","core_role"));var p,e,q=[];switch(b){case"allow":e=h.find(f.REMOVEROLE);break;case"prohibit":e=h.find(f.UNPROHIBIT);break;}for(p in l){var r="",s=e.filter("[data-role-id='"+p+"']").length;if(s){r="disabled"}var t={roleid:p,rolename:l[p],disabled:r};q.push(t)}d.render("core/permissionmanager_panelcontent",{message:n,roles:q}).done(function(c){m.set("bodyContent",c);m.show();a("div.role_buttons").on("click","button",function(c){var d=a(c.currentTarget).data("role-id");o(h,d,b)})}).fail(c.exception)})});n()},q=function(b){b.preventDefault();var d=a(b.currentTarget);a("body").one("rolesloaded",function(){var a=d.data("action"),b=d.data("role-id"),e=d.closest("tr.rolecap"),f={role:l[b],cap:e.data("humanname"),context:j};c.confirm(M.util.get_string("confirmunassigntitle","core_role"),M.util.get_string("confirmrole"+a,"core_role",f),M.util.get_string("confirmunassignyes","core_role"),M.util.get_string("confirmunassignno","core_role"),function(){o(e,b,a)})});n()};return{initialize:function initialize(b){h=b.contextid;j=b.contextname;k=b.adminurl;var c=a("body");c.on("click",f.ADDROLE,p);c.on("click",f.REMOVEROLE,q)}}});
define ("core/popover_region_controller",["jquery","core/str","core/custom_interaction_events"],function(a,b,c){var d={CONTENT:".popover-region-content",CONTENT_CONTAINER:".popover-region-content-container",MENU_CONTAINER:".popover-region-container",MENU_TOGGLE:".popover-region-toggle",CAN_RECEIVE_FOCUS:"input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]"},e=function(b){this.root=a(b);this.content=this.root.find(d.CONTENT);this.contentContainer=this.root.find(d.CONTENT_CONTAINER);this.menuContainer=this.root.find(d.MENU_CONTAINER);this.menuToggle=this.root.find(d.MENU_TOGGLE);this.isLoading=!1;this.promises={closeHandlers:a.Deferred(),navigationHandlers:a.Deferred()};this.registerBaseEventListeners()};e.prototype.events=function(){return{menuOpened:"popoverregion:menuopened",menuClosed:"popoverregion:menuclosed",startLoading:"popoverregion:startLoading",stopLoading:"popoverregion:stopLoading"}};e.prototype.getContentContainer=function(){return this.contentContainer};e.prototype.getContent=function(){return this.content};e.prototype.isMenuOpen=function(){return!this.root.hasClass("collapsed")};e.prototype.toggleMenu=function(){if(this.isMenuOpen()){this.closeMenu()}else{this.openMenu()}};e.prototype.closeMenu=function(){if(!this.isMenuOpen()){return}this.root.addClass("collapsed");this.menuContainer.attr("aria-expanded","false");this.menuContainer.attr("aria-hidden","true");this.updateButtonAriaLabel();this.root.trigger(this.events().menuClosed)};e.prototype.openMenu=function(){if(this.isMenuOpen()){return}this.root.removeClass("collapsed");this.menuContainer.attr("aria-expanded","true");this.menuContainer.attr("aria-hidden","false");this.updateButtonAriaLabel();this.promises.closeHandlers.resolve();this.promises.navigationHandlers.resolve();this.root.trigger(this.events().menuOpened)};e.prototype.updateButtonAriaLabel=function(){if(this.isMenuOpen()){b.get_string("hidepopoverwindow").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))}else{b.get_string("showpopoverwindow").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))}};e.prototype.startLoading=function(){this.isLoading=!0;this.getContentContainer().addClass("loading");this.getContentContainer().attr("aria-busy","true");this.root.trigger(this.events().startLoading)};e.prototype.stopLoading=function(){this.isLoading=!1;this.getContentContainer().removeClass("loading");this.getContentContainer().attr("aria-busy","false");this.root.trigger(this.events().stopLoading)};e.prototype.focusMenuToggle=function(){this.menuToggle.focus()};e.prototype.contentItemHasFocus=function(){return 0<this.getContentItemWithFocus().length};e.prototype.getContentItemWithFocus=function(){var b=a(document.activeElement),c=this.getContent().children(),d=c.filter(b);if(!d.length){d=c.has(b)}return d};e.prototype.focusContentItem=function(a){if(a.is(d.CAN_RECEIVE_FOCUS)){a.focus()}else{a.find(d.CAN_RECEIVE_FOCUS).first().focus()}};e.prototype.focusFirstContentItem=function(){this.focusContentItem(this.getContent().children().first())};e.prototype.focusLastContentItem=function(){this.focusContentItem(this.getContent().children().last())};e.prototype.focusNextContentItem=function(){var a=this.getContentItemWithFocus();if(a.length&&a.next()){this.focusContentItem(a.next())}};e.prototype.focusPreviousContentItem=function(){var a=this.getContentItemWithFocus();if(a.length&&a.prev()){this.focusContentItem(a.prev())}};e.prototype.registerBaseEventListeners=function(){c.define(this.root,[c.events.activate,c.events.escape]);this.root.on(c.events.activate,d.MENU_TOGGLE,function(){this.toggleMenu()}.bind(this));this.promises.closeHandlers.done(function(){this.root.on(c.events.escape,function(){this.closeMenu();this.focusMenuToggle()}.bind(this));a("html").click(function(b){var c=a(b.target);if(!this.root.is(c)&&!this.root.has(c).length){this.closeMenu()}}.bind(this));c.define(this.getContentContainer(),[c.events.scrollBottom])}.bind(this))};e.prototype.registerListNavigationEventListeners=function(){c.define(this.root,[c.events.down]);this.root.on(c.events.down,function(a,b){if(!this.isMenuOpen()){this.openMenu();this.focusFirstContentItem()}else{if(this.contentItemHasFocus()){this.focusNextContentItem()}else{this.focusFirstContentItem()}}b.originalEvent.preventDefault()}.bind(this));this.promises.navigationHandlers.done(function(){c.define(this.root,[c.events.up,c.events.home,c.events.end]);this.root.on(c.events.up,function(a,b){this.focusPreviousContentItem();b.originalEvent.preventDefault()}.bind(this));this.root.on(c.events.home,function(a,b){this.focusFirstContentItem();b.originalEvent.preventDefault()}.bind(this));this.root.on(c.events.end,function(a,b){this.focusLastContentItem();b.originalEvent.preventDefault()}.bind(this))}.bind(this))};return e});
define ("core/prefetch",["exports","core/config"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);var i="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};function c(a){return g(a)||f(a)||e(a)||d()}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function e(a,b){if(!a)return;if("string"==typeof a)return h(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return h(a,b)}function f(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function g(a){if(Array.isArray(a))return h(a)}function h(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}var j=!1,k=[],l={},m,n=function(){if(k){var d=k.slice();k=[];("function"==typeof i.define&&i.define.amd?new Promise(function(a,b){i.require(["core/templates"],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&i.require&&"component"===i.require.loader?Promise.resolve(require(("core/templates"))):Promise.resolve(i["core/templates"])).then(function(a){return a.prefetchTemplates(d)}).catch()}var a=l;l={};var b=[];Object.keys(a).forEach(function(d){b.push.apply(b,c(a[d].map(function(a){return{component:d,key:a}})))});("function"==typeof i.define&&i.define.amd?new Promise(function(a,b){i.require(["core/str"],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&i.require&&"component"===i.require.loader?Promise.resolve(require(("core/str"))):Promise.resolve(i["core/str"])).then(function(a){return a.get_strings(b)}).catch()},o=function(){if(m){return}if(j){n();return}m=setTimeout(function(){j=!0;m=null;("function"==typeof i.define&&i.define.amd?new Promise(function(a,c){i.require([b.default.iconsystemmodule],a,c)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&i.require&&"component"===i.require.loader?Promise.resolve(require((b.default.iconsystemmodule))):Promise.resolve(i[b.default.iconsystemmodule])).then(function(a){var b=new a;q(b.getTemplateName());return b}).then(function(a){n();a.init()}).catch()},500)},p=function(a){k=k.concat(a);o()},q=function(a){return p([a])},r=function(a,b){if(!l[a]){l[a]=[]}l[a]=l[a].concat(b);o()},s=function(a,b){if(!l[a]){l[a]=[]}l[a].push(b);o()};p([].concat(["core/loading"],["core/modal"],["core/modal_backdrop"]));r("core",["cancel","closebuttontitle","loading","savechanges"]);r("core_form",["showless","showmore"]);a.default={prefetchTemplate:q,prefetchTemplates:p,prefetchString:s,prefetchStrings:r};return a.default});
define ("core/search-input",["jquery"],function(a){var b=null,c=function(a){if(b.hasClass("expanded")){e()}else{d(a)}},d=function(c){var d=a(document).width();if("keydown"===c.type&&13!==c.keyCode&&32!==c.keyCode){return}if(767>=d&&("click"===c.type||"keydown"===c.type)){f();return}else if(767>=d){return}if("keydown"===c.type){c.preventDefault()}b.addClass("expanded");b.find("form").addClass("expanded");b.find("input").focus()},e=function(){b.removeClass("expanded");b.find("form").removeClass("expanded")},f=function(){b.find("form").submit()};return{init:function init(d){b=a("#"+d);b.on("click mouseover keydown","div",c)}}});
define ("core/sessionstorage",["core/config","core/storagewrapper"],function(a,b){var c=new b(window.sessionStorage);return{get:function get(a){return c.get(a)},set:function set(a,b){return c.set(a,b)}}});
define ("core/showhidesettings",["jquery"],function(a){var n;function b(a){return a.is("input[type=hidden]")&&a.siblings("input[type=checkbox][name=\""+a.attr("name")+"\"]").length}function c(a,b){return a.is("input[type=radio]")&&a.attr("value")!==b}function d(a,d){return!b(a)&&!c(a,d)}function e(a){return a.is("input[type=radio]")&&!a.prop("checked")}function f(a){return a.is("input[type=checkbox]")&&!a.prop("checked")}function g(a){return a.is("select")&&a.prop("multiple")}function h(a,b){var c=a.val()||[];if(!b.length){return!1}if(c.length!==b.length){return!1}for(var d in c){if(c.hasOwnProperty(d)){if(-1===b.indexOf(c[d])){return!1}}}return!0}var o={notchecked:function notchecked(b,c){var e=!1;c=c+"";b.each(function(b,f){var g=a(f);if(d(g,c)){e=e||!g.prop("checked")}});return e},checked:function checked(b,c){var e=!1;c=c+"";b.each(function(b,f){var g=a(f);if(d(g,c)){e=e||g.prop("checked")}});return e},noitemselected:function noitemselected(b){var c=!1;b.each(function(b,d){var e=a(d);c=c||-1===e.prop("selectedIndex")});return c},eq:function eq(c,d){var i=!1,j=!1;d=d+"";c.each(function(c,k){var l=a(k);if(e(l)){return}if(b(l)){j=l.val()===d;return}if(f(l)){i=i||j;return}if(g(l)){var m=d.split("|");i=h(l,m);return}i=i||l.val()===d});return i},in:function _in(c,d){var i=!1,j=!1,k=d.split("|");c.each(function(c,d){var l=a(d);if(e(l)){return}if(b(l)){j=-1<k.indexOf(l.val());return}if(f(l)){i=i||j;return}if(g(l)){i=h(l,k);return}i=i||-1<k.indexOf(l.val())});return i},defaultCondition:function defaultCondition(c,d){var i=!1,j=!1;d=d+"";c.each(function(c,k){var l=a(k);if(e(l)){return}if(b(l)){j=l.val()!==d;return}if(f(l)){i=i||j;return}if(g(l)){var m=d.split("|");i=!h(l,m);return}i=i||l.val()!==d});return i}};function i(b){return a("[name=\""+b+"\"],[name^=\""+b+"[\"]")}function j(a,b,c){if("function"==typeof o[b]){return o[b](a,c)}return o.defaultCondition(a,c)}function k(){var b={};a.each(n,function(c){var d=i(c);a.each(n[c],function(c,e){a.each(e,function(e,f){var g=j(d,c,e);a.each(f,function(a,c){if(b.hasOwnProperty(c)){b[c]=b[c]||g}else{b[c]=g}})})})});a.each(b,function(b,c){i(b).each(function(b,d){var e=a(d).closest(".form-item");if(e.length){if(c){e.hide()}else{e.show()}}})})}function l(){a.each(n,function(a){var b=i(a);if(b.length){b.on("change",k)}});k()}function m(){a(".form-dependenton").hide()}return{init:function init(a){n=a.dependencies;l();m()}}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core/sortable_list",["jquery","core/log","core/autoscroll","core/str","core/modal_factory","core/modal_events","core/notification"],function(b,a,c,d,e,f,g){var h={targetListSelector:null,moveHandlerSelector:"[data-drag-type=move]",isHorizontal:!1,autoScroll:!0},j={keyboardDragClass:"dragdrop-keyboard-drag",isDraggedClass:"sortable-list-is-dragged",currentPositionClass:"sortable-list-current-position",sourceListClass:"sortable-list-source",targetListClass:"sortable-list-target",overElementClass:"sortable-list-over-element"},k=function(a){return{setup:function setup(b,c,d){if(c.includes("notPassive")){this.addEventListener(a,d,{passive:!1});return!0}else{return!1}}}};if(function eventListenerOptionsSupported(){var a=!1,b;try{b=Object.defineProperty({},"passive",{get:function get(){a=!0}});document.addEventListener("testpassiveeventoptions",b,b);document.removeEventListener("testpassiveeventoptions",b,b)}catch(b){a=!1}return a}){b.event.special.touchstart=k("touchstart");b.event.special.touchmove=k("touchmove");b.event.special.touchend=k("touchend")}var l=function(a,c){this.info=null;this.proxy=null;this.proxyDelta=null;this.dragCounter=0;this.lastEvent=null;this.config=b.extend({},h,c||{});this.config.listSelector=a;if(!this.config.targetListSelector){this.config.targetListSelector=a}if("object"===_typeof(this.config.listSelector)){b(this.config.listSelector).on("mousedown touchstart.notPassive",b.proxy(this.dragStartHandler,this))}else{b("body").on("mousedown touchstart.notPassive",this.config.listSelector,b.proxy(this.dragStartHandler,this))}if(null!==this.config.moveHandlerSelector){b("body").on("click keypress",this.config.moveHandlerSelector,b.proxy(this.clickHandler,this))}};l.EVENTS={DRAGSTART:"sortablelist-dragstart",DRAG:"sortablelist-drag",DROP:"sortablelist-drop",DRAGEND:"sortablelist-dragend"};l.prototype.resetDraggedClasses=function(){var a=[j.isDraggedClass,j.currentPositionClass,j.overElementClass,j.targetListClass];for(var c in a){b("."+a[c]).removeClass(a[c])}if(this.proxy){this.proxy.remove();this.proxy=b()}};l.prototype.calculatePositionOnPage=function(a){if(a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]!==void 0){var c=a.originalEvent.touches[0];a.pageX=c.pageX;a.pageY=c.pageY}if(a.pageX===void 0){a.pageX=this.lastEvent.pageX;a.pageY=this.lastEvent.pageY}else{this.lastEvent=a}if(a.clientX===void 0){a.clientX=Math.round(a.pageX-b(window).scrollLeft());a.clientY=Math.round(a.pageY-b(window).scrollTop())}};l.prototype.dragStartHandler=function(a){if(null!==this.info){if("click"===this.info.type||"touchend"===this.info.type){return}this.moveElement(this.info.sourceList,this.info.sourceNextElement);this.finishDragging()}if("mousedown"===a.type&&1!==a.which){return}this.calculatePositionOnPage(a);var d=b(a.target).closest(b(a.currentTarget).children());if(!d.length){return}if(null!==this.config.moveHandlerSelector){if(!b(a.target).closest(this.config.moveHandlerSelector,d).length){return}}a.stopPropagation();a.preventDefault();this.dragCounter++;this.info={element:d,sourceNextElement:d.next(),sourceList:d.parent(),targetNextElement:d.next(),targetList:d.parent(),type:a.type,dropped:!1,startX:a.pageX,startY:a.pageY,startTime:new Date().getTime()};b(this.config.targetListSelector).addClass(j.targetListClass);var e=d.offset();d.addClass(j.currentPositionClass);this.proxyDelta={x:e.left-a.pageX,y:e.top-a.pageY};this.proxy=b();var f=this.dragCounter;setTimeout(b.proxy(function(){if(null===this.info||"click"===this.info.type||"keypress"===this.info.type||this.dragCounter!==f){return}this.createProxy()},this),500);b(window).on("mousemove touchmove.notPassive mouseup touchend.notPassive",b.proxy(this.dragHandler,this));b(window).on("keypress",b.proxy(this.dragcancelHandler,this));if(this.config.autoScroll){c.start(function(){b(window).trigger("mousemove")})}this.executeCallback(l.EVENTS.DRAGSTART)};l.prototype.createProxy=function(){this.proxy=this.info.element.clone();this.info.sourceList.append(this.proxy);this.proxy.removeAttr("id").removeClass(j.currentPositionClass).addClass(j.isDraggedClass).css({position:"fixed"});this.proxy.offset({top:this.proxyDelta.y+this.lastEvent.pageY,left:this.proxyDelta.x+this.lastEvent.pageX})};l.prototype.clickHandler=function(a){if("keypress"===a.type&&13!==a.originalEvent.keyCode&&32!==a.originalEvent.keyCode){return}if(null!==this.info){return}var c=b(a.target).closest(this.config.moveHandlerSelector),d=c.closest(this.config.listSelector),e=c.closest(d.children());if(!e.length){return}a.preventDefault();a.stopPropagation();this.dragCounter++;this.info={element:e,sourceNextElement:e.next(),sourceList:d,targetNextElement:e.next(),targetList:d,dropped:!1,type:a.type,startTime:new Date().getTime()};this.executeCallback(l.EVENTS.DRAGSTART);this.displayMoveDialogue(c)};l.prototype.getPositionInNode=function(a,b,c){if(!c.length){return null}var d=c[0],e=d.getBoundingClientRect(),f=b-(e.top+window.scrollY),g=a-(e.left+window.scrollX);if(g>=-0&&g<=e.width+0&&f>=-0&&f<=e.height+0){return{x:g,y:f,xRatio:e.width?g/e.width:0,yRatio:e.height?f/e.height:0}}return null};l.prototype.isListHorizontal=function(a){var b=this.config.isHorizontal;if(!0===b||!1===b){return b}return b(a)};l.prototype.dragHandler=function(a){a.preventDefault();a.stopPropagation();this.calculatePositionOnPage(a);this.proxy.offset({top:-1e3,left:-1e3});var c=b(document.elementFromPoint(a.clientX,a.clientY)),d=this.info.element[0],e=function(){return this!==d},f=c.closest("."+j.targetListClass+" > :not(."+j.isDraggedClass+")").filter(e),g=c.closest("."+j.targetListClass),h=this.proxy,i=function(){return!h||!h.length||this!==h[0]};b("."+j.overElementClass).removeClass(j.overElementClass);f.addClass(j.overElementClass);this.proxy.offset({top:this.proxyDelta.y+a.pageY,left:this.proxyDelta.x+a.pageX});if(g.length&&!g.children().filter(i).length){this.moveElement(g,b())}else if(1===f.length&&!this.info.element.find(f[0]).length){var k=this.getPositionInNode(a.pageX,a.pageY,f);if(k){var m=f.parent(),n=this.isListHorizontal(m)?k.xRatio:k.yRatio,o=f.find("."+j.targetListClass),p=!o.children().filter(i).filter(e).length;if(o.length&&p&&.2<n&&.8>n){this.moveElement(o,b())}else if(.5<n){this.moveElement(m,f.next().filter(i))}else{this.moveElement(m,f)}}}if("mouseup"===a.type||"touchend"===a.type){this.info.endX=a.pageX;this.info.endY=a.pageY;this.info.endTime=new Date().getTime();this.info.dropped=!0;this.info.positionChanged=this.hasPositionChanged(this.info);var q=this.info;this.executeCallback(l.EVENTS.DROP);this.finishDragging();if("touchend"===a.type&&null!==this.config.moveHandlerSelector&&500>q.endTime-q.startTime&&!q.positionChanged){this.clickHandler(a)}}};l.prototype.hasPositionChanged=function(a){return a.sourceList[0]!==a.targetList[0]||a.sourceNextElement.length!==a.targetNextElement.length||a.sourceNextElement.length&&a.sourceNextElement[0]!==a.targetNextElement[0]};l.prototype.moveElement=function(a,b){var c=this.info.element;if(b.length&&b[0]===c[0]){return}if(a[0]===this.info.targetList[0]&&b.length===this.info.targetNextElement.length&&b[0]===this.info.targetNextElement[0]){return}if(b.length){a[0].insertBefore(c[0],b[0])}else if(this.proxy&&this.proxy.parent().length&&this.proxy.parent()[0]===a[0]){a[0].insertBefore(c[0],this.proxy[0])}else{a[0].appendChild(c[0])}this.info.targetList=a;this.info.targetNextElement=b;this.executeCallback(l.EVENTS.DRAG)};l.prototype.finishDragging=function(){this.resetDraggedClasses();if(this.config.autoScroll){c.stop()}b(window).off("mousemove touchmove.notPassive mouseup touchend.notPassive",b.proxy(this.dragHandler,this));b(window).off("keypress",b.proxy(this.dragcancelHandler,this));this.executeCallback(l.EVENTS.DRAGEND);this.info=null};l.prototype.executeCallback=function(a){this.info.element.trigger(a,this.info)};l.prototype.dragcancelHandler=function(a){if("keypress"!==a.type||27!==a.originalEvent.keyCode){return}this.moveElement(this.info.sourceList,this.info.sourceNextElement);this.finishDragging()};l.prototype.getElementName=function(a){return b.Deferred().resolve(a.text())};l.prototype.getDestinationName=function(a,b){if(!b.length){return d.get_string("movecontenttothetop","moodle")}else{return this.getElementName(b).then(function(a){return d.get_string("movecontentafter","moodle",a)})}};l.prototype.getMoveDialogueTitle=function(a,c){if(c.attr("title")){return b.Deferred().resolve(c.attr("title"))}return this.getElementName(a).then(function(a){return d.get_string("movecontent","moodle",a)})};l.prototype.getDestinationsList=function(){var a=[],c=b(this.config.targetListSelector),d=b("<ul/>").addClass(j.keyboardDragClass),e=b.when().then(function(){return d}),f=b.proxy(function(c,f,g){if(f.is(this.info.element)||g.is(this.info.element)){return}if(b.contains(this.info.element[0],c[0])){return}e=e.then(b.proxy(function(){return this.getDestinationName(c,g)},this)).then(function(e){var g=b("<li/>").appendTo(d),h=b("<a href=\"#\"/>").attr("data-core_sortable_list-quickmove",1).appendTo(g);h.data("parent-element",c).data("before-element",f).text(e);return d})},this),g=function(){if(-1!==b.inArray(this,a)){return}a.push(this);var d=b(this),e=d.children();e.each(function(){var a=b(this);f(d,a,a.prev());a.find(c).each(g)});f(d,b(),e.last())};c.each(g);return e};l.prototype.displayMoveDialogue=function(a){e.create({type:e.types.CANCEL,title:this.getMoveDialogueTitle(this.info.element,a),body:this.getDestinationsList()}).then(b.proxy(function(c){var d=b.proxy(function(d){d.preventDefault();d.stopPropagation();this.moveElement(b(d.currentTarget).data("parent-element"),b(d.currentTarget).data("before-element"));this.info.endTime=new Date().getTime();this.info.positionChanged=this.hasPositionChanged(this.info);this.info.dropped=!0;a.focus();this.executeCallback(l.EVENTS.DROP);c.hide()},this);c.getRoot().on("click","[data-core_sortable_list-quickmove]",d);c.getRoot().on(f.hidden,b.proxy(function(){c.getRoot().off("click","[data-core_sortable_list-quickmove]",d);c.destroy();this.finishDragging()},this));c.setLarge();c.show();return c},this)).catch(g.exception)};return l});
define ("core/storagewrapper",["core/config"],function(a){var b=function(b){this.storage=b;this.supported=this.detectSupport();this.hashSource=a.wwwroot+"/"+a.jsrev;this.hash=this.hashString(this.hashSource);this.prefix=this.hash+"/";this.jsrevPrefix=this.hashString(a.wwwroot)+"/jsrev";this.validateCache()};b.prototype.detectSupport=function(){if(-1==a.jsrev){return!1}if("undefined"==typeof this.storage){return!1}try{if(null===this.storage){return!1}this.storage.setItem("test","1");this.storage.removeItem("test");return!0}catch(a){return!1}};b.prototype.prefixKey=function(a){return this.prefix+a};b.prototype.validateCache=function(){var b=this.storage.getItem(this.jsrevPrefix);if(null===b){this.storage.setItem(this.jsrevPrefix,a.jsrev);return}var c=a.jsrev;if(c!=b){this.storage.clear();this.storage.setItem(this.jsrevPrefix,a.jsrev)}};b.prototype.hashString=function(a){var b=0,c,d,e;if(0===a.length){return b}for(c=0,e=a.length;c<e;c++){d=a.charCodeAt(c);b=(b<<5)-b+d;b|=0}return b};b.prototype.get=function(a){if(!this.supported){return!1}a=this.prefixKey(a);return this.storage.getItem(a)};b.prototype.set=function(a,b){if(!this.supported){return!1}a=this.prefixKey(a);try{this.storage.setItem(a,b)}catch(a){return!1}return!0};return b});
define ("core/tag",["jquery","core/ajax","core/templates","core/notification","core/str","core/modal_factory","core/modal_events","core/pending"],function(a,b,c,d,f,g,h,i){return{initTagindexPage:function initTagindexPage(){a("body").delegate(".tagarea[data-ta] a[data-quickload=1]","click",function(f){var e=new i("core/tag:initTagindexPage");f.preventDefault();var g=a(this),h=g[0].search.replace(/^\?/,""),j=g.closest(".tagarea[data-ta]"),k=h.split("&").reduce(function(a,b){var c=b.split("=");a[c[0]]=decodeURIComponent(c[1]);return a},{});b.call([{methodname:"core_tag_get_tagindex",args:{tagindex:k}}])[0].then(function(a){return c.render("core_tag/index",a)}).then(function(a,b){c.replaceNode(j,a,b)}).always(e.resolve).catch(d.exception)})},initManagePage:function initManagePage(){a("body").on("updated","[data-inplaceeditable]",function(b){var c=new i("core/tag:initManagePage");f.get_strings([{key:"selecttag",component:"core_tag"},{key:"now",component:"core"}]).then(function(c){a("label[for=\"tagselect"+b.ajaxreturn.itemid+"\"]").html(c[0]);a(b.target).closest("tr").find("td.col-timemodified").html(c[1])}).always(c.resolve).catch(d.exception);if("tagflag"===b.ajaxreturn.itemtype){var e=a(b.target).closest("tr");if("0"===b.ajaxreturn.value){e.removeClass("flagged-tag")}else{e.addClass("flagged-tag")}}});a(".tag-management-table").delegate("a.tagdelete","click",function(b){var c=new i("core/tag:tagdelete");b.preventDefault();var e=a(this).attr("href");f.get_strings([{key:"delete",component:"core"},{key:"confirmdeletetag",component:"tag"},{key:"yes",component:"core"},{key:"no",component:"core"}]).then(function(a){return d.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=e})}).always(c.resolve).catch(d.exception)});a("#tag-management-delete").click(function(b){var c=a(this).closest("form").get(0),e=a(c).find("input[type=checkbox]:checked").length;if(!e){return}var g=new i("core/tag:tag-management-delete"),h=a("<input type='hidden'/>").attr("name",this.name);b.preventDefault();f.get_strings([{key:"delete",component:"core"},{key:"confirmdeletetags",component:"tag"},{key:"yes",component:"core"},{key:"no",component:"core"}]).then(function(a){return d.confirm(a[0],a[1],a[2],a[3],function(){h.appendTo(c);c.submit()})}).always(g.resolve).catch(d.exception)});a("#tag-management-combine").click(function(b){var e=new i("core/tag:tag-management-combine");b.preventDefault();var j=a(this).closest("form").get(0),k=a(j).find("input[type=checkbox]:checked");if(1>=k.length){f.get_strings([{key:"combineselected",component:"tag"},{key:"selectmultipletags",component:"tag"},{key:"ok"}]).then(function(a){return d.alert(a[0],a[1],a[2])}).always(e.resolve).catch(d.exception);return}var l=a("<input type='hidden'/>").attr("name",this.name),m="",n=[];k.each(function(){var b=a(this).val(),c=a(".inplaceeditable[data-itemtype=tagname][data-itemid="+b+"]").attr("data-value");n.push({id:b,name:c})});f.get_strings([{key:"combineselected",component:"tag"},{key:"continue",component:"core"}]).then(function(a){var b=a[0];m=a[1];return g.create({title:b,body:c.render("core_tag/combine_tags",{tags:n}),type:g.types.SAVE_CANCEL})}).then(function(a){a.setSaveButtonText(m);return a}).then(function(b){b.getRoot().on(h.save,function(b){b.preventDefault();l.appendTo(j);var c=a("input[name=maintag]:checked","#combinetags_form").val();a("<input type='hidden'/>").attr("name","maintag").attr("value",c).appendTo(j);j.submit()});b.getRoot().on(h.hidden,function(){b.destroy()});b.show();a("#combinetags_form input[type=radio]").first().focus().prop("checked",!0)}).always(e.resolve).catch(d.exception)});a("body").on("updatefailed","[data-inplaceeditable][data-itemtype=tagname]",function(b){var c=b.exception,e=b.newvalue,g=a(b.target).attr("data-itemid");if("namesalreadybeeingused"===c.errorcode){var h=new i("core/tag:updatefailed");b.preventDefault();f.get_strings([{key:"confirm",component:"core"},{key:"nameuseddocombine",component:"tag"},{key:"yes",component:"core"},{key:"cancel",component:"core"}]).then(function(a){return d.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=window.location.href+"&newname="+encodeURIComponent(e)+"&tagid="+encodeURIComponent(g)+"&action=renamecombine&sesskey="+M.cfg.sesskey})}).always(h.resolve).catch(d.exception)}});a("body").on("click","a[data-action=addstandardtag]",function(b){var e=new i("core/tag:addstandardtag");b.preventDefault();return g.create({title:f.get_string("addotags","tag"),body:c.render("core_tag/add_tags",{actionurl:window.location.href,sesskey:M.cfg.sesskey}),type:g.types.SAVE_CANCEL}).then(function(b){b.setSaveButtonText(f.get_string("continue","core"));b.getRoot().on(h.save,function(b){var c=a(b.currentTarget).find("#id_tagslist"),d=c.val().trim();c.val(d);var e=a("#addtags_form");e.on("submit",function(b){var c=a("#addtags_form");if(!1===c[0].checkValidity()){b.preventDefault();b.stopPropagation()}c.addClass("was-validated");a("[data-region=\"tagslistinput\"]").addClass("error");var d=a("#id_tagslist_error_message");d.removeAttr("hidden");d.addClass("help-block")});e.submit();return!1});b.getRoot().on(h.hidden,function(){b.destroy()});b.show()}).always(e.resolve).catch(d.exception)})},initManageCollectionsPage:function initManageCollectionsPage(){a("body").on("updated","[data-inplaceeditable]",function(b){var c=new i("core/tag:initManageCollectionsPage-updated"),d=b.ajaxreturn,e,f,g;if("core_tag"===d.component&&"tagareaenable"===d.itemtype){e=a(this).attr("data-itemid");a(".tag-collections-table ul[data-collectionid] li[data-areaid="+e+"]").hide();g=d.value;if("1"===g){a(this).closest("tr").removeClass("dimmed_text");f=a(this).closest("tr").find("[data-itemtype=\"tagareacollection\"]").attr("data-value");a(".tag-collections-table ul[data-collectionid="+f+"] li[data-areaid="+e+"]").show()}else{a(this).closest("tr").addClass("dimmed_text")}}if("core_tag"===d.component&&"tagareacollection"===d.itemtype){e=a(this).attr("data-itemid");a(".tag-collections-table ul[data-collectionid] li[data-areaid="+e+"]").hide();f=a(this).attr("data-value");g=a(this).closest("tr").find("[data-itemtype=\"tagareaenable\"]").attr("data-value");if("1"===g){a(".tag-collections-table ul[data-collectionid="+f+"] li[data-areaid="+e+"]").show()}}c.resolve()});a("body").on("click",".addtagcoll > a",function(b){var e=new i("core/tag:initManageCollectionsPage-addtagcoll");b.preventDefault();var j=a(this).attr("data-url"),k="";f.get_strings([{key:"addtagcoll",component:"tag"},{key:"create",component:"core"}]).then(function(a){var b=a[0];k=a[1];var d={actionurl:j,sesskey:M.cfg.sesskey};return g.create({title:b,body:c.render("core_tag/add_tag_collection",d),type:g.types.SAVE_CANCEL})}).then(function(b){b.setSaveButtonText(k);b.getRoot().on(h.save,function(b){var c=a(b.currentTarget).find("#addtagcoll_name"),d=c.val().trim();c.val(d);var f=a("#addtagcoll_form");f.on("submit",function(b){if(!1===f[0].checkValidity()){b.preventDefault();b.stopPropagation()}f.addClass("was-validated");a("[data-region=\"addtagcoll_nameinput\"]").addClass("error");var c=a("#id_addtagcoll_name_error_message");c.removeAttr("hidden");c.addClass("help-block")});f.submit();return!1});b.getRoot().on(h.hidden,function(){b.destroy()});b.show();return b}).always(e.resolve).catch(d.exception)});a("body").on("click",".tag-collections-table .action_delete",function(b){var c=new i("core/tag:initManageCollectionsPage-action_delete");b.preventDefault();var e=a(this).attr("data-url")+"&sesskey="+M.cfg.sesskey;f.get_strings([{key:"delete"},{key:"suredeletecoll",component:"tag",param:a(this).attr("data-collname")},{key:"yes"},{key:"no"}]).then(function(a){return d.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=e})}).always(c.resolve).catch(d.exception)})}}});
define ("core/templates",["core/mustache","jquery","core/ajax","core/str","core/notification","core/url","core/config","core/localstorage","core/icon_system","core/event","core/yui","core/log","core/truncate","core/user_date","core/pending"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=0,q={},r={},s={},t={},u=[],v=!1,w=["js"],x=function(a){if(a){if("moodle"!==a&&"core"!==a){return a}}return"core"},y=function(a){if(a in r){return r[a]}if(a in q){r[a]=b.Deferred().resolve(q[a]).promise();return r[a]}if(0>=M.cfg.templaterev){return null}var c=h.get("core_template/"+M.cfg.templaterev+":"+a);if(c){q[a]=c;r[a]=b.Deferred().resolve(c).promise();return r[a]}return null},z=function(){if(!u.length){return}if(v){return}v=!0;var a=u.slice(),e=b.Deferred(),f=[],g=a.map(function(a){var c=x(a.component),i=a.name,j=a.searchKey,k=a.theme,l=a.deferred,m=null,n=y(j);if(n){m=n}else{f.push({methodname:"core_output_load_template_with_dependencies",args:{component:c,template:i,themename:k,lang:b("html").attr("lang").replace(/-/g,"_")}});var o=f.length-1;m=e.promise().then(function(a){g[j]=a[o].then(function(a){var b=null;a.templates.forEach(function(a){a.component=x(a.component);var d=[k,a.component,a.name].join("/");q[d]=a.value;if(0<M.cfg.templaterev){h.set("core_template/"+M.cfg.templaterev+":"+d,a.value)}if(a.component==c&&a.name==i){b=a.value}});if(a.strings.length){d.cache_strings(a.strings.map(function(a){return{component:x(a.component),key:a.name,value:a.value}}))}return b});return g[j]})}return m.then(function(a){return l.resolve(a)}).catch(function(a){l.reject(a);throw a})});if(f.length){e.resolve(c.call(f,!0,!1,!1,0,M.cfg.templaterev))}else{e.resolve()}b.when.apply(null,g).then(function(){u.splice(0,a.length);v=!1;z()}).catch(function(){u.splice(0,a.length);v=!1;z()})},A=function(){this.requiredStrings=[];this.requiredJS=[];this.requiredDates=[];this.currentThemeName=""};A.prototype.requiredStrings=null;A.prototype.requiredDates=[];A.prototype.requiredJS=null;A.prototype.currentThemeName="";A.prototype.getTemplate=function(a){var c=this.currentThemeName,d=c+"/"+a,e=y(d);if(e){return e}var f=u.filter(function(a){return a.searchKey==d});if(f.length){return f[0].deferred.promise()}var g=a.split("/"),h=x(g.shift()),i=g.join("/"),j=b.Deferred();u.push({component:h,name:i,theme:c,searchKey:d,deferred:j});z();return j.promise()};A.prototype.prefetchTemplates=function(a,c){a.forEach(function(a){var d=c+"/"+a;if(y(d)){return}var e=u.filter(function(a){return a.searchKey==d});if(e.length){return}var f=a.split("/"),g=x(f.shift()),h=f.join("/");u.push({component:g,name:h,theme:c,searchKey:d,deferred:b.Deferred()})});z()};A.prototype.partialHelper=function(a){var b=this.currentThemeName+"/"+a;if(!(b in q)){e.exception(new Error("Failed to pre-fetch the template: "+a))}return q[b]};A.prototype.renderIcon=function(a,c,d){var f=g.iconsystemmodule;c=x(c);var h=b.Deferred();require([f],function(a){var b=new a;if(!(b instanceof i)){h.reject("Invalid icon system specified"+g.iconsystemmodule)}else{t=b;b.init().then(h.resolve).catch(e.exception)}});return h.then(function(a){return this.getTemplate(a.getTemplateName())}.bind(this)).then(function(b){return t.renderIcon(a,c,d,b)})};A.prototype.pixHelper=function(a,b,c){var d=b.split(","),e="",f="",g="";if(0<d.length){e=c(d.shift().trim(),a)}if(0<d.length){f=c(d.shift().trim(),a)}if(0<d.length){g=c(d.join(",").trim(),a)}var h=t.getTemplateName(),i=this.currentThemeName+"/"+h,j=q[i];f=x(f);e=e.replace(/&#x2F;/gi,"/");return t.renderIcon(e,f,g,j)};A.prototype.jsHelper=function(a,b,c){this.requiredJS.push(c(b,a));return""};A.prototype.stringHelper=function(a,b,c){var d=b.split(","),e="",f="",g="";if(0<d.length){e=d.shift().trim()}if(0<d.length){f=d.shift().trim()}if(0<d.length){g=d.join(",").trim()}f=x(f);if(""!==g){g=c(g,a)}if(0===g.indexOf("{")&&0!==g.indexOf("{{")){g=JSON.parse(g)}var h=this.requiredStrings.length;this.requiredStrings.push({key:e,component:f,param:g});return"[[_s"+h+"]]"};A.prototype.quoteHelper=function(a,b,c){var d=c(b.trim(),a);d=d.replace(/"/g,"\\\"").replace(/([{}]{2,3})/g,"{{=<% %>=}}$1<%={{ }}=%>").replace(/(\r\n|\r|\n)/g,"&#x0a;");return"\""+d+"\""};A.prototype.shortenTextHelper=function(a,b,c){var d=b.match(/(.*?),(.*)/),e=d[1].trim(),f=d[2].trim(),g=c(f,a);return m.truncate(g,{length:e,words:!0,ellipsis:"..."})};A.prototype.userDateHelper=function(a,b,c){var d=b.match(/(.*?),(.*)/),e=c(d[1].trim(),a),f=c(d[2].trim(),a),g=this.requiredDates.length;this.requiredDates.push({timestamp:e,format:f});return"[[_t_"+g+"]]"};A.prototype.addHelperFunction=function(a,b){return function(){return function(c,d){var e=w.reduce(function(a,c){if(b.hasOwnProperty(c)){a[c]=b[c]}return a},{});w.forEach(function(a){b[a]=function(){return""}});var f=a.apply(this,[b,c,d]);for(var g in e){b[g]=e[g]}return f}.bind(this)}.bind(this)};A.prototype.addHelpers=function(a,b){this.currentThemeName=b;this.requiredStrings=[];this.requiredJS=[];a.uniqid=p++;a.str=this.addHelperFunction(this.stringHelper,a);a.pix=this.addHelperFunction(this.pixHelper,a);a.js=this.addHelperFunction(this.jsHelper,a);a.quote=this.addHelperFunction(this.quoteHelper,a);a.shortentext=this.addHelperFunction(this.shortenTextHelper,a);a.userdate=this.addHelperFunction(this.userDateHelper,a);a.globals={config:g};a.currentTheme=b};A.prototype.getJS=function(){var a="";if(0<this.requiredJS.length){a=this.requiredJS.join(";\n")}return a};A.prototype.treatStringsInContent=function(a,b){var c=/\[\[_s\d+\]\]/,d,e,f,g,h,i;do{d="";e=a.search(c);while(-1<e){d+=a.substring(0,e);a=a.substr(e);f="";g=4;h=a.substr(g,1);do{f+=h;g++;h=a.substr(g,1)}while("]"!=h);i=b[parseInt(f,10)];if("undefined"==typeof i){l.debug("Could not find string for pattern [[_s"+f+"]].");i=""}d+=i;a=a.substr(6+f.length);e=a.search(c)}a=d+a;e=a.search(c)}while(-1<e);return a};A.prototype.treatDatesInContent=function(a,b){b.forEach(function(b,c){var d=new RegExp("\\[\\[_t_"+c+"\\]\\]","g");a=a.replace(d,b)});return a};A.prototype.doRender=function(c,e,f){this.currentThemeName=f;var g=t.getTemplateName(),h=new o("core/templates:doRender");return this.getTemplate(g).then(function(){this.addHelpers(e,f);var d=a.render(c,e,this.partialHelper.bind(this));return b.Deferred().resolve(d.trim(),this.getJS()).promise()}.bind(this)).then(function(a,c){if(0<this.requiredStrings.length){return d.get_strings(this.requiredStrings).then(function(d){this.requiredDates=this.requiredDates.map(function(a){return{timestamp:this.treatStringsInContent(a.timestamp,d),format:this.treatStringsInContent(a.format,d)}}.bind(this));a=this.treatStringsInContent(a,d);c=this.treatStringsInContent(c,d);return b.Deferred().resolve(a,c).promise()}.bind(this))}return b.Deferred().resolve(a,c).promise()}.bind(this)).then(function(a,c){if(0<this.requiredDates.length){return n.get(this.requiredDates).then(function(d){a=this.treatDatesInContent(a,d);c=this.treatDatesInContent(c,d);return b.Deferred().resolve(a,c).promise()}.bind(this))}return b.Deferred().resolve(a,c).promise()}.bind(this)).then(function(a,c){h.resolve();return b.Deferred().resolve(a,c).promise()})};var B=function(a){if(""!==a.trim()){var c=b("<script>").attr("type","text/javascript").html(a);b("head").append(c)}},C=function(a,c,d,e){var f=b(a);if(f.length){var g=b(c),h=null;if(e){h=new k.NodeList(f.children().get());h.destroy(!0);f.empty();f.append(g)}else{h=new k.NodeList(f.get());h.destroy(!0);f.replaceWith(g)}B(d);j.notifyFilterContentUpdated(g);return g.get()}return[]};A.prototype.scanForPartials=function(b){var c=a.parse(b),d=[],e=function(a,b){var c,d;for(c=0;c<a.length;c++){d=a[c];if(">"==d[0]||"<"==d[0]){b.push(d[1])}if(4<d.length){e(d[4],b)}}};e(c,d);return d};A.prototype.cachePartials=function(a,c){var d=this.currentThemeName+"/"+a;if(d in s){return s[d]}c=c||[d];s[d]=b.Deferred();this.getTemplate(a).then(function(e){var f=this.scanForPartials(e),g=f.filter(function(b){if(0<=c.indexOf(this.currentThemeName+"/"+b)){return!1}return b!=a}.bind(this)),h=g.map(function(a){c.push(this.currentThemeName+"/"+a);return this.cachePartials(a,c)}.bind(this));return b.when.apply(b,h).then(function(){return s[d].resolve(e)})}.bind(this)).catch(s[d].reject);return s[d]};A.prototype.render=function(a,c,d){if("undefined"==typeof d){d=g.theme}this.currentThemeName=d;var f=g.iconsystemmodule,h=b.Deferred();require([f],function(a){var b=new a;if(!(b instanceof i)){h.reject("Invalid icon system specified"+g.iconsystem)}else{t=b;b.init().then(h.resolve).catch(e.exception)}});return h.then(function(){return this.cachePartials(a)}.bind(this)).then(function(a){return this.doRender(a,c,d)}.bind(this))};var D=function(a,c,d){var e=b(a);if(e.length){var f=b(c);e.prepend(f);B(d);j.notifyFilterContentUpdated(e);return f.get()}return[]},E=function(a,c,d){var e=b(a);if(e.length){var f=b(c);e.append(f);B(d);j.notifyFilterContentUpdated(e);return f.get()}return[]};return{render:function render(a,b,c){var d=new A;return d.render(a,b,c)},prefetchTemplates:function prefetchTemplates(a,b){var c=new A;if("undefined"==typeof b){b=g.theme}return c.prefetchTemplates(a,b)},renderForPromise:function renderForPromise(a,b,c){var d=new A;return d.render(a,b,c).then(function(a,b){return{html:a,js:b}})},renderPix:function renderPix(a,b,c){var d=new A;return d.renderIcon(a,x(b),c)},runTemplateJS:B,replaceNodeContents:function replaceNodeContents(a,b,c){return C(a,b,c,!0)},replaceNode:function replaceNode(a,b,c){return C(a,b,c,!1)},prependNodeContents:function prependNodeContents(a,b,c){return D(a,b,c)},appendNodeContents:function appendNodeContents(a,b,c){return E(a,b,c)}}});
define ("core/toast",["exports","core/templates","core/notification","core/pending"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.add=a.addToastRegion=void 0;b=e(b);c=e(c);d=e(d);function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function g(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){f(Object(c),!0).forEach(function(b){h(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{f(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function h(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function i(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function j(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){i(h,d,e,f,g,"next",a)}function g(a){i(h,d,e,f,g,"throw",a)}f(void 0)})}}var k=function(){var a=j(regeneratorRuntime.mark(function a(e){var f,g,h,i;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:f=new d.default("addToastRegion");a.prev=1;a.next=4;return b.default.renderForPromise("core/local/toast/wrapper",{});case 4:g=a.sent;h=g.html;i=g.js;b.default.prependNodeContents(e,h,i);a.next=13;break;case 10:a.prev=10;a.t0=a["catch"](1);c.default.exception(a.t0);case 13:f.resolve();case 14:case"end":return a.stop();}}},a,null,[[1,10]])}));return function(){return a.apply(this,arguments)}}();a.addToastRegion=k;var l=function(){var a=j(regeneratorRuntime.mark(function a(e,f){var h,i,j,k,l,n;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:h=new d.default("addToastRegion");f=g({closeButton:!1,autohide:!0,delay:4e3},f);i="core/local/toast/message";a.prev=3;a.next=6;return m();case 6:j=a.sent;a.next=9;return b.default.renderForPromise(i,g({message:e},f));case 9:k=a.sent;l=k.html;n=k.js;b.default.prependNodeContents(j,l,n);a.next=18;break;case 15:a.prev=15;a.t0=a["catch"](3);c.default.exception(a.t0);case 18:h.resolve();case 19:case"end":return a.stop();}}},a,null,[[3,15]])}));return function(){return a.apply(this,arguments)}}();a.add=l;var m=function(){var a=j(regeneratorRuntime.mark(function a(){var b;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:b=document.querySelectorAll(".toast-wrapper");if(!b.length){a.next=3;break}return a.abrupt("return",b[b.length-1]);case 3:a.next=5;return k(document.body,"fixed-bottom");case 5:return a.abrupt("return",m());case 6:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}()});
define ("core/tooltip",["jquery"],function(a){var b=function(b){this._regionSelector=b;a(this._regionSelector).each(function(b,c){var d=a(c).attr("aria-describedby");if(d){var e=document.getElementById(d);if(e){var f="tooltip"==a(e).attr("role");if(f){a(e).hide();a(c).attr("tabindex","0")}a(c).on("focus",this._handleFocus.bind(this));a(c).on("mouseover",this._handleMouseOver.bind(this));a(c).on("mouseout",this._handleMouseOut.bind(this));a(c).on("blur",this._handleBlur.bind(this));a(c).on("keydown",this._handleKeyDown.bind(this))}}}.bind(this))};b.prototype._regionSelector=null;b.prototype._showTooltip=function(b){var c=a(b.target),d=c.attr("aria-describedby");if(d){var e=a(document.getElementById(d));e.show();e.attr("aria-hidden","false");if(!e.is(".tooltip")){var f=a("<div class=\"tooltip-inner\"></div>");f.append(e.contents());e.append(f);e.addClass("tooltip");e.addClass("bottom");e.append("<div class=\"tooltip-arrow\"></div>")}var g=c.offset();g.top+=c.height()+10;a(e).offset(g)}};b.prototype._hideTooltip=function(b){var c=a(b.target),d=c.attr("aria-describedby");if(d){var e=document.getElementById(d);a(e).hide();a(e).attr("aria-hidden","true")}};b.prototype._handleFocus=function(a){this._showTooltip(a)};b.prototype._handleKeyDown=function(a){if(27==a.which){this._hideTooltip(a)}};b.prototype._handleMouseOver=function(a){this._showTooltip(a)};b.prototype._handleMouseOut=function(b){var c=a(b.target);if(!c.is(":focus")){this._hideTooltip(b)}};b.prototype._handleBlur=function(a){this._hideTooltip(a)};return b});
define ("core/tree",["jquery"],function(a){var b={ITEM:"[role=treeitem]",GROUP:"[role=treeitem]:has([role=group]), [role=treeitem][aria-owns], [role=treeitem][data-requires-ajax=true]",CLOSED_GROUP:"[role=treeitem]:has([role=group])[aria-expanded=false], [role=treeitem][aria-owns][aria-expanded=false], [role=treeitem][data-requires-ajax=true][aria-expanded=false]",FIRST_ITEM:"[role=treeitem]:first",VISIBLE_ITEM:"[role=treeitem]:visible",UNLOADED_AJAX_ITEM:"[role=treeitem][data-requires-ajax=true][data-loaded=false][aria-expanded=true]"},c=function(c,d){this.treeRoot=a(c);this.treeRoot.data("activeItem",null);this.selectCallback=d;this.keys={tab:9,enter:13,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,asterisk:106};this.initialiseNodes(this.treeRoot);this.setActiveItem(this.treeRoot.find(b.FIRST_ITEM));this.refreshVisibleItemsCache();this.bindEventHandlers()};c.prototype.registerEnterCallback=function(a){this.enterCallback=a};c.prototype.refreshVisibleItemsCache=function(){this.treeRoot.data("visibleItems",this.treeRoot.find(b.VISIBLE_ITEM))};c.prototype.getVisibleItems=function(){return this.treeRoot.data("visibleItems")};c.prototype.setActiveItem=function(a){var b=this.treeRoot.data("activeItem");if(a===b){return}if(b){b.attr("tabindex","-1");b.attr("aria-selected","false")}a.attr("tabindex","0");a.attr("aria-selected","true");this.treeRoot.data("activeItem",a);if("function"==typeof this.selectCallback){this.selectCallback(a)}};c.prototype.isGroupItem=function(a){return a.is(b.GROUP)};c.prototype.getGroupFromItem=function(a){var b=this.treeRoot.find("#"+a.attr("aria-owns")),c=a.children("[role=group]");if(b.length>c.length){return b}else{return c}};c.prototype.isGroupCollapsed=function(a){return"false"===a.attr("aria-expanded")};c.prototype.isGroupCollapsible=function(a){return"false"!==a.attr("data-collapsible")};c.prototype.initialiseNodes=function(c){this.removeAllFromTabOrder(c);this.setAriaSelectedFalseOnItems(c);var d=this;c.find(b.UNLOADED_AJAX_ITEM).each(function(){var b=a(this);d.collapseGroup(b);d.expandGroup(b)})};c.prototype.removeAllFromTabOrder=function(b){b.find("*").attr("tabindex","-1");this.getGroupFromItem(a(b)).find("*").attr("tabindex","-1")};c.prototype.setAriaSelectedFalseOnItems=function(a){a.find(b.ITEM).attr("aria-selected","false")};c.prototype.expandAllGroups=function(){var c=this;this.treeRoot.find(b.CLOSED_GROUP).each(function(){var b=a(this);c.expandGroup(a(this)).done(function(){c.expandAllChildGroups(b)})})};c.prototype.expandAllChildGroups=function(c){var d=this;this.getGroupFromItem(c).find(b.CLOSED_GROUP).each(function(){var b=a(this);d.expandGroup(a(this)).done(function(){d.expandAllChildGroups(b)})})};c.prototype.expandGroup=function(b){var c=a.Deferred();if("false"!==b.attr("data-expandable")&&this.isGroupCollapsed(b)){if("true"===b.attr("data-requires-ajax")&&"true"!==b.attr("data-loaded")){b.attr("data-loaded",!1);var d=b.closest("[data-ajax-loader]").attr("data-ajax-loader"),e=this;b.addClass("loading");require([d],function(a){a.load(b).done(function(){b.attr("data-loaded",!0);e.initialiseNodes(b);e.finishExpandingGroup(b);b.removeClass("loading");c.resolve()})})}else{this.finishExpandingGroup(b);c.resolve()}}else{c.resolve()}return c};c.prototype.finishExpandingGroup=function(a){var b=this.getGroupFromItem(a);b.attr("aria-hidden","false");a.attr("aria-expanded","true");this.refreshVisibleItemsCache()};c.prototype.collapseGroup=function(a){if(!this.isGroupCollapsible(a)||this.isGroupCollapsed(a)){return}var b=this.getGroupFromItem(a);b.attr("aria-hidden","true");a.attr("aria-expanded","false");this.refreshVisibleItemsCache()};c.prototype.toggleGroup=function(a){if("true"===a.attr("aria-expanded")){this.collapseGroup(a)}else{this.expandGroup(a)}};c.prototype.handleKeyDown=function(c,d){var e=this.getVisibleItems().index(c);if(d.altKey||d.ctrlKey||d.metaKey||d.shiftKey&&d.keyCode!=this.keys.tab){return!0}switch(d.keyCode){case this.keys.home:{this.getVisibleItems().first().focus();d.stopPropagation();return!1}case this.keys.end:{this.getVisibleItems().last().focus();d.stopPropagation();return!1}case this.keys.enter:{var f=c.children("a").length?c.children("a"):c.children().not(b.GROUP).find("a");if(f.length){if("function"==typeof this.enterCallback){this.enterCallback(c)}else{window.location.href=f.first().attr("href")}}else if(this.isGroupItem(c)){this.toggleGroup(c,!0)}d.stopPropagation();return!1}case this.keys.space:{if(this.isGroupItem(c)){this.toggleGroup(c,!0)}d.stopPropagation();return!1}case this.keys.left:{var g=function(b){b.getVisibleItems().filter(function(){return b.getGroupFromItem(a(this)).has(c).length}).focus()};if(this.isGroupItem(c)){if(this.isGroupCollapsed(c)){g(this)}else{this.collapseGroup(c)}}else{g(this)}d.stopPropagation();return!1}case this.keys.right:{if(this.isGroupItem(c)){if(this.isGroupCollapsed(c)){this.expandGroup(c)}else{this.getGroupFromItem(c).find(b.ITEM).first().focus()}}d.stopPropagation();return!1}case this.keys.up:{if(0<e){var h=this.getVisibleItems().eq(e-1);h.focus()}d.stopPropagation();return!1}case this.keys.down:{if(e<this.getVisibleItems().length-1){var i=this.getVisibleItems().eq(e+1);i.focus()}d.stopPropagation();return!1}case this.keys.asterisk:{this.expandAllGroups();d.stopPropagation();return!1}}return!0};c.prototype.handleClick=function(a,b){if(b.altKey||b.ctrlKey||b.shiftKey||b.metaKey){return!0}a.focus();if(this.isGroupItem(a)){this.toggleGroup(a)}b.stopPropagation();return!0};c.prototype.handleFocus=function(a,b){this.setActiveItem(a);b.stopPropagation();return!0};c.prototype.bindEventHandlers=function(){var c=this;this.treeRoot.on({click:function click(b){return c.handleClick(a(this),b)},keydown:function keydown(b){return c.handleKeyDown(a(this),b)},focus:function focus(b){return c.handleFocus(a(this),b)}},b.ITEM)};return c});
define ("core/truncate",["jquery"],function(a){var b=function(a,b){var c=a+"",d=c.length,e=b?+b:0;if(e!=e){e=0}if(-1>=e||e>=d){return""}e=0|e;var f=c.charCodeAt(e),g,h=e+1,i=1;if(55296<=f&&56319>=f&&d>h){g=c.charCodeAt(h);if(56320<=g&&57343>=g){i=2}}return i},c=function(a){for(var c=0,d=0;d<a.length;d+=b(a,d)){c++}return c},d=function(a,c){if(!a.length){return 0}var d=0,e=0;do{d+=b(a,d);e++}while(d<a.length&&e<c);return d};a.truncate=function(b,c){return a("<div></div>").append(b).truncate(c).html()};a.fn.truncate=function(b){if(!isNaN(parseFloat(b)))b={length:b};var e=a.extend({},a.truncate.defaults,b);return this.each(function(){var b=a(this);if(e.noBreaks)b.find("br").replaceWith(" ");var f=e.ellipsis.length,g=b.text(),h=c(g),j=h-e.length+f;if(h<e.length)return;if(e.stripTags)b.text(g);if(e.words&&0<j){var k=g.slice(0,d(g,e.length-f)+1),l=k.replace(/(\s*\S+|\s)$/,""),m=c(l),n=k.match(/\s/)?!1:!0;if(e.keepFirstWord&&0===m){j=h-c(/^(\S*)/.exec(g)[0])-f}else if(n&&0===m){j=h-e.length+f}else{j=h-m-1}}if(j>h){j=h-e.length}if(0>j||!j&&!e.truncated)return;a.each(b.contents().get().reverse(),function(b,g){var h=a(g),i=h.text(),k=c(i);if(k<=j){e.truncated=!0;j-=k;h.remove();return}if(3===g.nodeType){var l=k-j;l=0<=l?d(i,l):0;a(g.splitText(l)).replaceWith(e.ellipsis);return!1}h.truncate(a.extend(e,{length:k-j+f}));return!1})})};a.truncate.defaults={stripTags:!1,words:!1,keepFirstWord:!1,noBreaks:!1,length:1/0,ellipsis:"\u2026"};return{truncate:a.truncate}});
define ("core/url",["jquery","core/config"],function(a,b){return{fileUrl:function fileUrl(a,c){var d=b.wwwroot+a;if("/"!=c.charAt(0)){c="/"+c}if(b.slasharguments){d+=c}else{d+="?file="+encodeURIComponent(c)}return d},relativeUrl:function relativeUrl(c,d,e){if(0===c.indexOf("http:")||0===c.indexOf("https:")||0<=c.indexOf("://")){throw new Error("relativeUrl function does not accept absolute urls")}if("/"!=c.charAt(0)){c="/"+c}if("admin"!==b.admin){c=c.replace(/^\/admin\//,"/"+b.admin+"/")}d=d||{};if(e){d.sesskey=b.sesskey}var f="";if(Object.keys(d).length){f=a.map(d,function(a,b){return b+"="+a}).join("&")}if(""!==f){return b.wwwroot+c+"?"+f}else{return b.wwwroot+c}},imageUrl:function imageUrl(a,b){return M.util.image_url(a,b)}}});
define ("core/user_date",["jquery","core/ajax","core/sessionstorage","core/config"],function(a,b,c,d){var e={},f=function(b){var c=a("html").attr("lang").replace(/-/g,"_");return"core_user_date/"+c+"/"+d.usertimezone+"/"+b.timestamp+"/"+b.format},g=function(a){return c.get(a)},h=function(a,b){c.set(a,b)},i=function(a){return"undefined"!=typeof e[a]},j=function(a){return e[a]},k=function(a,b){e[a]=b},l=function(a){var c=a.map(function(a){var b=a.hasOwnProperty("fixday")?a.fixday:1,c=a.hasOwnProperty("fixhour")?a.fixhour:1;return{timestamp:a.timestamp,format:a.format,type:a.type||null,fixday:b,fixhour:c}}),e={methodname:"core_get_user_dates",args:{contextid:d.contextid,timestamps:c}};return b.call([e],!0,!0)[0].then(function(b){b.dates.forEach(function(b,c){var d=a[c],e=f(d);h(e,b);d.deferred.resolve(b)})}).catch(function(b){a.forEach(function(a){a.deferred.reject(b)})})};return{get:function get(b){var c=[],d=[];b.forEach(function(b){var e=f(b);if(i(e)){d.push(j(e))}else{var h=a.Deferred(),l=g(e);if(l){h.resolve(l)}else{b.deferred=h;c.push(b)}k(e,h.promise());d.push(h.promise())}});if(c.length){l(c)}return a.when.apply(a,d).then(function(){return 1===arguments.length?[arguments[0]]:Array.apply(null,arguments)})},getUserMidnightForTimestamp:function getUserMidnightForTimestamp(a,b){var c=a>b,d=Math.abs(a-b),e=c?Math.floor(d/86400):Math.ceil(d/86400),f=e*86400,g=c?b+f:b-f;return g}}});
define ("core/userfeedback",["exports","core/ajax","core/notification"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.registerEventListeners=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}var f={regions:{root:"[data-region=\"core/userfeedback\"]"},actions:{}};f.actions.give="".concat(f.regions.root," [data-action=\"give\"]");f.actions.remind="".concat(f.regions.root," [data-action=\"remind\"]");a.registerEventListeners=function registerEventListeners(){document.addEventListener("click",function(a){var b=a.target.closest(f.actions.give);if(b){a.preventDefault();if(!window.open(b.href)){throw new Error("Unable to open popup")}Promise.resolve(b).then(h).then(g).catch(c.default.exception)}var d=a.target.closest(f.actions.remind);if(d){a.preventDefault();Promise.resolve(d).then(h).then(g).catch(c.default.exception)}})};var g=function(a){if(a.dataset.record){return b.default.call([{methodname:"core_create_userfeedback_action_record",args:{action:a.dataset.action,contextid:M.cfg.contextid}}])[0]}return Promise.resolve()},h=function(a){if(a.dataset.hide){a.closest(f.regions.root).remove()}return a}});
define ("core/utils",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.debounce=a.throttle=void 0;a.throttle=function throttle(a,b){var c=!1,d=null,e=function(){for(var f=arguments.length,g=Array(f),h=0;h<f;h++){g[h]=arguments[h]}if(null===d){d=!1}else{d=!0}if(c){return}a.apply(this,g);c=!0;setTimeout(function(){var a=d;c=!1;d=null;if(a){e(g)}},b)};return e};a.debounce=function debounce(a,b){var c=null;return function(){for(var d=this,e=arguments.length,f=Array(e),g=0;g<e;g++){f[g]=arguments[g]}clearTimeout(c);c=setTimeout(function(){a.apply(d,f)},b)}}});
define ("core/yui",function(){return Y});
define ("core_backup/async_backup",["jquery","core/ajax","core/str","core/notification","core/templates"],function(a,b,c,d,e){var q=900,r=1e3,s={},t=15e3,u=15e3,v=1.5,w,x,y,z,A,B,C,D=2e3;function f(a,b,c){var d=Math.round(c)+"%",e=document.querySelectorAll("[data-"+b+"id="+CSS.escape(a)+"]")[0],f=c.toFixed(2)+"%";e.setAttribute("aria-valuenow",d);e.style.width=d;e.innerHTML=f}function g(a,b,c){clearInterval(a);return setInterval(b,c)}function h(c){var f=a("#"+c+"_bar").parent().parent(),g=f.parent(),h=f.siblings(),i=h[1],j=a(i).text(),k=h[0],l=a(k).text();b.call([{methodname:"core_backup_get_async_backup_links_backup",args:{filename:l,contextid:x}}])[0].done(function(a){var b={filename:l,time:j,size:a.filesize,fileurl:a.fileurl,restoreurl:a.restoreurl};e.render("core/async_backup_progress_row",b).then(function(a,b){e.replaceNodeContents(g,a,b)}).fail(function(){d.exception(new Error("Failed to load table row"))})})}function i(c){var f=a("#"+c+"_bar").parent().parent(),g=f.parent(),h=f.siblings(),i=h[0],j=h[1],k=a(j).text();b.call([{methodname:"core_backup_get_async_backup_links_restore",args:{backupid:c,contextid:x}}])[0].done(function(b){var c=a(i).text(),f={resourcename:c,restoreurl:b.restoreurl,time:k};e.render("core/async_restore_progress_row",f).then(function(a,b){e.replaceNodeContents(g,a,b)}).fail(function(){d.exception(new Error("Failed to load table row"))})})}function j(a){var f=document.querySelectorAll("[data-restoreid="+CSS.escape(a)+"]")[0],g=f.closest("tr").children[1],h=g.innerHTML,i=document.createElement("a"),j=f.closest("td"),k=j.previousElementSibling;c.get_string("complete").then(function(a){k.innerHTML=a}).catch(function(){d.exception(new Error("Failed to load string: complete"))});e.render("core/async_copy_complete_cell",{}).then(function(a,b){e.replaceNodeContents(j,a,b)}).fail(function(){d.exception(new Error("Failed to load table cell"))});b.call([{methodname:"core_backup_get_async_backup_links_restore",args:{backupid:a,contextid:0}}])[0].done(function(a){i.setAttribute("href",a.restoreurl);i.innerHTML=h;g.innerHTML=null;g.appendChild(i)}).fail(function(){d.exception(new Error("Failed to update table row"))})}function k(e){var g=100*e.progress,h="backup",i=document.querySelectorAll("[data-"+h+"id="+CSS.escape(w)+"]")[0],j=a("#"+w+"_status"),k=a("#"+w+"_detail"),l=a("#"+w+"_button"),m;if(e.status==800){i.classList.add("bg-success");f(w,h,g);var n="async"+z+"processing";c.get_string(n,"backup").then(function(a){j.text(a)}).catch(function(){d.exception(new Error("Failed to load string: backup "+n))})}else if(e.status==q){i.classList.add("bg-danger");i.classList.remove("bg-success");f(w,h,100);var o="async"+z+"error",p="async"+z+"errordetail";m=[{key:o,component:"backup"},{key:p,component:"backup"}];c.get_strings(m).then(function(a){j.text(a[0]);k.text(a[1])}).catch(function(){d.exception(new Error("Failed to load string"))});a(".backup_progress").children("span").removeClass("backup_stage_current");a(".backup_progress").children("span").last().addClass("backup_stage_current");clearInterval(A)}else if(e.status==r){i.classList.add("bg-success");f(w,h,100);var s="async"+z+"complete";c.get_string(s,"backup").then(function(a){j.text(a)}).catch(function(){d.exception(new Error("Failed to load string: backup "+s))});if("restore"==z){b.call([{methodname:"core_backup_get_async_backup_links_restore",args:{backupid:w,contextid:x}}])[0].done(function(a){var b="async"+z+"completedetail",e="async"+z+"completebutton",f=[{key:b,component:"backup",param:a.restoreurl},{key:e,component:"backup"}];c.get_strings(f).then(function(b){k.html(b[0]);l.text(b[1]);l.attr("href",a.restoreurl)}).catch(function(){d.exception(new Error("Failed to load string"))})})}else{var t="async"+z+"completedetail",u="async"+z+"completebutton";m=[{key:t,component:"backup",param:y},{key:u,component:"backup"}];c.get_strings(m).then(function(a){k.html(a[0]);l.text(a[1]);l.attr("href",y)}).catch(function(){d.exception(new Error("Failed to load string"))})}a(".backup_progress").children("span").removeClass("backup_stage_current");a(".backup_progress").children("span").last().addClass("backup_stage_current");clearInterval(A)}}function l(a){a.forEach(function(a){var b=100*a.progress,c=a.backupid,d=a.operation,e=document.querySelectorAll("[data-"+d+"id="+CSS.escape(c)+"]")[0];if(a.status==800){e.classList.add("bg-success");f(c,d,b)}else if(a.status==q){e.classList.add("bg-danger");e.classList.add("complete");e.classList.remove("bg-success");f(c,d,100)}else if(a.status==r){e.classList.add("bg-success");e.classList.add("complete");f(c,d,100);if("backup"==d){h(c)}else{i(c)}}})}function m(a){a.forEach(function(a){var b=100*a.progress,e=a.backupid,g=a.operation,h=document.querySelectorAll("[data-"+g+"id="+CSS.escape(e)+"]")[0];if("restore"==g){var i=h.closest("tr").children[3];c.get_string("restore").then(function(a){i.innerHTML=a}).catch(function(){d.exception(new Error("Failed to load string: restore"))})}if(a.status==800){h.classList.add("bg-success");f(e,g,b)}else if(a.status==q){h.classList.add("bg-danger");h.classList.add("complete");h.classList.remove("bg-success");f(e,g,100)}else if(a.status==r&&"restore"==g){h.classList.add("bg-success");h.classList.add("complete");f(e,g,100);j(e)}})}function n(){b.call([{methodname:"core_backup_get_async_backup_progress",args:{backupids:[w],contextid:x}}],!0,!0,!1,D)[0].done(function(a){k(a[0]);u=t;A=g(A,n,t)}).fail(function(){u=u*v;A=g(A,n,u)})}function o(){var c=[],d=a(".progress").find(".progress-bar").not(".complete");d.each(function(){c.push(this.id.substring(0,32))});if(0<c.length){b.call([{methodname:"core_backup_get_async_backup_progress",args:{backupids:c,contextid:x}}],!0,!0,!1,D)[0].done(function(a){l(a);u=t;B=g(B,o,t)}).fail(function(){u=u*v;B=g(B,o,u)})}else{clearInterval(B)}}function p(){var c=[],d=a(".progress").find(".progress-bar[data-operation][data-backupid][data-restoreid]").not(".complete");d.each(function(){var a={backupid:this.dataset.backupid,restoreid:this.dataset.restoreid,operation:this.dataset.operation};c.push(a)});if(0<c.length){b.call([{methodname:"core_backup_get_copy_progress",args:{copies:c}}],!0,!0,!1,D)[0].done(function(a){m(a);u=t;C=g(C,p,t)}).fail(function(){u=u*v;C=g(C,p,u)})}else{clearInterval(C)}}s.asyncBackupAllStatus=function(a){x=a;B=setInterval(o,u)};s.asyncCopyAllStatus=function(){C=setInterval(p,u)};s.asyncBackupStatus=function(b,c,d,e){w=b;x=c;y=d;if("backup"==e){z="backup"}else{z="restore"}a(".backup_progress").children("a").removeAttr("href");A=setInterval(n,u)};return s});
define ("core_badges/backpackactions",["exports","jquery","core_badges/selectors","core/str","core/pending","core/modal_factory","core/modal_events","core/config"],function(a,b,c,d,e,f,g,h){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=i(b);c=i(c);e=i(e);f=i(f);g=i(g);h=i(h);function i(a){return a&&a.__esModule?a:{default:a}}function j(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function k(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){j(h,d,e,f,g,"next",a)}function g(a){j(h,d,e,f,g,"throw",a)}f(void 0)})}}var l=function(){var a=new e.default,d=(0,b.default)(c.default.elements.main);m(d);a.resolve()};a.init=l;var m=function(a){a.on("click",c.default.actions.deletebackpack,function(){var a=k(regeneratorRuntime.mark(function a(c){var d,e;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:c.preventDefault();d=(0,b.default)(c.currentTarget);a.next=4;return n(d);case 4:e=a.sent;o(e,d);case 6:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}())},n=function(){var a=k(regeneratorRuntime.mark(function a(b){var e;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:e=b.closest(c.default.elements.backpackurl).attr("data-backpackurl");a.t0=f.default;a.next=4;return(0,d.get_string)("delexternalbackpack","core_badges");case 4:a.t1=a.sent;a.next=7;return(0,d.get_string)("delexternalbackpackconfirm","core_badges",e);case 7:a.t2=a.sent;a.t3=f.default.types.SAVE_CANCEL;a.t4={title:a.t1,body:a.t2,type:a.t3};return a.abrupt("return",a.t0.create.call(a.t0,a.t4));case 11:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),o=function(){var a=k(regeneratorRuntime.mark(function a(b,c){return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:a.t0=b;a.next=3;return(0,d.get_string)("delete","core");case 3:a.t1=a.sent;a.t0.setSaveButtonText.call(a.t0,a.t1);b.getRoot().on(g.default.save,function(){window.location.href=c.attr("href")+"&sesskey="+h.default.sesskey+"&confirm=1"});b.getRoot().on(g.default.hidden,function(){b.destroy()});b.show();case 8:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}()});
define ("core_badges/selectors",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var b={actions:{deletebackpack:function getDataSelector(a,b){return"[data-".concat(a,"=\"").concat(b,"\"]")}("action","deletebackpack")},elements:{clearsearch:".input-group-append .clear-icon",main:"#backpacklist",backpackurl:"[data-backpackurl]"}};a.default=b;return a.default});
define ("core_calendar/calendar",["jquery","core/ajax","core/str","core/templates","core/notification","core/custom_interaction_events","core/modal_events","core/modal_factory","core_calendar/modal_event_form","core_calendar/summary_modal","core_calendar/repository","core_calendar/events","core_calendar/view_manager","core_calendar/crud","core_calendar/selectors"],function(a,b,c,d,f,g,h,i,j,k,l,m,n,o,p){var q={ROOT:"[data-region='calendar']",DAY:"[data-region='day']",NEW_EVENT_BUTTON:"[data-action='new-event-button']",DAY_CONTENT:"[data-region='day-content']",LOADING_ICON:".loading-icon",VIEW_DAY_LINK:"[data-action='view-day-link']",CALENDAR_MONTH_WRAPPER:".calendarwrapper",TODAY:".today"},r=function(b,c,e,g){var h=null,i=g.attr("data-day-timestamp");if(e){h=e.attr("data-day-timestamp")}if(!e||h!=i){d.render("core/loading",{}).then(function(a,b){g.find(q.DAY_CONTENT).addClass("hidden");d.appendNodeContents(g,a,b);if(e){e.find(q.DAY_CONTENT).addClass("hidden");d.appendNodeContents(e,a,b)}}).then(function(){return l.updateEventStartDay(c,i)}).then(function(){a("body").trigger(m.eventMoved,[c,e,g])}).always(function(){var a=g.find(q.LOADING_ICON);g.find(q.DAY_CONTENT).removeClass("hidden");d.replaceNode(a,"","");if(e){var b=e.find(q.LOADING_ICON);e.find(q.DAY_CONTENT).removeClass("hidden");d.replaceNode(b,"","")}}).fail(f.exception)}},s=function(b,c){var d=a("body");d.on(m.created,function(){n.reloadCurrentMonth(b)});d.on(m.deleted,function(){n.reloadCurrentMonth(b)});d.on(m.updated,function(){n.reloadCurrentMonth(b)});d.on(m.editActionEvent,function(a,b){window.location.assign(b)});d.on(m.moveEvent,r);d.on(m.eventMoved,function(){n.reloadCurrentMonth(b)});o.registerEditListeners(b,c)},t=function(b){b.on("click",q.VIEW_DAY_LINK,function(c){var d=a(c.target),e=d.data("year"),g=d.data("month"),h=d.data("day"),i=d.data("courseid"),j=d.data("categoryid");n.refreshDayContent(b,e,g,h,i,j,b,"core_calendar/calendar_day").then(function(){c.preventDefault();var a="?view=day&time="+d.data("timestamp");return window.history.pushState({},"",a)}).fail(f.exception)});b.on("change",p.elements.courseSelector,function(){var c=a(this),d=c.val();n.reloadCurrentMonth(b,d,null).then(function(){return b.find(p.elements.courseSelector).val(d)}).fail(f.exception)});var c=o.registerEventFormModal(b),d=a(q.CALENDAR_MONTH_WRAPPER).data("context-id");s(b,c);if(d){b.on("click",q.DAY,function(b){var d=a(b.target);if(!d.is(q.VIEW_DAY_LINK)){var e=a(this).attr("data-new-event-timestamp");c.then(function(a){var b=d.closest(p.wrapper);a.setCourseId(b.data("courseid"));var c=b.data("categoryid");if("undefined"!=typeof c){a.setCategoryId(c)}a.setContextId(b.data("contextId"));a.setStartTime(e);a.show()}).fail(f.exception);b.preventDefault()}})}};return{init:function init(b){b=a(b);n.init(b);t(b)}}});
define ("core_calendar/calendar_filter",["jquery","core_calendar/selectors","core_calendar/events","core/str","core/templates"],function(a,b,c,d,e){var f=function(d){d.on("click",b.eventFilterItem,function(b){var c=a(b.currentTarget);g(c);b.preventDefault()});a("body").on(c.viewUpdated,function(){var c=d.find(b.eventFilterItem);c.each(function(b,c){c=a(c);if(c.data("eventtype-hidden")){var d=i(c);h(d)}})})},g=function(a){var b=i(a);b.hidden=!b.hidden;M.util.js_pending("core_calendar/calendar_filter:toggleFilter");return d.get_string("eventtype"+b.eventtype,"calendar").then(function(a){b.name=a;b.icon=!0;b.key="i/"+b.eventtype+"event";b.component="core";return b}).then(function(a){return e.render("core_calendar/event_filter_key",a)}).then(function(b,c){return e.replaceNode(a,b,c)}).then(function(){h(b);M.util.js_complete("core_calendar/calendar_filter:toggleFilter")})},h=function(b){M.util.js_pending("month-mini-filterChanged");a("body").trigger(c.filterChanged,{type:b.eventtype,hidden:b.hidden});M.util.js_complete("month-mini-filterChanged")},i=function(a){return{eventtype:a.data("eventtype"),hidden:a.data("eventtype-hidden")}};return{init:function init(b){b=a(b);f(b)}}});
define ("core_calendar/calendar_mini",["jquery","core_calendar/selectors","core_calendar/events","core_calendar/view_manager"],function(a,b,c,d){var e=function(b){var d=a("body"),e="."+b.attr("id");d.on(c.created+e,b,f);d.on(c.deleted+e,b,f);d.on(c.updated+e,b,f);d.on(c.eventMoved+e,b,f)},f=function(b){var e=b.data,f=a("body"),g="."+e.attr("id");if(e.is(":visible")){d.reloadCurrentMonth(e)}else{f.off(c.created+g);f.off(c.deleted+g);f.off(c.updated+g);f.off(c.eventMoved+g)}},g=function(f){a("body").on(c.filterChanged,function(a,c){var d=f.find(b.eventType[c.type]);d.toggleClass("calendar_event_"+c.type,!c.hidden)});var g="."+f.attr("id");a("body").on("change"+g,b.elements.courseSelector,function(){if(f.is(":visible")){var b=a(this),c=b.val();d.reloadCurrentMonth(f,c,null)}else{a("body").off("change"+g)}})};return{init:function init(b,c){b=a(b);d.init(b);g(b);e(b);if(c){d.reloadCurrentMonth(b)}}}});
define ("core_calendar/calendar_threemonth",["jquery","core/notification","core_calendar/selectors","core_calendar/events","core/templates","core_calendar/view_manager"],function(a,b,c,d,e,f){var g=function(g){var h=a("body");h.on([d.monthChanged,d.dayChanged].join(" "),function(a,c,d,e,f){g.queue(function(g){return i(a,c,d,e,f).then(function(){return g()}).fail(b.exception)})});var i=function(b,d,e,h,i){var j=g.find("[data-year=\""+d+"\"][data-month=\""+e+"\"]"),k=j.closest(c.calendarPeriods.month),l=g.find(c.calendarPeriods.month),m=a(l[0]),n=a(l[2]),o=a("<span>");o.attr("data-template","core_calendar/threemonth_month");o.attr("data-includenavigation",!1);o.attr("data-mini",!0);var p=a("<div>");p.hide();p.append(o);var q,r,s;if(k.is(m)){p.insertBefore(m);q=m.data("previousYear");r=m.data("previousMonth");s=n}else if(k.is(n)){p.insertAfter(n);q=n.data("nextYear");r=n.data("nextMonth");s=m}else{return a.Deferred().resolve()}return f.refreshMonthContent(o,q,r,h,i,o).then(function(){var b=a.Deferred(),c=a.Deferred();s.slideUp("fast",function(){a(this).remove();b.resolve()});p.slideDown("fast",function(){c.resolve()});return a.when(b,c)})};g.on("click",c.links.miniDayLink,function(b){var d=a(b.target),e=d.data("year"),g=d.data("month"),h=d.text(),i=d.data("courseid"),j=d.data("categoryid"),k=a("body").find(c.calendarMain);f.refreshDayContent(k,e,g,h,i,j,k,"core_calendar/calendar_day");b.preventDefault();window.history.pushState({},"","?view=day")})};return{init:function init(b){b=a(b);g(b)}}});
define ("core_calendar/calendar_view",["jquery","core/str","core/notification","core_calendar/selectors","core_calendar/events","core_calendar/view_manager","core_calendar/repository","core/modal_factory","core_calendar/modal_event_form","core/modal_events","core_calendar/crud"],function(a,b,c,d,e,f,g,h,i,j,k){var l=function(b,g){var h=a("body");k.registerRemove(b);var i="reloadCurrent"+g.charAt(0).toUpperCase()+g.slice(1);h.on(e.created,function(){f[i](b)});h.on(e.deleted,function(){f[i](b)});h.on(e.updated,function(){f[i](b)});b.on("change",d.courseSelector,function(){var e=a(this),g=e.val();f[i](b,g,null).then(function(){return b.find(d.courseSelector).val(g)}).then(function(){window.history.pushState({},"","?view=upcoming&course="+g)}).fail(c.exception)});h.on(e.filterChanged,function(a,c){var e=b.find(d.eventType[c.type]);if(!0==c.hidden){e.addClass("hidden")}else{e.removeClass("hidden")}});var j=k.registerEventFormModal(b);k.registerEditListeners(b,j)};return{init:function init(b,c){b=a(b);f.init(b,c);l(b,c)}}});
define ("core_calendar/crud",["jquery","core/str","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","core/modal_factory","core/modal_events","core_calendar/modal_event_form","core_calendar/repository","core_calendar/events","core_calendar/modal_delete","core_calendar/selectors","core/pending"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(d,e,f){var i=new n("core_calendar/crud:confirmDeletion"),m=[{key:"deleteevent",component:"calendar"}];f=parseInt(f,10);var o,p=1<f;if(p){m.push({key:"confirmeventseriesdelete",component:"calendar",param:{name:e,count:f}});o=g.create({type:l.TYPE})}else{m.push({key:"confirmeventdelete",component:"calendar",param:e});o=g.create({type:g.types.SAVE_CANCEL})}var q=b.get_strings(m),r=a.when(q,o).then(function(b,e){e.setRemoveOnClose(!0);e.setTitle(b[0]);e.setBody(b[1]);if(!p){e.setSaveButtonText(b[0])}e.show();e.getRoot().on(h.save,function(){var b=new n("calendar/crud:initModal:deletedevent");j.deleteEvent(d,!1).then(function(){a("body").trigger(k.deleted,[d,!1])}).then(b.resolve).catch(c.exception)});e.getRoot().on(k.deleteAll,function(){var b=new n("calendar/crud:initModal:deletedallevent");j.deleteEvent(d,!0).then(function(){a("body").trigger(k.deleted,[d,!0])}).then(b.resolve).catch(c.exception)});return e}).then(function(a){i.resolve();return a}).catch(c.exception);return r}return{registerRemove:function(b){b.on("click",m.actions.remove,function(b){var c=a(this).closest(m.eventItem),d=c.data("eventId"),e=c.data("eventTitle"),f=c.data("eventCount");o(d,e,f);b.preventDefault()})},registerEditListeners:function(b,d){var e=new n("core_calendar/crud:registerEditListeners");return d.then(function(c){a("body").on(k.editEvent,function(a,d){var e=b.find(m.wrapper);c.setEventId(d);c.setContextId(e.data("contextId"));c.show();a.stopImmediatePropagation()});return c}).then(function(a){e.resolve();return a}).catch(c.exception)},registerEventFormModal:function registerEventFormModal(b){var d=g.create({type:i.TYPE,large:!0});b.on("click",m.actions.create,function(a){d.then(function(a){var c=b.find(m.wrapper),d=c.data("categoryid");if("undefined"!=typeof d){a.setCategoryId(d)}var e=b.find(m.today),f=b.find(m.day);if(!e.length&&f.length){a.setStartTime(f.data("newEventTimestamp"))}a.setContextId(c.data("contextId"));a.setCourseId(c.data("courseid"));a.show()}).fail(c.exception);a.preventDefault()});b.on("click",m.actions.edit,function(b){b.preventDefault();var e=a(b.currentTarget),f=e.closest(m.wrapper),g=e.closest(m.eventItem);d.then(function(a){a.setEventId(g.data("eventId"));a.setContextId(f.data("contextId"));a.show();b.stopImmediatePropagation()}).fail(c.exception)});return d}}});
define ("core_calendar/drag_drop_data_store",[],function(){var a=null,b=null,c=null,d=null,e=null,f=null,g=function(b){a=b},h=function(){return a},i=function(){return null!==a},j=function(a){b=a},k=function(){return b},l=function(a){c=a},m=function(){return c},n=function(){return null!==c},o=function(a){d=a},p=function(){return d},q=function(){return null!==d},r=function(a){e=a},s=function(){return e},t=function(a){f=a},u=function(){return f};return{setEventId:g,getEventId:h,hasEventId:i,setDurationDays:j,getDurationDays:k,setMinTimestart:l,getMinTimestart:m,hasMinTimestart:n,setMaxTimestart:o,getMaxTimestart:p,hasMaxTimestart:q,setMinError:r,getMinError:s,setMaxError:t,getMaxError:u,clearAll:function clearAll(){g(null);j(null);l(null);o(null);r(null);t(null)}}});
define ("core_calendar/event_form",["jquery","core_calendar/repository"],function(a,b){var c={EVENT_GROUP_COURSE_ID:"[name=\"groupcourseid\"]",EVENT_GROUP_ID:"[name=\"groupid\"]",SELECT_OPTION:"option"},d=function(d){var e=d.find(c.EVENT_GROUP_COURSE_ID),f=function(b){var e=d.find(c.EVENT_GROUP_ID),f=e.find(c.SELECT_OPTION),g=a(b);f.remove();e.prop("disabled",!1);g.each(function(b,c){a(e).append(a("<option></option>").attr("value",c.id).text(c.name))})};e.on("change",function(){var a=d.find(c.EVENT_GROUP_COURSE_ID).val();b.getCourseGroupsData(a).then(function(a){return f(a)}).catch(Notification.exception)})};return{init:function init(b){var c=a("#"+b);d(c)}}});
define ("core_calendar/events",[],function(){return{created:"calendar-events:created",deleted:"calendar-events:deleted",deleteAll:"calendar-events:delete_all",updated:"calendar-events:updated",editEvent:"calendar-events:edit_event",editActionEvent:"calendar-events:edit_action_event",eventMoved:"calendar-events:event_moved",dayChanged:"calendar-events:day_changed",monthChanged:"calendar-events:month_changed",moveEvent:"calendar-events:move_event",filterChanged:"calendar-events:filter_changed",viewUpdated:"calendar-events:view_updated"}});
define ("core_calendar/modal_delete",["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_events","core/modal_registry","core_calendar/events"],function(a,b,c,d,f,g,h){var i=!1,j={DELETE_ONE_BUTTON:"[data-action=\"deleteone\"]",DELETE_ALL_BUTTON:"[data-action=\"deleteall\"]",CANCEL_BUTTON:"[data-action=\"cancel\"]"},k=function(a){d.call(this,a);this.setRemoveOnClose(!0)};k.TYPE="core_calendar-modal_delete";k.prototype=Object.create(d.prototype);k.prototype.constructor=k;k.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this);this.getModal().on(c.events.activate,j.DELETE_ONE_BUTTON,function(b,c){var d=a.Event(f.save);this.getRoot().trigger(d,this);if(!d.isDefaultPrevented()){this.hide();c.originalEvent.preventDefault()}}.bind(this));this.getModal().on(c.events.activate,j.DELETE_ALL_BUTTON,function(b,c){var d=a.Event(h.deleteAll);this.getRoot().trigger(d,this);if(!d.isDefaultPrevented()){this.hide();c.originalEvent.preventDefault()}}.bind(this));this.getModal().on(c.events.activate,j.CANCEL_BUTTON,function(b,c){var d=a.Event(f.cancel);this.getRoot().trigger(d,this);if(!d.isDefaultPrevented()){this.hide();c.originalEvent.preventDefault()}}.bind(this))};if(!i){g.register(k.TYPE,k,"calendar/event_delete_modal");i=!0}return k});
define ("core_calendar/modal_event_form",["jquery","core/event","core/str","core/notification","core/templates","core/custom_interaction_events","core/modal","core/modal_registry","core/fragment","core_calendar/events","core_calendar/repository"],function(a,b,c,d,e,f,g,h,i,j,k){var l=!1,m={SAVE_BUTTON:"[data-action=\"save\"]",LOADING_ICON_CONTAINER:"[data-region=\"loading-icon-container\"]"},n=function(a){g.call(this,a);this.eventId=null;this.startTime=null;this.courseId=null;this.categoryId=null;this.contextId=null;this.reloadingBody=!1;this.reloadingTitle=!1;this.saveButton=this.getFooter().find(m.SAVE_BUTTON)};n.TYPE="core_calendar-modal_event_form";n.prototype=Object.create(g.prototype);n.prototype.constructor=n;n.prototype.setContextId=function(a){this.contextId=a};n.prototype.getContextId=function(){return this.contextId};n.prototype.setCourseId=function(a){this.courseId=a};n.prototype.getCourseId=function(){return this.courseId};n.prototype.setCategoryId=function(a){this.categoryId=a};n.prototype.getCategoryId=function(){return this.categoryId};n.prototype.hasCourseId=function(){return null!==this.courseId};n.prototype.hasCategoryId=function(){return null!==this.categoryId};n.prototype.setEventId=function(a){this.eventId=a};n.prototype.getEventId=function(){return this.eventId};n.prototype.hasEventId=function(){return null!==this.eventId};n.prototype.setStartTime=function(a){this.startTime=a};n.prototype.getStartTime=function(){return this.startTime};n.prototype.hasStartTime=function(){return null!==this.startTime};n.prototype.getForm=function(){return this.getBody().find("form")};n.prototype.disableButtons=function(){this.saveButton.prop("disabled",!0)};n.prototype.enableButtons=function(){this.saveButton.prop("disabled",!1)};n.prototype.reloadTitleContent=function(){if(this.reloadingTitle){return this.titlePromise}this.reloadingTitle=!0;if(this.hasEventId()){this.titlePromise=c.get_string("editevent","calendar")}else{this.titlePromise=c.get_string("newevent","calendar")}this.titlePromise.then(function(a){this.setTitle(a);return a}.bind(this)).always(function(){this.reloadingTitle=!1}.bind(this)).fail(d.exception);return this.titlePromise};n.prototype.reloadBodyContent=function(a){if(this.reloadingBody){return this.bodyPromise}this.reloadingBody=!0;this.disableButtons();var b={};if(this.hasEventId()){b.eventid=this.getEventId()}if(this.hasStartTime()){b.starttime=this.getStartTime()}if(this.hasCourseId()){b.courseid=this.getCourseId()}if(this.hasCategoryId()){b.categoryid=this.getCategoryId()}if("undefined"!=typeof a){b.formdata=a}this.bodyPromise=i.loadFragment("calendar","event_form",this.getContextId(),b);this.setBody(this.bodyPromise);this.bodyPromise.then(function(){this.enableButtons()}.bind(this)).fail(d.exception).always(function(){this.reloadingBody=!1}.bind(this)).fail(d.exception);return this.bodyPromise};n.prototype.reloadAllContent=function(){return a.when(this.reloadTitleContent(),this.reloadBodyContent())};n.prototype.show=function(){this.reloadAllContent();g.prototype.show.call(this)};n.prototype.hide=function(){g.prototype.hide.call(this);this.setEventId(null);this.setStartTime(null);this.setCourseId(null);this.setCategoryId(null)};n.prototype.getFormData=function(){return this.getForm().serialize()};n.prototype.save=function(){var b,c=this.saveButton.find(m.LOADING_ICON_CONTAINER);b=this.getForm().find("[aria-invalid=\"true\"]");if(b.length){b.first().focus();return}c.removeClass("hidden");this.disableButtons();var e=this.getFormData();return k.submitCreateUpdateForm(e).then(function(b){if(b.validationerror){this.reloadBodyContent(e)}else{var c=this.hasEventId();this.hide();if(c){a("body").trigger(j.updated,[b.event])}else{a("body").trigger(j.created,[b.event])}}}.bind(this)).always(function(){c.addClass("hidden");this.enableButtons()}.bind(this)).fail(d.exception)};n.prototype.registerEventListeners=function(){g.prototype.registerEventListeners.call(this);this.getModal().on(f.events.activate,m.SAVE_BUTTON,function(a,b){this.getForm().submit();b.originalEvent.preventDefault();a.stopPropagation()}.bind(this));this.getModal().on("submit",function(a){b.notifyFormSubmitAjax(this.getForm()[0]);this.save();a.preventDefault();a.stopPropagation()}.bind(this))};if(!l){h.register(n.TYPE,n,"calendar/modal_event_form");l=!0}return n});
define ("core_calendar/month_navigation_drag_drop",["jquery","core_calendar/drag_drop_data_store"],function(a,b){var c={DRAGGABLE:"[draggable=\"true\"][data-region=\"event-item\"]",DROP_ZONE:"[data-drop-zone=\"nav-link\"]"},d="bg-primary text-white",e="drop-target",f=!1,g=null,h=null,i=function(a,b){if(b){a.addClass(d)}else{a.removeClass(d)}},j=function(){h.find(c.DROP_ZONE).addClass(e)},k=function(){h.find(c.DROP_ZONE).removeClass(e)},l=function(b){var d=a(b.target).closest(c.DROP_ZONE);return d.length?d:null},m=function(b){var d=a(b.target).closest(c.DRAGGABLE);if(d.length){j()}},n=function(a){if(!b.hasEventId()){return}a.preventDefault();var c=l(a);if(!c){return}if(!b.hasEventId()){return}if(!g){g=setTimeout(function(){c.click();g=null},1e3)}i(c,!0);k()},o=function(a){if(!b.hasEventId()){return}var c=l(a);if(!c){return}if(g){clearTimeout(g);g=null}i(c,!1);j();a.preventDefault()},p=function(a){if(!b.hasEventId()){return}k();var c=l(a);if(!c){return}i(c,!1);a.preventDefault()};return{init:function init(c){if(!f){document.addEventListener("dragstart",m,!1);document.addEventListener("dragover",n,!1);document.addEventListener("dragleave",o,!1);document.addEventListener("drop",p,!1);document.addEventListener("dragend",k,!1);f=!0}h=a(c);if(b.hasEventId()){j()}}}});
define ("core_calendar/month_view_drag_drop",["jquery","core/notification","core/str","core_calendar/events","core_calendar/drag_drop_data_store"],function(a,b,c,d,f){var g={ROOT:"[data-region='calendar']",DRAGGABLE:"[draggable=\"true\"][data-region=\"event-item\"]",DROP_ZONE:"[data-drop-zone=\"month-view-day\"]",WEEK:"[data-region=\"month-view-week\"]"},h="bg-faded",i="bg-danger text-white",j="bg-primary text-white",k=h+" "+i+" "+j,l=!1,m=function(b){var c=a(b.target).closest(g.DROP_ZONE);return c.length?c:null},n=function(a){var b=a.attr("data-day-timestamp"),c=f.getMinTimestart(),d=f.getMaxTimestart();if(c&&c>b){return!1}if(d&&d<b){return!1}return!0},o=function(a){var b=a.attr("data-day-timestamp"),c=f.getMinTimestart(),d=f.getMaxTimestart();if(c&&c>b){return f.getMinError()}if(d&&d<b){return f.getMaxError()}return null},p=function(){a(g.ROOT).find(g.DROP_ZONE).each(function(b,c){c=a(c);c.removeClass(k)})},q=function(a,b,c){if("undefined"==typeof c){c=f.getDurationDays()}var d=n(a);a.removeClass(k);if(b){if(d){a.addClass(j)}else{a.addClass(i)}}else{a.removeClass(j+" "+i);if(!d){a.addClass(h)}}c--;if(0<c){var e=a.next();if(!e.length){var l=a.closest(g.WEEK).next();if(l.length){e=l.children(g.DROP_ZONE).first()}}if(e.length){q(e,b,c)}}},r=function(){a(g.ROOT).find(g.DROP_ZONE).each(function(b,c){c=a(c);if(!n(c)){q(c,!1)}})},s=function(b){var c=a(b.target),d=c.closest(g.DRAGGABLE);if(!d.length){return}var e=d.find("[data-event-id]"),h=e.attr("data-event-id"),i=d.attr("data-min-day-timestamp"),j=d.attr("data-max-day-timestamp"),k=d.attr("data-min-day-error"),l=d.attr("data-max-day-error"),m=g.ROOT+" [data-event-id=\""+h+"\"]",n=a(m).length;f.setEventId(h);f.setDurationDays(n);if(i){f.setMinTimestart(i)}if(j){f.setMaxTimestart(j)}if(k){f.setMinError(k)}if(l){f.setMaxError(l)}b.dataTransfer.effectAllowed="move";b.dataTransfer.dropEffect="move";b.dataTransfer.setData("text/plain",h);b.dropEffect="move";r()},t=function(a){if(!f.hasEventId()){return}a.preventDefault();var b=m(a);if(!b){return}q(b,!0)},u=function(a){if(!f.hasEventId()){return}var b=m(a);if(!b){return}q(b,!1);a.preventDefault()},v=function(h){if(!f.hasEventId()){return}var e=m(h);if(!e){f.clearAll();p();return}if(n(e)){var i=f.getEventId(),j=g.ROOT+" [data-event-id=\""+i+"\"]",k=a(j),l=null;if(k.length){l=k.closest(g.DROP_ZONE)}a("body").trigger(d.moveEvent,[i,l,e])}else{var q=o(e);c.get_string("errorinvaliddate","calendar").then(function(a){b.exception({name:a,message:q||a})})}f.clearAll();p();h.preventDefault()},w=function(){f.clearAll();p()},x=function(){r()};return{init:function init(){if(!l){document.addEventListener("dragstart",s,!1);document.addEventListener("dragover",t,!1);document.addEventListener("dragleave",u,!1);document.addEventListener("drop",v,!1);document.addEventListener("dragend",w,!1);a("body").on(d.monthChanged,x);l=!0}}}});
define ("core_calendar/repository",["exports","core/ajax"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.getCourseGroupsData=a.getCalendarUpcomingData=a.updateEventStartDay=a.getCalendarDayData=a.getCalendarMonthData=a.submitCreateUpdateForm=a.getEventById=a.deleteEvent=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);var c=function(a){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1;return b.default.call([{methodname:"core_calendar_delete_calendar_events",args:{events:[{eventid:a,repeat:c}]}}])[0]};a.deleteEvent=c;var d=function(a){return b.default.call([{methodname:"core_calendar_get_calendar_event_by_id",args:{eventid:a}}])[0]};a.getEventById=d;var e=function(a){return b.default.call([{methodname:"core_calendar_submit_create_update_form",args:{formdata:a}}])[0]};a.submitCreateUpdateForm=e;var f=function(a,c,d,e,f,g){var h=6<arguments.length&&arguments[6]!==void 0?arguments[6]:1;return b.default.call([{methodname:"core_calendar_get_calendar_monthly_view",args:{year:a,month:c,courseid:d,categoryid:e,includenavigation:f,mini:g,day:h}}])[0]};a.getCalendarMonthData=f;var g=function(a,c,d,e,f){return b.default.call([{methodname:"core_calendar_get_calendar_day_view",args:{year:a,month:c,day:d,courseid:e,categoryid:f}}])[0]};a.getCalendarDayData=g;var h=function(a,c){return b.default.call([{methodname:"core_calendar_update_event_start_day",args:{eventid:a,daytimestamp:c}}])[0]};a.updateEventStartDay=h;var i=function(a,c){return b.default.call([{methodname:"core_calendar_get_calendar_upcoming_view",args:{courseid:a,categoryid:c}}])[0]};a.getCalendarUpcomingData=i;var j=function(a){return b.default.call([{methodname:"core_group_get_course_groups",args:{courseid:a}}])[0]};a.getCourseGroupsData=j});
define ("core_calendar/selectors",[],function(){return{eventFilterItem:"[data-action='filter-event-type']",eventType:{site:"[data-eventtype-site]",category:"[data-eventtype-category]",course:"[data-eventtype-course]",group:"[data-eventtype-group]",user:"[data-eventtype-user]",other:"[data-eventtype-other]"},popoverType:{site:"[data-popover-eventtype-site]",category:"[data-popover-eventtype-category]",course:"[data-popover-eventtype-course]",group:"[data-popover-eventtype-group]",user:"[data-popover-eventtype-user]",other:"[data-popover-eventtype-other]"},calendarPeriods:{month:"[data-period='month']"},courseSelector:"select[name=\"course\"]",viewSelector:"div[data-region=\"view-selector\"]",actions:{create:"[data-action=\"new-event-button\"]",edit:"[data-action=\"edit\"]",remove:"[data-action=\"delete\"]",viewEvent:"[data-action=\"view-event\"]"},elements:{courseSelector:"select[name=\"course\"]"},today:".today",day:"[data-region=\"day\"]",calendarMain:"[data-region=\"calendar\"]",wrapper:".calendarwrapper",eventItem:"[data-type=\"event\"]",links:{navLink:".calendarwrapper .arrow_link",eventLink:"[data-region='event-item']",miniDayLink:"[data-region='mini-day-link']"},containers:{loadingIcon:"[data-region=\"overlay-icon-container\"]"}}});
define ("core_calendar/summary_modal",["jquery","core/str","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","core/modal_factory","core/modal_events","core_calendar/repository","core_calendar/events","core_calendar/crud"],function(a,b,c,d,e,f,g,h,i,j,k){var l=!1,m={ROOT:"[data-region='summary-modal-container']",EDIT_BUTTON:"[data-action=\"edit\"]",DELETE_BUTTON:"[data-action=\"delete\"]"},n=function(a){e.call(this,a)};n.TYPE="core_calendar-event_summary";n.prototype=Object.create(e.prototype);n.prototype.constructor=n;n.prototype.getEditButton=function(){if("undefined"==typeof this.editButton){this.editButton=this.getFooter().find(m.EDIT_BUTTON)}return this.editButton};n.prototype.getDeleteButton=function(){if("undefined"==typeof this.deleteButton){this.deleteButton=this.getFooter().find(m.DELETE_BUTTON)}return this.deleteButton};n.prototype.getEventId=function(){return this.getBody().find(m.ROOT).attr("data-event-id")};n.prototype.getEventTitle=function(){return this.getBody().find(m.ROOT).attr("data-event-title")};n.prototype.getEventCount=function(){return this.getBody().find(m.ROOT).attr("data-event-count")};n.prototype.getEditUrl=function(){return this.getBody().find(m.ROOT).attr("data-edit-url")};n.prototype.isActionEvent=function(){return"true"==this.getBody().find(m.ROOT).attr("data-action-event")};n.prototype.registerEventListeners=function(){e.prototype.registerEventListeners.call(this);M.util.js_pending("core_calendar/summary_modal:registerEventListeners:bodyRendered");this.getRoot().on(h.bodyRendered,function(){this.getModal().data({eventTitle:this.getEventTitle(),eventId:this.getEventId(),eventCount:this.getEventCount()}).attr("data-type","event");k.registerRemove(this.getModal());M.util.js_complete("core_calendar/summary_modal:registerEventListeners:bodyRendered")}.bind(this));a("body").on(j.deleted,function(){this.hide()}.bind(this));d.define(this.getEditButton(),[d.events.activate]);this.getEditButton().on(d.events.activate,function(b,c){if(this.isActionEvent()){a("body").trigger(j.editActionEvent,[this.getEditUrl()])}else{a("body").trigger(j.editEvent,[this.getEventId()])}this.hide();b.preventDefault();b.stopPropagation();c.originalEvent.preventDefault();c.originalEvent.stopPropagation()}.bind(this))};if(!l){f.register(n.TYPE,n,"core_calendar/event_summary_modal");l=!0}return n});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_calendar/view_manager",["exports","jquery","core/templates","core/notification","core_calendar/repository","core_calendar/events","core_calendar/selectors","core/modal_factory","core/modal_events","core_calendar/summary_modal","core/custom_interaction_events","core/pending"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=a.reloadCurrentUpcoming=a.changeDay=a.reloadCurrentDay=a.refreshDayContent=a.reloadCurrentMonth=a.changeMonth=a.refreshMonthContent=void 0;b=o(b);c=o(c);d=o(d);e=n(e);f=o(f);g=n(g);h=o(h);i=o(i);j=o(j);k=o(k);l=o(l);function m(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;m=function(){return a};return a}function n(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=m();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function o(a){return a&&a.__esModule?a:{default:a}}var p=function(a){a=(0,b.default)(a);a.on("click",g.links.eventLink,function(a){var b=a.target,c=null,d=null,e=new l.default("core_calendar/view_manager:eventLink:click");if(b.matches(g.actions.viewEvent)){c=b}else{c=b.closest(g.actions.viewEvent)}if(c){d=c.dataset.eventId}else{d=b.querySelector(g.actions.viewEvent).dataset.eventId}if(d){a.preventDefault();a.stopPropagation();A(d).then(e.resolve).catch()}else{e.resolve()}});a.on("click",g.links.navLink,function(b){var c=a.find(g.wrapper),d=c.data("view"),e=c.data("courseid"),f=c.data("categoryid"),h=b.currentTarget;if("month"===d){r(a,h.href,h.dataset.year,h.dataset.month,e,f,h.dataset.day);b.preventDefault()}else if("day"===d){v(a,h.href,h.dataset.year,h.dataset.month,h.dataset.day,e,f);b.preventDefault()}});var c=a.find(g.viewSelector);k.default.define(c,[k.default.events.activate]);c.on(k.default.events.activate,function(b){b.preventDefault();var c=b.target;if(c.classList.contains("active")){return}var e=c.dataset.view,f=c.dataset.year,g=c.dataset.month,h=c.dataset.day,i=c.dataset.courseid,j=c.dataset.categoryid;if("month"==e){q(a,f,g,i,j,a,"core_calendar/calendar_month",h).then(function(){return window.history.pushState({},"","?view=month")}).fail(d.default.exception)}else if("day"==e){t(a,f,g,h,i,j,a,"core_calendar/calendar_day").then(function(){return window.history.pushState({},"","?view=day")}).fail(d.default.exception)}else if("upcoming"==e){y(a,i,j,a,"core_calendar/calendar_upcoming").then(function(){return window.history.pushState({},"","?view=upcoming")}).fail(d.default.exception)}})},q=function(a,b,h,i,j){var k=5<arguments.length&&arguments[5]!==void 0?arguments[5]:null,l=6<arguments.length&&arguments[6]!==void 0?arguments[6]:"",m=7<arguments.length&&arguments[7]!==void 0?arguments[7]:1;w(a);k=k||a.find(g.wrapper);l=l||a.attr("data-template");M.util.js_pending([a.get("id"),b,h,i].join("-"));var n=a.data("includenavigation"),o=a.data("mini");return e.getCalendarMonthData(b,h,i,j,n,o,m).then(function(a){a.viewingmonth=!0;return c.default.render(l,a)}).then(function(a,b){return c.default.replaceNode(k,a,b)}).then(function(){document.querySelector("body").dispatchEvent(new CustomEvent(f.default.viewUpdated))}).always(function(){M.util.js_complete([a.get("id"),b,h,i].join("-"));return x(a)}).fail(d.default.exception)};a.refreshMonthContent=q;var r=function(a,c,d,e,g,h){var i=6<arguments.length&&arguments[6]!==void 0?arguments[6]:1;return q(a,d,e,g,h,null,"",i).then(function(){if(c.length&&"#"!==c){window.history.pushState({},"",c)}for(var a=arguments.length,b=Array(a),d=0;d<a;d++){b[d]=arguments[d]}return b}).then(function(){(0,b.default)("body").trigger(f.default.monthChanged,[d,e,g,h]);for(var a=arguments.length,c=Array(a),i=0;i<a;i++){c[i]=arguments[i]}return c})};a.changeMonth=r;var s=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,d=a.find(g.wrapper).data("year"),e=a.find(g.wrapper).data("month"),f=a.find(g.wrapper).data("day");b=b||a.find(g.wrapper).data("courseid");c=c||a.find(g.wrapper).data("categoryid");return q(a,d,e,b,c,null,"",f)};a.reloadCurrentMonth=s;var t=function(a,b,h,i,j,k){var l=6<arguments.length&&arguments[6]!==void 0?arguments[6]:null,m=7<arguments.length&&arguments[7]!==void 0?arguments[7]:"";w(a);l=l||a.find(g.wrapper);m=m||a.attr("data-template");M.util.js_pending([a.get("id"),b,h,i,j,k].join("-"));var n=a.data("includenavigation");return e.getCalendarDayData(b,h,i,j,k,n).then(function(a){a.viewingday=!0;return c.default.render(m,a)}).then(function(a,b){return c.default.replaceNode(l,a,b)}).then(function(){document.querySelector("body").dispatchEvent(new CustomEvent(f.default.viewUpdated))}).always(function(){M.util.js_complete([a.get("id"),b,h,i,j,k].join("-"));return x(a)}).fail(d.default.exception)};a.refreshDayContent=t;var u=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,d=a.find(g.wrapper),e=d.data("year"),f=d.data("month"),h=d.data("day");b=b||a.find(g.wrapper).data("courseid");c=c||a.find(g.wrapper).data("categoryid");return t(a,e,f,h,b,c)};a.reloadCurrentDay=u;var v=function(a,c,d,e,g,h,i){return t(a,d,e,g,h,i).then(function(){if(c.length&&"#"!==c){window.history.pushState({},"",c)}for(var a=arguments.length,b=Array(a),d=0;d<a;d++){b[d]=arguments[d]}return b}).then(function(){(0,b.default)("body").trigger(f.default.dayChanged,[d,e,h,i]);for(var a=arguments.length,c=Array(a),g=0;g<a;g++){c[g]=arguments[g]}return c})};a.changeDay=v;var w=function(a){var b=a.find(g.containers.loadingIcon);b.removeClass("hidden")},x=function(a){var b=a.find(g.containers.loadingIcon);b.addClass("hidden")},y=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null,j=4<arguments.length&&arguments[4]!==void 0?arguments[4]:"";w(a);i=i||a.find(g.wrapper);j=j||a.attr("data-template");b=b||a.find(g.wrapper).data("courseid");h=h||a.find(g.wrapper).data("categoryid");return e.getCalendarUpcomingData(b,h).then(function(a){a.viewingupcoming=!0;return c.default.render(j,a)}).then(function(a,b){return c.default.replaceNode(i,a,b)}).then(function(){document.querySelector("body").dispatchEvent(new CustomEvent(f.default.viewUpdated))}).always(function(){return x(a)}).fail(d.default.exception)};a.reloadCurrentUpcoming=y;var z=function(a){return"calendar_event_"+a},A=function(a){var b=new l.default("core_calendar/view_manager:renderEventSummaryModal");return e.getEventById(a).then(function(b){if(!b.event){throw new Error("Error encountered while trying to fetch calendar event with ID: "+a)}return b.event}).then(function(a){var b={title:a.name,type:j.default.TYPE,body:c.default.render("core_calendar/event_summary_body",a),templateContext:{canedit:a.canedit,candelete:a.candelete,headerclasses:z(a.normalisedeventtype),isactionevent:a.isactionevent,url:a.url,action:a.action}};return h.default.create(b)}).then(function(a){a.getRoot().on(i.default.hidden,function(){a.destroy()});a.show();return a}).then(function(a){b.resolve();return a}).catch(d.default.exception)};a.init=function init(a,b){p(a,b)}});
define ("core_contentbank/actions",["jquery","core/ajax","core/notification","core/str","core/templates","core/url","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f,g,h){var k={DELETE_CONTENT:"[data-action=\"deletecontent\"]",RENAME_CONTENT:"[data-action=\"renamecontent\"]"},l=function(){this.registerEvents()};l.prototype.registerEvents=function(){a(k.DELETE_CONTENT).click(function(b){b.preventDefault();var e=a(this).data("contentname"),f=a(this).data("contentid"),j=a(this).data("contextid"),k="";d.get_strings([{key:"deletecontent",component:"core_contentbank"},{key:"deletecontentconfirm",component:"core_contentbank",param:{name:e}},{key:"delete",component:"core"}]).then(function(a){var b=a[0],c=a[1];k=a[2];return g.create({title:b,body:c,type:g.types.SAVE_CANCEL,large:!0})}).done(function(a){a.setSaveButtonText(k);a.getRoot().on(h.save,function(){return i(f,j)});a.getRoot().on(h.hidden,function(){a.destroy()});a.show()}).catch(c.exception)});a(k.RENAME_CONTENT).click(function(b){b.preventDefault();var f=a(this).data("contentname"),i=a(this).data("contentid"),k="";d.get_strings([{key:"renamecontent",component:"core_contentbank"},{key:"rename",component:"core_contentbank"}]).then(function(a){var b=a[0];k=a[1];return g.create({title:b,body:e.render("core_contentbank/renamecontent",{contentid:i,name:f}),type:g.types.SAVE_CANCEL})}).then(function(b){b.setSaveButtonText(k);b.getRoot().on(h.save,function(b){var e=a("#newname").val().trim();if(e){j(i,e)}else{d.get_strings([{key:"error"},{key:"emptynamenotallowed",component:"core_contentbank"}]).then(function(a){c.alert(a[0],a[1])}).catch(c.exception);b.preventDefault()}});b.getRoot().on(h.hidden,function(){b.destroy()});b.show()}).catch(c.exception)})};function i(a,d){var e="success";b.call([{methodname:"core_contentbank_delete_content",args:{contentids:{contentid:a}}}])[0].then(function(a){if(a.result){return"contentdeleted"}e="error";return"contentnotdeleted"}).done(function(a){var b={contextid:d};if("success"==e){b.statusmsg=a}else{b.errormsg=a}window.location.href=f.relativeUrl("contentbank/index.php",b,!1)}).fail(c.exception)}function j(a,d){var e="success";b.call([{methodname:"core_contentbank_rename_content",args:{contentid:a,name:d}}])[0].then(function(a){if(a.result){return"contentrenamed"}e="error";return a.warnings[0].message}).then(function(b){var d=null;if("success"==e){d={id:a,statusmsg:b};window.location.href=f.relativeUrl("contentbank/view.php",d,!1)}else{c.addNotification({message:b,type:"error"});c.fetchNotifications()}}).catch(c.exception)}return{init:function init(){return new l}}});
define ("core_contentbank/search",["exports","jquery","core_contentbank/selectors","core/str","core/pending","core/utils"],function(a,b,c,d,e,f){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=g(b);c=g(c);e=g(e);function g(a){return a&&a.__esModule?a:{default:a}}function h(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function i(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var i=a.apply(b,c);function f(a){h(i,d,e,f,g,"next",a)}function g(a){h(i,d,e,f,g,"throw",a)}f(void 0)})}}var j=function(){var a=new e.default,d=(0,b.default)(c.default.regions.contentbank);k(d);a.resolve()};a.init=j;var k=function(a){var b=a.find(c.default.elements.searchinput)[0];a.on("click",c.default.actions.search,function(c){c.preventDefault();l(a,b.value)});a.on("click",c.default.actions.clearSearch,function(c){c.preventDefault();b.value="";b.focus();l(a,b.value)});b.addEventListener("input",(0,f.debounce)(function(){l(a,b.value)},300))},l=function(){var a=i(regeneratorRuntime.mark(function a(b,e){var f,g,h,i,j;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:f=b.find(c.default.elements.clearsearch)[0];g=b.find(c.default.elements.searchicon)[0];h=b.find(c.default.elements.cbnavbarbreadcrumb)[0];i=b.find(c.default.elements.cbnavbartotalsearch)[0];j=m(b,e);if(!(0<e.length)){a.next=15;break}g.classList.add("d-none");f.classList.remove("d-none");h.classList.add("d-none");a.next=11;return(0,d.get_string)("itemsfound","core_contentbank",j.length);case 11:i.innerHTML=a.sent;i.classList.remove("d-none");a.next=19;break;case 15:f.classList.add("d-none");g.classList.remove("d-none");h.classList.remove("d-none");i.classList.add("d-none");case 19:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),m=function(a,b){var d=Array.from(a.find(c.default.elements.listitem)),e=[];d.forEach(function(a){var d=a.getAttribute("data-name");if(""===b||d.toLowerCase().includes(b.toLowerCase())){e.push(a);var f=a.querySelector(c.default.regions.cbcontentname);f.innerHTML=n(d,b);a.classList.remove("d-none")}else{a.classList.add("d-none")}});return e},n=function(a,b){var c=a;if(""!==b){var d=a.toLowerCase().indexOf(b.toLowerCase());if(-1<d){c=a.substr(0,d)+"<span class=\"matchtext\">"+a.substr(d,b.length)+"</span>"+a.substr(d+b.length)}}return c}});
define ("core_contentbank/selectors",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var b=function(a,b){return"[data-".concat(a,"=\"").concat(b,"\"]")},c={regions:{cbcontentname:b("region","cb-content-name"),contentbank:b("region","contentbank"),filearea:b("region","filearea")},actions:{search:b("action","searchcontent"),clearSearch:b("action","clearsearchcontent"),viewgrid:b("action","viewgrid"),viewlist:b("action","viewlist"),sortname:b("action","sortname"),sortdate:b("action","sortdate"),sortsize:b("action","sortsize"),sorttype:b("action","sorttype")},elements:{listitem:".cb-listitem",cbnavbarbreadcrumb:".cb-navbar-breadbrumb",cbnavbartotalsearch:".cb-navbar-totalsearch",clearsearch:".input-group-append .clear-icon",searchicon:".input-group-append .search-icon",searchinput:"#searchinput",sortbutton:".cb-btnsort"}};a.default=c;return a.default});
define ("core_contentbank/sort",["exports","./selectors","core/str","core/prefetch","core/ajax","core/notification"],function(a,b,c,d,e,f){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=g(b);d=g(d);e=g(e);f=g(f);function g(a){return a&&a.__esModule?a:{default:a}}var h=function(){var a=document.querySelector(b.default.regions.contentbank);d.default.prefetchStrings("contentbank",["contentname","lastmodified","size","type"]);d.default.prefetchStrings("moodle",["sortbyx","sortbyxreverse"]);i(a)};a.init=h;var i=function(a){var c=document.querySelector(b.default.regions.filearea),d=c.querySelectorAll(b.default.elements.listitem),e=a.querySelector(b.default.actions.viewgrid),f=a.querySelector(b.default.actions.viewlist);e.addEventListener("click",function(){a.classList.remove("view-list");a.classList.add("view-grid");e.classList.add("active");f.classList.remove("active");j(!1)});f.addEventListener("click",function(){a.classList.remove("view-grid");a.classList.add("view-list");f.classList.add("active");e.classList.remove("active");j(!0)});var g=a.querySelector(b.default.actions.sortname);g.addEventListener("click",function(){var b=k(a,g);m(c,d,"data-file",b)});var h=a.querySelector(b.default.actions.sortdate);h.addEventListener("click",function(){var b=k(a,h);m(c,d,"data-timemodified",b)});var i=a.querySelector(b.default.actions.sortsize);i.addEventListener("click",function(){var b=k(a,i);m(c,d,"data-bytes",b)});var l=a.querySelector(b.default.actions.sorttype);l.addEventListener("click",function(){var b=k(a,l);m(c,d,"data-type",b)})},j=function(a){if(!1===a){a=null}var b={methodname:"core_user_update_user_preferences",args:{preferences:[{type:"core_contentbank_view_list",value:a}]}};return e.default.call([b])[0].catch(f.default.exception)},k=function(a,c){var d=a.querySelectorAll(b.default.elements.sortbutton);d.forEach(function(a){if(a!==c){a.classList.remove("dir-asc");a.classList.remove("dir-desc");a.classList.add("dir-none");l(a,!1)}});var e=!0;if(c.classList.contains("dir-none")){c.classList.remove("dir-none");c.classList.add("dir-asc")}else if(c.classList.contains("dir-asc")){c.classList.remove("dir-asc");c.classList.add("dir-desc");e=!1}else if(c.classList.contains("dir-desc")){c.classList.remove("dir-desc");c.classList.add("dir-asc")}l(c,e);return e},l=function(a,b){var d=b?"sortbyxreverse":"sortbyx";return(0,c.get_string)(a.dataset.string,"contentbank").then(function(a){return(0,c.get_string)(d,"core",a)}).then(function(b){a.setAttribute("title",b);return b}).catch()},m=function(a,b,c,d){var e=[].slice.call(b).sort(function(e,a){var b=e.getAttribute(c),f=a.getAttribute(c);if(!isNaN(b)){b=parseInt(b);f=parseInt(f)}if(d){return b>f?1:-1}else{return b<f?1:-1}});e.forEach(function(b){return a.appendChild(b)})}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_course/local/activitychooser/dialogue",["exports","jquery","core/modal_events","core_course/local/activitychooser/selectors","core/templates","core/key_codes","core/loadingicon","core_course/local/activitychooser/repository","core/notification","core/utils"],function(a,b,c,d,e,f,g,h,i,j){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.displayChooser=void 0;b=m(b);c=l(c);d=m(d);e=l(e);h=l(h);i=m(i);var v="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};function k(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;k=function(){return a};return a}function l(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=k();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function m(a){return a&&a.__esModule?a:{default:a}}function n(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function o(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){n(h,d,e,f,g,"next",a)}function g(a){n(h,d,e,f,g,"throw",a)}f(void 0)})}}function p(a,b){return u(a)||t(a,b)||r(a,b)||q()}function q(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(a,b){if(!a)return;if("string"==typeof a)return s(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return s(a,b)}function s(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function t(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function u(a){if(Array.isArray(a))return a}var w=function(a){return"function"==typeof v.define&&v.define.amd?new Promise(function(b,c){v.require([a],b,c)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&v.require&&"component"===v.require.loader?Promise.resolve(require((a))):Promise.resolve(v[a])},x=function(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(null!==c&&!0===b.showFooter){c.setFooter(e.render("core_course/local/activitychooser/footer_partial",b))}var f=a.find(d.default.regions.help)[0];f.innerHTML="";f.classList.add("m-auto");var h=(0,g.addIconToContainer)(f),j=null,k=new Promise(function(a){j=a}),l=e.renderForPromise("core_course/local/activitychooser/help",b);Promise.all([l,h,k]).then(function(a){var b=p(a,1),c=b[0],d=c.html,g=c.js;return e.replaceNodeContents(f,d,g)}).then(function(){f.querySelector(d.default.regions.chooserSummary.header).focus();return f}).catch(i.default.exception);a.one("slid.bs.carousel",function(){j()});a.carousel("next")},y=function(){var a=o(regeneratorRuntime.mark(function a(b,c,d){var e,f,g,i;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:e=c.dataset.favourited;f=c.dataset.id;g=c.dataset.name;i=c.dataset.internal;if(!("true"===e)){a.next=10;break}a.next=7;return h.unfavouriteModule(g,f);case 7:d(i,!1,b);a.next=13;break;case 10:a.next=12;return h.favouriteModule(g,f);case 12:d(i,!0,b);case 13:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),z=function(a,c,f,g){var h=function(){var e=o(regeneratorRuntime.mark(function g(h){var e,i,j,k,l,m,n,o,p,q;return regeneratorRuntime.wrap(function(g){while(1){switch(g.prev=g.next){case 0:if(h.target.closest(d.default.actions.optionActions.showSummary)){e=(0,b.default)(a.getBody()[0].querySelector(d.default.regions.carousel));i=h.target.closest(d.default.regions.chooserOption.container);j=i.dataset.modname;k=c.get(j);k.showFooter=a.hasFooterContent();x(e,k,a)}if(!h.target.closest(d.default.actions.optionActions.manageFavourite)){g.next=10;break}l=h.target.closest(d.default.actions.optionActions.manageFavourite);g.next=5;return y(a.getBody()[0],l,f);case 5:m=a.getBody()[0].querySelector(d.default.elements.activetab).getAttribute("href");n=a.getBody()[0].querySelector(d.default.regions.getSectionChooserOptions(m));o=n.querySelector(d.default.regions.chooserOption.container);C(o,!0);A(a.getBody()[0],c,n,a);case 10:if(h.target.matches(d.default.actions.closeOption)){p=(0,b.default)(a.getBody()[0].querySelector(d.default.regions.carousel));p.carousel("prev");p.on("slid.bs.carousel",function(){var b=a.getBody()[0].querySelector(d.default.regions.modules),c=b.querySelector(d.default.regions.getModuleSelector(h.target.dataset.modname));c.focus()})}if(h.target.closest(d.default.actions.clearSearch)){q=a.getBody()[0].querySelector(d.default.actions.search);q.value="";q.focus();F(a,c,q.value)}case 12:case"end":return g.stop();}}},g)}));return function(){return e.apply(this,arguments)}}(),i=function(){var b=o(regeneratorRuntime.mark(function b(c){var d;return regeneratorRuntime.wrap(function(b){while(1){switch(b.prev=b.next){case 0:if(!(!0===g.footer)){b.next=6;break}b.next=3;return w(g.customfooterjs);case 3:d=b.sent;b.next=6;return d.footerClickListener(c,g,a);case 6:case"end":return b.stop();}}},b)}));return function(){return b.apply(this,arguments)}}();a.getBodyPromise().then(function(a){return a[0]}).then(function(a){(0,b.default)(a.querySelector(d.default.regions.carousel)).carousel({interval:!1,pause:!0,keyboard:!1});return a}).then(function(a){a.addEventListener("click",h);return a}).then(function(b){var e=b.querySelector(d.default.actions.search);e.addEventListener("input",(0,j.debounce)(function(){F(a,c,e.value)},300));return b}).then(function(b){var e=b.querySelector(d.default.elements.activetab).getAttribute("href"),f=b.querySelector(d.default.regions.getSectionChooserOptions(e)),g=f.querySelector(d.default.regions.chooserOption.container);C(g,!0);A(b,c,f,a);return b}).catch();a.getFooterPromise().then(function(a){return a[0]}).then(function(a){a.addEventListener("click",i);return a}).catch()},A=function(a,c,g){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null,i=g.querySelectorAll(d.default.regions.chooserOption.container);Array.from(i).forEach(function(e){return e.addEventListener("keydown",function(i){if(i.keyCode===f.enter||i.keyCode===f.space){if(i.target.matches(d.default.actions.optionActions.showSummary)){i.preventDefault();var e=i.target.closest(d.default.regions.chooserOption.container),j=e.dataset.modname,k=c.get(j),l=(0,b.default)(a.querySelector(d.default.regions.carousel));l.carousel({interval:!1,pause:!0,keyboard:!1});k.showFooter=h.hasFooterContent();x(l,k,h)}}if(i.keyCode===f.arrowRight){i.preventDefault();var m=i.target.closest(d.default.regions.chooserOption.container),n=m.nextElementSibling,o=g.firstElementChild,p=D(n,o);B(p,m)}if(i.keyCode===f.arrowLeft){i.preventDefault();var q=i.target.closest(d.default.regions.chooserOption.container),r=q.previousElementSibling,s=g.lastElementChild,t=D(r,s);B(t,q)}if(i.keyCode===f.home){i.preventDefault();var u=i.target.closest(d.default.regions.chooserOption.container),v=g.firstElementChild;B(v,u)}if(i.keyCode===f.end){i.preventDefault();var w=i.target.closest(d.default.regions.chooserOption.container),y=g.lastElementChild;B(y,w)}})})},B=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null;if(null!==b){C(b,!1)}C(a,!0);a.focus()},C=function(a,b){var c=a.querySelector(d.default.actions.addChooser),e=a.querySelector(d.default.actions.optionActions.showSummary),f=a.querySelector(d.default.actions.optionActions.manageFavourite);if(b){a.tabIndex=0;c.tabIndex=0;e.tabIndex=0;f.tabIndex=0}else{a.tabIndex=-1;c.tabIndex=-1;e.tabIndex=-1;f.tabIndex=-1}},D=function(a,b){if(null!==a){return a}else{return b}},E=function(){var a=o(regeneratorRuntime.mark(function a(b,c){var d,f,g,h;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:d={searchresultsnumber:c.length,searchresults:c};a.next=3;return e.renderForPromise("core_course/local/activitychooser/search_results",d);case 3:f=a.sent;g=f.html;h=f.js;a.next=8;return e.replaceNodeContents(b,g,h);case 8:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),F=function(){var a=o(regeneratorRuntime.mark(function a(b,c,e){var f,g,h,i,j,k,l,m;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:f=b.getBody()[0];g=f.querySelector(d.default.regions.searchResults);h=f.querySelector(d.default.regions.chooser);i=f.querySelector(d.default.elements.clearsearch);j=f.querySelector(d.default.elements.searchicon);if(!(0<e.length)){a.next=18;break}k=G(c,e);a.next=9;return E(g,k);case 9:l=g.querySelector(d.default.regions.searchResultItems);m=l.querySelector(d.default.regions.chooserOption.container);if(m){C(m,!0);A(f,c,l,b)}j.classList.add("d-none");i.classList.remove("d-none");h.setAttribute("hidden","hidden");g.removeAttribute("hidden");a.next=22;break;case 18:i.classList.add("d-none");j.classList.remove("d-none");g.setAttribute("hidden","hidden");h.removeAttribute("hidden");case 22:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),G=function(a,b){if(""===b){return a}b=b.toLowerCase();var c=[];a.forEach(function(a){var d=a.title.toLowerCase(),e=a.help.toLowerCase();if(d.includes(b)||e.includes(b)){c.push(a)}});return c},H=function(a,c){a.getModal()[0].tabIndex=-1;a.getBodyPromise().then(function(f){(0,b.default)(d.default.elements.tab).on("shown.bs.tab",function(b){var e=b.target.getAttribute("href"),g=f[0].querySelector(d.default.regions.getSectionChooserOptions(e)),h=g.querySelector(d.default.regions.chooserOption.container),i=b.relatedTarget.getAttribute("href"),j=f[0].querySelector(d.default.regions.getSectionChooserOptions(i));I(j);C(h,!0);A(f[0],c,g,a)})}).catch(i.default.exception)},I=function(a){var b=a.querySelectorAll(d.default.regions.chooserOption.container);b.forEach(function(a){C(a,!1)})};a.displayChooser=function displayChooser(a,b,d,e){var f=new Map;b.forEach(function(a){f.set(a.componentname+"_"+a.link,a)});a.then(function(a){z(a,f,d,e);H(a,f);a.getRoot().on(c.hidden,function(){a.destroy()});return a}).catch()}});
define ("core_course/local/activitychooser/repository",["exports","core/ajax"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.fetchFooterData=a.unfavouriteModule=a.favouriteModule=a.activityModules=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);var c=function(a){return b.default.call([{methodname:"core_course_get_course_content_items",args:{courseid:a}}])[0]};a.activityModules=c;var d=function(a,c){return b.default.call([{methodname:"core_course_add_content_item_to_user_favourites",args:{componentname:a,contentitemid:c}}])[0]};a.favouriteModule=d;var e=function(a,c){return b.default.call([{methodname:"core_course_remove_content_item_from_user_favourites",args:{componentname:a,contentitemid:c}}])[0]};a.unfavouriteModule=e;var f=function(a,c){return b.default.call([{methodname:"core_course_get_activity_chooser_footer",args:{courseid:a,sectionid:c}}])[0]};a.fetchFooterData=f});
define ("core_course/local/activitychooser/selectors",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var b=function(a,b){return"[data-".concat(a,"=\"").concat(b,"\"]")},c={regions:{chooser:b("region","chooser-container"),getSectionChooserOptions:function getSectionChooserOptions(a){return"".concat(a," ").concat(b("region","chooser-options-container"))},chooserOption:{container:b("region","chooser-option-container"),actions:b("region","chooser-option-actions-container"),info:b("region","chooser-option-info-container")},chooserSummary:{container:b("region","chooser-option-summary-container"),content:b("region","chooser-option-summary-content-container"),header:b("region","summary-header"),actions:b("region","chooser-option-summary-actions-container")},carousel:b("region","carousel"),help:b("region","help"),modules:b("region","modules"),favouriteTabNav:b("region","favourite-tab-nav"),defaultTabNav:b("region","default-tab-nav"),activityTabNav:b("region","activity-tab-nav"),favouriteTab:b("region","favourites"),recommendedTab:b("region","recommended"),defaultTab:b("region","default"),activityTab:b("region","activity"),resourceTab:b("region","resources"),getModuleSelector:function getModuleSelector(a){return"[role=\"menuitem\"][data-modname=\"".concat(a,"\"]")},searchResults:b("region","search-results-container"),searchResultItems:b("region","search-result-items-container")},actions:{optionActions:{showSummary:b("action","show-option-summary"),manageFavourite:b("action","manage-module-favourite")},addChooser:b("action","add-chooser-option"),closeOption:b("action","close-chooser-option-summary"),hide:b("action","hide"),search:b("action","search"),clearSearch:b("action","clearsearch")},render:{favourites:b("render","favourites-area")},elements:{section:".section",sectionmodchooser:"button.section-modchooser-link",sitemenu:".block_site_main_menu",sitetopic:"div.sitetopic",tab:"a[data-toggle=\"tab\"]",activetab:"a[data-toggle=\"tab\"][aria-selected=\"true\"]",visibletabs:"a[data-toggle=\"tab\"]:not(.d-none)",searchicon:".input-group-append .search-icon",clearsearch:".input-group-append .clear"}};a.default=c;return a.default});
define ("core_course/actions",["jquery","core/ajax","core/templates","core/notification","core/str","core/url","core/yui","core/modal_factory","core/modal_events","core/key_codes","core/log"],function(a,b,c,d,e,f,g,h,i,j,k){var l={EDITINPROGRESS:"editinprogress",SECTIONDRAGGABLE:"sectiondraggable",EDITINGMOVE:"editing_move"},m={ACTIVITYLI:"li.activity",ACTIONAREA:".actions",ACTIVITYACTION:"a.cm-edit-action",MENU:".moodle-actionmenu[data-enhance=moodle-core-actionmenu]",TOGGLE:".toggle-display,.dropdown-toggle",SECTIONLI:"li.section",SECTIONACTIONMENU:".section_action_menu",ADDSECTIONS:"#changenumsections [data-add-sections]"};g.use("moodle-course-coursebase",function(){var a=M.course.format.get_section_selector();if(a){m.SECTIONLI=a}});var n=function(a){var b;g.use("moodle-course-util",function(c){b=c.Moodle.core_course.util.cm.getId(c.Node(a.get(0)))});return b},o=function(a){var b;g.use("moodle-course-util",function(c){b=c.Moodle.core_course.util.cm.getName(c.Node(a.get(0)))});return b},p=function(a){a.addClass(l.EDITINPROGRESS);var b=a.find(m.ACTIONAREA).get(0);if(b){var c=M.util.add_spinner(g,g.Node(b));c.show();return c}return null},q=function(a){a.addClass(l.EDITINPROGRESS);var b=a.find(m.SECTIONACTIONMENU).get(0);if(b){var c=M.util.add_spinner(g,g.Node(b));c.show();return c}return null},r=function(a){var b=M.util.add_lightbox(g,g.Node(a.get(0)));b.show();return b},s=function(a,b,c){window.setTimeout(function(){a.removeClass(l.EDITINPROGRESS);if(b){b.hide()}},c)},t=function(a,b){if(a){window.setTimeout(function(){a.hide()},b)}},u=function(a){g.use("moodle-course-coursebase",function(){M.course.coursebase.invoke_function("setup_for_resource","#"+a)});if(M.core.actionmenu&&M.core.actionmenu.newDOMNode){M.core.actionmenu.newDOMNode(g.one("#"+a))}},v=function(b,c){var d=a("#"+b),e="[data-action="+c+"]";if("groupsseparate"===c||"groupsvisible"===c||"groupsnone"===c){e="[data-action=groupsseparate],[data-action=groupsvisible],[data-action=groupsnone]"}if(d.find(e).is(":visible")){d.find(e).focus()}else{d.find(m.MENU).find(m.TOGGLE).focus()}},w=function(b){var c=a("a:visible"),d=!1,e=null;c.each(function(){if(a.contains(b[0],this)){d=!0}else if(d){e=this;return!1}});return e},x=function(c,e,f){var g=f.attr("data-action"),h=p(c),i=b.call([{methodname:"core_course_edit_module",args:{id:e,action:g,sectionreturn:f.attr("data-sectionreturn")?f.attr("data-sectionreturn"):0}}],!0),j;if("duplicate"===g){j=r(f.closest(m.SECTIONLI))}a.when.apply(a,i).done(function(b){var d=w(c);c.replaceWith(b);a("<div>"+b+"</div>").find(m.ACTIVITYLI).each(function(b){u(a(this).attr("id"));if(0===b){v(a(this).attr("id"),g);d=null}});if(d){d.focus()}s(c,h,400);t(j,400);c.trigger(a.Event("coursemoduleedited",{ajaxreturn:b,action:g}))}).fail(function(b){s(c,h);t(j);var f=a.Event("coursemoduleeditfailed",{exception:b,action:g});c.trigger(f);if(!f.isDefaultPrevented()){d.exception(b)}})},y=function(c,d,e){var f=p(c),g=b.call([{methodname:"core_course_get_module",args:{id:d,sectionreturn:e}}],!0);a.when.apply(a,g).done(function(a){s(c,f,400);D(a)}).fail(function(){s(c,f)})},z=function(a,b){var c=a.attr("class").match(/modtype_([^\s]*)/)[1],f=o(a);e.get_string("pluginname",c).done(function(a){e.get_strings([{key:"confirm"},{key:null===f?"deletechecktype":"deletechecktypename",param:{type:a,name:f}},{key:"yes"},{key:"no"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],b)})})},A=function(a,b){e.get_strings([{key:"confirm"},{key:"yes"},{key:"no"}]).done(function(c){d.confirm(c[0],a,c[1],c[2],b)})},B=function(a,b,f,g,h){return e.get_strings([{key:f,component:g}]).then(function(d){a.find("span.menu-action-text").html(d[0]);return c.renderPix(b,"core")}).then(function(b){a.find(".icon").replaceWith(b);a.attr("data-action",h)}).catch(d.exception)},C=function(b,c,d,e){var f=c.attr("data-action");if("hide"===f||"show"===f){if("hide"===f){b.addClass("hidden");B(c,"i/show","showfromothers","format_"+e,"show")}else{b.removeClass("hidden");B(c,"i/hide","hidefromothers","format_"+e,"hide")}if(d.modules!==void 0){for(var g in d.modules){D(d.modules[g])}}if(d.section_availability!==void 0){b.find(".section_availability").first().replaceWith(d.section_availability)}}else if("setmarker"===f){var h=a(m.SECTIONLI+".current"),i=h.find(m.SECTIONACTIONMENU+" a[data-action=removemarker]");h.removeClass("current");B(i,"i/marker","highlight","core","setmarker");b.addClass("current");B(c,"i/marked","highlightoff","core","removemarker")}else if("removemarker"===f){b.removeClass("current");B(c,"i/marker","highlight","core","setmarker")}},D=function(b){a("<div>"+b+"</div>").find(m.ACTIVITYLI).each(function(){var c=a(this).attr("id");a(m.ACTIVITYLI+"#"+c).replaceWith(b);u(c)})},E=function(c,e,f,g){var h=f.attr("data-action"),i=f.attr("data-sectionreturn")?f.attr("data-sectionreturn"):0,j=q(c),k=b.call([{methodname:"core_course_edit_section",args:{id:e,action:h,sectionreturn:i}}],!0),l=r(c);a.when.apply(a,k).done(function(b){var d=a.parseJSON(b);s(c,j);t(l);c.find(m.SECTIONACTIONMENU).find(m.TOGGLE).focus();var i=a.Event("coursesectionedited",{ajaxreturn:d,action:h});c.trigger(i);if(!i.isDefaultPrevented()){C(c,f,d,g)}}).fail(function(b){s(c,j);t(l);var f=a.Event("coursesectioneditfailed",{exception:b,action:h});c.trigger(f);if(!f.isDefaultPrevented()){d.exception(b)}})};g.use("moodle-course-coursebase",function(){M.course.coursebase.register_module({set_visibility_resource_ui:function set_visibility_resource_ui(b){var c=a(b.element.getDOMNode()),d=n(c);if(d){var e=c.find("."+l.EDITINGMOVE).attr("data-sectionreturn");y(c,d,e)}}})});return{initCoursePage:function initCoursePage(b){a("body").on("click keypress",m.ACTIVITYLI+" "+m.ACTIVITYACTION+"[data-action]",function(b){if("keypress"===b.type&&13!==b.keyCode){return}var c=a(this),d=c.closest(m.ACTIVITYLI),e=c.attr("data-action"),f=n(d);switch(e){case"moveleft":case"moveright":case"delete":case"duplicate":case"hide":case"stealth":case"show":case"groupsseparate":case"groupsvisible":case"groupsnone":break;default:return;}if(!f){return}b.preventDefault();if("delete"===e){z(d,function(){x(d,f,c)})}else{x(d,f,c)}});a("body").on("click keypress",m.SECTIONLI+" "+m.SECTIONACTIONMENU+"[data-sectionid] a[data-action]",function(c){if("keypress"===c.type&&13!==c.keyCode){return}var d=a(this),e=d.closest(m.SECTIONLI),f=d.closest(m.SECTIONACTIONMENU).attr("data-sectionid");c.preventDefault();if(d.attr("data-confirm")){A(d.attr("data-confirm"),function(){E(e,f,d,b)})}else{E(e,f,d,b)}});e.get_string("numberweeks").done(function(b){var c=a(m.ADDSECTIONS),d=c.attr("data-add-sections"),e=c.attr("data-new-sections"),f=a("<div><label for=\"add_section_numsections\"></label> <input id=\"add_section_numsections\" type=\"number\" min=\"1\" max=\""+e+"\" value=\"1\"></div>");f.find("label").html(b);h.create({title:d,type:h.types.SAVE_CANCEL,body:f.html()},c).done(function(b){var e=a(b.getBody()).find("#add_section_numsections"),f=function(){if(""+parseInt(e.val())===e.val()&&1<=parseInt(e.val())){document.location=c.attr("href")+"&numsections="+parseInt(e.val())}};b.setSaveButtonText(d);b.getRoot().on(i.shown,function(){e.focus().select().on("keydown",function(a){if(a.keyCode===j.enter){f()}})});b.getRoot().on(i.save,function(a){a.preventDefault();f()})})})},replaceSectionActionItem:function replaceSectionActionItem(a,b,c,d,e,f){k.debug("replaceSectionActionItem() is deprecated and will be removed.");var g=a.find(m.SECTIONACTIONMENU+" "+b);B(g,c,d,e,f)}}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_course/activitychooser",["exports","core_course/local/activitychooser/dialogue","core_course/local/activitychooser/repository","core_course/local/activitychooser/selectors","core/custom_interaction_events","core/templates","core/modal_factory","core/str","core/pending"],function(a,b,c,d,e,f,g,h,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=l(b);c=l(c);d=j(d);e=j(e);f=l(f);g=l(g);i=j(i);function j(a){return a&&a.__esModule?a:{default:a}}function k(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;k=function(){return a};return a}function l(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=k();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function m(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function n(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){m(h,d,e,f,g,"next",a)}function g(a){m(h,d,e,f,g,"throw",a)}f(void 0)})}}var o=2,p=function(a,b){var c=new i.default;q(a,b);c.resolve()};a.init=p;var q=function(a,g){var h=["click",e.default.events.activate,e.default.events.keyboardActivate],i=function(){var b=null;return function(){if(!b){b=new Promise(function(b){b(c.activityModules(a))})}return b}}(),j=function(){var b=null;return function(d){if(!b){b=new Promise(function(b){b(c.fetchFooterData(a,d))})}return b}}();e.default.define(document,h);h.forEach(function(a){document.addEventListener(a,function(){var a=n(regeneratorRuntime.mark(function a(c){var e,h,k,l,m,o,p,q,u;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:if(!c.target.closest(d.default.elements.sectionmodchooser)){a.next=21;break}h=c.target.closest(d.default.elements.section);k=c.target.closest(d.default.elements.sectionmodchooser);if(null!==h&&h.hasAttribute("data-sectionid")){e=h}else{e=k}m=new Promise(function(a){l=a});a.next=7;return j(e.dataset.sectionid);case 7:o=a.sent;p=t(m,o);a.next=11;return i().catch(function(){var a=n(regeneratorRuntime.mark(function a(b){var c;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:c={errormessage:b.message};a.t0=l;a.next=4;return f.render("core_course/local/activitychooser/error",c);case 4:a.t1=a.sent;(0,a.t0)(a.t1);case 6:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}());case 11:q=a.sent;if(q){a.next=14;break}return a.abrupt("return");case 14:u=r(q,e.dataset.sectionid,e.dataset.sectionreturnid);b.displayChooser(p,u,v(q,e.dataset.sectionid),o);a.t0=l;a.next=19;return f.render("core_course/activitychooser",s(u,g));case 19:a.t1=a.sent;(0,a.t0)(a.t1);case 21:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}())})},r=function(a,b,c){var d=JSON.parse(JSON.stringify(a));d.content_items.forEach(function(a){a.link+="&section="+b+"&sr="+(null!==c&&void 0!==c?c:0)});return d.content_items},s=function(a,b){var c=[],d=[],e=!0,f=!1,g=!1,h=parseInt(b.tabmode),i=a.filter(function(a){return!0===a.favourite}),j=a.filter(function(a){return!0===a.recommended});if((h===0||h===o)&&h!==1){c=a.filter(function(a){return a.archetype===0});d=a.filter(function(a){return a.archetype===1});f=!0;g=!0;if(h===o){e=!1}}var k=!!i.length,l=!1===e&&!1===k,m=!0===e&&!1===k;return{default:a,showAll:e,activities:c,showActivities:f,activitiesFirst:l,resources:d,showResources:g,favourites:i,recommended:j,favouritesFirst:k,fallback:m}},t=function(a,b){return g.create({type:g.types.DEFAULT,title:(0,h.get_string)("addresourceoractivity"),body:a,footer:b.customfootertemplate,xlarge:!0,templateContext:{classes:"modchooser"}}).then(function(a){a.show();return a})},u=function(a,b){a.tabIndex=-1;a.classList.add("d-none");if(a.classList.contains("active")){a.classList.remove("active");a.setAttribute("aria-selected","false");var f=b.querySelector(d.default.regions.favouriteTab);f.classList.remove("active");var c=b.querySelector(d.default.regions.defaultTabNav),e=b.querySelector(d.default.regions.activityTabNav);if(!1===c.classList.contains("d-none")){c.classList.add("active");c.setAttribute("aria-selected","true");c.tabIndex=0;c.focus();var g=b.querySelector(d.default.regions.defaultTab);g.classList.add("active")}else{e.classList.add("active");e.setAttribute("aria-selected","true");e.tabIndex=0;e.focus();var h=b.querySelector(d.default.regions.activityTab);h.classList.add("active")}}},v=function(a,b){return function(){var c=n(regeneratorRuntime.mark(function c(e,g,h){var i,j,k,l,m,n,o,p,q,s,t;return regeneratorRuntime.wrap(function(c){while(1){switch(c.prev=c.next){case 0:i=h.querySelector(d.default.render.favourites);j=h.querySelectorAll("[data-internal=\"".concat(e,"\"] ").concat(d.default.actions.optionActions.manageFavourite));k=h.querySelector(d.default.regions.favouriteTabNav);l=a.content_items.find(function(a){var b=a.name;return b===e});m={};if(!l){c.next=27;break}if(!g){c.next=21;break}l.favourite=!0;m.content_items=a.content_items.filter(function(a){return!0===a.favourite});n=r(m,b);c.next=12;return f.renderForPromise("core_course/local/activitychooser/favourites",{favourites:n});case 12:o=c.sent;p=o.html;q=o.js;c.next=17;return f.replaceNodeContents(i,p,q);case 17:Array.from(j).forEach(function(a){a.classList.remove("text-muted");a.classList.add("text-primary");a.dataset.favourited="true";a.setAttribute("aria-pressed",!0);a.firstElementChild.classList.remove("fa-star-o");a.firstElementChild.classList.add("fa-star")});k.classList.remove("d-none");c.next=27;break;case 21:l.favourite=!1;s=i.querySelector("[data-internal=\"".concat(e,"\"]"));s.parentNode.removeChild(s);Array.from(j).forEach(function(a){a.classList.add("text-muted");a.classList.remove("text-primary");a.dataset.favourited="false";a.setAttribute("aria-pressed",!1);a.firstElementChild.classList.remove("fa-star");a.firstElementChild.classList.add("fa-star-o")});t=a.content_items.filter(function(a){return!0===a.favourite});if(0===t.length){u(k,h)}case 27:case"end":return c.stop();}}},c)}));return function(){return c.apply(this,arguments)}}()}});
define ("core_course/copy_modal",["jquery","core/str","core/modal_factory","core/modal_events","core/ajax","core/fragment","core/notification","core/config"],function(a,b,c,d,f,g,h,i){var m={},n,o,p,q="<p class=\"text-center\"><i class=\"fa fa-spinner fa-pulse fa-2x fa-fw\"></i></p>";function j(){b.get_string("loading").then(function(a){c.create({type:c.types.DEFAULT,title:a,body:q,large:!0}).done(function(a){p=a;p.getRoot().on("click","#id_submitreturn",l);p.getRoot().on("click","#id_submitdisplay",function(a){a.formredirect=!0;l(a)});p.getRoot().on("click","#id_cancel",function(a){a.preventDefault();p.setBody(q);p.hide()})})}).catch(function(){h.exception(new Error("Failed to load string: loading"))})}function k(a){if("undefined"==typeof a){a={}}var c={jsonformdata:JSON.stringify(a),courseid:o.id};p.setBody(q);b.get_string("copycoursetitle","backup",o.shortname).then(function(a){p.setTitle(a);p.setBody(g.loadFragment("course","new_base_form",n,c))}).catch(function(){h.exception(new Error("Failed to load string: copycoursetitle"))})}function l(b){b.preventDefault();var c=p.getRoot().find("form").serialize(),d=JSON.stringify(c),e=a.merge(p.getRoot().find("[aria-invalid=\"true\"]"),p.getRoot().find(".error"));if(e.length){e.first().focus();return}f.call([{methodname:"core_backup_submit_copy_form",args:{jsonformdata:d}}])[0].done(function(){p.setBody(q);p.hide();if(!0==b.formredirect){var a=i.wwwroot+"/backup/copyprogress.php?id="+o.id;window.location.assign(a)}}).fail(function(){k(c)})}m.init=function(b){n=b;j();a(".action-copy").on("click",function(a){a.preventDefault();var b=new URL(this.getAttribute("href")),c=new URLSearchParams(b.search),d=c.get("id");f.call([{methodname:"core_course_get_courses",args:{options:{ids:[d]}}}])[0].done(function(a){o=a[0];k()}).fail(function(){h.exception(new Error("Failed to load course"))});p.show()})};return m});
define ("core_course/events",[],function(){return{favourited:"core_course:favourited",unfavorited:"core_course:unfavorited"}});
define ("core_course/recommendations",["exports","core/ajax","core/notification"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}var e=function(a){var d={methodname:"core_course_toggle_activity_recommendation",args:{area:a.currentTarget.dataset.area,id:a.currentTarget.dataset.id}};b.default.call([d])[0].fail(c.default.exception)};a.init=function init(){var a=document.querySelectorAll("[data-area]");a.forEach(function(a){a.addEventListener("change",e)})}});
define ("core_course/repository",["jquery","core/ajax"],function(a,b){return{getEnrolledCoursesByTimelineClassification:function getEnrolledCoursesByTimelineClassification(a,c,d,e){var f={classification:a};if("undefined"!=typeof c){f.limit=c}if("undefined"!=typeof d){f.offset=d}if("undefined"!=typeof e){f.sort=e}return b.call([{methodname:"core_course_get_enrolled_courses_by_timeline_classification",args:f}])[0]},getLastAccessedCourses:function getLastAccessedCourses(a,c,d,e){var f={};if("undefined"!=typeof a){f.userid=a}if("undefined"!=typeof c){f.limit=c}if("undefined"!=typeof d){f.offset=d}if("undefined"!=typeof e){f.sort=e}return b.call([{methodname:"core_course_get_recent_courses",args:f}])[0]},getUsersFromCourseModuleID:function getEnrolledUsersFromCourseModuleID(a,c){return b.call([{methodname:"core_course_get_enrolled_users_by_cmid",args:{cmid:a,groupid:c}}])[0]}}});
define ("core_customfield/form",["jquery","core/str","core/notification","core/ajax","core/templates","core/sortable_list","core/pending","core/inplace_editable"],function(a,b,c,d,e,f,g){var h=function(f,h,i,j,k){var l=new g("core_customfield/form:confirmDelete");b.get_strings([{key:"confirm"},{key:"confirmdelete"+h,component:"core_customfield"},{key:"yes"},{key:"no"}]).then(function(b){c.confirm(b[0],b[1],b[2],b[3],function(){var b=new g("core_customfield/form:confirmDelete"),l="field"===h?"core_customfield_delete_field":"core_customfield_delete_category";d.call([{methodname:l,args:{id:f}},{methodname:"core_customfield_reload_template",args:{component:i,area:j,itemid:k}}])[1].then(function(a){return e.render("core_customfield/list",a)}).then(function(b,c){e.replaceNode(a("[data-region=\"list-page\"]"),b,c);return null}).then(b.resolve).catch(c.exception)})}).then(l.resolve).catch(c.exception)},i=function(b,f,h){var i=new g("core_customfield/form:confirmDelete"),j=d.call([{methodname:"core_customfield_create_category",args:{component:b,area:f,itemid:h}},{methodname:"core_customfield_reload_template",args:{component:b,area:f,itemid:h}}]),k;j[0].then(function(a){k=a;return null}).catch(c.exception);j[1].then(function(a){return e.render("core_customfield/list",a)}).then(function(b,c){e.replaceNode(a("[data-region=\"list-page\"]"),b,c);window.location.href="#category-"+k;return null}).catch(c.exception);Promise.all(j).then(i.resolve).catch()};return{init:function init(){var e=a("#customfield_catlist"),j=e.attr("data-component"),k=e.attr("data-area"),l=e.attr("data-itemid");a("[data-role=deletefield]").on("click",function(b){h(a(this).attr("data-id"),"field",j,k,l);b.preventDefault()});a("[data-role=deletecategory]").on("click",function(b){h(a(this).attr("data-id"),"category",j,k,l);b.preventDefault()});a("[data-role=addnewcategory]").on("click",function(){i(j,k,l)});var m=function(a){return a.closest("[data-category-id]").find("[data-inplaceeditable][data-itemtype=category][data-component=core_customfield]").attr("data-value")},n=new f(a("#customfield_catlist .categorieslist"),{moveHandlerSelector:".movecategory [data-drag-type=move]"});n.getElementName=function(b){return a.Deferred().resolve(m(b))};a("[data-category-id]").on("sortablelist-drop",function(a,b){if(b.positionChanged){var e=new g("core_customfield/form:categoryid:on:sortablelist-drop");d.call([{methodname:"core_customfield_move_category",args:{id:b.element.data("category-id"),beforeid:b.targetNextElement.data("category-id")}}])[0].then(e.resolve).catch(c.exception)}a.stopPropagation()});var o=new f(a("#customfield_catlist .fieldslist tbody"),{moveHandlerSelector:".movefield [data-drag-type=move]"});o.getDestinationName=function(c,d){if(!d.length){return b.get_string("totopofcategory","customfield",m(c))}else if(d.attr("data-field-name")){return b.get_string("afterfield","customfield",d.attr("data-field-name"))}else{return a.Deferred().resolve("")}};a("[data-field-name]").on("sortablelist-drop",function(a,b){a.stopPropagation();if(b.positionChanged){var e=new g("core_customfield/form:fieldname:on:sortablelist-drop");d.call([{methodname:"core_customfield_move_field",args:{id:b.element.data("field-id"),beforeid:b.targetNextElement.data("field-id"),categoryid:+b.targetList.closest("[data-category-id]").attr("data-category-id")}}])[0].then(e.resolve).catch(c.exception)}});a("[data-field-name]").on("sortablelist-drag",function(d){var e=new g("core_customfield/form:fieldname:on:sortablelist-drag");d.stopPropagation();b.get_string("therearenofields","core_customfield").then(function(b){a("#customfield_catlist .categorieslist").children().each(function(){var c=a(this).find(a(".field")),d=a(this).find(a(".nofields"));if(!c.length&&!d.length){a(this).find("tbody").append("<tr class=\"nofields\"><td colspan=\"5\">"+b+"</td></tr>")}if(c.length&&d.length){d.remove()}});return null}).then(e.resolve).catch(c.exception)});a("[data-category-id], [data-field-name]").on("sortablelist-dragstart",function(b,c){setTimeout(function(){a(".sortable-list-is-dragged").width(c.element.width())},501)})}}});
define ("core_form/defaultcustom",["jquery"],function(a){a("body").on("change","input[data-defaultcustom=true]",function onChangeSelect(b){var c=a(b.target),d=JSON.parse(c.attr("data-defaultvalue")),e=JSON.parse(c.attr("data-customvalue")),f=c.attr("data-type"),g=c.closest("form"),h=c.attr("name").replace(/\[customize\]$/,"[value]"),i=c.prop("checked")?e:d;if("text"===f){g.find("[name=\""+h+"\"]").val(i)}else if("date_selector"===f){g.find("[name=\""+h+"[day]\"]").val(i.day);g.find("[name=\""+h+"[month]\"]").val(i.month);g.find("[name=\""+h+"[year]\"]").val(i.year)}else if("date_time_selector"===f){g.find("[name=\""+h+"[day]\"]").val(i.day);g.find("[name=\""+h+"[month]\"]").val(i.month);g.find("[name=\""+h+"[year]\"]").val(i.year);g.find("[name=\""+h+"[hour]\"]").val(i.hour);g.find("[name=\""+h+"[minute]\"]").val(i.minute)}})});
define ("core_form/events",["exports","core/str"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.triggerUploadCompleted=a.triggerUploadStarted=a.formEventTypes=void 0;var c;(0,b.get_string)("changesmadereallygoaway","moodle").then(function(a){c=a;return a}).catch();var d=function(a){if(a){a.returnValue=c}},e={uploadStarted:"core_form/uploadStarted",uploadCompleted:"core_form/uploadCompleted"};a.formEventTypes=e;a.triggerUploadStarted=function triggerUploadStarted(a){window.addEventListener("beforeunload",d);var b=new CustomEvent(e.uploadStarted,{bubbles:!0,cancellable:!1}),c=document.getElementById(a);c.dispatchEvent(b);return b};a.triggerUploadCompleted=function triggerUploadCompleted(a){window.removeEventListener("beforeunload",d);var b=new CustomEvent(e.uploadCompleted,{bubbles:!0,cancellable:!1}),c=document.getElementById(a);c.dispatchEvent(b);return b}});
define ("core_form/filetypes",["jquery","core/log","core/str","core/modal_factory","core/modal_events","core/ajax","core/templates","core/tree"],function(a,b,c,d,e,f,g,h){"use strict";var i=function(c,d,e,f){this.elementId=c;this.elementLabel=d;this.onlyTypes=e;this.allowAll=f;this.inputField=a("#"+c);this.wrapperBrowserTrigger=a("[data-filetypesbrowser=\""+c+"\"]");this.wrapperDescriptions=a("[data-filetypesdescriptions=\""+c+"\"]");if(!this.wrapperBrowserTrigger.length){return}if(!this.inputField.length||!this.wrapperDescriptions.length){b.error("core_form/filetypes: Unexpected DOM structure, unable to enhance filetypes field "+c);return}this.prepareBrowserTrigger().then(function(){return this.prepareBrowserModal()}.bind(this)).then(function(){return this.prepareBrowserTree()}.bind(this))};i.prototype.prepareBrowserTrigger=function(){return g.render("core_form/filetypes-trigger",{}).then(function(a){this.wrapperBrowserTrigger.html(a);this.browserTrigger=this.wrapperBrowserTrigger.find("[data-filetypeswidget=\"browsertrigger\"]")}.bind(this))};i.prototype.prepareBrowserModal=function(){return d.create({type:d.types.SAVE_CANCEL,title:this.elementLabel}).then(function(a){this.browserModal=a}.bind(this)).then(function(){this.browserModal.getRoot().on(e.hidden,function(){this.browserTrigger.focus()}.bind(this));this.browserModal.getRoot().on(e.save,function(){this.saveBrowserModal()}.bind(this))}.bind(this))};i.prototype.prepareBrowserTree=function(){this.browserTrigger.on("click",function(b){b.preventDefault();if(this.inputField.is("[disabled]")){return}var c=this.loadBrowserModalBody();c.then(function(){this.browserTree=new h(this.browserModal.getBody());this.browserTree.handleKeyDown=function(a,b){if(b.keyCode==this.browserTree.keys.enter||b.keyCode==this.browserTree.keys.space){b.preventDefault();b.stopPropagation();this.toggleCheckbox(a.attr("data-filetypesbrowserkey"))}else{h.prototype.handleKeyDown.call(this.browserTree,a,b)}}.bind(this);if(this.allowAll){this.hideOrShowItemsDependingOnAllowAll(this.browserModal.getRoot().find("input[type=\"checkbox\"][data-filetypesbrowserkey=\"*\"]").first());this.browserModal.getRoot().on("change","input[type=\"checkbox\"][data-filetypesbrowserkey=\"*\"]",function(b){this.hideOrShowItemsDependingOnAllowAll(a(b.currentTarget))}.bind(this))}this.browserModal.getRoot().on("change","input[type=\"checkbox\"][data-filetypesbrowserkey]",function(b){var c=a(b.currentTarget),d=c.attr("data-filetypesbrowserkey");this.browserModal.getRoot().find("input[type=\"checkbox\"][data-filetypesbrowserkey=\""+d+"\"]").prop("checked",c.prop("checked"))}.bind(this))}.bind(this)).then(function(){this.browserModal.show()}.bind(this));this.browserModal.setBody(c)}.bind(this));return a.when()};i.prototype.loadBrowserModalBody=function(){var a={onlytypes:this.onlyTypes.join(),allowall:this.allowAll,current:this.inputField.val()};return f.call([{methodname:"core_form_get_filetypes_browser_data",args:a}])[0].then(function(a){return g.render("core_form/filetypes-browser",{elementid:this.elementId,groups:a.groups})}.bind(this))};i.prototype.toggleCheckbox=function(a){var b=this.browserModal.getRoot().find("input[type=\"checkbox\"][data-filetypesbrowserkey=\""+a+"\"]").first();b.prop("checked",!b.prop("checked"))};i.prototype.saveBrowserModal=function(){if(this.allowAll){var b=this.browserModal.getRoot().find("input[type=\"checkbox\"][data-filetypesbrowserkey=\"*\"]");if(b.length&&b.prop("checked")){this.inputField.val("*");this.updateDescriptions(["*"]);return}}var c=[];this.browserModal.getRoot().find("input[type=\"checkbox\"]").each(function(){var b=a(this),d=b.attr("data-filetypesbrowserkey");if(b.prop("checked")){c.push(d)}});c=c.filter(function(b,c,d){return d.indexOf(b)==c});this.inputField.val(c.join(" "));this.updateDescriptions(c)};i.prototype.updateDescriptions=function(a){var b=[];a.forEach(function(a){b.push({description:this.browserModal.getRoot().find("[data-filetypesname=\""+a+"\"]").first().text().trim(),extensions:this.browserModal.getRoot().find("[data-filetypesextensions=\""+a+"\"]").first().text().trim()})}.bind(this));var c={hasdescriptions:0<b.length,descriptions:b};return g.render("core_form/filetypes-descriptions",c).then(function(a){this.wrapperDescriptions.html(a)}.bind(this))};i.prototype.hideOrShowItemsDependingOnAllowAll=function(a){var b=this.browserModal.getRoot().find("[role=\"treeitem\"][data-filetypesbrowserkey!=\"*\"]");if(a.prop("checked")){b.hide()}else{b.show()}};return{init:function init(a,b,c,d){new i(a,b,c,d)}}});
define ("core_form/passwordunmask",["jquery","core/templates"],function(a,b){var c=function(b){this.wrapperSelector="[data-passwordunmask=\"wrapper\"][data-passwordunmaskid=\""+b+"\"]";this.wrapper=a(this.wrapperSelector);this.editorSpace=this.wrapper.find("[data-passwordunmask=\"editor\"]");this.editLink=this.wrapper.find("a[data-passwordunmask=\"edit\"]");this.editInstructions=this.wrapper.find("[data-passwordunmask=\"instructions\"]");this.displayValue=this.wrapper.find("[data-passwordunmask=\"displayvalue\"]");this.inputFieldLabel=a("label[for=\""+b+"\"]");this.inputField=this.editorSpace.find(document.getElementById(b));this.inputField.attr("type","hidden");this.inputField.removeClass("hiddenifjs");if(!this.editInstructions.attr("id")){this.editInstructions.attr("id",b+"_instructions")}this.editInstructions.hide();this.setDisplayValue();this.addListeners()};c.prototype.addListeners=function(){this.wrapper.on("click keypress","[data-passwordunmask=\"edit\"]",a.proxy(function(b){if("keypress"===b.type&&13!==b.keyCode){return}b.stopImmediatePropagation();b.preventDefault();if("hidden"!==this.inputField.attr("type")){if("click"!==b.type&&!a(b.relatedTarget).is(":input")){this.turnEditingOff(!0)}else{this.turnEditingOff(!1)}}else{this.turnEditingOn()}},this));this.wrapper.on("click keypress","[data-passwordunmask=\"unmask\"]",a.proxy(function(a){if("keypress"===a.type&&13!==a.keyCode){return}a.stopImmediatePropagation();a.preventDefault();this.wrapper.data("unmasked",!this.wrapper.data("unmasked"));this.setDisplayValue()},this));this.wrapper.on("keydown","input",a.proxy(function(a){if("keydown"===a.type&&13!==a.keyCode){return}a.stopImmediatePropagation();a.preventDefault();this.turnEditingOff(!0)},this));this.inputFieldLabel.on("click",a.proxy(function(a){a.preventDefault();this.turnEditingOn()},this));return this};c.prototype.checkFocusOut=function(b){if(!this.isEditing()){return}window.setTimeout(a.proxy(function(){var c=b.relatedTarget||document.activeElement;if(this.wrapper.has(a(c)).length){return}this.turnEditingOff(!a(c).is(":input,a"))},this),100)};c.prototype.passwordVisible=function(){return!!this.wrapper.data("unmasked")};c.prototype.isEditing=function(){return"hidden"!==this.inputField.attr("type")};c.prototype.turnEditingOn=function(){var b=this.getDisplayValue();if(this.passwordVisible()){this.inputField.attr("type","text")}else{this.inputField.attr("type","password")}this.inputField.val(b);this.inputField.attr("size",this.inputField.attr("data-size"));if(this.editInstructions.length){this.inputField.attr("aria-describedby",this.editInstructions.attr("id"));this.editInstructions.show()}this.wrapper.attr("data-passwordunmask-visible",1);this.editLink.hide();this.inputField.focus().select();a("body").on("focusout",this.wrapperSelector,a.proxy(this.checkFocusOut,this));return this};c.prototype.turnEditingOff=function(b){a("body").off("focusout",this.wrapperSelector,this.checkFocusOut);var c=this.getDisplayValue();this.inputField.attr("type","hidden").attr("aria-describedby",null);this.inputField.val(c);this.editInstructions.hide();this.wrapper.removeAttr("data-passwordunmask-visible");this.inputField.removeAttr("size");this.editLink.show();this.setDisplayValue();if(b){this.editLink.focus()}return this};c.prototype.getDisplayValue=function(){return this.inputField.val()};c.prototype.setDisplayValue=function(){var c=this.getDisplayValue();if(this.isEditing()){if(this.wrapper.data("unmasked")){this.inputField.attr("type","text")}else{this.inputField.attr("type","password")}this.inputField.val(c)}if(c&&this.wrapper.data("unmasked")){this.displayValue.text(c)}else{if(!c){c=""}b.render("core_form/element-passwordunmask-fill",{element:{frozen:this.inputField.is("[readonly]"),value:c,valuechars:c.split("")}}).done(a.proxy(function(a,c){this.displayValue.html(a);b.runTemplateJS(c)},this))}return this};return c});
define ("core_form/showadvanced",["jquery","core/log","core/str","core/notification"],function(a,b,c,d){var f={FIELDSETCONTAINSADVANCED:"fieldset.containsadvancedelements",DIVFITEMADVANCED:"div.fitem.advanced",DIVADVANCEDSECTION:"div#form-advanced-div",DIVFCONTAINER:"div.fcontainer",MORELESSLINK:"fieldset.containsadvancedelements .moreless-toggler"},g={SHOW:"show",MORELESSACTIONS:"moreless-actions",MORELESSTOGGLER:"moreless-toggler",SHOWLESS:"moreless-less"},h={FITEM:"<div class=\"fitem\"></div>",FELEMENT:"<div class=\"felement\"></div>",ADVANCEDDIV:"<div id=\"form-advanced-div\"></div>"},i=0,j=function(b){this.id=b;var c=a(document.getElementById(b));this.enhanceForm(c)};j.prototype.id="";j.prototype.enhanceForm=function(b){var c=b.find(f.FIELDSETCONTAINSADVANCED);c.each(function(b,c){this.enhanceFieldset(a(c))}.bind(this));b.on("click",f.MORELESSLINK,this.switchState);b.on("keydown",f.MORELESSLINK,function(a){if(13==a.which||32==a.which){return this.switchState(a)}return!0}.bind(this));return this};j.prototype.generateId=function(a){var b=a.prop("id");if("undefined"==typeof b){b="showadvancedid-"+i++;a.prop("id",b)}return b};j.prototype.enhanceFieldset=function(e){var i=a("input[name=mform_showmore_"+e.prop("id")+"]");if(!i.length){b.debug("M.form.showadvanced::processFieldset was called on an fieldset without a status field: '"+e.prop("id")+"'");return this}c.get_strings([{key:"showmore",component:"core_form"},{key:"showless",component:"core_form"}]).then(function(b){var c=b[0],d=b[1],j=a("<a href=\"#\"></a>");j.addClass(g.MORELESSTOGGLER);if("0"===i.val()){j.html(c);j.attr("aria-expanded","false")}else{j.html(d);j.attr("aria-expanded","true");j.addClass(g.SHOWLESS);e.find(f.DIVFITEMADVANCED).addClass(g.SHOW)}var k=[];e.find(f.DIVFITEMADVANCED).each(function(b,c){k[k.length]=this.generateId(a(c))}.bind(this));j.attr("role","button");j.attr("aria-controls","form-advanced-div");var l=a(h.ADVANCEDDIV);e.find(f.DIVFITEMADVANCED).wrapAll(l);var m=a(h.FITEM);m.addClass(g.MORELESSACTIONS);var n=a(h.FELEMENT);n.append(j);m.append(n);e.find(f.DIVADVANCEDSECTION).before(m);return!0}.bind(this)).fail(d.exception);return this};j.prototype.switchState=function(b){b.preventDefault();c.get_strings([{key:"showmore",component:"core_form"},{key:"showless",component:"core_form"}]).then(function(c){var d=c[0],e=c[1],h=a(b.target).closest(f.FIELDSETCONTAINSADVANCED);h.find(f.DIVFITEMADVANCED).toggleClass(g.SHOW);var i=a("input[name=mform_showmore_"+h.prop("id")+"]");if("0"===i.val()){i.val(1);a(b.target).addClass(g.SHOWLESS);a(b.target).html(e);a(b.target).attr("aria-expanded","true")}else{i.val(0);a(b.target).removeClass(g.SHOWLESS);a(b.target).html(d);a(b.target).attr("aria-expanded","false")}return!0}).fail(d.exception);return this};return{init:function init(a){return new j(a)}}});
define ("core_form/submit",["exports","core_form/events"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;var c=0,d=[],e=function(a){d.push(a);if(!c){c=setInterval(function(){var a=document.cookie.split(f()+"=");if(2==a.length){g();clearInterval(c);c=0;d.forEach(function(a){a.disabled=!1})}},500)}},f=function(){return"moodledownload_"+M.cfg.sesskey},g=function(){document.cookie=encodeURIComponent(f())+"=deleted; expires="+new Date(0).toUTCString()};a.init=function init(a){var c=document.getElementById(a);document.addEventListener(b.formEventTypes.uploadStarted,function(a){window.console.log(a.target);c.disabled=!0});document.addEventListener(b.formEventTypes.uploadCompleted,function(a){window.console.log(a.target);c.disabled=!1});if("off"===c.form.dataset.doubleSubmitProtection){return}c.form.addEventListener("submit",function(a){var b=function(){if(a.defaultPrevented||c.disabled){return}c.disabled=!0;g();e(c)};window.addEventListener("beforeunload",b);setTimeout(function(){window.removeEventListener("beforeunload",b)},0)},!1)}});
define ("core_grades/grades/grader/gradingpanel/comparison",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.compareData=a.fillInitialValues=void 0;var b=function(a){Array.prototype.forEach.call(a.elements,function(a){if("submit"===a.type||"button"===a.type){}else if("radio"===a.type||"checkbox"===a.type){a.dataset.initialValue=JSON.stringify(a.checked)}else if("undefined"!=typeof a.value){a.dataset.initialValue=JSON.stringify(a.value)}else if("select-one"===a.type){Array.prototype.forEach.call(a.options,function(a){a.dataset.initialValue=JSON.stringify(a.selected)})}})};a.fillInitialValues=b;a.compareData=function compareData(a){var c=Array.prototype.some.call(a.elements,function(a){if("submit"===a.type||"button"===a.type){return!1}else if("radio"===a.type||"checkbox"===a.type){if("undefined"!=typeof a.dataset.initialValue){return a.dataset.initialValue!==JSON.stringify(a.checked)}}else if("undefined"!=typeof a.value){if("undefined"!=typeof a.dataset.initialValue){return a.dataset.initialValue!==JSON.stringify(a.value)}}else if("select-one"===a.type){return Array.prototype.some.call(a.options,function(a){if("undefined"!=typeof a.dataset.initialValue){return a.dataset.initialValue!==JSON.stringify(a.selected)}return!1})}return!0});b(a);return c}});
define ("core_grades/grades/grader/gradingpanel/normalise",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.failedUpdate=a.invalidResult=a.normaliseResult=void 0;a.normaliseResult=function normaliseResult(a){return{result:a,failed:!!a.warnings.length,success:!a.warnings.length,error:null}};a.invalidResult=function invalidResult(){return{success:!1,failed:!1,result:{},error:null}};a.failedUpdate=function failedUpdate(a){return{success:!1,failed:!0,result:{},error:a}}});
define ("core_grades/grades/grader/gradingpanel/point",["exports","./repository","core_grades/grades/grader/gradingpanel/comparison","jquery","./normalise"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.storeCurrentGrade=a.fetchCurrentGrade=void 0;d=function(a){return a&&a.__esModule?a:{default:a}}(d);function f(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function g(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var i=a.apply(b,c);function g(a){f(i,d,e,g,h,"next",a)}function h(a){f(i,d,e,g,h,"throw",a)}g(void 0)})}}a.fetchCurrentGrade=function fetchCurrentGrade(){return(0,b.fetchGrade)("point").apply(void 0,arguments)};var h=function(){var a=g(regeneratorRuntime.mark(function a(f,g,h,i,j,k){var l,m;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:l=k.querySelector("form");m=l.querySelector("input[name=\"grade\"]");if(!(!m.checkValidity()||!m.value.trim())){a.next=4;break}return a.abrupt("return",e.invalidResult);case 4:if(!(!0===(0,c.compareData)(l))){a.next=10;break}a.next=7;return(0,b.saveGrade)("point")(f,g,h,i,j,(0,d.default)(l).serialize());case 7:return a.abrupt("return",a.sent);case 10:return a.abrupt("return","");case 11:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.storeCurrentGrade=h});
define ("core_grades/grades/grader/gradingpanel/repository",["exports","core/ajax","./normalise"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.saveGrade=a.fetchGrade=void 0;function d(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function e(a){return function(){var b=this,c=arguments;return new Promise(function(e,f){var i=a.apply(b,c);function g(a){d(i,e,f,g,h,"next",a)}function h(a){d(i,e,f,g,h,"throw",a)}g(void 0)})}}a.fetchGrade=function fetchGrade(a){return function(c,d,e,f){return(0,b.call)([{methodname:"core_grades_grader_gradingpanel_".concat(a,"_fetch"),args:{component:c,contextid:d,itemname:e,gradeduserid:f}}])[0]}};a.saveGrade=function saveGrade(a){return function(){var d=e(regeneratorRuntime.mark(function d(e,f,g,h,i,j){return regeneratorRuntime.wrap(function(d){while(1){switch(d.prev=d.next){case 0:d.t0=c.normaliseResult;d.next=3;return(0,b.call)([{methodname:"core_grades_grader_gradingpanel_".concat(a,"_store"),args:{component:e,contextid:f,itemname:g,gradeduserid:h,notifyuser:i,formdata:j}}])[0];case 3:d.t1=d.sent;return d.abrupt("return",(0,d.t0)(d.t1));case 5:case"end":return d.stop();}}},d)}));return function(){return d.apply(this,arguments)}}()}});
define ("core_grades/grades/grader/gradingpanel/scale",["exports","./repository","core_grades/grades/grader/gradingpanel/comparison","jquery","./normalise"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.storeCurrentGrade=a.fetchCurrentGrade=void 0;d=function(a){return a&&a.__esModule?a:{default:a}}(d);a.fetchCurrentGrade=function fetchCurrentGrade(){return(0,b.fetchGrade)("scale").apply(void 0,arguments)};var f=function(a,f,g,h,i,j){var k=j.querySelector("form"),l=k.querySelector("select[name=\"grade\"]");if(!l.checkValidity()||!l.value.trim()){return e.invalidResult}if(!0===(0,c.compareData)(k)){return(0,b.saveGrade)("scale")(a,f,g,h,i,(0,d.default)(k).serialize())}else{return""}};a.storeCurrentGrade=f});
define ("core_grades/edittree_index",["jquery"],function(a){var b=function(){a("body").on("change",".weightoverride",b.toggleWeightInput);a("#menumoveafter").on("change",function(){var b=a(this).closest("form"),c=b.find("#bulkmoveinput");c.val(1);b.submit()})};b.toggleWeightInput=function(b){b.preventDefault();var c=a(this),d=c.closest("tr");a("input[name=\"weight_"+d.data("itemid")+"\"]").prop("disabled",!c.prop("checked"))};return{enhance:b}});
define ("core_h5p/editor_display",["exports","jquery"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);var c=function(a){var c=(0,b.default)("#"+a),d=(0,b.default)(".h5p-editor"),e=d.closest("form"),f=(0,b.default)("h5p-editor-upload"),g=(0,b.default)("input[name=\"h5plibrary\"]"),h=(0,b.default)("input[name=\"h5pparams\"]"),i=(0,b.default)("input[name=\"name\"]"),j=(0,b.default)("input[name=\"h5paction\"]");j.val("create");H5PEditor.init(e,j,f,c,d,g,h,"",i,function cancelSubmitCallback(a){return a.is("[name=\"cancel\"]")});document.querySelector("#"+a+" iframe").setAttribute("name","h5p-editor")};a.init=c});
define ("core_message/message_drawer",["jquery","core/custom_interaction_events","core/pubsub","core_message/message_drawer_view_contact","core_message/message_drawer_view_contacts","core_message/message_drawer_view_conversation","core_message/message_drawer_view_group_info","core_message/message_drawer_view_overview","core_message/message_drawer_view_search","core_message/message_drawer_view_settings","core_message/message_drawer_router","core_message/message_drawer_routes","core_message/message_drawer_events","core/pending","core/drawer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p={DRAWER:"[data-region=\"right-hand-drawer\"]",JUMPTO:".popover-region [data-region=\"jumpto\"]",PANEL_BODY_CONTAINER:"[data-region=\"panel-body-container\"]",PANEL_HEADER_CONTAINER:"[data-region=\"panel-header-container\"]",VIEW_CONTACT:"[data-region=\"view-contact\"]",VIEW_CONTACTS:"[data-region=\"view-contacts\"]",VIEW_CONVERSATION:"[data-region=\"view-conversation\"]",VIEW_GROUP_INFO:"[data-region=\"view-group-info\"]",VIEW_OVERVIEW:"[data-region=\"view-overview\"]",VIEW_SEARCH:"[data-region=\"view-search\"]",VIEW_SETTINGS:"[data-region=\"view-settings\"]",ROUTES:"[data-route]",ROUTES_BACK:"[data-route-back]",HEADER_CONTAINER:"[data-region=\"header-container\"]",BODY_CONTAINER:"[data-region=\"body-container\"]",FOOTER_CONTAINER:"[data-region=\"footer-container\"]",CLOSE_BUTTON:"[data-action=\"closedrawer\"]"},q=function(a,b,c){var d=b.find(p.HEADER_CONTAINER).find(c);if(!d.length){d=b.find(p.PANEL_HEADER_CONTAINER).find(c)}var e=b.find(p.BODY_CONTAINER).find(c);if(!e.length){e=b.find(p.PANEL_BODY_CONTAINER).find(c)}var f=b.find(p.FOOTER_CONTAINER).find(c);return[a,d.length?d:null,e.length?e:null,f.length?f:null]},r=[[l.VIEW_CONTACT,p.VIEW_CONTACT,d.show,d.description],[l.VIEW_CONTACTS,p.VIEW_CONTACTS,e.show,e.description],[l.VIEW_CONVERSATION,p.VIEW_CONVERSATION,f.show,f.description],[l.VIEW_GROUP_INFO,p.VIEW_GROUP_INFO,g.show,g.description],[l.VIEW_OVERVIEW,p.VIEW_OVERVIEW,h.show,h.description],[l.VIEW_SEARCH,p.VIEW_SEARCH,i.show,i.description],[l.VIEW_SETTINGS,p.VIEW_SETTINGS,j.show,j.description]],s=function(a,b){r.forEach(function(c){k.add(a,c[0],q(a,b,c[1]),c[2],c[3])})},t=function(a,b){if(!b.attr("data-shown")){k.go(a,l.VIEW_OVERVIEW);b.attr("data-shown",!0)}var c=o.getDrawerRoot(b);if(c.length){o.show(c)}},u=function(a){var b=o.getDrawerRoot(a);if(b.length){o.hide(b)}},v=function(a){var b=o.getDrawerRoot(a);if(b.length){return o.isVisible(b)}return!0},w=function(b){a(p.DRAWER).attr("data-origin",b)},x=function(d,e,f){b.define(e,[b.events.activate]);var g=/^data-route-param-?(\d*)$/;e.on(b.events.activate,p.ROUTES,function(b,c){for(var e=a(b.target).closest(p.ROUTES),f=e.attr("data-route"),h=[],j=0;j<e[0].attributes.length;j++){h.push(e[0].attributes[j])}var l=h.filter(function(a){var b=a.nodeName,c=g.test(b);return c});l.sort(function(c,a){var b=g.exec(c.nodeName),d=g.exec(a.nodeName),e=1<b.length?b[1]:0,f=1<d.length?d[1]:0;if(e<f){return-1}else if(f<e){return 1}else{return 0}});var m=l.map(function(a){return a.nodeValue}),n=[d,f].concat(m);k.go.apply(null,n);c.originalEvent.preventDefault()});e.on(b.events.activate,p.ROUTES_BACK,function(a,b){k.back(d);b.originalEvent.preventDefault()});e.on("hide.bs.collapse",".collapse",function(b){var c=new n;a(b.target).one("hidden.bs.collapse",function(){c.resolve()})});e.on("show.bs.collapse",".collapse",function(b){var c=new n;a(b.target).one("shown.bs.collapse",function(){c.resolve()})});a(p.JUMPTO).focus(function(){var b=a(p.HEADER_CONTAINER).find("input:visible");if(b.length){b.focus()}else{a(p.HEADER_CONTAINER).find(p.ROUTES_BACK).focus()}});a(p.DRAWER).focus(function(){var b=a(this).attr("data-origin");if(b){a("#"+b).focus()}});if(!f){c.subscribe(m.SHOW,function(){t(d,e)});c.subscribe(m.HIDE,function(){u(e)});c.subscribe(m.TOGGLE_VISIBILITY,function(b){if(v(e)){u(e);a(p.JUMPTO).attr("tabindex",-1)}else{t(d,e);w(b);a(p.JUMPTO).attr("tabindex",0)}})}c.subscribe(m.SHOW_CONVERSATION,function(a){w(a.buttonid);t(d,e);k.go(d,l.VIEW_CONVERSATION,a.conversationid)});var h=e.find(p.CLOSE_BUTTON);h.on(b.events.activate,function(){c.publish(m.TOGGLE_VISIBILITY)});c.subscribe(m.CREATE_CONVERSATION_WITH_USER,function(a){w(a.buttonid);t(d,e);k.go(d,l.VIEW_CONVERSATION,null,"create",a.userid)});c.subscribe(m.SHOW_SETTINGS,function(){t(d,e);k.go(d,l.VIEW_SETTINGS)});c.subscribe(m.PREFERENCES_UPDATED,function(a){var b=a.filter(function(a){return"message_entertosend"==a.type}),c=b.length?b[0]:null;if(c){var d=e.find(p.FOOTER_CONTAINER).find(p.VIEW_CONVERSATION);d.attr("data-enter-to-send",c.value)}})};return{init:function init(b,c,d,e){b=a(b);s(c,b);x(c,b,d);if(d){t(c,b);if(e){var f=e.params||[];f=[c,e.path].concat(f);k.go.apply(null,f)}}}}});
define ("core_message/message_drawer_events",[],function(){return{CREATE_CONVERSATION_WITH_USER:"message-drawer-create-conversation-with-user",CONTACT_BLOCKED:"message-drawer-contact-blocked",CONTACT_UNBLOCKED:"message-drawer-contact-unblocked",CONTACT_ADDED:"message-drawer-contact-added",CONTACT_REMOVED:"message-drawer-contact-removed",CONTACT_REQUEST_ACCEPTED:"message-drawer-contact-request-accepted",CONTACT_REQUEST_DECLINED:"message-drawer-contact-request-declined",CONVERSATION_CREATED:"message-drawer-conversation-created",CONVERSATION_NEW_LAST_MESSAGE:"message-drawer-conversation-new-last-message",CONVERSATION_DELETED:"message-drawer-conversation-deleted",CONVERSATION_READ:"message-drawer-conversation-read",CONVERSATION_SET_FAVOURITE:"message-drawer-conversation-set-favourite",CONVERSATION_SET_MUTED:"message-drawer-conversation-set-muted",CONVERSATION_UNSET_FAVOURITE:"message-drawer-conversation-unset-favourite",CONVERSATION_UNSET_MUTED:"message-drawer-conversation-unset-muted",PREFERENCES_UPDATED:"message-drawer-preferences-updated",ROUTE_CHANGED:"message-drawer-route-change",SHOW:"message-drawer-show",HIDE:"message-drawer-hide",TOGGLE_VISIBILITY:"message-drawer-toggle",SHOW_CONVERSATION:"message-drawer-show-conversation",SHOW_SETTINGS:"message-drawer-show-settings"}});
define ("core_message/message_drawer_helper",["core/pubsub","core_message/message_drawer_events"],function(a,b){return{createConversationWithUser:function createConversationWithUser(c){a.publish(b.CREATE_CONVERSATION_WITH_USER,c)},hide:function hide(){a.publish(b.HIDE)},show:function show(){a.publish(b.SHOW)},showConversation:function showConversation(c){a.publish(b.SHOW_CONVERSATION,c)},showSettings:function showSettings(){a.publish(b.SHOW_SETTINGS)}}});
define ("core_message/message_send_bulk",["exports","core/str","core/modal_factory","core/templates","core/modal_events","core/ajax","core/notification"],function(a,b,c,d,e,f,g){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.sendMessage=a.showModal=void 0;c=h(c);d=h(d);e=h(e);f=h(f);g=h(g);function h(a){return a&&a.__esModule?a:{default:a}}var i=function(a){var f=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null;if(!a.length){return Promise.resolve()}var g=null;if(1==a.length){g=(0,b.get_string)("sendbulkmessagesingle","core_message")}else{g=(0,b.get_string)("sendbulkmessage","core_message",a.length)}return c.default.create({type:c.default.types.SAVE_CANCEL,body:d.default.render("core_message/send_bulk_message",{}),title:g}).then(function(b){b.setSaveButtonText(g);b.getRoot().on(e.default.hidden,function(){if(f){f()}b.getRoot().remove()});b.getRoot().on(e.default.save,function(){var c=b.getRoot().find("form textarea").val();j(c,a)});b.show();return b})};a.showModal=i;var j=function(a,c){var d=[];c.forEach(function(b){d.push({touserid:b,text:a})});return f.default.call([{methodname:"core_message_send_instant_messages",args:{messages:d}}])[0].then(function(a){if(1==a.length){return(0,b.get_string)("sendbulkmessagesentsingle","core_message")}else{return(0,b.get_string)("sendbulkmessagesent","core_message",a.length)}}).then(function(a){g.default.addNotification({message:a,type:"success"});return!0}).catch(g.default.exception)};a.sendMessage=j});
define ("core_message/notification_processor",["jquery"],function(a){var b={STATE_NONE:"[data-state=\"none\"]",STATE_BOTH:"[data-state=\"both\"]",STATE_LOGGED_IN:"[data-state=\"loggedin\"]",STATE_LOGGED_OFF:"[data-state=\"loggedoff\"]"},c=function(b){this.root=a(b)};c.prototype.getName=function(){return this.root.attr("data-processor-name")};c.prototype.isLoggedInEnabled=function(){var a=this.root.find(b.STATE_NONE).find("input");if(a.prop("checked")){return!1}var c=this.root.find(b.STATE_BOTH).find("input"),d=this.root.find(b.STATE_LOGGED_IN).find("input");return d.prop("checked")||c.prop("checked")};c.prototype.isLoggedOffEnabled=function(){var a=this.root.find(b.STATE_NONE).find("input");if(a.prop("checked")){return!1}var c=this.root.find(b.STATE_BOTH).find("input"),d=this.root.find(b.STATE_LOGGED_OFF).find("input");return d.prop("checked")||c.prop("checked")};return c});
define ("core_message/message_drawer_lazy_load_list",["jquery","core/custom_interaction_events"],function(a,b){var c={ROOT:"[data-region=\"lazy-load-list\"]",LOADING_ICON_CONTAINER:"[data-region=\"loading-icon-container\"]",CONTENT_CONTAINER:"[data-region=\"content-container\"]",EMPTY_MESSAGE:"[data-region=\"empty-message-container\"]",PLACEHOLDER:"[data-region=\"placeholder-container\"]"},d=function(a){a.attr("data-loading",!0)},e=function(a){a.attr("data-loading",!1)},f=function(a){return"true"===a.attr("data-loading")},g=function(a){return a.attr("data-user-id")},h=function(a){return a.find(c.CONTENT_CONTAINER)},i=function(a){a.find(c.LOADING_ICON_CONTAINER).removeClass("hidden")},j=function(a){a.find(c.LOADING_ICON_CONTAINER).addClass("hidden")},k=function(a){a.find(c.EMPTY_MESSAGE).removeClass("hidden")},l=function(a){a.find(c.PLACEHOLDER).removeClass("hidden")},m=function(a){a.find(c.PLACEHOLDER).addClass("hidden")},n=function(a){h(a).removeClass("hidden")},o=function(a){h(a).addClass("hidden")},p=function(a){return"true"==a.attr("data-loaded-all")},q=function(a,b){a.attr("data-loaded-all",b)},r=function(a){return!p(a)&&!f(a)},s=function(a,b,c){var f=g(a);d(a);return b(a,f).then(function(b){if(0<b.length){var d=h(a);return c(d,b,f).then(function(){return b})}else{return b}}).then(function(b){e(a);a.attr("data-seen",!0);if(!b.length){q(a,!0)}return b}).catch(function(){e(a);a.attr("data-seen",!0)})},t=function(a,b,c){h(a).empty();l(a);o(a);return s(a,b,c).then(function(b){m(a);if(!b.length){k(a)}else{n(a)}}).catch(function(){m(a);n(a)})},u=function(a,c,d){b.define(a,[b.events.scrollBottom]);a.on(b.events.scrollBottom,function(){if(r(a)){i(a);s(a,c,d).then(function(){return j(a)}).catch(function(){return j(a)})}})};return{show:function show(b,c,d){b=a(b);if(!b.attr("data-init")){u(b,c,d);t(b,c,d);b.attr("data-init",!0)}},getContentContainer:h,getRoot:function getRoot(a){return a.find(c.ROOT)},setLoadedAll:q,showEmptyMessage:k,hideEmptyMessage:function hideEmptyMessage(a){a.find(c.EMPTY_MESSAGE).addClass("hidden")},showContent:n,hideContent:o}});
define ("core_message/message_popover",["jquery","core/custom_interaction_events","core/pubsub","core_message/message_drawer_events"],function(a,b,c,d){var e={COUNT_CONTAINER:"[data-region=\"count-container\"]"},f=function(a){c.publish(d.TOGGLE_VISIBILITY,a)},g=function(a){return function(){var b=a.find(e.COUNT_CONTAINER),c=parseInt(b.text(),10);if(isNaN(c)){b.addClass("hidden")}else if(!c||2>c){b.addClass("hidden")}else{c=c-1;b.text(c)}}},h=function(a){b.define(a,[b.events.activate]);a.on(b.events.activate,function(b,c){f(a.attr("id"));a.focus();c.originalEvent.preventDefault()});c.subscribe(d.CONVERSATION_READ,g(a));c.subscribe(d.CONTACT_REQUEST_ACCEPTED,g(a));c.subscribe(d.CONTACT_REQUEST_DECLINED,g(a))};return{init:function init(b){b=a(b);h(b)}}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_message/message_drawer_router",["jquery","core/pubsub","core/str","core_message/message_drawer_events"],function(a,b,c,d){var e={},f={},g={CAN_RECEIVE_FOCUS:"input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]",ROUTES_BACK:"[data-route-back]"},h=function(c,f){var h,j=[].slice.call(arguments).some(function(a){return"frompanel"==a}),k=[].slice.call(arguments,2),l=a.Deferred().resolve().promise();Object.keys(e[c]).forEach(function(a){var b=e[c][a],d=a===f;if(d){h=b}b.parameters.forEach(function(a){if("object"!==_typeof(a)||null===a){return}a.removeClass("previous");a.attr("data-from-panel",!1);if(d){if(j){a.attr("data-from-panel",!0)}a.removeClass("hidden");a.attr("aria-hidden",!1)}else{if(!a.attr("data-in-panel")){a.addClass("hidden");a.attr("aria-hidden",!0)}else if("view-search"==f||"view-overview"==f){a.addClass("hidden");a.attr("aria-hidden",!0)}}})});if(h){if(h.onGo){l=h.onGo.apply(void 0,h.parameters.concat(k));for(var m=a(document.activeElement),n=!1,o=null,p=1,q;p<h.parameters.length;p++){q=h.parameters[p];if("object"!==_typeof(q)||null===q){continue}if(!o){o=q}if(q.has(m).length){n=!0;break}}if(!n){o.find(g.CAN_RECEIVE_FOCUS).filter(":visible").first().focus()}}}var r={route:f,params:k,renderPromise:l};b.publish(d.ROUTE_CHANGED,r);return r},i=function(b){var d=a(document.activeElement),j=h.apply(b,arguments),k=!1;if(!f[b]){f[b]=[]}f[b]=f[b].reduce(function(a,b){if(b.route===j.route){k=!0}if(!k){a.push(b)}return a},[]);var l=f[b].length,m=l?f[b][l-1]:null;if(m){for(var n=e[b][m.route],o=n.parameters,p=1;p<o.length;p++){if("object"!==_typeof(o[p])||null===o[p]){continue}o[p].addClass("previous")}m.focusElement=d;if(n.getDescription){n.getDescription.apply(null,n.parameters.concat(m.params)).then(function(a){return c.get_string("backto","core_message",a)}).then(function(a){return j.renderPromise.then(function(){e[b][j.route].parameters.forEach(function(b){if("object"!==_typeof(b)||!b){return}b.find(g.ROUTES_BACK).attr("aria-label",a)})})}).catch(function(){})}}f[b].push(j);return j};return{add:function add(a,b,c,d,f){if(!e[a]){e[a]=[]}e[a][b]={parameters:c,onGo:d,getDescription:f}},go:i,back:function back(a){if(f[a].length){f[a].pop();var b=f[a].pop();if(b){i.apply(void 0,[a,b.route].concat(b.params));window.setTimeout(function(){b.focusElement.focus()},50)}}}}});
define ("core_message/message_drawer_routes",[],function(){return{VIEW_CONTACT:"view-contact",VIEW_CONTACTS:"view-contacts",VIEW_CONVERSATION:"view-conversation",VIEW_GROUP_INFO:"view-group-info",VIEW_OVERVIEW:"view-overview",VIEW_SEARCH:"view-search",VIEW_SETTINGS:"view-settings"}});
define ("core_message/notification_processor_settings",["jquery","core/ajax","core/str","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","core/fragment"],function(a,b,c,d,e,f,g,h){var i=!1,j={SAVE_BUTTON:"[data-action=\"save\"]",CANCEL_BUTTON:"[data-action=\"cancel\"]",PROCESSOR:"[data-processor-name]",PREFERENCE_ROW:"[data-region=\"preference-row\"]"},k=function(a){f.call(this,a);this.name=null;this.userId=null;this.contextId=null;this.element=null;this.saveButton=this.getFooter().find(j.SAVE_BUTTON);this.cancelButton=this.getFooter().find(j.CANCEL_BUTTON)};k.TYPE="core_message-notification_processor_settings";k.prototype=Object.create(f.prototype);k.prototype.constructor=k;k.prototype.setUserId=function(a){this.userId=a};k.prototype.getUserId=function(){return this.userId};k.prototype.setElement=function(a){this.element=a};k.prototype.getElement=function(){return this.element};k.prototype.setName=function(a){this.name=a};k.prototype.getName=function(){return this.name};k.prototype.setContextId=function(a){this.contextId=a};k.prototype.getContextId=function(){return this.contextId};k.prototype.getForm=function(){return this.getBody().find("form")};k.prototype.disableButtons=function(){this.saveButton.prop("disabled",!0);this.cancelButton.prop("disabled",!0)};k.prototype.enableButtons=function(){this.saveButton.prop("disabled",!1);this.cancelButton.prop("disabled",!1)};k.prototype.loadTitleContent=function(){this.titlePromise=c.get_string("processorsettings","message");this.setTitle(this.titlePromise);return this.titlePromise};k.prototype.loadBodyContent=function(){this.disableButtons();var a={userid:this.getUserId(),type:this.getName()};this.bodyPromise=h.loadFragment("message","processor_settings",this.getContextId(),a);this.setBody(this.bodyPromise);this.bodyPromise.then(function(){this.enableButtons()}.bind(this)).fail(d.exception);return this.bodyPromise};k.prototype.loadAllContent=function(){return a.when(this.loadTitleContent(),this.loadBodyContent())};k.prototype.show=function(){this.loadAllContent();f.prototype.show.call(this)};k.prototype.hide=function(){f.prototype.hide.call(this);this.setContextId(null);this.setName(null);this.setUserId(null)};k.prototype.updateConfiguredStatus=function(){var c=a(this.getElement()).closest(j.PROCESSOR);if(!c.hasClass("unconfigured")){return!1}var e=c.attr("data-processor-name"),f={methodname:"core_message_get_message_processor",args:{name:e,userid:this.userId}};return b.call([f])[0].fail(d.exception).done(function(b){if(b.userconfigured){var d=a(j.PREFERENCE_ROW+" [data-processor-name=\""+e+"\"]");c.removeClass("unconfigured");d.removeClass("disabled")}})};k.prototype.registerEventListeners=function(){f.prototype.registerEventListeners.call(this);this.getModal().on(e.events.activate,j.SAVE_BUTTON,function(a,b){this.getForm().submit();b.originalEvent.preventDefault()}.bind(this));this.getModal().on("mpp:formsubmitted",function(a){this.hide();this.updateConfiguredStatus();a.stopPropagation()}.bind(this));this.getModal().on(e.events.activate,j.CANCEL_BUTTON,function(a,b){this.hide();b.originalEvent.preventDefault();a.stopPropagation()}.bind(this))};if(!i){g.register(k.TYPE,k,"core/modal_save_cancel");i=!0}return k});
define ("core_message/message_drawer_view_contact",["jquery","core/str","core/templates"],function(a,b,c){var d={CONTENT_CONTAINER:"[data-region=\"content-container\"]"},e={CONTENT:"core_message/message_drawer_view_contact_body_content"},f=function(a){return a.find(d.CONTENT_CONTAINER)},g=function(a,b){return c.render(e.CONTENT,b).then(function(b){f(a).append(b);return b})};return{show:function show(b,c,d,e,h){var i=a(d);f(i).empty();return g(i,h)},description:function description(a,c){return b.get_string("messagedrawerviewcontact","core_message",c.fullname)}}});
define ("core_message/preferences_processor_form",["jquery","core/ajax","core/notification"],function(a,b,c){var d=function(b){this.root=a(b);this.userId=this.root.attr("data-user-id");this.name=this.root.attr("data-processor-name");this.root.find("form").on("submit",function(c){c.preventDefault();this.save().done(function(){a(b).trigger("mpp:formsubmitted")})}.bind(this))};d.prototype.startLoading=function(){this.root.addClass("loading")};d.prototype.stopLoading=function(){this.root.removeClass("loading")};d.prototype.isLoading=function(){return this.root.hasClass("loading")};d.prototype.save=function(){if(this.isLoading()){return a.Deferred()}this.startLoading();var d=this.root.find("form").serializeArray(),e={methodname:"core_message_message_processor_config_form",args:{userid:this.userId,name:this.name,formvalues:d}};return b.call([e])[0].fail(c.exception).always(function(){this.stopLoading()}.bind(this))};return d});
define ("core_message/message_drawer_view_contacts",["jquery","core/pubsub","core/str","core_message/message_drawer_events","core_message/message_drawer_view_contacts_section_contacts","core_message/message_drawer_view_contacts_section_requests"],function(a,b,c,d,e,f){var g={ACTION_SHOW_CONTACTS_SECTION:"[data-action=\"show-contacts-section\"]",ACTION_SHOW_REQUESTS_SECTION:"[data-action=\"show-requests-section\"]",CONTACT_REQUEST_COUNT:"[data-region=\"contact-request-count\"]",CONTACTS_SECTION_CONTAINER:"[data-section=\"contacts\"]",REQUESTS_SECTION_CONTAINER:"[data-section=\"requests\"]"},h=function(a){return a.find(g.CONTACTS_SECTION_CONTAINER)},i=function(a){return a.find(g.REQUESTS_SECTION_CONTAINER)},j=function(a){return a.find(g.ACTION_SHOW_CONTACTS_SECTION)},k=function(a){return a.find(g.ACTION_SHOW_REQUESTS_SECTION)},l=function(a){return a.hasClass("active")},m=function(a){return function(){var b=a.find(g.CONTACT_REQUEST_COUNT),c=parseInt(b.text(),10);c=isNaN(c)?0:c-1;if(0>=c){b.addClass("hidden")}else{b.text(c)}}},n=function(a){var c=h(a),g=i(a),l=j(a),n=k(a);l.on("show.bs.tab",function(){e.show(c)});n.on("show.bs.tab",function(){f.show(g)});b.subscribe(d.CONTACT_REQUEST_ACCEPTED,m(a));b.subscribe(d.CONTACT_REQUEST_DECLINED,m(a))};return{show:function show(b,c,d,g,m){d=a(d);if(!d.attr("data-contacts-init")){n(d);d.attr("data-contacts-init",!0)}var o=h(d),p=i(d);if(m){var q=j(d),r=k(d);if("requests"==m){q.removeClass("active");o.removeClass("show active");r.addClass("active");p.addClass("show active")}else{r.removeClass("active");p.removeClass("show active");q.addClass("active");o.addClass("show active")}}if(l(o)){e.show(o)}else{f.show(p)}return a.Deferred().resolve().promise()},description:function description(){return c.get_string("messagedrawerviewcontacts","core_message")}}});
define ("core_message/message_preferences",["jquery","core/ajax","core/notification","core_message/message_notification_preference","core/custom_interaction_events"],function(a,b,c,d,e){var f={PREFERENCE:"[data-state]",PREFERENCES_CONTAINER:"[data-region=\"preferences-container\"]",CONTACTABLE_PRIVACY_CONTAINER:"[data-region=\"privacy-setting-container\"]"},g=function(b){this.root=a(b);this.userId=this.root.find(f.PREFERENCES_CONTAINER).attr("data-user-id");this.registerEventListeners()};g.prototype.preferencesDisabled=function(){return this.root.find(f.PREFERENCES_CONTAINER).hasClass("disabled")};g.prototype.saveContactablePrivacySetting=function(){var d=this.root.find(f.CONTACTABLE_PRIVACY_CONTAINER),e=a("input[type='radio']:checked").val();if(d.hasClass("loading")){return a.Deferred().resolve()}d.addClass("loading");var g={methodname:"core_user_update_user_preferences",args:{userid:this.userId,preferences:[{type:d.attr("data-preference-key"),value:e}]}};return b.call([g])[0].fail(c.exception).always(function(){d.removeClass("loading")})};g.prototype.registerEventListeners=function(){e.define(this.root,[e.events.activate]);this.root.on("change",function(b){if("message_blocknoncontacts"==b.target.name){this.saveContactablePrivacySetting()}else{if(!this.preferencesDisabled()){var c=a(b.target).closest(f.PREFERENCES_CONTAINER),e=a(b.target).closest(f.PREFERENCE),g=new d(c,this.userId);e.addClass("loading");g.save().always(function(){e.removeClass("loading")})}}}.bind(this))};return g});
function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}f(void 0)})}}define ("core_message/message_drawer_view_overview_section",["jquery","core/custom_interaction_events","core/notification","core/pubsub","core/str","core/pending","core/templates","core/user_date","core_message/message_repository","core_message/message_drawer_events","core_message/message_drawer_router","core_message/message_drawer_routes","core_message/message_drawer_lazy_load_list","core_message/message_drawer_view_conversation_constants"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o={TOGGLE:"[data-region=\"toggle\"]",CONVERSATION:"[data-conversation-id]",BLOCKED_ICON_CONTAINER:"[data-region=\"contact-icon-blocked\"]",LAST_MESSAGE:"[data-region=\"last-message\"]",LAST_MESSAGE_DATE:"[data-region=\"last-message-date\"]",MUTED_ICON_CONTAINER:"[data-region=\"muted-icon-container\"]",UNREAD_COUNT:"[data-region=\"unread-count\"]",SECTION_TOTAL_COUNT:"[data-region=\"section-total-count\"]",SECTION_TOTAL_COUNT_CONTAINER:"[data-region=\"section-total-count-container\"]",SECTION_UNREAD_COUNT:"[data-region=\"section-unread-count\"]",PLACEHOLDER_CONTAINER:"[data-region=\"placeholder-container\"]"},p={CONVERSATIONS_LIST:"core_message/message_drawer_conversations_list",CONVERSATIONS_LIST_ITEMS_PLACEHOLDER:"core_message/message_drawer_conversations_list_items_placeholder"},q=50,r={},s={},t=!1,u=!1,v=function(a){return m.getRoot(a).hasClass("show")},w=function(a){a.addClass("expanded")},x=function(a){a.removeClass("expanded")},y=function(a,b){var c=a.find(o.SECTION_TOTAL_COUNT_CONTAINER),d=c.find(o.SECTION_TOTAL_COUNT);d.text(b);c.removeClass("hidden");e.get_string("totalconversations","core_message",b).done(function(a){c.attr("aria-label",a)});var f=20<b?20:b,h=Array.apply(null,Array(f)).map(function(){return!0});g.render(p.CONVERSATIONS_LIST_ITEMS_PLACEHOLDER,{placeholders:h}).then(function(b){var c=a.find(o.PLACEHOLDER_CONTAINER);c.html(b)}).catch(function(){})},z=function(a,b){var c=a.find(o.SECTION_UNREAD_COUNT);c.text(b);e.get_string("unreadconversations","core_message",b).done(function(a){c.attr("aria-label",a)});if(0<b){c.removeClass("hidden")}},A=function(b){var c=function(b){return Object.keys(b).reduce(function(d,e){if(a.isArray(b[e])){d[e.toLowerCase()]=b[e].map(c)}else{d[e.toLowerCase()]=b[e]}return d},{})},d=c(b);d.messages=d.messages.map(function(a){a.useridfrom=a.userfrom.id;return a});return d},B=function(b,d){var h=new f,i=function(){var b=_asyncToGenerator(regeneratorRuntime.mark(function b(d){var f,h,i,j,k,l,m;return regeneratorRuntime.wrap(function(b){while(1){switch(b.prev=b.next){case 0:if(d){b.next=2;break}return b.abrupt("return",null);case 2:f=document.createElement("element");f.innerHTML=d.text.replace(/<img /g,"<noimg ");h=f.querySelector("[src]")||!1;if(h){b.next=10;break}i=a(d.text).text();if(!i){b.next=10;break}if(!(-1==i.indexOf("<"))){b.next=10;break}return b.abrupt("return",i);case 10:j="i/messagecontentmultimediageneral";k="messagecontentmultimediageneral";if(d.text.includes("<img")){j="i/messagecontentimage";k="messagecontentimage"}else if(d.text.includes("<video")){j="i/messagecontentvideo";k="messagecontentvideo"}else if(d.text.includes("<audio")){j="i/messagecontentaudio";k="messagecontentaudio"}b.prev=13;b.next=16;return e.get_string(k,"core_message");case 16:l=b.sent;b.next=19;return g.renderPix(j,"core",l);case 19:m=b.sent;return b.abrupt("return",m+" "+l);case 23:b.prev=23;b.t0=b["catch"](13);c.exception(b.t0);return b.abrupt("return",null);case 27:case"end":return b.stop();}}},b,null,[[13,23]])}));return function(){return b.apply(this,arguments)}}(),j=b.map(function(a){var b=a.messages.length?a.messages[a.messages.length-1]:null;return i(b).then(function(c){var e={id:a.id,imageurl:a.imageurl,name:a.name,subname:a.subname,unreadcount:a.unreadcount,ismuted:a.ismuted,lastmessagedate:b?b.timecreated:null,sentfromcurrentuser:b?b.useridfrom==d:null,lastmessage:c},f=null;if(a.type==n.CONVERSATION_TYPES.SELF){f=a.members[0]}else if(a.type==n.CONVERSATION_TYPES.PRIVATE){f=a.members.reduce(function(a,b){if(!a&&b.id!=d){a=b}return a},null)}if(null!==f){e.userid=f.id;e.showonlinestatus=f.showonlinestatus;e.isonline=f.isonline;e.isblocked=f.isblocked}if(a.type==n.CONVERSATION_TYPES.PUBLIC){e.lastsendername=a.members.reduce(function(a,c){if(!a&&b&&c.id==b.useridfrom){a=c.fullname}return a},null)}return e}).catch(c.exception)});return Promise.all(j).then(function(a){a.forEach(function(a){if(new Date().toDateString()==new Date(1e3*a.lastmessagedate).toDateString()){a.istoday=!0}});return g.render(p.CONVERSATIONS_LIST,{conversations:a})}).then(function(b,c){h.resolve();return a.Deferred().resolve(b,c)}).catch(function(a){h.resolve();c.exception(a)})},C=function(a,b,d){var e=null,f=!0;if(a&&a.length){var g=a.filter(function(a){return a!=n.CONVERSATION_TYPES.SELF});f=a.length!=g.length;e=g[0]}return function(a,g){return i.getConversations(g,e,q+1,d,b,f).then(function(b){var c=b.conversations;if(c.length>q){c=c.slice(0,-1)}else{m.setLoadedAll(a,!0)}d=d+q;c.forEach(function(a){r[a.id]=a});return c}).catch(c.exception)}},D=function(a){return a.find(o.SECTION_TOTAL_COUNT)},E=function(a){return a.find(o.SECTION_UNREAD_COUNT)},F=function(a){if(t){var b=D(a),c=parseInt(b.text());c=c+1;b.text(c)}},G=function(a){if(t){var b=D(a),c=parseInt(b.text());c=c-1;b.text(c)}},H=function(a){if(u){var b=E(a),c=parseInt(b.text());c=c-1;b.text(c);if(1>c){b.addClass("hidden")}}},I=function(a,b){return a.find("[data-conversation-id=\""+b+"\"]")},J=function(a,b){return a.find("[data-user-id=\""+b+"\"]")},K=function(a){a.find(o.MUTED_ICON_CONTAINER).removeClass("hidden")},L=function(a){a.find(o.MUTED_ICON_CONTAINER).addClass("hidden")},M=function(a){a.find(o.BLOCKED_ICON_CONTAINER).removeClass("hidden")},N=function(a){a.find(o.BLOCKED_ICON_CONTAINER).addClass("hidden")},O=function(a,b,d){var e=a.find(o.CONVERSATION);if(!e.length){var f=m.getRoot(a);m.showContent(f);m.hideEmptyMessage(f)}r[b.id]=b;return B([b],d).then(function(b){var c=m.getContentContainer(a);return c.prepend(b)}).then(function(){return F(a)}).catch(c.exception)},P=function(a,b){b.remove();G(a);var c=a.find(o.CONVERSATION);if(!c.length){var d=m.getRoot(a);m.hideContent(d);m.showEmptyMessage(d)}},Q=function(a,b){var c=b.find(o.UNREAD_COUNT);c.text("0");c.addClass("hidden");H(a)},R=function(g,h,i,n,p,q){var t=m.getRoot(h),u=function(a){var b=parseInt(a.type,10);if(n&&0>n.indexOf(b)||p&&!a.isFavourite||!p&&a.isFavourite){return!1}return!0},v=h.find(o.TOGGLE);h.css("min-height",v.outerHeight());h.on("show.bs.collapse",function(){w(h);m.show(t,i,function(a,b,d){return B(b,d).then(function(b){a.append(b);return b}).catch(c.exception)})});h.on("hidden.bs.collapse",function(){x(h)});d.subscribe(j.CONTACT_BLOCKED,function(a){var b=J(h,a);if(b.length){M(b)}});d.subscribe(j.CONTACT_UNBLOCKED,function(a){var b=J(h,a);if(b.length){N(b)}});d.subscribe(j.CONVERSATION_SET_MUTED,function(a){var b=a.id,c=I(h,b);if(c.length){K(c)}});d.subscribe(j.CONVERSATION_UNSET_MUTED,function(a){var b=a.id,c=I(h,b);if(c.length){L(c)}});d.subscribe(j.CONVERSATION_NEW_LAST_MESSAGE,function(a){if(!u(a)){return}var b=new f("core_message/message_drawer_view_overview_section:new"),d=a.loggedInUserId,e=a.id,g=I(h,e);a=A(a);if(g.length){var i=m.getContentContainer(h);B([a],d).then(function(b){if(s[e]){if(a.messages[0].timeadded<s[e]){return}}i.prepend(b);g.remove()}).then(b.resolve).catch(c.exception)}else if(a.messages.length){O(h,a,d).then(b.resolve).catch()}else{b.resolve()}});d.subscribe(j.CONVERSATION_DELETED,function(a){var b=I(h,a);delete r[a];s[a]=new Date;if(b.length){P(h,b)}});d.subscribe(j.CONVERSATION_READ,function(a){var b=I(h,a);if(b.length){Q(h,b)}});d.subscribe(j.CONVERSATION_SET_FAVOURITE,function(a){var b=null;if(u(a)){b=I(h,a.id);if(!b.length){O(h,A(a),a.loggedInUserId)}}else{b=I(h,a.id);if(b.length){P(h,b)}}});d.subscribe(j.CONVERSATION_UNSET_FAVOURITE,function(a){var b=null;if(u(a)){b=I(h,a.id);if(!b.length){O(h,A(a),a.loggedInUserId)}}else{b=I(h,a.id);if(b.length){P(h,b)}}});b.define(h,[b.events.activate]);h.on(b.events.activate,o.CONVERSATION,function(b,c){var d=a(b.target).closest(o.CONVERSATION),e=d.attr("data-conversation-id"),f=r[e];k.go(g,l.VIEW_CONVERSATION,f,q);c.originalEvent.preventDefault()})};return{show:function show(b,d,e,f,g,h,i,j,k){var l=a(e);if(!l.attr("data-init")){var n=C(g,h,0);R(b,l,n,g,h,k);if(v(l)){w(l);var o=m.getRoot(l);m.show(o,n,function(a,b,d){return B(b,d).then(function(b){a.append(b);return b}).catch(c.exception)})}i.then(function(a){y(l,a);t=!0}).catch(function(){});j.then(function(a){z(l,a);u=!0}).catch(function(){});l.attr("data-init",!0)}},isVisible:v}});
define ("core_message/message_drawer_view_contacts_section_contacts",["jquery","core/notification","core/pubsub","core/templates","core_message/message_repository","core_message/message_drawer_events","core_message/message_drawer_lazy_load_list"],function(a,b,c,d,e,f,g){var h={BLOCK_ICON_CONTAINER:"[data-region=\"block-icon-container\"]",CONTACT:"[data-region=\"contact\"]",CONTENT_CONTAINER:"[data-region=\"contacts-content-container\"]"},i={CONTACTS_LIST:"core_message/message_drawer_contacts_list"},j=function(a,b){return a.find("[data-contact-user-id=\""+b+"\"]")},k=function(c,e){var f=e.map(function(b){return a.extend(b,{id:b.userid})});return d.render(i.CONTACTS_LIST,{contacts:f}).then(function(a){c.append(a);return a}).catch(b.exception)},l=function(a){return function(c,d){return e.getContacts(d,101,a).then(function(a){return a}).then(function(a){if(a.length>100){a.pop()}else{g.setLoadedAll(c,!0)}return a}).then(function(b){a=a+100;return b}).catch(b.exception)}},m=function(a,b){j(a,b).remove()},n=function(a,b){var c=j(a,b);if(c.length){c.find(h.BLOCK_ICON_CONTAINER).removeClass("hidden")}},o=function(a,b){var c=j(a,b);if(c.length){c.find(h.BLOCK_ICON_CONTAINER).addClass("hidden")}},p=function(a){c.subscribe(f.CONTACT_ADDED,function(b){var c=g.getContentContainer(a);k(c,[b]);g.hideEmptyMessage(a);g.showContent(a)});c.subscribe(f.CONTACT_REMOVED,function(b){m(a,b);var c=a.find(h.CONTACT);if(!c.length){g.hideContent(a);g.showEmptyMessage(a)}});c.subscribe(f.CONTACT_BLOCKED,function(b){n(a,b)});c.subscribe(f.CONTACT_UNBLOCKED,function(b){o(a,b)})};return{show:function show(a){if(!a.attr("data-contacts-init")){p(a);a.attr("data-contacts-init",!0)}g.show(a,l(0),k)}}});
define ("core_message/message_drawer_view_contacts_section_requests",["jquery","core/notification","core/pubsub","core/templates","core_message/message_repository","core_message/message_drawer_events","core_message/message_drawer_lazy_load_list"],function(a,b,c,d,e,f,g){var h={CONTACT_REQUEST:"[data-region=\"contact-request\"]"},i={REQUESTS_LIST:"core_message/message_drawer_view_contacts_body_section_requests_list"},j=function(a,c){var e=c.map(function(a){return{id:a.id,profileimageurl:a.profileimageurl,fullname:a.fullname}});return d.render(i.REQUESTS_LIST,{requests:e}).then(function(b){a.append(b);return b}).catch(b.exception)},k=function(a,c){return e.getContactRequests(c).then(function(b){g.setLoadedAll(a,!0);return b}).catch(b.exception)},l=function(a){return function(b){a.find("[data-request-id=\""+b.userid+"\"]").remove();var c=a.find(h.CONTACT_REQUEST);if(!c.length){g.showEmptyMessage(a);g.hideContent(a)}}},m=function(a){c.subscribe(f.CONTACT_REQUEST_ACCEPTED,l(a));c.subscribe(f.CONTACT_REQUEST_DECLINED,l(a))};return{show:function show(a){if(!a.attr("data-contacts-init")){m(a);a.attr("data-contacts-init",!0)}g.show(a,k,j)}}});
define ("core_message/message_drawer_view_overview",["jquery","core/key_codes","core/pubsub","core/str","core_message/message_drawer_router","core_message/message_drawer_routes","core_message/message_drawer_events","core_message/message_drawer_view_overview_section","core_message/message_repository","core_message/message_drawer_view_conversation_constants"],function(a,b,c,d,e,f,g,h,i,j){var k={CONTACT_REQUEST_COUNT:"[data-region=\"contact-request-count\"]",FAVOURITES:"[data-region=\"view-overview-favourites\"]",GROUP_MESSAGES:"[data-region=\"view-overview-group-messages\"]",MESSAGES:"[data-region=\"view-overview-messages\"]",SEARCH_INPUT:"[data-region=\"view-overview-search-input\"]",SECTION_TOGGLE_BUTTON:"[data-toggle]"},l={PRIVATE:[j.CONVERSATION_TYPES.PRIVATE,j.CONVERSATION_TYPES.SELF],PUBLIC:[j.CONVERSATION_TYPES.PUBLIC],FAVOURITE:null},m=null,n=function(a){if(null===m){m=i.getAllConversationCounts(a)}return m},o=function(a,b,c){var d=0;if(b&&b.length){d=b.reduce(function(b,c){return b+a.types[c]},d)}if(c){d+=a.favourites}return d},p=function(a){var b=a.some(function(a){var b=a[0];return h.isVisible(b)});if(b){return}a.sort(function(c,a){var b=c[1],d=c[2],e=a[1],f=a[2];if(0<d&&0==f){return-1}else if(0==d&&0<f){return 1}else if(0<b&&0==e){return-1}else if(0==b&&0<e){return 1}else{return 0}});var c=a[0][0],d=c.find(k.SECTION_TOGGLE_BUTTON);d.click()},q=function(a){return a.find(k.SEARCH_INPUT)},r=function(a){return a.attr("data-user-id")},s=function(a){return function(){var b=a.find(k.CONTACT_REQUEST_COUNT),c=parseInt(b.text(),10);c=isNaN(c)?0:c-1;if(0>=c){b.addClass("hidden")}else{b.text(c)}}},t=function(a,d){var h=q(d),i=[b.tab,b.shift,b.ctrl,b.alt];h.on("click",function(){e.go(a,f.VIEW_SEARCH)});h.on("keydown",function(b){if(0>i.indexOf(b.keyCode)&&"Meta"!=b.key){e.go(a,f.VIEW_SEARCH)}});c.subscribe(g.CONTACT_REQUEST_ACCEPTED,s(d));c.subscribe(g.CONTACT_REQUEST_DECLINED,s(d))};return{show:function show(a,b,c){if(!b.attr("data-init")){t(a,b);b.attr("data-init",!0)}var d=b.attr("data-in-panel")?"frompanel":null;q(b).val("");var e=r(c),f=n(e),g=[[c.find(k.FAVOURITES),l.FAVOURITE,!0],[c.find(k.GROUP_MESSAGES),l.PUBLIC,!1],[c.find(k.MESSAGES),l.PRIVATE,!1]];g.forEach(function(b){var c=b[0],e=b[1],g=b[2],i=f.then(function(a){return o(a.total,e,g)}),j=f.then(function(a){return o(a.unread,e,g)});h.show(a,null,c,null,e,g,i,j,d)});return f.then(function(a){var b=g.map(function(b){var c=b[0],d=b[1],e=b[2],f=o(a.total,d,e),g=o(a.unread,d,e);return[c,f,g]});return p(b)})},description:function description(){return d.get_string("messagedrawerviewoverview","core_message")}}});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}define ("core_message/message_drawer_view_conversation",["jquery","core/auto_rows","core/backoff_timer","core/custom_interaction_events","core/notification","core/pending","core/pubsub","core/str","core_message/message_repository","core_message/message_drawer_events","core_message/message_drawer_view_conversation_constants","core_message/message_drawer_view_conversation_patcher","core_message/message_drawer_view_conversation_renderer","core_message/message_drawer_view_conversation_state_manager","core_message/message_drawer_router","core_message/message_drawer_routes","core/emoji/auto_complete","core/emoji/picker"],function(s,e,t,n,a,d,r,i,o,g,l,m,c,_,E,u,C,I){var v={},h=null,f=!1,T=0,A=null,p=!1,O=[],M=!0,S=!1,N=!1,b=[],R=null,U=[],L=l.NEWEST_MESSAGES_FIRST,D=l.LOAD_MESSAGE_LIMIT,w=l.MILLISECONDS_IN_SEC,y=l.SELECTORS,P=l.CONVERSATION_TYPES,B=function(){if(!h||h.type==P.PUBLIC){return null}var e=h.loggedInUserId;if(h.type==P.SELF){return e}var s=Object.keys(h.members).filter(function(s){return e!=s});return s.length?s[0]:null},F=function(e){return Object.keys(v).reduce(function(s,t){if(!s){var n=v[t].state;if(n.type!=P.PUBLIC){if(e in n.members){s=n.id}}}return s},null)},k=function(e){return{id:parseInt(e.attr("data-user-id"),10),fullname:null,profileimageurl:null,profileimageurlsmall:null,isonline:null,showonlinestatus:null,isblocked:null,iscontact:null,isdeleted:null,canmessage:null,canmessageevenifblocked:null,requirescontact:null,contactrequests:[]}},V=function(){return T},x=function(e){T=e;v[h.id].messagesOffset=e},G=function(){return f},q=function(e){f=e;v[h.id].loadedAllMessages=e},j=function(e){return e.find(y.MESSAGES_CONTAINER)},K=function(e){return{id:e.id,name:e.name,subname:e.subname,imageUrl:e.imageUrl,isFavourite:e.isFavourite,isMuted:e.isMuted,type:e.type,totalMemberCount:e.totalMemberCount,loggedInUserId:e.loggedInUserId,messages:e.messages.map(function(e){return s.extend({},e)}),members:Object.keys(e.members).map(function(t){var n=s.extend({},e.members[t]);n.contactrequests=e.members[t].contactrequests.map(function(e){return s.extend({},e)});return n})}},Q=function(e,s){var t=e.id,n=t==s?P.SELF:P.PRIVATE,d=_.setLoadingMembers(h,!0);d=_.setLoadingMessages(d,!0);R(d);return o.getMemberInfo(t,[s],!0,!0).then(function(e){if(e.length){return e[0]}else{throw new Error("Unable to load other user profile")}}).then(function(s){var t=n==P.SELF?[s]:[s,e],a=_.addMembers(h,t);a=_.setLoadingMembers(a,!1);a=_.setLoadingMessages(a,!1);a=_.setName(a,s.fullname);a=_.setType(a,n);a=_.setImageUrl(a,s.profileimageurl);a=_.setTotalMemberCount(a,t.length);R(a);return s}).catch(function(e){var s=_.setLoadingMembers(h,!1);R(s);a.exception(e)})},W=function(e,s){var t=null;if(e.type==P.PRIVATE){var n=e.members.filter(function(e){return e.id!=s});t=n.length?n[0]:null}else if(e.type==P.SELF){t=e.members[0]}var a=e.name,d=e.imageurl;if(e.type!=P.PUBLIC){a=a||t?t.fullname:"";d=d||t?t.profileimageurl:""}var r=_.addMembers(h,e.members);r=_.setName(r,a);r=_.setSubname(r,e.subname);r=_.setType(r,e.type);r=_.setImageUrl(r,d);r=_.setTotalMemberCount(r,e.membercount);r=_.setIsFavourite(r,e.isfavourite);r=_.setIsMuted(r,e.ismuted);r=_.addMessages(r,e.messages);r=_.setCanDeleteMessagesForAllUsers(r,e.candeletemessagesforallusers);return r},J=function(e,s,t,n,d){var r=s.id,i=_.setLoadingMembers(h,!0);i=_.setLoadingMessages(i,!0);R(i);return o.getConversation(r,e,!0,!0,0,0,t+1,n,d).then(function(e){if(e.messages.length>t){e.messages=e.messages.slice(1)}else{q(!0)}x(n+t);return e}).then(function(e){var t=e.members.filter(function(e){return e.id==s.id});if(1>t.length){e.members=e.members.concat([s])}var n=W(e,s.id);n=_.setLoadingMembers(n,!1);n=_.setLoadingMessages(n,!1);return R(n).then(function(){return e})}).then(function(){return z(e)}).catch(function(e){var s=_.setLoadingMembers(h,!1);s=_.setLoadingMessages(s,!1);R(s);a.exception(e)})},X=function(e,s,t,n){var d=e.members.filter(function(e){return e.id==s.id});if(1>d.length){e.members=e.members.concat([s])}var r=e.messages.length,i=r>=t,o=W(e,s.id);o=_.setLoadingMembers(o,!1);o=_.setLoadingMessages(o,!i);var g=R(o);return g.then(function(){if(!i){return Y(e.id,t,r,n,[])}else{return{messages:e.messages}}}).then(function(){var e=h.messages;x(e.length);z(h.id);return e}).catch(a.exception)},Y=function(e,s,t,n,a,d){return o.getMessages(h.loggedInUserId,e,s?s+1:s,t,n,d).then(function(e){if(e.id!=h.id){e.messages=[];if(e.id in v){delete v[e.id]}}return e}).then(function(e){if(e.messages.length&&a.length){e.messages=e.messages.filter(function(e){return 0>a.indexOf(parseInt(e.id,10))})}return e}).then(function(e){if(!s){return e}else if(e.messages.length>s){e.messages=e.messages.slice(0,-1)}else{q(!0)}return e}).then(function(e){var s=e.members.filter(function(e){return!(e.id in h.members)}),t=_.addMembers(h,s);t=_.addMessages(t,e.messages);t=_.setLoadingMessages(t,!1);return R(t).then(function(){return e})}).catch(function(e){var s=_.setLoadingMessages(h,!1);R(s);throw e})},H=function(e,t){return function(){var n=h.messages,a=n.length?n[n.length-1]:null,d=a?a.timeCreated:null;if(d&&!M&&!S&&!N){for(var o=[],l=n.length-1,m;0<=l;l--){m=n[l];if(m.timeCreated===d){o.push(m.id)}else{break}}return Y(e,0,0,t,o,d).then(function(s){if(s.messages.length){A.restart();var t=K(h);r.publish(g.CONVERSATION_NEW_LAST_MESSAGE,t);return z(e)}else{return s}})}return s.Deferred().resolve().promise()}},z=function(e){var s=h.loggedInUserId,t=new d("core_message/message_drawer_view_conversation:markConversationAsRead");return o.markAllConversationMessagesAsRead(s,e).then(function(){var s=_.markMessagesAsRead(h,h.messages);r.publish(g.CONVERSATION_READ,e);return R(s)}).then(function(e){t.resolve();return e})},Z=function(e){Ee(e);var s=_.addPendingBlockUsersById(h,[e]);R(s)},$=function(e){var s=_.setLoadingConfirmAction(h,!0),t=new d("core_message/message_drawer_view_conversation:blockUser");R(s);return o.blockUser(h.loggedInUserId,e).then(function(s){var t=_.addMembers(h,[s]);t=_.removePendingBlockUsersById(t,[e]);t=_.setLoadingConfirmAction(t,!1);r.publish(g.CONTACT_BLOCKED,e);return R(t)}).then(function(e){t.resolve();return e})},ee=function(e){Ee(e);var s=_.addPendingUnblockUsersById(h,[e]);R(s)},se=function(e){var s=_.setLoadingConfirmAction(h,!0),t=new d("core_message/message_drawer_view_conversation:unblockUser");R(s);return o.unblockUser(h.loggedInUserId,e).then(function(s){var t=_.addMembers(h,[s]);t=_.removePendingUnblockUsersById(t,[e]);t=_.setLoadingConfirmAction(t,!1);r.publish(g.CONTACT_UNBLOCKED,e);return R(t)}).then(function(e){t.resolve();return e})},te=function(e){Ee(e);var s=_.addPendingRemoveContactsById(h,[e]);R(s)},ne=function(e){var s=_.setLoadingConfirmAction(h,!0),t=new d("core_message/message_drawer_view_conversation:removeContact");R(s);return o.deleteContacts(h.loggedInUserId,[e]).then(function(s){var t=_.addMembers(h,s);t=_.removePendingRemoveContactsById(t,[e]);t=_.setLoadingConfirmAction(t,!1);r.publish(g.CONTACT_REMOVED,e);return R(t)}).then(function(e){t.resolve();return e})},ae=function(e){Ee(e);var s=_.addPendingAddContactsById(h,[e]);R(s)},de=function(e){var s=_.setLoadingConfirmAction(h,!0),t=new d("core_message/message_drawer_view_conversation:addContactRequests");R(s);return o.createContactRequest(h.loggedInUserId,e).then(function(e){if(!e.request){throw new Error(e.warnings[0].message)}return e.request}).then(function(s){var t=_.removePendingAddContactsById(h,[e]);t=_.addContactRequests(t,[s]);t=_.setLoadingConfirmAction(t,!1);return R(t)}).then(function(e){t.resolve();return e})},re=function(){var e=h.loggedInUserId,s=h.id,t=new d("core_message/message_drawer_view_conversation:setFavourite");return o.setFavouriteConversations(e,[s]).then(function(){var e=_.setIsFavourite(h,!0);return R(e)}).then(function(){return r.publish(g.CONVERSATION_SET_FAVOURITE,K(h))}).then(function(e){t.resolve();return e})},ie=function(){var e=h.loggedInUserId,s=h.id,t=new d("core_message/message_drawer_view_conversation:unsetFavourite");return o.unsetFavouriteConversations(e,[s]).then(function(){var e=_.setIsFavourite(h,!1);return R(e)}).then(function(){return r.publish(g.CONVERSATION_UNSET_FAVOURITE,K(h))}).then(function(e){t.resolve();return e})},oe=function(){var e=h.loggedInUserId,s=h.id,t=new d("core_message/message_drawer_view_conversation:markConversationAsRead");return o.setMutedConversations(e,[s]).then(function(){var e=_.setIsMuted(h,!0);return R(e)}).then(function(){return r.publish(g.CONVERSATION_SET_MUTED,K(h))}).then(function(e){t.resolve();return e})},ge=function(){var e=h.loggedInUserId,s=h.id;return o.unsetMutedConversations(e,[s]).then(function(){var e=_.setIsMuted(h,!1);return R(e)}).then(function(){return r.publish(g.CONVERSATION_UNSET_MUTED,K(h))})},le=function(e){var s=h.selectedMessageIds;Ee(e);var t=_.addPendingDeleteMessagesById(h,s);R(t)},me=function(){var e=new d("core_message/message_drawer_view_conversation:deleteSelectedMessages"),t=h.pendingDeleteMessageIds,n=h.messages.filter(function(e){return 0<=t.indexOf(e.id)&&("sent"==e.sendState||null===e.sendState)}),i=_.setLoadingConfirmAction(h,!0);R(i);var l=s.Deferred().resolve().promise();if(n.length){var m=n.map(function(e){return e.id});if(i.deleteMessagesForAllUsers){l=o.deleteMessagesForAllUsers(h.loggedInUserId,m)}else{l=o.deleteMessages(h.loggedInUserId,m)}}N=!0;if(A){A.stop()}return l.then(function(){var e=_.removeMessagesById(h,t);e=_.removePendingDeleteMessagesById(e,t);e=_.removeSelectedMessagesById(e,t);e=_.setLoadingConfirmAction(e,!1);e=_.setDeleteMessagesForAllUsers(e,!1);var s=h.messages[h.messages.length-1],n=e.messages.length?e.messages[e.messages.length-1]:null;if(n&&n.id!=s.id){var a=K(e);r.publish(g.CONVERSATION_NEW_LAST_MESSAGE,a)}else if(!e.messages.length){r.publish(g.CONVERSATION_DELETED,e.id)}N=!1;return R(e)}).then(function(s){e.resolve();return s}).catch(a.exception)},ce=function(e){Ee(e);var s=_.setPendingDeleteConversation(h,!0);R(s)},_e=function(){var e=new d("core_message/message_drawer_view_conversation:markConversationAsRead"),s=_.setLoadingConfirmAction(h,!0);R(s);N=!0;if(A){A.stop()}return o.deleteConversation(h.loggedInUserId,h.id).then(function(){var e=_.removeMessages(h,h.messages);e=_.removeSelectedMessagesById(e,h.selectedMessageIds);e=_.setPendingDeleteConversation(e,!1);e=_.setLoadingConfirmAction(e,!1);r.publish(g.CONVERSATION_DELETED,e.id);N=!1;return R(e)}).then(function(s){e.resolve();return s})},Ee=function(e){var s=h.pendingDeleteMessageIds,t=_.removePendingAddContactsById(h,[e]);t=_.removePendingRemoveContactsById(t,[e]);t=_.removePendingUnblockUsersById(t,[e]);t=_.removePendingBlockUsersById(t,[e]);t=_.removePendingDeleteMessagesById(t,s);t=_.setPendingDeleteConversation(t,!1);t=_.setDeleteMessagesForAllUsers(t,!1);R(t)},ue=function(e){var s=new d("core_message/message_drawer_view_conversation:acceptContactRequest"),t=h.loggedInUserId,n=h.members[e].contactrequests.filter(function(e){return e.requesteduserid==t}),a=n[0],i=_.setLoadingConfirmAction(h,!0);R(i);return o.acceptContactRequest(e,t).then(function(e){var s=_.removeContactRequests(h,[a]);s=_.addMembers(h,[e]);s=_.setLoadingConfirmAction(s,!1);return R(s)}).then(function(){r.publish(g.CONTACT_ADDED,h.members[e]);r.publish(g.CONTACT_REQUEST_ACCEPTED,a)}).then(function(e){s.resolve();return e})},Ce=function(e){var s=new d("core_message/message_drawer_view_conversation:declineContactRequest"),t=h.loggedInUserId,n=h.members[e].contactrequests.filter(function(e){return e.requesteduserid==t}),a=n[0],i=_.setLoadingConfirmAction(h,!0);R(i);return o.declineContactRequest(e,t).then(function(e){var s=_.removeContactRequests(h,[a]);s=_.addMembers(h,[e]);s=_.setLoadingConfirmAction(s,!1);return R(s)}).then(function(){r.publish(g.CONTACT_REQUEST_DECLINED,a)}).then(function(e){s.resolve();return e})},Ie=function(){if(S){return}if(!b.length){return}var e=new d("core_message/message_drawer_view_conversation:processSendMessageBuffer");S=!0;var t=b.slice();b=[];var n=h.id,a=null,l=t.map(function(e){return e.text}),m=t.map(function(e){return e.id}),c=null,E=null;if(!n&&h.type!=P.PUBLIC){var u=B();c=o.sendMessagesToUser(u,l).then(function(e){if(e.length){a=parseInt(e[0].conversationid,10);E=e[0].candeletemessagesforallusers}return e})}else{c=o.sendMessagesToConversation(n,l)}c.then(function(e){var s=e.map(function(e){return e.id}),n=[],d=[],i=[];t.forEach(function(s,t){var a=e[t];n.push([s,a]);if(0<=h.selectedMessageIds.indexOf(s.id)){d.push(s.id);i.push(a.id)}});var o=_.updateMessages(h,n);o=_.setMessagesSendSuccessById(o,s);if(d.length){o=_.removeSelectedMessagesById(o,d)}if(i.length){o=_.addSelectedMessagesById(o,i)}var l=K(o);if(!o.id){o=_.setId(o,a);l.id=a;xe(a);r.publish(g.CONVERSATION_CREATED,l);o=_.setCanDeleteMessagesForAllUsers(o,E)}R(o);S=!1;Ie();r.publish(g.CONVERSATION_NEW_LAST_MESSAGE,l)}).then(function(s){e.resolve();return s}).catch(function(t){var n;if(t.message){n=s.Deferred().resolve(t.message).promise()}else{n=i.get_string("unknownerror","core")}var a=function(e){var s=_.setMessagesSendFailById(h,m,e);R(s);S=!1;Ie()};n.then(a).then(function(s){e.resolve();return s}).catch(function(s){var e=s.message||"Something went wrong!";a(e)})})},ve=function(e){var s=e.replace(/<style([\s\S]*?)<\/style>/gi,"");s=s.replace(/<script([\s\S]*?)<\/script>/gi,"");s=s.replace(/<\/div>/ig,"\n");s=s.replace(/<\/li>/ig,"\n");s=s.replace(/<li>/ig,"  *  ");s=s.replace(/<\/ul>/ig,"\n");s=s.replace(/<\/p>/ig,"\n");s=s.replace(/<br[^>]*>/gi,"\n");s=s.replace(/<[^>]+>/ig,"");s=s.replace(/\n+/ig,"\n");return s.replace(/\n/ig,"<br>")},he=function(e){var s="temp"+Date.now(),t={id:s,useridfrom:h.loggedInUserId,text:ve(e),timecreated:null},n=_.addMessages(h,[t]);R(n);var a={id:s,useridfrom:h.loggedInUserId,text:e,timecreated:null};b.push(a);Ie()},fe=function(e){var s=_.setMessagesSendPendingById(h,[e.id]);R(s);b.push(e);Ie()},Te=function(e){var s=h;if(-1<h.selectedMessageIds.indexOf(e)){s=_.removeSelectedMessagesById(h,[e])}else{s=_.addSelectedMessagesById(h,[e])}R(s)},Ae=function(){Ee(B());var e=_.removeSelectedMessagesById(h,h.selectedMessageIds);R(e)},pe=function(e,t,n){if(p){return}if(!O.length){return}p=!0;var d=O.shift(),r=U.map(function(e){return e(d.patch)});s.when.apply(null,r).then(function(){p=!1;d.deferred.resolve(!0);pe(e,t,n)}).catch(function(e){p=!1;d.deferred.reject(e);a.exception(e)})},Oe=function(e,t,n,a){var d=function(s){return c.render(e,t,n,s)};if(!a){var r=_.buildInitialState(h.midnight,h.loggedInUserId,h.id),i=m.buildPatch(r,h);d(i)}U.push(d);return function(a){var d=m.buildPatch(h,a),r=s.Deferred();if(Object.keys(d).length){O.push({patch:d,deferred:r})}else{r.resolve(!0)}h=a;if(a.id){v[a.id]={state:a,messagesOffset:V(),loadedAllMessages:G()}}pe(e,t,n);return r.promise()}},Me=function(e){return function(s,t){if(!h.loadingConfirmAction){e(B());var n=_.setLoadingConfirmAction(h,!1);R(n)}t.originalEvent.preventDefault()}},Se=function(t,e){var n=s(t.target),a=n.closest(y.FOOTER_CONTAINER),d=a.find(y.MESSAGE_TEXT_AREA),r=d.val().trim();if(""!==r){he(r);d.val("");d.focus()}e.originalEvent.preventDefault()},Ne=function(t,e){var n=window.getSelection(),a=s(t.target);if(""!=n.toString()){return}if(a.is("a")){return}var d=a.closest(y.MESSAGE),r=d.attr("data-message-id");Te(r);e.originalEvent.preventDefault()},be=function(t,e){var n=s(t.target),a=n.closest(y.MESSAGE),d=a.attr("data-message-id"),r=h.messages.filter(function(e){return e.id==d}),i=r.length?r[0]:null;if(i){fe(i)}e.originalEvent.preventDefault();e.originalEvent.stopPropagation();t.stopPropagation()},Re=function(s,e){Ae();e.originalEvent.preventDefault()},Ue=function(s){return function(t,e){var n=B(),a=h.members[n];E.go(s,u.VIEW_CONTACT,a);e.originalEvent.preventDefault()}},Le=function(s,e){re().catch(a.exception);e.originalEvent.preventDefault()},De=function(s,e){ie().catch(a.exception);e.originalEvent.preventDefault()},we=function(s,e){oe().catch(a.exception);e.originalEvent.preventDefault()},ye=function(s,e){ge().catch(a.exception);e.originalEvent.preventDefault()},Pe=function(t){var e=s(t.target).prop("checked"),n=_.setDeleteMessagesForAllUsers(h,e);R(n)},Be=function(s){return function(t,e){E.go(s,u.VIEW_GROUP_INFO,{id:h.id,name:h.name,subname:h.subname,imageUrl:h.imageUrl,totalMemberCount:h.totalMemberCount},h.loggedInUserId);e.originalEvent.preventDefault()}},Fe=function(s,e){var t=_.setShowEmojiPicker(h,!h.showEmojiPicker);R(t);e.originalEvent.preventDefault()},ke=function(t){var e=s(t.target);if(h.showEmojiPicker&&!e.closest(y.EMOJI_PICKER_CONTAINER).length&&!e.closest(y.TOGGLE_EMOJI_PICKER_BUTTON).length){var n=_.setShowEmojiPicker(h,!1);R(n)}},Ve=function(t,d,i,o){var l=!1,m=j(i),c=o.find(y.EMOJI_PICKER),E=o.find(y.EMOJI_AUTO_COMPLETE_CONTAINER),v=o.find(y.MESSAGE_TEXT_AREA),f=[[y.ACTION_REQUEST_BLOCK,Me(Z)],[y.ACTION_REQUEST_UNBLOCK,Me(ee)],[y.ACTION_REQUEST_ADD_CONTACT,Me(ae)],[y.ACTION_REQUEST_REMOVE_CONTACT,Me(te)],[y.ACTION_REQUEST_DELETE_CONVERSATION,Me(ce)],[y.ACTION_CANCEL_EDIT_MODE,Re],[y.ACTION_VIEW_CONTACT,Ue(t)],[y.ACTION_VIEW_GROUP_INFO,Be(t)],[y.ACTION_CONFIRM_FAVOURITE,Le],[y.ACTION_CONFIRM_MUTE,we],[y.ACTION_CONFIRM_UNFAVOURITE,De],[y.ACTION_CONFIRM_UNMUTE,ye]],T=[[y.ACTION_CANCEL_CONFIRM,Me(Ee)],[y.ACTION_CONFIRM_BLOCK,Me($)],[y.ACTION_CONFIRM_UNBLOCK,Me(se)],[y.ACTION_CONFIRM_ADD_CONTACT,Me(de)],[y.ACTION_CONFIRM_REMOVE_CONTACT,Me(ne)],[y.ACTION_CONFIRM_DELETE_SELECTED_MESSAGES,Me(me)],[y.ACTION_CONFIRM_DELETE_CONVERSATION,Me(_e)],[y.ACTION_OKAY_CONFIRM,Me(Ee)],[y.ACTION_REQUEST_ADD_CONTACT,Me(ae)],[y.ACTION_ACCEPT_CONTACT_REQUEST,Me(ue)],[y.ACTION_DECLINE_CONTACT_REQUEST,Me(Ce)],[y.MESSAGE,Ne],[y.DELETE_MESSAGES_FOR_ALL_USERS_TOGGLE,Pe],[y.RETRY_SEND,be]],p=[[y.SEND_MESSAGE_BUTTON,Se],[y.TOGGLE_EMOJI_PICKER_BUTTON,Fe],[y.ACTION_REQUEST_DELETE_SELECTED_MESSAGES,Me(le)],[y.ACTION_REQUEST_ADD_CONTACT,Me(ae)],[y.ACTION_REQUEST_UNBLOCK,Me(ee)]];e.init(o);if(E.length){C(E[0],v[0],function(e){var s=_.setShowEmojiAutoComplete(h,e);R(s)},function(e){var s=_.setShowEmojiAutoComplete(h,!1);R(s);v.focus();var t=v.prop("selectionStart"),n=v.val(),a=n.substring(0,t).replace(/\S*$/,""),d=n.substring(t).replace(/^\S*/,"");v.val(a+e+d);v.prop("selectionStart",a.length+e.length);v.prop("selectionEnd",a.length+e.length)})}if(c.length){I(c[0],function(e){var s=_.setShowEmojiPicker(h,!h.showEmojiPicker);R(s);v.focus();var t=v.prop("selectionStart"),n=v.val(),a=n.substring(0,t),d=n.substring(t,n.length);v.val(a+e+d);v.prop("selectionStart",t+e.length);v.prop("selectionEnd",t+e.length)})}n.define(d,[n.events.activate]);n.define(i,[n.events.activate]);n.define(o,[n.events.activate,n.events.enter,n.events.escape]);n.define(m,[n.events.scrollTop,n.events.scrollLock]);m.on(n.events.scrollTop,function(s,e){var t=1<Object.keys(h.members).length;if(!M&&!l&&!G()&&t){l=!0;var n=_.setLoadingMessages(h,!0);R(n);Y(h.id,D,V(),L,[]).then(function(){l=!1;x(V()+D)}).catch(function(e){l=!1;a.exception(e)})}e.originalEvent.preventDefault()});f.forEach(function(e){var s=e[0],t=e[1];d.on(n.events.activate,s,t)});T.forEach(function(e){var s=e[0],t=e[1];i.on(n.events.activate,s,t)});p.forEach(function(e){var s=e[0],t=e[1];o.on(n.events.activate,s,t)});o.on(n.events.enter,y.MESSAGE_TEXT_AREA,function(s,e){var t=o.attr("data-enter-to-send");if(t&&"false"!=t&&"0"!=t){Se(s,e)}});o.on(n.events.escape,y.EMOJI_PICKER_CONTAINER,Fe);s(document.body).on("click",ke);r.subscribe(g.ROUTE_CHANGED,function(e){if(A){if(e.route!=u.VIEW_CONVERSATION){A.stop()}}})},xe=function(e){if(A){A.stop()}A=new t(H(e,L),t.getIncrementalCallback(h.messagePollMin*w,w,h.messagePollMax*w,h.messagePollAfterMax*w));A.start()},Ge=function(e,s,t){if(A){A.stop()}f=!1;T=0;A=null;p=!1;O=[];M=!0;S=!1;N=!1;b=[];var n=t.id,a=parseInt(e.attr("data-midnight"),10),d=parseInt(e.attr("data-message-poll-min"),10),r=parseInt(e.attr("data-message-poll-max"),10),i=parseInt(e.attr("data-message-poll-after-max"),10),o=_.buildInitialState(a,n,s,d,r,i);if(!h){h=o}R(o)},qe=function(e,s,t){Ge(e,null,s);var n=null;if(s.id!=t){n=o.getConversationBetweenUsers(s.id,t,!0,!0,0,0,D,0,L)}else{n=o.getSelfConversation(s.id,D,0,L)}return n.then(function(t){return Ke(e,t,s)}).catch(function(){return Q(s,t)})},je=function(e,t,n){var a=null;if(t in v){a=v[t]}Ge(e,t,n);var d=s.Deferred().resolve({}).promise();if(a){var r=a.state;r=_.setLoadingMessages(r,!1);r=_.setLoadingMembers(r,!1);x(a.messagesOffset);q(a.loadedAllMessages);R(r)}else{d=J(t,n,D,0,L)}return d.then(function(){return xe(t)})},Ke=function(e,t,n){var a=null;if(t.id in v){a=v[t.id]}Ge(e,t.id,n);var d=s.Deferred().resolve({}).promise();if(a){var r=a.state;r=_.setLoadingMessages(r,!1);r=_.setLoadingMembers(r,!1);x(a.messagesOffset);q(a.loadedAllMessages);R(r)}else{d=X(t,n,D,L)}return d.then(function(){return xe(t.id)})},Qe=function(e,t,n,d,r,i,o){var g=null,m=null;if(r&&null!==r&&"object"==_typeof(r)){g=r;m=parseInt(g.id,10)}else{g=null;m=parseInt(r,10);m=isNaN(m)?null:m}if(!m&&i&&o){m=F(o)}var c=!h||h.id!=m||o&&o!=B();if(!n.attr("data-init")){R=Oe(t,n,d,c);Ve(e,t,n,d);n.attr("data-init",!0)}if(c){var _=null,E=k(n);if(g){_=Ke(n,g,E,o)}else if(m){_=je(n,m,E,o)}else{_=qe(n,E,o)}return _.then(function(){M=!1;t.find(l.SELECTORS.CAN_RECEIVE_FOCUS).first().focus()}).catch(function(e){M=!1;a.exception(e)})}xe(m);if(h.type==P.PRIVATE&&i){var u=B();switch(i){case"block":return Z(u);case"unblock":return ee(u);case"add-contact":return ae(u);case"remove-contact":return te(u);}}return s.Deferred().resolve().promise()},We=function(){return i.get_string("messagedrawerviewconversation","core_message",h.name)};return{show:Qe,description:We}});
define ("core_message/message_repository",["jquery","core/ajax","core/notification","core_message/message_drawer_view_conversation_constants"],function(a,b,c,d){var e=d.CONVERSATION_TYPES,f=function(a,c){var d=c.map(function(b){return{touserid:a,text:b}});return b.call([{methodname:"core_message_send_instant_messages",args:{messages:d}}])[0].then(function(a){var b=a.reduce(function(a,b){if(b.errormessage){a.push(b.errormessage)}return a},[]);if(b.length){throw new Error(b.join("\n"))}return a}).then(function(a){return a.map(function(a){return{id:a.msgid,text:a.text,timecreated:a.timecreated,useridfrom:a.useridfrom,conversationid:a.conversationid,candeletemessagesforallusers:a.candeletemessagesforallusers}})})},g=function(a,c){var d=c.map(function(a){return{text:a}});return b.call([{methodname:"core_message_send_messages_to_conversation",args:{conversationid:a,messages:d}}])[0]};return{query:function query(a){if("undefined"==typeof a.limit){a.limit=0}if("undefined"==typeof a.offset){a.offset=0}if("undefined"==typeof a.type){a.type=null}if("undefined"==typeof a.favouritesonly){a.favouritesonly=!1}a.limitfrom=a.offset;a.limitnum=a.limit;delete a.limit;delete a.offset;var d=b.call([{methodname:"core_message_data_for_messagearea_conversations",args:a}])[0];d.fail(c.exception);return d},countUnreadConversations:function countUnreadConversations(a){var d=b.call([{methodname:"core_message_get_unread_conversations_count",args:a}])[0];d.fail(c.exception);return d},markAllAsRead:function markAllAsRead(a){var d=b.call([{methodname:"core_message_mark_all_messages_as_read",args:a}])[0];d.fail(c.exception);return d},getContacts:function getContacts(a,c,d){var e={userid:a};if("undefined"!=typeof c){e.limitnum=c}if("undefined"!=typeof d){e.limitfrom=d}return b.call([{methodname:"core_message_get_user_contacts",args:e}])[0]},getProfile:function getProfile(a,c){return b.call([{methodname:"core_message_data_for_messagearea_get_profile",args:{currentuserid:a,otheruserid:c}}])[0]},blockUser:function blockUser(c,d){return a.when.apply(null,b.call([{methodname:"core_message_block_user",args:{userid:c,blockeduserid:d}},{methodname:"core_message_get_member_info",args:{referenceuserid:c,userids:[d],includecontactrequests:!0,includeprivacyinfo:!0}}])).then(function(a,b){return b.length?b[0]:{}})},unblockUser:function unblockUser(c,d){return a.when.apply(null,b.call([{methodname:"core_message_unblock_user",args:{userid:c,unblockeduserid:d}},{methodname:"core_message_get_member_info",args:{referenceuserid:c,userids:[d],includecontactrequests:!0,includeprivacyinfo:!0}}])).then(function(a,b){return b.length?b[0]:{}})},createContactRequest:function createContactRequest(a,c){return b.call([{methodname:"core_message_create_contact_request",args:{userid:a,requesteduserid:c}}])[0]},deleteContacts:function deleteContacts(c,d){return a.when.apply(null,b.call([{methodname:"core_message_delete_contacts",args:{userid:c,userids:d}},{methodname:"core_message_get_member_info",args:{referenceuserid:c,userids:d,includecontactrequests:!0,includeprivacyinfo:!0}}])).then(function(a,b){return b})},getMessages:function getMessages(a,c,d,e,f,g){var h={currentuserid:a,convid:c,newest:f?!0:!1};if("undefined"!=typeof d){h.limitnum=d}if("undefined"!=typeof e){h.limitfrom=e}if("undefined"!=typeof g){h.timefrom=g}return b.call([{methodname:"core_message_get_conversation_messages",args:h}])[0]},searchUsers:function searchUsers(a,c,d,e){var f={userid:a,search:c};if("undefined"!=typeof d){f.limitnum=d}if("undefined"!=typeof e){f.limitfrom=e}return b.call([{methodname:"core_message_message_search_users",args:f}])[0]},searchMessages:function searchMessages(a,c,d,e){var f={userid:a,search:c};if("undefined"!=typeof d){f.limitnum=d}if("undefined"!=typeof e){f.limitfrom=e}return b.call([{methodname:"core_message_data_for_messagearea_search_messages",args:f}])[0]},sendMessagesToUser:f,sendMessageToUser:function sendMessageToUser(a,b){return f(a,[b]).then(function(a){return a[0]})},sendMessagesToConversation:g,sendMessageToConversation:function sendMessageToConversation(a,b){return g(a,[b]).then(function(a){return a[0]})},savePreferences:function savePreferences(a,c){return b.call([{methodname:"core_user_update_user_preferences",args:{userid:a,preferences:c}}])[0]},getPreferences:function getPreferences(a){return b.call([{methodname:"core_user_get_user_preferences",args:{userid:a}}])[0]},deleteMessages:function deleteMessages(c,d){return a.when.apply(null,b.call(d.map(function(a){return{methodname:"core_message_delete_message",args:{messageid:a,userid:c}}})))},deleteMessagesForAllUsers:function deleteMessagesForAllUsers(c,d){return a.when.apply(null,b.call(d.map(function(a){return{methodname:"core_message_delete_message_for_all_users",args:{messageid:a,userid:c}}})))},deleteConversation:function deleteConversation(a,c){return b.call([{methodname:"core_message_delete_conversations_by_id",args:{userid:a,conversationids:[c]}}])[0]},getContactRequests:function getContactRequests(a){return b.call([{methodname:"core_message_get_contact_requests",args:{userid:a}}])[0]},acceptContactRequest:function acceptContactRequest(c,d){return a.when.apply(null,b.call([{methodname:"core_message_confirm_contact_request",args:{userid:c,requesteduserid:d}},{methodname:"core_message_get_member_info",args:{referenceuserid:d,userids:[c],includecontactrequests:!0,includeprivacyinfo:!0}}])).then(function(a,b){return b.length?b[0]:{}})},declineContactRequest:function declineContactRequest(c,d){return a.when.apply(null,b.call([{methodname:"core_message_decline_contact_request",args:{userid:c,requesteduserid:d}},{methodname:"core_message_get_member_info",args:{referenceuserid:d,userids:[c],includecontactrequests:!0,includeprivacyinfo:!0}}])).then(function(a,b){return b.length?b[0]:{}})},getConversation:function getConversation(a,c,d,e,f,g,h,i,j){var k={userid:a,conversationid:c};if("undefined"!=typeof d&&null!==d){k.includecontactrequests=d}if("undefined"!=typeof e&&null!==e){k.includeprivacyinfo=e}if("undefined"!=typeof f&&null!==f){k.memberlimit=f}if("undefined"!=typeof g&&null!==g){k.memberoffset=g}if("undefined"!=typeof h&&null!==h){k.messagelimit=h}if("undefined"!=typeof i&&null!==i){k.messageoffset=i}if("undefined"!=typeof j&&null!==j){k.newestmessagesfirst=j}return b.call([{methodname:"core_message_get_conversation",args:k}])[0]},getConversationBetweenUsers:function getConversationBetweenUsers(a,c,d,e,f,g,h,i,j){var k={userid:a,otheruserid:c};if("undefined"!=typeof d&&null!==d){k.includecontactrequests=d}if("undefined"!=typeof e&&null!==e){k.includeprivacyinfo=e}if("undefined"!=typeof f&&null!==f){k.memberlimit=f}if("undefined"!=typeof g&&null!==g){k.memberoffset=g}if("undefined"!=typeof h&&null!==h){k.messagelimit=h}if("undefined"!=typeof i&&null!==i){k.messageoffset=i}if("undefined"!=typeof j&&null!==j){k.newestmessagesfirst=j}return b.call([{methodname:"core_message_get_conversation_between_users",args:k}])[0]},getSelfConversation:function getSelfConversation(a,c,d,e){var f={userid:a};if("undefined"!=typeof c&&null!==c){f.messagelimit=c}if("undefined"!=typeof d&&null!==d){f.messageoffset=d}if("undefined"!=typeof e&&null!==e){f.newestmessagesfirst=e}return b.call([{methodname:"core_message_get_self_conversation",args:f}])[0]},getConversations:function getConversations(a,c,d,f,g,h){var i={userid:a,type:c};if("undefined"!=typeof d&&null!==d){i.limitnum=d}if("undefined"!=typeof f&&null!==f){i.limitfrom=f}if("undefined"!=typeof g&&null!==g){i.favourites=g}if("undefined"!=typeof h&&null!==h){i.mergeself=h}return b.call([{methodname:"core_message_get_conversations",args:i}])[0].then(function(a){if(a.conversations.length){a.conversations=a.conversations.map(function(a){if(a.type==e.PRIVATE||a.type==e.SELF){var b=a.members.length?a.members[0]:null;if(b){a.name=a.name?a.name:b.fullname;a.imageurl=a.imageurl?a.imageurl:b.profileimageurl}}return a})}return a})},getConversationMembers:function getConversationMembers(a,c,d,e,f){var g={userid:c,conversationid:a};if("undefined"!=typeof d&&null!==d){g.limitnum=d}if("undefined"!=typeof e&&null!==e){g.limitfrom=e}if("undefined"!=typeof f&&null!==f){g.includecontactrequests=f}return b.call([{methodname:"core_message_get_conversation_members",args:g}])[0]},setFavouriteConversations:function setFavouriteConversations(a,c){return b.call([{methodname:"core_message_set_favourite_conversations",args:{userid:a,conversations:c}}])[0]},setMutedConversations:function setMutedConversations(a,c){return b.call([{methodname:"core_message_mute_conversations",args:{userid:a,conversationids:c}}])[0]},unsetFavouriteConversations:function unsetFavouriteConversations(a,c){return b.call([{methodname:"core_message_unset_favourite_conversations",args:{userid:a,conversations:c}}])[0]},unsetMutedConversations:function unsetMutedConversations(a,c){return b.call([{methodname:"core_message_unmute_conversations",args:{userid:a,conversationids:c}}])[0]},getMemberInfo:function getMemberInfo(a,c,d,e){var f={referenceuserid:a,userids:c};if("undefined"!=typeof d){f.includecontactrequests=d}if("undefined"!=typeof e){f.includeprivacyinfo=e}return b.call([{methodname:"core_message_get_member_info",args:f}])[0]},markAllConversationMessagesAsRead:function markAllConversationMessagesAsRead(a,c){return b.call([{methodname:"core_message_mark_all_conversation_messages_as_read",args:{userid:a,conversationid:c}}])[0]},getUserMessagePreferences:function getUserMessagePreferences(a){return b.call([{methodname:"core_message_get_user_message_preferences",args:{userid:a}}])[0]},getTotalConversationCounts:function getTotalConversationCounts(a){return b.call([{methodname:"core_message_get_conversation_counts",args:{userid:a}}])[0]},getUnreadConversationCounts:function getUnreadConversationCounts(a){return b.call([{methodname:"core_message_get_unread_conversation_counts",args:{userid:a}}])[0]},getAllConversationCounts:function getAllConversationCounts(c){return a.when.apply(null,b.call([{methodname:"core_message_get_conversation_counts",args:{userid:c}},{methodname:"core_message_get_unread_conversation_counts",args:{userid:c}}])).then(function(a,b){return{total:a,unread:b}})}}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_message/message_drawer_view_search",["jquery","core/custom_interaction_events","core/notification","core/pubsub","core/str","core/templates","core_message/message_repository","core_message/message_drawer_events"],function(a,b,c,d,e,f,g,h){var i=50,j=3,k={BLOCK_ICON_CONTAINER:"[data-region=\"block-icon-container\"]",CANCEL_SEARCH_BUTTON:"[data-action=\"cancel-search\"]",CONTACTS_CONTAINER:"[data-region=\"contacts-container\"]",CONTACTS_LIST:"[data-region=\"contacts-container\"] [data-region=\"list\"]",EMPTY_MESSAGE_CONTAINER:"[data-region=\"empty-message-container\"]",LIST:"[data-region=\"list\"]",LOADING_ICON_CONTAINER:"[data-region=\"loading-icon-container\"]",LOADING_PLACEHOLDER:"[data-region=\"loading-placeholder\"]",MESSAGES_LIST:"[data-region=\"messages-container\"] [data-region=\"list\"]",MESSAGES_CONTAINER:"[data-region=\"messages-container\"]",NON_CONTACTS_CONTAINER:"[data-region=\"non-contacts-container\"]",NON_CONTACTS_LIST:"[data-region=\"non-contacts-container\"] [data-region=\"list\"]",SEARCH_ICON_CONTAINER:"[data-region=\"search-icon-container\"]",SEARCH_ACTION:"[data-action=\"search\"]",SEARCH_INPUT:"[data-region=\"search-input\"]",SEARCH_RESULTS_CONTAINER:"[data-region=\"search-results-container\"]",LOAD_MORE_USERS:"[data-action=\"load-more-users\"]",LOAD_MORE_MESSAGES:"[data-action=\"load-more-messages\"]",BUTTON_TEXT:"[data-region=\"button-text\"]",NO_RESULTS_CONTAINTER:"[data-region=\"no-results-container\"]",ALL_CONTACTS_CONTAINER:"[data-region=\"all-contacts-container\"]"},l={CONTACTS_LIST:"core_message/message_drawer_contacts_list",NON_CONTACTS_LIST:"core_message/message_drawer_non_contacts_list",MESSAGES_LIST:"core_message/message_drawer_messages_list"},m=function(a){return a.attr("data-user-id")},n=function(a){return a.find(k.EMPTY_MESSAGE_CONTAINER)},o=function(a){return a.find(k.LOADING_ICON_CONTAINER)},p=function(a){return a.find(k.LOADING_PLACEHOLDER)},q=function(a){return a.find(k.SEARCH_ICON_CONTAINER)},r=function(a){return a.find(k.SEARCH_INPUT)},s=function(a){return a.find(k.SEARCH_RESULTS_CONTAINER)},t=function(a){return a.find(k.CONTACTS_CONTAINER)},u=function(a){return a.find(k.NON_CONTACTS_CONTAINER)},v=function(a){return a.find(k.MESSAGES_CONTAINER)},w=function(a){n(a).removeClass("hidden")},x=function(a){n(a).addClass("hidden")},y=function(a){o(a).removeClass("hidden")},z=function(a){o(a).addClass("hidden")},A=function(a){p(a).removeClass("hidden")},B=function(a){p(a).addClass("hidden")},C=function(a){q(a).removeClass("hidden")},D=function(a){q(a).addClass("hidden")},E=function(a){s(a).removeClass("hidden")},F=function(a){s(a).addClass("hidden")},G=function(a){var b=s(a);b.find(k.ALL_CONTACTS_CONTAINER).addClass("hidden");b.find(k.MESSAGES_CONTAINER).addClass("hidden");b.find(k.NO_RESULTS_CONTAINTER).removeClass("hidden")},H=function(a){var b=s(a);b.find(k.ALL_CONTACTS_CONTAINER).removeClass("hidden");b.find(k.MESSAGES_CONTAINER).removeClass("hidden");b.find(k.NO_RESULTS_CONTAINTER).addClass("hidden")},I=function(a){var b=s(a);b.find(k.ALL_CONTACTS_CONTAINER).removeClass("hidden")},J=function(a){var b=s(a);b.find(k.ALL_CONTACTS_CONTAINER).addClass("hidden")},K=function(a){var b=s(a);b.find(k.CONTACTS_CONTAINER).removeClass("hidden")},L=function(a){var b=s(a);b.find(k.CONTACTS_CONTAINER).addClass("hidden")},M=function(a){var b=s(a);b.find(k.NON_CONTACTS_CONTAINER).removeClass("hidden")},N=function(a){var b=s(a);b.find(k.NON_CONTACTS_CONTAINER).addClass("hidden")},O=function(a){var b=s(a);b.find(k.MESSAGES_CONTAINER).removeClass("hidden")},P=function(a){var b=s(a);b.find(k.MESSAGES_CONTAINER).addClass("hidden")},Q=function(a){r(a).prop("disabled",!0)},R=function(a){r(a).prop("disabled",!1)},S=function(a){r(a).val("")},T=function(a){a.find(k.CONTACTS_LIST).empty();a.find(k.NON_CONTACTS_LIST).empty();a.find(k.MESSAGES_LIST).empty();H(a);I(a);K(a);M(a);O(a);Y(a);aa(a)},U=function(a,b){D(a);x(b);F(b);y(a);A(b);Q(a)},V=function(a,b){C(a);x(b);E(b);z(a);B(b);R(a)},W=function(a){var b=a.find(k.LOAD_MORE_USERS);b.prop("disabled",!0);b.find(k.BUTTON_TEXT).addClass("hidden");b.find(k.LOADING_ICON_CONTAINER).removeClass("hidden")},X=function(a){var b=a.find(k.LOAD_MORE_USERS);b.prop("disabled",!1);b.find(k.BUTTON_TEXT).removeClass("hidden");b.find(k.LOADING_ICON_CONTAINER).addClass("hidden")},Y=function(a){a.find(k.LOAD_MORE_USERS).removeClass("hidden")},Z=function(a){a.find(k.LOAD_MORE_USERS).addClass("hidden")},$=function(a){var b=a.find(k.LOAD_MORE_MESSAGES);b.prop("disabled",!0);b.find(k.BUTTON_TEXT).addClass("hidden");b.find(k.LOADING_ICON_CONTAINER).removeClass("hidden")},_=function(a){var b=a.find(k.LOAD_MORE_MESSAGES);b.prop("disabled",!1);b.find(k.BUTTON_TEXT).removeClass("hidden");b.find(k.LOADING_ICON_CONTAINER).addClass("hidden")},aa=function(a){a.find(k.LOAD_MORE_MESSAGES).removeClass("hidden")},ba=function(a){a.find(k.LOAD_MORE_MESSAGES).addClass("hidden")},ca=function(a,b){return a.find("[data-contact-user-id=\""+b+"\"]")},da=function(a,b){var c=u(a),d=ca(c,b.userid);if(d.length){d.remove();var e=t(a);e.removeClass("hidden");e.find(k.LIST).append(d)}if(!c.find(k.LIST).children().length){c.addClass("hidden")}},ea=function(a,b){var c=t(a),d=ca(c,b);if(d.length){d.remove();var e=u(a);e.removeClass("hidden");e.find(k.LIST).append(d)}if(!c.find(k.LIST).children().length){c.addClass("hidden")}},fa=function(a,b){var c=ca(a,b);if(c.length){c.find(k.BLOCK_ICON_CONTAINER).removeClass("hidden")}},ga=function(a,b){var c=ca(a,b);if(c.length){c.find(k.BLOCK_ICON_CONTAINER).addClass("hidden")}},ha=function(a,b){if(!a){return""}var c=new RegExp("("+b+")","gi");return a.replace(c,"<span class=\"matchtext\">$1</span>")},ia=function(a,b){var c=t(a),d=a.attr("data-in-panel"),e=c.find(k.LIST);return f.render(l.CONTACTS_LIST,{contacts:b,frompanel:d}).then(function(a){e.append(a);return a})},ja=function(a,b){var c=u(a),d=a.attr("data-in-panel"),e=c.find(k.LIST);return f.render(l.NON_CONTACTS_LIST,{noncontacts:b,frompanel:d}).then(function(a){e.append(a);return a})},ka=function(a,b){var c=v(a),d=a.attr("data-in-panel"),e=c.find(k.LIST);return f.render(l.MESSAGES_LIST,{messages:b,frompanel:d}).then(function(a){e.append(a);return a})},la=function(b,c,d,e,f){var h=!1;W(b);return g.searchUsers(c,d,e+1,f).then(function(a){var b=a.contacts,c=a.noncontacts;if(b.length<=e&&c.length<=e){h=!0;return{contacts:b,noncontacts:c}}else{return{contacts:b.slice(0,e),noncontacts:c.slice(0,e)}}}).then(function(c){var e=c.contacts.length,f=c.noncontacts.length;if(e){c.contacts.forEach(function(a){a.highlight=ha(a.fullname,d)})}if(f){c.noncontacts.forEach(function(a){a.highlight=ha(a.fullname,d)})}return a.when(e?ia(b,c.contacts):!0,f?ja(b,c.noncontacts):!0).then(function(){return{contactsCount:e,nonContactsCount:f}})}).then(function(a){X(b);if(h){Z(b)}return a}).catch(function(a){X(b);throw a})},ma=function(a,b,c,d,e){var f=!1;$(a);return g.searchMessages(b,c,d+1,e).then(function(a){var b=a.contacts;if(b.length<=d){f=!0;return b}else{return b.slice(0,d)}}).then(function(b){if(b.length){b.forEach(function(a){a.lastmessage=ha(a.lastmessage,c)});return ka(a,b).then(function(){return b.length})}else{return b.length}}).then(function(b){_(a);if(f){ba(a)}return b}).catch(function(b){_(a);throw b})},na=function(b,c,d,e,f,g,h){var i=m(c);U(b,c);T(c);return a.when(la(c,i,d,e,f),ma(c,i,d,g,h)).then(function(a,d){var e=a.contactsCount,f=a.nonContactsCount;V(b,c);if(!e&&!f&&!d){G(c)}else{if(!e&&!f){J(c)}else{if(!e){L(c)}if(!f){N(c)}}if(!d){P(c)}}})},oa=function(a,e){var f=m(e),g=r(a),l="",n=0,o=0,p=function(b,d){l=g.val().trim();if(""!==l){n=0;o=0;na(a,e,l,j,o,50,n).then(function(){g.focus();o=o+j;n=n+50}).catch(c.exception)}d.originalEvent.preventDefault()};b.define(g,[b.events.enter]);b.define(a,[b.events.activate]);b.define(e,[b.events.activate]);g.on(b.events.enter,p);a.on(b.events.activate,k.SEARCH_ACTION,p);e.on(b.events.activate,k.LOAD_MORE_MESSAGES,function(a,b){if(""!==l){ma(e,f,l,50,n).then(function(){n=n+50}).catch(c.exception)}b.originalEvent.preventDefault()});e.on(b.events.activate,k.LOAD_MORE_USERS,function(a,b){if(""!==l){la(e,f,l,i,o).then(function(){o=o+i}).catch(c.exception)}b.originalEvent.preventDefault()});a.on(b.events.activate,k.CANCEL_SEARCH_BUTTON,function(){S(a);w(e);C(a);F(e);z(a);B(e);o=0;n=0});d.subscribe(h.CONTACT_ADDED,function(a){da(e,a)});d.subscribe(h.CONTACT_REMOVED,function(a){ea(e,a)});d.subscribe(h.CONTACT_BLOCKED,function(a){fa(e,a)});d.subscribe(h.CONTACT_UNBLOCKED,function(a){ga(e,a)})},pa=function(a,b){if("object"!==_typeof(b)){return e.get_string("messagedrawerviewsearch","core_message")}var c=r(b),d=c.val().trim();return e.get_string("messagedrawerviewsearch","core_message",d)};return{show:function show(b,c,d){if(!d.attr("data-init")){oa(c,d);d.attr("data-init",!0)}var e=r(c);e.focus();return a.Deferred().resolve().promise()},description:pa}});
define ("core_message/message_drawer_view_conversation_constants",[],function(){return{SELECTORS:{ACTION_ACCEPT_CONTACT_REQUEST:"[data-action=\"accept-contact-request\"]",ACTION_CANCEL_CONFIRM:"[data-action=\"cancel-confirm\"]",ACTION_OKAY_CONFIRM:"[data-action=\"okay-confirm\"]",ACTION_CANCEL_EDIT_MODE:"[data-action=\"cancel-edit-mode\"]",ACTION_CONFIRM_ADD_CONTACT:"[data-action=\"confirm-add-contact\"]",ACTION_CONFIRM_BLOCK:"[data-action=\"confirm-block\"]",ACTION_CONFIRM_DELETE_SELECTED_MESSAGES:"[data-action=\"confirm-delete-selected-messages\"]",ACTION_CONFIRM_DELETE_CONVERSATION:"[data-action=\"confirm-delete-conversation\"]",ACTION_CONFIRM_FAVOURITE:"[data-action=\"confirm-favourite\"]",ACTION_CONFIRM_MUTE:"[data-action=\"confirm-mute\"]",ACTION_CONFIRM_UNFAVOURITE:"[data-action=\"confirm-unfavourite\"]",ACTION_CONFIRM_REMOVE_CONTACT:"[data-action=\"confirm-remove-contact\"]",ACTION_CONFIRM_UNBLOCK:"[data-action=\"confirm-unblock\"]",ACTION_CONFIRM_UNMUTE:"[data-action=\"confirm-unmute\"]",ACTION_DECLINE_CONTACT_REQUEST:"[data-action=\"decline-contact-request\"]",ACTION_REQUEST_ADD_CONTACT:"[data-action=\"request-add-contact\"]",ACTION_REQUEST_BLOCK:"[data-action=\"request-block\"]",ACTION_REQUEST_DELETE_CONVERSATION:"[data-action=\"request-delete-conversation\"]",ACTION_REQUEST_DELETE_SELECTED_MESSAGES:"[data-action=\"delete-selected-messages\"]",ACTION_REQUEST_REMOVE_CONTACT:"[data-action=\"request-remove-contact\"]",ACTION_REQUEST_UNBLOCK:"[data-action=\"request-unblock\"]",ACTION_VIEW_CONTACT:"[data-action=\"view-contact\"]",ACTION_VIEW_GROUP_INFO:"[data-action=\"view-group-info\"]",CAN_RECEIVE_FOCUS:"input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]",CONFIRM_DIALOGUE:"[data-region=\"confirm-dialogue\"]",CONFIRM_DIALOGUE_BUTTON_TEXT:"[data-region=\"dialogue-button-text\"]",CONFIRM_DIALOGUE_CANCEL_BUTTON:"[data-action=\"cancel-confirm\"]",CONFIRM_DIALOGUE_CONTAINER:"[data-region=\"confirm-dialogue-container\"]",CONFIRM_DIALOGUE_HEADER:"[data-region=\"dialogue-header\"]",CONFIRM_DIALOGUE_OKAY_BUTTON:"[data-action=\"okay-confirm\"]",CONFIRM_DIALOGUE_TEXT:"[data-region=\"dialogue-text\"]",CONTACT_REQUEST_SENT_MESSAGE_CONTAINER:"[data-region=\"contact-request-sent-message-container\"]",CONTENT_PLACEHOLDER_CONTAINER:"[data-region=\"content-placeholder\"]",CONTENT_CONTAINER:"[data-region=\"content-container\"]",CONTENT_MESSAGES_CONTAINER:"[data-region=\"content-message-container\"]",CONTENT_MESSAGES_FOOTER_CONTAINER:"[data-region=\"content-messages-footer-container\"]",CONTENT_MESSAGES_FOOTER_EDIT_MODE_CONTAINER:"[data-region=\"content-messages-footer-edit-mode-container\"]",CONTENT_MESSAGES_FOOTER_REQUIRE_CONTACT_CONTAINER:"[data-region=\"content-messages-footer-require-contact-container\"]",CONTENT_MESSAGES_FOOTER_REQUIRE_UNBLOCK_CONTAINER:"[data-region=\"content-messages-footer-require-unblock-container\"]",CONTENT_MESSAGES_FOOTER_UNABLE_TO_MESSAGE_CONTAINER:"[data-region=\"content-messages-footer-unable-to-message\"]",DAY_MESSAGES_CONTAINER:"[data-region=\"day-messages-container\"]",DELETE_MESSAGES_FOR_ALL_USERS_TOGGLE:"[data-region=\"delete-messages-for-all-users-toggle\"]",DELETE_MESSAGES_FOR_ALL_USERS_TOGGLE_CONTAINER:"[data-region=\"delete-messages-for-all-users-toggle-container\"]",EMOJI_AUTO_COMPLETE_CONTAINER:"[data-region=\"emoji-auto-complete-container\"]",EMOJI_PICKER_CONTAINER:"[data-region=\"emoji-picker-container\"]",EMOJI_PICKER:"[data-region=\"emoji-picker\"]",EMOJI_PICKER_SEARCH_INPUT:"[data-region=\"search-input\"]",ERROR_MESSAGE_CONTAINER:"[data-region=\"error-message-container\"]",ERROR_MESSAGE:"[data-region=\"error-message\"]",FAVOURITE_ICON_CONTAINER:"[data-region=\"favourite-icon-container\"]",FOOTER_CONTAINER:"[data-region=\"content-messages-footer-container\"]",HEADER:"[data-region=\"header-content\"]",HEADER_EDIT_MODE:"[data-region=\"header-edit-mode\"]",HEADER_PLACEHOLDER_CONTAINER:"[data-region=\"header-placeholder\"]",LOADING_ICON_CONTAINER:"[data-region=\"loading-icon-container\"]",MESSAGE:"[data-region=\"message\"]",MESSAGE_NOT_SELECTED:"[data-region=\"message\"][aria-checked=\"false\"]",MESSAGE_NOT_SELECTED_ICON:"[data-region=\"not-selected-icon\"]",MESSAGE_SELECTED_ICON:"[data-region=\"selected-icon\"]",MESSAGES:"[data-region=\"content-message-container\"]",MESSAGES_CONTAINER:"[data-region=\"content-message-container\"]",MESSAGES_SELECTED_COUNT:"[data-region=\"message-selected-court\"]",MESSAGE_TEXT_AREA:"[data-region=\"send-message-txt\"]",MORE_MESSAGES_LOADING_ICON_CONTAINER:"[data-region=\"more-messages-loading-icon-container\"]",MUTED_ICON_CONTAINER:"[data-region=\"muted-icon-container\"]",PLACEHOLDER_CONTAINER:"[data-region=\"placeholder-container\"]",RETRY_SEND:"[data-region=\"retry-send\"]",SELF_CONVERSATION_MESSAGE_CONTAINER:"[data-region=\"self-conversation-message-container\"]",SEND_MESSAGE_BUTTON:"[data-action=\"send-message\"]",SEND_MESSAGE_ICON_CONTAINER:"[data-region=\"send-icon-container\"]",TEXT:"[data-region=\"text\"]",TEXT_CONTAINER:"[data-region=\"text-container\"]",TIME_CREATED:"[data-region=\"time-created\"]",TITLE:"[data-region=\"title\"]",TOGGLE_EMOJI_PICKER_BUTTON:"[data-action=\"toggle-emoji-picker\"]"},TEMPLATES:{HEADER_PRIVATE:"core_message/message_drawer_view_conversation_header_content_type_private",HEADER_PRIVATE_NO_CONTROLS:"core_message/message_drawer_view_conversation_header_content_type_private_no_controls",HEADER_PUBLIC:"core_message/message_drawer_view_conversation_header_content_type_public",HEADER_SELF:"core_message/message_drawer_view_conversation_header_content_type_self",DAY:"core_message/message_drawer_view_conversation_body_day",MESSAGE:"core_message/message_drawer_view_conversation_body_message",MESSAGES:"core_message/message_drawer_view_conversation_body_messages"},CONVERSATION_TYPES:{PRIVATE:1,PUBLIC:2,SELF:3},NEWEST_MESSAGES_FIRST:!0,LOAD_MESSAGE_LIMIT:100,MILLISECONDS_IN_SEC:1e3}});
define ("core_message/message_drawer_view_settings",["jquery","core/notification","core/str","core/pubsub","core/templates","core_message/message_repository","core/custom_interaction_events","core_message/message_drawer_events"],function(a,b,c,d,e,f,g,h){var i={CHECKBOX:"input[type=\"checkbox\"]",SETTINGS:"[data-region=\"settings\"]",PRIVACY_PREFERENCE:"[data-preference=\"blocknoncontacts\"] input[type=\"radio\"]",NOTIFICATIONS_PREFERENCE:"[data-preference=\"notifications\"] input[type=\"checkbox\"]",ENTER_TO_SEND_PREFERENCE:"[data-preference=\"entertosend\"] input[type=\"checkbox\"]",NOTIFICATION_PREFERENCES_CONTAINER:"[data-region=\"notification-preference-container\"]",CONTENT_CONTAINER:"[data-region=\"content-container\"]",PLACEHOLDER_CONTAINER:"[data-region=\"placeholder-container\"]"},j={NOTIFICATION_PREFERENCES:"core_message/message_drawer_view_settings_body_content_notification_preferences"},k=function(b,c){var d=b.find(i.PRIVACY_PREFERENCE);d.each(function(b,d){d=a(d);if(d.val()==c){d.prop("checked",!0)}else{d.prop("checked",!1)}})},l=function(a,b){var c=a.find(i.ENTER_TO_SEND_PREFERENCE);if(b){c.prop("checked",!0)}else{c.prop("checked",!1)}},m=function(a,c){return f.savePreferences(a,c).then(function(){d.publish(h.PREFERENCES_UPDATED,c)}).catch(b.exception)},n=function(b,c){var d=b.find(i.SETTINGS);g.define(d,[g.events.activate]);d.on(g.events.activate,i.NOTIFICATIONS_PREFERENCE,function(b){var d=a(b.target).closest(i.NOTIFICATION_PREFERENCES_CONTAINER),e=d.find(i.CHECKBOX);if(!e.length){return}var f=e.toArray().reduce(function(b,c){c=a(c);if(c.prop("checked")){b.push(c.attr("data-name"))}return b},[]),g=f.length?f.join(","):"none";m(c,[{type:"message_provider_moodle_instantmessage_loggedoff",value:g},{type:"message_provider_moodle_instantmessage_loggedin",value:g}])});d.on("change",i.PRIVACY_PREFERENCE,function(b){var d=a(b.target).val();m(c,[{type:"message_blocknoncontacts",value:d}])});d.on(g.events.activate,i.ENTER_TO_SEND_PREFERENCE,function(b){var d=a(b.target).prop("checked");m(c,[{type:"message_entertosend",value:d}])})},o=function(a,c){f.getUserMessagePreferences(c).then(function(b){k(a,b.blocknoncontacts);l(a,b.entertosend);var c=[];if(b.preferences.components.length){b.preferences.components.forEach(function(a){if(a.notifications.length){var b=a.notifications.filter(function(a){return a.preferencekey=="message_provider_moodle_instantmessage"});if(b.length){var d=a.notifications[0];c=d.processors.map(function(a){var b=a.loggedin.checked||a.loggedoff.checked;return{displayname:a.displayname,name:a.name,checked:b,locked:a.locked,lockedmessage:a.lockedmessage||null}})}}})}var d=a.find(i.NOTIFICATION_PREFERENCES_CONTAINER);if(c.length){d.removeClass("hidden");return e.render(j.NOTIFICATION_PREFERENCES,{processors:c}).then(function(a){d.append(a);return a})}else{return!0}}).then(function(){a.find(i.CONTENT_CONTAINER).removeClass("hidden");a.find(i.PLACEHOLDER_CONTAINER).addClass("hidden");n(a,c)}).catch(b.exception)};return{show:function show(b,c,d,e,f){if(!d.attr("data-init")){o(d,f);d.attr("data-init",!0)}return a.Deferred().resolve().promise()},description:function description(){return c.get_string("messagedrawerviewsettings","core_message")}}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_message/message_drawer_view_conversation_patcher",["jquery","core/user_date","core_message/message_drawer_view_conversation_constants"],function(a,b,c){var d=function(a,c){var d=a.reduce(function(a,d){var e=d.timeCreated?d.timeCreated:c,f=b.getUserMidnightForTimestamp(e,c);if(a.hasOwnProperty(f)){a[f].push(d)}else{a[f]=[d]}return a},{});return Object.keys(d).map(function(a){return{timestamp:a,messages:d[a]}})},e=function(c,a,d){a=a.slice();var e=[],f=[],g=[];c.forEach(function(b){var c=!1,e=0;for(;e<a.length;e++){var h=a[e];if(d(b,h)){c=!0;g.push({a:b,b:h});break}}if(c){a.splice(e,1)}else{f.push(b)}});e=a;return{missingFromA:e,missingFromB:f,matches:g}},f=function(a,b){for(var c=null,d=0,e;d<a.length;d++){e=a[d];if(b(e)){return e}}return c},g=function(c,d){c=c.slice();d=d.slice();c.sort();d.sort();var e=c.length,f=d.length;if(1>e&&1>f){return!0}if(e!=f){return!1}return c.every(function(a,b){return a==d[b]})},h=function(c,a){var b=Object.keys(c),d=Object.keys(a);if(b.length!=d.length){return!1}return b.every(function(b){var d=c[b],e=a[b],f=_typeof(d),i=_typeof(e);f=null===d?"null":f;i=null===d?"null":i;f="object"===f&&Array.isArray(f)?"array":f;i="object"===i&&Array.isArray(i)?"array":i;if(f!==i){return!1}switch(f){case"object":return h(d,e);case"array":return g(d,e);default:return c[b]==a[b];}})},i=function(c,a){return h({id:c.id,state:c.sendState,text:c.text,timeCreated:c.timeCreated},{id:a.id,state:a.sendState,text:a.text,timeCreated:a.timeCreated})},j=function(a,b,c){return{remove:b,add:c.map(function(b){var c=f(a,function(a){return b.timestamp<a.timestamp});return{before:c,value:b}})}},k=function(a){var b=[],c=[],d=[];a.forEach(function(a){var g=a.a,h=a.b,j=e(g.messages,h.messages,i),k=e(j.missingFromB,j.missingFromA,function(c,a){return c.id==a.id||c.sendState!=a.sendState&&c.timeAdded==a.timeAdded});b=b.concat(k.missingFromB);k.missingFromA.forEach(function(a){var b=null;if(a.timeCreated){b=f(g.messages,function(b){if(a.timeCreated==b.timeCreated){return a.id<b.id}else{return a.timeCreated<b.timeCreated}})}c.push({before:b,value:a,day:g})});d=d.concat(k.matches.map(function(a){return{before:a.a,after:a.b}}))});return{add:c,remove:b,update:d}},l=function(a,b){var c=e(a.messages,b.messages,i);if(c.missingFromA.length||c.missingFromB.length){var f=d(a.messages,a.midnight),g=d(b.messages,b.midnight),h=e(f,g,function(a,b){return a.timestamp==b.timestamp});return{days:j(f,h.missingFromB,h.missingFromA),messages:k(h.matches)}}else{return null}},m=function(a,b){var d=L(a,b),e=B(a,b),f=J(a),g=J(b),h=d&&d.show&&!d.hasMessages,i=d&&!d.show,j=!f&&g;j=j||h||i;j=j||null!==e;if(j){return{type:c.CONVERSATION_TYPES.PRIVATE,showControls:!h&&!e,context:{id:b.id,name:b.name,subname:b.subname,totalmembercount:b.totalMemberCount,imageurl:b.imageUrl,isfavourite:b.isFavourite,ismuted:b.isMuted,showfavourite:null!==b.id,userid:g.id,showonlinestatus:g.showonlinestatus,isonline:g.isonline,isblocked:g.isblocked,iscontact:g.iscontact}}}return null},n=function(a,b){var d=null===a.name&&null!==b.name;if(d){return{type:c.CONVERSATION_TYPES.SELF,showControls:!1,context:{id:b.id,name:b.name,subname:b.subname,imageurl:b.imageUrl,isfavourite:b.isFavourite,showfavourite:null!==b.id,showonlinestatus:!0}}}return null},o=function(a,b){var d=a.totalMemberCount,e=b.totalMemberCount;if(d!=e){return{type:c.CONVERSATION_TYPES.PUBLIC,showControls:!0,context:{id:b.id,name:b.name,subname:b.subname,totalmembercount:b.totalMemberCount,imageurl:b.imageUrl,isfavourite:b.isFavourite,ismuted:b.isMuted,showfavourite:null!==b.id}}}else{return null}},p=function(a,b){var c=a.messages,d=b.messages;if(1>d.length){return null}if(1>c.length){return d[d.length-1].id}var e=c[a.messages.length-1],f=d[d.length-1],g=c[0],h=d[0];if(e.id!=f.id){return f.id}else if(g.id!=h.id){return g.id}return null},q=function(a,b){if(!a.loadingMembers&&b.loadingMembers){return!0}else if(a.loadingMembers&&!b.loadingMembers){return!1}else{return null}},r=function(a,b){if(a.hasTriedToLoadMessages===b.hasTriedToLoadMessages){return null}else if(!b.hasTriedToLoadMessages&&b.loadingMessages){return!0}else if(b.hasTriedToLoadMessages&&!b.loadingMessages){return!1}else{return null}},s=function(a,b){if(!a.loadingMessages&&b.loadingMessages){return!0}else if(a.loadingMessages&&!b.loadingMessages){return!1}else{return null}},t=function(a,b){if(!a.showEmojiPicker&&b.showEmojiPicker){return!0}else if(a.showEmojiPicker&&!b.showEmojiPicker){return!1}else{return null}},u=function(a,b){if(!a.showEmojiAutoComplete&&b.showEmojiAutoComplete){return!0}else if(a.showEmojiAutoComplete&&!b.showEmojiAutoComplete){return!1}else{return null}},v=function(a,b){if(b.pendingBlockUserIds.length){var c=b.pendingBlockUserIds[0];return b.members[c]}else if(a.pendingBlockUserIds.length){return!1}return null},w=function(a,b){if(b.pendingUnblockUserIds.length){var c=b.pendingUnblockUserIds[0];return b.members[c]}else if(a.pendingUnblockUserIds.length){return!1}return null},x=function(a,b){if(b.pendingAddContactIds.length){var c=b.pendingAddContactIds[0];return b.members[c]}else if(a.pendingAddContactIds.length){return!1}return null},y=function(a,b){if(b.pendingRemoveContactIds.length){var c=b.pendingRemoveContactIds[0];return b.members[c]}else if(a.pendingRemoveContactIds.length){return!1}return null},z=function(a,b){var c=a.pendingDeleteMessageIds.length,d=b.pendingDeleteMessageIds.length;if(d&&!c){return{show:!0,type:b.type,canDeleteMessagesForAllUsers:b.canDeleteMessagesForAllUsers}}else if(c&&!d){return{show:!1}}return null},A=function(a,b){if(!a.pendingDeleteConversation&&b.pendingDeleteConversation){return b.type}else if(a.pendingDeleteConversation&&!b.pendingDeleteConversation){return!1}return null},B=function(a,b){var c=a.loggedInUserId,d=J(a),e=J(b),f=!d?[]:d.contactrequests.filter(function(a){return a.requesteduserid==c&&a.userid==d.id}),g=!e?[]:e.contactrequests.filter(function(a){return a.requesteduserid==c&&a.userid==e.id}),h=f.length?f[0]:null,i=g.length?g[0]:null;if(!h&&i){return e}else if(h&&!i){return!1}else{return null}},C=function(a,b){var c=J(a),d=J(b);if(!c&&!d){return null}else if(!c&&d){return d.isblocked?!0:null}else if(!d&&c){return c.isblocked?!1:null}else if(c.isblocked&&!d.isblocked){return!1}else if(!c.isblocked&&d.isblocked){return!0}else{return null}},D=function(a,b){var c=a.isFavourite,d=b.isFavourite;if(null===a.id&&null===b.id){return null}else if(null===a.id&&null!==b.id){return"show-add"}else if(null!==a.id&&null===b.id){return"hide"}else if(c==d){return null}else if(!c&&d){return"show-remove"}else if(c&&!d){return"show-add"}else{return null}},E=function(a,b){var c=a.isMuted,d=b.isMuted;if(null===a.id&&null===b.id){return null}else if(null===a.id&&null!==b.id){return"show-mute"}else if(null!==a.id&&null===b.id){return"hide"}else if(c==d){return null}else if(!c&&d){return"show-unmute"}else if(c&&!d){return"show-mute"}else{return null}},F=function(a,b){var c=a.loggedInUserId,d=J(a),e=J(b),f=!d?[]:d.contactrequests.filter(function(a){return a.userid==c&&a.requesteduserid==d.id||a.userid==d.id&&a.requesteduserid==c}),g=!e?[]:e.contactrequests.filter(function(a){return a.userid==c&&a.requesteduserid==e.id||a.userid==e.id&&a.requesteduserid==c}),h=0<f.length,i=0<g.length;if(!d&&!e){return null}else if(h&&i){return null}else if(!h&&i&&!e.iscontact){return"pending-contact"}else if(!d&&e){return e.iscontact?"contact":null}else if(!e&&d){return d.iscontact?"non-contact":null}else if(d.iscontact&&!e.iscontact){return i?"pending-contact":"non-contact"}else if(!d.iscontact&&e.iscontact){return"contact"}else{return null}},G=function(a,b){if(!a.loadingConfirmAction&&b.loadingConfirmAction){return!0}else if(a.loadingConfirmAction&&!b.loadingConfirmAction){return!1}else{return null}},H=function(a,b){var c=0<a.selectedMessageIds.length,d=0<b.selectedMessageIds.length,e=a.messages.length!=b.messages.length;if(!c&&d){return!0}else if(c&&!d){return!1}else if(c&&e){return!0}else{return null}},I=function(a,b){var c=a.selectedMessageIds,d=b.selectedMessageIds;if(g(c,d)){return null}var f=e(c,d,function(c,a){return c==a});return{count:d.length,add:f.missingFromA,remove:f.missingFromB}},J=function(a){return Object.keys(a.members).reduce(function(b,c){if(c!=a.loggedInUserId&&!b){b=a.members[c]}return b},null)},K=function(a,b){if(b.canmessage){return!1}var c=b.contactrequests.filter(function(b){return b.userid==a||b.requesteduserid}),d=0<c.length;return b.requirescontact&&!b.iscontact&&!d},L=function(a,b){var c=J(a),d=J(b),e=0<a.messages.length,f=0<b.messages.length,g=b.loggedInUserId,h=c&&K(g,c),i=d&&K(g,d),j=x(a,b);if(!a.hasTriedToLoadMessages&&!b.hasTriedToLoadMessages){return null}if(!c&&!d){return null}if(!c&&i){return{show:!0,hasMessages:f,user:d}}if(!1===j&&i){return{show:!0,hasMessages:f,user:d}}if(a.hasTriedToLoadMessages&&b.hasTriedToLoadMessages){if(!h&&i){return{show:!0,hasMessages:f,user:d}}if(h&&!i){return{show:!1,hasMessages:f}}}if(!a.hasTriedToLoadMessages&&b.hasTriedToLoadMessages){if(i){return{show:!0,hasMessages:f,user:d}}}if(a.hasTriedToLoadMessages&&!b.hasTriedToLoadMessages){if(h){return{show:!1,hasMessages:e}}}return null},M=function(a,b){var c=J(a),d=J(b);if(!c&&!d){return null}else if(c&&!d){return c.isblocked?!1:null}else if(!c&&d){return d.isblocked?!0:null}else if(!c.isblocked&&d.isblocked){return!0}else if(c.isblocked&&!d.isblocked){return!1}return null},N=function(a,b){var d=J(a),e=J(b);if(b.type==c.CONVERSATION_TYPES.SELF){return null}if(!d&&!e){return null}else if(d&&!e){return d.canmessage?null:!0}else if(!d&&e){return e.canmessage?null:!0}else if(!d.canmessage&&e.canmessage){return!1}else if(d.canmessage&&!e.canmessage){return!0}return null},O=function(a,b){var c=r(a,b),d=H(a,b),e=L(a,b),f=M(a,b),g=N(a,b),h=null!==e?e.show&&e.hasMessages:null,j=J(b),k=function(a,c){if(a){return c}else if(null!==a&&!a){if(!j){return{type:"content"}}else if(j.isblocked){return{type:"unblock"}}else if(b.messages.length&&K(b.loggedInUserId,j)){return{type:"add-contact",user:j}}else if(!j.canmessage&&j.requirescontact&&!j.iscontact){return{type:"unable-to-message"}}}return null};if(null===c&&null===d&&null===e&&null===f){return null}for(var l=[[c,{type:"placeholder"}],[d,{type:"edit-mode"}],[g,{type:"unable-to-message"}],[f,{type:"unblock"}],[h,{type:"add-contact",user:j}]],m=0;m<l.length;m++){var n=l[m][0],o=l[m][1],p=k(n,o);if(null!==p){return p}}return{type:"content"}},P=function(a,b){var c=r(a,b),d=H(a,b);if(null===c&&null===d){return null}if(c){return{type:"placeholder"}}if(d){return{type:"edit-mode"}}return{type:"content"}},Q=function(a,b){var c=a.type,d=b.type,e=a.id,f=b.id,g=Object.keys(a.members),h=Object.keys(b.members);g.sort();h.sort();var i=g.every(function(a,b){return a==h[b]});if(c!=d){return!0}else if(e&&!f){return!0}else if(e&&f&&e!=f){return!0}else if(!e&&!f&&!i){return!0}return null},R=function(a,b){if(a.type!=b.type){return b.type==c.CONVERSATION_TYPES.SELF}return null},S=function(a,b){var c=b.loggedInUserId,d=J(a),e=J(b),f=!d?[]:d.contactrequests.filter(function(a){return a.userid==c}),g=!e?[]:e.contactrequests.filter(function(a){return a.userid==c}),h=0<f.length,i=0<g.length,j=0<a.messages.length,k=0<a.messages.length;if(!h&&i&&!e.iscontact&&!k){return e.fullname}else if(d&&!d.iscontact&&i&&e.iscontact){return!1}else if(h&&!i){return!1}else if(!j&&k){return!1}else{return null}},T=function(b,d){var e={all:{reset:Q,conversation:l,scrollToMessage:p,loadingMembers:q,loadingFirstMessages:r,loadingMessages:s,confirmDeleteSelectedMessages:z,inEditMode:H,selectedMessages:I,isFavourite:D,isMuted:E,showEmojiPicker:t,showEmojiAutoComplete:u}};e[c.CONVERSATION_TYPES.PRIVATE]={header:m,footer:O,confirmBlockUser:v,confirmUnblockUser:w,confirmAddContact:x,confirmRemoveContact:y,confirmContactRequest:B,confirmDeleteConversation:A,isBlocked:C,isContact:F,loadingConfirmAction:G,requireAddContact:L,contactRequestSent:S};e[c.CONVERSATION_TYPES.PUBLIC]={header:o,footer:P};e[c.CONVERSATION_TYPES.SELF]={header:n,footer:P,confirmDeleteConversation:A,selfConversationMessage:R};var f=a.extend({},e.all);if(d.type&&d.type in e){f=a.extend(f,e[d.type])}return Object.keys(f).reduce(function(a,c){var e=f[c],g=e(b,d);if(null!==g){a[c]=g}return a},{})};return{buildPatch:T}});
define ("core_message/message_drawer_view_conversation_renderer",["jquery","core/notification","core/str","core/templates","core/user_date","core_message/message_drawer_view_conversation_constants"],function(a,b,c,d,e,f){var g=f.SELECTORS,h=f.TEMPLATES,i=f.CONVERSATION_TYPES,j=function(a){return a.find(g.CONTENT_MESSAGES_CONTAINER)},k=function(a){j(a).removeClass("hidden")},l=function(a){j(a).addClass("hidden")},m=function(a){return a.find(g.SELF_CONVERSATION_MESSAGE_CONTAINER)},n=function(a){return m(a).addClass("hidden")},o=function(a){return a.find(g.CONTACT_REQUEST_SENT_MESSAGE_CONTAINER)},p=function(a){return o(a).addClass("hidden")},q=function(a){return a.find(g.CONTENT_MESSAGES_FOOTER_CONTAINER)},r=function(a){q(a).removeClass("hidden")},s=function(a){q(a).addClass("hidden")},t=function(a){return a.find(g.CONTENT_MESSAGES_FOOTER_EDIT_MODE_CONTAINER)},u=function(a){t(a).removeClass("hidden")},v=function(a){t(a).addClass("hidden")},w=function(a){return a.find(g.PLACEHOLDER_CONTAINER)},x=function(a){w(a).removeClass("hidden")},y=function(a){w(a).addClass("hidden")},z=function(a){return a.find(g.CONTENT_MESSAGES_FOOTER_REQUIRE_CONTACT_CONTAINER)},A=function(a){z(a).removeClass("hidden")},B=function(a){z(a).addClass("hidden")},C=function(a){return a.find(g.CONTENT_MESSAGES_FOOTER_REQUIRE_UNBLOCK_CONTAINER)},D=function(a){C(a).removeClass("hidden")},E=function(a){C(a).addClass("hidden")},F=function(a){return a.find(g.CONTENT_MESSAGES_FOOTER_UNABLE_TO_MESSAGE_CONTAINER)},G=function(a){F(a).removeClass("hidden")},H=function(a){F(a).addClass("hidden")},I=function(a){P(a);S(a);V(a)},J=function(a){s(a);v(a);y(a);B(a);E(a);H(a)},K=function(a){return a.find(g.CONTENT_PLACEHOLDER_CONTAINER)},L=function(a){K(a).removeClass("hidden")},M=function(a){K(a).addClass("hidden")},N=function(a){return a.find(g.HEADER)},O=function(a){N(a).removeClass("hidden")},P=function(a){N(a).addClass("hidden")},Q=function(a){return a.find(g.HEADER_EDIT_MODE)},R=function(a){Q(a).removeClass("hidden")},S=function(a){Q(a).addClass("hidden")},T=function(a){return a.find(g.HEADER_PLACEHOLDER_CONTAINER)},U=function(a){T(a).removeClass("hidden")},V=function(a){T(a).addClass("hidden")},W=function(a){return a.find(g.EMOJI_PICKER_CONTAINER)},X=function(a){return a.find(g.EMOJI_AUTO_COMPLETE_CONTAINER)},Y=function(a,b){var c=j(a);return c.find("[data-message-id=\""+b+"\"]")},Z=function(a,b){var c=j(a);return c.find("[data-day-id=\""+b+"\"]")},$=function(a){return a.find(g.MORE_MESSAGES_LOADING_ICON_CONTAINER)},_=function(a){$(a).removeClass("hidden")},aa=function(a){$(a).addClass("hidden")},ba=function(a){return a.find(g.CONFIRM_DIALOGUE_CONTAINER)},ca=function(a){var b=ba(a),c=b.siblings(":not(.hidden)");c.attr("aria-hidden",!0);c.attr("tabindex",-1);c.attr("data-confirm-dialogue-hidden",!0);b.removeClass("hidden")},da=function(a){var b=ba(a),c=b.siblings("[data-confirm-dialogue-hidden=\"true\"]");c.removeAttr("aria-hidden");c.removeAttr("tabindex");c.removeAttr("data-confirm-dialogue-hidden");b.addClass("hidden")},ea=function(a,b){Q(a).find(g.MESSAGES_SELECTED_COUNT).text(b)},fa=function(a,b){return a.map(function(a){return{id:a.id,isread:a.isRead,fromloggedinuser:a.fromLoggedInUser,userfrom:a.userFrom,text:a.text,formattedtime:a.timeCreated?b[a.timeCreated]:null}})},ga=function(b,c,e,f,g){var i=j(c),k=f.map(function(a){return d.render(h.DAY,{timestamp:a.value.timestamp,messages:fa(a.value.messages,g)})});return a.when.apply(a,k).then(function(){f.forEach(function(b,d){k[d].then(function(d){if(b.before){var e=Z(c,b.before.timestamp);return a(d).insertBefore(e)}else{return i.append(d)}}).catch(function(){})})})},ha=function(b,c,e,f,i){var j=f.map(function(a){return a.value}),k=fa(j,i);return d.render(h.MESSAGES,{messages:k}).then(function(b){var d=a(b);f.forEach(function(a){var b=d.find("[data-message-id=\""+a.value.id+"\"]");if(a.before){var e=Y(c,a.before.id);return b.insertBefore(e)}else{var f=Z(c,a.day.timestamp),h=f.find(g.DAY_MESSAGES_CONTAINER);return h.append(b)}})})},ia=function(a,b,c,d,e){d.forEach(function(a){var c=a.before,d=a.after,f=Y(b,c.id);if(c.id!=d.id){f.attr("data-message-id",d.id)}if(c.timeCreated!=d.timeCreated){var h=e[d.timeCreated];f.find(g.LOADING_ICON_CONTAINER).addClass("hidden");f.find(g.TIME_CREATED).text(h).removeClass("hidden")}if(c.sendState!=d.sendState){var i=f.find(g.LOADING_ICON_CONTAINER),j=f.find(g.TIME_CREATED),k=f.find(g.RETRY_SEND);i.addClass("hidden");i.attr("aria-hidden","true");j.addClass("hidden");j.attr("aria-hidden","true");k.addClass("hidden");k.attr("aria-hidden","true");f.removeClass("border border-danger");switch(d.sendState){case"pending":i.removeClass("hidden");i.attr("aria-hidden","false");break;case"error":k.removeClass("hidden");k.attr("aria-hidden","false");f.addClass("border border-danger");break;case"sent":j.removeClass("hidden");j.attr("aria-hidden","false");break;}}if(c.text!=d.text){f.find(g.TEXT_CONTAINER).html(d.text)}if(c.errorMessage!=d.errorMessage){var l=f.find(g.ERROR_MESSAGE_CONTAINER),a=l.find(g.ERROR_MESSAGE);if(d.errorMessage){l.removeClass("hidden");l.attr("aria-hidden","false");a.text(d.errorMessage)}else{l.addClass("hidden");l.attr("aria-hidden","true");a.text("")}}})},ja=function(a,b){b.forEach(function(b){Z(a,b.timestamp).remove()})},ka=function(a,b){b.forEach(function(b){Y(a,b.id).remove()})},la=function(b,d,f,g){var h=[],i=0<g.days.add.length,j=0<g.messages.add.length,k=0<g.messages.update.length,l=[],m=a.Deferred().resolve({}).promise();if(i){l=l.concat(g.days.add.reduce(function(a,b){return a.concat(b.value.messages.reduce(function(a,b){if(b.timeCreated){a.push(b.timeCreated)}return a},[]))},[]))}if(j){l=l.concat(g.messages.add.reduce(function(a,b){if(b.value.timeCreated){a.push(b.value.timeCreated)}return a},[]))}if(k){l=l.concat(g.messages.update.reduce(function(a,b){if(b.before.timeCreated!=b.after.timeCreated){a.push(b.after.timeCreated)}return a},[]))}if(l.length){m=c.get_string("strftimetime24","core_langconfig").then(function(a){var b=l.map(function(b){return{timestamp:b,format:a}});return e.get(b)}).then(function(a){return l.reduce(function(b,c,d){b[c]=a[d];return b},{})})}if(i){h.push(m.then(function(a){return ga(b,d,f,g.days.add,a)}))}if(j){h.push(m.then(function(a){return ha(b,d,f,g.messages.add,a)}))}if(k){h.push(m.then(function(a){return ia(b,d,f,g.messages.update,a)}))}if(0<g.days.remove.length){ja(d,g.days.remove)}if(0<g.messages.remove.length){ka(d,g.messages.remove)}return a.when.apply(a,h)},ma=function(a,b,c,e){var f=N(a),g=h.HEADER_PUBLIC;e.context.showrouteback="false"===a.attr("data-from-panel");if(e.type==i.PRIVATE){g=e.showControls?h.HEADER_PRIVATE:h.HEADER_PRIVATE_NO_CONTROLS}else if(e.type==i.SELF){g=h.HEADER_SELF}return d.render(g,e.context).then(function(a,b){d.replaceNodeContents(f,a,b)})},na=function(a,b,d,e){J(d);switch(e.type){case"placeholder":return x(d);case"add-contact":return c.get_strings([{key:"requirecontacttomessage",component:"core_message",param:e.user.fullname},{key:"isnotinyourcontacts",component:"core_message",param:e.user.fullname}]).then(function(a){var b=a[1],c=a[0],e=z(d);e.find(g.TITLE).text(b);e.find(g.TEXT).text(c);A(d);return a});case"edit-mode":return u(d);case"content":return r(d);case"unblock":return D(d);case"unable-to-message":return G(d);}return!0},oa=function(a,b,c,d){var e=j(b),f=Y(b,d),g=f.position();if(g){var h=e.scrollTop()+g.top;e.scrollTop(h)}},pa=function(a,b,c,d){if(d){P(a);U(a)}else{O(a);V(a)}},qa=function(a,b,c,d){if(d){l(b);L(b)}else{k(b);M(b)}},ra=function(a,b,c,d){if(d){_(b)}else{aa(b)}},sa=function(a,b,c,d){var e=W(c);if(d){e.removeClass("hidden");e.attr("aria-hidden",!1);e.find(g.EMOJI_PICKER_SEARCH_INPUT).focus()}else{e.addClass("hidden");e.attr("aria-hidden",!0)}},ta=function(a,b,c,d){var e=X(c);if(d){e.removeClass("hidden");e.attr("aria-hidden",!1)}else{e.addClass("hidden");e.attr("aria-hidden",!0)}},ua=function(b,c,d,e,f,h,i,j,k){var l=ba(c),m=e.map(function(a){return l.find(a)}),n=l.find(g.CONFIRM_DIALOGUE_CANCEL_BUTTON),o=l.find(g.CONFIRM_DIALOGUE_OKAY_BUTTON),p=l.find(g.CONFIRM_DIALOGUE_TEXT),q=l.find(g.CONFIRM_DIALOGUE_HEADER);l.find("button").addClass("hidden");if(i){n.removeClass("hidden")}else{n.addClass("hidden")}if(k){o.removeClass("hidden")}else{o.addClass("hidden")}if(h){q=a("<h3 class=\"h6\" data-region=\"dialogue-header\"></h3>");q.text(h);var r=l.find(g.CONFIRM_DIALOGUE);r.prepend(q)}else if(q.length){q.remove()}m.forEach(function(a){a.removeClass("hidden")});p.text(f);ca(d);ca(c);if(!j){ca(b)}l.find(g.CAN_RECEIVE_FOCUS).filter(":visible").first().focus()},va=function(a,b,c){var d=ba(b),e=d.find(g.CONFIRM_DIALOGUE_CANCEL_BUTTON),f=d.find(g.CONFIRM_DIALOGUE_OKAY_BUTTON),h=d.find(g.CONFIRM_DIALOGUE_TEXT),i=d.find(g.CONFIRM_DIALOGUE_HEADER);Ea(b);da(b);da(c);da(a);d.find("button").addClass("hidden");e.removeClass("hidden");f.removeClass("hidden");h.text("");if(i.length){i.remove()}a.find(g.CAN_RECEIVE_FOCUS).first().focus();return!0},wa=function(a,b,d,e){if(e){if(e.canmessageevenifblocked){return c.get_string("cantblockuser","core_message",e.fullname).then(function(c){return ua(a,b,d,[],c,"",!1,!1,!0)})}else{return c.get_string("blockuserconfirm","core_message",e.fullname).then(function(c){return ua(a,b,d,[g.ACTION_CONFIRM_BLOCK],c,"",!0,!1)})}}else{return va(a,b,d)}},xa=function(a,b,d,e){if(e){return c.get_string("unblockuserconfirm","core_message",e.fullname).then(function(c){return ua(a,b,d,[g.ACTION_CONFIRM_UNBLOCK],c,"",!0,!1)})}else{return va(a,b,d)}},ya=function(a,b,d,e){if(e){return c.get_string("addcontactconfirm","core_message",e.fullname).then(function(c){return ua(a,b,d,[g.ACTION_CONFIRM_ADD_CONTACT],c,"",!0,!1)})}else{return va(a,b,d)}},za=function(a,b,d,e){if(e){return c.get_string("removecontactconfirm","core_message",e.fullname).then(function(c){return ua(a,b,d,[g.ACTION_CONFIRM_REMOVE_CONTACT],c,"",!0,!1)})}else{return va(a,b,d)}},Aa=function(a,b,d,e){var f=null;if(e.type==i.SELF){f="deleteselectedmessagesconfirmselfconversation"}else{if(e.canDeleteMessagesForAllUsers){Da(b);f="deleteforeveryoneselectedmessagesconfirm"}else{f="deleteselectedmessagesconfirm"}}if(e.show){return c.get_string(f,"core_message").then(function(c){return ua(a,b,d,[g.ACTION_CONFIRM_DELETE_SELECTED_MESSAGES],c,"",!0,!1)})}else{return va(a,b,d)}},Ba=function(a,b,d,e){var f=null;if(e==i.SELF){f="deleteallselfconfirm"}else if(e){f="deleteallconfirm"}if(f){return c.get_string(f,"core_message").then(function(c){return ua(a,b,d,[g.ACTION_CONFIRM_DELETE_CONVERSATION],c,"",!0,!1)})}else{return va(a,b,d)}},Ca=function(a,b,d,e){if(e){return c.get_string("userwouldliketocontactyou","core_message",e.fullname).then(function(c){var e=[g.ACTION_ACCEPT_CONTACT_REQUEST,g.ACTION_DECLINE_CONTACT_REQUEST];return ua(a,b,d,e,c,"",!1,!0)})}else{return va(a,b,d)}},Da=function(a){var b=ba(a),c=b.find(g.DELETE_MESSAGES_FOR_ALL_USERS_TOGGLE_CONTAINER);c.removeClass("hidden")},Ea=function(a){var b=ba(a),c=b.find(g.DELETE_MESSAGES_FOR_ALL_USERS_TOGGLE_CONTAINER),d=b.find(g.DELETE_MESSAGES_FOR_ALL_USERS_TOGGLE);d.prop("checked",!1);c.addClass("hidden")},Fa=function(a,b,c,d){if(d){a.find(g.ACTION_REQUEST_BLOCK).addClass("hidden");a.find(g.ACTION_REQUEST_UNBLOCK).removeClass("hidden")}else{a.find(g.ACTION_REQUEST_BLOCK).removeClass("hidden");a.find(g.ACTION_REQUEST_UNBLOCK).addClass("hidden")}},Ga=function(a,b,c,d){var e=a.find(g.FAVOURITE_ICON_CONTAINER),f=a.find(g.ACTION_CONFIRM_FAVOURITE),h=a.find(g.ACTION_CONFIRM_UNFAVOURITE);switch(d){case"hide":e.addClass("hidden");f.addClass("hidden");h.addClass("hidden");break;case"show-add":e.addClass("hidden");f.removeClass("hidden");h.addClass("hidden");break;case"show-remove":e.removeClass("hidden");f.addClass("hidden");h.removeClass("hidden");break;}},Ha=function(a,b,c,d){var e=a.find(g.MUTED_ICON_CONTAINER),f=a.find(g.ACTION_CONFIRM_MUTE),h=a.find(g.ACTION_CONFIRM_UNMUTE);switch(d){case"hide":e.addClass("hidden");f.addClass("hidden");h.addClass("hidden");break;case"show-mute":e.addClass("hidden");f.removeClass("hidden");h.addClass("hidden");break;case"show-unmute":e.removeClass("hidden");f.addClass("hidden");h.removeClass("hidden");break;}},Ia=function(a,b,c,d){var e=a.find(g.ACTION_REQUEST_ADD_CONTACT),f=a.find(g.ACTION_REQUEST_REMOVE_CONTACT);switch(d){case"pending-contact":e.addClass("hidden");f.addClass("hidden");break;case"contact":e.addClass("hidden");f.removeClass("hidden");break;case"non-contact":e.removeClass("hidden");f.addClass("hidden");break;}},Ja=function(a,b,c,d){var e=ba(b),f=e.find("button"),h=e.find(g.CONFIRM_DIALOGUE_BUTTON_TEXT),i=e.find(g.LOADING_ICON_CONTAINER);if(d){f.prop("disabled",!0);h.addClass("hidden");i.removeClass("hidden")}else{f.prop("disabled",!1);h.removeClass("hidden");i.addClass("hidden")}},Ka=function(a,b,c,d){var e=null;if(d){e=b.find(g.MESSAGE_NOT_SELECTED);e.find(g.MESSAGE_NOT_SELECTED_ICON).removeClass("hidden");P(a);R(a)}else{e=j(b);e.find(g.MESSAGE_NOT_SELECTED_ICON).addClass("hidden");e.find(g.MESSAGE_SELECTED_ICON).addClass("hidden");O(a);S(a)}},La=function(a,b,c,d){var e=0<d.count;if(d.add.length){d.add.forEach(function(a){var c=Y(b,a);c.find(g.MESSAGE_NOT_SELECTED_ICON).addClass("hidden");c.find(g.MESSAGE_SELECTED_ICON).removeClass("hidden");c.attr("aria-checked",!0)})}if(d.remove.length){d.remove.forEach(function(a){var c=Y(b,a);if(e){c.find(g.MESSAGE_NOT_SELECTED_ICON).removeClass("hidden")}c.find(g.MESSAGE_SELECTED_ICON).addClass("hidden");c.attr("aria-checked",!1)})}ea(a,d.count)},Ma=function(a,b,d,e){if(e.show&&!e.hasMessages){return c.get_strings([{key:"requirecontacttomessage",component:"core_message",param:e.user.fullname},{key:"isnotinyourcontacts",component:"core_message",param:e.user.fullname}]).then(function(c){var e=c[1],f=c[0];return ua(a,b,d,[g.ACTION_REQUEST_ADD_CONTACT],f,e,!1,!0)})}else{return va(a,b,d)}},Na=function(a,b,c,d){var e=m(b);if(d){e.removeClass("hidden")}else{e.addClass("hidden")}return!0},Oa=function(a,b,d,e){var f=o(b);if(e){return c.get_string("yourcontactrequestpending","core_message",e).then(function(a){f.find(g.TEXT).text(a);f.removeClass("hidden");return a})}else{f.addClass("hidden");return!0}},Pa=function(a,b,c){va(a,b,c);p(b);n(b);I(a);U(a);J(c);x(c);return!0};return{render:function render(c,d,e,f){var g=[{reset:Pa},{conversation:la,header:ma,footer:na,confirmBlockUser:wa,confirmUnblockUser:xa,confirmAddContact:ya,confirmRemoveContact:za,confirmDeleteSelectedMessages:Aa,confirmDeleteConversation:Ba,confirmContactRequest:Ca,requireAddContact:Ma,selfConversationMessage:Na,contactRequestSent:Oa},{loadingMembers:pa,loadingFirstMessages:qa,loadingMessages:ra,isBlocked:Fa,isContact:Ia,isFavourite:Ga,isMuted:Ha,loadingConfirmAction:Ja,inEditMode:Ka,showEmojiPicker:sa,showEmojiAutoComplete:ta},{scrollToMessage:oa,selectedMessages:La}],h=function(a){var b=[];for(var g in f){if(a.hasOwnProperty(g)){var h=a[g],i=f[g];b.push(h(c,d,e,i))}}return b},i=h(g[0]);i=i.concat(h(g[1]));return a.when.apply(a,i).then(function(){for(var a=2;a<g.length;a++){h(g[a])}}).catch(b.exception)}}});
define ("core_message/message_notification_preference",["jquery","core_message/notification_preference"],function(a,b){var c={PREFERENCE_KEY:"[data-preference-key]"},d=function(a,c){b.call(this,a,c)};d.prototype=Object.create(b.prototype);d.prototype.constructor=d;d.prototype.getPreferenceKey=function(){return this.root.find(c.PREFERENCE_KEY).attr("data-preference-key")};return d});
define ("core_message/message_drawer_view_conversation_state_manager",["jquery"],function(a){var b=function(b){return a.extend(!0,{},b)},c=function(a,b,c){return a.map(function(a){var d=a.useridfrom==b;return{id:""+a.id,fromLoggedInUser:d,userFrom:c[a.useridfrom],text:a.text,timeCreated:a.timecreated?parseInt(a.timecreated,10):null}})},d=function(a){return a.map(function(a){return{id:a.id,fullname:a.fullname,profileurl:a.profileurl,profileimageurl:a.profileimageurl,profileimageurlsmall:a.profileimageurlsmall,isonline:a.isonline,showonlinestatus:a.showonlinestatus,isblocked:a.isblocked,iscontact:a.iscontact,isdeleted:a.isdeleted,canmessage:a.canmessage,canmessageevenifblocked:a.canmessageevenifblocked,requirescontact:a.requirescontact,contactrequests:a.contactrequests||[]}})};return{buildInitialState:function buildInitialState(a,b,c,d,e,f){return{midnight:a,loggedInUserId:b,id:c,messagePollMin:d,messagePollMax:e,messagePollAfterMax:f,name:null,subname:null,type:null,totalMemberCount:null,imageUrl:null,isFavourite:null,isMuted:null,canDeleteMessagesForAllUsers:!1,deleteMessagesForAllUsers:!1,members:{},messages:[],hasTriedToLoadMessages:!1,loadingMessages:!0,loadingMembers:!0,loadingConfirmAction:!1,pendingBlockUserIds:[],pendingUnblockUserIds:[],pendingRemoveContactIds:[],pendingAddContactIds:[],pendingDeleteMessageIds:[],pendingSendMessageIds:[],pendingDeleteConversation:!1,selectedMessageIds:[],showEmojiAutoComplete:!1,showEmojiPicker:!1}},addMessages:function addMessages(a,d){var e=b(a),f=c(d,a.loggedInUserId,a.members);f=f.map(function(a){a.sendState=null;a.timeAdded=Date.now();a.errorMessage=null;return a});var g=a.messages.concat(f);g.sort(function(c,a){if(null===c.timeCreated&&null===a.timeCreated){if(c.timeAdded<a.timeAdded){return-1}else if(c.timeAdded>a.timeAdded){return 1}}if(null===c.timeCreated&&null!==a.timeCreated){return 1}else if(null!==c.timeCreated&&null===a.timeCreated){return-1}else if(c.timeCreated<a.timeCreated){return-1}else if(c.timeCreated>a.timeCreated){return 1}else if(c.id<a.id){return-1}else if(c.id>a.id){return 1}else{return 0}});e.messages=g.filter(function(a,b,c){return!b||a.id!=c[b-1].id});return e},updateMessages:function updateMessages(d,e){var f=b(d),g=e.reduce(function(a,b){var e=b[0],f=b[1],g=c([f],d.loggedInUserId,d.members),h=g[0];a[e.id]=h;return a},{});f.messages=f.messages.map(function(b){if(b.id in g){return a.extend(b,g[b.id])}else{return b}});return f},removeMessages:function removeMessages(a,c){var d=b(a),e=c.map(function(a){return""+a.id});d.messages=d.messages.filter(function(a){return 0>e.indexOf(a.id)});return d},removeMessagesById:function removeMessagesById(a,c){var d=b(a);c=c.map(function(a){return""+a});d.messages=d.messages.filter(function(a){return 0>c.indexOf(a.id)});return d},addMembers:function addMembers(a,c){var e=b(a),f=d(c);f.forEach(function(a){e.members[a.id]=a});return e},removeMembers:function removeMembers(a,c){var d=b(a);c.forEach(function(a){delete d.members[a.id]});return d},setLoadingMessages:function setLoadingMessages(a,c){var d=b(a);d.loadingMessages=c;if(a.loadingMessages&&!c){d.hasTriedToLoadMessages=!0}return d},setLoadingMembers:function setLoadingMembers(a,c){var d=b(a);d.loadingMembers=c;return d},setId:function setId(a,c){var d=b(a);d.id=c;return d},setName:function setName(a,c){var d=b(a);d.name=c;return d},setSubname:function setSubname(a,c){var d=b(a);d.subname=c;return d},setType:function setType(a,c){var d=b(a);d.type=c;return d},setIsFavourite:function setIsFavourite(a,c){var d=b(a);d.isFavourite=c;return d},setIsMuted:function setIsMuted(a,c){var d=b(a);d.isMuted=c;return d},setCanDeleteMessagesForAllUsers:function setCanDeleteMessagesForAllUsers(a,c){var d=b(a);d.canDeleteMessagesForAllUsers=c;return d},setDeleteMessagesForAllUsers:function setDeleteMessagesForAllUsers(a,c){var d=b(a);d.deleteMessagesForAllUsers=c;return d},setTotalMemberCount:function setTotalMemberCount(a,c){var d=b(a);d.totalMemberCount=c;return d},setImageUrl:function setImageUrl(a,c){var d=b(a);d.imageUrl=c;return d},setLoadingConfirmAction:function setLoadingConfirmAction(a,c){var d=b(a);d.loadingConfirmAction=c;return d},setPendingDeleteConversation:function setPendingDeleteConversation(a,c){var d=b(a);d.pendingDeleteConversation=c;return d},setMessagesSendPendingById:function setMessagesSendPendingById(a,c){var d=b(a);c=c.map(function(a){return""+a});d.messages.forEach(function(a){if(0<=c.indexOf(a.id)){a.sendState="pending";a.errorMessage=null}});return d},setMessagesSendSuccessById:function setMessagesSendSuccessById(a,c){var d=b(a);c=c.map(function(a){return""+a});d.messages.forEach(function(a){if(0<=c.indexOf(a.id)){a.sendState="sent";a.errorMessage=null}});return d},setMessagesSendFailById:function setMessagesSendFailById(a,c,d){var e=b(a);c=c.map(function(a){return""+a});e.messages.forEach(function(a){if(0<=c.indexOf(a.id)){a.sendState="error";a.errorMessage=d}});return e},setShowEmojiAutoComplete:function setShowEmojiAutoComplete(a,c){var d=b(a);d.showEmojiAutoComplete=c;return d},setShowEmojiPicker:function setShowEmojiPicker(a,c){var d=b(a);d.showEmojiPicker=c;return d},addPendingBlockUsersById:function addPendingBlockUsersById(a,c){var d=b(a);c.forEach(function(a){d.pendingBlockUserIds.push(a)});return d},addPendingRemoveContactsById:function addPendingRemoveContactsById(a,c){var d=b(a);c.forEach(function(a){d.pendingRemoveContactIds.push(a)});return d},addPendingUnblockUsersById:function addPendingUnblockUsersById(a,c){var d=b(a);c.forEach(function(a){d.pendingUnblockUserIds.push(a)});return d},addPendingAddContactsById:function addPendingAddContactsById(a,c){var d=b(a);c.forEach(function(a){d.pendingAddContactIds.push(a)});return d},addPendingDeleteMessagesById:function addPendingDeleteMessagesById(a,c){var d=b(a);c.forEach(function(a){d.pendingDeleteMessageIds.push(a)});return d},removePendingBlockUsersById:function removePendingBlockUsersById(a,c){var d=b(a);d.pendingBlockUserIds=d.pendingBlockUserIds.filter(function(a){return 0>c.indexOf(a)});return d},removePendingRemoveContactsById:function removePendingRemoveContactsById(a,c){var d=b(a);d.pendingRemoveContactIds=d.pendingRemoveContactIds.filter(function(a){return 0>c.indexOf(a)});return d},removePendingUnblockUsersById:function removePendingUnblockUsersById(a,c){var d=b(a);d.pendingUnblockUserIds=d.pendingUnblockUserIds.filter(function(a){return 0>c.indexOf(a)});return d},removePendingAddContactsById:function removePendingAddContactsById(a,c){var d=b(a);d.pendingAddContactIds=d.pendingAddContactIds.filter(function(a){return 0>c.indexOf(a)});return d},removePendingDeleteMessagesById:function removePendingDeleteMessagesById(a,c){var d=b(a);c=c.map(function(a){return""+a});d.pendingDeleteMessageIds=d.pendingDeleteMessageIds.filter(function(a){return 0>c.indexOf(a)});return d},addSelectedMessagesById:function addSelectedMessagesById(a,c){var d=b(a);c=c.map(function(a){return""+a});d.selectedMessageIds=d.selectedMessageIds.concat(c);return d},removeSelectedMessagesById:function removeSelectedMessagesById(a,c){var d=b(a);c=c.map(function(a){return""+a});d.selectedMessageIds=d.selectedMessageIds.filter(function(a){return 0>c.indexOf(a)});return d},markMessagesAsRead:function markMessagesAsRead(a,c){var d=b(a),e=c.map(function(a){return a.id});d.messages=d.messages.map(function(a){if(0<=e.indexOf(a.id)){a.isRead=!0}return a});return d},addContactRequests:function addContactRequests(a,c){var d=b(a);c.forEach(function(a){var b=a.userid,c=a.requesteduserid;d.members[b].contactrequests.push(a);d.members[c].contactrequests.push(a)});return d},removeContactRequests:function removeContactRequests(a,c){var d=b(a);c.forEach(function(a){var b=a.userid,c=a.requesteduserid;d.members[b].contactrequests=d.members[b].contactrequests.filter(function(a){return a.userid!=b});d.members[c].contactrequests=d.members[c].contactrequests.filter(function(a){return a.requesteduserid!=c})});return d}}});
define ("core_message/message_drawer_view_group_info",["jquery","core/str","core/templates","core_message/message_repository","core_message/message_drawer_lazy_load_list"],function(a,b,c,d,e){var f={CONTENT_CONTAINER:"[data-region=\"group-info-content-container\"]",MEMBERS_LIST:"[data-region=\"members-list\"]"},g={CONTENT:"core_message/message_drawer_view_group_info_body_content",MEMBERS_LIST:"core_message/message_drawer_view_group_info_participants_list"},h=function(a){return a.find(f.CONTENT_CONTAINER)},i=function(a,b,d){var e=50<b.totalMemberCount?50:b.totalMemberCount,f=Array.apply(null,Array(e)).map(function(){return!0}),i={name:b.name,subname:b.subname,imageurl:b.imageUrl,placeholders:f,loggedinuser:{id:d}};return c.render(g.CONTENT,i).then(function(b){h(a).append(b);return b})},j=function(a,b,c){return function(f,g){return d.getConversationMembers(a.id,g,b+1,c).then(function(a){if(a.length>b){a=a.slice(0,-1)}else{e.setLoadedAll(f,!0)}c=c+b;return a.filter(function(a){return a.id!=g})})}},k=function(a,b){return c.render(g.MEMBERS_LIST,{contacts:b}).then(function(b){a.append(b);return b})};return{show:function show(b,c,d,f,g,l){var m=a(d);h(m).empty();return i(m,g,l).then(function(){var a=e.getRoot(m);e.show(a,j(g,50,0),k)})},description:function description(a,c){return b.get_string("messagedrawerviewgroupinfo","core_message",c.name)}}});
define ("core_message/message_user_button",["jquery","core/custom_interaction_events","core_message/message_drawer_helper","core/templates"],function(a,b,c,d){var e={MESSAGE_TEXTAREA:"[data-region=\"send-message-txt\"]",MESSAGE_USER_BUTTON:"#message-user-button",MESSAGE_JUMP:"[data-region=\"jumpto\"]"},f={CONTENT:"core_message/message_jumpto"},g=function(a){return parseInt(a.attr("data-userid"))},h=function(a){return parseInt(a.attr("data-conversationid"))};return{send:function send(i){i=a(i);var j={conversationid:h(i),buttonid:a(i).attr("id"),userid:g(i)};d.render(f.CONTENT,{}).then(function(a){i.after(a)}).then(function(){a(e.MESSAGE_USER_BUTTON).next().focus(function(){a(e.MESSAGE_TEXTAREA).focus()})});b.define(i,[b.events.activate]);i.on(b.events.activate,function(b,d){if(a(b.target).hasClass("active")){c.hide();a(e.MESSAGE_USER_BUTTON).next().attr("tabindex",-1)}else{a(e.MESSAGE_USER_BUTTON).next().attr("tabindex",0);if(j.conversationid){c.showConversation(j)}else{c.createConversationWithUser(j)}}a(b.target).focus();a(b.target).toggleClass("active");b.preventDefault();d.originalEvent.preventDefault()})}}});
define ("core_message/toggle_contact_button",["jquery","core/ajax","core/templates","core/notification","core/custom_interaction_events"],function(a,b,c,d,e){var f=function(a){return"1"==a.attr("data-is-contact")},g=function(a){a.attr("data-is-contact","1")},h=function(a){a.attr("data-is-contact","0")},i=function(a){return a.attr("data-userid")},j=function(a){return a.hasClass("loading")||a.attr("disabled")},k=function(c,e){if(j(c)){return a.Deferred()}c.addClass("loading");c.attr("disabled","disabled");return b.call([e])[0].fail(d.exception).always(function(){c.removeClass("loading");c.removeAttr("disabled")})},l=function(a){if(j(a)){return}var b={methodname:"core_message_create_contacts",args:{userids:[i(a)]}};k(a,b).done(function(){g(a);c.render("message/remove_contact_button",{}).done(function(b,d){c.replaceNodeContents(a,b,d)})})},m=function(a){if(j(a)){return}var b={methodname:"core_message_delete_contacts",args:{userids:[i(a)]}};k(a,b).done(function(){h(a);c.render("message/add_contact_button",{}).done(function(b,d){c.replaceNodeContents(a,b,d)})})};return{enhance:function enhance(b){b=a(b);if(!b.children(".loading-icon").length){c.render("core/loading",{}).done(function(a,c){b.append(a,c)})}e.define(b,[e.events.activate]);b.on(e.events.activate,function(a,c){if(f(b)){m(b)}else{l(b)}a.preventDefault();c.originalEvent.preventDefault()})}}});
define ("core_message/notification_preference",["jquery","core/ajax","core/notification","core_message/notification_processor"],function(a,b,c,d){var e={PROCESSOR:"[data-processor-name]",STATE_INPUTS:"[data-state] input"},f=function(b,c){this.root=a(b);this.userId=c};f.prototype.getPreferenceKey=function(){return this.root.attr("data-preference-key")};f.prototype.getLoggedInPreferenceKey=function(){return this.getPreferenceKey()+"_loggedin"};f.prototype.getLoggedOffPreferenceKey=function(){return this.getPreferenceKey()+"_loggedoff"};f.prototype.getProcessors=function(){return this.root.find(e.PROCESSOR).map(function(b,c){return new d(a(c))})};f.prototype.startLoading=function(){this.root.addClass("loading");this.root.find(e.STATE_INPUTS).prop("disabled",!0)};f.prototype.stopLoading=function(){this.root.removeClass("loading");this.root.find(e.STATE_INPUTS).prop("disabled",!1)};f.prototype.isLoading=function(){return this.root.hasClass("loading")};f.prototype.save=function(){if(this.isLoading()){return a.Deferred().resolve()}this.startLoading();var d="",e="";this.getProcessors().each(function(a,b){if(b.isLoggedInEnabled()){if(""===d){d=b.getName()}else{d+=","+b.getName()}}if(b.isLoggedOffEnabled()){if(""===e){e=b.getName()}else{e+=","+b.getName()}}});if(""===d){d="none"}if(""===e){e="none"}var f={userid:this.userId,preferences:[{type:this.getLoggedInPreferenceKey(),value:d},{type:this.getLoggedOffPreferenceKey(),value:e}]};return b.call([{methodname:"core_user_update_user_preferences",args:f}])[0].fail(c.exception).always(function(){this.stopLoading()}.bind(this))};return f});
define ("core_message/preferences_notifications_list_controller",["jquery","core/ajax","core/notification","core/custom_interaction_events","core_message/notification_preference","core_message/notification_processor_settings","core/modal_factory"],function(a,b,c,d,f,g,h){var i={DISABLE_NOTIFICATIONS:"[data-region=\"disable-notification-container\"] [data-disable-notifications]",DISABLE_NOTIFICATIONS_CONTAINER:"[data-region=\"disable-notification-container\"]",PREFERENCE:"[data-state]",PREFERENCE_ROW:"[data-region=\"preference-row\"]",PREFERENCE_INPUT:"[data-state] input",PROCESSOR_SETTING:"[data-processor-setting]"},j=function(b){this.root=a(b);this.userId=this.root.attr("data-user-id");this.registerEventListeners()};j.prototype.isDisabled=function(){return this.root.hasClass("disabled")};j.prototype.setDisabled=function(){this.root.addClass("disabled");this.root.find(i.PREFERENCE_INPUT).prop("disabled",!0)};j.prototype.setEnabled=function(){this.root.removeClass("disabled");this.root.find(i.PREFERENCE_INPUT).prop("disabled",!1)};j.prototype.toggleDisableAllStatus=function(){var d=a(i.DISABLE_NOTIFICATIONS),e=a(i.DISABLE_NOTIFICATIONS_CONTAINER),f=d.prop("checked");if(e.hasClass("loading")){return a.Deferred().resolve()}e.addClass("loading");var g={methodname:"core_user_update_user_preferences",args:{userid:this.userId,emailstop:f?1:0}};return b.call([g])[0].done(function(){if(f){this.setDisabled()}else{this.setEnabled()}}.bind(this)).always(function(){e.removeClass("loading")}).fail(c.exception)};j.prototype.registerEventListeners=function(){var b=a(i.DISABLE_NOTIFICATIONS);d.define(this.root,[d.events.activate]);this.root.on("change",function(b){if(!this.isDisabled()){var c=a(b.target).closest(i.PREFERENCE),d=a(b.target).closest(i.PREFERENCE_ROW),e=new f(d,this.userId);c.addClass("loading");e.save().always(function(){c.removeClass("loading")})}}.bind(this));var j=h.create({type:g.TYPE});this.root.on(d.events.activate,i.PROCESSOR_SETTING,function(b){var d=a(b.target).closest(i.PROCESSOR_SETTING);b.preventDefault();j.then(function(c){c.setUserId(a(d).attr("data-user-id"));c.setName(a(d).attr("data-name"));c.setContextId(a(d).attr("data-context-id"));c.setElement(d);c.show();b.stopImmediatePropagation()}).fail(c.exception)});d.define(b,[d.events.activate]);b.on(d.events.activate,function(){this.toggleDisableAllStatus()}.bind(this))};return j});
define ("core_question/edit_tags",["jquery","core/fragment","core/str","core/modal_events","core/modal_factory","core/notification","core/custom_interaction_events","core_question/repository","core_question/selectors"],function(a,b,c,d,e,f,g,h,i){var j=function(a){a.find(i.actions.save).prop("disabled",!1)},k=function(a){a.find(i.actions.save).prop("disabled",!0)},l=function(a){return a.getBody().find("form").serialize()},m=function(a){var b=a.find(i.containers.loadingIcon);b.removeClass("hidden")},n=function(a){var b=a.find(i.containers.loadingIcon);b.addClass("hidden")},o=function(a,b){a.getBody().attr("data-contextid",b)},p=function(a){return a.getBody().data("contextid")},q=function(a,b){a.getBody().attr("data-questionid",b)},r=function(a){return a.getBody().data("questionid")},s=function(h){var l=e.create({type:e.types.SAVE_CANCEL,large:!1},[h,i.actions.edittags]).then(function(a){c.get_string("questiontags","question").then(function(b){a.setTitle(b);return b}).fail(f.exception);a.getRoot().on(d.save,function(b){var c=a.getBody().find("form");c.submit();b.preventDefault()});a.getRoot().on("submit","form",function(b){t(a,h).then(function(){a.hide();location.reload()}).fail(f.exception);b.preventDefault();b.stopPropagation()});return a});h.on(g.events.activate,i.actions.edittags,function(c){var d=a(c.currentTarget),e=d.data("questionid"),g=!!d.data("cantag"),p=d.data("contextid");l.then(function(a){k(h);m(h);var c=b.loadFragment("question","tags_form",p,{id:e});a.setBody(c);c.then(function(){j(h)}).always(function(){n(h)}).fail(f.exception);if(g){a.getRoot().find(i.actions.save).show()}else{a.getRoot().find(i.actions.save).hide()}q(a,e);o(a,p);return a}).fail(f.exception);c.preventDefault()})},t=function(a,b){k(b);m(b);var c=l(a),d=r(a),e=p(a);return h.submitTagCreateUpdateForm(d,e,c).always(function(){n(b);j(b)}).fail(f.exception)};return{init:function init(b){b=a(b);s(b)}}});
define ("core_question/repository",["jquery","core/ajax"],function(a,b){return{submitTagCreateUpdateForm:function submitTagCreateUpdateForm(a,c,d){return b.call([{methodname:"core_question_submit_tags_form",args:{questionid:a,contextid:c,formdata:d}}])[0]}}});
define ("core_question/selectors",[],function(){return{actions:{save:"[data-action=\"save\"]",edittags:"[data-action=\"edittags\"]"},containers:{loadingIcon:"[data-region=\"overlay-icon-container\"]"}}});
define ("core_search/form-search-user-selector",["jquery","core/ajax","core/templates"],function(a,b,c){return{processResults:function processResults(b,c){var d=[];a.each(c,function(a,b){d.push({value:b.id,label:b._label})});return d},transport:function transport(d,e,f,g){var h,i={query:e},j=a(d).attr("withincourseid");if("undefined"!=typeof j&&""!==a("#id_searchwithin").val()){i.courseid=j}else{i.courseid=0}h=b.call([{methodname:"core_search_get_relevant_users",args:i}]);h[0].then(function(b){var d=[];a.each(b,function(a,b){d.push(c.render("core_search/form-user-selector-suggestion",b))});return a.when.apply(a.when,d).then(function(){var c=arguments,d=0;a.each(b,function(a,b){b._label=c[d++]});f(b)})}).fail(g)}}});
define ("core_table/local/dynamic/events",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var b={tableContentRefreshed:function prefixEventName(a){return"core_table/dynamic:".concat(a)}("tableContentRefreshed")};a.default=b;return a.default});
define ("core_table/local/dynamic/repository",["exports","core/ajax"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.fetch=void 0;a.fetch=function fetch(a,c,d){var e=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{},f=e.sortData,g=void 0===f?[]:f,h=e.joinType,i=void 0===h?null:h,j=e.filters,k=void 0===j?{}:j,l=e.firstinitial,m=void 0===l?null:l,n=e.lastinitial,o=void 0===n?null:n,p=e.pageNumber,q=void 0===p?null:p,r=e.pageSize,s=void 0===r?null:r,t=e.hiddenColumns,u=void 0===t?{}:t,v=4<arguments.length&&arguments[4]!==void 0?arguments[4]:!1;return(0,b.call)([{methodname:"core_table_get_dynamic_table_content",args:{component:a,handler:c,uniqueid:d,sortdata:g,jointype:i,filters:k,firstinitial:m,lastinitial:o,pagenumber:q,pagesize:s,hiddencolumns:u,resetpreferences:v}}])[0]}});
define ("core_table/local/dynamic/selectors",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;a.default={main:{region:"[data-region=\"core_table/dynamic\"]",fromRegionId:function fromRegionId(a){return"[data-region=\"core_table/dynamic\"][data-table-uniqueid=\"".concat(a,"\"]")}},table:{links:{sortableColumn:"a[data-sortable=\"1\"]",hide:"a[data-action=\"hide\"]",show:"a[data-action=\"show\"]"}},initialsBar:{links:{firstInitial:".firstinitial [data-initial]",lastInitial:".lastinitial [data-initial]"}},paginationBar:{links:{pageItem:".pagination [data-page-number]"}}};return a.default});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_table/dynamic",["exports","core_table/local/dynamic/selectors","./local/dynamic/events","core/pending","core/loadingicon","core_table/local/dynamic/repository","core/notification"],function(a,b,c,d,e,f,g){"use strict";Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"Events",{enumerable:!0,get:function get(){return c.default}});a.getTableFromId=a.init=a.showColumn=a.hideColumn=a.getLastInitial=a.setLastInitial=a.getFirstInitial=a.setFirstInitial=a.getPageSize=a.setPageSize=a.getPageNumber=a.setPageNumber=a.setSortOrder=a.getFilters=a.setFilters=a.updateTable=a.refreshTableContent=void 0;b=j(b);c=h(c);d=h(d);g=h(g);function h(a){return a&&a.__esModule?a:{default:a}}function i(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;i=function(){return a};return a}function j(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=i();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function k(a){return o(a)||n(a)||m(a)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(a,b){if(!a)return;if("string"==typeof a)return p(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return p(a,b)}function n(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function o(a){if(Array.isArray(a))return p(a)}function p(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}var q=!1,r=function(a){if(!a){throw new Error("The table specified is not a dynamic table and cannot be updated")}if(!a.matches(b.main.region)){throw new Error("The table specified is not a dynamic table and cannot be updated")}return!0},s=function(a){return JSON.parse(a.dataset.tableFilters)},t=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1,g=s(a);(0,e.addIconToContainer)(a);var h=new d.default("core_table/dynamic:refreshTableContent");return(0,f.fetch)(a.dataset.tableComponent,a.dataset.tableHandler,a.dataset.tableUniqueid,{sortData:JSON.parse(a.dataset.tableSortData),joinType:g.jointype,filters:g.filters,firstinitial:a.dataset.tableFirstInitial,lastinitial:a.dataset.tableLastInitial,pageNumber:a.dataset.tablePageNumber,pageSize:a.dataset.tablePageSize,hiddenColumns:JSON.parse(a.dataset.tableHiddenColumns)},b).then(function(b){var c=document.createElement("div");c.innerHTML=b.html;a.replaceWith.apply(a,k(c.childNodes));return E(a.dataset.tableUniqueid)}).then(function(a){a.dispatchEvent(new CustomEvent(c.default.tableContentRefreshed,{bubbles:!0}));return a}).then(function(a){h.resolve();return a})};a.refreshTableContent=t;var u=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},c=b.sortBy,e=void 0===c?null:c,f=b.sortOrder,g=void 0===f?null:f,h=b.filters,i=void 0===h?null:h,j=b.firstInitial,k=void 0===j?null:j,l=b.lastInitial,m=void 0===l?null:l,n=b.pageNumber,o=void 0===n?null:n,p=b.pageSize,q=void 0===p?null:p,s=b.hiddenColumns,u=void 0===s?null:s,v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0;r(a);var w=new d.default("core_table/dynamic:updateTable"),x=!1;if(e&&g){x=!0;var y=JSON.parse(a.dataset.tableSortData);y.unshift({sortby:e,sortorder:parseInt(g,10)});a.dataset.tableSortData=JSON.stringify(y)}if(null!==k){if(a.dataset.tableFirstInitial!==k){x=!0}a.dataset.tableFirstInitial=k}if(null!==m){if(a.dataset.tableLastInitial!==m){x=!0}a.dataset.tableLastInitial=m}if(null!==q){if(a.dataset.tablePageSize!=q){x=!0}a.dataset.tablePageSize=q}if(i){var z=JSON.stringify(i);if(a.dataset.tableFilters!==z){x=!0}a.dataset.tableFilters=z}if(x){o=1}if(u){var A=JSON.stringify(u);if(a.dataset.tableHiddenColumns!==A){x=!0}a.dataset.tableHiddenColumns=A}if(null!==o){if(a.dataset.tablePageNumber!=o){x=!0}a.dataset.tablePageNumber=o}if(v&&x){return t(a).then(function(a){w.resolve();return a})}else{w.resolve();return Promise.resolve(a)}};a.updateTable=u;var v=function(a){r(a);return a.dataset};a.setFilters=function setFilters(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0;return u(a,{filters:b},c)};a.getFilters=function getFilters(a){r(a);return s(a)};var w=function(a,b,c){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:!0;return u(a,{sortBy:b,sortOrder:c},d)};a.setSortOrder=w;var x=function(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0;return u(a,{pageNumber:b},c)};a.setPageNumber=x;a.getPageNumber=function getPageNumber(a){return v(a).tablePageNumber};a.setPageSize=function setPageSize(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0;return u(a,{pageSize:b,pageNumber:1},c)};a.getPageSize=function getPageSize(a){return v(a).tablePageSize};var y=function(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0;return u(a,{firstInitial:b},c)};a.setFirstInitial=y;a.getFirstInitial=function getFirstInitial(a){return v(a).tableFirstInitial};var z=function(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0;return u(a,{lastInitial:b},c)};a.setLastInitial=z;a.getLastInitial=function getLastInitial(a){return v(a).tableLastInitial};var A=function(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0,d=JSON.parse(a.dataset.tableHiddenColumns);d.push(b);return u(a,{hiddenColumns:d},c)};a.hideColumn=A;var B=function(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0,d=JSON.parse(a.dataset.tableHiddenColumns);d=d.filter(function(a){return a!==b});return u(a,{hiddenColumns:d},c)};a.showColumn=B;var C=function(a){return t(a,!0)},D=function(){if(q){return}q=!0;document.addEventListener("click",function(a){var c=a.target.closest(b.main.region);if(!c){return}var d=a.target.closest(b.table.links.sortableColumn);if(d){a.preventDefault();w(c,d.dataset.sortby,d.dataset.sortorder).catch(g.default.exception)}var e=a.target.closest(b.initialsBar.links.firstInitial);if(null!==e){a.preventDefault();y(c,e.dataset.initial).catch(g.default.exception)}var f=a.target.closest(b.initialsBar.links.lastInitial);if(null!==f){a.preventDefault();z(c,f.dataset.initial).catch(g.default.exception)}var h=a.target.closest(b.paginationBar.links.pageItem);if(h){a.preventDefault();x(c,h.dataset.pageNumber).catch(g.default.exception)}var i=a.target.closest(b.table.links.hide);if(i){a.preventDefault();A(c,i.dataset.column).catch(g.default.exception)}var j=a.target.closest(b.table.links.show);if(j){a.preventDefault();B(c,j.dataset.column).catch(g.default.exception)}var k=a.target.closest(".resettable a");if(k){a.preventDefault();C(c).catch(g.default.exception)}})};a.init=D;var E=function(a){var c=document.querySelector(b.main.fromRegionId(a));if(!c){throw new Error("The table specified is not a dynamic table and cannot be updated")}return c};a.getTableFromId=E});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_user/local/participants/bulkactions",["exports","core_user/repository","core/str","core/modal_events","core/modal_factory","core/notification","core/templates","core/toast"],function(a,b,c,d,e,f,g,h){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.showSendMessage=a.showAddNote=void 0;b=k(b);c=k(c);d=i(d);e=i(e);f=i(f);g=i(g);function i(a){return a&&a.__esModule?a:{default:a}}function j(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;j=function(){return a};return a}function k(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=j();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}var l=function(a,b,f,h){if(!b.length){return Promise.resolve()}var i=[];for(var l in f){switch(l){case"draft":i.push({value:"personal",label:f[l]});break;case"public":i.push({value:"course",label:f[l],selected:1});break;case"site":i.push({value:l,label:f[l]});break;}}var j={stateNames:i,stateHelpIcon:h.innerHTML},k=null;if(1===b.length){k=c.get_string("addbulknotesingle","core_notes")}else{k=c.get_string("addbulknote","core_notes",b.length)}return e.default.create({type:e.default.types.SAVE_CANCEL,body:g.default.render("core_user/add_bulk_note",j),title:k,buttons:{save:k},removeOnClose:!0}).then(function(c){c.getRoot().on(d.default.save,function(){return m(a,b,c)});c.show();return c})};a.showAddNote=l;var m=function(a,d,e){var g=e.getRoot().find("form textarea").val(),i=e.getRoot().find("form select").val(),j=d.map(function(b){return{userid:b,text:g,courseid:a,publishstate:i}});return b.createNotesForUsers(j).then(function(a){if(1===a.length){return c.get_string("addbulknotedonesingle","core_notes")}else{return c.get_string("addbulknotedone","core_notes",a.length)}}).then(function(a){return(0,h.add)(a)}).catch(f.default.exception)},n=function(a){if(!a.length){return Promise.resolve()}var b;if(1===a.length){b=c.get_string("sendbulkmessagesingle","core_message")}else{b=c.get_string("sendbulkmessage","core_message",a.length)}return e.default.create({type:e.default.types.SAVE_CANCEL,body:g.default.render("core_user/send_bulk_message",{}),title:b,buttons:{save:b},removeOnClose:!0}).then(function(b){b.getRoot().on(d.default.save,function(c){var d=b.getRoot().find("form textarea").val();if(""===d.trim()){b.getRoot().find("[data-role=\"messagetextrequired\"]").removeAttr("hidden");c.preventDefault();return}o(b,a,d)});b.show();return b})};a.showSendMessage=n;var o=function(a,d,e){var g=d.map(function(a){return{touserid:a,text:e}});return b.sendMessagesToUsers(g).then(function(a){if(1==a.length){return c.get_string("sendbulkmessagesentsingle","core_message")}else{return c.get_string("sendbulkmessagesent","core_message",a.length)}}).then(function(a){return(0,h.add)(a)}).catch(f.default.exception)}});
define ("core_user/local/participantsfilter/filtertypes/courseid",["exports","../filter"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);function c(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){c=function(a){return typeof a}}else{c=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return c(a)}function d(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function e(a){return function(){var b=this,c=arguments;return new Promise(function(e,f){var i=a.apply(b,c);function g(a){d(i,e,f,g,h,"next",a)}function h(a){d(i,e,f,g,h,"throw",a)}g(void 0)})}}function f(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function g(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function h(a,b,c){if(b)g(a.prototype,b);if(c)g(a,c);return a}function i(a,b){if("function"!=typeof b&&null!==b){throw new TypeError("Super expression must either be null or a function")}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});if(b)j(a,b)}function j(a,b){j=Object.setPrototypeOf||function(a,b){a.__proto__=b;return a};return j(a,b)}function k(a){return function(){var b=p(a),c;if(n()){var d=p(this).constructor;c=Reflect.construct(b,arguments,d)}else{c=b.apply(this,arguments)}return l(this,c)}}function l(a,b){if(b&&("object"===c(b)||"function"==typeof b)){return b}return m(a)}function m(a){if(void 0===a){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return a}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(a){return!1}}function p(a){p=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return p(a)}var q=function(a){i(b,a);var c=k(b);function b(a,d){f(this,b);return c.call(this,a,d)}h(b,[{key:"addValueSelector",value:function(){var a=e(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:case"end":return a.stop();}}},a)}));return function addValueSelector(){return a.apply(this,arguments)}}()},{key:"filterValue",get:function get(){return{name:this.name,jointype:1,values:[parseInt(this.rootNode.dataset.tableCourseId,10)]}}}]);return b}(b.default);a.default=q;return a.default});
define ("core_user/local/participantsfilter/filtertypes/keyword",["exports","../filter","core/str"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);function d(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){d=function(a){return typeof a}}else{d=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return d(a)}function e(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function f(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function g(a,b,c){if(b)f(a.prototype,b);if(c)f(a,c);return a}function h(a,b){if("function"!=typeof b&&null!==b){throw new TypeError("Super expression must either be null or a function")}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});if(b)i(a,b)}function i(a,b){i=Object.setPrototypeOf||function(a,b){a.__proto__=b;return a};return i(a,b)}function j(a){return function(){var b=n(a),c;if(m()){var d=n(this).constructor;c=Reflect.construct(b,arguments,d)}else{c=b.apply(this,arguments)}return k(this,c)}}function k(a,b){if(b&&("object"===d(b)||"function"==typeof b)){return b}return l(a)}function l(a){if(void 0===a){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return a}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(a){return!1}}function n(a){n=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return n(a)}var o=function(a){h(b,a);var d=j(b);function b(){e(this,b);return d.apply(this,arguments)}g(b,[{key:"values",get:function get(){return this.rawValues}},{key:"placeholder",get:function get(){return(0,c.get_string)("placeholdertype","core_user")}},{key:"showSuggestions",get:function get(){return!1}}]);return b}(b.default);a.default=o;return a.default});
define ("core_user/local/participantsfilter/filter",["exports","core/form-autocomplete","./selectors","core/str"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=e(b);c=e(c);function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function g(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var i=a.apply(b,c);function g(a){f(i,d,e,g,h,"next",a)}function h(a){f(i,d,e,g,h,"throw",a)}g(void 0)})}}function h(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function i(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function j(a,b,c){if(b)i(a.prototype,b);if(c)i(a,c);return a}var k=function(a){return a.querySelectorAll(":checked")},l=function(){function a(b,c,d){h(this,a);this.filterType=b;this.rootNode=c;this.addValueSelector(d)}j(a,[{key:"tearDown",value:function tearDown(){}},{key:"addValueSelector",value:function(){var a=g(regeneratorRuntime.mark(function a(){var c=this,d,e,f,g,h=arguments;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:d=0<h.length&&h[0]!==void 0?h[0]:[];e=this.getFilterValueNode();e.innerHTML=this.getSourceDataForFilter().outerHTML;f=e.querySelector("select");f.id="filter-value-"+f.getAttribute("data-field-name");g=document.createElement("label");g.setAttribute("for",f.id);g.classList.add("sr-only");g.innerText=f.getAttribute("data-field-title");e.appendChild(g);d.forEach(function(a){var b=f.querySelector("option[value=\"".concat(a,"\"]"));if(b){b.selected=!0}else if(!c.showSuggestions){b=document.createElement("option");b.value=a;b.innerHTML=a;b.selected=!0;f.append(b)}});a.t0=b.default;a.t1=f;a.t2="1"==f.dataset.allowCustom;a.next=16;return this.placeholder;case 16:a.t3=a.sent;a.t4=this.showSuggestions;a.t5=!f.multiple;a.t6={items:"core_user/local/participantsfilter/autocomplete_selection_items",layout:"core_user/local/participantsfilter/autocomplete_layout",selection:"core_user/local/participantsfilter/autocomplete_selection"};a.t0.enhance.call(a.t0,a.t1,a.t2,null,a.t3,!1,a.t4,null,a.t5,a.t6);case 21:case"end":return a.stop();}}},a,this)}));return function addValueSelector(){return a.apply(this,arguments)}}()},{key:"getSourceDataForFilter",value:function getSourceDataForFilter(){var a=this.rootNode.querySelector(c.default.filterset.regions.datasource);return a.querySelector(c.default.data.fields.byName(this.filterType))}},{key:"getFilterValueNode",value:function getFilterValueNode(){return this.filterRoot.querySelector(c.default.filter.regions.values)}},{key:"placeholder",get:function get(){return(0,d.get_string)("placeholdertypeorselect","core_user")}},{key:"showSuggestions",get:function get(){return!0}},{key:"filterRoot",get:function get(){return this.rootNode.querySelector(c.default.filter.byName(this.filterType))}},{key:"name",get:function get(){return this.filterType}},{key:"jointype",get:function get(){return parseInt(this.filterRoot.querySelector(c.default.filter.fields.join).value,10)}},{key:"rawValues",get:function get(){var a=this.getFilterValueNode(),b=a.querySelector("select");return Object.values(k(b)).map(function(a){return a.value})}},{key:"values",get:function get(){return this.rawValues.map(function(a){return parseInt(a,10)})}},{key:"filterValue",get:function get(){return{name:this.name,jointype:this.jointype,values:this.values}}}]);return a}();a.default=l;return a.default});
define ("core_user/local/participantsfilter/selectors",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var b=function(a){return"[data-filterregion=\"".concat(a,"\"]")},c=function(a){return"[data-filteraction=\"".concat(a,"\"]")},d=function(a){return"[data-filterfield=\"".concat(a,"\"]")},e={filter:{region:b("filter"),actions:{remove:c("remove")},fields:{join:d("join"),type:d("type")},regions:{values:b("value")},byName:function byName(a){return"".concat(b("filter"),"[data-filter-type=\"").concat(a,"\"]")}},filterset:{region:b("actions"),actions:{addRow:c("add"),applyFilters:c("apply"),resetFilters:c("reset")},regions:{filtermatch:b("filtermatch"),filterlist:b("filters"),datasource:b("filtertypedata")},fields:{join:"".concat(b("filtermatch")," ").concat(d("join"))}},data:{fields:{byName:function byName(a){return"[data-field-name=\"".concat(a,"\"]")},all:"".concat(b("filtertypedata")," [data-field-name]")},typeList:b("filtertypelist"),typeListSelect:"select".concat(b("filtertypelist"))}};a.default=e;return a.default});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_user/participants",["exports","core_table/dynamic","core/str","core/checkbox-toggleall","core/custom_interaction_events","core_table/local/dynamic/selectors","core/modal_events","core/notification","core/pending","jquery","core_user/local/participants/bulkactions"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=n(b);c=n(c);d=l(d);e=l(e);f=l(f);g=l(g);h=l(h);i=l(i);j=l(j);function l(a){return a&&a.__esModule?a:{default:a}}function m(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;m=function(){return a};return a}function n(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=m();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function o(a,b){return t(a)||s(a,b)||q(a,b)||p()}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function q(a,b){if(!a)return;if("string"==typeof a)return r(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(a,b)}function r(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function s(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function t(a){if(Array.isArray(a))return a}var u={bulkActionSelect:"#formactionid",bulkUserSelectedCheckBoxes:"input[data-togglegroup='participants-table'][data-toggle='slave']:checked",checkCountButton:"#checkall",showCountText:"[data-region=\"participant-count\"]",showCountToggle:"[data-action=\"showcount\"]",stateHelpIcon:"[data-region=\"state-help-icon\"]",tableForm:function tableForm(a){return"form[data-table-unique-id=\"".concat(a,"\"]")}};a.init=function init(a){var l=a.uniqueid,m=a.noteStateNames,n=void 0===m?{}:m,p=document.querySelector(u.tableForm(l)),q=function(a){return p.querySelector(f.default.main.fromRegionId(a))},r=function(){e.default.define(u.bulkActionSelect,[e.default.events.accessibleChange]);(0,j.default)(u.bulkActionSelect).on(e.default.events.accessibleChange,function(a){var b=a.target.closest("select"),c=b.value,d=q(l),e=d.querySelectorAll(u.bulkUserSelectedCheckBoxes),f=new i.default("core_user/participants:bulkActionSelect");if(-1!==c.indexOf("#")){a.preventDefault();var j=[];e.forEach(function(a){j.push(a.getAttribute("name").replace("user",""))});var m;if("#messageselect"===c){m=(0,k.showSendMessage)(j)}else if("#addgroupnote"===c){m=(0,k.showAddNote)(p.dataset.courseId,j,n,p.querySelector(u.stateHelpIcon))}if(m){var o=new i.default("core_user/participants:bulkActionSelected");m.then(function(a){a.getRoot().on(g.default.hidden,function(){b.focus()});o.resolve();return a}).catch(h.default.exception)}}else if(""!==c&&e.length){b.form.submit()}s(b);f.resolve()});p.addEventListener("click",function(a){var c=p.querySelector(u.showCountToggle),e=p.querySelector(u.checkCountButton),f=c&&c.contains(a.target),g=e&&e.contains(a.target);if(f||g){a.preventDefault();var i=q(l);b.setPageSize(i,c.dataset.targetPageSize).then(function(a){d.default.setGroupState(p,"participants-table",g);return a}).catch(h.default.exception)}});p.addEventListener(b.Events.tableContentRefreshed,function(a){var b=p.querySelector(u.showCountToggle),e=p.querySelector(u.checkCountButton),f=a.target,g=parseInt(p.dataset.tableDefaultPerPage,10),i=parseInt(f.dataset.tablePageSize,10),j=parseInt(f.dataset.tableTotalRows,10);d.default.updateSlavesFromMasterState(p,"participants-table");var k=[{key:"countparticipantsfound",component:"core_user",param:j}];if(j<=g){b.classList.add("hidden");if(e){e.classList.add("hidden")}}else if(j<=i){k.push({key:"showperpage",component:"core",param:g});k.push({key:"selectalluserswithcount",component:"core",param:g});b.classList.remove("hidden");b.dataset.targetPageSize=g;if(e){e.classList.add("hidden")}}else{k.push({key:"showall",component:"core",param:j});k.push({key:"selectalluserswithcount",component:"core",param:j});b.classList.remove("hidden");b.dataset.targetPageSize=j;if(e){e.classList.remove("hidden")}}c.get_strings(k).then(function(a){var c=o(a,3),d=c[0],f=c[1],g=c[2],h=p.querySelector(u.showCountText);h.innerHTML=d;if(f){b.innerHTML=f}if(g&&e){e.value=g}}).catch(h.default.exception)})},s=function(a){a.value=""};r()}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_user/participantsfilter",["exports","./local/participantsfilter/filtertypes/courseid","core_table/dynamic","./local/participantsfilter/filter","core/str","core/notification","core/pending","./local/participantsfilter/selectors","core/templates","core/custom_interaction_events","jquery"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=n(b);c=m(c);d=n(d);f=n(f);g=n(g);h=n(h);i=n(i);j=n(j);k=n(k);var A="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};function l(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;l=function(){return a};return a}function m(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=l();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function n(a){return a&&a.__esModule?a:{default:a}}function o(a){return r(a)||q(a)||u(a)||p()}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function q(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function r(a){if(Array.isArray(a))return v(a)}function s(a,b){return x(a)||w(a,b)||u(a,b)||t()}function t(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(a,b){if(!a)return;if("string"==typeof a)return v(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return v(a,b)}function v(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function w(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function x(a){if(Array.isArray(a))return a}function y(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function z(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){y(h,d,e,f,g,"next",a)}function g(a){y(h,d,e,f,g,"throw",a)}f(void 0)})}}var B=function(a){var l=document.querySelector("#".concat(a)),m={courseid:new b.default("courseid",l)},n=function(){return l.querySelector(h.default.filterset.regions.filterlist)},p=function(){var a=new g.default("core_user/participantsfilter:addFilterRow"),b=1+n().querySelectorAll(h.default.filter.region).length;return i.default.renderForPromise("core_user/local/participantsfilter/filterrow",{rownumber:b}).then(function(a){var b=a.html,c=a.js,d=i.default.appendNodeContents(n(),b,c);return d}).then(function(a){var b=l.querySelector(h.default.data.typeList);a.forEach(function(a){var c=a.querySelector(h.default.filter.fields.type);if(c){c.innerHTML=b.innerHTML}});return a}).then(function(a){C();return a}).then(function(b){a.resolve();return b}).catch(f.default.exception)},q=function(a){var b=l.querySelector(h.default.filterset.regions.datasource);return b.querySelector(h.default.data.fields.byName(a))},r=function(){var a=z(regeneratorRuntime.mark(function a(b,c,e){var f,g,i;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:b.dataset.filterType=c;f=q(c);g=d.default;if(!f.dataset.filterTypeClass){a.next=7;break}a.next=6;return"function"==typeof A.define&&A.define.amd?new Promise(function(a,b){A.require([f.dataset.filterTypeClass],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&A.require&&"component"===A.require.loader?Promise.resolve(require((f.dataset.filterTypeClass))):Promise.resolve(A[f.dataset.filterTypeClass]);case 6:g=a.sent;case 7:m[c]=new g(c,l,e);i=b.querySelector(h.default.filter.fields.type);i.value=c;i.disabled="disabled";C();return a.abrupt("return",m[c]);case 13:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),t=function(a){return m[a]},u=function(a,b){var c=n().querySelectorAll(h.default.filter.region).length;if(1===c){w(a,b)}else{v(a,b)}},v=function(){var a=z(regeneratorRuntime.mark(function a(b){var c,d,e,f,g=arguments;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:c=1<g.length&&g[1]!==void 0?g[1]:!0;d=b.querySelector(h.default.filter.fields.type);e=!!d.value;x(b.dataset.filterType);b.remove();C();if(e&&c){E()}a.next=9;return F();case 9:f=a.sent;n().querySelectorAll(h.default.filter.region).forEach(function(a,b){a.querySelector("legend").innerText=f[b]});case 11:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),w=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!0,c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;x(a.dataset.filterType);return i.default.renderForPromise("core_user/local/participantsfilter/filterrow",{rownumber:c}).then(function(b){var c=b.html,d=b.js,e=i.default.replaceNode(a,c,d);return e}).then(function(a){var b=l.querySelector(h.default.data.typeList);a.forEach(function(a){var c=a.querySelector(h.default.filter.fields.type);if(c){c.innerHTML=b.innerHTML}});return a}).then(function(a){C();return a}).then(function(a){if(b){return E()}else{return a}}).catch(f.default.exception)},x=function(a){if(a){var b=t(a);if(b){b.tearDown();delete m[a]}}},y=function(){var a=new g.default("core_user/participantsfilter:setFilterFromConfig"),b=n().querySelectorAll(h.default.filter.region);b.forEach(function(a){return u(a,!1)});return E().then(function(b){a.resolve();return b})},B=function(){var a=n().querySelectorAll(h.default.filter.region);a.forEach(function(a){var b=a.querySelector(h.default.filter.fields.type);if(!b.value){u(a,!1)}})},C=function(){var a=n().querySelectorAll(h.default.filter.region);a.forEach(function(a){var b=a.querySelectorAll(h.default.filter.fields.type+" option");b.forEach(function(b){if(b.value===a.dataset.filterType){b.classList.remove("hidden");b.disabled=!1}else if(m[b.value]){b.classList.add("hidden");b.disabled=!0}else{b.classList.remove("hidden");b.disabled=!1}})});var b=l.querySelector(h.default.filterset.actions.addRow),c=l.querySelectorAll(h.default.data.fields.all);if(c.length<=a.length){b.setAttribute("disabled","disabled")}else{b.removeAttribute("disabled")}if(1===a.length){l.querySelector(h.default.filterset.regions.filtermatch).classList.add("hidden");l.querySelector(h.default.filterset.fields.join).value=1;l.dataset.filterverb=1}else{l.querySelector(h.default.filterset.regions.filtermatch).classList.remove("hidden")}},D=function(a){var b=Object.entries(a.filters);if(!b.length){return Promise.resolve()}l.querySelector(h.default.filterset.fields.join).value=a.jointype;var c=b.map(function(a){var b=s(a,2),c=b[0],d=b[1];if("courseid"===c){return!1}var e=d.values;if(!e.length){return!1}return p().then(function(a){var b=s(a,1),d=b[0];return r(d,c,e)})}).filter(function(a){return a});if(!c.length){return Promise.resolve()}return Promise.all(c).then(function(){return B()}).then(C).then(E)},E=function(){var a=new g.default("core_user/participantsfilter:updateTableFromFilter"),b={};Object.values(m).forEach(function(a){b[a.filterValue.name]=a.filterValue});return c.setFilters(c.getTableFromId(l.dataset.tableRegion),{jointype:parseInt(l.querySelector(h.default.filterset.fields.join).value,10),filters:b}).then(function(b){a.resolve();return b}).catch(f.default.exception)},F=function(){var a=z(regeneratorRuntime.mark(function a(){var b,c,d;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:b=document.querySelector(h.default.data.typeListSelect).length-1;c=[];o(Array(b)).forEach(function(a,b){c.push({key:"filterrowlegend",component:"core_user",param:b+1})});a.next=5;return(0,e.get_strings)(c).then(function(a){return a}).catch(f.default.exception);case 5:d=a.sent;return a.abrupt("return",d);case 7:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();l.querySelector(h.default.filterset.region).addEventListener("click",function(a){if(a.target.closest(h.default.filterset.actions.addRow)){a.preventDefault();p()}if(a.target.closest(h.default.filterset.actions.applyFilters)){a.preventDefault();E()}if(a.target.closest(h.default.filterset.actions.resetFilters)){a.preventDefault();y()}});l.querySelector(h.default.filterset.regions.filterlist).addEventListener("click",function(a){if(a.target.closest(h.default.filter.actions.remove)){a.preventDefault();u(a.target.closest(h.default.filter.region),!0)}});var G=(0,k.default)(n());j.default.define(G,[j.default.events.accessibleChange]);G.on(j.default.events.accessibleChange,function(a){var b=a.target.closest(h.default.filter.fields.type);if(b&&b.value){var c=a.target.closest(h.default.filter.region);r(c,b.value)}});l.querySelector(h.default.filterset.fields.join).addEventListener("change",function(a){l.dataset.filterverb=a.target.value});var H=c.getTableFromId(l.dataset.tableRegion),I=c.getFilters(H);if(I){var J=new g.default("core_user/participantsfilter:setFilterFromConfig");D(I).then(function(){return J.resolve()}).catch()}};a.init=B});
define ("core_user/repository",["exports","core/ajax"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.sendMessagesToUsers=a.createNotesForUsers=a.submitUserEnrolmentForm=a.unenrolUser=void 0;a.unenrolUser=function unenrolUser(a){return(0,b.call)([{methodname:"core_enrol_unenrol_user_enrolment",args:{ueid:a}}])[0]};a.submitUserEnrolmentForm=function submitUserEnrolmentForm(a){return(0,b.call)([{methodname:"core_enrol_submit_user_enrolment_form",args:{formdata:a}}])[0]};a.createNotesForUsers=function createNotesForUsers(a){return(0,b.call)([{methodname:"core_notes_create_notes",args:{notes:a}}])[0]};a.sendMessagesToUsers=function sendMessagesToUsers(a){return(0,b.call)([{methodname:"core_message_send_instant_messages",args:{messages:a}}])[0]}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_user/status_field",["exports","core_table/dynamic","./repository","core/str","core_table/local/dynamic/selectors","core/fragment","core/modal_events","core/modal_factory","core/notification","core/templates","core/toast"],function(a,b,c,d,f,g,h,i,j,k,l){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=o(b);c=o(c);d=o(d);f=m(f);g=m(g);h=m(h);i=m(i);j=m(j);k=m(k);function m(a){return a&&a.__esModule?a:{default:a}}function n(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;n=function(){return a};return a}function o(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=n();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function p(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function q(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){p(Object(c),!0).forEach(function(b){r(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{p(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function r(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function s(a,b){return x(a)||w(a,b)||u(a,b)||t()}function t(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(a,b){if(!a)return;if("string"==typeof a)return v(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return v(a,b)}function v(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function w(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function x(a){if(Array.isArray(a))return a}var y={editEnrolment:"[data-action=\"editenrolment\"]",showDetails:"[data-action=\"showdetails\"]",unenrol:"[data-action=\"unenrol\"]",statusElement:"[data-status]"},z=function(a){return a.closest(f.default.main.region)},A=function(a){return a.closest(y.statusElement)},B=function(a){return a.getAttribute("rel")},C=function(a,b){var c=function(b,c){return I(a,b,c)};document.addEventListener("click",function(a){var d=a.target.closest(f.default.main.fromRegionId(b));if(!d){return}var e=a.target.closest(y.editEnrolment);if(e){a.preventDefault();D(e,c)}var g=a.target.closest(y.unenrol);if(g){a.preventDefault();E(g)}var h=a.target.closest(y.showDetails);if(h){a.preventDefault();F(h)}})},D=function(a,b){var c=A(a),f=B(a);i.default.create({large:!0,title:d.get_string("edituserenrolment","enrol",c.dataset.fullname),type:i.default.types.SAVE_CANCEL,body:b(f)}).then(function(d){d.getRoot().on(h.default.save,function(g){g.preventDefault();G(a,b,d,f,c.dataset)});d.getRoot().on(h.default.hidden,function(){d.destroy()});d.show();return d}).catch(j.default.exception)},E=function(a){var b=A(a),c=B(a);i.default.create({type:i.default.types.SAVE_CANCEL}).then(function(f){f.getRoot().on(h.default.save,function(d){d.preventDefault();H(a,f,{ueid:c},b.dataset)});f.getRoot().on(h.default.hidden,function(){f.destroy()});f.show();var g=[{key:"unenrol",component:"enrol"},{key:"unenrolconfirm",component:"enrol",param:{user:b.dataset.fullname,course:b.dataset.coursename,enrolinstancename:b.dataset.enrolinstancename}}];return Promise.all([d.get_strings(g),f])}).then(function(a){var b=s(a,2),c=b[0],d=b[1];d.setTitle(c[0]);d.setSaveButtonText(c[0]);d.setBody(c[1]);return d}).catch(j.default.exception)},F=function(a){var b=A(a),c=q({editenrollink:"",statusclass:b.querySelector("span.badge").getAttribute("class")},b.dataset),f=b.querySelector(y.editEnrolment);if(f){c.editenrollink=f.outerHTML}i.default.create({large:!0,type:i.default.types.CANCEL,title:d.get_string("enroldetails","enrol"),body:k.default.render("core_user/status_details",c)}).then(function(a){if(f){a.getRoot().on("click",y.editEnrolment,function(b){b.preventDefault();a.hide();f.click()})}a.show();a.getRoot().on(h.default.hidden,function(){return a.destroy()});return a}).catch(j.default.exception)},G=function(a,e,f,g,h){var i=f.getRoot().find("form");c.submitUserEnrolmentForm(i.serialize()).then(function(a){if(!a.result){throw a.result}f.hide();f.destroy();return a}).then(function(){b.refreshTableContent(z(a)).catch(j.default.exception);return d.get_string("enrolmentupdatedforuser","core_enrol",h)}).then(function(a){(0,l.add)(a)}).catch(function(){f.setBody(e(g,JSON.stringify(i.serialize())));return f})},H=function(a,e,f,g){c.unenrolUser(f.ueid).then(function(a){if(!a.result){j.default.alert(a.errors[0].key,a.errors[0].message);return a}e.hide();e.destroy();return a}).then(function(){b.refreshTableContent(z(a)).catch(j.default.exception);return d.get_string("unenrolleduser","core_enrol",g)}).then(function(a){(0,l.add)(a)}).catch(j.default.exception)},I=function(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;return g.default.loadFragment("enrol","user_enrolment_form",a,{ueid:b,formdata:c})};a.init=function init(a){var b=a.contextid,c=a.uniqueid;C(b,c)}});
define ("core_user/unified_filter",["jquery","core/form-autocomplete","core/str","core/notification"],function(a,b,c,d){var e={UNIFIED_FILTERS:"#unified-filters"},f=function init(){M.util.js_pending("unified_filter_datasource");c.get_strings([{key:"userfilterplaceholder",component:"moodle"},{key:"nofiltersapplied",component:"moodle"}]).done(function(a){var c=a[0],f=a[1];b.enhance(e.UNIFIED_FILTERS,!0,"core_user/unified_filter_datasource",c,!1,!0,f,!0).then(function(){M.util.js_complete("unified_filter_datasource")}).fail(d.exception)}).fail(d.exception);var f=a(e.UNIFIED_FILTERS).val();a(e.UNIFIED_FILTERS).on("change",function(){var b=a(this).val(),c=[],d=[],e=!1;a.each(b,function(a,b){var f=b.split(":",2);if(2!==f.length){d.push(b);return!0}var g=f[0],h=f[1];if("undefined"!=typeof c[g]){e=!0}c[g]=h;return!0});if(e){var g=[];for(var h in c){g.push(h+":"+c[h])}g=g.concat(d);a(this).val(g)}if(f.join(",")!=b.join(",")){this.form.submit()}})},g=function getForm(){return a(e.UNIFIED_FILTERS).closest("form")};return{init:function init(){f()},getForm:function getForm(){return g()}}});
define ("core_user/unified_filter_datasource",["jquery","core/ajax","core/notification"],function(a,b,c){return{list:function list(b,c){var d=[],e=a(b),f=a(b).data("originaloptionsjson"),g=e.val();a.each(f,function(b,e){if(""!==c.trim()&&-1===e.label.toLocaleLowerCase().indexOf(c.toLocaleLowerCase())){return!0}if(-1<a.inArray(e.value,g)){return!0}d.push(e);return!0});var h=new a.Deferred;h.resolve(d);return h.promise()},processResults:function processResults(b,c){var d=[];a.each(c,function(a,b){d.push({value:b.value,label:b.label})});return d},transport:function transport(a,b,d){this.list(a,b).then(d).catch(c.exception)}}});
define ("qtype_ddimageortext/form",["jquery","core/dragdrop"],function(a,b){"use strict";var c={maxBgImageSize:null,maxDragImageSize:null,fp:null,init:function init(){c.fp=c.filePickers();a("#id_previewareaheader").append("<div class=\"ddarea que ddimageortext\">  <div class=\"droparea\">    <img class=\"dropbackground\" />    <div class=\"dropzones\"></div>  </div>  <div class=\"dragitems\"></div></div>");c.updateVisibilityOfFilePickers();c.setOptionsForDragItemSelectors();c.setupEventHandlers();c.waitForFilePickerToInitialise()},waitForFilePickerToInitialise:function waitForFilePickerToInitialise(){if(null===c.fp.file("bgimage").href){setTimeout(c.waitForFilePickerToInitialise,1e3);return}M.util.js_pending("dragDropToImageForm");a("form.mform").on("change",".filepickerhidden",function(){M.util.js_pending("dragDropToImageForm");c.loadPreviewImage()});c.loadPreviewImage()},loadPreviewImage:function loadPreviewImage(){a("fieldset#id_previewareaheader .dropbackground").one("load",c.afterPreviewImageLoaded).attr("src",c.fp.file("bgimage").href)},afterPreviewImageLoaded:function afterPreviewImageLoaded(){c.createDropZones();M.util.js_complete("dragDropToImageForm")},createDropZones:function createDropZones(){var b=a(".dropzones");b.empty();var d=c.fp.file("bgimage").href;if(null===d){return}for(var e=c.form.getFormValue("nodropzone",[]),f=0,g;f<e;f++){g=c.form.getFormValue("drops",[f,"choice"]);if("0"===g){continue}g=g-1;var h=c.form.getFormValue("drags",[g,"draggroup"]),i=c.form.getFormValue("draglabel",[g]);if("image"===c.form.getFormValue("drags",[g,"dragitemtype"])){var j=c.fp.file("dragitem["+g+"]").href;if(null===j){continue}b.append("<img class=\"droppreview group"+h+" drop"+f+"\" src=\""+j+"\" alt=\""+i+"\" data-drop-no=\""+f+"\">")}else if(""!==i){b.append("<div class=\"droppreview group"+h+" drop"+f+"\"  data-drop-no=\""+f+"\">"+i+"</div>")}}c.waitForAllDropImagesToBeLoaded()},waitForAllDropImagesToBeLoaded:function waitForAllDropImagesToBeLoaded(){var b=a(".dropzones img").not(function(a,b){return c.imageIsLoaded(b)});if(0<b.length){setTimeout(function(){c.waitForAllDropImagesToBeLoaded()},100);return}c.updateDropZones()},imageIsLoaded:function imageIsLoaded(a){return a.complete&&0!==a.naturalHeight},updateDropZones:function updateDropZones(){var b=c.fp.file("bgimage").href;if(null===b){return}for(var d=a("fieldset#id_previewareaheader .dropbackground").offset(),e=c.form.getFormValue("nodropzone",[]),f=0,g;f<e;f++){g=a(".dropzones .drop"+f);if(0===g.length){continue}var h=c.form.getFormValue("drops",[f,"choice"])-1;g.offset({left:d.left+parseInt(c.form.getFormValue("drops",[f,"xleft"])),top:d.top+parseInt(c.form.getFormValue("drops",[f,"ytop"]))});var i=c.form.getFormValue("draglabel",[h]);if(g.is("img")){g.attr("alt",i)}else{g.html(i)}}a(".dropzones .droppreview").css("padding","0");for(var j=a(".draggroup select").first().find("option").length,k=1;k<=j;k++){c.resizeAllDragsAndDropsInGroup(k)}},resizeAllDragsAndDropsInGroup:function resizeAllDragsAndDropsInGroup(b){var c=a(".dropzones .droppreview.group"+b),d=0,e=0;c.each(function(a,b){d=Math.max(d,Math.ceil(b.offsetWidth));e=Math.max(e,Math.ceil(b.offsetHeight))});d+=10;e+=10;c.each(function(b,c){var f=Math.round((d-c.offsetWidth)/2),g=Math.floor((e-c.offsetHeight)/2);a(c).css({"padding-left":f+"px","padding-right":d-c.offsetWidth-f+"px","padding-top":g+"px","padding-bottom":e-c.offsetHeight-g+"px"})})},setupEventHandlers:function setupEventHandlers(){a("fieldset#id_draggableitemheader").on("change input","input, select",function(b){var d=a(b.target).closest("select, input");if(d.hasClass("dragitemtype")){c.updateVisibilityOfFilePickers()}c.setOptionsForDragItemSelectors();if(d.is(".dragitemtype, .draggroup")){c.createDropZones()}else if(d.is(".draglabel")){c.updateDropZones()}});a("fieldset#id_dropzoneheader").on("change input","input, select",function(b){var d=a(b.target).closest("select, input");if(d.is("select")){c.createDropZones()}else{c.updateDropZones()}});a("fieldset#id_previewareaheader").on("mousedown touchstart",".droppreview",function(a){c.dragStart(a)});a(window).on("resize",function(){c.updateDropZones()})},updateVisibilityOfFilePickers:function updateVisibilityOfFilePickers(){for(var b=c.form.getFormValue("noitems",[]),d=0,e;d<b;d++){e=a("input#id_dragitem_"+d).closest(".fitem_ffilepicker");if("image"===c.form.getFormValue("drags",[d,"dragitemtype"])){e.show()}else{e.hide()}}},setOptionsForDragItemSelectors:function setOptionsForDragItemSelectors(){for(var b={0:""},d=c.form.getFormValue("noitems",[]),e=c.form.getFormValue("nodropzone",[]),f=0;f<d;f++){var g=c.form.getFormValue("draglabel",[f]),h=c.fp.file(c.form.toNameWithIndex("dragitem",[f]));if("image"===c.form.getFormValue("drags",[f,"dragitemtype"])&&null!==h.name){b[f+1]=f+1+". "+g+" ("+h.name+")"}else if(""!==g){b[f+1]=f+1+". "+g}}for(var i=0;i<e;i++){var j=a("#id_drops_"+i+"_choice"),k=j.val();j.find("option").remove();for(var l in b){if(!b.hasOwnProperty(l)){continue}j.append("<option value=\""+l+"\">"+b[l]+"</option>");var m=j.find("option[value=\""+l+"\"]");if(parseInt(l)===parseInt(k)){m.attr("selected",!0)}else if(c.isItemUsed(parseInt(l))){m.attr("disabled",!0)}}}},isItemUsed:function isItemUsed(b){if(0===b){return!1}if(c.form.getFormValue("drags",[b-1,"infinite"])){return!1}return 0!==a("fieldset#id_dropzoneheader select").filter(function(c,d){return parseInt(a(d).val())===b}).length},dragStart:function dragStart(d){var e=a(d.target).closest(".droppreview"),f=b.prepare(d);if(!f.start){return}b.start(d,e,function(a,b,d){c.dragMove(d)},function(){c.dragEnd()})},dragMove:function dragMove(b){var d=a("fieldset#id_previewareaheader .dropbackground"),e=d.offset(),f=b.data("dropNo"),g=b.offset(),h=Math.round(g.left-e.left),i=Math.round(g.top-e.top);h=Math.round(Math.max(0,Math.min(h,d.outerWidth()-b.outerWidth())));i=Math.round(Math.max(0,Math.min(i,d.outerHeight()-b.outerHeight())));c.form.setFormValue("drops",[f,"xleft"],h);c.form.setFormValue("drops",[f,"ytop"],i)},dragEnd:function dragEnd(){c.updateDropZones()},form:{toNameWithIndex:function toNameWithIndex(a,b){for(var c=a,d=0;d<b.length;d++){c=c+"["+b[d]+"]"}return c},getEl:function getEl(b,c){var d=a("form.mform")[0];return d.elements[this.toNameWithIndex(b,c)]},getFormValue:function getFormValue(a,b){var c=this.getEl(a,b);if(!c.type){c=c[c.length-1]}if("checkbox"===c.type){return c.checked}else{return c.value}},setFormValue:function setFormValue(a,b,c){var d=this.getEl(a,b);if("checkbox"===d.type){d.checked=c}else{d.value=c}}},filePickers:function filePickers(){var b,c;if(b===void 0){b={};c={};var d=a("form.mform input.filepickerhidden");d.each(function(a,d){b[d.value]=d.name;c[d.name]=d.parentNode})}return{file:function file(b){var d=a(c[b]),e=d.find("div.filepicker-filelist a");if(e.length){return{href:e.get(0).href,name:e.get(0).innerHTML}}else{return{href:null,name:null}}},name:function name(a){return b[a]}}}};return{init:c.init}});
define ("qtype_ddimageortext/question",["jquery","core/dragdrop","core/key_codes"],function(a,b,c){"use strict";function d(a,b,c){this.containerId=a;M.util.js_pending("qtype_ddimageortext-init-"+this.containerId);this.places=c;this.allImagesLoaded=!1;this.imageLoadingTimeoutId=null;this.isPrinting=!1;if(b){this.getRoot().addClass("qtype_ddimageortext-readonly")}var d=this;this.getNotYetLoadedImages().one("load",function(){d.waitForAllImagesToBeLoaded()});this.waitForAllImagesToBeLoaded()}d.prototype.waitForAllImagesToBeLoaded=function(){var a=this;if(this.allImagesLoaded){return}if(null!==this.imageLoadingTimeoutId){clearTimeout(this.imageLoadingTimeoutId)}if(0<this.getNotYetLoadedImages().length){this.imageLoadingTimeoutId=setTimeout(function(){a.waitForAllImagesToBeLoaded()},100);return}this.allImagesLoaded=!0;a.setupQuestion()};d.prototype.getNotYetLoadedImages=function(){var a=this;return this.getRoot().find(".ddarea img").not(function(b,c){return a.imageIsLoaded(c)})};d.prototype.imageIsLoaded=function(a){return a.complete&&0!==a.naturalHeight};d.prototype.setupQuestion=function(){this.resizeAllDragsAndDrops();this.cloneDrags();this.positionDragsAndDrops();M.util.js_complete("qtype_ddimageortext-init-"+this.containerId)};d.prototype.resizeAllDragsAndDrops=function(){var b=this;this.getRoot().find(".draghomes > div").each(function(c,d){b.resizeAllDragsAndDropsInGroup(b.getClassnameNumericSuffix(a(d),"dragitemgroup"))})};d.prototype.resizeAllDragsAndDropsInGroup=function(b){var c=this.getRoot(),d=c.find(".dragitemgroup"+b+" .draghome"),e=0,f=0;d.each(function(a,b){e=Math.max(e,Math.ceil(b.offsetWidth));f=Math.max(f,Math.ceil(b.offsetHeight))});e+=10;f+=10;d.each(function(b,c){var d=Math.round((e-c.offsetWidth)/2),g=Math.floor((f-c.offsetHeight)/2);a(c).css({"padding-left":d+"px","padding-right":e-c.offsetWidth-d+"px","padding-top":g+"px","padding-bottom":f-c.offsetHeight-g+"px"})});for(var g in this.places){if(!this.places.hasOwnProperty(g)){continue}var h=this.places[g],i=h.text;if(parseInt(h.group)!==b){continue}if(""===i){i=M.util.get_string("blank","qtype_ddimageortext")}c.find(".dropzones").append("<div class=\"dropzone active group"+h.group+" place"+g+"\" tabindex=\"0\"><span class=\"accesshide\">"+i+"</span>&nbsp;</div>");c.find(".dropzone.place"+g).width(e-2).height(f-2)}};d.prototype.cloneDrags=function(){var b=this;b.getRoot().find(".draghome").each(function(c,d){var e=a(d),f=e.clone();f.removeClass();f.addClass("draghome choice"+b.getChoice(e)+" group"+b.getGroup(e)+" dragplaceholder");e.before(f)})};d.prototype.cloneDragsForOneChoice=function(a){if(a.hasClass("infinite")){for(var b=this.noOfDropsInGroup(this.getGroup(a)),c=0;c<b;c++){this.cloneDrag(a)}}else{this.cloneDrag(a)}};d.prototype.cloneDrag=function(a){var b=a.clone();b.removeClass("draghome").addClass("drag unplaced moodle-has-zindex").offset(a.offset());this.getRoot().find(".dragitems").append(b)};d.prototype.positionDragsAndDrops=function(){var b=this,c=this.getRoot(),d=this.bgRatio();c.find(".ddarea .dropzone").each(function(c,e){var f=a(e),g=b.places[b.getPlace(f)];f.css("left",parseInt(g.xy[0])*d).css("top",parseInt(g.xy[1])*d);f.data("originX",parseInt(g.xy[0])).data("originY",parseInt(g.xy[1]));b.handleElementScale(f,"left top")});c.find(".draghome").not(".dragplaceholder").each(function(c,d){var e=a(d),f=b.getClassnameNumericSuffix(e,"inplace");e.addClass("unplaced").removeClass("placed");e.removeAttr("tabindex");if(null!==f){e.removeClass("inplace"+f)}});c.find("input.placeinput").each(function(d,e){var f=a(e),g=f.val();if(0===g.length||0<g.length&&"0"===g){return}var h=b.getPlace(f),i=b.getUnplacedChoice(b.getGroup(f),g),j=b.getDragClone(i);if(j.length){if(i.hasClass("infinite")){var k=b.noOfDropsInGroup(b.getGroup(i)),l=b.getInfiniteDragClones(i,!1);if(l.length<k){var m=i.clone();m.removeClass("beingdragged");m.removeAttr("tabindex");j.after(m)}else{j.addClass("active")}}else{j.addClass("active")}}var n=c.find(".dropzone.place"+h);b.sendDragToDrop(i,n)})};d.prototype.handleDragStart=function(c){var d=this,e=a(c.target).closest(".draghome"),g=this.calculateZIndex(),h=b.prepare(c);if(!h.start){return}e.addClass("beingdragged").css("transform","").css("z-index",g+2);var i=this.getClassnameNumericSuffix(e,"inplace");if(null!==i){this.setInputValue(i,0);e.removeClass("inplace"+i);var j=d.getDrop(e,i);if(j.length){j.addClass("active");e.offset(j.offset())}}else{var k=d.getDragClone(e);if(k.length){if(e.hasClass("infinite")){var l=this.noOfDropsInGroup(d.getGroup(e)),m=this.getInfiniteDragClones(e,!1);if(m.length<l){var n=e.clone();n.removeClass("beingdragged");n.removeAttr("tabindex");k.after(n);f.addEventHandlersToDrag(n);e.offset(n.offset())}else{k.addClass("active");e.offset(k.offset())}}else{k.addClass("active");e.offset(k.offset())}}}b.start(c,e,function(a,b,c){d.dragMove(a,b,c)},function(a,b,c){d.dragEnd(a,b,c)})};d.prototype.dragMove=function(b,c,d){var e=this,f=!1;this.getRoot().find(".dropzone.group"+this.getGroup(d)).each(function(d,g){var h=a(g);if(e.isPointInDrop(b,c,h)&&!f){f=!0;h.addClass("valid-drag-over-drop")}else{h.removeClass("valid-drag-over-drop")}});this.getRoot().find(".draghome.placed.group"+this.getGroup(d)).not(".beingdragged").each(function(g,h){var i=a(h);if(e.isPointInDrop(b,c,i)&&!f&&!e.isDragSameAsDrop(d,i)){f=!0;i.addClass("valid-drag-over-drop")}else{i.removeClass("valid-drag-over-drop")}})};d.prototype.dragEnd=function(b,c,d){var e=this,f=this.getRoot(),g=!1;f.find(".dropzone.group"+this.getGroup(d)).each(function(f,h){var i=a(h);if(!e.isPointInDrop(b,c,i)){return!0}i.removeClass("valid-drag-over-drop");e.sendDragToDrop(d,i);g=!0;return!1});if(!g){f.find(".draghome.placed.group"+this.getGroup(d)).not(".beingdragged").each(function(f,h){var i=a(h);if(!e.isPointInDrop(b,c,i)||e.isDragSameAsDrop(d,i)){return!0}i.removeClass("valid-drag-over-drop");var j=e.getClassnameNumericSuffix(i,"inplace"),k=e.getDrop(d,j);e.sendDragToDrop(d,k);g=!0;return!1})}if(!g){this.sendDragHome(d)}};d.prototype.sendDragToDrop=function(a,b){var c=this.getCurrentDragInPlace(this.getPlace(b));if(0!==c.length){c.addClass("beingdragged");c.offset(c.offset());var d=this.getClassnameNumericSuffix(c,"inplace"),e=this.getDrop(c,d);e.addClass("active");this.sendDragHome(c)}if(0===a.length){this.setInputValue(this.getPlace(b),0);if(b.data("isfocus")){b.focus()}}else{this.setInputValue(this.getPlace(b),this.getChoice(a));a.removeClass("unplaced").addClass("placed inplace"+this.getPlace(b));a.attr("tabindex",0);this.animateTo(a,b)}};d.prototype.sendDragHome=function(a){var b=this.getClassnameNumericSuffix(a,"inplace");if(null!==b){a.removeClass("inplace"+b)}a.data("unplaced",!0);this.animateTo(a,this.getDragHome(this.getGroup(a),this.getChoice(a)))};d.prototype.handleKeyPress=function(b){var d=a(b.target).closest(".dropzone");if(0===d.length){var e=a(b.target),g=this.getClassnameNumericSuffix(e,"inplace");if(null!==g){d=this.getDrop(e,g)}}var h=this.getCurrentDragInPlace(this.getPlace(d)),i=a();switch(b.keyCode){case c.space:case c.arrowRight:case c.arrowDown:i=this.getNextDrag(this.getGroup(d),h);break;case c.arrowLeft:case c.arrowUp:i=this.getPreviousDrag(this.getGroup(d),h);break;case c.escape:f.isKeyboardNavigation=!1;break;default:f.isKeyboardNavigation=!1;return;}if(i.length){i.data("isfocus",!0);i.addClass("beingdragged");var j=this.getDragClone(i);if(j.length){if(i.hasClass("infinite")){var k=this.noOfDropsInGroup(this.getGroup(i)),l=this.getInfiniteDragClones(i,!1);if(l.length<k){var m=i.clone();m.removeClass("beingdragged");m.removeAttr("tabindex");j.after(m);f.addEventHandlersToDrag(m);i.offset(m.offset())}else{j.addClass("active");i.offset(j.offset())}}else{j.addClass("active");i.offset(j.offset())}}}else{d.data("isfocus",!0)}b.preventDefault();this.sendDragToDrop(i,d)};d.prototype.getNextDrag=function(a,b){var c,d=this.noOfChoicesInGroup(a);if(0===b.length){c=1}else{c=this.getChoice(b)+1}var e=this.getUnplacedChoice(a,c);while(0===e.length&&c<d){c++;e=this.getUnplacedChoice(a,c)}return e};d.prototype.getPreviousDrag=function(a,b){var c;if(0===b.length){c=this.noOfChoicesInGroup(a)}else{c=this.getChoice(b)-1}var d=this.getUnplacedChoice(a,c);while(0===d.length&&1<c){c--;d=this.getUnplacedChoice(a,c)}return d};d.prototype.animateTo=function(b,c){var d=b.offset(),e=c.offset(),f=this;M.util.js_pending("qtype_ddimageortext-animate-"+f.containerId);b.animate({left:parseInt(b.css("left"))+e.left-d.left,top:parseInt(b.css("top"))+e.top-d.top},{duration:"fast",done:function done(){a("body").trigger("qtype_ddimageortext-dragmoved",[b,c,f]);M.util.js_complete("qtype_ddimageortext-animate-"+f.containerId)}})};d.prototype.isPointInDrop=function(a,b,c){var d=c.offset();if(c.hasClass("draghome")){return a>=d.left&&a<d.left+c.outerWidth()&&b>=d.top&&b<d.top+c.outerHeight()}return a>=d.left&&a<d.left+c.width()&&b>=d.top&&b<d.top+c.height()};d.prototype.setInputValue=function(a,b){this.getRoot().find("input.placeinput.place"+a).val(b)};d.prototype.getRoot=function(){return a(document.getElementById(this.containerId))};d.prototype.bgImage=function(){return this.getRoot().find("img.dropbackground")};d.prototype.getDragHome=function(a,b){if(!this.getRoot().find(".draghome.dragplaceholder.group"+a+".choice"+b).is(":visible")){return this.getRoot().find(".dragitemgroup"+a+" .draghome.infinite.choice"+b+".group"+a)}return this.getRoot().find(".draghome.dragplaceholder.group"+a+".choice"+b)};d.prototype.getUnplacedChoice=function(a,b){return this.getRoot().find(".ddarea .draghome.group"+a+".choice"+b+".unplaced").slice(0,1)};d.prototype.getCurrentDragInPlace=function(a){return this.getRoot().find(".ddarea .draghome.inplace"+a)};d.prototype.noOfDropsInGroup=function(a){return this.getRoot().find(".dropzone.group"+a).length};d.prototype.noOfChoicesInGroup=function(a){return this.getRoot().find(".dragitemgroup"+a+" .draghome").length};d.prototype.getClassnameNumericSuffix=function(a,b){var c=a.attr("class");if(""!==c){for(var d=c.split(" "),e=0,f;e<d.length;e++){f=new RegExp("^"+b+"([0-9])+$");if(f.test(d[e])){var g=/([0-9])+$/.exec(d[e]);return+g[0]}}}return null};d.prototype.getChoice=function(a){return this.getClassnameNumericSuffix(a,"choice")};d.prototype.getGroup=function(a){return this.getClassnameNumericSuffix(a,"group")};d.prototype.getPlace=function(a){return this.getClassnameNumericSuffix(a,"place")};d.prototype.getDragClone=function(a){return this.getRoot().find(".dragitemgroup"+this.getGroup(a)+" .draghome.choice"+this.getChoice(a)+".group"+this.getGroup(a)+".dragplaceholder")};d.prototype.getInfiniteDragClones=function(a,b){if(b){return this.getRoot().find(".dragitemgroup"+this.getGroup(a)+" .draghome.choice"+this.getChoice(a)+".group"+this.getGroup(a)+".infinite").not(".dragplaceholder")}return this.getRoot().find(".draghome.choice"+this.getChoice(a)+".group"+this.getGroup(a)+".infinite").not(".dragplaceholder")};d.prototype.getDrop=function(a,b){return this.getRoot().find(".dropzone.group"+this.getGroup(a)+".place"+b)};d.prototype.handleResize=function(){var b=this,c=this.bgRatio();if(this.isPrinting){c=1}this.getRoot().find(".ddarea .dropzone").each(function(d,e){a(e).css("left",parseInt(a(e).data("originX"))*parseFloat(c)).css("top",parseInt(a(e).data("originY"))*parseFloat(c));b.handleElementScale(e,"left top")});this.getRoot().find("div.droparea .draghome").not(".beingdragged").each(function(d,e){a(e).css("left",parseFloat(a(e).data("originX"))*parseFloat(c)).css("top",parseFloat(a(e).data("originY"))*parseFloat(c));b.handleElementScale(e,"left top")})};d.prototype.bgRatio=function(){var a=this.bgImage(),b=a.get(0).naturalWidth,c=a.width();return c/b};d.prototype.handleElementScale=function(b,c){var d=parseFloat(this.bgRatio());if(this.isPrinting){d=1}a(b).css({"-webkit-transform":"scale("+d+")","-moz-transform":"scale("+d+")","-ms-transform":"scale("+d+")","-o-transform":"scale("+d+")",transform:"scale("+d+")","transform-origin":c})};d.prototype.calculateZIndex=function(){var b=0;this.getRoot().find(".ddarea .dropzone, div.droparea .draghome").each(function(c,d){d=a(d);var e=d.css("z-index")?parseInt(d.css("z-index")):0;if(e>b){b=e}});return b};d.prototype.isDragSameAsDrop=function(a,b){return this.getChoice(a)===this.getChoice(b)&&this.getGroup(a)===this.getGroup(b)};var f={eventHandlersInitialised:!1,isPrinting:!1,isKeyboardNavigation:!1,questions:{},init:function init(a,b,c){f.questions[a]=new d(a,b,c);if(!f.eventHandlersInitialised){f.setupEventHandlers();f.eventHandlersInitialised=!0}},setupEventHandlers:function setupEventHandlers(){f.addEventHandlersToDrag(a(".que.ddimageortext:not(.qtype_ddimageortext-readonly) .draghome"));a("body").on("keydown",".que.ddimageortext:not(.qtype_ddimageortext-readonly) .dropzones .dropzone",f.handleKeyPress).on("keydown",".que.ddimageortext:not(.qtype_ddimageortext-readonly) .draghome.placed:not(.beingdragged)",f.handleKeyPress).on("qtype_ddimageortext-dragmoved",f.handleDragMoved);a(window).on("resize",function(){f.handleWindowResize(!1)});window.addEventListener("beforeprint",function(){f.isPrinting=!0;f.handleWindowResize(f.isPrinting)});window.addEventListener("afterprint",function(){f.isPrinting=!1;f.handleWindowResize(f.isPrinting)});setTimeout(function(){f.fixLayoutIfThingsMoved()},100)},addEventHandlersToDrag:function addEventHandlersToDrag(a){a.unbind("mousedown touchstart");a.on("mousedown touchstart",f.handleDragStart)},handleDragStart:function handleDragStart(a){a.preventDefault();var b=f.getQuestionForEvent(a);if(b){b.handleDragStart(a)}},handleKeyPress:function handleKeyPress(a){if(f.isKeyboardNavigation){return}f.isKeyboardNavigation=!0;var b=f.getQuestionForEvent(a);if(b){b.handleKeyPress(a)}},handleWindowResize:function handleWindowResize(a){for(var b in f.questions){if(f.questions.hasOwnProperty(b)){f.questions[b].isPrinting=a;f.questions[b].handleResize()}}},fixLayoutIfThingsMoved:function fixLayoutIfThingsMoved(){this.handleWindowResize(f.isPrinting);setTimeout(function(){f.fixLayoutIfThingsMoved(f.isPrinting)},100)},handleDragMoved:function handleDragMoved(a,b,c,d){b.removeClass("beingdragged").css("z-index","");b.css("top",c.position().top).css("left",c.position().left);c.after(b);c.removeClass("active");if("undefined"!=typeof b.data("unplaced")&&!0===b.data("unplaced")){b.removeClass("placed").addClass("unplaced");b.removeAttr("tabindex");b.removeData("unplaced");b.css("top","").css("left","").css("transform","");if(b.hasClass("infinite")&&1<d.getInfiniteDragClones(b,!0).length){d.getInfiniteDragClones(b,!0).first().remove()}}else{b.data("originX",c.data("originX")).data("originY",c.data("originY"));d.handleElementScale(b,"left top")}if("undefined"!=typeof b.data("isfocus")&&!0===b.data("isfocus")){b.focus();b.removeData("isfocus")}if("undefined"!=typeof c.data("isfocus")&&!0===c.data("isfocus")){c.removeData("isfocus")}if(f.isKeyboardNavigation){f.isKeyboardNavigation=!1}},getQuestionForEvent:function getQuestionForEvent(b){var c=a(b.currentTarget).closest(".que.ddimageortext").attr("id");return f.questions[c]}};return{init:f.init}});
define ("qtype_ddmarker/form",["jquery","core/dragdrop","qtype_ddmarker/shapes"],function(a,b,c){"use strict";function d(a){this.dropzoneNo=a;this.svgEl=null;this.shape=c.make(this.getShapeType(),this.getLabel());this.updateCoordinatesFromForm()}d.prototype.updateCoordinatesFromForm=function(a){var b=this.getCoordinates(),c="polygon"===this.shape.getType()&&this.shape.points.length;if(this.shape.getCoordinates()===b){return}if(!this.shape.parse(b,1)){return}if("polygon"===this.shape.getType()&&c!==this.shape.points.length){var d=this.isActive();this.removeFromSvg();if(a){this.addToSvg(a);if(d){this.setActive()}}}else{this.updateSvgEl()}this.setCoordinatesInForm()};d.prototype.updateLabel=function(){var a=this.getLabel();if(this.shape.label!==a){this.shape.label=a;this.updateSvgEl()}};d.prototype.changeShape=function(a){var b=this.getShapeType(),d=this.isActive();if(b===this.shape.getType()){return}this.removeFromSvg();this.shape=c.getSimilar(b,this.shape);if(a){this.addToSvg(a);if(d){this.setActive()}}this.setCoordinatesInForm()};d.prototype.addToSvg=function(a){if(null!==this.svgEl){throw new Error("this.svgEl already set")}this.svgEl=this.shape.makeSvg(a);if(!this.svgEl){return}this.svgEl.setAttribute("class","dropzone");this.svgEl.setAttribute("data-dropzone-no",this.dropzoneNo);var b=this.shape.getHandlePositions();if(null===b){return}var d=c.createSvgElement(this.svgEl,"circle");d.setAttribute("cx",b.moveHandle.x);d.setAttribute("cy",b.moveHandle.y);d.setAttribute("r",7);d.setAttribute("class","handle move");for(var e=0;e<b.editHandles.length;++e){this.makeEditHandle(e,b.editHandles[e])}};d.prototype.makeEditHandle=function(a,b){var d=c.createSvgElement(this.svgEl,"rect");d.setAttribute("x",b.x-6);d.setAttribute("y",b.y-6);d.setAttribute("width",11);d.setAttribute("height",11);d.setAttribute("class","handle edit");d.setAttribute("data-edit-handle-no",a)};d.prototype.removeFromSvg=function(){if(null!==this.svgEl){this.svgEl.parentNode.removeChild(this.svgEl);this.svgEl=null}};d.prototype.updateSvgEl=function(){if(null===this.svgEl){return}this.shape.updateSvg(this.svgEl);var a=this.shape.getHandlePositions();if(null===a){return}this.svgEl.childNodes[2].setAttribute("cx",a.moveHandle.x);this.svgEl.childNodes[2].setAttribute("cy",a.moveHandle.y);for(var b=0;b<a.editHandles.length;++b){this.svgEl.childNodes[3+b].setAttribute("x",a.editHandles[b].x-6);this.svgEl.childNodes[3+b].setAttribute("y",a.editHandles[b].y-6)}};d.prototype.isActive=function(){return null!==this.svgEl&&this.svgEl.getAttribute("class").match(/\bactive\b/)};d.prototype.setActive=function(){var a=this.svgEl.parentNode;a.removeChild(this.svgEl);a.appendChild(this.svgEl);this.svgEl.setAttribute("class",this.svgEl.getAttribute("class")+" active")};d.prototype.setCoordinatesInForm=function(){f.form.setFormValue("drops",[this.dropzoneNo,"coords"],this.shape.getCoordinates())};d.prototype.getCoordinates=function(){return f.form.getFormValue("drops",[this.dropzoneNo,"coords"]).replace(/\s*/g,"")};d.prototype.getChoiceNo=function(){return f.form.getFormValue("drops",[this.dropzoneNo,"choice"])};d.prototype.getLabel=function(){return f.form.getMarkerText(this.getChoiceNo())};d.prototype.getShapeType=function(){return f.form.getFormValue("drops",[this.dropzoneNo,"shape"])};d.prototype.handleMove=function(c){var d=b.prepare(c);if(!d.start){return}var e=this,f=d.x,g=d.y,h=this.makeDragProxy(d.x,d.y),i=a("fieldset#id_previewareaheader .dropbackground"),j=i.width(),k=i.height();b.start(c,a(h),function(a,b){e.shape.move(a-f,b-g,j,k);f=a;g=b;e.updateSvgEl();e.setCoordinatesInForm()},function(){document.body.removeChild(h)})};d.prototype.handleEdit=function(c,d,e){var f=b.prepare(c);if(!f.start){return}if("polygon"===this.shape.getType()&&(c.ctrlKey||c.metaKey)){this.shape.addNewPointAfter(d);this.removeFromSvg();this.addToSvg(e);this.setActive()}var g=this,h=f.x,i=f.y,j=this.makeDragProxy(f.x,f.y),k=a("fieldset#id_previewareaheader .dropbackground"),l=k.width(),m=k.height();b.start(c,a(j),function(a,b){g.shape.edit(d,a-h,b-i,l,m);h=a;i=b;g.updateSvgEl();g.setCoordinatesInForm()},function(){document.body.removeChild(j);g.shape.normalizeShape();g.updateSvgEl();g.setCoordinatesInForm()})};d.prototype.makeDragProxy=function(a,b){var c=document.createElement("div");c.style.position="absolute";c.style.top=b+"px";c.style.left=a+"px";c.style.width="1px";c.style.height="1px";document.body.appendChild(c);return c};var f={fp:null,noDropZones:null,dropZones:[],init:function init(){f.fp=f.filePickers();f.noDropZones=f.form.getFormValue("nodropzone",[]);f.setupPreviewArea();f.setOptionsForDragItemSelectors();f.createShapes();f.setupEventHandlers();f.waitForFilePickerToInitialise()},setupPreviewArea:function setupPreviewArea(){a("fieldset#id_previewareaheader div.fcontainer").append("<div class=\"ddarea que ddmarker\">   <div id=\"ddm-droparea\" class=\"droparea\">       <img class=\"dropbackground\" />       <div id=\"ddm-dropzone\" class=\"dropzones\">       </div>   </div></div>")},setOptionsForDragItemSelectors:function setOptionsForDragItemSelectors(){var b={0:""},c=f.form.getFormValue("noitems",[]),d=[],e,g,h;for(g=1;g<=c;g++){h=f.form.getMarkerText(g);if(""!==h){b[g]=a("<div/>").text(h).html()}}for(g=0;g<f.noDropZones;g++){e=a("#id_drops_"+g+"_choice");d[g]=+e.val()}for(g=0;g<f.noDropZones;g++){e=a("#id_drops_"+g+"_choice");e.find("option").remove();for(var j in b){j=+j;var l="<option value=\""+j+"\">"+b[j]+"</option>";e.append(l);var m=e.find("option[value=\""+j+"\"]");if(0===j){continue}if(j===d[g]){m.attr("selected",!0);continue}var n=f.form.getFormValue("drags",[j-1,"noofdrags"]);if(0===+n){continue}for(var o in d){if(+d[o]!==j){continue}if(1===+n){m.attr("disabled",!0);break}else{n--}}}if(0<f.dropZones.length){f.dropZones[g].updateLabel()}}},createShapes:function createShapes(){for(var a=0;a<f.noDropZones;a++){f.dropZones[a]=new d(a)}},setupEventHandlers:function setupEventHandlers(){a("fieldset#id_draggableitemheader").on("change input","input, select",function(){f.setOptionsForDragItemSelectors()});a("fieldset#id_dropzoneheader").on("change input","input, select",function(a){var b=a.currentTarget.name.match(/^drops\[(\d+)]\[([a-z]*)]$/);if(!b){return}var c=b[1],d=b[2],e=f.dropZones[c];switch(d){case"shape":e.changeShape(f.form.getSvg());break;case"coords":e.updateCoordinatesFromForm(f.form.getSvg());break;case"choice":e.updateLabel();break;}});var b=a("fieldset#id_previewareaheader");b.on("click","g.dropzone",function(b){var c=a(b.currentTarget).data("dropzone-no"),d=f.dropZones[c].isActive();a(f.form.getSvg()).find(".dropzone.active").removeClass("active");if(!d){f.dropZones[c].setActive()}});b.on("mousedown touchstart",".dropzone .handle.move",function(b){var c=a(b.currentTarget).closest("g").data("dropzoneNo");f.dropZones[c].handleMove(b)});b.on("mousedown touchstart",".dropzone .handle.edit",function(b){var c=a(b.currentTarget).closest("g").data("dropzoneNo"),d=b.currentTarget.getAttribute("data-edit-handle-no");f.dropZones[c].handleEdit(b,d,f.form.getSvg())})},waitForFilePickerToInitialise:function waitForFilePickerToInitialise(){if(null===f.fp.file("bgimage").href){setTimeout(f.waitForFilePickerToInitialise,1e3);return}a("form.mform").on("change","#id_bgimage",f.loadPreviewImage);f.loadPreviewImage()},loadPreviewImage:function loadPreviewImage(){a("fieldset#id_previewareaheader .dropbackground").one("load",f.afterPreviewImageLoaded).attr("src",f.fp.file("bgimage").href)},afterPreviewImageLoaded:function afterPreviewImageLoaded(){var b=a("fieldset#id_previewareaheader .dropbackground");a("#ddm-dropzone").css("position","relative").css("top",-1*(b.height()+1));a("#ddm-droparea").css("height",b.height()+20);f.updateSvgDisplay()},updateSvgDisplay:function updateSvgDisplay(){var b=a("fieldset#id_previewareaheader .dropbackground"),c;if(f.form.getSvg()){for(c=0;c<f.noDropZones;c++){f.dropZones[c].updateSvgEl()}}else{a("#ddm-dropzone").html("<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"dropzones\" width=\""+b.outerWidth()+"\" height=\""+b.outerHeight()+"\"></svg>");for(c=0;c<f.noDropZones;c++){f.dropZones[c].addToSvg(f.form.getSvg())}}},form:{getMarkerText:function getMarkerText(a){if(0!==+a){var b=f.form.getFormValue("drags",[a-1,"label"]);return b.replace(/^\s*(.*)\s*$/,"$1")}else{return""}},getSvg:function getSvg(){var b=a("fieldset#id_previewareaheader svg");if(0===b.length){return null}else{return b[0]}},toNameWithIndex:function toNameWithIndex(a,b){for(var c=a,d=0;d<b.length;d++){c=c+"["+b[d]+"]"}return c},getEl:function getEl(b,c){var d=a("form.mform")[0];return d.elements[this.toNameWithIndex(b,c)]},getFormValue:function getFormValue(a,b){var c=this.getEl(a,b);if("checkbox"===c.type){return c.checked}else{return c.value}},setFormValue:function setFormValue(a,b,c){var d=this.getEl(a,b);if("checkbox"===d.type){d.checked=c}else{d.value=c}}},filePickers:function filePickers(){var b,c;if(b===void 0){b={};c={};a("form.mform input.filepickerhidden").each(function(a,d){b[d.value]=d.name;c[d.name]=d.parentNode})}return{file:function file(b){var d=a(c[b]).find("div.filepicker-filelist a");if(d.length){return{href:d.get(0).href,name:d.get(0).innerHTML}}else{return{href:null,name:null}}},name:function name(a){return b[a]}}}};return{init:f.init}});
define ("qtype_ddmarker/question",["jquery","core/dragdrop","qtype_ddmarker/shapes","core/key_codes"],function(a,b,c,d){"use strict";function e(a,b,c){var d=this;this.containerId=a;this.visibleDropZones=c;this.shapes=[];this.shapeSVGs=[];this.isPrinting=!1;if(b){this.getRoot().addClass("qtype_ddmarker-readonly")}d.cloneDrags();d.repositionDrags();d.drawDropzones()}e.prototype.drawDropzones=function(){if(0<this.visibleDropZones.length){var a=this.bgImage();this.getRoot().find("div.dropzones").html("<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"dropzones\" width=\""+a.outerWidth()+"\" height=\""+a.outerHeight()+"\"></svg>");for(var b=this.getRoot().find("svg.dropzones"),c=0,d=0,e;d<this.visibleDropZones.length;d++){e="color"+c;c=(c+1)%8;this.addDropzone(b,d,e)}}};e.prototype.addDropzone=function(a,b,d){var e=this.visibleDropZones[b],f=c.make(e.shape,""),g,h=this.bgRatio();if(!f.parse(e.coords,h)){return}g=this.getRoot().find("div.markertexts span.markertext"+b);if(g.length){if(""!==e.markertext){g.html(e.markertext)}else{g.remove()}}else if(""!==e.markertext){this.getRoot().find("div.markertexts").append("<span class=\""+("markertext markertext"+b)+"\">"+e.markertext+"</span>");var i=this.getRoot().find("div.ddarea div.markertexts span.markertext"+b);if(i.length){var j=f.getHandlePositions(),k=j.moveHandle.x-i.outerWidth()/2-4,l=j.moveHandle.y-i.outerHeight()/2;i.css("left",k).css("top",l);i.data("originX",i.position().left/h).data("originY",i.position().top/h);this.handleElementScale(i,"center")}}var m=f.makeSvg(a[0]);m.setAttribute("class","dropzone "+d);this.shapes[this.shapes.length]=f;this.shapeSVGs[this.shapeSVGs.length]=m};e.prototype.repositionDrags=function(){var b=this.getRoot(),c=this;b.find("div.draghomes .marker").not(".dragplaceholder").each(function(b,c){a(c).addClass("unneeded")});b.find("input.choices").each(function(a,b){var d=c.getChoiceNoFromElement(b),e=c.getCoords(b);if(e.length){var f=c.getRoot().find(".draghomes span.marker.choice"+d).not(".dragplaceholder");f.remove();for(var g=0,h;g<e.length;g++){h=f.clone();h.data("pagex",e[g].x).data("pagey",e[g].y);c.sendDragToDrop(h,!1)}c.getDragClone(f).addClass("active");c.cloneDragIfNeeded(f)}})};e.prototype.getCoords=function(b){var d=[],e=a(b).val();if(""!==e){for(var f=e.split(";"),g=0;g<f.length;g++){d[g]=this.convertToWindowXY(c.Point.parse(f[g]))}}return d};e.prototype.convertToWindowXY=function(a){var b=this.bgImage();return a.offset(b.offset().left+1,b.offset().top+1)};e.prototype.convertToBgImgXY=function(a){var b=this.bgImage();return a.offset(-b.offset().left-1,-b.offset().top-1)};e.prototype.coordsInBgImg=function(a){var b=this.bgImage(),c=b.offset();return a.x>=c.left&&a.x<c.left+b.width()&&a.y>=c.top&&a.y<c.top+b.height()};e.prototype.getRoot=function(){return a(document.getElementById(this.containerId))};e.prototype.bgImage=function(){return this.getRoot().find("img.dropbackground")};e.prototype.handleDragStart=function(c){var d=this,e=a(c.target).closest(".marker"),f=b.prepare(c);if(!f.start){return}e.addClass("beingdragged").css("transform","");var g=!e.hasClass("unneeded");if(!g){var h=d.getDragClone(e);if(h.length){h.addClass("active");e.offset(h.offset())}}b.start(c,e,function(){},function(a,b,c){d.dragEnd(c)})};e.prototype.dragEnd=function(a){var b=!1,d=this.getChoiceNoFromElement(a),e=this.bgRatio(),f;a.data("pagex",a.offset().left).data("pagey",a.offset().top);f=new c.Point(a.data("pagex"),a.data("pagey"));if(this.coordsInBgImg(f)){this.sendDragToDrop(a,!0);b=!0;var g=this.convertToBgImgXY(f);g=new c.Point(g.x/e,g.y/e);a.data("originX",g.x).data("originY",g.y)}if(!b){this.sendDragHome(a);this.removeDragIfNeeded(a)}else{this.cloneDragIfNeeded(a)}this.saveCoordsForChoice(d)};e.prototype.saveCoordsForChoice=function(b){var d=[],e=this.getRoot().find("div.droparea span.marker.choice"+b),f=this,g=this.bgRatio();if(e.length){e.each(function(){var b=a(this);if(!b.hasClass("beingdragged")){var e=new c.Point(b.data("pagex"),b.data("pagey"));if(f.coordsInBgImg(e)){var h=f.convertToBgImgXY(e);h=new c.Point(h.x/g,h.y/g);d[d.length]=h}}})}this.getRoot().find("input.choice"+b).val(d.join(";"))};e.prototype.handleKeyPress=function(b){var e=a(b.target).closest(".marker"),f=new c.Point(e.offset().left,e.offset().top),g=this.getChoiceNoFromElement(e);switch(b.keyCode){case d.arrowLeft:case 65:f.x-=1;break;case d.arrowRight:case 68:f.x+=1;break;case d.arrowDown:case 83:f.y+=1;break;case d.arrowUp:case 87:f.y-=1;break;case d.space:case d.escape:f=null;break;default:return;}b.preventDefault();if(null!==f){f=this.constrainToBgImg(f);e.offset({left:f.x,top:f.y});e.data("pagex",e.offset().left).data("pagey",e.offset().top);var h=this.convertToBgImgXY(new c.Point(e.data("pagex"),e.data("pagey")));e.data("originX",h.x/this.bgRatio()).data("originY",h.y/this.bgRatio());if(this.coordsInBgImg(new c.Point(e.offset().left,e.offset().top))){if(e.hasClass("unneeded")){this.sendDragToDrop(e,!0);var i=this.getDragClone(e);if(i.length){i.addClass("active")}this.cloneDragIfNeeded(e)}}}else{e.css("left","").css("top","");e.data("pagex",e.offset().left).data("pagey",e.offset().top);this.sendDragHome(e);this.removeDragIfNeeded(e)}e.focus();this.saveCoordsForChoice(g)};e.prototype.constrainToBgImg=function(a){var b=this.bgImage(),c=this.convertToBgImgXY(a);c.x=Math.max(0,c.x);c.y=Math.max(0,c.y);c.x=Math.min(b.width(),c.x);c.y=Math.min(b.height(),c.y);return this.convertToWindowXY(c)};e.prototype.getChoiceNoFromElement=function(a){return+this.getClassnameNumericSuffix(a,"choice")};e.prototype.getClassnameNumericSuffix=function(b,c){var d=a(b).attr("class");if(d!==void 0&&""!==d){for(var e=d.split(" "),f=0,g;f<e.length;f++){g=new RegExp("^"+c+"([0-9])+$");if(g.test(e[f])){var h=/([0-9])+$/.exec(e[f]);return+h[0]}}}return null};e.prototype.handleResize=function(){var b=this,c=this.bgRatio();if(this.isPrinting){c=1}this.getRoot().find("div.droparea .marker").not(".beingdragged").each(function(d,e){a(e).css("left",parseFloat(a(e).data("originX"))*parseFloat(c)).css("top",parseFloat(a(e).data("originY"))*parseFloat(c));b.handleElementScale(e,"left top")});this.getRoot().find("div.droparea svg.dropzones").width(this.bgImage().width()).height(this.bgImage().height());for(var d=0;d<this.visibleDropZones.length;d++){var e=b.visibleDropZones[d],f=e.coords,g=b.shapes[d],h=b.shapeSVGs[d];g.parse(f,c);g.updateSvg(h);var i=g.getHandlePositions(),j=this.getRoot().find("div.ddarea div.markertexts span.markertext"+d);j.css("left",i.moveHandle.x-j.outerWidth()/2-4).css("top",i.moveHandle.y-j.outerHeight()/2);b.handleElementScale(j,"center")}};e.prototype.cloneDrags=function(){var b=this;this.getRoot().find("div.draghomes span.marker").each(function(c,d){var e=a(d),f=e.clone();f.removeClass();f.addClass("marker");f.addClass("choice"+b.getChoiceNoFromElement(e));f.addClass(b.getDragNoClass(e,!1));f.addClass("dragplaceholder");e.before(f)})};e.prototype.getDragNo=function(a){return this.getClassnameNumericSuffix(a,"dragno")};e.prototype.getDragNoClass=function(a,b){var c="dragno"+this.getDragNo(a);if(this.isInfiniteDrag(a)){c="infinite"}if(b){return"."+c}return c};e.prototype.getDragClone=function(a){return this.getRoot().find(".draghomes span.marker.choice"+this.getChoiceNoFromElement(a)+this.getDragNoClass(a,!0)+".dragplaceholder")};e.prototype.dropArea=function(){return this.getRoot().find("div.droparea")};e.prototype.sendDragHome=function(a){a.removeClass("beingdragged").addClass("unneeded").css("top","").css("left","").css("transform","");var b=this.getDragClone(a);b.after(a);b.removeClass("active")};e.prototype.sendDragToDrop=function(a,b){var d=this.dropArea(),e=this.bgRatio();a.removeClass("beingdragged").removeClass("unneeded");var f=this.convertToBgImgXY(new c.Point(a.data("pagex"),a.data("pagey")));if(b){a.data("originX",f.x/e).data("originY",f.y/e);a.css("left",f.x).css("top",f.y)}else{a.data("originX",f.x).data("originY",f.y);a.css("left",f.x*e).css("top",f.y*e)}d.append(a);this.handleElementScale(a,"left top")};e.prototype.cloneDragIfNeeded=function(a){var b=this.getInput(a),c=+this.getClassnameNumericSuffix(b,"noofdrags"),d=this.getRoot().find("div.droparea .marker.choice"+this.getChoiceNoFromElement(a)+this.getDragNoClass(a,!0)).length,e=this.getRoot().find("div.draghomes .marker.choice"+this.getChoiceNoFromElement(a)+this.getDragNoClass(a,!0)).not(".dragplaceholder").length;if((this.isInfiniteDrag(a)||!this.isInfiniteDrag(a)&&d<c)&&0===e){var g=a.clone();g.addClass("unneeded").css("top","").css("left","").css("transform","");this.getDragClone(a).removeClass("active").after(g);f.addEventHandlersToMarker(g)}};e.prototype.removeDragIfNeeded=function(a){var b=this.getRoot().find("div.draghomes .marker.choice"+this.getChoiceNoFromElement(a)+this.getDragNoClass(a,!0)).not(".dragplaceholder"),c=b.length;while(1<c){b.first().remove();c--}};e.prototype.getInput=function(a){var b=this.getChoiceNoFromElement(a);return this.getRoot().find("input.choices.choice"+b)};e.prototype.bgRatio=function(){var a=this.bgImage(),b=a.get(0).naturalWidth,c=a.width();return c/b};e.prototype.handleElementScale=function(b,c){var d=parseFloat(this.bgRatio());if(this.isPrinting){d=1}a(b).css({"-webkit-transform":"scale("+d+")","-moz-transform":"scale("+d+")","-ms-transform":"scale("+d+")","-o-transform":"scale("+d+")",transform:"scale("+d+")","transform-origin":c})};e.prototype.isInfiniteDrag=function(a){return a.hasClass("infinite")};var f={eventHandlersInitialised:!1,isPrinting:!1,isKeyboardNavigation:!1,questions:{},init:function init(a,b,c){f.questions[a]=new e(a,b,c);if(!f.eventHandlersInitialised){f.setupEventHandlers();f.eventHandlersInitialised=!0}},setupEventHandlers:function setupEventHandlers(){f.addEventHandlersToMarker(a(".que.ddmarker:not(.qtype_ddmarker-readonly) div.draghomes .marker"));f.addEventHandlersToMarker(a(".que.ddmarker:not(.qtype_ddmarker-readonly) div.droparea .marker"));a(window).on("resize",function(){f.handleWindowResize(!1)});window.addEventListener("beforeprint",function(){f.isPrinting=!0;f.handleWindowResize(f.isPrinting)});window.addEventListener("afterprint",function(){f.isPrinting=!1;f.handleWindowResize(f.isPrinting)});setTimeout(function(){f.fixLayoutIfThingsMoved()},100)},addEventHandlersToMarker:function addEventHandlersToMarker(a){a.on("mousedown touchstart",f.handleDragStart).on("keydown keypress",f.handleKeyPress).focusin(function(a){f.handleKeyboardFocus(a,!0)}).focusout(function(a){f.handleKeyboardFocus(a,!1)})},handleDragStart:function handleDragStart(a){a.preventDefault();var b=f.getQuestionForEvent(a);if(b){b.handleDragStart(a)}},handleKeyPress:function handleKeyPress(a){var b=f.getQuestionForEvent(a);if(b){b.handleKeyPress(a)}},handleWindowResize:function handleWindowResize(a){for(var b in f.questions){if(f.questions.hasOwnProperty(b)){f.questions[b].isPrinting=a;f.questions[b].handleResize()}}},handleKeyboardFocus:function handleKeyboardFocus(a,b){f.isKeyboardNavigation=b},fixLayoutIfThingsMoved:function fixLayoutIfThingsMoved(){if(!f.isKeyboardNavigation){this.handleWindowResize(f.isPrinting)}setTimeout(function(){f.fixLayoutIfThingsMoved(f.isPrinting)},100)},getQuestionForEvent:function getQuestionForEvent(b){var c=a(b.currentTarget).closest(".que.ddmarker").attr("id");return f.questions[c]}};return{init:f.init}});
define ("qtype_ddmarker/shapes",function(){"use strict";function a(a,b){this.x=a;this.y=b}a.prototype.toString=function(){return this.x+","+this.y};a.prototype.move=function(a,b){this.x+=a;this.y+=b};a.prototype.offset=function(b,c){if(b instanceof a){c=b.y;b=b.x}return new a(this.x+b,this.y+c)};a.parse=function(b){var c=b.split(",");if(2!==c.length){throw new Error(b+" is not a valid point")}return new a(Math.round(c[0]),Math.round(c[1]))};function b(b,c,d){this.label=b;this.centre=new a(c||0,d||0)}b.prototype.getType=function(){throw new Error("Not implemented.")};b.prototype.getCoordinates=function(){throw new Error("Not implemented.")};b.prototype.parse=function(a,b){void(a,b);throw new Error("Not implemented.")};b.prototype.move=function(){};b.prototype.edit=function(){};b.prototype.normalizeShape=function(){};b.prototype.makeSvg=function(){throw new Error("Not implemented.")};b.prototype.updateSvg=function(){};b.prototype.makeSimilarCircle=function(){throw new Error("Not implemented.")};b.prototype.makeSimilarRectangle=function(){throw new Error("Not implemented.")};b.prototype.makeSimilarPolygon=function(){throw new Error("Not implemented.")};b.prototype.getHandlePositions=function(){return null};function c(a,c,d,e){c=c||15;d=d||15;b.call(this,a,c,d);this.radius=e||15}c.prototype=new b;c.prototype.getType=function(){return"circle"};c.prototype.getCoordinates=function(){return this.centre+";"+Math.abs(this.radius)};c.prototype.makeSvg=function(a){var b=h(a,"circle");this.updateSvg(b);return b};c.prototype.updateSvg=function(a){a.childNodes[0].setAttribute("cx",this.centre.x);a.childNodes[0].setAttribute("cy",this.centre.y);a.childNodes[0].setAttribute("r",Math.abs(this.radius));a.childNodes[1].setAttribute("x",this.centre.x);a.childNodes[1].setAttribute("y",this.centre.y+15);a.childNodes[1].textContent=this.label};c.prototype.parse=function(b,c){if(!b.match(/^\d+(\.\d+)?,\d+(\.\d+)?;\d+(\.\d+)?$/)){return!1}var d=b.split(";");this.centre=a.parse(d[0]);this.centre.x=this.centre.x*parseFloat(c);this.centre.y=this.centre.y*parseFloat(c);this.radius=Math.round(d[1])*parseFloat(c);return!0};c.prototype.move=function(a,b,c,d){this.centre.move(a,b);if(this.centre.x<this.radius){this.centre.x=this.radius}if(this.centre.x>c-this.radius){this.centre.x=c-this.radius}if(this.centre.y<this.radius){this.centre.y=this.radius}if(this.centre.y>d-this.radius){this.centre.y=d-this.radius}};c.prototype.edit=function(a,b,c,d,e){this.radius+=b;var f=Math.min(this.centre.x,this.centre.y,d-this.centre.x,e-this.centre.y);if(this.radius>f){this.radius=f}if(this.radius<-f){this.radius=-f}};c.prototype.normalizeShape=function(){this.radius=Math.abs(this.radius)};c.prototype.makeSimilarRectangle=function(){return new d(this.label,this.centre.x-this.radius,this.centre.y-this.radius,2*this.radius,2*this.radius)};c.prototype.makeSimilarPolygon=function(){return new e(this.label,[this.centre.offset(-this.radius,-this.radius),this.centre.offset(-this.radius,this.radius),this.centre.offset(this.radius,this.radius),this.centre.offset(this.radius,-this.radius)])};c.prototype.getHandlePositions=function(){return{moveHandle:this.centre,editHandles:[this.centre.offset(this.radius,0)]}};function d(a,c,d,e,f){b.call(this,a,c,d);this.width=e||30;this.height=f||30}d.prototype=new b;d.prototype.getType=function(){return"rectangle"};d.prototype.getCoordinates=function(){return this.centre+";"+this.width+","+this.height};d.prototype.makeSvg=function(a){var b=h(a,"rect");this.updateSvg(b);return b};d.prototype.updateSvg=function(a){if(0<=this.width){a.childNodes[0].setAttribute("x",this.centre.x);a.childNodes[0].setAttribute("width",this.width)}else{a.childNodes[0].setAttribute("x",this.centre.x+this.width);a.childNodes[0].setAttribute("width",-this.width)}if(0<=this.height){a.childNodes[0].setAttribute("y",this.centre.y);a.childNodes[0].setAttribute("height",this.height)}else{a.childNodes[0].setAttribute("y",this.centre.y+this.height);a.childNodes[0].setAttribute("height",-this.height)}a.childNodes[1].setAttribute("x",this.centre.x+this.width/2);a.childNodes[1].setAttribute("y",this.centre.y+this.height/2+15);a.childNodes[1].textContent=this.label};d.prototype.parse=function(b,c){if(!b.match(/^\d+(\.\d+)?,\d+(\.\d+)?;\d+(\.\d+)?,\d+(\.\d+)?$/)){return!1}var d=b.split(";");this.centre=a.parse(d[0]);this.centre.x=this.centre.x*parseFloat(c);this.centre.y=this.centre.y*parseFloat(c);var e=a.parse(d[1]);this.width=e.x*parseFloat(c);this.height=e.y*parseFloat(c);return!0};d.prototype.move=function(a,b,c,d){this.centre.move(a,b);if(0>this.centre.x){this.centre.x=0}if(this.centre.x>c-this.width){this.centre.x=c-this.width}if(0>this.centre.y){this.centre.y=0}if(this.centre.y>d-this.height){this.centre.y=d-this.height}};d.prototype.edit=function(a,b,c,d,e){this.width+=b;this.height+=c;if(this.width<-this.centre.x){this.width=-this.centre.x}if(this.width>d-this.centre.x){this.width=d-this.centre.x}if(this.height<-this.centre.y){this.height=-this.centre.y}if(this.height>e-this.centre.y){this.height=e-this.centre.y}};d.prototype.normalizeShape=function(){if(0>this.width){this.centre.x+=this.width;this.width=-this.width}if(0>this.height){this.centre.y+=this.height;this.height=-this.height}};d.prototype.makeSimilarCircle=function(){return new c(this.label,Math.round(this.centre.x+this.width/2),Math.round(this.centre.y+this.height/2),Math.round((this.width+this.height)/4))};d.prototype.makeSimilarPolygon=function(){return new e(this.label,[this.centre,this.centre.offset(0,this.height),this.centre.offset(this.width,this.height),this.centre.offset(this.width,0)])};d.prototype.getHandlePositions=function(){return{moveHandle:this.centre.offset(this.width/2,this.height/2),editHandles:[this.centre.offset(this.width,this.height)]}};function e(c,d){b.call(this,c,0,0);this.points=d?d.slice():[new a(10,10),new a(40,10),new a(10,40)];this.normalizeShape();this.ratio=1}e.prototype=new b;e.prototype.getType=function(){return"polygon"};e.prototype.getCoordinates=function(){for(var a="",b=0;b<this.points.length;b++){a+=this.centre.offset(this.points[b])+";"}return a.slice(0,a.length-1)};e.prototype.makeSvg=function(a){var b=h(a,"polygon");this.updateSvg(b);return b};e.prototype.updateSvg=function(a){a.childNodes[0].setAttribute("points",this.getCoordinates().replace(/[,;]/g," "));a.childNodes[0].setAttribute("transform","scale("+parseFloat(this.ratio)+")");a.childNodes[1].setAttribute("x",this.centre.x);a.childNodes[1].setAttribute("y",this.centre.y+15);a.childNodes[1].textContent=this.label};e.prototype.parse=function(b,c){if(!b.match(/^\d+(\.\d+)?,\d+(\.\d+)?(?:;\d+(\.\d+)?,\d+(\.\d+)?)*$/)){return!1}for(var d=b.split(";"),e=[],f=0;f<d.length;f++){e.push(a.parse(d[f]))}this.points=e;this.centre.x=0;this.centre.y=0;this.ratio=c;this.normalizeShape();return!0};e.prototype.move=function(a,b,c,d){this.centre.move(a,b);for(var e=c,f=0,g=d,h=0,j=0;j<this.points.length;j++){e=Math.min(e,this.points[j].x);f=Math.max(f,this.points[j].x);g=Math.min(g,this.points[j].y);h=Math.max(h,this.points[j].y)}if(this.centre.x<-e){this.centre.x=-e}if(this.centre.x>c-f){this.centre.x=c-f}if(this.centre.y<-g){this.centre.y=-g}if(this.centre.y>d-h){this.centre.y=d-h}};e.prototype.edit=function(a,b,c,d,e){this.points[a].move(b,c);if(this.points[a].x<-this.centre.x){this.points[a].x=-this.centre.x}if(this.points[a].x>d-this.centre.x){this.points[a].x=d-this.centre.x}if(this.points[a].y<-this.centre.y){this.points[a].y=-this.centre.y}if(this.points[a].y>e-this.centre.y){this.points[a].y=e-this.centre.y}};e.prototype.addNewPointAfter=function(b){this.points.splice(b,0,new a(this.points[b].x,this.points[b].y))};e.prototype.normalizeShape=function(){var a,b=0,c=0;if(0===this.points.length){return}for(a=0;a<this.points.length;a++){b+=this.points[a].x;c+=this.points[a].y}b=Math.round(b/this.points.length);c=Math.round(c/this.points.length);if(0===b&&0===c){return}for(a=0;a<this.points.length;a++){this.points[a].move(-b,-c)}this.centre.move(b,c)};e.prototype.makeSimilarCircle=function(){return this.makeSimilarRectangle().makeSimilarCircle()};e.prototype.makeSimilarRectangle=function(){for(var a,b=0,c=0,e=0,f=0,g=0;g<this.points.length;g++){a=this.points[g];b=Math.min(b,a.x);c=Math.max(c,a.x);e=Math.min(e,a.y);f=Math.max(f,a.y)}return new d(this.label,this.centre.x+b,this.centre.y+e,Math.max(c-b,10),Math.max(f-e,10))};e.prototype.getHandlePositions=function(){for(var a=[],b=0;b<this.points.length;b++){a.push(this.points[b].offset(this.centre.x,this.centre.y))}this.centre.x=this.centre.x*parseFloat(this.ratio);this.centre.y=this.centre.y*parseFloat(this.ratio);return{moveHandle:this.centre,editHandles:a}};function f(a){b.call(this,a)}f.prototype=new b;f.prototype.getType=function(){return"null"};f.prototype.getCoordinates=function(){return""};f.prototype.makeSvg=function(){return null};f.prototype.updateSvg=function(){};f.prototype.parse=function(){return!1};f.prototype.makeSimilarCircle=function(){return new c(this.label)};f.prototype.makeSimilarRectangle=function(){return new d(this.label)};f.prototype.makeSimilarPolygon=function(){return new e(this.label)};function g(a,b){var c=a.ownerDocument.createElementNS("http://www.w3.org/2000/svg",b);a.appendChild(c);return c}function h(a,b){var c=g(a,"g");g(c,b).setAttribute("class","shape");g(c,"text").setAttribute("class","shapeLabel");return c}return{Point:a,Shape:b,Circle:c,Rectangle:d,Polygon:e,NullShape:f,createSvgElement:g,make:function make(a,b){switch(a){case"circle":return new c(b);case"rectangle":return new d(b);case"polygon":return new e(b);default:return new f(b);}},getSimilar:function getSimilar(a,b){if(a===b.getType()){return b}switch(a){case"circle":return b.makeSimilarCircle();case"rectangle":return b.makeSimilarRectangle();case"polygon":return b.makeSimilarPolygon();default:return new f(b.label);}}}});
define ("qtype_ddwtos/ddwtos",["jquery","core/dragdrop","core/key_codes"],function(a,b,c){"use strict";function d(a,b){this.containerId=a;if(b){this.getRoot().addClass("qtype_ddwtos-readonly")}this.resizeAllDragsAndDrops();this.cloneDrags();this.positionDrags()}d.prototype.resizeAllDragsAndDrops=function(){var b=this;this.getRoot().find(".answercontainer > div").each(function(c,d){b.resizeAllDragsAndDropsInGroup(b.getClassnameNumericSuffix(a(d),"draggrouphomes"))})};d.prototype.resizeAllDragsAndDropsInGroup=function(a){var b=this,c=this.getRoot().find(".draggrouphomes"+a+" span.draghome"),d=0,e=0;c.each(function(a,b){d=Math.max(d,Math.ceil(b.offsetWidth));e=Math.max(e,Math.ceil(0+b.offsetHeight))});d+=8;e+=2;c.each(function(a,c){b.setElementSize(c,d,e)});this.getRoot().find("span.drop.group"+a).each(function(a,c){b.setElementSize(c,d,e)})};d.prototype.setElementSize=function(b,c,d){a(b).width(c).height(d).css("lineHeight",d+"px")};d.prototype.cloneDrags=function(){var b=this;b.getRoot().find("span.draghome").each(function(c,d){var e=a(d),f=e.clone();f.removeClass();f.addClass("draghome choice"+b.getChoice(e)+" group"+b.getGroup(e)+" dragplaceholder");e.before(f)})};d.prototype.positionDrags=function(){var b=this,c=this.getRoot();c.find("span.draghome").not(".dragplaceholder").each(function(c,d){var e=a(d),f=b.getClassnameNumericSuffix(e,"inplace");e.addClass("unplaced").removeClass("placed");e.removeAttr("tabindex");if(null!==f){e.removeClass("inplace"+f)}});c.find("input.placeinput").each(function(d,e){var g=a(e),h=g.val(),i=b.getPlace(g),j=c.find(".drop.place"+i),k=j.offset();j.data("prev-top",k.top).data("prev-left",k.left);if("0"===h){return}var l=b.getUnplacedChoice(b.getGroup(g),h),m=b.getDragClone(l);if(m.length){if(l.hasClass("infinite")){var n=b.noOfDropsInGroup(b.getGroup(l)),o=b.getInfiniteDragClones(l,!1);if(o.length<n){var p=l.clone();m.after(p);f.addEventHandlersToDrag(p)}else{m.addClass("active")}}else{m.addClass("active")}}b.sendDragToDrop(b.getUnplacedChoice(b.getGroup(g),h),j)})};d.prototype.handleDragStart=function(c){var d=this,e=a(c.target).closest(".draghome"),g=b.prepare(c);if(!g.start){return}e.addClass("beingdragged");var h=this.getClassnameNumericSuffix(e,"inplace");if(null!==h){this.setInputValue(h,0);e.removeClass("inplace"+h);var i=d.getDrop(e,h);if(i.length){i.addClass("active");e.offset(i.offset())}}else{var j=d.getDragClone(e);if(j.length){if(e.hasClass("infinite")){var k=this.noOfDropsInGroup(this.getGroup(e)),l=this.getInfiniteDragClones(e,!1);if(l.length<k){var m=e.clone();m.removeClass("beingdragged");j.after(m);f.addEventHandlersToDrag(m);e.offset(m.offset())}else{j.addClass("active");e.offset(j.offset())}}else{j.addClass("active");e.offset(j.offset())}}}b.start(c,e,function(a,b,c){d.dragMove(a,b,c)},function(a,b,c){d.dragEnd(a,b,c)})};d.prototype.dragMove=function(b,c,d){var e=this;this.getRoot().find("span.drop.group"+this.getGroup(d)).each(function(d,f){var g=a(f);if(e.isPointInDrop(b,c,g)){g.addClass("valid-drag-over-drop")}else{g.removeClass("valid-drag-over-drop")}});this.getRoot().find("span.draghome.placed.group"+this.getGroup(d)).not(".beingdragged").each(function(f,g){var h=a(g);if(e.isPointInDrop(b,c,h)&&!e.isDragSameAsDrop(d,h)){h.addClass("valid-drag-over-drop")}else{h.removeClass("valid-drag-over-drop")}})};d.prototype.dragEnd=function(b,c,d){var e=this,f=this.getRoot(),g=!1;f.find("span.drop.group"+this.getGroup(d)).each(function(f,h){var i=a(h);if(!e.isPointInDrop(b,c,i)){return!0}i.removeClass("valid-drag-over-drop");e.sendDragToDrop(d,i);g=!0;return!1});f.find("span.draghome.placed.group"+this.getGroup(d)).not(".beingdragged").each(function(f,h){var i=a(h);if(!e.isPointInDrop(b,c,i)||e.isDragSameAsDrop(d,i)){return!0}i.removeClass("valid-drag-over-drop");var j=e.getClassnameNumericSuffix(i,"inplace"),k=e.getDrop(d,j);e.sendDragToDrop(d,k);g=!0;return!1});if(!g){this.sendDragHome(d)}};d.prototype.sendDragToDrop=function(a,b){var c=this.getCurrentDragInPlace(this.getPlace(b));if(0!==c.length){var d=this.getClassnameNumericSuffix(c,"inplace"),e=this.getDrop(c,d);e.addClass("active");c.addClass("beingdragged");c.offset(e.offset());this.sendDragHome(c)}if(0===a.length){this.setInputValue(this.getPlace(b),0);if(b.data("isfocus")){b.focus()}}else{this.setInputValue(this.getPlace(b),this.getChoice(a));a.removeClass("unplaced").addClass("placed inplace"+this.getPlace(b));a.attr("tabindex",0);this.animateTo(a,b)}};d.prototype.sendDragHome=function(a){var b=this.getClassnameNumericSuffix(a,"inplace");if(null!==b){a.removeClass("inplace"+b)}a.data("unplaced",!0);this.animateTo(a,this.getDragHome(this.getGroup(a),this.getChoice(a)))};d.prototype.handleKeyPress=function(b){var d=a(b.target).closest(".drop");if(0===d.length){var e=a(b.target),g=this.getClassnameNumericSuffix(e,"inplace");if(null!==g){d=this.getDrop(e,g)}}var h=this.getCurrentDragInPlace(this.getPlace(d)),i=a();switch(b.keyCode){case c.space:case c.arrowRight:case c.arrowDown:i=this.getNextDrag(this.getGroup(d),h);break;case c.arrowLeft:case c.arrowUp:i=this.getPreviousDrag(this.getGroup(d),h);break;case c.escape:break;default:f.isKeyboardNavigation=!1;return;}if(i.length){i.data("isfocus",!0);i.addClass("beingdragged");var j=this.getDragClone(i);if(j.length){if(i.hasClass("infinite")){var k=this.noOfDropsInGroup(this.getGroup(i)),l=this.getInfiniteDragClones(i,!1);if(l.length<k){var m=i.clone();m.removeClass("beingdragged");m.removeAttr("tabindex");j.after(m);f.addEventHandlersToDrag(m);i.offset(m.offset())}else{j.addClass("active");i.offset(j.offset())}}else{j.addClass("active");i.offset(j.offset())}}}else{d.data("isfocus",!0)}b.preventDefault();this.sendDragToDrop(i,d)};d.prototype.getNextDrag=function(a,b){var c,d=this.noOfChoicesInGroup(a);if(0===b.length){c=1}else{c=this.getChoice(b)+1}var e=this.getUnplacedChoice(a,c);while(0===e.length&&c<d){c++;e=this.getUnplacedChoice(a,c)}return e};d.prototype.getPreviousDrag=function(a,b){var c;if(0===b.length){c=this.noOfChoicesInGroup(a)}else{c=this.getChoice(b)-1}var d=this.getUnplacedChoice(a,c);while(0===d.length&&1<c){c--;d=this.getUnplacedChoice(a,c)}return d};d.prototype.animateTo=function(b,c){var d=b.offset(),e=c.offset(),f=this;M.util.js_pending("qtype_ddwtos-animate-"+f.containerId);b.animate({left:parseInt(b.css("left"))+e.left-d.left,top:parseInt(b.css("top"))+e.top-d.top},{duration:"fast",done:function done(){a("body").trigger("qtype_ddwtos-dragmoved",[b,c,f]);M.util.js_complete("qtype_ddwtos-animate-"+f.containerId)}})};d.prototype.isPointInDrop=function(a,b,c){var d=c.offset();return a>=d.left&&a<d.left+c.width()&&b>=d.top&&b<d.top+c.height()};d.prototype.setInputValue=function(a,b){this.getRoot().find("input.placeinput.place"+a).val(b)};d.prototype.getRoot=function(){return a(document.getElementById(this.containerId))};d.prototype.getDragHome=function(a,b){if(!this.getRoot().find(".draghome.dragplaceholder.group"+a+".choice"+b).is(":visible")){return this.getRoot().find(".draggrouphomes"+a+" span.draghome.infinite.choice"+b+".group"+a)}return this.getRoot().find(".draghome.dragplaceholder.group"+a+".choice"+b)};d.prototype.getUnplacedChoice=function(a,b){return this.getRoot().find(".draghome.group"+a+".choice"+b+".unplaced").slice(0,1)};d.prototype.getCurrentDragInPlace=function(a){return this.getRoot().find("span.draghome.inplace"+a)};d.prototype.noOfDropsInGroup=function(a){return this.getRoot().find(".drop.group"+a).length};d.prototype.noOfChoicesInGroup=function(a){return this.getRoot().find(".draghome.group"+a).length};d.prototype.getClassnameNumericSuffix=function(a,b){var c=a.attr("class");if(""!==c){for(var d=c.split(" "),e=0,f;e<d.length;e++){f=new RegExp("^"+b+"([0-9])+$");if(f.test(d[e])){var g=/([0-9])+$/.exec(d[e]);return+g[0]}}}return null};d.prototype.getChoice=function(a){return this.getClassnameNumericSuffix(a,"choice")};d.prototype.getGroup=function(a){return this.getClassnameNumericSuffix(a,"group")};d.prototype.getPlace=function(a){return this.getClassnameNumericSuffix(a,"place")};d.prototype.getDragClone=function(a){return this.getRoot().find(".draggrouphomes"+this.getGroup(a)+" span.draghome.choice"+this.getChoice(a)+".group"+this.getGroup(a)+".dragplaceholder")};d.prototype.getInfiniteDragClones=function(a,b){if(b){return this.getRoot().find(".draggrouphomes"+this.getGroup(a)+" span.draghome.choice"+this.getChoice(a)+".group"+this.getGroup(a)+".infinite").not(".dragplaceholder")}return this.getRoot().find("span.draghome.choice"+this.getChoice(a)+".group"+this.getGroup(a)+".infinite").not(".dragplaceholder")};d.prototype.getDrop=function(a,b){return this.getRoot().find(".drop.group"+this.getGroup(a)+".place"+b)};d.prototype.isDragSameAsDrop=function(a,b){return this.getChoice(a)===this.getChoice(b)&&this.getGroup(a)===this.getGroup(b)};var f={eventHandlersInitialised:!1,isKeyboardNavigation:!1,questions:{},init:function init(a,b){f.questions[a]=new d(a,b);if(!f.eventHandlersInitialised){f.setupEventHandlers();f.eventHandlersInitialised=!0}},setupEventHandlers:function setupEventHandlers(){f.addEventHandlersToDrag(a(".que.ddwtos:not(.qtype_ddwtos-readonly) span.draghome"));a("body").on("keydown",".que.ddwtos:not(.qtype_ddwtos-readonly) span.drop",f.handleKeyPress).on("keydown",".que.ddwtos:not(.qtype_ddwtos-readonly) span.draghome.placed:not(.beingdragged)",f.handleKeyPress).on("qtype_ddwtos-dragmoved",f.handleDragMoved)},addEventHandlersToDrag:function addEventHandlersToDrag(a){a.unbind("mousedown touchstart");a.on("mousedown touchstart",f.handleDragStart)},handleDragStart:function handleDragStart(a){a.preventDefault();var b=f.getQuestionForEvent(a);if(b){b.handleDragStart(a)}},handleKeyPress:function handleKeyPress(a){if(f.isKeyboardNavigation){return}f.isKeyboardNavigation=!0;var b=f.getQuestionForEvent(a);if(b){b.handleKeyPress(a)}},getQuestionForEvent:function getQuestionForEvent(b){var c=a(b.currentTarget).closest(".que.ddwtos").attr("id");return f.questions[c]},handleDragMoved:function handleDragMoved(a,b,c,d){b.removeClass("beingdragged");b.css("top","").css("left","");c.after(b);c.removeClass("active");if("undefined"!=typeof b.data("unplaced")&&!0===b.data("unplaced")){b.removeClass("placed").addClass("unplaced");b.removeAttr("tabindex");b.removeData("unplaced");if(b.hasClass("infinite")&&1<d.getInfiniteDragClones(b,!0).length){d.getInfiniteDragClones(b,!0).first().remove()}}if("undefined"!=typeof b.data("isfocus")&&!0===b.data("isfocus")){b.focus();b.removeData("isfocus")}if("undefined"!=typeof c.data("isfocus")&&!0===c.data("isfocus")){c.removeData("isfocus")}if(f.isKeyboardNavigation){f.isKeyboardNavigation=!1}}};return{init:f.init}});
define ("qtype_multichoice/answers",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var b={ANSWER_LABEL:"[data-region=answer-label]"};a.default={init:function init(a){var c=document.getElementById(a),d=c.querySelectorAll(b.ANSWER_LABEL);d.forEach(function(a){a.addEventListener("click",function(a){var b=a.currentTarget.id,d=c.querySelector("[aria-labelledby=\"".concat(b,"\"]"));d.click()})})}};return a.default});
define ("qtype_multichoice/clearchoice",["jquery","core/custom_interaction_events"],function(a,b){var c={CHOICE_ELEMENT:".answer input",LINK:"a",RADIO:"input[type=\"radio\"]"},d=function(a){a.find(c.RADIO).prop("disabled",!1).prop("checked",!0)},e=function(a,b){return a.find("div[id=\""+b+"\"]")},f=function(a){a.addClass("sr-only");a.attr("aria-hidden",!0);a.find(c.LINK).attr("tabindex",-1)},g=function(a){a.removeClass("sr-only");a.removeAttr("aria-hidden");a.find(c.LINK).attr("tabindex",0);a.find(c.RADIO).prop("disabled",!0)},h=function(a,h){var i=e(a,h);i.on(b.events.activate,c.LINK,function(a,b){d(i);f(i);b.originalEvent.preventDefault()});a.on("change",c.CHOICE_ELEMENT,function(){g(i)});i.find(c.RADIO).focus(function(){var b=a.find(c.CHOICE_ELEMENT).first();b.focus()})};return{init:function init(b,c){b=a("#"+b);h(b,c)}}});
define ("mod_assign/grading_actions",["jquery","mod_assign/grading_events"],function(a,b){var c=function(b){this._regionSelector=b;this._region=a(b);this.registerEventListeners()};c.prototype._regionSelector=null;c.prototype._lastUserId=0;c.prototype._region=null;c.prototype._showActionsForm=function(a,b){var c=this._region.find("[data-region=grading-actions-form]");if(b!=this._lastUserId&&0<b){this._lastUserId=b}if(0<b){c.removeClass("hide")}else{c.addClass("hide")}};c.prototype._trigger=function(b){a(document).trigger(b)};c.prototype.getReviewPanelElement=function(){return a("[data-region=\"review-panel\"]")};c.prototype.hasReviewPanelElement=function(){return 0<this.getReviewPanelElement().length};c.prototype.getCollapseGradePanelButton=function(){return a("[data-region=\"grade-actions\"] .collapse-grade-panel")};c.prototype.getCollapseReviewPanelButton=function(){return a("[data-region=\"grade-actions\"] .collapse-review-panel")};c.prototype.getExpandAllPanelsButton=function(){return a("[data-region=\"grade-actions\"] .collapse-none")};c.prototype.resetLayoutButtons=function(){this.getCollapseGradePanelButton().removeClass("active");this.getCollapseReviewPanelButton().removeClass("active");this.getExpandAllPanelsButton().removeClass("active")};c.prototype.collapseReviewPanel=function(){a(document).trigger(b.COLLAPSE_REVIEW_PANEL);a(document).trigger(b.EXPAND_GRADE_PANEL);this.resetLayoutButtons();this.getCollapseReviewPanelButton().addClass("active")};c.prototype.collapseGradePanel=function(){a(document).trigger(b.COLLAPSE_GRADE_PANEL);a(document).trigger(b.EXPAND_REVIEW_PANEL);this.resetLayoutButtons();this.getCollapseGradePanelButton().addClass("active")};c.prototype.expandAllPanels=function(){a(document).trigger(b.EXPAND_GRADE_PANEL);a(document).trigger(b.EXPAND_REVIEW_PANEL);this.resetLayoutButtons();this.getExpandAllPanelsButton().addClass("active")};c.prototype.registerEventListeners=function(){if(this.hasReviewPanelElement()){var b=this.getCollapseReviewPanelButton();b.click(function(a){this.collapseReviewPanel();a.preventDefault()}.bind(this));b.keydown(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(13===a.keyCode||32===a.keyCode){this.collapseReviewPanel();a.preventDefault()}}}.bind(this));var c=this.getCollapseGradePanelButton();c.click(function(a){this.collapseGradePanel();a.preventDefault()}.bind(this));c.keydown(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(13===a.keyCode||32===a.keyCode){this.collapseGradePanel();a.preventDefault()}}}.bind(this));var d=this.getExpandAllPanelsButton();d.click(function(a){this.expandAllPanels();a.preventDefault()}.bind(this));d.keydown(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(13===a.keyCode||32===a.keyCode){this.expandAllPanels();a.preventDefault()}}}.bind(this))}a(document).on("user-changed",this._showActionsForm.bind(this));this._region.find("[name=\"savechanges\"]").on("click",this._trigger.bind(this,"save-changes"));this._region.find("[name=\"saveandshownext\"]").on("click",this._trigger.bind(this,"save-and-show-next"));this._region.find("[name=\"resetbutton\"]").on("click",this._trigger.bind(this,"reset"));this._region.find("form").on("submit",function(a){a.preventDefault()})};return c});
define ("mod_assign/grading_events",function(){return{COLLAPSE_REVIEW_PANEL:"grading:collapse-review-panel",EXPAND_REVIEW_PANEL:"grading:expand-review-panel",COLLAPSE_GRADE_PANEL:"grading:collapse-grade-panel",EXPAND_GRADE_PANEL:"grading:expand-grade-panel"}});
define ("mod_assign/grading_form_change_checker",["jquery"],function(a){return{saveFormState:function saveFormState(b){a(b).trigger("save-form-state");var c=a(b).serialize();a(b).data("saved-form-state",c)},checkFormForChanges:function checkFormForChanges(b){a(b).trigger("save-form-state");var c=a(b).serialize(),d=a(b).data("saved-form-state");if("undefined"==typeof d){return!1}return d!=c}}});
define ("mod_assign/grading_navigation",["jquery","core/notification","core/str","core/form-autocomplete","core/ajax","mod_assign/grading_form_change_checker"],function(a,b,c,d,e,f){var g=function(e){this._regionSelector=e;this._region=a(e);this._filters=[];this._users=[];this._filteredUsers=[];this._lastXofYUpdate=0;this._firstLoadUsers=!0;this._loadAllUsers();this._region.find("[data-action=\"previous-user\"]").on("click",this._handlePreviousUser.bind(this));this._region.find("[data-action=\"next-user\"]").on("click",this._handleNextUser.bind(this));this._region.find("[data-action=\"change-user\"]").on("change",this._handleChangeUser.bind(this));this._region.find("[data-region=\"user-filters\"]").on("click",this._toggleExpandFilters.bind(this));a(document).on("user-changed",this._refreshSelector.bind(this));a(document).on("done-saving-show-next",this._handleNextUser.bind(this));var f=this._region.find("[data-region=\"user-filters\"]"),g=a(document.getElementById(f.attr("aria-controls")));g.on("change","select",this._filterChanged.bind(this));var h=a("[data-region=\"grading-navigation-panel\"]").data("first-userid");if(h){this._selectUserById(h)}c.get_string("changeuser","mod_assign").done(function(a){d.enhance("[data-action=change-user]",!1,"mod_assign/participant_selector",a)}).fail(b.exception);a(document).bind("start-loading-user",function(){this._isLoading=!0}.bind(this));a(document).bind("finish-loading-user",function(){this._isLoading=!1}.bind(this))};g.prototype._isLoading=!1;g.prototype._regionSelector=null;g.prototype._filters=null;g.prototype._users=null;g.prototype._region=null;g.prototype._lastFilters="";g.prototype._loadAllUsers=function(){var a=this._region.find("[data-action=change-user]"),c=a.attr("data-assignmentid"),d=a.attr("data-groupid"),f=this._region.find("[data-region=\"configure-filters\"]"),g=f.find("select[name=\"filter\"]").val(),h=f.find("select[name=\"workflowfilter\"]");if(h){g+=","+h.val()}var i=f.find("select[name=\"markerfilter\"]");if(i){g+=","+i.val()}if(this._lastFilters==g){return!1}this._lastFilters=g;e.call([{methodname:"mod_assign_list_participants",args:{assignid:c,groupid:d,filter:"",onlyids:!0,tablesort:!0},done:this._usersLoaded.bind(this),fail:b.exception}]);return!0};g.prototype._usersLoaded=function(b){this._firstLoadUsers=!1;this._filteredUsers=this._users=b;if(this._users.length){var c=this._region.find("[data-region=\"user-filters\"]"),d=a(document.getElementById(c.attr("aria-controls")));d.find("select[name=\"filter\"]").trigger("change")}else{this._selectNoUser()}this._triggerNextUserEvent()};g.prototype._checkClickOutsideConfigureFilters=function(b){var c=this._region.find("[data-region=\"configure-filters\"]");if(!c.is(b.target)&&0===c.has(b.target).length){var d=this._region.find("[data-region=\"user-filters\"]");c.hide();c.attr("aria-hidden","true");d.attr("aria-expanded","false");a(document).unbind("click.mod_assign_grading_navigation")}};g.prototype._updateFilterPreferences=function(b,c,d){var f=[],g=0;if(0==c.length||this._firstLoadUsers){var h=a.Deferred();h.resolve();return h}for(g=0;g<c.length;g++){var j=c[g];if("none"==j){j=""}f.push({userid:b,name:d[g],value:j})}return e.call([{methodname:"core_user_set_user_preferences",args:{preferences:f}}])[0]};g.prototype._filterChanged=function(){var d=this._region.find("[data-region=\"configure-filters\"]"),e=d.find("select"),f=[];this._filters=[];e.each(function(b,c){var d=a(c);this._filters.push(d.val());f.push("assign_"+d.prop("name"))}.bind(this));var g=[];d.find("option:checked").each(function(b,c){g[g.length]=a(c).text()});if(g.length){this._region.find("[data-region=\"user-filters\"] span").text(g.join(", "))}else{c.get_string("nofilters","mod_assign").done(function(a){this._region.find("[data-region=\"user-filters\"] span").text(a)}.bind(this)).fail(b.exception)}var h=this._region.find("[data-action=change-user]"),i=h.data("currentuserid");this._updateFilterPreferences(i,this._filters,f).done(function(){if(!this._loadAllUsers()){var b=parseInt(h.attr("data-selected")),c=0;a.each(this._filteredUsers,function(a,d){if(b==d.id){c=a}});if(this._filteredUsers.length){this._selectUserById(this._filteredUsers[c].id)}else{this._selectNoUser()}}}.bind(this)).fail(b.exception);this._refreshCount()};g.prototype._selectNoUser=function(){if(this._isLoading){return}if(f.checkFormForChanges("[data-region=\"grade-panel\"] .gradeform")){c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",-1)})})}else{a(document).trigger("user-changed",-1)}};g.prototype._selectUserById=function(d){var e=this._region.find("[data-action=change-user]"),g=parseInt(d,10);if(this._isLoading){return}if(f.checkFormForChanges("[data-region=\"grade-panel\"] .gradeform")){c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",g)})})}else{e.attr("data-selected",d);if(!isNaN(g)&&0<g){a(document).trigger("user-changed",d)}}};g.prototype._toggleExpandFilters=function(b){b.preventDefault();var c=a(b.target).closest("[data-region=\"user-filters\"]"),d="true"==c.attr("aria-expanded"),e=a(document.getElementById(c.attr("aria-controls")));if(d){e.hide();e.attr("aria-hidden","true");c.attr("aria-expanded","false");a(document).unbind("click.mod_assign_grading_navigation")}else{e.css("display","inline-block");e.attr("aria-hidden","false");c.attr("aria-expanded","true");b.stopPropagation();a(document).on("click.mod_assign_grading_navigation",this._checkClickOutsideConfigureFilters.bind(this))}};g.prototype._handlePreviousUser=function(a){a.preventDefault();var b=this._region.find("[data-action=change-user]"),c=b.attr("data-selected"),d=0,e=0;for(d=0;d<this._filteredUsers.length;d++){if(this._filteredUsers[d].id==c){e=d;break}}var f=this._filteredUsers.length,g=e-1;if(0>g){g=f-1}if(f){this._selectUserById(this._filteredUsers[g].id)}};g.prototype._handleNextUser=function(b,c){b.preventDefault();var d=this._region.find("[data-action=change-user]"),e=d.attr("data-selected"),f=0,g=0;for(f=0;f<this._filteredUsers.length;f++){if(this._filteredUsers[f].id==e){g=f;break}}var h=this._filteredUsers.length,j=(g+1)%h;if(c&&h){var k=this._filteredUsers[j].id,l=parseInt(k,10);d.attr("data-selected",k);if(!isNaN(l)&&0<l){a(document).trigger("user-changed",k)}}else if(h){this._selectUserById(this._filteredUsers[j].id)}};g.prototype._setCountString=function(a,d){var e=0;this._lastXofYUpdate++;e=this._lastXofYUpdate;c.get_string("xofy","mod_assign",{x:a,y:d}).done(function(a){if(e==this._lastXofYUpdate){this._region.find("[data-region=\"user-count-summary\"]").text(a)}}.bind(this)).fail(b.exception)};g.prototype._refreshCount=function(){var a=this._region.find("[data-action=change-user]"),b=a.attr("data-selected"),c=0,d=0;if(isNaN(b)||0>=b){this._region.find("[data-region=\"user-count\"]").hide()}else{this._region.find("[data-region=\"user-count\"]").show();for(c=0;c<this._filteredUsers.length;c++){if(this._filteredUsers[c].id==b){d=c;break}}var e=this._filteredUsers.length;if(e){d+=1}this._setCountString(d,e);if(0<d){var f=new URL(window.location);if(0<parseInt(f.searchParams.get("blindid"))){var g=this._filteredUsers[d-1].recordid;f.searchParams.set("blindid",g)}else{f.searchParams.set("userid",b)}window.history.replaceState({},"",f)}}};g.prototype._refreshSelector=function(a,b){var c=this._region.find("[data-action=change-user]");b=parseInt(b,10);if(!isNaN(b)&&0<b){c.attr("data-selected",b)}this._refreshCount()};g.prototype._triggerNextUserEvent=function(){if(1<this._filteredUsers.length){a(document).trigger("next-user",{nextUserId:null,nextUser:!0})}else{a(document).trigger("next-user",{nextUser:!1})}};g.prototype._handleChangeUser=function(){var d=this._region.find("[data-action=change-user]"),e=parseInt(d.val(),10);if(this._isLoading){return}if(f.checkFormForChanges("[data-region=\"grade-panel\"] .gradeform")){c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",e)})})}else{if(!isNaN(e)&&0<e){d.attr("data-selected",e);a(document).trigger("user-changed",e)}}};return g});
define ("mod_assign/grading_navigation_user_info",["jquery","core/notification","core/ajax","core/templates"],function(a,b,c,d){var e=function(b){this._regionSelector=b;this._region=a(b);this._userCache={};a(document).on("user-changed",this._refreshUserInfo.bind(this))};e.prototype._regionSelector=null;e.prototype._userCache=null;e.prototype._region=null;e.prototype._lastUserId=0;e.prototype._getAssignmentId=function(){return this._region.attr("data-assignmentid")};e.prototype._refreshUserInfo=function(e,f){var g=a.Deferred();this._region.attr("data-userid",f);if(this._lastUserId==f){return}this._lastUserId=f;d.render("mod_assign/loading",{}).done(function(e,h){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,e,h);this._region.fadeIn("fast")}.bind(this));if(0>f){d.render("mod_assign/grading_navigation_no_users",{}).done(function(a,b){if(f==this._lastUserId){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b);this._region.fadeIn("fast")}.bind(this))}}.bind(this)).fail(b.exception);return}if("undefined"!=typeof this._userCache[f]){g.resolve(this._userCache[f])}else{var i=this._getAssignmentId(),j=c.call([{methodname:"mod_assign_get_participant",args:{userid:f,assignid:i,embeduser:!0}}]);j[0].done(function(a){if(!a.hasOwnProperty("id")){g.reject("No users")}else{this._userCache[f]=a;g.resolve(this._userCache[f])}}.bind(this)).fail(b.exception)}g.done(function(c){var e=a("[data-showuseridentity]").data("showuseridentity").split(","),g=[];
    
    c.courseid=a("[data-region=\"grading-navigation-panel\"]").attr("data-courseid");
    if(c.user){a.each(e,function(a,b){if("undefined"!=typeof c.user[b]&&""!==c.user[b]){c.hasidentity=!0;g.push(c.user[b])}});c.identity=g.join(", ");if(c.user.profileimageurl){c.profileimageurl=c.user.profileimageurl}}d.render("mod_assign/grading_navigation_user_summary",c).done(function(a,b){if(f==this._lastUserId){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b);this._region.fadeIn("fast")}.bind(this))}}.bind(this)).fail(b.exception)}.bind(this)).fail(function(){d.render("mod_assign/grading_navigation_no_users",{}).done(function(a,b){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b);this._region.fadeIn("fast")}.bind(this))}.bind(this)).fail(b.exception)}.bind(this))}.bind(this)).fail(b.exception)};return e});
define ("mod_assign/grading_panel",["jquery","core/yui","core/notification","core/templates","core/fragment","core/ajax","core/str","mod_assign/grading_form_change_checker","mod_assign/grading_events","core/event"],function(a,b,c,d,e,f,g,h,i,j){var k=function(b){this._regionSelector=b;this._region=a(b);this._userCache=[];this.registerEventListeners()};k.prototype._regionSelector=null;k.prototype._lastUserId=0;k.prototype._lastAttemptNumber=-1;k.prototype._region=null;k.prototype.nextUserId=null;k.prototype.nextUser=!1;k.prototype._niceReplaceNodeContents=function(b,c,e){var f=a.Deferred();b.fadeOut("fast",function(){d.replaceNodeContents(b,c,e);b.fadeIn("fast",function(){f.resolve()})});return f.promise()};k.prototype._saveFormState=function(){var b=a("[data-region=\"grading-actions-form\"] [name=\"sendstudentnotifications\"]").prop("checked");a(".gradeform [name=\"sendstudentnotifications\"]").val(b)};k.prototype._submitForm=function(b,d,e){var g=a(this._region.find("form.gradeform"));a("[data-region=\"overlay\"]").show();g.trigger("save-form-state");j.notifyFormSubmitAjax(g[0]);var h=g.serialize(),i=this._region.attr("data-assignmentid");f.call([{methodname:"mod_assign_submit_grading_form",args:{assignmentid:i,userid:this._lastUserId,jsonformdata:JSON.stringify(h)},done:this._handleFormSubmissionResponse.bind(this,h,d,e),fail:c.exception}])};k.prototype._handleFormSubmissionResponse=function(d,e,f,h){if("undefined"==typeof e){e=this._lastUserId}if(h.length){a(document).trigger("reset",[this._lastUserId,d])}else{g.get_strings([{key:"changessaved",component:"core"},{key:"gradechangessaveddetail",component:"mod_assign"}]).done(function(a){c.alert(a[0],a[1])}).fail(c.exception);b.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()});if(e==this._lastUserId){a(document).trigger("reset",e)}else if(f){a(document).trigger("done-saving-show-next",!0)}else{a(document).trigger("user-changed",e)}}a("[data-region=\"overlay\"]").hide()};k.prototype._resetForm=function(b,c,d){var e=a.Event("custom");if("undefined"==typeof c){c=this._lastUserId}this._lastUserId=0;this._refreshGradingPanel(e,c,d)};k.prototype._chooseAttempt=function(b){var d=a(b.target),e=d.data("submissions"),f=a(document.getElementById(e)),h=f.clone(),i=h.wrap(a("<form/>")).html();g.get_strings([{key:"viewadifferentattempt",component:"mod_assign"},{key:"view",component:"core"},{key:"cancel",component:"core"}]).done(function(b){c.confirm(b[0],i,b[1],b[2],function(){var b=a("input:radio[name='select-attemptnumber']:checked").val();this._refreshGradingPanel(null,this._lastUserId,"",b)}.bind(this))}.bind(this)).fail(c.exception)};k.prototype._addPopoutButtons=function(b){var e=a(b);d.render("mod_assign/popout_button",{}).done(function(a){var b=e.find("[data-fieldtype=\"filemanager\"],[data-fieldtype=\"editor\"],[data-fieldtype=\"grading\"]").closest(".fitem");b.addClass("has-popout").find("label").parent().append(a);e.on("click","[data-region=\"popout-button\"]",this._togglePopout.bind(this))}.bind(this)).fail(c.exception)};k.prototype._togglePopout=function(b){b.preventDefault();var c=a(b.target).closest(".fitem");if(c.hasClass("popout")){a(".popout").removeClass("popout")}else{a(".popout").removeClass("popout");c.addClass("popout");c.addClass("moodle-has-zindex")}};k.prototype._refreshGradingPanel=function(b,f,g,i){var j=this._region.attr("data-contextid");if("undefined"==typeof g){g=""}if("undefined"==typeof i){i=-1}if(this._lastUserId==f&&this._lastAttemptNumber==i&&""===g){return}this._lastUserId=f;this._lastAttemptNumber=i;a(document).trigger("start-loading-user");window.M.util.js_pending("mod-assign-loading-user");d.render("mod_assign/loading",{}).done(function(b,d){this._niceReplaceNodeContents(this._region,b,d).done(function(){if(0<f){this._region.show();var b={userid:f,attemptnumber:i,jsonformdata:JSON.stringify(g)};e.loadFragment("mod_assign","gradingpanel",j,b).done(function(b,d){this._niceReplaceNodeContents(this._region,b,d).done(function(){h.saveFormState("[data-region=\"grade-panel\"] .gradeform");a(document).on("editor-content-restored",function(){h.saveFormState("[data-region=\"grade-panel\"] .gradeform")});a("[data-region=\"attempt-chooser\"]").on("click",this._chooseAttempt.bind(this));this._addPopoutButtons("[data-region=\"grade-panel\"] .gradeform");a(document).trigger("finish-loading-user");window.M.util.js_complete("mod-assign-loading-user")}.bind(this)).fail(c.exception)}.bind(this)).fail(c.exception);a("[data-region=\"review-panel\"]").show()}else{this._region.hide();a("[data-region=\"review-panel\"]").hide();a(document).trigger("finish-loading-user");window.M.util.js_complete("mod-assign-loading-user")}}.bind(this))}.bind(this)).fail(c.exception)};k.prototype._getNextUser=function(a,b){this.nextUserId=b.nextUserId;this.nextUser=b.nextUser};k.prototype._handleSaveAndShowNext=function(){this._submitForm(null,this.nextUserId,this.nextUser)};k.prototype.getPanelElement=function(){return a("[data-region=\"grade-panel\"]")};k.prototype.collapsePanel=function(){this.getPanelElement().addClass("collapsed")};k.prototype.expandPanel=function(){this.getPanelElement().removeClass("collapsed")};k.prototype.registerEventListeners=function(){var b=a(document),c=a(this._region);c.on("submit","form",function(a){a.preventDefault()});b.on("next-user",this._getNextUser.bind(this));b.on("user-changed",this._refreshGradingPanel.bind(this));b.on("save-changes",this._submitForm.bind(this));b.on("save-and-show-next",this._handleSaveAndShowNext.bind(this));b.on("reset",this._resetForm.bind(this));b.on("save-form-state",this._saveFormState.bind(this));b.on(i.COLLAPSE_GRADE_PANEL,function(){this.collapsePanel()}.bind(this));b.on(i.COLLAPSE_REVIEW_PANEL,function(){this.expandPanel()}.bind(this));b.on(i.EXPAND_GRADE_PANEL,function(){this.expandPanel()}.bind(this))};return k});
define ("mod_assign/grading_review_panel",["jquery","mod_assign/grading_events"],function(a,b){var c=function(){this._region=a("[data-region=\"review-panel-content\"]");this.registerEventListeners()};c.prototype._region=null;c.prototype.getReviewPanel=function(a){var b=this._region.data("panel-owner");if("undefined"==typeof b){this._region.data("review-panel-plugin",a)}if(this._region.data("review-panel-plugin")==a){return this._region[0]}return!1};c.prototype.getTogglePanelButton=function(){return this.getPanelElement().find("[data-region=\"review-panel-toggle\"]")};c.prototype.getPanelElement=function(){return a("[data-region=\"review-panel\"]")};c.prototype.getPanelContentElement=function(){return a("[data-region=\"review-panel-content\"]")};c.prototype.togglePanel=function(){if(this.getPanelElement().hasClass("collapsed")){a(document).trigger(b.EXPAND_REVIEW_PANEL)}else{a(document).trigger(b.COLLAPSE_REVIEW_PANEL)}};c.prototype.collapsePanel=function(){this.getPanelElement().addClass("collapsed").removeClass("grade-panel-collapsed");this.getPanelContentElement().attr("aria-hidden",!0)};c.prototype.expandPanel=function(){this.getPanelElement().removeClass("collapsed");this.getPanelContentElement().removeAttr("aria-hidden")};c.prototype.registerEventListeners=function(){var c=this.getTogglePanelButton();c.click(function(a){this.togglePanel();a.preventDefault()}.bind(this));c.keydown(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(13===a.keyCode||32===a.keyCode){this.togglePanel();a.preventDefault()}}}.bind(this));var d=a(document);d.on(b.COLLAPSE_REVIEW_PANEL,function(){this.collapsePanel()}.bind(this));d.on(b.COLLAPSE_GRADE_PANEL,function(){this.expandPanel();this.getPanelElement().addClass("grade-panel-collapsed")}.bind(this));d.on(b.EXPAND_REVIEW_PANEL,function(){this.expandPanel()}.bind(this));d.on(b.EXPAND_GRADE_PANEL,function(){this.getPanelElement().removeClass("grade-panel-collapsed")}.bind(this))};return c});
define ("mod_assign/override_form",["exports","jquery"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);var c=function(a,c){var d=document.getElementById(a),e=d.querySelector("[name=\"".concat(c,"\"]"));(0,b.default)(e).on("change",function(){var a=document.createElement("input");a.setAttribute("type","hidden");a.setAttribute("name","userchange");a.setAttribute("value",!0);d.appendChild(a);if("undefined"!=typeof M.core_formchangechecker){M.core_formchangechecker.reset_form_dirty_state()}d.submit()})};a.init=c});
define ("mod_assign/participant_selector",["core/ajax","jquery","core/templates"],function(a,b,c){return{processResults:function processResults(a,b){return b},transport:function transport(d,e,f,g){var h=b(d).attr("data-assignmentid"),i=b(d).attr("data-groupid"),j=b("[data-region=\"configure-filters\"] input[type=\"checkbox\"]"),k=[];j.each(function(a,c){k[b(c).attr("name")]=b(c).prop("checked")});a.call([{methodname:"mod_assign_list_participants",args:{assignid:h,groupid:i,filter:e,limit:30,includeenrolments:!1,tablesort:!0}}])[0].then(function(a){var d=[],e=b("[data-showuseridentity]").data("showuseridentity").split(",");b.each(a,function(a,f){var g=f,h=[],i=!0;if(k.filter_submitted&&!f.submitted){i=!1}if(k.filter_notsubmitted&&f.submitted){i=!1}if(k.filter_requiregrading&&!f.requiregrading){i=!1}if(k.filter_grantedextension&&!f.grantedextension){i=!1}if(i){b.each(e,function(a,b){if("undefined"!=typeof f[b]&&""!==f[b]){g.hasidentity=!0;h.push(f[b])}});g.identity=h.join(", ");d.push(c.render("mod_assign/list_participant_user_summary",g).then(function(a){return{value:f.id,label:a}}))}});return b.when.apply(b,d)}).then(function(){var a=[];if(arguments[0]){a=Array.prototype.slice.call(arguments)}f(a)}).catch(g)}}});
define ("mod_capquiz/attempt",["jquery","core/str"],function(a,b){function c(b,c){var d=a(".capquiz-star-tooltip");d.html(c);d.css("display","block");var e=b.offset().left-d.width()/2,f=b.offset().top+32;d.css("left",e+"px");d.css("top",f+"px")}function d(){a(".capquiz-star-tooltip").css("display","none")}function e(){a(document).on("mouseover",".capquiz-quiz-stars span",function(){var d=a(this);if(d.hasClass("capquiz-star")){a.when(b.get_string("tooltip_achieved_star","capquiz")).done(function(a){c(d,a)})}else if(d.hasClass("capquiz-lost-star")){a.when(b.get_string("tooltip_lost_star","capquiz")).done(function(a){c(d,a)})}else if(d.hasClass("capquiz-no-star")){a.when(b.get_string("tooltip_no_star","capquiz")).done(function(a){c(d,a)})}else if(d.hasClass("capquiz-help-stars")){a.when(b.get_string("tooltip_help_star","capquiz")).done(function(a){c(d,a)})}});a(document).on("mouseleave",".capquiz-quiz-stars span",function(){d()})}return{initialize:function initialize(){e()}}});
define ("mod_capquiz/edit_questions",["jquery"],function(a){var m={courseModuleId:0};function b(b,c,d){a.ajax({type:"post",url:"action.php",data:b,success:c,error:d})}function c(a,c,d,e){b({action:"set-default-question-rating",id:m.courseModuleId,rating:c},d,e)}function d(a,c,d,e){b({action:"set-question-rating",id:m.courseModuleId,"question-id":a.questionId,rating:c},d,e)}function e(a,b,c){a.data("saving",!0);a.data("dirty",!1);var d=a.next();d.css("color","blue");b(c,a.val(),function(){if(!0===a.data("dirty")){e(a,b,c)}else{d.css("color","green");a.data("dirty",!1);a.data("saving",!1)}},function(){d.css("color","red")})}function f(a){e(a,d,{questionId:a.data("question-id")})}function g(a){e(a,c,null)}function h(b,c){a(document).on("input",b,function(b){var d=a(b.target),e=d.data("saving");if(!0===e){d.data("dirty",!0);return}c(d)})}function i(b){var c=b.index(),d=b.parent().parent(),e=d.find("tr:gt(0)").toArray().sort(function(b,c){var d=a(b).children("td").eq(0),e=a(c).children("td").eq(0);return parseInt(d.text())-parseInt(e.text())});d.append(e);e=d.find("tr:gt(0)").toArray().sort(function(b,d){var e=a(b).children("td").eq(c),f=a(d).children("td").eq(c),g=e.find(".capquiz-sortable-item"),h=f.find(".capquiz-sortable-item"),i=0===g.length?e.html():0===g.val().length?g.html():g.val(),j=0===h.length?f.html():0===h.val().length?h.html():h.val();if(a.isNumeric(i)&&a.isNumeric(j)){return i-j}else{return i.toString().localeCompare(j)}});var f="true"===d.data("asc");d.data("asc",f?"false":"true");var g=f?"fa-arrow-up":"fa-arrow-down";a.each(d.find(".capquiz-sortable"),function(){a(this).find(".fa").remove()});b.prepend("<i class=\"fa "+g+"\"></i>");if(!f){e=e.reverse()}d.append(e);var h=1;d.find("tr:gt(0)").each(function(){a(this).find("td:first-child").html(h);h++})}function j(){a(document).on("click",".capquiz-sortable",function(){i(a(this))});a(".capquiz-sortable-default-asc").each(function(){i(a(this));i(a(this))});a(".capquiz-sortable-default-desc").each(function(){i(a(this))})}function k(){a(".capquiz-question-rating-submit-wrapper button").each(function(b,c){a(c).attr("tabindex",-1)})}function l(){a(".capquiz-add-selected-questions").on("click",function(){var b="";a("#categoryquestions td input[type=checkbox]:checked").each(function(){b+=a(this).attr("name").slice(1)+","});a.post("action.php",{action:"add-question",id:m.courseModuleId,"question-id":b},function(){location.reload()})})}return{initialize:function initialize(a){m.courseModuleId=a;h(".capquiz-question-rating input",f);h(".capquiz-default-question-rating input",g);k();j();l()}}});
define ("mod_econtents/management",["jquery","jqueryui","theme_coursemos/bootstrap"],function(a){var b={moduleurl:M.cfg.wwwroot+"/mod/econtents"};b.actionurl=b.moduleurl+"/action.php";b.containerid="econtents_container";b.mform=function(){b.modal();a("#id_selectcontentbtn").click(function(){b.list()});a("#id_add_grade_item").change(function(){if(1==a(this).val()){a("#id_autograde").val(1)}else{a("#id_autograde").val(0)}})};b.list=function(){a("#"+b.containerid).modal("show");a("#"+b.containerid+" .modal-body").load(b.moduleurl+"/_list.php")};b.modal=function(){if(0==a("#"+b.containerid).length){var c=a("<div id=\""+b.containerid+"\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\"></div>"),d=a("<div class=\"modal-dialog modal-xl\" role=\"document\"></div>"),e=a("<div class=\"modal-content\"></div>"),f=a("<div id=\"econtents-hd\" class=\"modal-header\"></div>");f.append("<h5 class=\"modal-title\" id=\"myModalLabel\">"+M.util.get_string("select","econtents")+"</h5>");f.append("<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>");var g=a("<div id=\"econtents-bd\" class=\"modal-body\">Loading...</div>");e.append(f).append(g);d.append(e);c.append(d);a("body").append(c)}};b.modalMove=function(c){a("#"+b.containerid).modal("show");a("#"+b.containerid+" .modal-body").load(c)};b.modalHide=function(){a("#"+b.containerid).modal("hide")};return b});
define ("mod_econtents/progress",["jquery","theme_coursemos/bootstrap"],function(a){var b={isLogin:!0,isProgress:!0,attempt:0,progressTagID:null,actionurl:M.cfg.wwwroot+"/mod/econtents/action.php"};b.progress=function(c,d,e,f,g,h,i,j,k){b.isProgress=0!=c?!0:!1;b.attempt=d;var l=0;a("#viewer .viewer-header .btn-close").click(function(){setTimeout(function(){self.close()},500)});setInterval(function(){l+=1},1e3);setInterval(function(){b.ajax(f,g,"8",l,l)},h);setTimeout(function(){b.ajax(f,g,1,0,0)},500);if(b.isProgress){a(window).bind("beforeunload",function(a){b.ajax(f,g,"99",l,l);var c=M.util.get_string("track_window_close","econtents");(a||window.event).returnValue=c;return c});if(!e){b.alertMessage("alert-danger",M.util.get_string("no_progress_period","econtents"))}else{b.alertMessage("alert-info",M.util.get_string("window_close_message","econtents"))}if(!i){b.alertMessage("alert-danger",M.util.get_string("error_study_end","local_ubonattend"))}}if(""!=j&&null!==j){require.config({enforceDefine:!1,paths:{externalLearningChecker:j}});require(["externalLearningChecker"],function(a){a.init(k,null)})}};b.alertMessage=function(b,c,d){d="undefined"!=typeof d?d:5e3;var e=null;if(0<a(".viewer-content .alert-message").length){e=parseInt(a(".viewer-content .alert-message:last-child").css("top"))+parseInt(a(".viewer-content .alert-message:last-child").outerHeight())+10}var f=a("<div class=\"alert alert-message\"></div>");if(null!==e){f.css("top",e)}f.addClass(b).html(c);a(".viewer-content").append(f);f.show();var g=setTimeout(function(){f.remove()},d);f.click(function(){a(this).remove();clearTimeout(g)})};b.ajax=function(c,d,e,f,g){if(0<d&&b.isLogin&&b.isProgress){var h={courseid:c,cmid:d,sesskey:M.cfg.sesskey,attempt:b.attempt,state:e,positionfrom:f,positionto:g};h[coursemostype]="trackDetail";a.ajax({url:b.actionurl,data:h,cache:!1,global:!1,type:"post",success:function success(a){if(a.code==mesg.failure){alert(a.msg);return!1}else if(a.code==mesg.failureNotLogin){alert(a.msg);if(opener){self.close();opener.document.replace(opener.document.location.href)}else{location.replace(location.href)}}return!0},error:function error(a,b){if(a.responseText){alert(b+" : "+a.responseText)}}})}};return b});
define ("mod_feedback/edit",["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){var e={deleteItem:function deleteItem(b){b.preventDefault();var e=a(b.currentTarget).attr("href");c.get_strings([{key:"confirmation",component:"admin"},{key:"confirmdeleteitem",component:"mod_feedback"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).then(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){window.location=e})}).catch()},setup:function setup(){a("body").delegate("[data-action=\"delete\"]","click",e.deleteItem)}};return{setup:e.setup}});
define ("mod_forum/grades/grader/selectors",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;a.default={launch:"[data-grade-action=\"launch\"]",gradableItem:"[data-gradable-itemtype]",gradableItems:{wholeForum:"[data-gradable-itemtype=\"forum\"]"},expandConversation:"[data-action=\"view-context\"]",posts:"[data-region=\"posts\"]",viewGrade:"[data-grade-action=\"view\"]"};return a.default});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("mod_forum/grades/expandconversation",["exports","./grader/selectors","mod_forum/repository","core/notification","core/templates","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f,g){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.registerEventListeners=void 0;b=j(b);c=h(c);e=h(e);f=j(f);g=j(g);function h(a){return a&&a.__esModule?a:{default:a}}function i(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;i=function(){return a};return a}function j(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=i();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function k(a,b){return r(a)||q(a,b)||m(a,b)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(a,b){if(!a)return;if("string"==typeof a)return p(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return p(a,b)}function p(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function q(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function r(a){if(Array.isArray(a))return a}function s(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function t(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){s(h,d,e,f,g,"next",a)}function g(a){s(h,d,e,f,g,"throw",a)}f(void 0)})}}var u=function(a){return a.closest(b.expandConversation)},v=function(){var a=t(regeneratorRuntime.mark(function a(b){var d,h,i,j,l,m,n,o,p,q,r,s,t,u,v=arguments;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:d=1<v.length&&v[1]!==void 0?v[1]:{},h=d.focusOnClose,i=void 0===h?null:h;j=b.dataset.postid;l=b.dataset.discussionid;m=b.dataset.name;n="1"==b.dataset.experimentalDisplayMode;a.next=7;return Promise.all([c.default.getDiscussionPosts(parseInt(l)),f.create({title:m,large:!0,type:f.types.CANCEL})]);case 7:o=a.sent;p=k(o,2);q=p[0];r=p[1];s=new Map(q.posts.map(function(a){a.readonly=!0;a.hasreplies=!1;a.replies=[];return[a.id,a]}));t=[];q.posts.forEach(function(a){if(a.parentid){var b=s.get(a.parentid);if(b){a.parentauthorname=b.author.fullname;b.hasreplies=!0;b.replies.push(a)}else{t.push(a)}}else{t.push(a)}});r.getRoot().on(g.hidden,function(){r.destroy();try{i.focus()}catch(a){}});r.getRoot().on(g.bodyRendered,function(){var a=r.getRoot()[0].querySelector("#p".concat(j));if(a){a.scrollIntoView({behavior:"smooth"})}});r.show();u=e.default.render("mod_forum/grades/grader/discussion/post_modal",{posts:t,experimentaldisplaymode:n});r.setBody(u);case 19:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.registerEventListeners=function registerEventListeners(a){a.addEventListener("click",function(a){var b=u(a.target);if(b){a.preventDefault();try{v(b,{focusOnClose:a.target})}catch(a){(0,d.exception)(a)}}})}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("mod_forum/grades/grader",["exports","./grader/selectors","mod_forum/repository","core/templates","../local/grades/grader","core/notification","core_course/repository","core/url"],function(a,b,c,d,e,f,g,h){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.registerLaunchListeners=void 0;b=k(b);c=i(c);d=i(d);e=k(e);f=i(f);g=i(g);function i(a){return a&&a.__esModule?a:{default:a}}function j(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;j=function(){return a};return a}function k(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=j();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function l(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function m(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){l(Object(c),!0).forEach(function(b){n(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{l(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function n(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function o(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function p(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){o(h,d,e,f,g,"next",a)}function g(a){o(h,d,e,f,g,"throw",a)}f(void 0)})}}var q={contentRegion:"mod_forum/grades/grader/discussion/posts"},r=function(a,b){return function(e){return c.default.getDiscussionByUserID(e,a).then(function(a){a.discussions=a.discussions.map(u);a.experimentaldisplaymode=b?!0:!1;return d.default.render(q.contentRegion,a)}).catch(f.default.exception)}},s=function(a,b){return p(regeneratorRuntime.mark(function c(){var d;return regeneratorRuntime.wrap(function(c){while(1){switch(c.prev=c.next){case 0:c.next=2;return g.default.getUsersFromCourseModuleID(a,b);case 2:d=c.sent;return c.abrupt("return",d.users);case 4:case"end":return c.stop();}}},c)}))},t=function(a){return a.closest(b.gradableItem)},u=function(a){var b=new Map;a.posts.parentposts.forEach(function(a){return b.set(a.id,a)});var c=a.posts.userposts.map(function(a){a.readonly=!0;a.hasreplies=!1;a.replies=[];var c=a.parentid?b.get(a.parentid):null;if(c){c.hasreplies=!1;c.replies=[];c.readonly=!0;a.parentauthorname=c.author.fullname}return{parent:c,post:a}});return m({},a,{posts:c})},v=function(){var a=p(regeneratorRuntime.mark(function a(b){var c,d,f,g,i,j,k=arguments;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:c=1<k.length&&k[1]!==void 0?k[1]:{},d=c.focusOnClose,f=void 0===d?null:d;g=b.dataset;a.next=4;return e.getGradingPanelFunctions("mod_forum",g.contextid,g.gradingComponent,g.gradingComponentSubtype,g.gradableItemtype);case 4:i=a.sent;j=g.group?g.group:0;a.next=8;return e.launch(s(g.cmid,j),r(g.cmid,"1"==g.experimentalDisplayMode),i.getter,i.setter,{groupid:g.groupid,initialUserId:g.initialuserid,moduleName:g.name,courseName:g.courseName,courseUrl:(0,h.relativeUrl)("/course/view.php",{id:g.courseId}),sendStudentNotifications:g.sendStudentNotifications,focusOnClose:f});case 8:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),w=function(){var a=p(regeneratorRuntime.mark(function a(b){var c,d,f,g,h,i=arguments;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:c=1<i.length&&i[1]!==void 0?i[1]:{},d=c.focusOnClose,f=void 0===d?null:d;g=b.dataset;a.next=4;return e.getGradingPanelFunctions("mod_forum",g.contextid,g.gradingComponent,g.gradingComponentSubtype,g.gradableItemtype);case 4:h=a.sent;a.next=7;return e.view(h.getter,g.userid,g.name,{focusOnClose:f});case 7:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.registerLaunchListeners=function registerLaunchListeners(){document.addEventListener("click",function(){var a=p(regeneratorRuntime.mark(function a(c){var d,e;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:if(!c.target.matches(b.launch)){a.next=17;break}d=t(c.target);if(d){a.next=4;break}throw Error("Unable to find a gradable item");case 4:if(!d.matches(b.gradableItems.wholeForum)){a.next=16;break}c.preventDefault();a.prev=6;a.next=9;return v(d,{focusOnClose:c.target});case 9:a.next=14;break;case 11:a.prev=11;a.t0=a["catch"](6);f.default.exception(a.t0);case 14:a.next=17;break;case 16:throw Error("Unable to find a valid gradable item");case 17:if(!c.target.matches(b.viewGrade)){a.next=35;break}c.preventDefault();e=t(c.target);if(e){a.next=22;break}throw Error("Unable to find a gradable item");case 22:if(!e.matches(b.gradableItems.wholeForum)){a.next=34;break}c.preventDefault();a.prev=24;a.next=27;return w(e,{focusOnClose:c.target});case 27:a.next=32;break;case 29:a.prev=29;a.t1=a["catch"](24);f.default.exception(a.t1);case 32:a.next=35;break;case 34:throw Error("Unable to find a valid gradable item");case 35:case"end":return a.stop();}}},a,null,[[6,11],[24,29]])}));return function(){return a.apply(this,arguments)}}())}});
define ("mod_forum/local/grades/local/grader/user_picker/selectors",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;a.default={regions:{currentUser:"[data-region=\"user_picker/current_user\"]",userRegion:"[data-region=\"user_picker/user\"]"},actions:{changeUser:"[data-action=\"change-user\"]"}};return a.default});
define ("mod_forum/local/grades/local/grader/gradingpanel",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var d="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};function b(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function c(a){return function(){var c=this,d=arguments;return new Promise(function(e,f){var i=a.apply(c,d);function g(a){b(i,e,f,g,h,"next",a)}function h(a){b(i,e,f,g,h,"throw",a)}g(void 0)})}}var e=function(){var a=c(regeneratorRuntime.mark(function a(b,c,e,f,g){var h,i;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:h="".concat(e,"/grades/grader/gradingpanel");if(f){h+="/".concat(f)}a.next=4;return"function"==typeof d.define&&d.define.amd?new Promise(function(a,b){d.require([h],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&d.require&&"component"===d.require.loader?Promise.resolve(require((h))):Promise.resolve(d[h]);case 4:i=a.sent;return a.abrupt("return",{getter:function(a){return i.fetchCurrentGrade(b,c,g,a)},setter:function(a,d,e){return i.storeCurrentGrade(b,c,g,a,d,e)}});case 6:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.default=e;return a.default});
define ("mod_forum/local/grades/local/grader/selectors",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var b=function(a,b){return"[data-".concat(a,"=\"").concat(b,"\"]")},c={buttons:{toggleFullscreen:b("action","togglefullscreen"),closeGrader:b("action","closegrader"),collapseGradingDrawer:b("action","collapse-grading-drawer"),saveGrade:b("action","savegrade"),selectUser:b("action","select-user"),toggleSearch:b("action","toggle-search")},regions:{bodyContainer:b("region","body-container"),moduleContainer:b("region","module_content_container"),moduleReplace:b("region","module_content"),pickerRegion:b("region","user_picker"),gradingInfoContainer:b("region","grading-info-container"),gradingPanel:b("region","grade"),gradingPanelContainer:b("region","grading-panel-container"),gradingPanelErrors:b("region","grade-errors"),searchResultsContainer:b("region","search-results-container"),statusContainer:b("region","status-container"),userSearchContainer:b("region","user-search-container"),userSearchInput:b("region","user-search-input")},values:{sendStudentNotifications:"[data-region=\"notification\"] input[type=\"radio\"]:checked"}};a.default=c;return a.default});
define ("mod_forum/local/grades/local/grader/user_picker",["exports","core/templates","./user_picker/selectors","core/str"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=e(b);c=e(c);function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function g(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){f(Object(c),!0).forEach(function(b){h(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{f(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function h(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function i(a,b){return n(a)||m(a,b)||k(a,b)||j()}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(a,b){if(!a)return;if("string"==typeof a)return l(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return l(a,b)}function l(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function m(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function n(a){if(Array.isArray(a))return a}function o(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function p(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){o(h,d,e,f,g,"next",a)}function g(a){o(h,d,e,f,g,"throw",a)}f(void 0)})}}function q(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function r(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function s(a,b,c){if(b)r(a.prototype,b);if(c)r(a,c);return a}var t=function(){function a(b,c,d){q(this,a);this.userList=b;this.showUserCallback=c;this.preChangeUserCallback=d;this.currentUserIndex=0;this.render=this.render.bind(this);this.setUserId=this.setUserId.bind(this)}s(a,[{key:"setUserId",value:function setUserId(a){var b=this.userList.findIndex(function(b){return b.id===parseInt(a)});if(-1===b){throw Error("User with id ".concat(a," not found"))}this.currentUserIndex=b}},{key:"render",value:function(){var a=p(regeneratorRuntime.mark(function a(){var c,d,e;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:this.root=document.createElement("div");a.next=3;return this.renderNavigator();case 3:c=a.sent;d=c.html;e=c.js;b.default.replaceNodeContents(this.root,d,e);a.next=9;return this.showUser(this.currentUser);case 9:this.registerEventListeners();case 10:case"end":return a.stop();}}},a,this)}));return function render(){return a.apply(this,arguments)}}()},{key:"renderNavigator",value:function renderNavigator(){return b.default.renderForPromise("".concat("mod_forum/local/grades/local/grader","/user_picker"),{})}},{key:"renderUserChange",value:function renderUserChange(a){return b.default.renderForPromise("".concat("mod_forum/local/grades/local/grader","/user_picker/user"),a)}},{key:"showUser",value:function(){var a=p(regeneratorRuntime.mark(function a(e){var f,g,h,j,k,l,m;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:a.next=2;return Promise.all([this.renderUserChange(e),this.showUserCallback(e)]);case 2:f=a.sent;g=i(f,1);h=g[0];j=h.html;k=h.js;l=this.root.querySelector(c.default.regions.userRegion);b.default.replaceNodeContents(l,j,k);m=this.root.querySelector(c.default.regions.currentUser);a.next=12;return(0,d.get_string)("nowgradinguser","mod_forum",e.fullname);case 12:m.textContent=a.sent;case 13:case"end":return a.stop();}}},a,this)}));return function showUser(){return a.apply(this,arguments)}}()},{key:"registerEventListeners",value:function registerEventListeners(){var a=this;this.root.addEventListener("click",function(){var b=p(regeneratorRuntime.mark(function b(d){var e,f;return regeneratorRuntime.wrap(function(b){while(1){switch(b.prev=b.next){case 0:e=d.target.closest(c.default.actions.changeUser);if(!e){b.next=9;break}b.next=4;return a.preChangeUserCallback(a.currentUser);case 4:f=b.sent;if(f.failed){b.next=9;break}a.updateIndex(parseInt(e.dataset.direction));b.next=9;return a.showUser(a.currentUser);case 9:case"end":return b.stop();}}},b)}));return function(){return b.apply(this,arguments)}}())}},{key:"updateIndex",value:function updateIndex(a){this.currentUserIndex+=a;if(0>this.currentUserIndex){this.currentUserIndex=this.userList.length-1}else if(this.currentUserIndex>this.userList.length-1){this.currentUserIndex=0}return this.currentUserIndex}},{key:"currentUser",get:function get(){return g({},this.userList[this.currentUserIndex],{total:this.userList.length,displayIndex:this.currentUserIndex+1})}},{key:"rootNode",get:function get(){return this.root}}]);return a}(),u=function(){var a=p(regeneratorRuntime.mark(function a(b,c,d){var e,f,g,h,i=arguments;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:e=3<i.length&&i[3]!==void 0?i[3]:{},f=e.initialUserId,g=void 0===f?null:f;h=new t(b,c,d);if(g){h.setUserId(g)}a.next=5;return h.render();case 5:return a.abrupt("return",h);case 6:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.default=u;return a.default});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("mod_forum/local/grades/grader",["exports","core/templates","./local/grader/selectors","./local/grader/user_picker","mod_forum/local/layout/fullscreen","./local/grader/gradingpanel","core/toast","core/notification","core/str","core_grades/grades/grader/gradingpanel/normalise","core/loadingicon","core/utils","core_grades/grades/grader/gradingpanel/comparison","core/modal_factory","core/modal_events","core/pubsub","core/drawer_events"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"getGradingPanelFunctions",{enumerable:!0,get:function get(){return f.default}});a.view=a.launch=void 0;b=t(b);c=t(c);d=t(d);f=t(f);n=s(n);o=s(o);q=t(q);function r(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;r=function(){return a};return a}function s(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=r();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function t(a){return a&&a.__esModule?a:{default:a}}function u(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function v(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){u(Object(c),!0).forEach(function(b){w(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{u(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function w(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function x(a,b){return C(a)||B(a,b)||z(a,b)||y()}function y(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function z(a,b){if(!a)return;if("string"==typeof a)return A(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return A(a,b)}function A(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function B(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function C(a){if(Array.isArray(a))return a}function D(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function E(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){D(h,d,e,f,g,"next",a)}function g(a){D(h,d,e,f,g,"throw",a)}f(void 0)})}}var F={grader:{app:"mod_forum/local/grades/grader",gradingPanel:{error:"mod_forum/local/grades/local/grader/gradingpanel/error"},searchResults:"mod_forum/local/grades/local/grader/user_picker/user_search",status:"mod_forum/local/grades/local/grader/status"}},G=function(a,d){var e=a.querySelector(c.default.regions.pickerRegion);b.default.replaceNodeContents(e,d,"")},H=function(a,b){return[a,b]},I=function(a,d,e,f){var g=!0;return function(){var h=E(regeneratorRuntime.mark(function h(i){var j,l,n,o,p,q,r,s,t,u,v,w,y,z;return regeneratorRuntime.wrap(function(h){while(1){switch(h.prev=h.next){case 0:j=g?null:(0,k.addIconToContainerWithPromise)(a);h.next=3;return Promise.all([d(i.id).then(H),e(i.id)]);case 3:l=h.sent;n=x(l,2);o=x(n[0],2);p=o[0];q=o[1];r=n[1];b.default.replaceNodeContents(a.querySelector(c.default.regions.moduleReplace),p,q);h.next=12;return b.default.render(r.templatename,r.grade).then(H);case 12:s=h.sent;t=x(s,2);u=t[0];v=t[1];w=a.querySelector(c.default.regions.gradingPanelContainer);y=w.querySelector(c.default.regions.gradingPanel);b.default.replaceNodeContents(y,u,v);z=y.querySelector("form");(0,m.fillInitialValues)(z);z.addEventListener("submit",function(a){f(i);a.preventDefault()});w.scrollTop=0;g=!1;if(j){j.resolve()}return h.abrupt("return",r);case 26:case"end":return h.stop();}}},h)}));return function(){return h.apply(this,arguments)}}()},J=function(a,b,c){a.classList.add("hidden");b.classList.add("hidden");c.classList.remove("hidden")},K=function(a,b,c){a.classList.remove("hidden");b.classList.remove("hidden");c.classList.add("hidden")},L=function(a,b,d){b.classList.remove("collapsed");a.setAttribute("aria-expanded","true");a.classList.add("expand");a.classList.remove("collapse");var e=b.parentElement.querySelector(c.default.regions.gradingInfoContainer);e.setAttribute("aria-hidden","true");var f=b.parentElement.querySelector(c.default.buttons.collapseGradingDrawer);f.setAttribute("aria-hidden","true");f.setAttribute("tabindex","-1");d.focus()},M=function(a,b,d){b.classList.add("collapsed");a.setAttribute("aria-expanded","false");a.classList.add("collapse");a.classList.remove("expand");a.focus();var e=b.parentElement.querySelector(c.default.regions.gradingInfoContainer);e.removeAttribute("aria-hidden");var f=b.parentElement.querySelector(c.default.buttons.collapseGradingDrawer);f.removeAttribute("aria-hidden");f.setAttribute("tabindex","0");d.value=""},N=function(a,b){if(""===b){return a}b=b.toLowerCase();return a.filter(function(a){return a.fullname.toLowerCase().includes(b)})},O=function(){var a=E(regeneratorRuntime.mark(function a(c,d){var e,f,g;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:a.next=2;return b.default.renderForPromise(F.grader.searchResults,{users:d});case 2:e=a.sent;f=e.html;g=e.js;b.default.replaceNodeContents(c,f,g);case 6:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),P=function(a,b,d,e){var f=a.getContainer(),g=f.querySelector(c.default.buttons.toggleSearch),h=f.querySelector(c.default.regions.userSearchContainer),i=h.querySelector(c.default.regions.userSearchInput),j=f.querySelector(c.default.regions.bodyContainer),k=f.querySelector(c.default.regions.pickerRegion),m=f.querySelector(c.default.regions.searchResultsContainer);f.addEventListener("click",function(f){if(f.target.closest(c.default.buttons.toggleFullscreen)){f.stopImmediatePropagation();f.preventDefault();a.toggleFullscreen();return}if(f.target.closest(c.default.buttons.closeGrader)){f.stopImmediatePropagation();f.preventDefault();a.close();return}if(f.target.closest(c.default.buttons.saveGrade)){d(b.currentUser)}if(f.target.closest(c.default.buttons.toggleSearch)){if("true"===g.getAttribute("aria-expanded")){M(g,h,i);K(j,k,m);m.innerHTML=""}else{L(g,h,i);J(j,k,m);O(m,e)}return}var l=f.target.closest(c.default.buttons.selectUser);if(l){var n=l.getAttribute("data-userid"),o=e.find(function(a){return a.id==n});b.setUserId(n);b.showUser(o);M(g,h,i);K(j,k,m);m.innerHTML=""}});i.addEventListener("input",(0,l.debounce)(function(){var a=N(e,i.value);O(m,a)},300));(0,p.subscribe)(q.default.DRAWER_HIDDEN,function(a){var b=a[0];if(b.querySelector(c.default.regions.gradingPanel)){Q(f,0)}});(0,p.subscribe)(q.default.DRAWER_SHOWN,function(a){var b=a[0];if(b.querySelector(c.default.regions.gradingPanel)){Q(f,b.offsetWidth)}})},Q=function(a,b){var d=a.querySelector(c.default.regions.moduleContainer);if(d){d.style.marginRight="".concat(b,"px")}},R=function(a,b){return function(){var d=E(regeneratorRuntime.mark(function d(e){var f;return regeneratorRuntime.wrap(function(d){while(1){switch(d.prev=d.next){case 0:d.prev=0;a.querySelector(c.default.regions.gradingPanelErrors).innerHTML="";d.next=4;return b(e.id,a.querySelector(c.default.values.sendStudentNotifications).value,a.querySelector(c.default.regions.gradingPanel));case 4:f=d.sent;if(!f.success){d.next=11;break}d.t0=g.add;d.next=9;return(0,i.get_string)("grades:gradesavedfor","mod_forum",e);case 9:d.t1=d.sent;(0,d.t0)(d.t1);case 11:if(f.failed){S(a,e,f.error)}return d.abrupt("return",f);case 15:d.prev=15;d.t2=d["catch"](0);S(a,e,d.t2);return d.abrupt("return",(0,j.failedUpdate)(d.t2));case 19:case"end":return d.stop();}}},d,null,[[0,15]])}));return function(){return d.apply(this,arguments)}}()},S=function(){var a=E(regeneratorRuntime.mark(function a(d,e,f){var h,j,k,l,m,n;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:a.t0=Promise;a.t1=b.default.renderForPromise(F.grader.gradingPanel.error,{error:f});a.next=4;return(0,i.get_string)("grades:gradesavefailed","mod_forum",v({error:f.message},e));case 4:a.t2=a.sent;a.t3=[a.t1,a.t2];a.next=8;return a.t0.all.call(a.t0,a.t3);case 8:h=a.sent;j=x(h,2);k=j[0];l=k.html;m=k.js;n=j[1];b.default.replaceNodeContents(d.querySelector(c.default.regions.gradingPanelErrors),l,m);(0,g.add)(n);case 16:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),T=function(){var a=E(regeneratorRuntime.mark(function a(f,g,j,k){var l,m,n,o,p,q,r,s,t,u,v,w,y,z,A,B,C,D,H,J,K,L,M=arguments;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:l=4<M.length&&M[4]!==void 0?M[4]:{},m=l.initialUserId,n=void 0===m?null:m,o=l.moduleName,p=l.courseName,q=l.courseUrl,r=l.sendStudentNotifications,s=l.focusOnClose,t=void 0===s?null:s;a.next=3;return f();case 3:u=a.sent;if(u.length){a.next=12;break}a.t0=h.addNotification;a.next=8;return(0,i.get_string)("nouserstograde","core_grades");case 8:a.t1=a.sent;a.t2={message:a.t1,type:"error"};(0,a.t0)(a.t2);return a.abrupt("return");case 12:a.next=14;return Promise.all([(0,e.createLayout)({fullscreen:!1,showLoader:!1,focusOnClose:t}),b.default.renderForPromise(F.grader.app,{moduleName:o,courseName:p,courseUrl:q,drawer:{show:!0},defaultsendnotifications:r})]);case 14:v=a.sent;w=x(v,2);y=w[0];z=w[1];A=z.html;B=z.js;C=y.getContainer();D=R(C,k);b.default.replaceNodeContents(C,A,B);H=I(C,g,j,D);J=u.map(function(a){return a.id});K=C.querySelector(c.default.regions.statusContainer);a.next=28;return(0,d.default)(u,function(){var a=E(regeneratorRuntime.mark(function a(c){var d,e;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:a.next=2;return H(c);case 2:d=a.sent;e={status:d.hasgrade,index:J.indexOf(c.id)+1,total:u.length};b.default.render(F.grader.status,e).then(function(a){K.innerHTML=a;return a}).catch();case 5:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),D,{initialUserId:n});case 28:L=a.sent;P(y,L,D,u);G(C,L.rootNode);case 31:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.launch=T;var U=function(){var a=E(regeneratorRuntime.mark(function a(c,d,e){var f,g,h,i,j,l,m,p,q,r,s,t,u,v,w,y,z,A=arguments;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:f=3<A.length&&A[3]!==void 0?A[3]:{},g=f.focusOnClose,h=void 0===g?null:g;a.next=3;return Promise.all([c(d),n.create({title:e,large:!0,type:n.types.CANCEL})]);case 3:i=a.sent;j=x(i,2);l=j[0];m=j[1];p=(0,k.addIconToContainerWithPromise)(m.getRoot());m.getRoot().on(o.hidden,function(){m.destroy();if(h){try{h.focus()}catch(a){}}});m.show();q=document.createElement("div");a.next=13;return b.default.renderForPromise("mod_forum/local/grades/view_grade",l);case 13:r=a.sent;s=r.html;t=r.js;b.default.replaceNodeContents(q,s,t);a.next=19;return V(l);case 19:u=a.sent;v=x(u,2);w=v[0];y=v[1];z=q.querySelector("[data-region=\"grade-template\"]");b.default.replaceNodeContents(z,w,y);m.setBody(q.outerHTML);p.resolve();case 27:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.view=U;var V=function(){var a=E(regeneratorRuntime.mark(function a(c){var d,e,f;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:a.next=2;return b.default.renderForPromise(c.templatename,c.grade);case 2:d=a.sent;e=d.html;f=d.js;return a.abrupt("return",[e,f]);case 6:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}()});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("mod_forum/local/layout/fullscreen",["exports","core/loadingicon","core/toast","core/local/aria/focuslock"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.createLayout=void 0;d=f(d);function e(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;e=function(){return a};return a}function f(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=e();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a){if(Object.prototype.hasOwnProperty.call(a,f)){var g=d?Object.getOwnPropertyDescriptor(a,f):null;if(g&&(g.get||g.set)){Object.defineProperty(c,f,g)}else{c[f]=a[f]}}}c.default=a;if(b){b.set(a,c)}return c}var g=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},b=a.fullscreen,e=void 0===b?!0:b,f=a.showLoader,g=void 0===f?!1:f,j=a.focusOnClose,k=void 0===j?null:j,l=document.createElement("div");document.body.append(l);l.classList.add("layout");l.classList.add("fullscreen");l.setAttribute("role","application");(0,c.addToastRegion)(l);i();d.trapFocus(l);var m=h(l,d,k);if(g){m.showLoadingIcon()}if(e){m.requestFullscreen()}return m},h=function(a,c,d){var e=document.createElement("div");a.append(e);var f=document.createElement("div");a.append(f);var g=function(){if(a.requestFullscreen){a.requestFullscreen()}else if(a.msRequestFullscreen){a.msRequestFullscreen()}else if(a.mozRequestFullscreen){a.mozRequestFullscreen()}else if(a.webkitRequestFullscreen){a.webkitRequestFullscreen()}else{a.setTop(0)}},h=function(){if(document.exitRequestFullScreen){if(document.fullScreenElement!==a){return}document.exitRequestFullScreen()}else if(document.msExitFullscreen){if(document.msFullscreenElement!==a){return}document.msExitFullscreen()}else if(document.mozCancelFullScreen){if(document.mozFullScreenElement!==a){return}document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){if(document.webkitFullscreenElement!==a){return}document.webkitExitFullscreen()}},i=function(){var a=f.lastElementChild;while(a){f.removeChild(a);a=f.lastElementChild}};return{close:function close(){h();j();c.untrapFocus();a.remove();if(d){try{d.focus()}catch(a){}}},toggleFullscreen:function toggleFullscreen(){if(document.exitRequestFullScreen){if(document.fullScreenElement===a){h()}else{g()}}else if(document.msExitFullscreen){if(document.msFullscreenElement===a){h()}else{g()}}else if(document.mozCancelFullScreen){if(document.mozFullScreenElement===a){h()}else{g()}}else if(document.webkitExitFullscreen){if(document.webkitFullscreenElement===a){h()}else{g()}}},requestFullscreen:g,exitFullscreen:h,getContainer:function getContainer(){return e},setContent:function setContent(a){i();var b=e.lastElementChild;while(b){e.removeChild(b);b=e.lastElementChild}e.append(a)},showLoadingIcon:function showLoadingIcon(){(0,b.addIconToContainer)(f)},hideLoadingIcon:i}},i=function(){document.querySelector("body").classList.add("overflow-hidden")},j=function(){document.querySelector("body").classList.remove("overflow-hidden")};a.createLayout=g});
define ("mod_forum/local/layouts",["exports","./layout/fullscreen"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"createFullScreenWindow",{enumerable:!0,get:function get(){return b.createLayout}})});
define ("mod_forum/discussion",["jquery","core/custom_interaction_events","mod_forum/selectors","core/pubsub","mod_forum/forum_events","core/str","core/notification"],function(a,b,c,d,e,f,g){var h=function(a){var b=a.prev(c.post.post);if(b.length){var d=b.find(c.post.post).last();if(d.length){d.focus()}else{b.focus()}}else{a.parents(c.post.post).first().focus()}},i=function(b){var d=b.find(c.post.post).first();if(d.length){d.focus()}else{var e=b.next(c.post.post);if(e.length){e.focus()}else{for(var f=b.parents(c.post.post).toArray(),g=0,h;g<f.length;g++){h=a(f[g]).next(c.post.post);if(h.length){h.focus();break}}}}},j=function(b){var d=a(b).closest(c.post.inpageReplyContent);return d.length?!0:!1},k=function(k){var l=k.find(c.post.post);l.each(function(b,d){var e=a(d).find(c.post.action),f=e.first();e.attr("tabindex","-1");f.attr("tabindex",0)});b.define(k,[b.events.up,b.events.down,b.events.next,b.events.previous,b.events.home,b.events.end]);k.on(b.events.up,function(b,d){var e=document.activeElement;if(j(e)){return}var f=a(e).closest(c.post.post);if(f.length){h(f)}else{k.find(c.post.post).first().focus()}d.originalEvent.preventDefault()});k.on(b.events.down,function(b,d){var e=document.activeElement;if(j(e)){return}var f=a(e).closest(c.post.post);if(f.length){i(f)}else{k.find(c.post.post).first().focus()}d.originalEvent.preventDefault()});k.on(b.events.home,function(a,b){if(j(document.activeElement)){return}k.find(c.post.post).first().focus();b.originalEvent.preventDefault()});k.on(b.events.end,function(a,b){if(j(document.activeElement)){return}k.find(c.post.post).last().focus();b.originalEvent.preventDefault()});k.on(b.events.next,c.post.action,function(b,d){var e=a(b.target),f=e.closest(c.post.actionsContainer),g=f.find(c.post.action),h=e.next(c.post.action);g.attr("tabindex","-1");if(!h.length){h=g.first()}h.attr("tabindex",0);h.focus();d.originalEvent.preventDefault()});k.on(b.events.previous,c.post.action,function(b,d){var e=a(b.target),f=e.closest(c.post.actionsContainer),g=f.find(c.post.action),h=e.prev(c.post.action);g.attr("tabindex","-1");if(!h.length){h=g.last()}h.attr("tabindex",0);h.focus();d.originalEvent.preventDefault()});k.on(b.events.home,c.post.action,function(b,d){var e=a(b.target),f=e.closest(c.post.actionsContainer),g=f.find(c.post.action),h=g.first();g.attr("tabindex","-1");h.attr("tabindex",0);h.focus();b.stopPropagation();d.originalEvent.preventDefault()});k.on(b.events.end,c.post.action,function(b,d){var e=a(b.target),f=e.closest(c.post.actionsContainer),g=f.find(c.post.action),h=g.last();g.attr("tabindex","-1");h.attr("tabindex",0);h.focus();b.stopPropagation();d.originalEvent.preventDefault()});d.subscribe(e.SUBSCRIPTION_TOGGLED,function(a){var b=a.subscriptionState,c=b?"discussionsubscribed":"discussionunsubscribed";f.get_string(c,"forum").then(function(a){return g.addNotification({message:a,type:"info"})}).catch(g.exception)})};return{init:function init(a){k(a)}}});
define ("mod_forum/discussion_list",["jquery","core/templates","core/str","core/notification","mod_forum/subscription_toggle","mod_forum/selectors","mod_forum/repository","core/pubsub","mod_forum/forum_events"],function(a,b,c,d,e,f,g,h,i){var j=function(e){h.subscribe(i.SUBSCRIPTION_TOGGLED,function(a){var b=a.discussionId,c=a.subscriptionState,d=e.find(f.discussion.item+"[data-discussionid= "+b+"]"),g=d.find(f.discussion.subscribedLabel);if(c){d.addClass("subscribed");g.removeAttr("hidden")}else{d.removeClass("subscribed");g.attr("hidden",!0)}});e.on("click",f.favourite.toggle,function(){var b=a(this),c=b.data("forumid"),e=b.data("discussionid"),f=b.data("targetstate");g.setFavouriteDiscussionState(c,e,f).then(function(){return location.reload()}).catch(d.exception)});e.on("click",f.pin.toggle,function(b){b.preventDefault();var c=a(this),e=c.data("forumid"),f=c.data("discussionid"),h=c.data("targetstate");g.setPinDiscussionState(e,f,h).then(function(){return location.reload()}).catch(d.exception)});e.on("click",f.lock.toggle,function(h){var e=a(this),i=e.data("forumid"),j=e.data("discussionid"),k=e.data("state");g.setDiscussionLockState(i,j,k).then(function(a){var b=e.parents(f.summary.actions).find(f.lock.icon),c=e.parents(f.discussion.item).find(f.discussion.lockedLabel);if(a.locked){b.removeClass("hidden");c.removeAttr("hidden")}else{b.addClass("hidden");c.attr("hidden",!0)}return a}).then(function(a){a.forumid=i;return b.render("mod_forum/discussion_lock_toggle",a)}).then(function(a,c){return b.replaceNode(e,a,c)}).then(function(){return c.get_string("lockupdated","forum").done(function(a){return d.addNotification({message:a,type:"info"})})}).catch(d.exception);h.preventDefault()})};return{init:function init(a){e.init(a,!1,function(a,b){var d=a.attr("id"),e=b.userstate.subscribed?0:1;a.data("targetstate",e);var f=b.userstate.subscribed?"unsubscribediscussion":"subscribediscussion";return c.get_string(f,"mod_forum").then(function(b){a.closest("td").find("label[for=\""+d+"\"]").find("span").text(b);return b})});j(a)}}});
define ("mod_forum/discussion_nested_v2",["exports","jquery","core/auto_rows","core/custom_interaction_events","core/notification","core/templates","mod_forum/discussion","mod_forum/inpage_reply","mod_forum/lock_toggle","mod_forum/favourite_toggle","mod_forum/pin_toggle","mod_forum/selectors","mod_forum/subscription_toggle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=n(b);c=n(c);d=n(d);e=n(e);f=n(f);g=n(g);h=n(h);i=n(i);j=n(j);k=n(k);l=n(l);m=n(m);var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};function n(a){return a&&a.__esModule?a:{default:a}}function o(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function p(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){o(Object(c),!0).forEach(function(b){q(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{o(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function q(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function r(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function s(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){r(h,d,e,f,g,"next",a)}function g(a){r(h,d,e,f,g,"throw",a)}f(void 0)})}}var u=function(a){return a.closest(l.default.post.post)},v=function(a,b){return a.find("".concat(l.default.post.post,"[data-post-id=").concat(b,"]"))},w=function(a){return a.parents(l.default.post.post)},x=function(a){return a.children().not(l.default.post.repliesContainer).find(l.default.post.forumCoreContent)},y=function(a){return a.children().filter(l.default.post.inpageReplyContainer)},z=function(a){return y(a).find(l.default.post.inpageReplyContent)},A=function(a){return x(a).find(l.default.post.inpageReplyCreateButton)},B=function(a){return a.children(l.default.post.repliesVisibilityToggleContainer)},C=function(a){return a.children(l.default.post.repliesContainer)},D=function(a){return 0<C(a).children().length},E=function(a){return a.find(l.default.post.showReplies)},F=function(a){return a.find(l.default.post.hideReplies)},G=function(a){var b=C(a);return b.is(":visible")},H=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null,c=C(a),d=B(a),e=E(d),f=F(d);e.addClass("hidden");f.removeClass("hidden");c.slideDown({duration:150,queue:!1,complete:function complete(){if(b){var a=v(c,b);if(a.length){a[0].scrollIntoView()}}}}).css("display","none").fadeIn(150)},I=function(a){var b=C(a),c=B(a),d=E(c),e=F(c);d.removeClass("hidden");e.addClass("hidden");b.slideUp({duration:150,queue:!1}).fadeOut(150)},J=null,K=function(a){return function(){var b=s(regeneratorRuntime.mark(function b(c){var d,g,h,i;return regeneratorRuntime.wrap(function(b){while(1){switch(b.prev=b.next){case 0:d=y(c);g=B(c);h=A(c);if(N(d)){b.next=15;break}b.prev=4;b.next=7;return O(a,h,c);case 7:i=b.sent;f.default.appendNodeContents(d,i,"");b.next=14;break;case 11:b.prev=11;b.t0=b["catch"](4);e.default.exception(b.t0);case 14:("function"==typeof t.define&&t.define.amd?new Promise(function(a,b){t.require(["core/yui"],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&t.require&&"component"===t.require.loader?Promise.resolve(require(("core/yui"))):Promise.resolve(t["core/yui"])).then(function(a){return new Promise(function(b){a.use("moodle-core-formchangechecker",function(a){b(a)})})}).then(function(a){M.core_formchangechecker.init({formid:a.one(c[0].querySelector("form")).generateID()});return a}).catch();case 15:h.fadeOut(150,function(){var a=z(c);a.slideDown({duration:150,queue:!1,complete:function complete(){a.find("textarea").focus()}}).css("display","none").fadeIn(150);if(g.length&&D(c)){g.fadeIn(150);I(c)}});case 16:case"end":return b.stop();}}},b,null,[[4,11]])}));return function(){return b.apply(this,arguments)}}()},L=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null,c=z(a),d=A(a),e=B(a);if(e.length&&D(a)){e.fadeOut(150);if(!G(a)){H(a,b)}}c.slideUp({duration:150,queue:!1,complete:function complete(){d.fadeIn(150)}}).fadeOut(200)},N=function(a){return 0<a.find(l.default.post.inpageReplyContent).length},O=function(a,b,c){var d=x(c),e=d.find(l.default.post.forumSubject).text(),g=d.find(l.default.post.authorName).text(),i=p({postid:c.data("post-id"),reply_url:b.attr("data-href"),sesskey:M.cfg.sesskey,parentsubject:e,parentauthorname:g,canreplyprivately:b.data("can-reply-privately"),postformat:h.default.CONTENT_FORMATS.MOODLE},a);return f.default.render("mod_forum/inpage_reply_v2",i)},P=function(a){B(a).find(l.default.post.replyCount).each(function(a,b){var c=parseInt(b.innerText,10);b.innerText=c+1})},Q=function(a){d.default.define(a,[d.default.events.activate]);c.default.init(a);a.on(d.default.events.activate,l.default.post.inpageReplyCreateButton,function(a,c){c.originalEvent.preventDefault();var d=u((0,b.default)(a.currentTarget));J(d)});a.on(d.default.events.activate,l.default.post.inpageReplyCancelButton,function(a,c){c.originalEvent.preventDefault();var d=u((0,b.default)(a.currentTarget));L(d)});a.on(d.default.events.activate,l.default.post.showReplies,function(a,c){c.originalEvent.preventDefault();var d=u((0,b.default)(a.target));H(d)});a.on(d.default.events.activate,l.default.post.hideReplies,function(a,c){c.originalEvent.preventDefault();var d=u((0,b.default)(a.target));I(d)});a.on(h.default.EVENTS.POST_CREATED,l.default.post.inpageSubmitBtn,function(a,c){var d=(0,b.default)(a.currentTarget),e=u(d),f=w(d);L(e,c);f.each(function(a,c){P((0,b.default)(c))})})},R=function(a,b){J=K(b);Q(a);g.default.init(a);h.default.init(a);var c=a.find(l.default.discussion.tools);i.default.init(c,!1);j.default.init(c,!1,function(a,b){var c=b.userstate.favourited?0:1;return a.data("targetstate",c)});k.default.init(c,!1,function(a,b){var c=b.pinned?0:1;return a.data("targetstate",c)});m.default.init(c,!1,function(a,b){var c=b.userstate.subscribed?0:1;a.data("targetstate",c)})};a.init=R});
define ("mod_forum/favourite_toggle",["jquery","core/templates","core/notification","mod_forum/repository","mod_forum/selectors","core/str"],function(a,b,c,d,e,f){return{init:function registerEventListeners(b,g,h){b.on("click",e.favourite.toggle,function(b){var e=a(this),i=e.data("forumid"),j=e.data("discussionid"),k=e.data("targetstate");d.setFavouriteDiscussionState(i,j,k).then(function(a){return h(e,a)}).then(function(){return f.get_string("favouriteupdated","forum").done(function(a){return c.addNotification({message:a,type:"info"})})}).catch(c.exception);if(g){b.preventDefault()}})}}});
define ("mod_forum/form-user-selector",["jquery","core/ajax","core/templates"],function(a,b,c){return{processResults:function processResults(b,c){var d=[];a.each(c,function(a,b){d.push({value:b.id,label:b._label})});return d},transport:function transport(d,e,f,g){var h,i=a(d).attr("courseid");h=b.call([{methodname:"core_enrol_search_users",args:{courseid:i,search:e,searchanywhere:!0,page:0,perpage:30}}]);h[0].then(function(b){var d=[],e=0;a.each(b,function(a,b){d.push(c.render("mod_forum/form-user-selector-suggestion",b))});return a.when.apply(a.when,d).then(function(){var c=arguments;a.each(b,function(a,b){b._label=c[e];e++});f(b)})}).fail(g)}}});
define ("mod_forum/forum_events",[],function(){return{SUBSCRIPTION_TOGGLED:"mod_forum/subscription_toggle:subscriptionToggled"}});
define ("mod_forum/inpage_reply",["jquery","core/templates","core/notification","mod_forum/repository","mod_forum/selectors"],function(a,b,c,d,f){var g={NESTED_V2:4,THREADED:2,NESTED:3,FLAT_OLDEST_FIRST:1,FLAT_NEWEST_FIRST:-1},h={POST_CREATED:"mod_forum-post-created"},i={MOODLE:0},j=function(a){var b=a.find(f.post.inpageSubmitBtnText),c=a.find(f.post.loadingIconContainer),d=a.outerWidth();a.css("width",d);b.addClass("hidden");c.removeClass("hidden")},k=function(a){var b=a.find(f.post.inpageSubmitBtnText),c=a.find(f.post.loadingIconContainer);a.css("width","");b.removeClass("hidden");c.addClass("hidden")},l=function(l){l.on("click",f.post.inpageSubmitBtn,function(m){m.preventDefault();var e=a(m.currentTarget),n=e.parent().find(f.post.inpageReplyButton),o=e.parents(f.post.inpageReplyForm).get(0),p=o.elements.post.value.trim(),q=i.MOODLE,r=o.elements.reply.value,s=o.elements.subject.value,t=e.closest(f.post.post),u=o.elements.privatereply!=void 0?o.elements.privatereply.checked:!1,v=l.find(f.post.modeSelect),w=v.length?parseInt(v.get(0).value):null,x;if(p.length){j(e);n.prop("disabled",!0);d.addDiscussionPost(r,s,p,q,u,!0).then(function(a){var b=a.messages.reduce(function(a,b){if("success"==b.type){a+="<p>"+b.message+"</p>"}return a},"");c.addNotification({message:b,type:"success"});return a}).then(function(a){o.reset();var c=a.post;x=c.id;switch(w){case g.NESTED_V2:var d=c.capabilities,e=t.children().not(f.post.repliesContainer).find(f.post.authorName).text();c.parentauthorname=e;c.showactionmenu=d.view||d.controlreadstatus||d.edit||d.split||d.delete||d.export||c.urls.viewparent;return b.render("mod_forum/forum_discussion_nested_v2_post_reply",c);case g.THREADED:return b.render("mod_forum/forum_discussion_threaded_post",c);case g.NESTED:return b.render("mod_forum/forum_discussion_nested_post",c);default:return b.render("mod_forum/forum_discussion_post",c);}}).then(function(a,c){var d=t.find(f.post.repliesContainer).first();if(w==g.FLAT_NEWEST_FIRST){return b.prependNodeContents(d,a,c)}else{return b.appendNodeContents(d,a,c)}}).then(function(){e.trigger(h.POST_CREATED,x);k(e);n.prop("disabled",!1);if("undefined"!=typeof M.core_formchangechecker){M.core_formchangechecker.reset_form_dirty_state()}return t.find(f.post.inpageReplyContent).hide()}).then(function(){location.href="#p"+x}).catch(function(a){k(e);n.prop("disabled",!1);return c.exception(a)})}})};return{init:function init(a){l(a)},CONTENT_FORMATS:i,EVENTS:h}});
define ("mod_forum/lock_toggle",["jquery","core/templates","core/notification","mod_forum/repository","mod_forum/selectors"],function(a,b,c,d,e){return{init:function registerEventListeners(b,f){b.on("click",e.lock.toggle,function(b){var e=a(this),g=e.data("forumid"),h=e.data("discussionid"),i=e.data("state");d.setDiscussionLockState(g,h,i).then(function(){return location.reload()}).catch(c.exception);if(f){b.preventDefault()}})}}});
define ("mod_forum/pin_toggle",["jquery","core/ajax","core/str","core/templates","core/notification","mod_forum/repository","mod_forum/selectors","core/str"],function(a,b,c,d,f,g,h,i){return{init:function registerEventListeners(b,c,d){b.on("click",h.pin.toggle,function(b){var e=a(this),h=e.data("forumid"),j=e.data("discussionid"),k=e.data("targetstate");g.setPinDiscussionState(h,j,k).then(function(a){return d(e,a)}).then(function(){return i.get_string("pinupdated","forum").done(function(a){return f.addNotification({message:a,type:"info"})})}).fail(f.exception);if(c){b.preventDefault()}})}}});
define ("mod_forum/posts_list",["jquery","core/templates","core/notification","core/pending","core/yui","mod_forum/selectors","mod_forum/inpage_reply"],function(a,b,c,d,e,f,g){var h=function(h){h.on("click",f.post.inpageReplyLink,function(h){h.preventDefault();if(window.location.hash){var i=window.location.href.split("#")[0];history.pushState({},document.title,i)}var j=new d("inpage-reply"),k=a(h.currentTarget).parents(f.post.forumCoreContent),l=k.find(f.post.forumSubject),m=a(h.currentTarget).parents(f.post.forumContent),n={postid:a(m).data("post-id"),reply_url:a(h.currentTarget).attr("href"),sesskey:M.cfg.sesskey,parentsubject:l.data("replySubject"),canreplyprivately:a(h.currentTarget).data("can-reply-privately"),postformat:g.CONTENT_FORMATS.MOODLE};if(!m.find(f.post.inpageReplyContent).length){b.render("mod_forum/inpage_reply",n).then(function(a,c){return b.appendNodeContents(k,a,c)}).then(function(){return m.find(f.post.inpageReplyContent).slideToggle(300,j.resolve).find("textarea").focus()}).then(function(){e.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.init({formid:"inpage-reply-".concat(n.postid)})})}).fail(c.exception)}else{var o=m.find(f.post.inpageReplyContent);o.slideToggle(300,j.resolve);if(o.is(":visible")){o.find("textarea").focus()}}})};return{init:function init(a){h(a);g.init(a)}}});
define ("mod_forum/repository",["core/ajax"],function(a){return{setDiscussionSubscriptionState:function setDiscussionSubscriptionState(b,c,d){return a.call([{methodname:"mod_forum_set_subscription_state",args:{forumid:b,discussionid:c,targetstate:d}}])[0]},addDiscussionPost:function addDiscussionPost(b,c,d,e,f,g){return a.call([{methodname:"mod_forum_add_discussion_post",args:{postid:b,message:d,messageformat:e,subject:c,options:[{name:"private",value:f},{name:"topreferredformat",value:g}]}}])[0]},setDiscussionLockState:function setDiscussionLockState(b,c,d){return a.call([{methodname:"mod_forum_set_lock_state",args:{forumid:b,discussionid:c,targetstate:d}}])[0]},setFavouriteDiscussionState:function setFavouriteDiscussionState(b,c,d){return a.call([{methodname:"mod_forum_toggle_favourite_state",args:{discussionid:c,targetstate:d}}])[0]},setPinDiscussionState:function setPinDiscussionState(b,c,d){return a.call([{methodname:"mod_forum_set_pin_state",args:{discussionid:c,targetstate:d}}])[0]},getDiscussionByUserID:function getDiscussionByUserID(b,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"modified",e=3<arguments.length&&arguments[3]!==void 0?arguments[3]:"DESC";return a.call([{methodname:"mod_forum_get_discussion_posts_by_userid",args:{userid:b,cmid:c,sortby:d,sortdirection:e}}])[0]},getDiscussionPosts:function getDiscussionPosts(b){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"created",d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"ASC";return a.call([{methodname:"mod_forum_get_discussion_posts",args:{discussionid:b,sortby:c,sortdirection:d}}])[0]}}});
define ("mod_forum/selectors",[],function(){return{subscription:{toggle:"[data-type='subscription-toggle'][data-action='toggle']"},summary:{actions:"[data-container='discussion-summary-actions']"},post:{post:"[data-region=\"post\"]",action:"[data-region=\"post-action\"]",actionsContainer:"[data-region=\"post-actions-container\"]",authorName:"[data-region=\"author-name\"]",forumCoreContent:"[data-region-content='forum-post-core']",forumContent:"[data-content='forum-post']",forumSubject:"[data-region-content='forum-post-core-subject']",inpageReplyButton:"button",inpageReplyLink:"[data-action='collapsible-link']",inpageReplyCancelButton:"[data-action='cancel-inpage-reply']",inpageReplyCreateButton:"[data-action='create-inpage-reply']",inpageReplyContainer:"[data-region=\"inpage-reply-container\"]",inpageReplyContent:"[data-content='inpage-reply-content']",inpageReplyForm:"form[data-content='inpage-reply-form']",inpageSubmitBtn:"[data-action='forum-inpage-submit']",inpageSubmitBtnText:"[data-region='submit-text']",loadingIconContainer:"[data-region='loading-icon-container']",repliesContainer:"[data-region='replies-container']",replyCount:"[data-region=\"reply-count\"]",modeSelect:"select[name='mode']",showReplies:"[data-action=\"show-replies\"]",hideReplies:"[data-action=\"hide-replies\"]",repliesVisibilityToggleContainer:"[data-region=\"replies-visibility-toggle-container\"]"},lock:{toggle:"[data-action='toggle'][data-type='lock-toggle']",icon:"[data-region='locked-icon']"},favourite:{toggle:"[data-type='favorite-toggle'][data-action='toggle']"},pin:{toggle:"[data-type='pin-toggle'][data-action='toggle']"},discussion:{tools:"[data-container=\"discussion-tools\"]",item:"[data-region=\"discussion-list-item\"]",lockedLabel:"[data-region='locked-label']",subscribedLabel:"[data-region='subscribed-label']",timedLabel:"[data-region='timed-label']"}}});
define ("mod_forum/subscription_toggle",["jquery","core/templates","core/notification","mod_forum/repository","mod_forum/selectors","core/pubsub","mod_forum/forum_events"],function(a,b,c,d,e,f,g){return{init:function registerEventListeners(b,h,i){b.on("click",e.subscription.toggle,function(b){var e=a(this),j=e.data("forumid"),k=e.data("discussionid"),l=e.data("targetstate");d.setDiscussionSubscriptionState(j,k,l).then(function(a){f.publish(g.SUBSCRIPTION_TOGGLED,{discussionId:k,subscriptionState:l});return i(e,a)}).catch(c.exception);if(h){b.preventDefault()}})}}});
define ("mod_lti/cartridge_registration_form",["jquery","core/ajax","core/notification","mod_lti/tool_type","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,f,g,h){var i={CARTRIDGE_URL:"#cartridge-url",CONSUMER_KEY:"#registration-key",SHARED_SECRET:"#registration-secret",REGISTRATION_FORM:"#cartridge-registration-form",REGISTRATION_SUBMIT_BUTTON:"#cartridge-registration-submit",REGISTRATION_CANCEL_BUTTON:"#cartridge-registration-cancel"},j=function(){return a(i.REGISTRATION_FORM).attr("data-cartridge-url")},k=function(){return a(i.REGISTRATION_SUBMIT_BUTTON)},l=function(){return a(i.REGISTRATION_CANCEL_BUTTON)},m=function(){return a(i.CONSUMER_KEY).val()},n=function(){return a(i.SHARED_SECRET).val()},o=function(){k().addClass("loading")},p=function(){k().removeClass("loading")},q=function(){return k().hasClass("loading")},r=function(){if(q()){return!1}var b=j();if(""===b){return!1}o();var e=m(),g=n(),i=d.create({cartridgeurl:b,key:e,secret:g});i.done(function(){h.get_string("successfullycreatedtooltype","mod_lti").done(function(b){a(document).trigger(f.NEW_TOOL_TYPE);a(document).trigger(f.STOP_CARTRIDGE_REGISTRATION);a(document).trigger(f.REGISTRATION_FEEDBACK,{message:b})}).fail(c.exception)}).fail(function(){h.get_string("failedtocreatetooltype","mod_lti").done(function(b){a(document).trigger(f.NEW_TOOL_TYPE);a(document).trigger(f.STOP_CARTRIDGE_REGISTRATION);a(document).trigger(f.REGISTRATION_FEEDBACK,{message:b,error:!0})}).fail(c.exception)}).always(function(){p()});return i},s=function(){var b=a(i.REGISTRATION_FORM);b.submit(function(a){a.preventDefault();r()});var c=l();c.click(function(b){b.preventDefault();a(document).trigger(f.STOP_CARTRIDGE_REGISTRATION)});c.keypress(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(a.keyCode==g.ENTER||a.keyCode==g.SPACE){a.preventDefault();c.click()}}})};return{init:function init(){s()}}});
define ("mod_lti/contentitem",["jquery","core/notification","core/str","core/templates","mod_lti/form-field","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f,g){var h,i,j=[new e("name",e.TYPES.TEXT,!1,""),new e("introeditor",e.TYPES.EDITOR,!1,""),new e("toolurl",e.TYPES.TEXT,!0,""),new e("securetoolurl",e.TYPES.TEXT,!0,""),new e("instructorchoiceacceptgrades",e.TYPES.CHECKBOX,!0,!0),new e("instructorchoicesendname",e.TYPES.CHECKBOX,!0,!0),new e("instructorchoicesendemailaddr",e.TYPES.CHECKBOX,!0,!0),new e("instructorcustomparameters",e.TYPES.TEXT,!0,""),new e("icon",e.TYPES.TEXT,!0,""),new e("secureicon",e.TYPES.TEXT,!0,""),new e("launchcontainer",e.TYPES.SELECT,!0,0),new e("grade_modgrade_point",e.TYPES.TEXT,!1,""),new e("lineitemresourceid",e.TYPES.TEXT,!0,""),new e("lineitemtag",e.TYPES.TEXT,!0,"")];window.processContentItemReturnData=function(a){if(h){h.hide()}for(var b in j){var c=j[b],d=null;if("undefined"!=typeof a[c.name]){d=a[c.name]}c.setFieldValue(d)}if(i){i()}};return{init:function init(a,e,j){i=j;var k=d.render("mod_lti/contentitem",{url:a,postData:e});if(h){h.setBody(k);h.show();return}c.get_string("selectcontent","lti").then(function(a){return f.create({title:a,body:k,large:!0})}).then(function(a){h=a;a.getRoot().on(g.hidden,function(){a.setBody("");b.fetchNotifications()});a.show()}).catch(b.exception)}}});
define ("mod_lti/contentitem_return",["jquery"],function(a){return{init:function init(b){a(window).ready(function(){if(window!=top){parent.processContentItemReturnData(b)}else{window.processContentItemReturnData(b)}})}}});
define ("mod_lti/events",[],function(){return{NEW_TOOL_TYPE:"lti.tool.type.new",START_EXTERNAL_REGISTRATION:"lti.registration.external.start",STOP_EXTERNAL_REGISTRATION:"lti.registration.external.stop",START_CARTRIDGE_REGISTRATION:"lti.registration.cartridge.start",STOP_CARTRIDGE_REGISTRATION:"lti.registration.cartridge.stop",REGISTRATION_FEEDBACK:"lti.registration.feedback",CAPABILITIES_AGREE:"lti.tool.type.capabilities.agree",CAPABILITIES_DECLINE:"lti.tool.type.capabilities.decline"}});
define ("mod_lti/external_registration",["jquery","core/ajax","core/notification","core/templates","mod_lti/events","mod_lti/tool_proxy","mod_lti/tool_type","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h,i){var j={EXTERNAL_REGISTRATION_CONTAINER:"#external-registration-page-container",EXTERNAL_REGISTRATION_TEMPLATE_CONTAINER:"#external-registration-template-container",EXTERNAL_REGISTRATION_CANCEL_BUTTON:"#cancel-external-registration",TOOL_TYPE_CAPABILITIES_CONTAINER:"#tool-type-capabilities-container",TOOL_TYPE_CAPABILITIES_TEMPLATE_CONTAINER:"#tool-type-capabilities-template-container",CAPABILITIES_AGREE_CONTAINER:".capabilities-container"},k=function(){return a(j.EXTERNAL_REGISTRATION_CANCEL_BUTTON)},l=function(){return a(j.EXTERNAL_REGISTRATION_CONTAINER)},m=function(){return a(j.EXTERNAL_REGISTRATION_TEMPLATE_CONTAINER)},n=function(){return a(j.TOOL_TYPE_CAPABILITIES_CONTAINER)},o=function(){return a(j.TOOL_TYPE_CAPABILITIES_TEMPLATE_CONTAINER)},p=function(){n().addClass("loading")},q=function(){n().removeClass("loading")},r=function(){k().addClass("loading")},s=function(){k().removeClass("loading")},t=function(){n().addClass("hidden")},u=function(){n().removeClass("hidden")},v=function(){l().addClass("hidden")},w=function(){l().removeClass("hidden")},x=function(a){var b=k();b.attr("data-tool-proxy-id",a)},y=function(){var a=k();return a.attr("data-tool-proxy-id")},z=function(){var a=k();a.removeAttr("data-tool-proxy-id")},A=function(){return y()?!0:!1},B=function(){var a=k();return a.attr("data-tool-proxy-new")&&A()},C=function(){var a=k();return a.attr("data-tool-proxy-new","new")},D=function(){var a=k();return a.removeAttr("data-tool-proxy-new")},E=function(a){return b.call([{methodname:"mod_lti_get_tool_proxy_registration_request",args:{id:a}}])[0]},F=function(){r();var b=a.Deferred();if(B()){var d=y();f.delete(d).done(function(){b.resolve()}).fail(function(a){b.reject(a)})}else{b.resolve()}b.done(function(){L();s()}).fail(function(b){c.exception(b);L();s();i.get_string("failedtodeletetoolproxy","mod_lti").done(function(b){a(document).trigger(e.REGISTRATION_FEEDBACK,{message:b,error:!0})}).fail(c.exception)});return b},G=function(a){var b=d.render("mod_lti/tool_proxy_registration_form",a);b.done(function(a,b){var c=m();c.append(a);d.runTemplateJS(b);c.find("form").submit();w()}).fail(c.exception);return b},H=function(a){return g.update({id:a.id,state:g.constants.state.configured})},I=function(b){var f=a.Deferred();d.render("mod_lti/tool_type_capabilities_agree",b).done(function(a,c){var g=o();v();u();d.replaceNodeContents(g,a,c);var h=g.find(j.CAPABILITIES_AGREE_CONTAINER);h.on(e.CAPABILITIES_AGREE,function(){p();H(b).always(function(){q();g.empty();f.resolve()})});h.on(e.CAPABILITIES_DECLINE,function(){g.empty();f.resolve()})}).fail(f.reject);f.done(function(){t()}).fail(c.exception);return f},J=function(b){var c=a.Deferred();if(!b||""===b){c.resolve()}else{f.create({regurl:b}).done(function(a){C();c=K(a.id)}).fail(function(b){F();var d={message:b.message,error:!0};a(document).trigger(e.REGISTRATION_FEEDBACK,d);c.reject(b)})}return c},K=function(b){var c=a.Deferred();x(b);E(b).done(function(a){G(a).done(function(){c.resolve()}).fail(c.fail)}).fail(c.fail);return c},L=function(){if(A()){z()}D(!1);v();var b=m();b.empty();a(document).trigger(e.STOP_EXTERNAL_REGISTRATION)},M=function(){a(document).on(e.START_EXTERNAL_REGISTRATION,function(a,b){if(!b){return}if(b.url){J(b.url)}if(b.proxyid){K(b.proxyid)}});var b=k();b.click(function(a){a.preventDefault();F()});b.keypress(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(a.keyCode==h.ENTER||a.keyCode==h.SPACE){a.preventDefault();F()}}});window.triggerExternalRegistrationComplete=function(b){var d=a.Deferred(),f={message:"",error:!1};if("success"==b.status){i.get_string("successfullycreatedtooltype","mod_lti").done(function(a){f.message=a}).fail(c.exception);d.done(function(){L();a(document).trigger(e.REGISTRATION_FEEDBACK,f);a(document).trigger(e.NEW_TOOL_TYPE)}).fail(c.exception);if(B()){var h=y();g.getFromToolProxyId(h).done(function(a){if(a&&a.length){var b=a[0];if(b.hascapabilitygroups){I(b).always(function(){d.resolve()})}else{d.resolve()}}else{d.resolve()}}).fail(function(){d.resolve()})}}else{f.message=b.error;f.error=!0;d.done(function(){F().always(function(){a(document).trigger(e.REGISTRATION_FEEDBACK,f)})}).fail(c.exception);d.resolve()}return d}};return{init:function init(){M()}}});
define ("mod_lti/external_registration_return",[],function(){return{init:function init(a,b,c,d){if(window.parent){window.parent.triggerExternalRegistrationComplete({message:a,error:b,id:c,status:d})}}}});
define ("mod_lti/form-field",["jquery"],function(a){var b=function(a,b,c,d){this.name=a;this.id="id_"+this.name;this.selector="#"+this.id;this.type=b;this.resetIfUndefined=c;this.defaultValue=d};b.TYPES={TEXT:1,SELECT:2,CHECKBOX:3,EDITOR:4};b.prototype.setFieldValue=function(c){if(null===c){if(this.resetIfUndefined){c=this.defaultValue}else{return}}switch(this.type){case b.TYPES.CHECKBOX:if(c){a(this.selector).prop("checked",!0)}else{a(this.selector).prop("checked",!1)}break;case b.TYPES.EDITOR:if("undefined"!=typeof c.text){var d=a(this.selector+"editable");if(d.length){d.html(c.text)}else if("undefined"!=typeof tinyMCE){tinyMCE.execInstanceCommand(this.id,"mceInsertContent",!1,c.text)}a(this.selector).val(c.text)}break;default:a(this.selector).val(c);break;}};return b});
define ("mod_lti/keys",[],function(){return{ENTER:13,SPACE:32}});
define ("mod_lti/tool_card_controller",["jquery","core/ajax","core/notification","core/templates","core/modal_factory","mod_lti/tool_type","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h,i){var j={DELETE_BUTTON:".delete",NAME_ELEMENT:".name",DESCRIPTION_ELEMENT:".description",CAPABILITIES_CONTAINER:".capabilities-container",ACTIVATE_BUTTON:".tool-card-footer a.activate"},k=2e3,l=function(a){return a.find(j.DELETE_BUTTON)},m=function(a){return a.find(j.NAME_ELEMENT)},n=function(a){return a.find(j.DESCRIPTION_ELEMENT)},o=function(a){return a.find(j.ACTIVATE_BUTTON)},p=function(a){return o(a).length?!0:!1},q=function(a){return a.find(j.CAPABILITIES_CONTAINER)},r=function(a){return q(a).length?!0:!1},s=function(a){return a.attr("data-type-id")},t=function(a){a.removeClass("announcement loading success fail capabilities")},u=function(a){t(a);a.addClass("announcement loading")},v=function(a){a.removeClass("announcement loading")},w=function(b){var c=a.Deferred();t(b);b.addClass("announcement success");setTimeout(function(){b.removeClass("announcement success");c.resolve()},k);return c},x=function(b){var c=a.Deferred();t(b);b.addClass("announcement fail");setTimeout(function(){b.removeClass("announcement fail");c.resolve()},k);return c},y=function(b){var d=a.Deferred(),e=s(b);u(b);if(""===e){return a.Deferred().resolve()}i.get_strings([{key:"delete",component:"mod_lti"},{key:"delete_confirmation",component:"mod_lti"},{key:"delete",component:"mod_lti"},{key:"cancel",component:"core"}]).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){f.delete(e).done(function(){v(b);w(b).done(function(){b.remove()}).fail(c.exception).always(function(){d.resolve()})}).fail(function(a){x(b);d.reject(a)})},function(){v(b);d.resolve()})}).fail(function(a){v(b);c.exception(a);d.reject(a)});return d},z=function(a,b){a.attr("data-val-snapshot",b)},A=function(a){return a.attr("data-val-snapshot")},B=function(a){var b=n(a);if(b.hasClass("loading")){return}var c=b.text().trim();z(b,c)},C=function(b){var d=s(b);if(""===d){return a.Deferred().resolve()}var e=n(b);if(e.hasClass("loading")){return a.Deferred().resolve()}var g=e.text().trim(),h=A(e);if(h==g){return a.Deferred().resolve()}e.addClass("loading");var i=f.update({id:d,description:g});i.done(function(a){e.removeClass("loading");e.text(a.description)}).fail(c.exception);i.fail(function(){e.removeClass("loading")});return i},D=function(a){var b=m(a);if(b.hasClass("loading")){return}var c=b.text().trim();z(b,c)},E=function(b){var c=s(b);if(""===c){return a.Deferred().resolve()}var d=m(b);if(d.hasClass("loading")){return a.Deferred().resolve()}var e=d.text().trim(),g=A(d);if(g==e){return a.Deferred().resolve()}d.addClass("loading");var h=f.update({id:c,name:e});h.done(function(a){d.removeClass("loading");d.text(a.name)});h.fail(function(){d.removeClass("loading")});return h},F=function(b){var c=s(b);if(""===c){return a.Deferred().resolve()}u(b);var e=f.update({id:c,state:f.constants.state.configured});e.then(function(a){v(b);w(b);return a}).then(function(a){return d.render("mod_lti/tool_card",a)}).then(function(a){var c=a[0],e=a[1];d.replaceNode(b,c,e)}).catch(function(){v(b);x(b)});return e},G=function(a){a.addClass("announcement capabilities")},H=function(a){a.removeClass("announcement capabilities")},I=function(a){if(r(a)){G(a)}else{F(a)}},J=function(a){var b=l(a);b.click(function(b){b.preventDefault();y(a)});b.keypress(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(a.keyCode==h.ENTER||a.keyCode==h.SPACE){a.preventDefault();b.click()}}});var c=n(a);c.focus(function(b){b.preventDefault();B(a)});c.blur(function(b){b.preventDefault();C(a)});c.keypress(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(a.keyCode==h.ENTER){a.preventDefault();c.blur()}}});var d=m(a);d.focus(function(b){b.preventDefault();D(a)});d.blur(function(b){b.preventDefault();E(a)});d.keypress(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(a.keyCode==h.ENTER){a.preventDefault();d.blur()}}});if(p(a)){var f=o(a);f.click(function(b){b.preventDefault();I(a)});f.keypress(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(a.keyCode==h.ENTER||a.keyCode==h.SPACE){a.preventDefault();f.click()}}})}if(r(a)){var i=q(a);i.on(g.CAPABILITIES_AGREE,function(){F(a)});i.on(g.CAPABILITIES_DECLINE,function(){H(a)})}},K=function(b){var c=a("#"+b.data("uniqid")+"-"+b.data("deploymentid")),f={uniqid:b.data("uniqid"),platformid:b.data("platformid"),clientid:b.data("clientid"),deploymentid:b.data("deploymentid"),urls:{publickeyset:b.data("publickeyseturl"),accesstoken:b.data("accesstokenurl"),authrequest:b.data("authrequesturl")}},g=d.render("mod_lti/tool_config_modal_body",f),h="mailto:?subject="+encodeURIComponent(b.data("mailtosubject"))+"&body="+encodeURIComponent(b.data("platformidstr"))+":%20"+encodeURIComponent(b.data("platformid"))+"%0D%0A"+encodeURIComponent(b.data("clientidstr"))+":%20"+encodeURIComponent(b.data("clientid"))+"%0D%0A"+encodeURIComponent(b.data("deploymentidstr"))+":%20"+encodeURIComponent(b.data("deploymentid"))+"%0D%0A"+encodeURIComponent(b.data("publickeyseturlstr"))+":%20"+encodeURIComponent(b.data("publickeyseturl"))+"%0D%0A"+encodeURIComponent(b.data("accesstokenurlstr"))+":%20"+encodeURIComponent(b.data("accesstokenurl"))+"%0D%0A"+encodeURIComponent(b.data("authrequesturlstr"))+":%20"+encodeURIComponent(b.data("authrequesturl"))+"%0D%0A";f={mailto:h};var i=d.render("mod_lti/tool_config_modal_footer",f);e.create({large:!0,title:b.data("modaltitle"),body:g,footer:i},c)};return{init:function init(a){J(a);K(a)}}});
define ("mod_lti/tool_configure_controller",["jquery","core/ajax","core/notification","core/templates","mod_lti/events","mod_lti/keys","mod_lti/tool_type","mod_lti/tool_proxy","core/str"],function(a,b,c,d,e,f,g,h,i){var j={EXTERNAL_REGISTRATION_CONTAINER:"#external-registration-container",EXTERNAL_REGISTRATION_PAGE_CONTAINER:"#external-registration-page-container",CARTRIDGE_REGISTRATION_CONTAINER:"#cartridge-registration-container",CARTRIDGE_REGISTRATION_FORM:"#cartridge-registration-form",ADD_TOOL_FORM:"#add-tool-form",TOOL_LIST_CONTAINER:"#tool-list-container",TOOL_CREATE_BUTTON:"#tool-create-button",REGISTRATION_CHOICE_CONTAINER:"#registration-choice-container",TOOL_URL:"#tool-url"},k=function(){return a(j.TOOL_CREATE_BUTTON)},l=function(){return a(j.TOOL_LIST_CONTAINER)},m=function(){return a(j.EXTERNAL_REGISTRATION_CONTAINER)},n=function(){return a(j.CARTRIDGE_REGISTRATION_CONTAINER)},o=function(){return a(j.REGISTRATION_CHOICE_CONTAINER)},p=function(){return a(j.TOOL_URL).val()},q=function(){m().addClass("hidden")},r=function(){n().addClass("hidden")},s=function(){o().addClass("hidden")},t=function(){r();s();m().removeClass("hidden");w(m())},u=function(a){q();s();var b=n();b.find("input").val("");b.removeClass("hidden");b.find(j.CARTRIDGE_REGISTRATION_FORM).attr("data-cartridge-url",a);w(b)},v=function(){q();r();o().removeClass("hidden");w(o())},w=function(a){var b=a.children().detach();b.appendTo(a)},x=function(){l().addClass("hidden")},y=function(){l().removeClass("hidden")},z=function(a){var b=a.error?"error":"success";c.addNotification({message:a.message,type:b})},A=function(a){a.addClass("loading")},B=function(a){a.removeClass("loading")},C=function(){var b=a.Deferred(),e=l();A(e);a.when(g.query(),h.query({orphanedonly:!0})).done(function(a,c){d.render("mod_lti/tool_list",{tools:a,proxies:c}).done(function(a,c){e.empty();e.append(a);d.runTemplateJS(c);b.resolve()}).fail(b.reject)}).fail(b.reject);b.fail(c.exception).always(function(){B(e)})},D=function(){var b=p().trim();if(""===b){return a.Deferred().resolve()}var d=k();A(d);var f=g.isCartridge(b);f.always(function(){B(d)});f.done(function(c){if(c.iscartridge){a(j.TOOL_URL).val("");a(document).trigger(e.START_CARTRIDGE_REGISTRATION,b)}else{a(document).trigger(e.START_EXTERNAL_REGISTRATION,{url:b})}});f.fail(function(){i.get_string("errorbadurl","mod_lti").done(function(b){a(document).trigger(e.REGISTRATION_FEEDBACK,{message:b,error:!0})}).fail(c.exception)});return f},E=function(){a(document).on(e.NEW_TOOL_TYPE,function(){C()});a(document).on(e.START_EXTERNAL_REGISTRATION,function(){t();a(j.TOOL_URL).val("");x()});a(document).on(e.STOP_EXTERNAL_REGISTRATION,function(){y();v()});a(document).on(e.START_CARTRIDGE_REGISTRATION,function(a,b){u(b)});a(document).on(e.STOP_CARTRIDGE_REGISTRATION,function(){n().find(j.CARTRIDGE_REGISTRATION_FORM).removeAttr("data-cartridge-url");v()});a(document).on(e.REGISTRATION_FEEDBACK,function(a,b){z(b)});var b=a(j.ADD_TOOL_FORM);b.submit(function(a){a.preventDefault();D()})};return{init:function init(){E();C()}}});
define ("mod_lti/tool_proxy",["core/ajax","core/notification"],function(a,b){return{query:function query(c){var d=a.call([{methodname:"mod_lti_get_tool_proxies",args:c||{}}])[0];d.fail(b.exception);return d},delete:function _delete(c){var d=a.call([{methodname:"mod_lti_delete_tool_proxy",args:{id:c}}])[0];d.fail(b.exception);return d},create:function create(b){var c=a.call([{methodname:"mod_lti_create_tool_proxy",args:b}])[0];return c}}});
define ("mod_lti/tool_proxy_card_controller",["jquery","core/ajax","core/notification","core/templates","mod_lti/tool_proxy","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h){var i={DELETE_BUTTON:".delete",CAPABILITIES_CONTAINER:".capabilities-container",ACTIVATE_BUTTON:".tool-card-footer a.activate"},j=2e3,k=function(a){return a.find(i.DELETE_BUTTON)},l=function(a){return a.find(i.ACTIVATE_BUTTON)},m=function(a){return a.attr("data-proxy-id")},n=function(a){a.removeClass("announcement loading success fail capabilities")},o=function(a){n(a);a.addClass("announcement loading")},p=function(a){a.removeClass("announcement loading")},q=function(b){var c=a.Deferred();n(b);b.addClass("announcement success");setTimeout(function(){b.removeClass("announcement success");c.resolve()},j);return c},r=function(b){var c=a.Deferred();n(b);b.addClass("announcement fail");setTimeout(function(){b.removeClass("announcement fail");c.resolve()},j);return c},s=function(b){var d=a.Deferred(),f=m(b);o(b);if(""===f){return a.Deferred().resolve()}h.get_strings([{key:"delete",component:"mod_lti"},{key:"delete_confirmation",component:"mod_lti"},{key:"delete",component:"mod_lti"},{key:"cancel",component:"core"}]).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){e.delete(f).done(function(){p(b);q(b).done(function(){b.remove();d.resolve()}).fail(c.exception)}).fail(function(a){r(b);d.reject(a)})},function(){p(b);d.resolve()})}).fail(function(a){p(b);c.exception(a);d.reject(a)});return d},t=function(b){var c={proxyid:m(b)};a(document).trigger(f.START_EXTERNAL_REGISTRATION,c)},u=function(a){var b=k(a);b.click(function(b){b.preventDefault();s(a)});b.keypress(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(a.keyCode==g.ENTER||a.keyCode==g.SPACE){a.preventDefault();b.click()}}});var c=l(a);c.click(function(b){b.preventDefault();t(a)});c.keypress(function(a){if(!a.metaKey&&!a.shiftKey&&!a.altKey&&!a.ctrlKey){if(a.keyCode==g.ENTER||a.keyCode==g.SPACE){a.preventDefault();c.click()}}})};return{init:function init(a){u(a)}}});
define ("mod_lti/tool_type",["core/ajax","core/notification"],function(a,b){return{query:function query(c){var d=a.call([{methodname:"mod_lti_get_tool_types",args:c||{}}])[0];d.fail(b.exception);return d},create:function create(b){var c=a.call([{methodname:"mod_lti_create_tool_type",args:b}])[0];return c},update:function update(c){var d=a.call([{methodname:"mod_lti_update_tool_type",args:c}])[0];d.fail(b.exception);return d},delete:function _delete(c){var d=a.call([{methodname:"mod_lti_delete_tool_type",args:{id:c}}])[0];d.fail(b.exception);return d},getFromToolProxyId:function getFromToolProxyId(a){return this.query({toolproxyid:a})},isCartridge:function isCartridge(b){var c=a.call([{methodname:"mod_lti_is_cartridge",args:{url:b}}])[0];return c},constants:{state:{configured:1,pending:2,rejected:3}}}});
define ("mod_quiz/add_question_modal_launcher",["jquery","core/notification","core/modal_factory"],function(a,b,c){return{init:function init(d,e,f,g){var h=a("body");return c.create({type:d,large:!0,preShowCallback:function preShowCallback(b,c){b=a(b);c.setContextId(f);c.setAddOnPageId(b.attr("data-addonpage"));c.setTitle(b.attr("data-header"));if(g){g(b,c)}}},[h,e]).fail(b.exception)}}});
define ("mod_quiz/add_random_form",["jquery","mod_quiz/random_question_form_preview"],function(a,b){var c={PREVIEW_CONTAINER:"[data-region=\"random-question-preview-container\"]",CATEGORY_FORM_ELEMENT:"[name=\"category\"]",SUBCATEGORY_FORM_ELEMENT:"[name=\"includesubcategories\"]",TAG_IDS_FORM_ELEMENT:"[name=\"fromtags[]\"]"},d=function(a){return a.find(c.CATEGORY_FORM_ELEMENT).val()},e=function(a){var b=d(a),c=b.split(",");return c[0]},f=function(a,b){var c=d(a);return-1<b.indexOf(c)},g=function(a,b){if(f(a,b)){return!0}else{return a.find(c.SUBCATEGORY_FORM_ELEMENT).is(":checked")}},h=function(a){var b=a.find(c.TAG_IDS_FORM_ELEMENT).val();return b.map(function(a){var b=a.split(",");return b[0]})},i=function(a,d,f){var i=a.find(c.PREVIEW_CONTAINER);b.reload(i,e(a),g(a,f),h(a),d)},j=function(a){if(0<a.closest(c.CATEGORY_FORM_ELEMENT).length){return!0}if(0<a.closest(c.SUBCATEGORY_FORM_ELEMENT).length){return!0}if(0<a.closest(c.TAG_IDS_FORM_ELEMENT).length){return!0}return!1},k=function(c,d,e){var f=null;c.on("change",function(g){if(!j(a(g.target))){return}b.showLoadingIcon(c);if(f){clearTimeout(f)}f=setTimeout(function(){i(c,d,e)},2000)})};return{init:function init(b,c,d,e){if(!0==e){var f=a("#"+b);i(f,c,d,e);k(f,c,d,e)}}}});
define ("mod_quiz/add_random_question",["mod_quiz/add_question_modal_launcher","mod_quiz/modal_add_random_question"],function(a,b){return{init:function init(c,d,e,f){a.init(b.TYPE,".menu [data-action=\"addarandomquestion\"]",c,function(a,b){b.setCategory(d);b.setReturnUrl(e);b.setCMID(f)})}}});
define ("mod_quiz/modal_add_random_question",["jquery","core/yui","core/notification","core/modal","core/modal_events","core/modal_registry","core/fragment","core/templates"],function(a,b,c,d,e,f,g,h){var i=!1,j={EXISTING_CATEGORY_CONTAINER:"[data-region=\"existing-category-container\"]",EXISTING_CATEGORY_FORM_ELEMENT:"#id_existingcategoryheader",NEW_CATEGORY_CONTAINER:"[data-region=\"new-category-container\"]",NEW_CATEGORY_FORM_ELEMENT:"#id_newcategoryheader",TAB_CONTENT:"[data-region=\"tab-content\"]",ADD_ON_PAGE_FORM_ELEMENT:"[name=\"addonpage\"]",SUBMIT_BUTTON_ELEMENT:"input[type=\"submit\"]",CANCEL_BUTTON_ELEMENT:"input[type=\"submit\"][name=\"cancel\"]",FORM_HEADER:"legend",BUTTON_CONTAINER:".fitem"},k=function(a){d.call(this,a);this.contextId=null;this.addOnPageId=null;this.category=null;this.returnUrl=null;this.cmid=null;this.loadedForm=!1};k.TYPE="mod_quiz-quiz-add-random-question";k.prototype=Object.create(d.prototype);k.prototype.constructor=k;k.prototype.setContextId=function(a){this.contextId=a};k.prototype.getContextId=function(){return this.contextId};k.prototype.setAddOnPageId=function(a){this.addOnPageId=a;this.getBody().find(j.ADD_ON_PAGE_FORM_ELEMENT).val(a)};k.prototype.getAddOnPageId=function(){return this.addOnPageId};k.prototype.setCategory=function(a){this.category=a};k.prototype.getCategory=function(){return this.category};k.prototype.setReturnUrl=function(a){this.returnUrl=a};k.prototype.getReturnUrl=function(){return this.returnUrl};k.prototype.setCMID=function(a){this.cmid=a};k.prototype.getCMID=function(){return this.cmid};k.prototype.moveFormElementIntoTab=function(b,c){var d=b.find(j.SUBMIT_BUTTON_ELEMENT),e=a("<div class=\"modal-footer mt-1\" data-region=\"footer\"></div>");b.find(j.FORM_HEADER).addClass("hidden");b.wrap(c);d.closest(j.BUTTON_CONTAINER).remove();d.appendTo(e);e.appendTo(b)};k.prototype.moveTabsIntoTabContent=function(a){var b=this.getBody().find(j.TAB_CONTENT).empty();a.find("[role=\"tabpanel\"]").wrapAll(b)};k.prototype.moveCancelButtonToTabs=function(a){var b=a.find(j.CANCEL_BUTTON_ELEMENT).addClass("ml-1"),c=a.find("[data-region=\"footer\"]");b.closest(j.BUTTON_CONTAINER).remove();b.clone().appendTo(c)};k.prototype.loadForm=function(){return g.loadFragment("mod_quiz","add_random_question_form",this.getContextId(),{addonpage:this.getAddOnPageId(),cat:this.getCategory(),returnurl:this.getReturnUrl(),cmid:this.getCMID()}).then(function(b,c){var d=a(b),e=d.find(j.EXISTING_CATEGORY_FORM_ELEMENT),f=this.getBody().find(j.EXISTING_CATEGORY_CONTAINER),g=d.find(j.NEW_CATEGORY_FORM_ELEMENT),i=this.getBody().find(j.NEW_CATEGORY_CONTAINER);this.moveFormElementIntoTab(e,f);this.moveFormElementIntoTab(g,i);this.moveTabsIntoTabContent(d);this.moveCancelButtonToTabs(d);h.replaceNode(this.getBody().find(j.TAB_CONTENT),d,c)}.bind(this)).then(function(){b.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()})}).fail(c.exception)};k.prototype.show=function(){d.prototype.show.call(this);if(!this.loadedForm){this.loadForm();this.loadedForm=!0}};if(!i){f.register(k.TYPE,k,"mod_quiz/modal_add_random_question");i=!0}return k});
define ("mod_quiz/modal_quiz_question_bank",["jquery","core/yui","core/notification","core/modal","core/modal_events","core/modal_registry","core/fragment"],function(a,b,c,d,e,f,g){var h=!1,i={ADD_TO_QUIZ_CONTAINER:"td.addtoquizaction",ANCHOR:"a[href]",PREVIEW_CONTAINER:"td.previewaction",SEARCH_OPTIONS:"#advancedsearch",DISPLAY_OPTIONS:"#displayoptions",ADD_QUESTIONS_FORM:"form[action=\"edit.php\"]"},j=function(a){d.call(this,a);this.contextId=null;this.addOnPageId=null};j.TYPE="mod_quiz-quiz-question-bank";j.prototype=Object.create(d.prototype);j.prototype.constructor=j;j.prototype.setContextId=function(a){this.contextId=a};j.prototype.getContextId=function(){return this.contextId};j.prototype.setAddOnPageId=function(a){this.addOnPageId=a};j.prototype.getAddOnPageId=function(){return this.addOnPageId};j.prototype.show=function(){this.reloadBodyContent(window.location.search);return d.prototype.show.call(this)};j.prototype.reloadBodyContent=function(a){var b=g.loadFragment("mod_quiz","quiz_question_bank",this.getContextId(),{querystring:a}).fail(c.exception);this.setBody(b)};j.prototype.handleAddToQuizEvent=function(a,b){var c=b.attr("href")+"&addonpage="+this.getAddOnPageId();b.attr("href",c)};j.prototype.handlePreviewContainerEvent=function(a,b){window.openpopup(a,{url:b.attr("href"),name:"questionpreview",options:["height=600","width=800","top=0","left=0","menubar=0","location=0","scrollbars","resizable","toolbar","status","directories=0","fullscreen=0","dependent"].join(",")})};j.prototype.handleDisplayOptionFormEvent=function(b){b.stopPropagation();b.preventDefault();var c=a(b.target).closest(i.DISPLAY_OPTIONS),d="?"+c.serialize();this.reloadBodyContent(d)};j.prototype.registerDisplayOptionListeners=function(){this.getModal().on("change",i.DISPLAY_OPTIONS,function(b){var c=a(b.target);if(c.attr("aria-autocomplete")){return}this.handleDisplayOptionFormEvent(b)}.bind(this));this.getModal().on("submit",i.DISPLAY_OPTIONS,function(a){this.handleDisplayOptionFormEvent(a)}.bind(this))};j.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this);this.registerDisplayOptionListeners();this.getModal().on("submit",i.ADD_QUESTIONS_FORM,function(b){var c=a(b.currentTarget);a("<input />").attr("type","hidden").attr("name","addonpage").attr("value",this.getAddOnPageId()).appendTo(c)}.bind(this));this.getModal().on("click",i.ANCHOR,function(b){var c=a(b.currentTarget);if(c.closest(i.ADD_TO_QUIZ_CONTAINER).length){this.handleAddToQuizEvent(b,c);return}if(c.closest(i.PREVIEW_CONTAINER).length){this.handlePreviewContainerEvent(b,c);return}if(c.closest(i.SEARCH_OPTIONS).length){return}b.preventDefault();this.reloadBodyContent(c.prop("search"))}.bind(this));this.getRoot().on(e.bodyRendered,function(){b.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()})})};if(!h){f.register(j.TYPE,j,"core/modal");h=!0}return j});
define ("mod_quiz/preflightcheck",["jquery","core/yui"],function(a,b){var c={confirmDialogue:null,init:function init(a,d,e,f){var g=a;b.use("moodle-core-notification",function(){if(b.one(e)){c.confirmDialogue=new M.core.dialogue({headerContent:d,bodyContent:b.one(e),draggable:!0,visible:!1,center:!0,modal:!0,width:null,extraClasses:["mod_quiz_preflight_popup"]});b.one(a).on("click",c.displayDialogue);b.one("#id_cancel").on("click",c.hideDialogue);g=c.confirmDialogue.get("boundingBox").one("[name=\"submitbutton\"]")}if(f){b.one(g).on("click",c.launchQuizPopup,c,f)}})},displayDialogue:function displayDialogue(a){if(a){a.halt()}c.confirmDialogue.show()},hideDialogue:function hideDialogue(a){if(a){a.halt()}c.confirmDialogue.hide(a)},launchQuizPopup:function launchQuizPopup(a,c){a.halt();b.use("moodle-core-formchangechecker","io-form",function(){M.core_formchangechecker.reset_form_dirty_state();var d=a.target.ancestor("form");window.openpopup(a,{url:d.get("action")+"?"+b.IO.stringify(d).replace(/\bcancel=/,"x="),windowname:"quizpopup",options:c,fullscreen:!0})})}};return c});
define ("mod_quiz/quizquestionbank",["mod_quiz/add_question_modal_launcher","mod_quiz/modal_quiz_question_bank"],function(a,b){return{init:function init(c){a.init(b.TYPE,".menu [data-action=\"questionbank\"]",c)}}});
define ("mod_quiz/random_question_form_preview",["jquery","core/ajax","core/str","core/notification","core/templates","core/paged_content_factory"],function(a,b,c,d,e,f){var g="mod_quiz/random_question_form_preview_question_list",h={LOADING_ICON_CONTAINER:"[data-region=\"overlay-icon-container\"]",QUESTION_COUNT_CONTAINER:"[data-region=\"question-count-container\"]",QUESTION_LIST_CONTAINER:"[data-region=\"question-list-container\"]"},i=function(a){a.find(h.LOADING_ICON_CONTAINER).removeClass("hidden")},j=function(a){a.find(h.LOADING_ICON_CONTAINER).addClass("hidden")},k=function(a,b){c.get_string("questionsmatchingfilter","mod_quiz",b).then(function(b){a.find(h.QUESTION_COUNT_CONTAINER).html(b)}).fail(d.exception)},l=function(a,c,d,e,f,g){return b.call([{methodname:"core_question_get_random_question_summaries",args:{categoryid:a,includesubcategories:c,tagids:d,contextid:e,limit:f,offset:g}}])[0]},m=function(a,b,c,h,i,j){return f.createFromAjax(i,5,function(f){return f.map(function(f){var i=f.limit,k=f.offset;if(0==k){return e.render(g,{questions:j})}else{return l(a,b,c,h,i,k).then(function(a){var b=a.questions;return e.render(g,{questions:b})}).fail(d.exception)}})})};return{reload:function reload(b,c,f,g,n){i(b);return l(c,f,g,n,5,0).then(function(a){var c=a.totalcount;k(b,c);return a}).then(function(b){var d=b.totalcount,e=b.questions;if(e.length){return m(c,f,g,n,d,e)}else{return a.Deferred().resolve("","")}}).then(function(a,c){var d=b.find(h.QUESTION_LIST_CONTAINER);e.replaceNodeContents(d,a,c)}).always(function(){j(b)}).fail(d.exception)},showLoadingIcon:i,hideLoadingIcon:j}});
define ("mod_quiz/repaginate",["jquery","core/modal_factory"],function(a,b){var c={REPAGINATECOMMAND:"#repaginatecommand",HEADER:"header",BODY:"form"};return{init:function init(){b.create({title:a(c.REPAGINATECOMMAND).data(c.HEADER),body:a(c.REPAGINATECOMMAND).data(c.BODY),large:!1},a(c.REPAGINATECOMMAND))}}});
define ("mod_survey/validation",["jquery","core/str","core/modal_factory","core/notification"],function(a,b,c,d){return{ensureRadiosChosen:function ensureRadiosChosen(e){var f=b.get_strings([{key:"error",component:"moodle"},{key:"questionsnotanswered",component:"survey"}]).then(function(a){return c.create({type:c.types.CANCEL,title:a[0],body:a[1]})}).catch(d.exception),g=a("#"+e);g.submit(function(a){if(0!==g.find("input:radio[data-survey-default=\"true\"]:checked").length){a.preventDefault();return f.then(function(a){a.show();return!1})}return!0})}}});
define ("mod_turnitintooltwo/migration_tool_launch",["jquery","core/templates","core/modal_factory","core/modal_events","mod_turnitintooltwo/modal_migration_tool","mod_turnitintooltwo/migration_tool_migrate"],function(a,b,c,d,e,f){return{migration_tool_launch:function migration_tool_launch(){a.ajax({dataType:"json",type:"POST",url:M.cfg.wwwroot+"/mod/turnitintooltwo/ajax.php",data:{action:"check_migrated",turnitintoolid:a("#migrate_type").data("turnitintoolid"),sesskey:M.cfg.sesskey},success:function success(b){if(!0===b.migrated){window.location.href=M.cfg.wwwroot+"/mod/turnitintooltwo/view.php?id="+b.v2id}else{c.create({type:e.TYPE}).then(function(b){b.show();if(2===a("#migrate_type").data("migratetype")){a(".asktomigrate").hide();a(".migrating").show();f.migration_tool_migrate(a("#migrate_type").data("courseid"),a("#migrate_type").data("turnitintoolid"))}})}}})}}});
define ("mod_turnitintooltwo/migration_tool_migrate",["jquery"],function(a){return{migration_tool_migrate:function migration_tool_migrate(b,c){a.ajax({dataType:"json",type:"POST",url:M.cfg.wwwroot+"/mod/turnitintooltwo/ajax.php",data:{action:"begin_migration",courseid:b,turnitintoolid:c,sesskey:M.cfg.sesskey},success:function success(a){window.location.href=M.cfg.wwwroot+"/mod/turnitintooltwo/view.php?id="+a.id},error:function error(b){var c=b.responseJSON;a("#turnitintool_style").prepend("<div id=\"full-error\" class=\"box generalbox noticebox\">"+c.error+" "+c.message+"</div>")}})}}});
define ("mod_turnitintooltwo/modal_migration_tool",["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","core/modal_events","core/config","mod_turnitintooltwo/migration_tool_migrate"],function(a,b,c,d,e,f,g,h){var i=!1,j={MIGRATE_BUTTON:"[data-action=\"migrate-assignment\"]",CANCEL_BUTTON:"[data-action=\"cancel\"]"},k=function(a){d.call(this,a)};k.TYPE="mod_turnitintooltwo-migration_tool";k.prototype=Object.create(d.prototype);k.prototype.constructor=k;k.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this);this.getModal().on(c.events.activate,j.MIGRATE_BUTTON,function(){a(".asktomigrate").hide();a(".migrating").show();h.migration_tool_migrate(a("#migrate_type").data("courseid"),a("#migrate_type").data("turnitintoolid"))}.bind(this));this.getModal().on(c.events.activate,j.CANCEL_BUTTON,function(b,c){var d=a.Event(f.cancel);this.getRoot().trigger(d,this);if(!d.isDefaultPrevented()){this.hide();c.originalEvent.preventDefault()}}.bind(this))};if(!i){e.register(k.TYPE,k,"mod_turnitintooltwo/modal_migration_tool");i=!0}return k});
define ("mod_ubboard/tracking",["jquery","theme_coursemos/jquery.validate"],function(a){var b={action:"action.php",cmid:null,defaultLs:null};b.init=function(c,d){b.cmid=c;b.defaultLs=d;a(".ubboard .btn-tracking").click(function(){var c=a(this).data("bwid");b.trackingSubmit(c,"","",1,d,b.trackingModalSetting)})};b.trackingSubmit=function(c,d,e,f,g,h){var i=coursemostype+"=tracking";i+="&id="+b.cmid;i+="&bwid="+c;i+="&keyfield="+d;i+="&keyword="+e;i+="&page="+f;i+="&ls="+g;a.ajax({url:b.action,data:i,success:function success(a){if(a.code==mesg.success){h(a)}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})};b.trackingModalSetting=function(c){if(c.isUserDetail){b.trackingDetailModalSetting(c)}else{var d=a(".ubboard .modal-ubboard-tracking");d.find(".modal-title").text(c.title);d.find(".container-fluid").html(c.html);var e=d.find(".form-search");d.find(".pagination .page-link").click(function(){var d=a(this).data("pagenum"),f=e.find("select[name=\"keyfield\"]").val(),g=e.find("input[name=\"keyword\"]").val(),h=e.find("input[name=\"ls\"]").val();b.trackingSubmit(c.bwid,f,g,d,h,b.trackingModalSetting);return!1});e.validate({submitHandler:function submitHandler(d){b.trackingSubmit(c.bwid,a(d.keyfield).val(),a(d.keyword).val(),1,a(d.ls).val(),b.trackingModalSetting);return!1}});e.find(".btn-search-cancel").click(function(){var a=e.find("input[name=\"ls\"]").val();b.trackingSubmit(c.bwid,"","",1,a,b.trackingModalSetting);return!1});d.find(".btn-tracking-detail").click(function(){var c=a(this).data("bwid"),d=a(this).data("userid"),e=b.defaultLs;b.trackingDetailSubmit(c,d,1,e,b.trackingDetailModalSetting)});d.modal("show")}};b.trackingDetailModalSetting=function(c){var d=a(".ubboard .modal-ubboard-tracking-detail");d.find(".modal-title").text(c.title);d.find(".container-fluid").html(c.html);d.find(".pagination .page-link").click(function(){var e=a(this).data("pagenum"),f=d.find("input[name=\"ls\"]").val(),g=d.find("input[name=\"userid\"]").val();b.trackingDetailSubmit(c.bwid,g,e,f,b.trackingDetailModalSetting);return!1});d.modal("show")};b.trackingDetailSubmit=function(c,d,e,f,g){var h=coursemostype+"=trackingDetail";h+="&id="+b.cmid;h+="&bwid="+c;h+="&userid="+d;h+="&page="+e;h+="&ls="+f;a.ajax({url:b.action,data:h,success:function success(a){if(a.code==mesg.success){g(a)}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})};return b});
define ("mod_ubboard/ubboard",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery.filedownload","theme_coursemos/jquery-sortable"],function(a,b,c){var d={adminPath:".path-mod-ubboard ",action:"action.php",manage:function(){a("#ubboard-list-form input[name='all_checked']").click(function(){var b=a(this).is(":checked");a("#ubboard-list-form input[name=\"manage[]\"]").each(function(){if(!a(this).is(":disabled")){this.checked=b}})});a("#ubboard-list-form .btn-selected-delete").click(function(){var d=a("#ubboard-list-form input[name=\"manage[]\"]:checked").length;if(0<d){var e=a("<button type='button'></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_select_article_delete","ubboard",d)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a("#ubboard-list-form input[name=\""+coursemostype+"\"]").val("checkDelete");a("#ubboard-list-form").submit()})});e.trigger("click")}else{alert(M.util.get_string("selected_noarticle","ubboard"))}return!1});a("#ubboard-list-form .btn-selected-open").click(function(){var b=a("#ubboard-list-form input[name=\"manage[]\"]:checked").length;if(0<b){a(".ubboard .modal-article-open").modal("show")}else{alert(M.util.get_string("selected_noarticle","ubboard"))}return!1});a(".ubboard .modal-article-open .btn-open-save").click(function(){var d=a("#ubboard-list-form input[name=\"manage[]\"]:checked").length,f=a(".ubboard .modal-article-open .form-control-open").val(),g="open_conversion_1",h="confirm_select_article_open";if(1!=f){g="open_conversion_0";h="confirm_select_article_open_cancel"}var i=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string(g,"ubboard"),body:M.util.get_string(h,"ubboard",d)},i).done(function(b){b.setSaveButtonText(M.util.get_string(g,"ubboard"));b.getRoot().on(c.save,function(b){b.preventDefault();a("#ubboard-list-form input[name=\""+coursemostype+"\"]").val("checkOpen");a("#ubboard-list-form input[name=\"open\"]").val(f);a("#ubboard-list-form").submit()})});i.trigger("click")});a("#ubboard-list-form .btn-selected-download").click(function(){var b=a("#ubboard-list-form input[name=\"manage[]\"]:checked").length;if(0<b){a("#ubboard-list-form input[name=\""+coursemostype+"\"]").val("checkDownload");a.fileDownload("alldownload.php",{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("alldownload_loading","ubboard"))},httpMethod:"POST",data:a("#ubboard-list-form").serialize()+"&isscript=1",successCallback:function successCallback(){hideSubmitProgress()},failCallback:function failCallback(a){alert(a);hideSubmitProgress()}})}else{alert(M.util.get_string("selected_noarticle","ubboard"))}return!1});a("#ubboard-list-form .btn-selected-category").click(function(){var b=a("#ubboard-list-form input[name=\"manage[]\"]:checked").length;if(0<b){a(".ubboard .modal-article-move").modal("show")}else{alert(M.util.get_string("selected_noarticle","ubboard"))}return!1});a(".ubboard .modal-article-move .btn-move-save").click(function(){var b=a("#ubboard-list-form input[name=\"manage[]\"]:checked").length;if(0<b){var c=a(".ubboard .modal-article-move .form-control-movecategoryid").val();a("#ubboard-list-form input[name=\""+coursemostype+"\"]").val("checkMoveArticles");a("#ubboard-list-form input[name=\"categoryid\"]").val(c);a("#ubboard-list-form").submit()}});a("#ubboard-list-form .btn-selected-share").click(function(){var b=a("#ubboard-list-form input[name=\"manage[]\"]:checked").length;if(0<b){a(".ubboard .modal-share").modal("show")}else{alert(M.util.get_string("selected_noarticle","ubboard"))}return!1});a(".ubboard .modal-share").on("show.bs.modal",function(){var b=a("#ubboard-list-form input[name=\"manage[]\"]:checked"),c="";if(0<a(b).length){var d="";a(b).each(function(){c+=d+a(this).val();d=","})}a(".ubboard .modal-share .modal-body").load(a("#ubboard-list-form .btn-selected-share").data("url")+"&bwids="+c)})}};d.modform=function(){a(d.adminPath+"#id_type").change(function(){a(d.adminPath+"#id_updateboardtype").trigger("click");return!1});a(".mform[action=\"modedit.php\"]").submit(function(){a("#id_type").removeAttr("disabled");a("#id_board_setting select:disabled").each(function(b,c){a(c).removeAttr("disabled")});a("#id_modstandardelshdr select:disabled").each(function(b,c){a(c).removeAttr("disabled")});return!0})};d.write=function(){a(".form-control-usertypes:checkbox").click(function(){var b=a(this).is(":checked");if("0"==a(this).data("usertype")){a(".form-control-usertypes:checkbox").prop("checked",b)}else{var c=!0;a(".form-control-usertypes:checkbox").each(function(b,d){if(0!=a(d).data("usertype")){if(!a(d).prop("checked")&&c){c=!1}}});a(".form-control-usertypes[data-usertype='0']").prop("checked",c)}})};d.article=function(f,g){a(".ubboard .article-buttons .btn-share").click(function(){a(".ubboard .modal-article-share").modal("show")});a(".ubboard .modal-article-share").on("show.bs.modal",function(){a(".ubboard .modal-article-share .modal-body").load(a(".ubboard .article-buttons .btn-share").data("url"))});a(".article-lists .pagination .page-link").click(function(){h(a(this),f,g);return!1});function h(b,c,e){if("#"!=a(b).attr("href")){for(var f,g=location.search.replace(/^\?/,"").split("&"),j={},k=0;k<g.length;k++){f=g[k].split("=");if(1<f.length){j[f[0]]=f[1]}else{j[f[0]]=""}}j.page=a(b).data("pagenum");j[coursemostype]="articleLists";a.ajax({url:d.action,data:a.param(j),success:function success(f){if(f.code==mesg.success){a(".article-lists").html(f.html);a(".article-lists .pagination .page-link").removeAttr("active");a(b).addClass("active");a(".article-lists .pagination .page-link").click(function(){h(a(this),e);return!1});a(".ubboard .lists .form-control-category").change(function(){var b=a(this).val(),d=M.cfg.wwwroot+"/mod/ubboard/view.php?id="+c;if(b){d+="&categoryid="+b}location.href=d});d.manage()}else{alert(f.msg)}}})}return!1}a(".ubboard .article-buttons .btn-delete").click(function(){i();return!1});a(".ubboard .article-buttons .btn-delete-shareall").click(function(){j();return!1});a(".ubboard .article-buttons .btn-popover-delete").popover({html:!0,placement:"top",trigger:"focus",container:a(".ubboard .article-buttons"),content:function content(){return a(".popover-delete-content").html()}}).on("shown.bs.popover",function(){a(".ubboard .article-buttons .btn-delete").click(function(){i();return!1});a(".ubboard .article-buttons .btn-delete-shareall").click(function(){j();return!1})});function i(){var e=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_article_delete","ubboard")},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(a){a.preventDefault();var b=coursemostype+"=delete&id="+f+"&bwid="+g;formSubmit(d.action,b)})});e.trigger("click")}function j(){var e=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_article_delete_shareall","ubboard")},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(a){a.preventDefault();var b=coursemostype+"=deleteShareAll&id="+f+"&bwid="+g;formSubmit(d.action,b)})});e.trigger("click")}a(".ubboard .article-buttons .btn-open").click(function(){var e=a(this),h=e.attr("data-open"),i="confirm_article_open_y",j="open_conversion_1";if("0"==h){i="confirm_article_open_n";j="open_conversion_0"}var k=a("<button type='button'></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string(j,"ubboard"),body:M.util.get_string(i,"ubboard")},k).done(function(b){b.setSaveButtonText(M.util.get_string(j,"ubboard"));b.getRoot().on(c.save,function(c){c.preventDefault();var i=coursemostype+"=open&id="+f+"&bwid="+g+"&open="+h;a.ajax({url:d.action,data:i,success:function success(a){if(a.code==mesg.success){e.attr("data-open",a.open).text(a.text);b.hide()}else{alert(a.msg)}}})})});k.trigger("click");return!1})};d.defaultSetting=function(){a("#mformubboard #id_cancel").click(function(){history.back(-1);return!1})};d.category=function(b){a(".ubboard .lists .form-control-category").change(function(){var c=a(this).val(),d=M.cfg.wwwroot+"/mod/ubboard/view.php?id="+b;if(c){d+="&categoryid="+c}location.href=d})};d.categoryManage=function(f){a(".ubboard .btn-category-delete").each(function(){var e=a(this),g=a(this).data("title"),h=a(this).data("id");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_category_delete","ubboard",g)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(a){a.preventDefault();var b=coursemostype+"=categoryDelete&id="+f+"&categoryid="+h;formSubmit(d.action,b)})})});a(".ubboard .coursemos-sortable").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",handle:".orders",placeholder:"<tr class=\"placeholder\"/>",onDrop:function onDrop(b,c,e){e(b,c);var g=a(".ubboard .coursemos-sortable").sortable("serialize").get(),h=JSON.stringify(g,null," ");a.ajax({data:coursemostype+"=categorySortorder&id="+f+"&json="+h,url:d.action,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}})};d.comment=function(f,g){a("#ubboard-comment .form-validate").validate();a("#ubboard-comment .form-comment .btn-comment-cancel").click(function(){a("#ubboard-comment .form-control-comment").val("")});a("#ubboard-comment .btn-comment-modify").click(function(){var b=a(this).closest(".media-body").find(".comment-content");i(f,a(this).data("id"),b);return!1});a("#ubboard-comment .btn-comment-delete").each(function(){var e=a(this),h=a(this).data("id");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_comment_delete","ubboard")},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(a){a.preventDefault();var b=coursemostype+"=commentDelete&id="+f+"&bwid="+g+"&bcid="+h;formSubmit(d.action,b)})})});a("#ubboard-comment .btn-comment-reply").click(function(){var b=a(this).closest(".media-body").find(".comment-content");h(a(this).data("id"),b);return!1});function h(b,c){var d=j();a(d).find("input[name='"+coursemostype+"']").val("commentInsert");a(d).find("input[name='bcid']").val(b);a(d).find("textarea").val("");a(c).after(d)}function i(b,c,e){var f=j();a(f).find("input[name='"+coursemostype+"']").val("commentUpdate");a(f).find("input[name='bcid']").val(c);a(e).hide();a(e).after(f);var g=coursemostype+"=comment&id="+b+"&commentid="+c;a.ajax({url:d.action,data:g,type:"post",success:function success(b){if(b.code==mesg.success){a(f).find("textarea").val(b.comment);if(0<a(f).find(".form-control-nickname").length){a(f).find(".form-control-nickname").val(b.name)}}else{alert(b.msg);k()}return!1}})}function j(){var b=a("#form-comment-clone");if(0<b.length){a(b).parent().find(".comment-content").show()}else{b=a("<div id='form-comment-clone' />").append(a("#ubboard-comment .card-comment-form").clone());a("body").append(b);a("#form-comment-clone .form-validate").validate()}a(b).find(".btn-comment-cancel").unbind("click").click(function(){k()});return b}function k(){var b=a("#form-comment-clone");if(0<b.length){a(b).parent().find(".comment-content").show()}a(b).remove()}};d.list=function(b,c){a(".ubboard .paging-info .btn-alldownload").click(function(){a.fileDownload(a(this).prop("href")+"&isscript=1",{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("alldownload_loading","ubboard"))},successCallback:function successCallback(){hideSubmitProgress()},failCallback:function failCallback(a){alert(a)}});return!1});a(".ubboard .paging-info .form-control-ls").change(function(){var d=a(this).val();if(!a.isNumeric(d)){d=c}location.replace(M.cfg.wwwroot+"/mod/ubboard/view.php?id="+b+"&ls="+d)})};return d});
define ("mod_ubchat/chat",["jquery","theme_coursemos/bootstrap"],function(a){return{view:function(){a(".mod-ubchat .btn-log").click(function(){var b=a(this).attr("href");window.open(b,"ubchat_logs","width=800, height=600");return!1})}}});
define ("mod_ubgroup/group",["jquery","core/modal_factory","core/modal_events","theme_coursemos/jquery.validate","theme_coursemos/bootstrap","theme_coursemos/bootstrap-select","theme_coursemos/jquery.filedownload"],function(a,b,c){var d={};d.groups=function(f,g){a(".ubgroup input[name='allchecked']").click(function(){var b=a(this).is(":checked");a(".ubgroup input[name='groupids[]']").each(function(){if(!a(this).is(":disabled")){this.checked=b}})});a(document).on("click",".ubgroup .btn-not-registered",function(){var b=a(this),c=b.closest("tr").data("id");if(c!==void 0){a.ajax({url:"action.php",data:d.statusChangeParam(f,c,1),success:function success(a){if(a.code==mesg.success){b.removeClass("btn-not-registered btn-danger").addClass("btn-registered btn-info").text(M.util.get_string("group_registered","ubgroup"))}else{alert(a.msg)}}})}});a(document).on("click",".ubgroup .btn-registered",function(){var e=a(this),h=e.closest("tr"),i=h.data("id");if(i!==void 0){var j=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:h.data("name"),body:M.util.get_string("group_status_change_no","ubgroup",{name:"aa",url:g})},j).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("group_register_not","ubgroup"));b.getRoot().on(c.save,function(c){c.preventDefault();a.ajax({url:"action.php",data:d.statusChangeParam(f,i,0),success:function success(a){if(a.code==mesg.success){e.removeClass("btn-registered btn-info").addClass("btn-not-registered btn-danger").text(M.util.get_string("group_register_not","ubgroup"))}else{alert(a.msg)}}});b.hide()})});j.trigger("click")}});a(".ubgroup .btn-delete").each(function(){var d=a(this),e=d.closest("tr"),g=e.data("name"),h=e.data("id");if(h!=void 0){b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("group_delete_message","ubgroup",g)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({url:"action.php",data:coursemostype+"=delete&id="+f+"&groupid="+h,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg)}}})})})}});a(".ubgroup .btn-all-register").click(function(){d.checkStatusChange(1)});a(".ubgroup .btn-all-cancel").click(function(){d.checkStatusChange(0)});a(".ubgroup .btn-all-delete").click(function(){var d=a(".form-ubgroup input[name='groupids[]']:checked").length;if(0<d){var e=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("check_delete","ubgroup",d)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a(".form-ubgroup input[name='"+coursemostype+"']").val("checkDelete");a(".form-ubgroup").submit()})});e.trigger("click")}else{alert(M.util.get_string("notchecked","ubgroup"))}})};d.statusChangeParam=function(a,b,c){return coursemostype+"=statusChange&id="+a+"&groupid="+b+"&status="+c};d.checkStatusChange=function(d){var e,f,g,h;if("1"==d){f=e="group_register";g="info"}else{e="group_register_not";f="group_cancel";g="danger"}e=M.util.get_string(e,"ubgroup");f=M.util.get_string(f,"ubgroup");h="<span class=\"badge badge-size-default badge-"+g+"\">"+e+"</span>";var i=a(".form-ubgroup input[name='groupids[]']:checked").length;if(0<i){var j=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:f,body:M.util.get_string("check_status_change","ubgroup",{count:i,status:h})},j).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-"+g).text(f);b.getRoot().on(c.save,function(b){b.preventDefault();a(".form-ubgroup input[name='"+coursemostype+"']").val("checkStatusChange");a(".form-ubgroup input[name='status']").val(d);a(".form-ubgroup").submit()})});j.trigger("click")}else{alert(M.util.get_string("notchecked","ubgroup"))}};d.enrolmentkeyHtml=function(){var a="";a+="<div class=\"mt-4 container-fluid\">";a+="<div class=\"form-group row\">";a+="<div class=\"col-sm-3 col-form-label\">"+M.util.get_string("enrolmentkey","group")+"</div>";a+="<div class=\"col-sm-9\"><input type=\"password\" name=\"enrolkey\" class=\"form-control\" /></div>";a+="</div >";a+="</div >";return a};d.view=function(f,g){a(".ubgroup .btn-choice").each(function(){var e=a(this),g=e.closest(".card-group-info"),h=g.data("id");if(h!==void 0){var i="",j=!1;if(e.hasClass("btn-enrolmentkey")){i=d.enrolmentkeyHtml();j=!0}b.create({type:b.types.SAVE_CANCEL,title:e.text(),body:M.util.get_string("group_choice","ubgroup",g.data("name"))+i},e).done(function(b){b.setSaveButtonText(e.text());b.getRoot().on(c.save,function(b){b.preventDefault();var c=!0,d=null;if(j){var e=a("input[name='enrolkey']");d=e.val();if(""==d){alert(M.util.get_string("enrolkey_required","ubgroup"));e.focus();c=!1}}if(c){a.ajax({url:"action.php",data:coursemostype+"=choice&id="+f+"&groupid="+h+"&enrolkey="+d,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}location.replace(location.href)}})}})})}});a(".ubgroup .btn-choice-delete").each(function(){var d=a(this),e=d.closest(".card-group-info"),g=e.data("id");if(g!==void 0){b.create({type:b.types.SAVE_CANCEL,title:d.text(),body:M.util.get_string("group_choice_delete","ubgroup",e.data("name"))},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(d.text());b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({url:"action.php",data:coursemostype+"=choiceDelete&id="+f+"&groupid="+g,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}location.replace(location.href)}})})})}});a(".ubgroup .btn-group-add").click(function(b){if(a(this).hasClass("disabled")){b.preventDefault()}else{location.href=g}return!1});a(".ubgroup .btn-group-delete").each(function(){var d=a(this),e=d.closest(".card-group-info"),g=e.data("name"),h=e.data("id");if(h!=void 0&&!d.hasClass("disabled")){b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("group_delete","ubgroup"),body:M.util.get_string("group_delete_message_user","ubgroup",g)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("group_delete","ubgroup",g));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({url:"action.php",data:coursemostype+"=delete&id="+f+"&groupid="+h,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg)}}})})})}});a(".ubgroup .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})};d.response=function(b){a(".ubgroup .form-search").submit(function(){var b=a(".ubgroup .form-search select[name='groupid']").val(),c=a(".ubgroup .form-search select[name='userid']").val();if(""==b&&""==c){alert(M.util.get_string("group_search_required","ubgroup"));return!1}return!0});a(".ubgroup .form-search select[name='groupid']").change(function(){var c=a(this).val();a.ajax({url:"action.php",data:coursemostype+"=groupUsers&groupid="+c+"&id="+b,success:function success(b){if(b.code==mesg.success){var c=a(".ubgroup .form-search select[name='userid']");c.empty();c.append("<option value=\"\">"+M.util.get_string("select_user","ubgroup")+"</option>");if(0<b.users.length){a.each(b.users,function(a,b){c.append("<option value=\""+b.id+"\">"+b.fullname+"</option>")})}a(".ubgroup .form-search select[name='userid']").selectpicker("refresh")}else{alert(b.msg)}}})});a(".ubgroup .form-search select[name='userid']").selectpicker({style:"btn-default",liveSearch:!0});a(".ubgroup .form-search select[name='userid']").change(function(){a(".ubgroup .form-search .btn-submit").trigger("click")})};return d});
define ("mod_ubpeer/peer",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable","theme_coursemos/jquery.tableHeadFixer","theme_coursemos/jquery.filedownload"],function(a,b,c){var d={pluginname:"ubpeer"};d.options=function(f){a(".ubpeer .btn-options-add").click(function(){a("#modal-options form").each(function(){this.reset()});a("#modal-options input[name='"+coursemostype+"']").val("optionAdd");a("#modal-options").modal("show");a("#modal-options input[name='title']").focus()});a(".ubpeer .form-validate").validate();var e=a(".ubpeer .table-options").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",handle:".fa-arrows",placeholder:"<tr class=\"placeholder\"/>",onDrop:function onDrop(b,c,d){d(b,c);var g=e.sortable("serialize").get(0),h=JSON.stringify(g);a.ajax({data:coursemostype+"=optionSortable&id="+f+"&json="+h,url:"action.php",success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});a(".ubpeer .btn-modify").click(function(){var b=a(this).closest("tr");a("#modal-options input[name='poid']").val(b.data("poid"));a("#modal-options input[name='"+coursemostype+"']").val("optionUpdate");a("#modal-options input[name='title']").val(b.find(".td-title").text());a("#modal-options input[name='score']").val(b.find(".td-score").text());a("#modal-options").modal("show")});a(".ubpeer .btn-delete").each(function(){var e=a(this),g=e.closest("tr"),h=g.find(".td-title").text(),i=g.data("poid");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("options_confrim_delete",d.pluginname,h)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();var c=coursemostype+"=optionDelete&id="+f+"&poid="+i;a.ajax({url:"action.php",data:c,type:"post",success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg)}}})})})});b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("evaluation_reset",d.pluginname),body:M.util.get_string("evaluation_reset_confirm",d.pluginname)},a(".ubpeer .btn-evaluation-reset")).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("evaluation_reset",d.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();var c=coursemostype+"=evaluationReset&id="+f;a.ajax({url:"action.php",data:c,type:"post",success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{hideSubmitProgress();alert(a.msg)}}})})})};d.evaluation=function(f){a(".ubpeer .table-evaluation").each(function(){a(this).tableHeadFixer({head:!1,left:2})});a(".ubpeer .form-validate").validate({submitHandler:function submitHandler(a){showSubmitProgress();a.submit()}});a(".ubpeer .evaluationform .btn-max-batch").each(function(){var f=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("setting_max_score",d.pluginname),body:M.util.get_string("setting_max_score_help",d.pluginname)},f).done(function(b){b.setSaveButtonText(M.util.get_string("setting_max_score",d.pluginname));b.getRoot().on(c.save,function(c){c.preventDefault();f.closest(".evaluationform").find(".form-control-score").each(function(){if(""==a(this).val()){a(this).val(a(this).attr("max"))}});b.hide()})})});a(".ubpeer .btn-group-member").click(function(){var b=a(this).data("groupid");a.ajax({url:"action.php",data:coursemostype+"=groupMembers&id="+f+"&groupid="+b,type:"post",success:function success(b){if(b.code==mesg.success){a("#modal-group-member .groupmembers").html(b.html);a("#modal-group-member").modal("show")}else{alert(b.msg)}}})});b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("answer_delete_confirm",d.pluginname)},a(".ubpeer .btn-answer-delete")).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({url:"action.php",data:coursemostype+"=evaluationDelete&id="+f,type:"post",success:function success(a){if(a.code==mesg.success){location.replace(a.href)}else{alert(a.msg)}}})})})};d.result=function(f,e){a(".ubpeer .form-search .form-control-autosubmit").change(function(){a(".ubpeer .form-search").submit()});var g=e?3:4;a(".ubpeer .table-evaluation").tableHeadFixer({head:!1,left:g});a(".ubpeer .table-evaluation .btn-user-result").click(function(){var b=a(this).data("groupid"),c=a(this).data("targetid"),d=a(this).data("status");window.open(M.cfg.wwwroot+"/mod/ubpeer/result_popup.php?id="+f+"&groupid="+b+"&targetid="+c+"&status="+d,"result","width=1024, height=768px, scrollbars=1")});b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("grade_rereflected",d.pluginname),body:M.util.get_string("grade_rereflected_confirm",d.pluginname)},a(".ubpeer .btn-rereflected")).done(function(b){b.setSaveButtonText(M.util.get_string("grade_rereflected",d.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({url:"action.php",data:coursemostype+"=gradeReset&id="+f,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg)}}})})});a(".ubpeer .batch_button .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","ubpeer"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})};d.resultPopup=function(){a(".ubpeer .table-evaluation").each(function(){a(this).tableHeadFixer({head:!1,left:2})})};d.status=function(b){a(".ubpeer .form-search .form-control-autosubmit").change(function(){a(".ubpeer .form-search").submit()});a(".ubpeer .table-evaluation .btn-user-status").click(function(){var c=a(this).data("userid");window.open(M.cfg.wwwroot+"/mod/ubpeer/status_popup.php?id="+b+"&userid="+c,"status","width=1024,height=768px, scrollbars=1")});a(".ubpeer .table-evaluation-group").tableHeadFixer({head:!1,left:3})};return d});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("mod_vod/category",["jquery","core/modal_factory","core/modal_events","theme_coursemos/jstree"],function(a,b,c){var d={action:M.cfg.wwwroot+"/mod/vod/categoryAction.php",dragging:!1,splitLayout:function(){if(!a.fn.resizable){a.fn.resizable=function(b){var c={handleSelector:null,resizeWidth:!0,resizeHeight:!0,onStartDragging:null,onStopDragging:null,onDrag:null},d,f;if("object"==_typeof(b)){c=a.extend(c,b)}return this.each(function(){var i=a(this),j=a(c.handleSelector),k,l,m;function b(a){a.stopPropagation();a.preventDefault()}function e(j){d=j.clientX;f=j.clientY;k=parseInt(i.width(),10);l=parseInt(i.height(),10);console.log("start: width: "+k+" x: "+d);c.dragFunc=g;a(document).bind("mousemove.rsz",c.dragFunc);a(document).bind("mouseup.rsz",h);a(document).bind("selectstart.rsz",b);m=i.css("transition");i.css("transition","none");if(c.onStartDragging){c.onStartDragging(j)}}function g(a){var b=k+a.clientX-d;console.log("start: width: "+k+" x: "+d+" newidth: "+b);if(c.resizeWidth){i.width(b)}console.log("after: "+i.width());if(c.resizeHeight){i.height(l+a.clientY-f)}if(c.onDrag){c.onDrag(a)}}function h(d){d.stopPropagation();d.preventDefault();a(document).unbind("mousemove.rsz",c.dragFunc);a(document).unbind("mouseup.rsz",h);a(document).unbind("selectstart.rsz",b);i.css("transition",m);if(c.onStopDragging){c.onStopDragging(d)}return!1}i.addClass("resizable");j.bind("mousedown.rsz",e)})}}}};d.tree=function(e,f){console.log("tree");d.splitLayout();a(".col-tree").resizable({handleSelector:".col-splitter",resizeHeight:!1});a("#treeview").jstree({core:{check_callback:function check_callback(b,c,d){if("move_node"===b){console.log("node parent : "+c.parent+" , nodeParent.parent : "+d.parent);console.log("node");console.log(c);console.log("nodeParent");console.log(d);if(null===d.parent){return!1}if(c.parent===e+"top"||null!==d.parent&&0<=d.parent.indexOf(e)){var g=0,h=1,i=parseInt(a("#"+d.id).children(".jstree-anchor").attr("aria-level"));console.log(c);if(0<c.children_d.length){a.each(c.children_d,function(b,c){g=parseInt(a("#"+c).children(".jstree-anchor").attr("aria-level"));if(g>h){h=g}});console.log("current : "+i+", max : "+h);var j=h-a("#"+c.id).children(".jstree-anchor").attr("aria-level");console.log("moveLevel : "+j);console.log("targetAriaLevel + moveLevel : "+(i+j));if(i+j+1>f){return!1}}else{console.log("targetAriaLevel : "+i);if(i>=f){return!1}}}}return!0}},plugins:["contextmenu","dnd"],contextmenu:{items:function items(d){var e={create:{separator_before:!1,separator_after:!0,_disabled:!1,label:M.util.get_string("add","core"),action:function action(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.create_node(d,{},"last",function(a){c.edit(a,M.util.get_string("category_new_name","vod"),function(a,b,c){if(c){this.delete_node(a)}})})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:M.util.get_string("category_edit","vod"),action:function action(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.edit(d)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:M.util.get_string("delete","core"),action:function action(d){var e=a(d.reference),f=e.text(),g=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("category_delete","vod",f),body:M.util.get_string("category_delete_confirm","vod",f)},g).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(c){c.preventDefault();var e=a.jstree.reference(d.reference),f=e.get_node(d.reference);if(e.is_selected(f)){e.delete_node(e.get_selected())}else{e.delete_node(f)}b.hide()})});g.trigger("click")}}},g=a("#"+d.id),h=g.attr("aria-level");if(1==h){delete e.rename;delete e.remove}if(h>=f){delete e.create}return e}}}).bind("select_node.jstree",function(b,c){var e=d.treeNumber(c.node.id);a.ajax({url:d.action,data:coursemostype+"=vodLists&id="+e,success:function success(b){if(b.code==mesg.success){a(".col-contents").html(b.html)}else{alert(b.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}).bind("create_node.jstree",function(b,c){var f=null,g=d.treeNumber(c.node.parent);console.log("parent: "+g);a.ajax({url:d.action,data:coursemostype+"=add&parent="+g,success:function success(a){if(a.code==mesg.success){f=a.id;if(null!==f){console.log(c);c.instance.set_id(c.node,e+f)}else{c.instance.refresh()}}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));c.instance.refresh()}})}).bind("rename_node.jstree",function(b,c){console.log("rename node");console.log(c);var e=d.treeNumber(c.node.id),f=c.node.text;if(c.node.text!=c.node.old){a.ajax({url:d.action,data:coursemostype+"=nameUpdate&id="+e+"&name="+f,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));c.instance.refresh()}})}else{console.log("\uC774\uB984 \uB3D9\uC77C\uD568")}}).bind("delete_node.jstree",function(b,c){console.log("delete_node");var f=d.treeNumber(c.node.id);console.log("tree id : "+f);a.ajax({url:d.action,data:coursemostype+"=delete&id="+f,success:function success(a){if(a.code==mesg.success){console.log("delete success")}else{alert(a.msg)}c.instance.select_node(e+"top")},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}).bind("move_node.jstree",function(b,c){console.log("move_node.jstree");console.log(c);console.log("\uC774\uC804\uC704\uCE58: "+c.old_position+", \uC774\uC804 \uBD80\uBAA8: "+c.old_parent);console.log("\uC2E0\uADDC\uC704\uCE58: "+c.position+", \uC2E0\uADDC \uBD80\uBAA8: "+c.parent);var f=!1;if(c.old_parent!=c.parent||c.old_position!=c.position){f=!0}if(f){var g=d.treeNumber(c.node.id),h=c.parent;if(h===e+"top"){h=0}else{h=d.treeNumber(h)}var i=c.instance.get_node(c.parent),j="",k="";if(Array.isArray(i.children)){i.children.forEach(function(a){j+=k+d.treeNumber(a);k=","})}console.log("childSortorder: "+j);a.ajax({url:d.action,data:coursemostype+"=sortorder&id="+g+"&parent="+h+"&sortorder="+j,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));c.instance.refresh()}})}}).bind("hover_node.jstree",function(b,c){console.log("hover");console.log(c);a("#"+c.node.id).attr("title",c.node.text)});a("#treeview").jstree("open_all")};d.treeNumber=function(a){var b=a.replace(/[^0-9]/g,"");if(""==b){b=0}return b};return d});
define ("mod_vod/management",["jquery","jqueryui","theme_coursemos/bootstrap"],function(a){var b={isUploading:!1,moduleurl:M.cfg.wwwroot+"/mod/vod"};b.actionurl=b.moduleurl+"/action.php";b.transInterval=null;b.containerid="vod_container";b.attachboxid="attach_box";b.isCloud=!1;b.isPopup=!0;b.fileExt="asf, asx, avi, dat, flv, mkv, m2v, mov, mp4, mpg, mpeg, mpe, rm, vod, wmv";b.fileCount=5;b.fileSize=4294967296;b.maxFileSize=10737418240;b.uploadurl=null;b.isYoutube=null;b.ls=5;b.init=function(a,c,d){var e=a.wm_api_upload.replace("{fileid}","");b.uploadurl=a.wm_api_addr+e+a.wm_instanceid;b.fileCount=a.upload_count;b.fileSize=a.upload_size;b.maxFileSize=a.upload_total_size;b.fileExt=a.fileExt;b.isYoutube=a.isYoutube;b.isCloud=c;b.ls=d};b.mform=function(){b.modal();var c=a(".mform input[name='vuid']").val();if(""!=c&&0!=c){a("#id_selectcontentbtn").click(function(){b.modalViewSelect(c)})}else{a("#id_selectcontentbtn").click(function(){b.modalList()})}a("#id_uploadcontentbtn").click(function(){b.modalUpload()});a("#id_add_grade_item").change(function(){if(1==a(this).val()){a("#id_autograde").val(1)}else{a("#id_autograde").val(0)}})};b.modal=function(){if(0==a("#"+b.containerid).length){var c=a("<div id=\""+b.containerid+"\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\"></div>"),d=a("<div class=\"modal-dialog modal-xl\" role=\"document\"></div>"),e=a("<div class=\"modal-content\"></div>"),f=a("<div id=\"vod-hd\" class=\"modal-header\"></div>");f.append("<h5 class=\"modal-title\" id=\"myModalLabel\">"+M.util.get_string("vod_select","vod")+"</h5>");var g="<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">";g+="<span aria-hidden=\"true\">&times;</span>";g+="</button>";f.append(g);var h=a("<div id=\"vod-bd\" class=\"modal-body\"><div class=\"p-3\">Loading...</div></div>");e.append(f).append(h);d.append(e);c.append(d);a("body").append(c);a("#"+b.containerid).on("hide.bs.modal",function(){if(b.isUploading){alert(M.util.get_string("uploaded_cannot_be_move","vod"));return!1}else{return!0}})}};b.checkBodyClass=function(){if(!a("body").hasClass("modal-open")&&b.isPopup){a("body").addClass("modal-open")}};b.modalShow=function(){b.isUploading=!1;if(b.isPopup){a("#"+b.containerid).modal("show")}};b.modalList=function(c){b.stopInterval();b.modalShow();var d=b.moduleurl+"/_vod_list.php",e={};if(""!==b.ls){e.ls=b.ls}if(c!==void 0){e.categoryid=c}if(0<Object.keys(e).length){d+="?"+a.param(e)}a("#"+b.containerid+" .modal-body").load(d);b.checkBodyClass()};b.modalUpload=function(){b.stopInterval();b.modalShow();var c=b.moduleurl+"/_vod_list.php?upload=1";a("#"+b.containerid+" .modal-body").load(c);b.checkBodyClass()};b.modalView=function(c,d,e){b.stopInterval();b.modalShow();var f=b.moduleurl+"/_vod_info.php?id="+c;if(d!==void 0){f+="&iscoursemosadmin="+d}if(e!==void 0){f+="&categoryid="+e}var g=b.containerid+" .modal-body",h=!1;if(0<a("#"+g).children(".row-splitter").length){g+=" .col-contents"}else{h=!0}if(h){a("#"+g).load(f,function(){if(!a(this).hasClass("p-4")){a(this).addClass("p-4")}})}else{a("#"+g).load(f)}b.checkBodyClass()};b.modalViewSelect=function(c){b.stopInterval();b.modalShow();var d=b.moduleurl+"/_vod_list.php?vuid="+c;a("#"+b.containerid+" .modal-body").load(d);b.checkBodyClass()};b.modalMove=function(a){b.modalRedirect(a,!1)};b.modalColMove=function(a){b.modalRedirect(a,!0)};b.modalRedirect=function(c,d){b.stopInterval();b.isUploading=!1;var e="#"+b.containerid+" .modal-body";if(d){e+=" .col-contents"}a(e).load(c);b.checkBodyClass()};b.stopInterval=function(){clearInterval(b.transInterval)};b.modalHide=function(){b.stopInterval();a("#"+b.containerid).modal("hide")};b.transcoding=function(c,d){a(document).unbind("ajaxStart");b.transInterval=setInterval(function(){a.ajax({url:b.actionurl,data:coursemostype+"=transcoding&uuid="+c,success:function success(e){if(e.code==mesg.success){if(!e.convert.isError){var f=a("#vod_progress");f.find(".percent").text(e.convert.percent+" %");f.find(".progress-bar").css("width",e.convert.percent+"%");if(100<=e.convert.percent){clearInterval(b.transInterval);b.transComplete(c,d)}}var g=a(".vod_progress .convert-message");if(e.convert.isError){g.addClass("text-danger");var h="";if(e.convert.isWait){h=e.convert.waitMessage}a(".vod_progress .convert-wait-message").html(h)}else{g.removeClass("text-danger")}g.text(e.convert.message)}else{alert(e.msg)}return!0},error:function error(a,c,d){alert(d);clearInterval(b.transInterval)}})},3e3)};b.transComplete=function(c,d){a.ajax({url:b.actionurl,data:coursemostype+"=transComplete&uuid="+c,success:function success(a){if(a.code==mesg.success){b.modalColMove(d)}else{alert(a.msg)}return!1}})};b.setThumbnail=function(c,d){a.ajax({url:b.actionurl,data:coursemostype+"=thumb&vuid="+c+"&thumb="+d,success:function success(a){if(a.code==mesg.success){if(a.code!=mesg.success){alert(a.msg)}}else{alert(a.msg)}return!0}})};b.vodList=function(){b.isPopup=!1;b.modal();b.modalList()};return b});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}var MXI_DEBUG=!0;(function(e,t){var i=function(){var e={};t.apply(e,arguments);return e.moxie};if("function"==typeof define&&define.amd){define ("mod_vod/moxie",[],i)}else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){module.exports=i()}else{e.moxie=i()}})(this||window,function(){(function(e){"use strict";var o={};function t(e,t){for(var n,a=[],s=0;s<e.length;++s){n=o[e[s]]||r(e[s]);if(!n){throw"module definition dependecy not found: "+e[s]}a.push(n)}t.apply(null,a)}function i(e,i,n){if("string"!=typeof e){throw"invalid module definition, module id must be defined and be a string"}if(i===void 0){throw"invalid module definition, dependencies must be specified"}if(n===void 0){throw"invalid module definition, definition function must be specified"}t(i,function(){o[e]=n.apply(null,arguments)})}function n(e){return!!o[e]}function r(t){for(var i=e,n=t.split(/[.\/]/),r=0;r<n.length;++r){if(!i[n[r]]){return}i=i[n[r]]}return i}i("moxie/core/utils/Basic",[],function(){function e(e){var t;if(e===t){return"undefined"}else if(null===e){return"null"}else if(e.nodeType){return"node"}return{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function t(){return n(!1,!1,arguments)}function i(i){switch(e(i)){case"array":return Array.prototype.slice.call(i);case"object":return t({},i);}return i}function n(t,a,s){var d,l=s[0];r(s,function(s,u){if(0<u){r(s,function(r,s){var u=-1!==o(e(r),["array","object"]);if(r===d||t&&l[s]===d){return!0}if(u&&a){r=i(r)}if(e(l[s])===e(r)&&u){n(t,a,[l[s],r])}else{l[s]=r}})}});return l}function r(e,t){var n,r,o,a;if(e){try{n=e.length}catch(e){n=a}if(n===a||"number"!=typeof n){for(r in e){if(e.hasOwnProperty(r)){if(!1===t(e[r],r)){return}}}}else{for(o=0;o<n;o++){if(!1===t(e[o],o)){return}}}}}function o(e,t){if(t){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(t,e)}for(var n=0,r=t.length;n<r;n++){if(t[n]===e){return n}}}return-1}var a=function(){var e=0;return function(t){var n=new Date().getTime().toString(32),r;for(r=0;5>r;r++){n+=Math.floor(65535*Math.random()).toString(32)}return(t||"o_")+n+(e++).toString(32)}}();return{guid:a,typeOf:e,extend:t,extendIf:function(){return n(!0,!1,arguments)},extendImmutable:function(){return n(!1,!0,arguments)},extendImmutableIf:function(){return n(!0,!0,arguments)},clone:function(t){switch(e(t)){case"array":return n(!1,!0,[[],t]);case"object":return n(!1,!0,[{},t]);default:return t;}},inherit:function(e,t){for(var n in t){if({}.hasOwnProperty.call(t,n)){e[n]=t[n]}}function i(){this.constructor=e;if(MXI_DEBUG){var t=function(e){var t=e.toString().match(/^function\s([^\(\s]+)/);return t?t[1]:!1};this.ctorName=t(e)}}i.prototype=t.prototype;e.prototype=new i;e.parent=t.prototype;return e},each:r,isEmptyObj:function(t){if(!t||"object"!==e(t)){return!0}for(var i in t){return!1}return!0},inSeries:function(t,n){var o=t.length;if("function"!==e(n)){n=function(){}}if(!t||!t.length){n()}function r(a){if("function"===e(t[a])){t[a](function(e){++a<o&&!e?r(a):n(e)})}}r(0)},inParallel:function(e,t){var n=0,o=e.length,a=Array(o);r(e,function(e,r){e(function(e){if(e){return t(e)}var i=[].slice.call(arguments);i.shift();a[r]=i;n++;if(n===o){a.unshift(null);t.apply(this,a)}})})},inArray:o,arrayDiff:function(t,n){var r=[];if("array"!==e(t)){t=[t]}if("array"!==e(n)){n=[n]}for(var a in t){if(-1===o(t[a],n)){r.push(t[a])}}return r.length?r:!1},arrayIntersect:function(e,t){var i=[];r(e,function(e){if(-1!==o(e,t)){i.push(e)}});return i.length?i:null},toArray:function(e){var t,n=[];for(t=0;t<e.length;t++){n[t]=e[t]}return n},trim:function(e){if(!e){return e}return String.prototype.trim?String.prototype.trim.call(e):e.toString().replace(/^\s*/,"").replace(/\s*$/,"")},sprintf:function(e){var t=[].slice.call(arguments,1);return e.replace(/%([a-z])/g,function(e,i){var n=t.shift();switch(i){case"s":return n+"";case"d":return parseInt(n,10);case"f":return parseFloat(n);case"c":return"";default:return n;}})},parseSizeStr:function(e){if("string"!=typeof e){return e}var t={t:1099511627776,g:1073741824,m:1048576,k:1024},i;e=/^([0-9\.]+)([tmgk]?)$/.exec(e.toLowerCase().replace(/[^0-9\.tmkg]/g,""));i=e[2];e=+e[1];if(t.hasOwnProperty(i)){e*=t[i]}return Math.floor(e)},delay:function(e,t){var i=this;setTimeout(function(){e.call(i)},t||1)}}});i("moxie/core/utils/Encode",[],function(){var e=function(e){return unescape(encodeURIComponent(e))},t=function(e){return decodeURIComponent(escape(e))};return{utf8_encode:e,utf8_decode:t,atob:function atob(e,n){if("function"==typeof window.atob){return n?t(window.atob(e)):window.atob(e)}var r,o,a,s,d,l,u,m,c=0,p=0,g="",h=[];if(!e){return e}e+="";do{s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(c++));d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(c++));l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(c++));u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(c++));m=s<<18|d<<12|l<<6|u;r=255&m>>16;o=255&m>>8;a=255&m;if(64==l){h[p++]=String.fromCharCode(r)}else if(64==u){h[p++]=String.fromCharCode(r,o)}else{h[p++]=String.fromCharCode(r,o,a)}}while(c<e.length);g=h.join("");return n?t(g):g},btoa:function btoa(t,n){if(n){t=e(t)}if("function"==typeof window.btoa){return window.btoa(t)}var o,a,s,d,l,u,m,c,p=0,g=0,h="",f=[];if(!t){return t}do{o=t.charCodeAt(p++);a=t.charCodeAt(p++);s=t.charCodeAt(p++);c=o<<16|a<<8|s;d=63&c>>18;l=63&c>>12;u=63&c>>6;m=63&c;f[g++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(u)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)}while(p<t.length);h=f.join("");var x=t.length%3;return(x?h.slice(0,x-3):h)+"===".slice(x||3)}}});i("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(e){var t=function(){var e={has:function has(e,t){return-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function lowerize(e){return e.toLowerCase()}},t={rgx:function rgx(){for(var e,t=0,n,r,o,a,s,d,l=arguments;t<l.length;t+=2){var u=l[t],m=l[t+1];if(_typeof(e)==="undefined"){e={};for(o in m){a=m[o];if(_typeof(a)==="object"){e[a[0]]=void 0}else{e[a]=void 0}}}for(n=r=0;n<u.length;n++){s=u[n].exec(this.getUA());if(!!s){for(o=0;o<m.length;o++){d=s[++r];a=m[o];if(_typeof(a)==="object"&&0<a.length){if(2==a.length){if(_typeof(a[1])=="function"){e[a[0]]=a[1].call(this,d)}else{e[a[0]]=a[1]}}else if(3==a.length){if(_typeof(a[1])==="function"&&!(a[1].exec&&a[1].test)){e[a[0]]=d?a[1].call(this,d,a[2]):void 0}else{e[a[0]]=d?d.replace(a[1],a[2]):void 0}}else if(4==a.length){e[a[0]]=d?a[3].call(this,d.replace(a[1],a[2])):void 0}}else{e[a]=d?d:void 0}}break}}if(!!s)break}return e},str:function str(t,n){for(var r in n){if(_typeof(n[r])==="object"&&0<n[r].length){for(var i=0;i<n[r].length;i++){if(e.has(n[r][i],t)){return r==="?"?void 0:r}}}else if(e.has(n[r],t)){return r==="?"?void 0:r}}return t}},i={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},n={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],["name","version"],[/\s(opr)\/([\w\.]+)/i],[["name","Opera"],"version"],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],["name","version"],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[["name","IE"],"version"],[/(edge)\/((\d+)?[\w\.]+)/i],["name","version"],[/(yabrowser)\/([\w\.]+)/i],[["name","Yandex"],"version"],[/(comodo_dragon)\/([\w\.]+)/i],[["name",/_/g," "],"version"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],["name","version"],[/(dolfin)\/([\w\.]+)/i],[["name","Dolphin"],"version"],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[["name","Chrome"],"version"],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],["version",["name","MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],["version",["name","Android Browser"]],[/FBAV\/([\w\.]+);/i],["version",["name","Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],["version",["name","Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],["version","name"],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],["name",["version",t.str,i.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],["name","version"],[/(navigator|netscape)\/([\w\.-]+)/i],[["name","Netscape"],"version"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],["name","version"]],engine:[[/windows.+\sedge\/([\w\.]+)/i],["version",["name","EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],["version","name"]],os:[[/microsoft\s(windows)\s(vista|xp)/i],["name","version"],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",t.str,i.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",t.str,i.os.windows.version]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name","Symbian"],"version"],[/\((series40);/i],["name"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[["name","Mac OS"],["version",/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]]};return function UAParser(e){var i=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"");this.getBrowser=function(){return t.rgx.apply(this,n.browser)};this.getEngine=function(){return t.rgx.apply(this,n.engine)};this.getOS=function(){return t.rgx.apply(this,n.os)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return i};this.setUA=function(e){i=e;return this};this.setUA(i)}}();var i=function(){var t={access_global_ns:function access_global_ns(){return!!window.moxie},define_property:function(){return!1}(),create_canvas:function create_canvas(){var e=document.createElement("canvas"),i=!!(e.getContext&&e.getContext("2d"));t.create_canvas=i;return i},return_response_type:function return_response_type(t){try{if(-1!==e.inArray(t,["","text","document"])){return!0}else if(window.XMLHttpRequest){var i=new XMLHttpRequest;i.open("get","/");if("responseType"in i){i.responseType=t;if(i.responseType!==t){return!1}return!0}}}catch(e){}return!1},use_blob_uri:function use_blob_uri(){var e=window.URL;t.use_blob_uri=e&&"createObjectURL"in e&&"revokeObjectURL"in e&&("IE"!==r.browser||r.verComp(r.version,"11.0.46",">="));return t.use_blob_uri},use_data_uri:function(){var e=new Image;e.onload=function(){t.use_data_uri=1===e.width&&1===e.height};setTimeout(function(){e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1);return!1}(),use_data_uri_over32kb:function use_data_uri_over32kb(){return t.use_data_uri&&("IE"!==r.browser||9<=r.version)},use_data_uri_of:function use_data_uri_of(e){return t.use_data_uri&&33e3>e||t.use_data_uri_over32kb()},use_fileinput:function use_fileinput(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/)){return!1}var e=document.createElement("input");e.setAttribute("type","file");return t.use_fileinput=!e.disabled},use_webgl:function use_webgl(){var e=document.createElement("canvas"),i=null,n;try{i=e.getContext("webgl")||e.getContext("experimental-webgl")}catch(t){}if(!i){i=null}n=!!i;t.use_webgl=n;e=void 0;return n}};return function(i){var n=[].slice.call(arguments);n.shift();return"function"===e.typeOf(t[i])?t[i].apply(this,n):!!t[i]}}(),n=new t().getResult(),r={can:i,uaParser:t,browser:n.browser.name,version:n.browser.version,os:n.os.name,osVersion:n.os.version,verComp:function(e,t,n){var r=0,o=0,a=0,s={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},d=function(e){e=(""+e).replace(/[_\-+]/g,".");e=e.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return!e.length?[-8]:e.split(".")},l=function(e){return!e?0:isNaN(e)?s[e]||-7:parseInt(e,10)};e=d(e);t=d(t);o=Math.max(e.length,t.length);for(r=0;r<o;r++){if(e[r]==t[r]){continue}e[r]=l(e[r]);t[r]=l(t[r]);if(e[r]<t[r]){a=-1;break}else if(e[r]>t[r]){a=1;break}}if(!n){return a}switch(n){case">":case"gt":return 0<a;case">=":case"ge":return 0<=a;case"<=":case"le":return 0>=a;case"==":case"=":case"eq":return 0===a;case"<>":case"!=":case"ne":return 0!==a;case"":case"<":case"lt":return 0>a;default:return null;}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};r.OS=r.os;if(MXI_DEBUG){r.debug={runtime:!0,events:!1};r.log=function(){function t(e){i.appendChild(document.createTextNode(e+"\n"))}if(window&&window.console&&window.console.log&&window.console.log.apply){window.console.log.apply(window.console,arguments)}else if(document){var i=document.getElementById("moxie-console");if(!i){i=document.createElement("pre");i.id="moxie-console";document.body.appendChild(i)}var n=arguments[0];if("string"===e.typeOf(n)){n=e.sprintf.apply(this,arguments)}else if(-1!==e.inArray(e.typeOf(n),["object","array"])){t(n);return}i.appendChild(document.createTextNode(n+"\n"))}}}return r});i("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(e){function t(e,t){for(var i in e){if(e[i]===t){return i}}return null}return{RuntimeError:function(){var n={NOT_INIT_ERR:1,EXCEPTION_ERR:3,NOT_SUPPORTED_ERR:9,JS_ERR:4};function i(e,i){this.code=e;this.name=t(n,e);this.message=this.name+(i||": RuntimeError "+this.code)}e.extend(i,n);i.prototype=Error.prototype;return i}(),OperationNotAllowedException:function(){function t(e){this.code=e;this.name="OperationNotAllowedException"}e.extend(t,{NOT_ALLOWED_ERR:1});t.prototype=Error.prototype;return t}(),ImageError:function(){var n={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};function i(e){this.code=e;this.name=t(n,e);this.message=this.name+": ImageError "+this.code}e.extend(i,n);i.prototype=Error.prototype;return i}(),FileException:function(){var n={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};function i(e){this.code=e;this.name=t(n,e);this.message=this.name+": FileException "+this.code}e.extend(i,n);i.prototype=Error.prototype;return i}(),DOMException:function(){var n={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function i(e){this.code=e;this.name=t(n,e);this.message=this.name+": DOMException "+this.code}e.extend(i,n);i.prototype=Error.prototype;return i}(),EventException:function(){function t(e){this.code=e;this.name="EventException"}e.extend(t,{UNSPECIFIED_EVENT_TYPE_ERR:0});t.prototype=Error.prototype;return t}()}});i("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(e){var t=function(e,t){if(!e.className){return!1}var i=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return i.test(e.className)};return{get:function get(e){if("string"!=typeof e){return e}return document.getElementById(e)},hasClass:t,addClass:function addClass(e,i){if(!t(e,i)){e.className=!e.className?i:e.className.replace(/\s+$/,"")+" "+i}},removeClass:function removeClass(e,t){if(e.className){var i=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(i,function(e,t,i){return" "===t&&" "===i?" ":""})}},getStyle:function getStyle(e,t){if(e.currentStyle){return e.currentStyle[t]}else if(window.getComputedStyle){return window.getComputedStyle(e,null)[t]}},getPos:function getPos(t,i){var r=0,o=0,a,s=document,d,l;t=t;i=i||s.body;function n(e){var t,i,n=0,r=0;if(e){i=e.getBoundingClientRect();t="CSS1Compat"===s.compatMode?s.documentElement:s.body;n=i.left+t.scrollLeft;r=i.top+t.scrollTop}return{x:n,y:r}}if(t&&t.getBoundingClientRect&&"IE"===e.browser&&(!s.documentMode||8>s.documentMode)){d=n(t);l=n(i);return{x:d.x-l.x,y:d.y-l.y}}a=t;while(a&&a!=i&&a.nodeType){r+=a.offsetLeft||0;o+=a.offsetTop||0;a=a.offsetParent}a=t.parentNode;while(a&&a!=i&&a.nodeType){r-=a.scrollLeft||0;o-=a.scrollTop||0;a=a.parentNode}return{x:r,y:o}},getSize:function getSize(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}}}});i("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(e,t,i){var r={};function n(){this.uid=i.guid()}i.extend(n.prototype,{init:function init(){if(!this.uid){this.uid=i.guid("uid_")}},addEventListener:function addEventListener(e,t,n,o){var a=this,s;if(!this.hasOwnProperty("uid")){this.uid=i.guid("uid_")}e=i.trim(e);if(/\s/.test(e)){i.each(e.split(/\s+/),function(e){a.addEventListener(e,t,n,o)});return}e=e.toLowerCase();n=parseInt(n,10)||0;s=r[this.uid]&&r[this.uid][e]||[];s.push({fn:t,priority:n,scope:o||this});if(!r[this.uid]){r[this.uid]={}}r[this.uid][e]=s},hasEventListener:function hasEventListener(e){var t;if(e){e=e.toLowerCase();t=r[this.uid]&&r[this.uid][e]}else{t=r[this.uid]}return t?t:!1},removeEventListener:function removeEventListener(e,t){var n=this,o,a;e=e.toLowerCase();if(/\s/.test(e)){i.each(e.split(/\s+/),function(e){n.removeEventListener(e,t)});return}o=r[this.uid]&&r[this.uid][e];if(o){if(t){for(a=o.length-1;0<=a;a--){if(o[a].fn===t){o.splice(a,1);break}}}else{o=[]}if(!o.length){delete r[this.uid][e];if(i.isEmptyObj(r[this.uid])){delete r[this.uid]}}}},removeAllEventListeners:function removeAllEventListeners(){if(r[this.uid]){delete r[this.uid]}},dispatchEvent:function dispatchEvent(n){var o,a,s,d,l={},u=!0,m;if("string"!==i.typeOf(n)){d=n;if("string"===i.typeOf(d.type)){n=d.type;if(d.total!==m&&d.loaded!==m){l.total=d.total;l.loaded=d.loaded}l.async=d.async||!1}else{throw new t.EventException(t.EventException.UNSPECIFIED_EVENT_TYPE_ERR)}}if(-1!==n.indexOf("::")){(function(e){o=e[0];n=e[1]})(n.split("::"))}else{o=this.uid}n=n.toLowerCase();a=r[o]&&r[o][n];if(a){a.sort(function(e,t){return t.priority-e.priority});s=[].slice.call(arguments);s.shift();l.type=n;s.unshift(l);if(MXI_DEBUG&&e.debug.events){e.log("%cEvent '%s' fired on %s","color: #999;",l.type,(this.ctorName?this.ctorName+"::":"")+o)}var c=[];i.each(a,function(e){s[0].target=e.scope;if(l.async){c.push(function(t){setTimeout(function(){t(!1===e.fn.apply(e.scope,s))},1)})}else{c.push(function(t){t(!1===e.fn.apply(e.scope,s))})}});if(c.length){i.inSeries(c,function(e){u=!e})}}return u},bindOnce:function bindOnce(e,t,i,n){var r=this;r.bind.call(this,e,function i(){r.unbind(e,i);return t.apply(this,arguments)},i,n)},bind:function bind(){this.addEventListener.apply(this,arguments)},unbind:function unbind(){this.removeEventListener.apply(this,arguments)},unbindAll:function unbindAll(){this.removeAllEventListeners.apply(this,arguments)},trigger:function trigger(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function handleEventProps(e){var t=this;this.bind(e.join(" "),function(t){var e="on"+t.type.toLowerCase();if("function"===i.typeOf(this[e])){this[e].apply(this,arguments)}});i.each(e,function(e){e="on"+e.toLowerCase(e);if("undefined"===i.typeOf(t[e])){t[e]=null}})}});n.instance=new n;return n});i("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(e,t,i,n){var o={},a={};function r(n,o,s,d,l){var u=this,m,c=t.guid(o+"_"),p=l||"browser";n=n||{};a[c]=this;s=t.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},s);if(n.preferred_caps){p=r.getMode(d,n.preferred_caps,p)}if(MXI_DEBUG&&e.debug.runtime){e.log("\tdefault mode: %s",p)}m=function(){var e={};return{exec:function exec(t,i,n,r){if(m[i]){if(!e[t]){e[t]={context:this,instance:new m[i]}}if(e[t].instance[n]){return e[t].instance[n].apply(this,r)}}},removeInstance:function removeInstance(t){delete e[t]},removeAllInstances:function removeAllInstances(){var i=this;t.each(e,function(e,n){if("function"===t.typeOf(e.instance.destroy)){e.instance.destroy.call(e.context)}i.removeInstance(n)})}}}();t.extend(this,{initialized:!1,uid:c,type:o,mode:r.getMode(d,n.required_caps,p),shimid:c+"_container",clients:0,options:n,can:function can(e,i){var n=arguments[2]||s;if("string"===t.typeOf(e)&&"undefined"===t.typeOf(i)){e=r.parseCaps(e)}if("object"===t.typeOf(e)){for(var o in e){if(!this.can(o,e[o],n)){return!1}}return!0}if("function"===t.typeOf(n[e])){return n[e].call(this,i)}else{return i===n[e]}},getShimContainer:function getShimContainer(){var e,n=i.get(this.shimid);if(!n){e=i.get(this.options.container)||document.body;n=document.createElement("div");n.id=this.shimid;n.className="moxie-shim moxie-shim-"+this.type;t.extend(n.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"});e.appendChild(n);e=null}return n},getShim:function getShim(){return m},shimExec:function shimExec(e,t){var i=[].slice.call(arguments,2);return u.getShim().exec.call(this,this.uid,e,t,i)},exec:function exec(e,t){var i=[].slice.call(arguments,2);if(u[e]&&u[e][t]){return u[e][t].apply(this,i)}return u.shimExec.apply(this,arguments)},destroy:function destroy(){if(!u){return}var e=i.get(this.shimid);if(e){e.parentNode.removeChild(e)}if(m){m.removeAllInstances()}this.unbindAll();delete a[this.uid];this.uid=null;c=u=m=e=null}});if(this.mode&&n.required_caps&&!this.can(n.required_caps)){this.mode=!1}}r.order="html5,flash,silverlight,html4";r.getRuntime=function(e){return a[e]?a[e]:!1};r.addConstructor=function(e,t){t.prototype=n.instance;o[e]=t};r.getConstructor=function(e){return o[e]||null};r.getInfo=function(e){var t=r.getRuntime(e);if(t){return{uid:t.uid,type:t.type,mode:t.mode,can:function can(){return t.can.apply(t,arguments)}}}return null};r.parseCaps=function(e){var i={};if("string"!==t.typeOf(e)){return e||{}}t.each(e.split(","),function(e){i[e]=!0});return i};r.can=function(e,t){var i,n=r.getConstructor(e),o;if(n){i=new n({required_caps:t});o=i.mode;i.destroy();return!!o}return!1};r.thatCan=function(e,t){var n=(t||r.order).split(/\s*,\s*/);for(var o in n){if(r.can(n[o],e)){return n[o]}}return null};r.getMode=function(i,n,r){var o=null;if("undefined"===t.typeOf(r)){r="browser"}if(n&&!t.isEmptyObj(i)){t.each(n,function(n,r){if(i.hasOwnProperty(r)){var a=i[r](n);if("string"==typeof a){a=[a]}if(!o){o=a}else if(!(o=t.arrayIntersect(o,a))){if(MXI_DEBUG&&e.debug.runtime){e.log("\t\t%s: %s (conflicting mode requested: %s)",r,n,a)}return o=!1}}if(MXI_DEBUG&&e.debug.runtime){e.log("\t\t%s: %s (compatible modes: %s)",r,n,o)}});if(o){return-1!==t.inArray(r,o)?r:o[0]}else if(!1===o){return!1}}return r};r.getGlobalEventTarget=function(){if(/^moxie\./.test(e.global_event_dispatcher)&&!e.can("access_global_ns")){var i=t.guid("moxie_event_target_");window[i]=function(t,e){n.instance.dispatchEvent(t,e)};e.global_event_dispatcher=i}return e.global_event_dispatcher};r.capTrue=function(){return!0};r.capFalse=function(){return!1};r.capTest=function(e){return function(){return!!e}};return r});i("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(t,i,e,n){return function(){var r;e.extend(this,{connectRuntime:function connectRuntime(o){var s=this,d;function a(e){var d,l;if(!e.length){s.trigger("RuntimeError",new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR));r=null;return}d=e.shift().toLowerCase();l=n.getConstructor(d);if(!l){if(MXI_DEBUG&&t.debug.runtime){t.log("Constructor for '%s' runtime is not available.",d)}a(e);return}if(MXI_DEBUG&&t.debug.runtime){t.log("Trying runtime: %s",d);t.log(o)}r=new l(o);r.bind("Init",function(){r.initialized=!0;if(MXI_DEBUG&&t.debug.runtime){t.log("Runtime '%s' initialized",r.type)}setTimeout(function(){r.clients++;s.ruid=r.uid;s.trigger("RuntimeInit",r)},1)});r.bind("Error",function(){if(MXI_DEBUG&&t.debug.runtime){t.log("Runtime '%s' failed to initialize",r.type)}r.destroy();a(e)});r.bind("Exception",function(n,e){var r=e.name+"(#"+e.code+")"+(e.message?", from: "+e.message:"");if(MXI_DEBUG&&t.debug.runtime){t.log("Runtime '%s' has thrown an exception: %s",this.type,r)}s.trigger("RuntimeError",new i.RuntimeError(i.RuntimeError.EXCEPTION_ERR,r))});if(MXI_DEBUG&&t.debug.runtime){t.log("\tselected mode: %s",r.mode)}if(!r.mode){r.trigger("Error");return}r.init()}if("string"===e.typeOf(o)){d=o}else if("string"===e.typeOf(o.ruid)){d=o.ruid}if(d){r=n.getRuntime(d);if(r){s.ruid=d;r.clients++;return r}else{throw new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR)}}a((o.runtime_order||n.order).split(/\s*,\s*/))},disconnectRuntime:function disconnectRuntime(){if(r&&0>=--r.clients){r.destroy()}r=null},getRuntime:function getRuntime(){if(r&&r.uid){return r}return r=null},exec:function exec(){return r?r.exec.apply(this,arguments):null},can:function can(e){return r?r.can(e):!1}})}});i("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(e,t,i){var r={};function n(o,a){function s(t,i,o){var a,s=r[this.uid];if("string"!==e.typeOf(s)||!s.length){return null}a=new n(null,{type:o,size:i-t});a.detach(s.substr(t,a.size));return a}i.call(this);if(o){this.connectRuntime(o)}if(!a){a={}}else if("string"===e.typeOf(a)){a={data:a}}e.extend(this,{uid:a.uid||e.guid("uid_"),ruid:o,size:a.size||0,type:a.type||"",slice:function slice(e,t,i){if(this.isDetached()){return s.apply(this,arguments)}return this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),e,t,i)},getSource:function getSource(){if(!r[this.uid]){return null}return r[this.uid]},detach:function detach(e){if(this.ruid){this.getRuntime().exec.call(this,"Blob","destroy");this.disconnectRuntime();this.ruid=null}e=e||"";if("data:"==e.substr(0,5)){var i=e.indexOf(";base64,");this.type=e.substring(5,i);e=t.atob(e.substring(i+8))}this.size=e.length;r[this.uid]=e},isDetached:function isDetached(){return!this.ruid&&"string"===e.typeOf(r[this.uid])},destroy:function destroy(){this.detach();delete r[this.uid]}});if(a.data){this.detach(a.data)}else{r[this.uid]=a}}return n});i("moxie/core/I18n",["moxie/core/utils/Basic"],function(e){var t={};return{addI18n:function addI18n(i){return e.extend(t,i)},translate:function translate(e){return t[e]||e},_:function _(e){return this.translate(e)},sprintf:function sprintf(t){var i=[].slice.call(arguments,1);return t.replace(/%[a-z]/g,function(){var t=i.shift();return"undefined"!==e.typeOf(t)?t:""})}}});i("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(e,t){var n={},r={},o=function(e){var t=e.split(/,/),o,a,s;for(o=0;o<t.length;o+=2){s=t[o+1].split(/ /);for(a=0;a<s.length;a++){n[s[a]]=t[o]}r[t[o]]=s}},a=function(t){var i=[];e.each(t,function(t){t=t.toLowerCase();if("*"===t){i=[];return!1}var n=t.match(/^(\w+)\/(\*|\w+)$/);if(n){if("*"===n[2]){e.each(r,function(e,t){if(new RegExp("^"+n[1]+"/").test(t)){[].push.apply(i,r[t])}})}else if(r[t]){[].push.apply(i,r[t])}}});return i},s=function(e){var t=e&&e.match(/\.([^.]+)$/);if(t){return t[1].toLowerCase()}return""};o("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb xlt xla,application/vnd.ms-powerpoint,ppt pps pot ppa,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");return{mimes:n,extensions:r,addMimeType:o,extList2mimes:function extList2mimes(t,n){var r,o,a,s,d=[];for(o=0;o<t.length;o++){r=t[o].extensions.toLowerCase().split(/\s*,\s*/);for(a=0;a<r.length;a++){if("*"===r[a]){return[]}s=d[r[a]];if(n&&/^\w+$/.test(r[a])){d.push("."+r[a])}else if(s&&-1===e.inArray(s,d)){d.push(s)}else if(!s){return[]}}}return d},mimes2exts:a,mimes2extList:function mimes2extList(i){var n=[],r=[];if("string"===e.typeOf(i)){i=e.trim(i).split(/\s*,\s*/)}r=a(i);n.push({title:t.translate("Files"),extensions:r.length?r.join(","):"*"});return n},getFileExtension:s,getFileMime:function getFileMime(e){return n[s(e)]||""}}});i("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(e,t,i,n,r,o,a,s,d){var u=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];function l(o){if(MXI_DEBUG){t.log("Instantiating FileInput...")}var l,m,c;if(-1!==e.inArray(e.typeOf(o),["string","node"])){o={browse_button:o}}m=n.get(o.browse_button);if(!m){throw new r.DOMException(r.DOMException.NOT_FOUND_ERR)}c={accept:[{title:a.translate("All Files"),extensions:"*"}],multiple:!1,required_caps:!1,container:m.parentNode||document.body};o=e.extend({},c,o);if("string"==typeof o.required_caps){o.required_caps=s.parseCaps(o.required_caps)}if("string"==typeof o.accept){o.accept=i.mimes2extList(o.accept)}l=n.get(o.container);if(!l){l=document.body}if("static"===n.getStyle(l,"position")){l.style.position="relative"}l=m=null;d.call(this);e.extend(this,{uid:e.guid("uid_"),ruid:null,shimid:null,files:null,init:function init(){var t=this;t.bind("RuntimeInit",function(i,r){t.ruid=r.uid;t.shimid=r.shimid;t.bind("Ready",function(){t.trigger("Refresh")},999);t.bind("Refresh",function(){var t,i,a,s,d;a=n.get(o.browse_button);s=n.get(r.shimid);if(a){t=n.getPos(a,n.get(o.container));i=n.getSize(a);d=parseInt(n.getStyle(a,"z-index"),10)||0;if(s){e.extend(s.style,{top:t.y+"px",left:t.x+"px",width:i.w+"px",height:i.h+"px",zIndex:d+1})}}s=a=null});r.exec.call(t,"FileInput","init",o)});t.connectRuntime(e.extend({},o,{required_caps:{select_file:!0}}))},getOption:function getOption(e){return o[e]},setOption:function setOption(e,t){if(!o.hasOwnProperty(e)){return}var n=o[e];switch(e){case"accept":if("string"==typeof t){t=i.mimes2extList(t)}break;case"container":case"required_caps":throw new r.FileException(r.FileException.NO_MODIFICATION_ALLOWED_ERR);}o[e]=t;this.exec("FileInput","setOption",e,t);this.trigger("OptionChanged",e,t,n)},disable:function disable(t){var i=this.getRuntime();if(i){this.exec("FileInput","disable","undefined"===e.typeOf(t)?!0:t)}},refresh:function refresh(){this.trigger("Refresh")},destroy:function destroy(){var t=this.getRuntime();if(t){t.exec.call(this,"FileInput","destroy");this.disconnectRuntime()}if("array"===e.typeOf(this.files)){e.each(this.files,function(e){e.destroy()})}this.files=null;this.unbindAll()}});this.handleEventProps(u)}l.prototype=o.instance;return l});i("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(e,t,i){function n(n,r){if(!r){r={}}i.apply(this,arguments);if(!this.type){this.type=t.getFileMime(r.name)}var o;if(r.name){o=r.name.replace(/\\/g,"/");o=o.substr(o.lastIndexOf("/")+1)}else if(this.type){var a=this.type.split("/")[0];o=e.guid((""!==a?a:"file")+"_");if(t.extensions[this.type]){o+="."+t.extensions[this.type][0]}}e.extend(this,{name:o||e.guid("file_"),relativePath:"",lastModifiedDate:r.lastModifiedDate||new Date().toLocaleString()})}n.prototype=i.prototype;return n});i("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/core/utils/Env","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(e,t,i,n,r,o,a,s,d){var u=["ready","dragenter","dragleave","drop","error"];function l(i){if(MXI_DEBUG){r.log("Instantiating FileDrop...")}var o=this,s;if("string"==typeof i){i={drop_zone:i}}s={accept:[{title:e.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};i="object"===_typeof(i)?n.extend({},s,i):s;i.container=t.get(i.drop_zone)||document.body;if("static"===t.getStyle(i.container,"position")){i.container.style.position="relative"}if("string"==typeof i.accept){i.accept=d.mimes2extList(i.accept)}a.call(o);n.extend(o,{uid:n.guid("uid_"),ruid:null,files:null,init:function init(){o.bind("RuntimeInit",function(t,e){o.ruid=e.uid;e.exec.call(o,"FileDrop","init",i);o.dispatchEvent("ready")});o.connectRuntime(i)},destroy:function destroy(){var e=this.getRuntime();if(e){e.exec.call(this,"FileDrop","destroy");this.disconnectRuntime()}this.files=null;this.unbindAll()}});this.handleEventProps(u)}l.prototype=s.instance;return l});i("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/runtime/RuntimeClient"],function(e,t,i,n,r,o){var s=["loadstart","progress","load","abort","error","loadend"];function a(){o.call(this);e.extend(this,{uid:e.guid("uid_"),readyState:a.EMPTY,result:null,error:null,readAsBinaryString:function readAsBinaryString(e){n.call(this,"readAsBinaryString",e)},readAsDataURL:function readAsDataURL(e){n.call(this,"readAsDataURL",e)},readAsText:function readAsText(e){n.call(this,"readAsText",e)},abort:function abort(){this.result=null;if(-1!==e.inArray(this.readyState,[a.EMPTY,a.DONE])){return}else if(this.readyState===a.LOADING){this.readyState=a.DONE}this.exec("FileReader","abort");this.trigger("abort");this.trigger("loadend")},destroy:function destroy(){this.abort();this.exec("FileReader","destroy");this.disconnectRuntime();this.unbindAll()}});this.handleEventProps(s);this.bind("Error",function(t,e){this.readyState=a.DONE;this.error=e},999);this.bind("Load",function(){this.readyState=a.DONE},999);function n(e,n){this;this.trigger("loadstart");if(this.readyState===a.LOADING){this.trigger("error",new i.DOMException(i.DOMException.INVALID_STATE_ERR));this.trigger("loadend");return}if(!(n instanceof r)){this.trigger("error",new i.DOMException(i.DOMException.NOT_FOUND_ERR));this.trigger("loadend");return}this.result=null;this.readyState=a.LOADING;if(n.isDetached()){var o=n.getSource();switch(e){case"readAsText":case"readAsBinaryString":this.result=o;break;case"readAsDataURL":this.result="data:"+n.type+";base64,"+t.btoa(o);break;}this.readyState=a.DONE;this.trigger("load");this.trigger("loadend")}else{this.connectRuntime(n.ruid);this.exec("FileReader","read",e,n)}}}a.EMPTY=0;a.LOADING=1;a.DONE=2;a.prototype=n.instance;return a});i("moxie/core/utils/Url",["moxie/core/utils/Basic"],function(e){var t=function(n,r){var o=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],a=o.length,s={},d=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?(\[[\da-fA-F:]+\]|[^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(n||""),l,u=/^\/\/\w/.test(n);switch(e.typeOf(r)){case"undefined":r=t(document.location.href,!1);break;case"string":r=t(r,!1);break;}while(a--){if(d[a]){s[o[a]]=d[a]}}l=!u&&!s.scheme;if(u||l){s.scheme=r.scheme}if(l){s.host=r.host;s.port=r.port;var m="";if(/^[^\/]/.test(s.path)){m=r.path;if(/\/[^\/]*\.[^\/]*$/.test(m)){m=m.replace(/\/[^\/]+$/,"/")}else{m=m.replace(/\/?$/,"/")}}s.path=m+(s.path||"")}if(!s.port){s.port={http:80,https:443}[s.scheme]||80}s.port=parseInt(s.port,10);if(!s.path){s.path="/"}delete s.source;return s},i=function(e){var i="object"===_typeof(e)?e:t(e);return i.scheme+"://"+i.host+(i.port!=={http:80,https:443}[i.scheme]?":"+i.port:"")+i.path+(i.query?i.query:"")};return{parseUrl:t,resolveUrl:i,hasSameOrigin:function hasSameOrigin(e){function i(e){return[e.scheme,e.host,e.port].join("/")}if("string"==typeof e){e=t(e)}return i(t())===i(e)}}});i("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,t,i){function n(){this.uid=e.guid("uid_");t.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}n.prototype=i.instance;return n});i("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(e,t,n){return function(){t.call(this);e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function readAsBinaryString(e){return i.call(this,"readAsBinaryString",e)},readAsDataURL:function readAsDataURL(e){return i.call(this,"readAsDataURL",e)},readAsText:function readAsText(e){return i.call(this,"readAsText",e)}});function i(e,t){if(t.isDetached()){var r=t.getSource();switch(e){case"readAsBinaryString":return r;case"readAsDataURL":return"data:"+t.type+";base64,"+n.btoa(r);case"readAsText":for(var o="",a=0,s=r.length;a<s;a++){o+=String.fromCharCode(r[a])}return o;}}else{var d=this.connectRuntime(t.ruid).exec.call(this,"FileReaderSync","read",e,t);this.disconnectRuntime();return d}}}});i("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(e,t,i){return function(){var e,n=[];t.extend(this,{append:function append(r,o){var a=this,s=t.typeOf(o);if(o instanceof i){e={name:r,value:o}}else if("array"===s){r+="[]";t.each(o,function(e){a.append(r,e)})}else if("object"===s){t.each(o,function(e,t){a.append(r+"["+t+"]",e)})}else if("null"===s||"undefined"===s||"number"===s&&isNaN(o)){a.append(r,"false")}else{n.push({name:r,value:o.toString()})}},hasBlob:function hasBlob(){return!!this.getBlob()},getBlob:function getBlob(){return e&&e.value||null},getBlobName:function getBlobName(){return e&&e.name||null},each:function each(i){t.each(n,function(e){i(e.value,e.name)});if(e){i(e.value,e.name)}},destroy:function destroy(){e=null;n=[]}})}});i("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(t,i,e,n,r,o,a,s,d,l,u,m){var g={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};function c(){this.uid=t.guid("uid_")}c.prototype=e.instance;var h=["loadstart","progress","abort","error","load","timeout","loadend"];function p(){var x=this,E={timeout:0,readyState:p.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},y=!0,R,_,b={},v,A,I=null,T=null,S=!1,O=!1,w=!1,D=!1,C=!1,N=!1,L,F={},M,B="",P;t.extend(this,E,{uid:t.guid("uid_"),upload:new c,open:function open(e,o,a,s,l){var u;if(!e||!o){throw new i.DOMException(i.DOMException.SYNTAX_ERR)}if(/[\u0100-\uffff]/.test(e)||n.utf8_encode(e)!==e){throw new i.DOMException(i.DOMException.SYNTAX_ERR)}if(!!~t.inArray(e.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])){_=e.toUpperCase()}if(!!~t.inArray(_,["CONNECT","TRACE","TRACK"])){throw new i.DOMException(i.DOMException.SECURITY_ERR)}o=n.utf8_encode(o);u=r.parseUrl(o);N=r.hasSameOrigin(u);R=r.resolveUrl(o);if((s||l)&&!N){throw new i.DOMException(i.DOMException.INVALID_ACCESS_ERR)}v=s||u.user;A=l||u.pass;y=a||!0;if(!1===y&&(d("timeout")||d("withCredentials")||""!==d("responseType"))){throw new i.DOMException(i.DOMException.INVALID_ACCESS_ERR)}S=!y;O=!1;b={};f.call(this);d("readyState",p.OPENED);this.dispatchEvent("readystatechange")},setRequestHeader:function setRequestHeader(e,r){if(d("readyState")!==p.OPENED||O){throw new i.DOMException(i.DOMException.INVALID_STATE_ERR)}if(/[\u0100-\uffff]/.test(e)||n.utf8_encode(e)!==e){throw new i.DOMException(i.DOMException.SYNTAX_ERR)}e=t.trim(e).toLowerCase();if(!!~t.inArray(e,["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"])||/^(proxy\-|sec\-)/.test(e)){return!1}if(!b[e]){b[e]=r}else{b[e]+=", "+r}return!0},hasRequestHeader:function hasRequestHeader(e){return e&&b[e.toLowerCase()]||!1},getAllResponseHeaders:function getAllResponseHeaders(){return B||""},getResponseHeader:function getResponseHeader(e){e=e.toLowerCase();if(C||!!~t.inArray(e,["set-cookie","set-cookie2"])){return null}if(B&&""!==B){if(!P){P={};t.each(B.split(/\r\n/),function(e){var i=e.split(/:\s+/);if(2===i.length){i[0]=t.trim(i[0]);P[i[0].toLowerCase()]={header:i[0],value:t.trim(i[1])}}})}if(P.hasOwnProperty(e)){return P[e].header+": "+P[e].value}}return null},overrideMimeType:function overrideMimeType(e){var n,r;if(!!~t.inArray(d("readyState"),[p.LOADING,p.DONE])){throw new i.DOMException(i.DOMException.INVALID_STATE_ERR)}e=t.trim(e.toLowerCase());if(/;/.test(e)&&(n=e.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))){e=n[1];if(n[2]){r=n[2]}}if(!m.mimes[e]){throw new i.DOMException(i.DOMException.SYNTAX_ERR)}},send:function send(r,o){if("string"===t.typeOf(o)){F={ruid:o}}else if(!o){F={}}else{F=o}if(this.readyState!==p.OPENED||O){throw new i.DOMException(i.DOMException.INVALID_STATE_ERR)}if(r instanceof s){F.ruid=r.ruid;T=r.type||"application/octet-stream"}else if(r instanceof l){if(r.hasBlob()){var a=r.getBlob();F.ruid=a.ruid;T=a.type||"application/octet-stream"}}else if("string"==typeof r){I="UTF-8";T="text/plain;charset=UTF-8";r=n.utf8_encode(r)}if(!this.withCredentials){this.withCredentials=F.required_caps&&F.required_caps.send_browser_cookies&&!N}w=!S&&this.upload.hasEventListener();C=!1;D=!r;if(!S){O=!0}e.call(this,r)},abort:function abort(){C=!0;S=!1;if(!~t.inArray(d("readyState"),[p.UNSENT,p.OPENED,p.DONE])){d("readyState",p.DONE);O=!1;if(M){M.getRuntime().exec.call(M,"XMLHttpRequest","abort",D)}else{throw new i.DOMException(i.DOMException.INVALID_STATE_ERR)}D=!0}else{d("readyState",p.UNSENT)}},destroy:function destroy(){if(M){if("function"===t.typeOf(M.destroy)){M.destroy()}M=null}this.unbindAll();if(this.upload){this.upload.unbindAll();this.upload=null}}});this.handleEventProps(h.concat(["readystatechange"]));this.upload.handleEventProps(h);function d(e,t){if(!E.hasOwnProperty(e)){return}if(1===arguments.length){return u.can("define_property")?E[e]:x[e]}else{if(u.can("define_property")){E[e]=t}else{x[e]=t}}}function e(e){var r=this;new Date().getTime();M=new a;function i(){if(M){M.destroy();M=null}r.dispatchEvent("loadend");r=null}function n(n){M.bind("LoadStart",function(t){d("readyState",p.LOADING);r.dispatchEvent("readystatechange");r.dispatchEvent(t);if(w){r.upload.dispatchEvent(t)}});M.bind("Progress",function(t){if(d("readyState")!==p.LOADING){d("readyState",p.LOADING);r.dispatchEvent("readystatechange")}r.dispatchEvent(t)});M.bind("UploadProgress",function(t){if(w){r.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:t.total,loaded:t.loaded})}});M.bind("Load",function(o){d("readyState",p.DONE);d("status",+(n.exec.call(M,"XMLHttpRequest","getStatus")||0));d("statusText",g[d("status")]||"");d("response",n.exec.call(M,"XMLHttpRequest","getResponse",d("responseType")));if(!!~t.inArray(d("responseType"),["text",""])){d("responseText",d("response"))}else if("document"===d("responseType")){d("responseXML",d("response"))}B=n.exec.call(M,"XMLHttpRequest","getAllResponseHeaders");r.dispatchEvent("readystatechange");if(0<d("status")){if(w){r.upload.dispatchEvent(o)}r.dispatchEvent(o)}else{C=!0;r.dispatchEvent("error")}i()});M.bind("Abort",function(t){r.dispatchEvent(t);i()});M.bind("Error",function(t){C=!0;d("readyState",p.DONE);r.dispatchEvent("readystatechange");D=!0;r.dispatchEvent(t);i()});n.exec.call(M,"XMLHttpRequest","send",{url:R,method:_,async:y,user:v,password:A,headers:b,mimeType:T,encoding:I,responseType:r.responseType,withCredentials:r.withCredentials,options:F},e)}if("string"==typeof F.required_caps){F.required_caps=o.parseCaps(F.required_caps)}F.required_caps=t.extend({},F.required_caps,{return_response_type:r.responseType});if(e instanceof l){F.required_caps.send_multipart=!0}if(!t.isEmptyObj(b)){F.required_caps.send_custom_headers=!0}if(!N){F.required_caps.do_cors=!0}if(F.ruid){n(M.connectRuntime(F))}else{M.bind("RuntimeInit",function(t,e){n(e)});M.bind("RuntimeError",function(t,e){r.dispatchEvent("RuntimeError",e)});M.connectRuntime(F)}}function f(){d("responseText","");d("responseXML",null);d("response",null);d("status",0);d("statusText","");L=null}}p.UNSENT=0;p.OPENED=1;p.HEADERS_RECEIVED=2;p.LOADING=3;p.DONE=4;p.prototype=e.instance;return p});i("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(t,i,n,r){function o(){var s,d,l,u,m,c;n.call(this);t.extend(this,{uid:t.guid("uid_"),state:o.IDLE,result:null,transport:function transport(i,n,o){var a=this;o=t.extend({chunk_size:204798},o);if(s=o.chunk_size%3){o.chunk_size+=3-s}c=o.chunk_size;e.call(this);l=i;u=i.length;if("string"===t.typeOf(o)||o.ruid){r.call(a,n,this.connectRuntime(o))}else{var d=function(t,e){a.unbind("RuntimeInit",d);r.call(a,n,e)};this.bind("RuntimeInit",d);this.connectRuntime(o)}},abort:function abort(){var t=this;t.state=o.IDLE;if(d){d.exec.call(t,"Transporter","clear");t.trigger("TransportingAborted")}e.call(t)},destroy:function destroy(){this.unbindAll();d=null;this.disconnectRuntime();e.call(this)}});function e(){u=m=0;l=this.result=null}function r(e,i){var n=this;d=i;n.bind("TransportingProgress",function(i){m=i.loaded;if(m<u&&-1===t.inArray(n.state,[o.IDLE,o.DONE])){a.call(n)}},999);n.bind("TransportingComplete",function(){m=u;n.state=o.DONE;l=null;n.result=d.exec.call(n,"Transporter","getAsBlob",e||"")},999);n.state=o.BUSY;n.trigger("TransportingStarted");a.call(n)}function a(){var e=this,t,n=u-m;if(c>n){c=n}t=i.btoa(l.substr(m,c));d.exec.call(e,"Transporter","receive",t,u)}}o.IDLE=0;o.BUSY=1;o.DONE=2;o.prototype=r.instance;return o});i("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(e,t,i,n,r,o,a,s,d,l,u,m,c){var g=["progress","load","error","resize","embedded"];function p(){a.call(this);e.extend(this,{uid:e.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function clone(){this.load.apply(this,arguments)},load:function load(){l.apply(this,arguments)},resize:function resize(t){var n=this,r,o,a={x:0,y:0,width:n.width,height:n.height},s=e.extendIf({width:n.width,height:n.height,type:n.type||"image/jpeg",quality:90,crop:!1,fit:!0,preserveHeaders:!0,resample:"default",multipass:!0},t);try{if(!n.size){throw new i.DOMException(i.DOMException.INVALID_STATE_ERR)}if(n.width>p.MAX_RESIZE_WIDTH||n.height>p.MAX_RESIZE_HEIGHT){throw new i.ImageError(i.ImageError.MAX_RESOLUTION_ERR)}r=n.meta&&n.meta.tiff&&n.meta.tiff.Orientation||1;if(-1!==e.inArray(r,[5,6,7,8])){var d=s.width;s.width=s.height;s.height=d}if(s.crop){o=Math.max(s.width/n.width,s.height/n.height);if(t.fit){a.width=Math.min(Math.ceil(s.width/o),n.width);a.height=Math.min(Math.ceil(s.height/o),n.height);o=s.width/a.width}else{a.width=Math.min(s.width,n.width);a.height=Math.min(s.height,n.height);o=1}if("boolean"==typeof s.crop){s.crop="cc"}switch(s.crop.toLowerCase().replace(/_/,"-")){case"rb":case"right-bottom":a.x=n.width-a.width;a.y=n.height-a.height;break;case"cb":case"center-bottom":a.x=Math.floor((n.width-a.width)/2);a.y=n.height-a.height;break;case"lb":case"left-bottom":a.x=0;a.y=n.height-a.height;break;case"lt":case"left-top":a.x=0;a.y=0;break;case"ct":case"center-top":a.x=Math.floor((n.width-a.width)/2);a.y=0;break;case"rt":case"right-top":a.x=n.width-a.width;a.y=0;break;case"rc":case"right-center":case"right-middle":a.x=n.width-a.width;a.y=Math.floor((n.height-a.height)/2);break;case"lc":case"left-center":case"left-middle":a.x=0;a.y=Math.floor((n.height-a.height)/2);break;case"cc":case"center-center":case"center-middle":default:a.x=Math.floor((n.width-a.width)/2);a.y=Math.floor((n.height-a.height)/2);}a.x=Math.max(a.x,0);a.y=Math.max(a.y,0)}else{o=Math.min(s.width/n.width,s.height/n.height);if(1<o&&!s.fit){o=1}}this.exec("Image","resize",a,o,s)}catch(e){n.trigger("error",e.code)}},downsize:function downsize(t){var i={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,fit:!1,preserveHeaders:!0,resample:"default"},n;if("object"===_typeof(t)){n=e.extend(i,t)}else{n=e.extend(i,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]})}this.resize(n)},crop:function crop(e,t,i){this.downsize(e,t,!0,i)},getAsCanvas:function getAsCanvas(){if(!d.can("create_canvas")){throw new i.RuntimeError(i.RuntimeError.NOT_SUPPORTED_ERR)}return this.exec("Image","getAsCanvas")},getAsBlob:function getAsBlob(e,t){if(!this.size){throw new i.DOMException(i.DOMException.INVALID_STATE_ERR)}return this.exec("Image","getAsBlob",e||"image/jpeg",t||90)},getAsDataURL:function getAsDataURL(e,t){if(!this.size){throw new i.DOMException(i.DOMException.INVALID_STATE_ERR)}return this.exec("Image","getAsDataURL",e||"image/jpeg",t||90)},getAsBinaryString:function getAsBinaryString(e,t){var i=this.getAsDataURL(e,t);return c.atob(i.substring(i.indexOf("base64,")+7))},embed:function embed(n,r){var a=this,l,u=e.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,fit:!0,resample:"nearest"},r);function o(t,r){var o=this;if(d.can("create_canvas")){var u=o.getAsCanvas();if(u){n.appendChild(u);u=null;o.destroy();a.trigger("embedded");return}}var m=o.getAsDataURL(t,r);if(!m){throw new i.ImageError(i.ImageError.WRONG_FORMAT)}if(d.can("use_data_uri_of",m.length)){n.innerHTML="<img src=\""+m+"\" width=\""+o.width+"\" height=\""+o.height+"\" alt=\"\" />";o.destroy();a.trigger("embedded")}else{var p=new s;p.bind("TransportingComplete",function(){l=a.connectRuntime(this.result.ruid);a.bind("Embedded",function(){e.extend(l.getShimContainer().style,{top:"0px",left:"0px",width:o.width+"px",height:o.height+"px"});l=null},999);l.exec.call(a,"ImageView","display",this.result.uid,width,height);o.destroy()});p.transport(c.atob(m.substring(m.indexOf("base64,")+7)),t,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:n})}}try{if(!(n=t.get(n))){throw new i.DOMException(i.DOMException.INVALID_NODE_TYPE_ERR)}if(!this.size){throw new i.DOMException(i.DOMException.INVALID_STATE_ERR)}if(this.width>p.MAX_RESIZE_WIDTH||this.height>p.MAX_RESIZE_HEIGHT){}var m=new p;m.bind("Resize",function(){o.call(this,u.type,u.quality)});m.bind("Load",function(){this.downsize(u)});if(this.meta.thumb&&this.meta.thumb.width>=u.width&&this.meta.thumb.height>=u.height){m.load(this.meta.thumb.data)}else{m.clone(this,!1)}return m}catch(e){this.trigger("error",e.code)}},destroy:function destroy(){if(this.ruid){this.getRuntime().exec.call(this,"Image","destroy");this.disconnectRuntime()}if(this.meta&&this.meta.thumb){this.meta.thumb.data.destroy()}this.unbindAll()}});this.handleEventProps(g);this.bind("Load Resize",function(){return n.call(this)},999);function n(e){try{if(!e){e=this.exec("Image","getInfo")}this.size=e.size;this.width=e.width;this.height=e.height;this.type=e.type;this.meta=e.meta;if(""===this.name){this.name=e.name}return!0}catch(e){this.trigger("error",e.code);return!1}}function l(t){var n=e.typeOf(t);try{if(t instanceof p){if(!t.size){throw new i.DOMException(i.DOMException.INVALID_STATE_ERR)}h.apply(this,arguments)}else if(t instanceof u){if(!~e.inArray(t.type,["image/jpeg","image/png"])){throw new i.ImageError(i.ImageError.WRONG_FORMAT)}f.apply(this,arguments)}else if(-1!==e.inArray(n,["blob","file"])){l.call(this,new m(null,t),arguments[1])}else if("string"===n){if("data:"===t.substr(0,5)){l.call(this,new u(null,{data:t}),arguments[1])}else{x.apply(this,arguments)}}else if("node"===n&&"img"===t.nodeName.toLowerCase()){l.call(this,t.src,arguments[1])}else{throw new i.DOMException(i.DOMException.TYPE_MISMATCH_ERR)}}catch(e){this.trigger("error",e.code)}}function h(t,i){var n=this.connectRuntime(t.ruid);this.ruid=n.uid;n.exec.call(this,"Image","loadFromImage",t,"undefined"===e.typeOf(i)?!0:i)}function f(t,i){var r=this;r.name=t.name||"";function n(e){r.ruid=e.uid;e.exec.call(r,"Image","loadFromBlob",t)}if(t.isDetached()){this.bind("RuntimeInit",function(t,e){n(e)});if(i&&"string"==typeof i.required_caps){i.required_caps=o.parseCaps(i.required_caps)}this.connectRuntime(e.extend({required_caps:{access_image_binary:!0,resize_image:!0}},i))}else{n(this.connectRuntime(t.ruid))}}function x(e,t){var i=this,n;n=new r;n.open("get",e);n.responseType="blob";n.onprogress=function(t){i.trigger(t)};n.onload=function(){f.call(i,n.response,!0)};n.onerror=function(t){i.trigger(t)};n.onloadend=function(){n.destroy()};n.bind("RuntimeError",function(t,e){i.trigger("RuntimeError",e)});n.send(null,t)}}p.MAX_RESIZE_WIDTH=8192;p.MAX_RESIZE_HEIGHT=8192;p.prototype=l.instance;return p});i("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,t,i,r){var a={};function o(t){var o=this,s=i.capTest,d=i.capTrue,l=e.extend({access_binary:s(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function access_image_binary(){return o.can("access_binary")&&!!a.Image},display_media:s((r.can("create_canvas")||r.can("use_data_uri_over32kb"))&&n("moxie/image/Image")),do_cors:s(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:s(function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&("IE"!==r.browser||r.verComp(r.version,9,">"))}()),filter_by_extension:s(function(){return!("Chrome"===r.browser&&r.verComp(r.version,28,"<")||"IE"===r.browser&&r.verComp(r.version,10,"<")||"Safari"===r.browser&&r.verComp(r.version,7,"<")||"Firefox"===r.browser&&r.verComp(r.version,37,"<"))}()),return_response_headers:d,return_response_type:function return_response_type(e){if("json"===e&&!!window.JSON){return!0}return r.can("return_response_type",e)},return_status_code:d,report_upload_progress:s(window.XMLHttpRequest&&new XMLHttpRequest().upload),resize_image:function resize_image(){return o.can("access_binary")&&r.can("create_canvas")},select_file:function select_file(){return r.can("use_fileinput")&&window.File},select_folder:function select_folder(){return o.can("select_file")&&("Chrome"===r.browser&&r.verComp(r.version,21,">=")||"Firefox"===r.browser&&r.verComp(r.version,42,">="))},select_multiple:function select_multiple(){return o.can("select_file")&&!("Safari"===r.browser&&"Windows"===r.os)&&!("iOS"===r.os&&r.verComp(r.osVersion,"7.0.0",">")&&r.verComp(r.osVersion,"8.0.0","<"))},send_binary_string:s(window.XMLHttpRequest&&(new XMLHttpRequest().sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:s(window.XMLHttpRequest),send_multipart:function send_multipart(){return!!(window.XMLHttpRequest&&new XMLHttpRequest().upload&&window.FormData)||o.can("send_binary_string")},slice_blob:s(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function stream_upload(){return o.can("slice_blob")&&o.can("send_multipart")},summon_file_dialog:function summon_file_dialog(){return o.can("select_file")&&!("Firefox"===r.browser&&r.verComp(r.version,4,"<")||"Opera"===r.browser&&r.verComp(r.version,12,"<")||"IE"===r.browser&&r.verComp(r.version,10,"<"))},upload_filesize:d,use_http_method:d},arguments[2]);i.call(this,t,arguments[1]||"html5",l);e.extend(this,{init:function init(){this.trigger("Init")},destroy:function(e){return function(){e.call(o);e=o=null}}(this.destroy)});e.extend(this.getShim(),a)}i.addConstructor("html5",o);return a});i("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(e,t){return e.Blob=function(){function e(t,i,n){var r;if(window.File.prototype.slice){try{t.slice();return t.slice(i,n)}catch(r){return t.slice(i,n-i)}}else if(r=window.File.prototype.webkitSlice||window.File.prototype.mozSlice){return r.call(t,i,n)}else{return null}}this.slice=function(){return new t(this.getRuntime().uid,e.apply(this,arguments))};this.destroy=function(){this.getRuntime().getShim().removeInstance(this.uid)}}});i("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(e){var n={},r="moxie_"+e.guid();function t(){this.returnValue=!1}function i(){this.cancelBubble=!0}var o=function(t,o,a){var s,d;o=o.toLowerCase();if(t[r]&&n[t[r]]&&n[t[r]][o]){s=n[t[r]][o]}else{return}for(var l=s.length-1;0<=l;l--){if(s[l].orig===a||s[l].key===a){if(t.removeEventListener){t.removeEventListener(o,s[l].func,!1)}else if(t.detachEvent){t.detachEvent("on"+o,s[l].func)}s[l].orig=null;s[l].func=null;s.splice(l,1);if(a!==d){break}}}if(!s.length){delete n[t[r]][o]}if(e.isEmptyObj(n[t[r]])){delete n[t[r]];try{delete t[r]}catch(i){t[r]=d}}};return{addEvent:function addEvent(o,a,s,d){var l,u;a=a.toLowerCase();if(o.addEventListener){l=s;o.addEventListener(a,l,!1)}else if(o.attachEvent){l=function(){var e=window.event;if(!e.target){e.target=e.srcElement}e.preventDefault=t;e.stopPropagation=i;s(e)};o.attachEvent("on"+a,l)}if(!o[r]){o[r]=e.guid()}if(!n.hasOwnProperty(o[r])){n[o[r]]={}}u=n[o[r]];if(!u.hasOwnProperty(a)){u[a]=[]}u[a].push({func:l,orig:s,key:d})},removeEvent:o,removeAllEvents:function removeAllEvents(t,i){if(!t||!t[r]){return}e.each(n[t[r]],function(e,n){o(t,n,i)})}}});i("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,t,i,n,r,o,a){return e.FileInput=function(){var e,s;i.extend(this,{init:function init(d){var l=this,u=l.getRuntime(),m,c,p,g,h,f;e=d;p=o.extList2mimes(e.accept,u.can("filter_by_extension"));c=u.getShimContainer();c.innerHTML="<input id=\""+u.uid+"\" type=\"file\" style=\"font-size:999px;opacity:0;\""+(e.multiple&&u.can("select_multiple")?"multiple":"")+(e.directory&&u.can("select_folder")?"webkitdirectory directory":"")+(p?" accept=\""+p.join(",")+"\"":"")+" />";m=n.get(u.uid);i.extend(m.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});g=n.get(e.browse_button);s=n.getStyle(g,"z-index")||"auto";if(u.can("summon_file_dialog")){if("static"===n.getStyle(g,"position")){g.style.position="relative"}r.addEvent(g,"click",function(t){var e=n.get(u.uid);if(e&&!e.disabled){e.click()}t.preventDefault()},l.uid);l.bind("Refresh",function(){h=parseInt(s,10)||1;n.get(e.browse_button).style.zIndex=h;this.getRuntime().getShimContainer().style.zIndex=h-1})}f=u.can("summon_file_dialog")?g:c;r.addEvent(f,"mouseover",function(){l.trigger("mouseenter")},l.uid);r.addEvent(f,"mouseout",function(){l.trigger("mouseleave")},l.uid);r.addEvent(f,"mousedown",function(){l.trigger("mousedown")},l.uid);r.addEvent(n.get(e.container),"mouseup",function(){l.trigger("mouseup")},l.uid);(u.can("summon_file_dialog")?m:g).setAttribute("tabindex",-1);m.onchange=function n(){l.files=[];i.each(this.files,function(i){var n="";if(e.directory){if("."==i.name){return!0}}if(i.webkitRelativePath){n="/"+i.webkitRelativePath.replace(/^\//,"")}i=new t(u.uid,i);i.relativePath=n;l.files.push(i)});if("IE"!==a.browser&&"IEMobile"!==a.browser){this.value=""}else{var r=this.cloneNode(!0);this.parentNode.replaceChild(r,this);r.onchange=n}if(l.files.length){l.trigger("change")}};l.trigger({type:"ready",async:!0});c=null},setOption:function setOption(e,t){var i=this.getRuntime(),r=n.get(i.uid);switch(e){case"accept":if(t){var a=t.mimes||o.extList2mimes(t,i.can("filter_by_extension"));r.setAttribute("accept",a.join(","))}else{r.removeAttribute("accept")}break;case"directory":if(t&&i.can("select_folder")){r.setAttribute("directory","");r.setAttribute("webkitdirectory","")}else{r.removeAttribute("directory");r.removeAttribute("webkitdirectory")}break;case"multiple":if(t&&i.can("select_multiple")){r.setAttribute("multiple","")}else{r.removeAttribute("multiple")}}},disable:function disable(e){var t=this.getRuntime(),i;if(i=n.get(t.uid)){i.disabled=!!e}},destroy:function destroy(){var t=this.getRuntime(),i=t.getShim(),o=t.getShimContainer(),a=e&&n.get(e.container),d=e&&n.get(e.browse_button);if(a){r.removeAllEvents(a,this.uid)}if(d){r.removeAllEvents(d,this.uid);d.style.zIndex=s}if(o){r.removeAllEvents(o,this.uid);o.innerHTML=""}i.removeInstance(this.uid);e=o=a=d=i=null}})}});i("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(e,t,n,r,o,a){return e.FileDrop=function(){var g=[],h=[],f,x;n.extend(this,{init:function init(e){var t=this,r;f=e;x=t.ruid;h=d(f.accept);r=f.container;o.addEvent(r,"dragover",function(t){if(!i(t)){return}t.preventDefault();t.dataTransfer.dropEffect="copy"},t.uid);o.addEvent(r,"drop",function(r){if(!i(r)){return}r.preventDefault();g=[];if(r.dataTransfer.items&&r.dataTransfer.items[0].webkitGetAsEntry){u(r.dataTransfer.items,function(){t.files=g;t.trigger("drop")})}else{n.each(r.dataTransfer.files,function(e){s(e)});t.files=g;t.trigger("drop")}},t.uid);o.addEvent(r,"dragenter",function(){t.trigger("dragenter")},t.uid);o.addEvent(r,"dragleave",function(){t.trigger("dragleave")},t.uid)},destroy:function destroy(){o.removeAllEvents(f&&r.get(f.container),this.uid);x=g=h=f=null;this.getRuntime().getShim().removeInstance(this.uid)}});function i(t){if(!t.dataTransfer||!t.dataTransfer.types){return!1}var e=n.toArray(t.dataTransfer.types||[]);return-1!==n.inArray("Files",e)||-1!==n.inArray("public.file-url",e)||-1!==n.inArray("application/x-moz-file",e)}function s(e,i){if(l(e)){var n=new t(x,e);n.relativePath=i||"";g.push(n)}}function d(e){for(var t=[],r=0;r<e.length;r++){[].push.apply(t,e[r].extensions.split(/\s*,\s*/))}return-1===n.inArray("*",t)?t:[]}function l(e){if(!h.length){return!0}var t=a.getFileExtension(e.name);return!t||-1!==n.inArray(t,h)}function u(e,t){var i=[];n.each(e,function(e){var t=e.webkitGetAsEntry();if(t){if(t.isFile){s(e.getAsFile(),t.fullPath)}else{i.push(t)}}});if(i.length){m(i,t)}else{t()}}function m(e,t){var i=[];n.each(e,function(e){i.push(function(t){c(e,t)})});n.inSeries(i,function(){t()})}function c(e,t){if(e.isFile){e.file(function(i){s(i,e.fullPath);t()},function(){t()})}else if(e.isDirectory){p(e,t)}else{t()}}function p(e,t){var n=[],r=e.createReader();function i(e){r.readEntries(function(t){if(t.length){[].push.apply(n,t);i(e)}else{e()}},e)}i(function(){m(n,t)})}}});i("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(e,t,i){return e.FileReader=function(){var r,o=!1;i.extend(this,{read:function read(e,t){var a=this;a.result="";r=new window.FileReader;r.addEventListener("progress",function(t){a.trigger(t)});r.addEventListener("load",function(t){a.result=o?n(r.result):r.result;a.trigger(t)});r.addEventListener("error",function(t){a.trigger(t,r.error)});r.addEventListener("loadend",function(t){r=null;a.trigger(t)});if("function"===i.typeOf(r[e])){o=!1;r[e](t.getSource())}else if("readAsBinaryString"===e){o=!0;r.readAsDataURL(t.getSource())}},abort:function abort(){if(r){r.abort()}},destroy:function destroy(){r=null;this.getRuntime().getShim().removeInstance(this.uid)}});function n(e){return t.atob(e.substring(e.indexOf("base64,")+7))}}});i("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(e,t,i,n,r,o,a,s,d){return e.XMLHttpRequest=function(){var c=this,p,g;t.extend(this,{send:function send(i,r){var s=this,u="Mozilla"===d.browser&&d.verComp(d.version,4,">=")&&d.verComp(d.version,7,"<"),c="Android Browser"===d.browser,h=!1;g=i.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase();p=l();p.open(i.method,i.url,i.async,i.user,i.password);if(r instanceof o){if(r.isDetached()){h=!0}r=r.getSource()}else if(r instanceof a){if(r.hasBlob()){if(r.getBlob().isDetached()){r=m.call(s,r);h=!0}else if((u||c)&&"blob"===t.typeOf(r.getBlob().getSource())&&window.FileReader){e.call(s,i,r);return}}if(r instanceof a){var f=new window.FormData;r.each(function(e,t){if(e instanceof o){f.append(t,e.getSource())}else{f.append(t,e)}});r=f}}if(p.upload){if(i.withCredentials){p.withCredentials=!0}p.addEventListener("load",function(t){s.trigger(t)});p.addEventListener("error",function(t){s.trigger(t)});p.addEventListener("progress",function(t){s.trigger(t)});p.upload.addEventListener("progress",function(t){s.trigger({type:"UploadProgress",loaded:t.loaded,total:t.total})})}else{p.onreadystatechange=function(){switch(p.readyState){case 1:break;case 2:break;case 3:var e,t;try{if(n.hasSameOrigin(i.url)){e=p.getResponseHeader("Content-Length")||0}if(p.responseText){t=p.responseText.length}}catch(i){e=t=0}s.trigger({type:"progress",lengthComputable:!!e,total:parseInt(e,10),loaded:t});break;case 4:p.onreadystatechange=function(){};try{if(200<=p.status&&400>p.status){s.trigger("load");break}}catch(e){}s.trigger("error");break;}}}if(!t.isEmptyObj(i.headers)){t.each(i.headers,function(e,t){p.setRequestHeader(t,e)})}if(""!==i.responseType&&"responseType"in p){if("json"===i.responseType&&!d.can("return_response_type","json")){p.responseType="text"}else{p.responseType=i.responseType}}if(!h){p.send(r)}else{if(p.sendAsBinary){p.sendAsBinary(r)}else{(function(){for(var e=new Uint8Array(r.length),t=0;t<r.length;t++){e[t]=255&r.charCodeAt(t)}p.send(e.buffer)})()}}s.trigger("loadstart")},getStatus:function getStatus(){try{if(p){return p.status}}catch(e){}return 0},getResponse:function getResponse(e){var t=this.getRuntime();try{switch(e){case"blob":var n=new r(t.uid,p.response),o=p.getResponseHeader("Content-Disposition");if(o){var a=o.match(/filename=([\'\"'])([^\1]+)\1/);if(a){g=a[2]}}n.name=g;if(!n.type){n.type=i.getFileMime(g)}return n;case"json":if(!d.can("return_response_type","json")){return 200===p.status&&!!window.JSON?JSON.parse(p.responseText):null}return p.response;case"document":return u(p);default:return""!==p.responseText?p.responseText:null;}}catch(e){return null}},getAllResponseHeaders:function getAllResponseHeaders(){try{return p.getAllResponseHeaders()}catch(e){}return""},abort:function abort(){if(p){p.abort()}},destroy:function destroy(){c=g=null;this.getRuntime().getShim().removeInstance(this.uid)}});function e(e,t){var i=this,n,r;n=t.getBlob().getSource();r=new window.FileReader;r.onload=function(){t.append(t.getBlobName(),new o(null,{type:n.type,data:r.result}));c.send.call(i,e,t)};r.readAsBinaryString(n)}function l(){if(window.XMLHttpRequest&&!("IE"===d.browser&&d.verComp(d.version,8,"<"))){return new window.XMLHttpRequest}else{return function(){for(var e=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++){try{return new ActiveXObject(e[t])}catch(e){}}}()}}function u(e){var t=e.responseXML,i=e.responseText;if("IE"===d.browser&&i&&t&&!t.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(e.getResponseHeader("Content-Type"))){t=new window.ActiveXObject("Microsoft.XMLDOM");t.async=!1;t.validateOnParse=!1;t.loadXML(i)}if(t){if("IE"===d.browser&&0!==t.parseError||!t.documentElement||"parsererror"===t.documentElement.tagName){return null}}return t}function m(e){var t="----moxieboundary"+new Date().getTime(),i="",n=this.getRuntime();if(!n.can("send_binary_string")){throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR)}p.setRequestHeader("Content-Type","multipart/form-data; boundary="+t);e.each(function(e,n){if(e instanceof o){i+="--"+t+"\r\n"+"Content-Disposition: form-data; name=\""+n+"\"; filename=\""+unescape(encodeURIComponent(e.name||"blob"))+"\""+"\r\n"+"Content-Type: "+(e.type||"application/octet-stream")+"\r\n"+"\r\n"+e.getSource()+"\r\n"}else{i+="--"+t+"\r\n"+"Content-Disposition: form-data; name=\""+n+"\""+"\r\n"+"\r\n"+unescape(encodeURIComponent(e))+"\r\n"}});i+="--"+t+"--"+"\r\n";return i}}});i("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(e){function t(e){if(e instanceof ArrayBuffer){i.apply(this,arguments)}else{n.apply(this,arguments)}}e.extend(t.prototype,{littleEndian:!1,read:function read(e,t){var n,r,o;if(e+t>this.length()){throw new Error("You are trying to read outside the source boundaries.")}r=this.littleEndian?0:-8*(t-1);for(o=0,n=0;o<t;o++){n|=this.readByteAt(e+o)<<Math.abs(r+8*o)}return n},write:function write(e,t,n){var r,o;if(e>this.length()){throw new Error("You are trying to write outside the source boundaries.")}r=this.littleEndian?0:-8*(n-1);for(o=0;o<n;o++){this.writeByteAt(e+o,255&t>>Math.abs(r+8*o))}},BYTE:function BYTE(e){return this.read(e,1)},SHORT:function SHORT(e){return this.read(e,2)},LONG:function LONG(e){return this.read(e,4)},SLONG:function SLONG(e){var t=this.read(e,4);return 2147483647<t?t-4294967296:t},CHAR:function CHAR(e){return String.fromCharCode(this.read(e,1))},STRING:function STRING(e,t){return this.asArray("CHAR",e,t).join("")},asArray:function asArray(e,t,n){for(var r=[],o=0;o<n;o++){r[o]=this[e](t+o)}return r}});function i(t){var i=new DataView(t);e.extend(this,{readByteAt:function readByteAt(e){return i.getUint8(e)},writeByteAt:function writeByteAt(e,t){i.setUint8(e,t)},SEGMENT:function SEGMENT(e,n,r){switch(arguments.length){case 2:return t.slice(e,e+n);case 1:return t.slice(e);case 3:if(null===r){r=new ArrayBuffer}if(r instanceof ArrayBuffer){var o=new Uint8Array(this.length()-n+r.byteLength);if(0<e){o.set(new Uint8Array(t.slice(0,e)),0)}o.set(new Uint8Array(r),e);o.set(new Uint8Array(t.slice(e+n)),e+r.byteLength);this.clear();t=o.buffer;i=new DataView(t);break}default:return t;}},length:function length(){return t?t.byteLength:0},clear:function clear(){i=t=null}})}function n(t){e.extend(this,{readByteAt:function readByteAt(e){return t.charCodeAt(e)},writeByteAt:function writeByteAt(e,t){i(String.fromCharCode(t),e,1)},SEGMENT:function SEGMENT(e,n,r){switch(arguments.length){case 1:return t.substr(e);case 2:return t.substr(e,n);case 3:i(null!==r?r:"",e,n);break;default:return t;}},length:function length(){return t?t.length:0},clear:function clear(){t=null}});function i(e,i,n){n=3===arguments.length?n:t.length-i-1;t=t.substr(0,i)+e+t.substr(n+i)}}return t});i("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(e,t){return function n(r){var o=[],a,s,d,l=0;a=new e(r);if(65496!==a.SHORT(0)){a.clear();throw new t.ImageError(t.ImageError.WRONG_FORMAT)}s=2;while(s<=a.length()){d=a.SHORT(s);if(65488<=d&&65495>=d){s+=2;continue}if(65498===d||65497===d){break}l=a.SHORT(s+2)+2;if(65505<=d&&65519>=d){o.push({hex:d,name:"APP"+(15&d),start:s,length:l,segment:a.SEGMENT(s,l)})}s+=l}a.clear();return{headers:o,restore:function restore(t){var n,r,a;a=new e(t);s=65504==a.SHORT(2)?4+a.SHORT(4):2;for(r=0,n=o.length;r<n;r++){a.SEGMENT(s,0,o[r].segment);s+=o[r].length}t=a.SEGMENT();a.clear();return t},strip:function strip(t){var r,o,a,s;a=new n(t);o=a.headers;a.purge();r=new e(t);s=o.length;while(s--){r.SEGMENT(o[s].start,o[s].length,"")}t=r.SEGMENT();r.clear();return t},get:function get(e){for(var t=[],n=0,r=o.length;n<r;n++){if(o[n].name===e.toUpperCase()){t.push(o[n].segment)}}return t},set:function set(e,t){var n=[],r,a,s;if("string"==typeof t){n.push(t)}else{n=t}for(r=a=0,s=o.length;r<s;r++){if(o[r].name===e.toUpperCase()){o[r].segment=n[a];o[r].length=n[a].length;a++}if(a>=n.length){break}}},purge:function purge(){this.headers=o=[]}}}});i("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(e,t,i){function n(r){var s,d,l,u,m,c;t.call(this,r);d={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}};l={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};u={tiffHeader:10};m=u.tiffHeader;s={clear:this.clear};e.extend(this,{read:function read(){try{return n.prototype.read.apply(this,arguments)}catch(e){throw new i.ImageError(i.ImageError.INVALID_META_ERR)}},write:function write(){try{return n.prototype.write.apply(this,arguments)}catch(e){throw new i.ImageError(i.ImageError.INVALID_META_ERR)}},UNDEFINED:function UNDEFINED(){return this.BYTE.apply(this,arguments)},RATIONAL:function RATIONAL(e){return this.LONG(e)/this.LONG(e+4)},SRATIONAL:function SRATIONAL(e){return this.SLONG(e)/this.SLONG(e+4)},ASCII:function ASCII(e){return this.CHAR(e)},TIFF:function TIFF(){return c||null},EXIF:function EXIF(){var t=null;if(u.exifIFD){try{t=o.call(this,u.exifIFD,d.exif)}catch(e){return null}if(t.ExifVersion&&"array"===e.typeOf(t.ExifVersion)){for(var n=0,r="";n<t.ExifVersion.length;n++){r+=String.fromCharCode(t.ExifVersion[n])}t.ExifVersion=r}}return t},GPS:function(){var t=null;if(u.gpsIFD){try{t=o.call(this,u.gpsIFD,d.gps)}catch(e){return null}if(t.GPSVersionID&&"array"===e.typeOf(t.GPSVersionID)){t.GPSVersionID=t.GPSVersionID.join(".")}}return t},thumb:function thumb(){if(u.IFD1){try{var e=o.call(this,u.IFD1,d.thumb);if("JPEGInterchangeFormat"in e){return this.SEGMENT(u.tiffHeader+e.JPEGInterchangeFormat,e.JPEGInterchangeFormatLength)}}catch(e){}}return null},setExif:function setExif(e,t){if("PixelXDimension"!==e&&"PixelYDimension"!==e){return!1}return a.call(this,"exif",e,t)},clear:function clear(){s.clear();r=d=l=c=u=s=null}});if(65505!==this.SHORT(0)||"EXIF\0"!==this.STRING(4,5).toUpperCase()){throw new i.ImageError(i.ImageError.INVALID_META_ERR)}this.littleEndian=18761==this.SHORT(m);if(42!==this.SHORT(m+=2)){throw new i.ImageError(i.ImageError.INVALID_META_ERR)}u.IFD0=u.tiffHeader+this.LONG(m+=2);c=o.call(this,u.IFD0,d.tiff);if("ExifIFDPointer"in c){u.exifIFD=u.tiffHeader+c.ExifIFDPointer;delete c.ExifIFDPointer}if("GPSInfoIFDPointer"in c){u.gpsIFD=u.tiffHeader+c.GPSInfoIFDPointer;delete c.GPSInfoIFDPointer}if(e.isEmptyObj(c)){c=null}var p=this.LONG(u.IFD0+12*this.SHORT(u.IFD0)+2);if(p){u.IFD1=u.tiffHeader+p}function o(t,n){var r=this,o,a,s,d,m,c,p,g,h=[],f={},x={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},E={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};o=r.SHORT(t);for(a=0;a<o;a++){h=[];p=t+2+12*a;s=n[r.SHORT(p)];if(s===void 0){continue}d=x[r.SHORT(p+=2)];m=r.LONG(p+=2);c=E[d];if(!c){throw new i.ImageError(i.ImageError.INVALID_META_ERR)}p+=4;if(4<c*m){p=r.LONG(p)+u.tiffHeader}if(p+c*m>=this.length()){throw new i.ImageError(i.ImageError.INVALID_META_ERR)}if("ASCII"===d){f[s]=e.trim(r.STRING(p,m).replace(/\0$/,""));continue}else{h=r.asArray(d,p,m);g=1==m?h[0]:h;if(l.hasOwnProperty(s)&&"object"!=_typeof(g)){f[s]=l[s][g]}else{f[s]=g}}}return f}function a(e,t,n){var r,o,a,s=0;if("string"==typeof t){var l=d[e.toLowerCase()];for(var m in l){if(l[m]===t){t=m;break}}}r=u[e.toLowerCase()+"IFD"];o=this.SHORT(r);for(var c=0;c<o;c++){a=r+12*c+2;if(this.SHORT(a)==t){s=a+8;break}}if(!s){return!1}try{this.write(s,n,4)}catch(e){return!1}return!0}}n.prototype=t.prototype;return n});i("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(e,t,i,n,r){return function(o){var l,u,m,c;l=new n(o);if(65496!==l.SHORT(0)){throw new t.ImageError(t.ImageError.WRONG_FORMAT)}u=new i(o);try{m=new r(u.get("app1")[0])}catch(e){}c=a.call(this);e.extend(this,{type:"image/jpeg",size:l.length(),width:c&&c.width||0,height:c&&c.height||0,setExif:function setExif(t,i){if(!m){return!1}if("object"===e.typeOf(t)){e.each(t,function(e,t){m.setExif(t,e)})}else{m.setExif(t,i)}u.set("app1",m.SEGMENT())},writeHeaders:function writeHeaders(){if(!arguments.length){return u.restore(o)}return u.restore(arguments[0])},stripHeaders:function stripHeaders(e){return u.strip(e)},purge:function purge(){d.call(this)}});if(m){this.meta={tiff:m.TIFF(),exif:m.EXIF(),gps:m.GPS(),thumb:s()}}function a(e){var t=0,i,n;if(!e){e=l}while(t<=e.length()){i=e.SHORT(t+=2);if(65472<=i&&65475>=i){t+=5;return{height:e.SHORT(t),width:e.SHORT(t+=2)}}n=e.SHORT(t+=2);t+=n-2}return null}function s(){var e=m.thumb(),t,i;if(e){t=new n(e);i=a(t);t.clear();if(i){i.data=e;return i}}return null}function d(){if(!m||!u||!l){return}m.clear();u.purge();l.clear();c=u=m=l=null}}});i("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(e,t,i){return function(n){var s,d,l,u;s=new i(n);(function(){var t=0,n=0,r=[35152,20039,3338,6666];for(n=0;n<r.length;n++,t+=2){if(r[n]!=s.SHORT(t)){throw new e.ImageError(e.ImageError.WRONG_FORMAT)}}})();function r(){var e,t;e=a.call(this,8);if("IHDR"==e.type){t=e.start;return{width:s.LONG(t),height:s.LONG(t+=4)}}return null}function o(){if(!s){return}s.clear();n=u=d=l=s=null}u=r.call(this);t.extend(this,{type:"image/png",size:s.length(),width:u.width,height:u.height,purge:function purge(){o.call(this)}});o.call(this);function a(e){var t,i,n,r;t=s.LONG(e);i=s.STRING(e+=4,4);n=e+=4;r=s.LONG(e+t);return{length:t,type:i,start:n,CRC:r}}}});i("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(e,t,i,n){return function(r){var o=[i,n],a;a=function(){for(var e=0;e<o.length;e++){try{return new o[e](r)}catch(e){}}throw new t.ImageError(t.ImageError.WRONG_FORMAT)}();e.extend(this,{type:"",size:0,width:0,height:0,setExif:function setExif(){},writeHeaders:function writeHeaders(e){return e},stripHeaders:function stripHeaders(e){return e},purge:function purge(){r=null}});e.extend(this,a);this.purge=function(){a.purge();a=null}}});i("moxie/runtime/html5/image/ResizerCanvas",[],function(){function e(i,n,r){var o=i.width>i.height?"width":"height",a=Math.round(i[o]*n),s=!1;if("nearest"!==r&&(.5>n||2<n)){n=.5>n?.5:2;s=!0}var d=t(i,n);if(s){return e(d,a/d[o],r)}else{return d}}function t(e,t){var i=e.width,n=e.height,r=Math.round(i*t),o=Math.round(n*t),a=document.createElement("canvas");a.width=r;a.height=o;a.getContext("2d").drawImage(e,0,0,i,n,0,0,r,o);e=null;return a}return{scale:e}});i("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/ResizerCanvas","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,t,i,n,r,o,a,s,d){return e.Image=function(){var f=this,x,E,y,R,_,b=!1,v=!0;t.extend(this,{loadFromBlob:function loadFromBlob(e){var t=this.getRuntime(),n=1<arguments.length?arguments[1]:!0;if(!t.can("access_binary")){throw new i.RuntimeError(i.RuntimeError.NOT_SUPPORTED_ERR)}_=e;if(e.isDetached()){R=e.getSource();c.call(this,R)}else{p.call(this,e.getSource(),function(e){if(n){R=u(e)}c.call(this,e)})}},loadFromImage:function loadFromImage(e,t){this.meta=e.meta;_=new o(null,{name:e.name,size:e.size,type:e.type});c.call(this,t?R=e.getAsBinaryString():e.getAsDataURL())},getInfo:function getInfo(){var t=this.getRuntime(),i;if(!E&&R&&t.can("access_image_binary")){E=new a(R)}i={width:e().width||0,height:e().height||0,type:_.type||d.getFileMime(_.name),size:R&&R.length||_.size||0,name:_.name||"",meta:null};if(v){i.meta=E&&E.meta||this.meta||{};if(i.meta&&i.meta.thumb&&!(i.meta.thumb.data instanceof r)){i.meta.thumb.data=new r(null,{type:"image/jpeg",data:i.meta.thumb.data})}}return i},resize:function resize(t,i,n){var r=document.createElement("canvas");r.width=t.width;r.height=t.height;r.getContext("2d").drawImage(e(),t.x,t.y,t.width,t.height,0,0,r.width,r.height);y=s.scale(r,i);v=n.preserveHeaders;if(!v){var o=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;y=g(y,o)}this.width=y.width;this.height=y.height;b=!0;this.trigger("Resize")},getAsCanvas:function getAsCanvas(){if(!y){y=l()}y.id=this.uid+"_canvas";return y},getAsBlob:function getAsBlob(e,t){if(e!==this.type){b=!0;return new o(null,{name:_.name||"",type:e,data:f.getAsDataURL(e,t)})}return new o(null,{name:_.name||"",type:e,data:f.getAsBinaryString(e,t)})},getAsDataURL:function getAsDataURL(e){var t=arguments[1]||90;if(!b){return x.src}l();if("image/jpeg"!==e){return y.toDataURL("image/png")}else{try{return y.toDataURL("image/jpeg",t/100)}catch(e){return y.toDataURL("image/jpeg")}}},getAsBinaryString:function getAsBinaryString(e,t){if(!b){if(!R){R=u(f.getAsDataURL(e,t))}return R}if("image/jpeg"!==e){R=u(f.getAsDataURL(e,t))}else{var i;if(!t){t=90}l();try{i=y.toDataURL("image/jpeg",t/100)}catch(e){i=y.toDataURL("image/jpeg")}R=u(i);if(E){R=E.stripHeaders(R);if(v){if(E.meta&&E.meta.exif){E.setExif({PixelXDimension:this.width,PixelYDimension:this.height})}R=E.writeHeaders(R)}E.purge();E=null}}b=!1;return R},destroy:function destroy(){f=null;h.call(this);this.getRuntime().getShim().removeInstance(this.uid)}});function e(){if(!y&&!x){throw new i.ImageError(i.DOMException.INVALID_STATE_ERR)}return y||x}function l(){var t=e();if("canvas"==t.nodeName.toLowerCase()){return t}y=document.createElement("canvas");y.width=t.width;y.height=t.height;y.getContext("2d").drawImage(t,0,0);return y}function u(e){return n.atob(e.substring(e.indexOf("base64,")+7))}function m(e,t){return"data:"+(t||"")+";base64,"+n.btoa(e)}function c(e){var t=this;x=new Image;x.onerror=function(){h.call(this);t.trigger("error",i.ImageError.WRONG_FORMAT)};x.onload=function(){t.trigger("load")};x.src="data:"==e.substr(0,5)?e:m(e,_.type)}function p(e,t){var n=this,r;if(window.FileReader){r=new FileReader;r.onload=function(){t.call(n,this.result)};r.onerror=function(){n.trigger("error",i.ImageError.WRONG_FORMAT)};r.readAsDataURL(e)}else{return t.call(this,e.getAsDataURL())}}function g(e,i){var n=Math.PI/180,r=document.createElement("canvas"),o=r.getContext("2d"),a=e.width,s=e.height;if(-1<t.inArray(i,[5,6,7,8])){r.width=s;r.height=a}else{r.width=a;r.height=s}switch(i){case 2:o.translate(a,0);o.scale(-1,1);break;case 3:o.translate(a,s);o.rotate(180*n);break;case 4:o.translate(0,s);o.scale(1,-1);break;case 5:o.rotate(90*n);o.scale(1,-1);break;case 6:o.rotate(90*n);o.translate(0,-s);break;case 7:o.rotate(90*n);o.translate(a,-s);o.scale(-1,1);break;case 8:o.rotate(-90*n);o.translate(-a,0);break;}o.drawImage(e,0,0,a,s);return r}function h(){if(E){E.purge();E=null}R=x=y=_=null;b=!1}}});i("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,t,r,o,i){var l={};function a(){var e;try{e=navigator.plugins["Shockwave Flash"];e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(t){e="0.0"}}e=e.match(/\d+/g);return parseFloat(e[0]+"."+e[1])}function s(e){var i=r.get(e);if(i&&"OBJECT"==i.nodeName){if("IE"===t.browser){i.style.display="none";(function t(){if(4==i.readyState){d(e)}else{setTimeout(t,10)}})()}else{i.parentNode.removeChild(i)}}}function d(e){var t=r.get(e);if(t){for(var n in t){if("function"==typeof t[n]){t[n]=null}}t.parentNode.removeChild(t)}}i.addConstructor("flash",function(d){var u=this,m;d=e.extend({swf_url:t.swf_url},d);i.call(this,d,"flash",{access_binary:function access_binary(e){return e&&"browser"===u.mode},access_image_binary:function access_image_binary(e){return e&&"browser"===u.mode},display_media:i.capTest(n("moxie/image/Image")),do_cors:i.capTrue,drag_and_drop:!1,report_upload_progress:function report_upload_progress(){return"client"===u.mode},resize_image:i.capTrue,return_response_headers:!1,return_response_type:function return_response_type(t){if("json"===t&&!!window.JSON){return!0}return!e.arrayDiff(t,["","text","document"])||"browser"===u.mode},return_status_code:function return_status_code(t){return"browser"===u.mode||!e.arrayDiff(t,[200,404])},select_file:i.capTrue,select_multiple:i.capTrue,send_binary_string:function send_binary_string(e){return e&&"browser"===u.mode},send_browser_cookies:function send_browser_cookies(e){return e&&"browser"===u.mode},send_custom_headers:function send_custom_headers(e){return e&&"browser"===u.mode},send_multipart:i.capTrue,slice_blob:function slice_blob(e){return e&&"browser"===u.mode},stream_upload:function stream_upload(e){return e&&"browser"===u.mode},summon_file_dialog:!1,upload_filesize:function upload_filesize(t){return 2097152>=e.parseSizeStr(t)||"client"===u.mode},use_http_method:function use_http_method(t){return!e.arrayDiff(t,["GET","POST"])}},{access_binary:function access_binary(e){return e?"browser":"client"},access_image_binary:function access_image_binary(e){return e?"browser":"client"},report_upload_progress:function report_upload_progress(e){return e?"browser":"client"},return_response_type:function return_response_type(t){return e.arrayDiff(t,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function return_status_code(t){return e.arrayDiff(t,[200,404])?"browser":["client","browser"]},send_binary_string:function send_binary_string(e){return e?"browser":"client"},send_browser_cookies:function send_browser_cookies(e){return e?"browser":"client"},send_custom_headers:function send_custom_headers(e){return e?"browser":"client"},slice_blob:function slice_blob(e){return e?"browser":"client"},stream_upload:function stream_upload(e){return e?"client":"browser"},upload_filesize:function upload_filesize(t){return 2097152<=e.parseSizeStr(t)?"client":"browser"}},"client");if(11.3>a()){if(MXI_DEBUG&&t.debug.runtime){t.log("\tFlash didn't meet minimal version requirement (11.3).")}this.mode=!1}e.extend(this,{getShim:function getShim(){return r.get(this.uid)},shimExec:function shimExec(e,t){var i=[].slice.call(arguments,2);return u.getShim().exec(this.uid,e,t,i)},init:function init(){var n,r,a;a=this.getShimContainer();e.extend(a.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});n="<object id=\""+this.uid+"\" type=\"application/x-shockwave-flash\" data=\""+d.swf_url+"\" ";if("IE"===t.browser){n+="classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" "}n+="width=\"100%\" height=\"100%\" style=\"outline:0\"><param name=\"movie\" value=\""+d.swf_url+"\" /><param name=\"flashvars\" value=\"uid="+escape(this.uid)+"&target="+i.getGlobalEventTarget()+"\" /><param name=\"wmode\" value=\"transparent\" /><param name=\"allowscriptaccess\" value=\"always\" /></object>";if("IE"===t.browser){r=document.createElement("div");a.appendChild(r);r.outerHTML=n;r=a=null}else{a.innerHTML=n}m=setTimeout(function(){if(u&&!u.initialized){u.trigger("Error",new o.RuntimeError(o.RuntimeError.NOT_INIT_ERR));if(MXI_DEBUG&&t.debug.runtime){t.log("\tFlash failed to initialize within a specified period of time (typically 5s).")}}},5e3)},destroy:function(e){return function(){s(u.uid);e.call(u);clearTimeout(m);d=m=e=u=null}}(this.destroy)},l)});return l});i("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,t){return e.Blob={slice:function slice(e,i,n,r){var o=this.getRuntime();if(0>i){i=Math.max(e.size+i,0)}else if(0<i){i=Math.min(i,e.size)}if(0>n){n=Math.max(e.size+n,0)}else if(0<n){n=Math.min(n,e.size)}e=o.shimExec.call(this,"Blob","slice",i,n,r||"");if(e){e=new t(o.uid,e)}return e}}});i("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(e,t,i,n){return e.FileInput={init:function init(e){var r=this,o=this.getRuntime(),a=i.get(e.browse_button);if(a){a.setAttribute("tabindex",-1);a=null}this.bind("Change",function(){var e=o.shimExec.call(r,"FileInput","getFiles");r.files=[];n.each(e,function(e){r.files.push(new t(o.uid,e))})},999);this.getRuntime().shimExec.call(this,"FileInput","init",{accept:e.accept,multiple:e.multiple});this.trigger("ready")}}});i("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,t){function i(e,i){switch(i){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e;}return null}return e.FileReader={read:function read(e,t){var n=this;n.result="";if("readAsDataURL"===e){n.result="data:"+(t.type||"")+";base64,"}n.bind("Progress",function(t,r){if(r){n.result+=i(r,e)}},999);return n.getRuntime().shimExec.call(this,"FileReader","readAsBase64",t.uid)}}});i("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,t){function i(e,i){switch(i){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e;}return null}return e.FileReaderSync={read:function read(e,t){var n,r=this.getRuntime();n=r.shimExec.call(this,"FileReaderSync","readAsBase64",t.uid);if(!n){return null}if("readAsDataURL"===e){n="data:"+(t.type||"")+";base64,"+n}return i(n,e,t.type)}}});i("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,t){return e.Transporter={getAsBlob:function getAsBlob(e){var i=this.getRuntime(),n=i.shimExec.call(this,"Transporter","getAsBlob",e);if(n){return new t(i.uid,n)}return null}}});i("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/runtime/flash/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter","moxie/runtime/flash/runtime/Transporter"],function(e,t,i,n,r,o,a,s){return e.XMLHttpRequest={send:function(e,n){var l=this,u=l.getRuntime();function r(){e.transport=u.mode;u.shimExec.call(l,"XMLHttpRequest","send",e,n)}function o(e,t){u.shimExec.call(l,"XMLHttpRequest","appendBlob",e,t.uid);n=null;r()}function d(e,t){var i=new s;i.bind("TransportingComplete",function(){t(this.result)});i.transport(e.getSource(),e.type,{ruid:u.uid})}if(!t.isEmptyObj(e.headers)){t.each(e.headers,function(e,t){u.shimExec.call(l,"XMLHttpRequest","setRequestHeader",t,e.toString())})}if(n instanceof a){var m;n.each(function(e,t){if(e instanceof i){m=t}else{u.shimExec.call(l,"XMLHttpRequest","append",t,e)}});if(!n.hasBlob()){n=null;r()}else{var c=n.getBlob();if(c.isDetached()){d(c,function(e){c.destroy();o(m,e)})}else{o(m,c)}}}else if(n instanceof i){if(n.isDetached()){d(n,function(e){n.destroy();n=e.uid;r()})}else{n=n.uid;r()}}else{r()}},getResponse:function getResponse(e){var i,o,a=this.getRuntime();o=a.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob");if(o){o=new n(a.uid,o);if("blob"===e){return o}try{i=new r;if(!!~t.inArray(e,["","text"])){return i.readAsText(o)}else if("json"===e&&!!window.JSON){return JSON.parse(i.readAsText(o))}}finally{o.destroy()}}return null},abort:function abort(){var e=this.getRuntime();e.shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});i("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(e,t,i,n,r){return e.Image={loadFromBlob:function loadFromBlob(e){var n=this,r=n.getRuntime();function t(e){r.shimExec.call(n,"Image","loadFromBlob",e.uid);n=r=null}if(e.isDetached()){var o=new i;o.bind("TransportingComplete",function(){t(o.result.getSource())});o.transport(e.getSource(),e.type,{ruid:r.uid})}else{t(e.getSource())}},loadFromImage:function loadFromImage(e){var t=this.getRuntime();return t.shimExec.call(this,"Image","loadFromImage",e.uid)},getInfo:function getInfo(){var e=this.getRuntime(),t=e.shimExec.call(this,"Image","getInfo");if(t.meta&&t.meta.thumb&&t.meta.thumb.data&&!(e.meta.thumb.data instanceof n)){t.meta.thumb.data=new n(e.uid,t.meta.thumb.data)}return t},getAsBlob:function getAsBlob(e,t){var i=this.getRuntime(),r=i.shimExec.call(this,"Image","getAsBlob",e,t);if(r){return new n(i.uid,r)}return null},getAsDataURL:function getAsDataURL(){var e=this.getRuntime(),t=e.Image.getAsBlob.apply(this,arguments),i;if(!t){return null}i=new r;return i.readAsDataURL(t)}}});i("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,t,i,r,o){var s={};function a(e){var t=!1,i=null,n,r,o,a,s,d=0;try{try{i=new ActiveXObject("AgControl.AgControl");if(i.IsVersionSupported(e)){t=!0}i=null}catch(i){var l=navigator.plugins["Silverlight Plug-In"];if(l){n=l.description;if("1.0.30226.2"===n){n="2.0.30226.2"}r=n.split(".");while(3<r.length){r.pop()}while(4>r.length){r.push(0)}o=e.split(".");while(4<o.length){o.pop()}do{a=parseInt(o[d],10);s=parseInt(r[d],10);d++}while(d<o.length&&a===s);if(a<=s&&!isNaN(a)){t=!0}}}}catch(e){t=!1}return t}o.addConstructor("silverlight",function(d){var l=this,u;d=e.extend({xap_url:t.xap_url},d);o.call(this,d,"silverlight",{access_binary:o.capTrue,access_image_binary:o.capTrue,display_media:o.capTest(n("moxie/image/Image")),do_cors:o.capTrue,drag_and_drop:!1,report_upload_progress:o.capTrue,resize_image:o.capTrue,return_response_headers:function return_response_headers(e){return e&&"client"===l.mode},return_response_type:function return_response_type(e){if("json"!==e){return!0}else{return!!window.JSON}},return_status_code:function return_status_code(t){return"client"===l.mode||!e.arrayDiff(t,[200,404])},select_file:o.capTrue,select_multiple:o.capTrue,send_binary_string:o.capTrue,send_browser_cookies:function send_browser_cookies(e){return e&&"browser"===l.mode},send_custom_headers:function send_custom_headers(e){return e&&"client"===l.mode},send_multipart:o.capTrue,slice_blob:o.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:o.capTrue,use_http_method:function use_http_method(t){return"client"===l.mode||!e.arrayDiff(t,["GET","POST"])}},{return_response_headers:function return_response_headers(e){return e?"client":"browser"},return_status_code:function return_status_code(t){return e.arrayDiff(t,[200,404])?"client":["client","browser"]},send_browser_cookies:function send_browser_cookies(e){return e?"browser":"client"},send_custom_headers:function send_custom_headers(e){return e?"client":"browser"},use_http_method:function use_http_method(t){return e.arrayDiff(t,["GET","POST"])?"client":["client","browser"]}});if(!a("2.0.31005.0")||"Opera"===t.browser){if(MXI_DEBUG&&t.debug.runtime){t.log("\tSilverlight is not installed or minimal version (2.0.31005.0) requirement not met (not likely).")}this.mode=!1}e.extend(this,{getShim:function getShim(){return i.get(this.uid).content.Moxie},shimExec:function shimExec(e,t){var i=[].slice.call(arguments,2);return l.getShim().exec(this.uid,e,t,i)},init:function init(){var e=this.getShimContainer();e.innerHTML="<object id=\""+this.uid+"\" data=\"data:application/x-silverlight,\" type=\"application/x-silverlight-2\" width=\"100%\" height=\"100%\" style=\"outline:none;\"><param name=\"source\" value=\""+d.xap_url+"\"/><param name=\"background\" value=\"Transparent\"/><param name=\"windowless\" value=\"true\"/><param name=\"enablehtmlaccess\" value=\"true\"/><param name=\"initParams\" value=\"uid="+this.uid+",target="+o.getGlobalEventTarget()+"\"/></object>";u=setTimeout(function(){if(l&&!l.initialized){l.trigger("Error",new r.RuntimeError(r.RuntimeError.NOT_INIT_ERR));if(MXI_DEBUG&&t.debug.runtime){t.log("Silverlight failed to initialize within a specified period of time (5-10s).")}}},"Windows"!==t.OS?1e4:5e3)},destroy:function(e){return function(){e.call(l);clearTimeout(u);d=u=e=l=null}}(this.destroy)},s)});return s});i("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(e,t,i){return e.Blob=t.extend({},i)});i("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(e,t,i,n){function r(e){for(var t="",n=0;n<e.length;n++){t+=(""!==t?"|":"")+e[n].title+" | *."+e[n].extensions.replace(/,/g,";*.")}return t}return e.FileInput={init:function init(e){var o=this,a=this.getRuntime(),s=i.get(e.browse_button);if(s){s.setAttribute("tabindex",-1);s=null}this.bind("Change",function(){var e=a.shimExec.call(o,"FileInput","getFiles");o.files=[];n.each(e,function(e){o.files.push(new t(a.uid,e))})},999);a.shimExec.call(this,"FileInput","init",r(e.accept),e.multiple);this.trigger("ready")},setOption:function setOption(e,t){if("accept"==e){t=r(t)}this.getRuntime().shimExec.call(this,"FileInput","setOption",e,t)}}});i("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(e,t,i){return e.FileDrop={init:function init(){var e=this,n=e.getRuntime(),r;r=n.getShimContainer();i.addEvent(r,"dragover",function(t){t.preventDefault();t.stopPropagation();t.dataTransfer.dropEffect="copy"},e.uid);i.addEvent(r,"dragenter",function(i){i.preventDefault();var e=t.get(n.uid).dragEnter(i);if(e){i.stopPropagation()}},e.uid);i.addEvent(r,"drop",function(i){i.preventDefault();var e=t.get(n.uid).dragDrop(i);if(e){i.stopPropagation()}},e.uid);return n.shimExec.call(this,"FileDrop","init")}}});i("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(e,t,i){return e.FileReader=t.extend({},i)});i("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(e,t,i){return e.FileReaderSync=t.extend({},i)});i("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(e,t,i){return e.Transporter=t.extend({},i)});i("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/silverlight/file/FileReaderSync","moxie/runtime/silverlight/runtime/Transporter"],function(e,t,i){return e.XMLHttpRequest=t.extend({},i)});i("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(e,t,i,n){return e.Image=t.extend({},n,{getInfo:function getInfo(){var e=this.getRuntime(),n={meta:{}},r=e.shimExec.call(this,"Image","getInfo");if(r.meta){t.each(["tiff","exif","gps","thumb"],function(e){var t=r.meta[e],o,a,s,d;if(t&&t.keys){n.meta[e]={};for(a=0,s=t.keys.length;a<s;a++){o=t.keys[a];d=t[o];if(d){if(/^(\d|[1-9]\d+)$/.test(d)){d=parseInt(d,10)}else if(/^\d*\.\d+$/.test(d)){d=parseFloat(d)}n.meta[e][o]=d}}}});if(n.meta&&n.meta.thumb&&n.meta.thumb.data&&!(e.meta.thumb.data instanceof i)){n.meta.thumb.data=new i(e.uid,n.meta.thumb.data)}}n.width=parseInt(r.width,10);n.height=parseInt(r.height,10);n.size=parseInt(r.size,10);n.type=r.type;n.name=r.name;return n},resize:function resize(e,t,i){this.getRuntime().shimExec.call(this,"Image","resize",e.x,e.y,e.width,e.height,t,i.preserveHeaders,i.resample)}})});i("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,t,i,r){var o={};i.addConstructor("html4",function(t){var a=this,s=i.capTest,d=i.capTrue;i.call(this,t,"html4",{access_binary:s(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:s((r.can("create_canvas")||r.can("use_data_uri_over32kb"))&&n("moxie/image/Image")),do_cors:!1,drag_and_drop:!1,filter_by_extension:s(function(){return!("Chrome"===r.browser&&r.verComp(r.version,28,"<")||"IE"===r.browser&&r.verComp(r.version,10,"<")||"Safari"===r.browser&&r.verComp(r.version,7,"<")||"Firefox"===r.browser&&r.verComp(r.version,37,"<"))}()),resize_image:function resize_image(){return o.Image&&a.can("access_binary")&&r.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function return_response_type(t){if("json"===t&&!!window.JSON){return!0}return!!~e.inArray(t,["text","document",""])},return_status_code:function return_status_code(t){return!e.arrayDiff(t,[200,404])},select_file:function select_file(){return r.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function stream_upload(){return a.can("select_file")},summon_file_dialog:function summon_file_dialog(){return a.can("select_file")&&!("Firefox"===r.browser&&r.verComp(r.version,4,"<")||"Opera"===r.browser&&r.verComp(r.version,12,"<")||"IE"===r.browser&&r.verComp(r.version,10,"<"))},upload_filesize:d,use_http_method:function use_http_method(t){return!e.arrayDiff(t,["GET","POST"])}});e.extend(this,{init:function init(){this.trigger("Init")},destroy:function(e){return function(){e.call(a);e=a=null}}(this.destroy)});e.extend(this.getShim(),o)});return o});i("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,t,i,n,r,o,a){return e.FileInput=function(){var s,d=[],l,u;function e(){var o=this,u=o.getRuntime(),m,c,p,g,h,f;f=i.guid("uid_");m=u.getShimContainer();if(s){p=n.get(s+"_form");if(p){i.extend(p.style,{top:"100%"});p.firstChild.setAttribute("tabindex",-1)}}g=document.createElement("form");g.setAttribute("id",f+"_form");g.setAttribute("method","post");g.setAttribute("enctype","multipart/form-data");g.setAttribute("encoding","multipart/form-data");i.extend(g.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});h=document.createElement("input");h.setAttribute("id",f);h.setAttribute("type","file");h.setAttribute("accept",d.join(","));if(u.can("summon_file_dialog")){h.setAttribute("tabindex",-1)}i.extend(h.style,{fontSize:"999px",opacity:0});g.appendChild(h);m.appendChild(g);i.extend(h.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});if("IE"===a.browser&&a.verComp(a.version,10,"<")){i.extend(h.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"})}h.onchange=function(){var i;if(!this.value){return}if(this.files){i=this.files[0]}else{i={name:this.value}}i=new t(u.uid,i);this.onchange=function(){};e.call(o);o.files=[i];h.setAttribute("id",i.uid);g.setAttribute("id",i.uid+"_form");o.trigger("change");h=g=null};if(u.can("summon_file_dialog")){c=n.get(l.browse_button);r.removeEvent(c,"click",o.uid);r.addEvent(c,"click",function(t){if(h&&!h.disabled){h.click()}t.preventDefault()},o.uid)}s=f;m=p=c=null}i.extend(this,{init:function init(t){var i=this,a=i.getRuntime(),s;l=t;d=o.extList2mimes(t.accept,a.can("filter_by_extension"));s=a.getShimContainer();(function(){var e,o,d;e=n.get(t.browse_button);u=n.getStyle(e,"z-index")||"auto";if(a.can("summon_file_dialog")){if("static"===n.getStyle(e,"position")){e.style.position="relative"}i.bind("Refresh",function(){o=parseInt(u,10)||1;n.get(l.browse_button).style.zIndex=o;this.getRuntime().getShimContainer().style.zIndex=o-1})}else{e.setAttribute("tabindex",-1)}d=a.can("summon_file_dialog")?e:s;r.addEvent(d,"mouseover",function(){i.trigger("mouseenter")},i.uid);r.addEvent(d,"mouseout",function(){i.trigger("mouseleave")},i.uid);r.addEvent(d,"mousedown",function(){i.trigger("mousedown")},i.uid);r.addEvent(n.get(t.container),"mouseup",function(){i.trigger("mouseup")},i.uid);e=null})();e.call(this);s=null;i.trigger({type:"ready",async:!0})},setOption:function setOption(e,t){var i=this.getRuntime(),r;if("accept"==e){d=t.mimes||o.extList2mimes(t,i.can("filter_by_extension"))}r=n.get(s);if(r){r.setAttribute("accept",d.join(","))}},disable:function disable(e){var t;if(t=n.get(s)){t.disabled=!!e}},destroy:function destroy(){var e=this.getRuntime(),t=e.getShim(),i=e.getShimContainer(),o=l&&n.get(l.container),a=l&&n.get(l.browse_button);if(o){r.removeAllEvents(o,this.uid)}if(a){r.removeAllEvents(a,this.uid);a.style.zIndex=u}if(i){r.removeAllEvents(i,this.uid);i.innerHTML=""}t.removeInstance(this.uid);s=d=l=i=o=a=t=null}})}});i("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(e,t){return e.FileReader=t});i("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(e,t,n,r,o,i,a,s){return e.XMLHttpRequest=function(){var d,l,u;function e(e){var t=this,r,o,a,s,d=!1;if(!u){return}r=u.id.replace(/_iframe$/,"");o=n.get(r+"_form");if(o){a=o.getElementsByTagName("input");s=a.length;while(s--){switch(a[s].getAttribute("type")){case"hidden":a[s].parentNode.removeChild(a[s]);break;case"file":d=!0;break;}}a=[];if(!d){o.parentNode.removeChild(o)}o=null}setTimeout(function(){i.removeEvent(u,"load",t.uid);if(u.parentNode){u.parentNode.removeChild(u)}var n=t.getRuntime().getShimContainer();if(!n.children.length){n.parentNode.removeChild(n)}n=u=null;e()},1)}t.extend(this,{send:function send(m,c){var g=this,h=g.getRuntime(),f,x,E,y;d=l=null;function p(){var n=h.getShimContainer()||document.body,o=document.createElement("div");o.innerHTML="<iframe id=\""+f+"_iframe\" name=\""+f+"_iframe\" src=\"javascript:&quot;&quot;\" style=\"display:none\"></iframe>";u=o.firstChild;n.appendChild(u);i.addEvent(u,"load",function(){var i;try{i=u.contentWindow.document||u.contentDocument||window.frames[u.id].document;if(/^4(0[0-9]|1[0-7]|2[2346])\s/.test(i.title)){d=i.title.replace(/^(\d+).*$/,"$1")}else{d=200;l=t.trim(i.body.innerHTML);g.trigger({type:"progress",loaded:l.length,total:l.length});if(y){g.trigger({type:"uploadprogress",loaded:y.size||1025,total:y.size||1025})}}}catch(t){if(r.hasSameOrigin(m.url)){d=404}else{e.call(g,function(){g.trigger("error")});return}}e.call(g,function(){g.trigger("load")})},g.uid)}if(c instanceof s&&c.hasBlob()){y=c.getBlob();f=y.uid;E=n.get(f);x=n.get(f+"_form");if(!x){throw new o.DOMException(o.DOMException.NOT_FOUND_ERR)}}else{f=t.guid("uid_");x=document.createElement("form");x.setAttribute("id",f+"_form");x.setAttribute("method",m.method);x.setAttribute("enctype","multipart/form-data");x.setAttribute("encoding","multipart/form-data");h.getShimContainer().appendChild(x)}x.setAttribute("target",f+"_iframe");if(c instanceof s){c.each(function(e,i){if(e instanceof a){if(E){E.setAttribute("name",i)}}else{var n=document.createElement("input");t.extend(n,{type:"hidden",name:i,value:e});if(E){x.insertBefore(n,E)}else{x.appendChild(n)}}})}x.setAttribute("action",m.url);p();x.submit();g.trigger("loadstart")},getStatus:function getStatus(){return d},getResponse:function getResponse(e){if("json"===e){if("string"===t.typeOf(l)&&!!window.JSON){try{return JSON.parse(l.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(e){return null}}}else if("document"===e){}return l},abort:function abort(){var t=this;if(u&&u.contentWindow){if(u.contentWindow.stop){u.contentWindow.stop()}else if(u.contentWindow.document.execCommand){u.contentWindow.document.execCommand("Stop")}else{u.src="about:blank"}}e.call(this,function(){t.dispatchEvent("abort")})},destroy:function destroy(){this.getRuntime().getShim().removeInstance(this.uid)}})}});i("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(e,t){return e.Image=t});(function(t){for(var n=0;n<t.length;n++){for(var r=e,a=t[n],s=a.split(/[.\/]/),d=0;d<s.length-1;++d){if(r[s[d]]===void 0){r[s[d]]={}}r=r[s[d]]}r[s[s.length-1]]=o[a]}})(["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Dom","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/core/I18n","moxie/core/utils/Mime","moxie/file/FileInput","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/image/Image","moxie/core/utils/Events","moxie/runtime/html5/image/ResizerCanvas"])})(this)});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("mod_vod/plupload-bootstrap-csmsmedia",["jquery","mod_vod/plupload","mod_vod/moxie"],function(a,b,c){"use strict";var h={},j=c;function d(a){return b.translate(a)||a}function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random(),c="x"==a?b:8|3&b;return c.toString(16)})}function f(a){a.id=a.attr("id");a.html("<div class=\"plupload_wrapper\"><div class=\"plupload_container card\"><div class=\"plupload_header card-header\"><div class=\"plupload_header_content\"><div class=\"plupload_logo\"> </div><div class=\"plupload_header_title\">"+d("Select files")+"</div><div class=\"plupload_header_text\">"+d("Add files to the upload queue and click the start button.")+"</div><div class=\"plupload_view_switch\"><input type=\"radio\" id=\""+a.id+"_view_list\" name=\"view_mode_"+a.id+"\" checked=\"checked\" /><label class=\"plupload_button\" for=\""+a.id+"_view_list\" data-view=\"list\">"+d("List")+"</label><input type=\"radio\" id=\""+a.id+"_view_thumbs\" name=\"view_mode_"+a.id+"\" /><label class=\"plupload_button\"  for=\""+a.id+"_view_thumbs\" data-view=\"thumbs\">"+d("Thumbnails")+"</label></div></div><div class=\"card-heading\">"+d("File List")+"</div></div><div class=\"plupload_content card-body \"><div class=\"plupload_droptext\">"+d("Drag files here.")+"</div><ul class=\"plupload_filelist_content list-unstyled p-2\"> </ul><div class=\"plupload_clearer\">&nbsp;</div></div><div class=\"card-footer\"><div class=\"file-status float-none float-md-right form-text mb-3 mb-md-0 mt-0 mt-md-1\"><span class=\"mr-3 plupload_file_status\"><span class=\"plupload_total_status\">0%</span></span><span class=\"mr-3 plupload_file_count\">"+d("FileCount")+" : <span class=\"plupload_total_file_count\">0</span></span><span class=\"plupload_file_size\">"+d("FileSize")+" : <span class=\"plupload_total_file_size\">0 kb</span></span></div><div class=\"plupload_buttons\"><!-- Visible --><a class=\"plupload_button plupload_add btn btn-default\">"+d("Add Files")+"</a>&nbsp;<a class=\"plupload_button plupload_start btn btn-success\">"+d("Start Upload")+"</a>&nbsp;<a class=\"plupload_button plupload_stop plupload_hidden btn btn-warning\">"+d("Stop Upload")+"</a>&nbsp;</div></div></div><input class=\"plupload_count\" value=\"0\" type=\"hidden\"></div>")}var i=function(c,d){this.options=a.extend(!0,i.DEFAULTS,d);this.element=a(c);this.widgetEventPrefix="";this.contents_bak="";this.FILE_COUNT_ERROR=-9001;var e=this.element.attr("id");if(!e){e=b.guid();this.element.attr("id",e)}this.id=e;this.contents_bak=this.element.html();f(this.element);this.container=a(".plupload_container",this.element).attr("id",e+"_container");this.content=a(".plupload_content",this.element);if(a.fn.resizable){this.container.resizable({handles:"s",minHeight:300})}this.filelist=a(".plupload_filelist_content",this.container).attr({id:e+"_filelist",unselectable:"on"});this.browse_button=a(".plupload_add",this.container).attr("id",e+"_browse");this.start_button=a(".plupload_start",this.container).attr("id",e+"_start");this.stop_button=a(".plupload_stop",this.container).attr("id",e+"_stop");this.thumbs_switcher=a("#"+e+"_view_thumbs");this.list_switcher=a("#"+e+"_view_list");this.browse_button.addClass("disabled");this.start_button.addClass("disabled");this.progressbar=a(".plupload_progress_container",this.container);this.counter=a(".plupload_count",this.element).attr({id:e+"_count",name:e+"_count"});this._initUploader();var g,h="";if(this.uploader.getOption("filters").max_file_count!=g){h="0 / "+this.uploader.getOption("filters").max_file_count}var j=b.formatSize(0);if(this.uploader.getOption("filters").total_max_file_size!=g){j+=" / "+b.formatSize(this.uploader.getOption("filters").total_max_file_size)}this.element.find(".plupload_total_file_count").html(h).end().find(".plupload_total_file_size").html(j)};i.DEFAULTS={filters:{},buttons:{browse:!0,start:!0,stop:!0},views:{list:!0,thumbs:!1,active:"list",remember:!0},thumb_width:100,thumb_height:60,multiple_queues:!0,dragdrop:!0,autostart:!1,rename:!1};i.VERSION="1.0.0";i.prototype._trigger=function(b,c,d){var e,f,g=this.options[b];d=d||{};c=a.Event(c);c.type=b.toLowerCase();c.target=this.element[0];f=c.originalEvent;if(f){for(e in f){if(!(e in c)){c[e]=f[e]}}}this.element.trigger(c,d);return!(a.isFunction(g)&&!1===g.apply(this.element[0],[c].concat(d))||c.isDefaultPrevented())};i.prototype._initUploader=function(){var c=this,f=this.id,g,i={container:f+"_buttons",browse_button:f+"_browse"};a(".plupload_buttons",this.element).attr("id",f+"_buttons");if(c.options.dragdrop){this.filelist.parent().attr("id",this.id+"_dropbox");i.drop_element=this.id+"_dropbox"}this.filelist.on("click",function(b){if(a(b.target).hasClass("fa-minus-circle")){c.removeFile(a(b.target).closest(".plupload_file").attr("id"));b.preventDefault()}});g=this.uploader=h[f]=new b.Uploader(a.extend(this.options,i));if(c.options.views.thumbs){g.settings.required_features.display_media=!0}if(c.options.max_file_count){b.extend(g.getOption("filters"),{max_file_count:c.options.max_file_count})}b.addFileFilter("max_file_count",function(a,b,e){if(a<=this.files.length-(this.total.uploaded+this.total.failed)){c.browse_button.addClass("disabled");this.disableBrowse();this.trigger("Error",{code:c.FILE_COUNT_ERROR,message:d("File count error."),file:b});e(!1)}else{e(!0)}});b.addFileFilter("total_max_file_size",function(a,b,e){var f,g=0,h,j=this.files.length;if(0<j){for(h=0;h<j;h++){g+=this.files[h].size}}g+=b.size;if(b.size!=f&&0<a&&g>a){this.trigger("Error",{code:c.TOTAL_FILE_SIZE_ERROR,message:d("Total File size error."),file:b,totalFileSize:g+b.size});e(!1)}else{e(!0)}});g.bind("Error",function(a,e){var f,g="";f="<strong>"+e.message+"</strong>";switch(e.code){case b.FILE_EXTENSION_ERROR:g=b.sprintf(d("File: %s"),e.file.name);break;case b.FILE_SIZE_ERROR:g=b.sprintf(d("File: %s, size: %s, max file size: %s"),e.file.name,b.formatSize(e.file.size),b.formatSize(b.parseSize(a.getOption("filters").max_file_size)));break;case b.TOTAL_FILE_SIZE_ERROR:g=b.sprintf(d("File: %s, size: %s, max total file size: %s"),e.file.name,b.formatSize(e.file.size),b.formatSize(b.parseSize(a.getOption("filters").total_max_file_size)));break;case b.FILE_DUPLICATE_ERROR:g=b.sprintf(d("%s already present in the queue."),e.file.name);break;case c.FILE_COUNT_ERROR:g=b.sprintf(d("Upload element accepts only %d file(s) at a time. Extra files were stripped."),a.getOption("filters").max_file_count||0);break;case b.IMAGE_FORMAT_ERROR:g=d("Image format either wrong or not supported.");break;case b.IMAGE_MEMORY_ERROR:g=d("Runtime ran out of available memory.");break;case b.HTTP_ERROR:g=d("Upload URL might be wrong or doesn't exist.");break;}f+=" <div class='mx-3 mt-2'>"+g+"</div>";c._trigger("error",null,{up:a,error:e});if(e.code===b.INIT_ERROR){setTimeout(function(){c.destroy()},1)}else{c.notify("error",f)}});g.bind("PostInit",function(b){if(!c.options.buttons.browse){c.browse_button.addClass("disabled").hide();b.disableBrowse(!0)}else{c.browse_button.removeClass("disabled")}if(!c.options.buttons.start){c.start_button.addClass("disabled").hide()}if(!c.options.buttons.stop){c.stop_button.addClass("disabled").hide()}if(!c.options.unique_names&&c.options.rename){c._enableRenaming()}if(c.options.dragdrop&&b.features.dragdrop){c.filelist.parent().addClass("plupload_dropbox")}c._enableViewSwitcher();c.start_button.click(function(b){if(!a(this).hasClass("disabled")){c.start()}b.preventDefault()});c.stop_button.click(function(a){c.stop();a.preventDefault()});c._trigger("ready",null,{up:b})});g.init();g.bind("BeforeUpload",function(a,b){console.log(a);console.log(b.name);var c=e(),d=b.name,f=c+"."+b.name.split(".").pop();b.uuid=c;a.settings.multipart_params.key=a.settings.organization_open_token+"/"+f;console.log(b);console.log(a.settings.multipart_params)});g.bind("FileFiltered",function(a,b){c._addFiles(b)});g.bind("FilesAdded",function(a,b){c._trigger("selected",null,{up:a,files:b});c._trigger("updatelist",null,{filelist:c.filelist});if(c.options.autostart){setTimeout(function(){c.start()},10)}});g.bind("FilesRemoved",function(b,d){a.each(d,function(b,c){a("#"+c.id).remove()});c._trigger("updatelist",null,{filelist:c.filelist});c._trigger("removed",null,{up:b,files:d})});g.bind("QueueChanged StateChanged",function(){c._handleState()});g.bind("UploadFile",function(a,b){c._handleFileStatus(b)});g.bind("FileUploaded",function(b,d,e){c._handleFileStatus(d);c._trigger("uploaded",null,{up:b,file:d,re:a.parseJSON(e.response)})});g.bind("UploadProgress",function(a,b){c._handleFileStatus(b);c._updateTotalProgress();c._trigger("progress",null,{up:a,file:b})});g.bind("UploadComplete",function(a,b){c._addFormFields();c._trigger("complete",null,{up:a,files:b})});g.bind("BeforeUpload",function(a,b){c._trigger("beforeupload",null,{up:a,file:b})})};i.prototype._setOption=function(b,c){var d=this;if("buttons"==b&&"object"==_typeof(c)){c=a.extend(d.options.buttons,c);if(!c.browse){d.browse_button.addClass("disabled").hide();d.uploader.disableBrowse(!0)}else{d.browse_button.removeClass("disabled").show();d.uploader.disableBrowse(!1)}if(!c.start){d.start_button.addClass("disabled").hide()}else{d.start_button.removeClass("disabled").show()}if(!c.stop){d.stop_button.addClass("disabled").hide()}else{d.start_button.removeClass("disabled").show()}}d.uploader.settings[b]=c};i.prototype.start=function(){this.uploader.start()};i.prototype.stop=function(){this.uploader.stop()};i.prototype.enable=function(){this.browse_button.removeClass("disabled");this.uploader.disableBrowse(!1)};i.prototype.disable=function(){this.browse_button.addClass("disabled");this.uploader.disableBrowse(!0)};i.prototype.getFile=function(a){var b;if("number"==typeof a){b=this.uploader.files[a]}else{b=this.uploader.getFile(a)}return b};i.prototype.getFiles=function(){return this.uploader.files};i.prototype.removeFile=function(a){if("string"===b.typeOf(a)){a=this.getFile(a)}this.uploader.removeFile(a)};i.prototype.clearQueue=function(){this.uploader.splice()};i.prototype.getUploader=function(){return this.uploader};i.prototype.refresh=function(){this.uploader.refresh()};i.prototype.notify=function(b,c){var d=a("<div class=\"plupload_message alert alert-dismissible mx-2\" role=\"alert\"><button type=\"button\" class=\"plupload_message_close close\" data-dismiss=\"alert\"><span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span></button > <p><span class=\"fa\"></span>&nbsp;"+c+"</p></div>");d.addClass("alert-"+("error"===b?"danger":"warning")).find(".fa").addClass("error"===b?"fa-exclamation-triangle":"fa-exclamation-circle").end().find(".plupload_message_close").click(function(){d.remove()}).end();a(".plupload_content",this.container).append(d)};i.prototype.destroy=function(){this.uploader.destroy();a(".plupload_button",this.element).unbind();this.element.empty().html(this.contents_bak);this.contents_bak="";i.prototype.destroy.apply(this)};i.prototype._handleState=function(){var c=this.uploader,e=c.files.length-(c.total.uploaded+c.total.failed),f=c.getOption("filters").max_file_count||0;if(b.STARTED===c.state){a([]).add(this.stop_button).add(".plupload_started",this.container).removeClass("plupload_hidden");this.start_button.addClass("disabled");if(!this.options.multiple_queues){this.browse_button.addClass("disabled");c.disableBrowse()}a(".plupload_upload_status",this.element).html(b.sprintf(d("Uploaded %d/%d files"),c.total.uploaded,c.files.length));a(".plupload_header_content",this.element).addClass("plupload_header_content_bw")}else if(b.STOPPED===c.state){a([]).add(this.stop_button).add(".plupload_started",this.container).addClass("plupload_hidden");if(e){this.start_button.removeClass("disabled")}else{this.start_button.addClass("disabled")}if(this.options.multiple_queues){a(".plupload_header_content",this.element).removeClass("plupload_header_content_bw")}if(this.options.multiple_queues&&f&&f>e){this.browse_button.removeClass("disabled");c.disableBrowse(!1)}this._updateTotalProgress()}if(0===c.total.queued){a(".ui-button-text",this.browse_button).html(d("Add Files"))}else{a(".ui-button-text",this.browse_button).html(b.sprintf(d("%d files queued"),c.total.queued))}this.container.toggleClass("plupload_files_queued",c.files.length);c.refresh()};i.prototype._handleFileStatus=function(c){var d=a("#"+c.id),e,f;if(!d.length){return}switch(c.status){case b.DONE:e="plupload_done";f="plupload_action_icon plupload_action_icon fa fa-minus-circle";d.find(".plupload_file_progress").removeClass("bg-success").addClass("bg-primary");break;case b.FAILED:e="plupload_failed";f="plupload_action_icon plupload_action_icon fa fa-minus-circle";break;case b.QUEUED:e="plupload_delete";f="plupload_action_icon plupload_action_icon fa fa-minus-circle";d.find(".plupload_file_progress").attr("aria-valuenow",0).css("width","0px");break;case b.UPLOADING:e="plupload_uploading";f="plupload_action_icon fa fa-cloud-upload";var g=a(".plupload_scroll",this.container),h=g.scrollTop(),i=g.height(),j=d.position().top+d.height();if(i<j){g.scrollTop(h+j-i)}d.find(".plupload_file_percent").html(c.percent+"%").end().find(".plupload_file_progress").addClass("bg-success").attr("aria-valuenow",c.percent).css("width",c.percent+"%").end().find(".plupload_file_size").html(b.formatSize(c.size));break;}e+=" plupload_file";d.attr("class",e).find(".plupload_action_icon").attr("class",f)};i.prototype._updateTotalProgress=function(){var a,c=this.uploader;this.filelist[0].scrollTop=this.filelist[0].scrollHeight;this.progressbar.progressbar("value",c.total.percent);var e="";if(c.getOption("filters").max_file_count!=a){e=c.files.length+" / "+c.getOption("filters").max_file_count}var f=b.formatSize(c.total.size);if(c.getOption("filters").total_max_file_size!=a){f+=" / "+b.formatSize(c.getOption("filters").total_max_file_size)}this.element.find(".plupload_total_status").html(c.total.percent+"%").end().find(".plupload_total_file_size").html(f).end().find(".plupload_total_file_count").html(e).end().find(".plupload_upload_status").html(b.sprintf(d("Uploaded %d/%d files"),c.total.uploaded,c.files.length))};i.prototype._displayThumbs=function(){var h=this,i,k,l,m=0,n=[],o=!1;if(!this.options.views.thumbs){return}function b(a,b,c){var d;a.on(b,function(){clearTimeout(d);d=setTimeout(function(){clearTimeout(d);c()},300)})}function c(){if(!i||!k){var b=a(".plupload_file:eq(0)",h.filelist);i=b.outerWidth(!0);k=b.outerHeight(!0)}var c=h.content.width(),d=h.content.height();l=Math.floor(c/i);m=l*(Math.ceil(d/k)+1)}function d(){var b=Math.floor(h.content.scrollTop()/k)*l;n=a(".plupload_file",h.filelist).slice(b,b+m).filter(".plupload_file_loading").get()}function e(){function e(){if("thumbs"!==h.view_mode){return}c();d();g()}b(a(window),"resize",e);b(h.content,"scroll",e);h.element.on("viewchanged selected",e);e()}function f(b,c){var d=new j.image.Image,e=j.core.utils.Url.resolveUrl;d.onload=function(){var c=a("#"+b.id+" .plupload_file_thumb",h.filelist).html("");this.embed(c[0],{width:h.options.thumb_width,height:h.options.thumb_height,crop:!0,swf_url:e(h.options.flash_swf_url),xap_url:e(h.options.silverlight_xap_url)})};d.bind("embedded error",function(){a("#"+b.id,h.filelist).removeClass("plupload_file_loading");this.destroy();setTimeout(c,1)});d.load(b.getSource())}function g(){if("thumbs"!==h.view_mode||o){return}d();if(!n.length){return}o=!0;f(h.getFile(a(n.shift()).attr("id")),function(){o=!1;g()})}this.element.on("selected",function a(){h.element.off("selected",a);e()})};i.prototype._addFiles=function(c){var d=this,e,f="";e="<li class=\"media plupload_file plupload_delete\" id=\"{id}\" style=\"width:{thumb_width}px;\"><div class=\"media-body mb-1\"><div class=\"plupload_file_thumb plupload_thumb_toload\" style=\"width: {thumb_width}px; height: {thumb_height}px;\"><div class=\"plupload_file_dummy\" style=\"line-height: {thumb_height}px;\">{ext}</div></div><div class=\"plupload_file_name media-body mb-1\" title=\"{name}\"><span class=\"plupload_file_name_wrapper font-weight-bold\">{name} </span><span class=\"plupload_file_size ml-2 small\">({size})</span><span class=\"plupload_file_fields ml-2\"> </span><span class=\"plupload_file_action ml-2\"><span class=\"plupload_action_icon fa fa-minus-circle text-danger cursor-pointer\"> </span></span></div><div class=\"plupload_file_status mb-2 progress\"><div class=\"plupload_file_progress progress-bar progress-bar-striped\" style=\"width: 0%\"><span class=\"plupload_file_percent\">{percent} </span></div > </div></div></li>";if("array"!==b.typeOf(c)){c=[c]}a.each(c,function(a,c){var g=j.core.utils.Mime.getFileExtension(c.name)||"none";f+=e.replace(/\{(\w+)\}/g,function(a,e){switch(e){case"thumb_width":case"thumb_height":return d.options[e];case"size":return b.formatSize(c.size);case"ext":return g;default:return c[e]||"";}})});d.filelist.append(f)};i.prototype._addFormFields=function(){var c=this;a(".plupload_file_fields",this.filelist).html("");b.each(this.uploader.files,function(d,e){var f="",g=c.id+"_"+e;if(d.target_name){f+="<input type=\"hidden\" name=\""+g+"_tmpname\" value=\""+b.xmlEncode(d.target_name)+"\" />"}f+="<input type=\"hidden\" name=\""+g+"_name\" value=\""+b.xmlEncode(d.name)+"\" />";f+="<input type=\"hidden\" name=\""+g+"_status\" value=\""+(d.status===b.DONE?"done":"failed")+"\" />";a("#"+d.id).find(".plupload_file_fields").html(f)});this.counter.val(this.uploader.files.length)};i.prototype._viewChanged=function(c){if(this.options.views.remember&&a.cookie){a.cookie("plupload_ui_view",c,{expires:7,path:"/"})}if("IE"===b.ua.browser&&7>b.ua.version){this.content.attr("style","height:expression(document.getElementById(\""+this.id+"_container\").clientHeight - "+("list"===c?132:102)+")")}this.container.removeClass("plupload_view_list plupload_view_thumbs").addClass("plupload_view_"+c);this.view_mode=c;this._trigger("viewchanged",null,{view:c})};i.prototype._enableViewSwitcher=function(){var c=this,d,e=a(".plupload_view_switch",this.container),f,g;b.each(["list","thumbs"],function(a){if(!c.options.views[a]){e.find("[for=\""+c.id+"_view_"+a+"\"], #"+c.id+"_view_"+a).remove()}});f=e.find(".plupload_button");if(1===f.length){e.hide();d=f.eq(0).data("view");this._viewChanged(d)}else if(1<f.length){if(this.options.views.remember&&a.cookie){d=a.cookie("plupload_ui_view")}if(!~b.inArray(d,["list","thumbs"])){d=this.options.views.active}e.show().find(".btn").click(function(b){d=a(this).data("view");c._viewChanged(d);b.preventDefault()});g=e.find("[for=\""+c.id+"_view_"+d+"\"]");if(g.length){g.trigger("click")}}else{e.show();this._viewChanged(this.options.views.active)}if(this.options.views.thumbs){this._displayThumbs()}};i.prototype._enableRenaming=function(){var b=this;this.filelist.dblclick(function(c){var d=a(c.target),e,f,g,h,i="";if(!d.hasClass("plupload_file_name_wrapper")){return}fileContainer=d.closest(".plupload_file");if(!fileContainer.hasClass("plupload_delete")){return}f=b.uploader.getFile(d.closest(".plupload_file")[0].id);h=f.name;g=/^(.+)(\.[^.]+)$/.exec(h);if(g){h=g[1];i=g[2]}e=a("<input class=\"plupload_file_rename\" type=\"text\" />").width(d.width()).insertAfter(d.hide());e.val(h).blur(function(){d.show().parent().scrollLeft(0).end().next().remove()}).keydown(function(b){var c=a(this);if(-1!==a.inArray(b.keyCode,[13,27])){b.preventDefault();if(13===b.keyCode){f.name=c.val()+i;d.html(f.name)}c.blur()}})[0].focus()})};i.prototype._enableSortingList=function(){};function g(b){return this.each(function(){var c=a(this),d=c.data("bs.bsupload"),e="object"==_typeof(b)&&b;if(!d){c.data("bs.bsupload",d=new i(this,e))}})}var k=a.fn.bsupload;a.fn.bsupload=g;a.fn.bsupload.Constructor=i;a.fn.bsupload.noConflict=function(){a.fn.bsupload=k;return this};a(document).on("ready.bs.bsupload.data-api",function(){a("[data-toggle=\"bsupload\"]").each(function(){var b=a(this),c=a.extend({},b.data());g.call(b,c)})})});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("mod_vod/plupload-bootstrap",["jquery","mod_vod/plupload","mod_vod/moxie"],function(a,b,c){"use strict";var g={},h=c;function d(a){return b.translate(a)||a}function e(a){a.id=a.attr("id");a.html("<div class=\"plupload_wrapper\"><div class=\"plupload_container card\"><div class=\"plupload_header card-header\"><div class=\"plupload_header_content\"><div class=\"plupload_logo\"> </div><div class=\"plupload_header_title\">"+d("Select files")+"</div><div class=\"plupload_header_text\">"+d("Add files to the upload queue and click the start button.")+"</div><div class=\"plupload_view_switch\"><input type=\"radio\" id=\""+a.id+"_view_list\" name=\"view_mode_"+a.id+"\" checked=\"checked\" /><label class=\"plupload_button\" for=\""+a.id+"_view_list\" data-view=\"list\">"+d("List")+"</label><input type=\"radio\" id=\""+a.id+"_view_thumbs\" name=\"view_mode_"+a.id+"\" /><label class=\"plupload_button\"  for=\""+a.id+"_view_thumbs\" data-view=\"thumbs\">"+d("Thumbnails")+"</label></div></div><div class=\"card-heading\">"+d("File List")+"</div></div><div class=\"plupload_content card-body \"><div class=\"plupload_droptext\">"+d("Drag files here.")+"</div><ul class=\"plupload_filelist_content list-unstyled p-2\"> </ul><div class=\"plupload_clearer\">&nbsp;</div></div><div class=\"card-footer\"><div class=\"file-status float-none float-md-right form-text mb-3 mb-md-0 mt-0 mt-md-1\"><span class=\"mr-3 plupload_file_status\"><span class=\"plupload_total_status\">0%</span></span><span class=\"mr-3 plupload_file_count\">"+d("FileCount")+" : <span class=\"plupload_total_file_count\">0</span></span><span class=\"plupload_file_size\">"+d("FileSize")+" : <span class=\"plupload_total_file_size\">0 kb</span></span></div><div class=\"plupload_buttons\"><!-- Visible --><a class=\"plupload_button plupload_add btn btn-default\">"+d("Add Files")+"</a>&nbsp;<a class=\"plupload_button plupload_start btn btn-success\">"+d("Start Upload")+"</a>&nbsp;<a class=\"plupload_button plupload_stop plupload_hidden btn btn-warning\">"+d("Stop Upload")+"</a>&nbsp;</div></div></div><input class=\"plupload_count\" value=\"0\" type=\"hidden\"></div>")}var i=function(c,d){this.options=a.extend(!0,i.DEFAULTS,d);this.element=a(c);this.widgetEventPrefix="";this.contents_bak="";this.FILE_COUNT_ERROR=-9001;var f=this.element.attr("id");if(!f){f=b.guid();this.element.attr("id",f)}this.id=f;this.contents_bak=this.element.html();e(this.element);this.container=a(".plupload_container",this.element).attr("id",f+"_container");this.content=a(".plupload_content",this.element);if(a.fn.resizable){this.container.resizable({handles:"s",minHeight:300})}this.filelist=a(".plupload_filelist_content",this.container).attr({id:f+"_filelist",unselectable:"on"});this.browse_button=a(".plupload_add",this.container).attr("id",f+"_browse");this.start_button=a(".plupload_start",this.container).attr("id",f+"_start");this.stop_button=a(".plupload_stop",this.container).attr("id",f+"_stop");this.thumbs_switcher=a("#"+f+"_view_thumbs");this.list_switcher=a("#"+f+"_view_list");this.browse_button.addClass("disabled");this.start_button.addClass("disabled");this.progressbar=a(".plupload_progress_container",this.container);this.counter=a(".plupload_count",this.element).attr({id:f+"_count",name:f+"_count"});this._initUploader();var g,h="";if(this.uploader.getOption("filters").max_file_count!=g){h="0 / "+this.uploader.getOption("filters").max_file_count}var j=b.formatSize(0);if(this.uploader.getOption("filters").total_max_file_size!=g){j+=" / "+b.formatSize(this.uploader.getOption("filters").total_max_file_size)}this.element.find(".plupload_total_file_count").html(h).end().find(".plupload_total_file_size").html(j)};i.DEFAULTS={filters:{},buttons:{browse:!0,start:!0,stop:!0},views:{list:!0,thumbs:!1,active:"list",remember:!0},thumb_width:100,thumb_height:60,multiple_queues:!0,dragdrop:!0,autostart:!1,rename:!1};i.VERSION="1.0.0";i.prototype._trigger=function(b,c,d){var e,f,g=this.options[b];d=d||{};c=a.Event(c);c.type=b.toLowerCase();c.target=this.element[0];f=c.originalEvent;if(f){for(e in f){if(!(e in c)){c[e]=f[e]}}}this.element.trigger(c,d);return!(a.isFunction(g)&&!1===g.apply(this.element[0],[c].concat(d))||c.isDefaultPrevented())};i.prototype._initUploader=function(){var c=this,e=this.id,f,h={container:e+"_buttons",browse_button:e+"_browse"};a(".plupload_buttons",this.element).attr("id",e+"_buttons");if(c.options.dragdrop){this.filelist.parent().attr("id",this.id+"_dropbox");h.drop_element=this.id+"_dropbox"}this.filelist.on("click",function(b){if(a(b.target).hasClass("fa-minus-circle")){c.removeFile(a(b.target).closest(".plupload_file").attr("id"));b.preventDefault()}});f=this.uploader=g[e]=new b.Uploader(a.extend(this.options,h));if(c.options.views.thumbs){f.settings.required_features.display_media=!0}if(c.options.max_file_count){b.extend(f.getOption("filters"),{max_file_count:c.options.max_file_count})}b.addFileFilter("max_file_count",function(a,b,e){if(a<=this.files.length-(this.total.uploaded+this.total.failed)){c.browse_button.addClass("disabled");this.disableBrowse();this.trigger("Error",{code:c.FILE_COUNT_ERROR,message:d("File count error."),file:b});e(!1)}else{e(!0)}});b.addFileFilter("total_max_file_size",function(a,b,e){var f,g=0,h,j=this.files.length;if(0<j){for(h=0;h<j;h++){g+=this.files[h].size}}g+=b.size;if(b.size!=f&&0<a&&g>a){this.trigger("Error",{code:c.TOTAL_FILE_SIZE_ERROR,message:d("Total File size error."),file:b,totalFileSize:g+b.size});e(!1)}else{e(!0)}});f.bind("Error",function(a,e){var f,g="";f="<strong>"+e.message+"</strong>";switch(e.code){case b.FILE_EXTENSION_ERROR:g=b.sprintf(d("File: %s"),e.file.name);break;case b.FILE_SIZE_ERROR:g=b.sprintf(d("File: %s, size: %s, max file size: %s"),e.file.name,b.formatSize(e.file.size),b.formatSize(b.parseSize(a.getOption("filters").max_file_size)));break;case b.TOTAL_FILE_SIZE_ERROR:g=b.sprintf(d("File: %s, size: %s, max total file size: %s"),e.file.name,b.formatSize(e.file.size),b.formatSize(b.parseSize(a.getOption("filters").total_max_file_size)));break;case b.FILE_DUPLICATE_ERROR:g=b.sprintf(d("%s already present in the queue."),e.file.name);break;case c.FILE_COUNT_ERROR:g=b.sprintf(d("Upload element accepts only %d file(s) at a time. Extra files were stripped."),a.getOption("filters").max_file_count||0);break;case b.IMAGE_FORMAT_ERROR:g=d("Image format either wrong or not supported.");break;case b.IMAGE_MEMORY_ERROR:g=d("Runtime ran out of available memory.");break;case b.HTTP_ERROR:g=d("Upload URL might be wrong or doesn't exist.");break;}f+=" <div class='mx-3 mt-2'>"+g+"</div>";c._trigger("error",null,{up:a,error:e});if(e.code===b.INIT_ERROR){setTimeout(function(){c.destroy()},1)}else{c.notify("error",f)}});f.bind("PostInit",function(b){if(!c.options.buttons.browse){c.browse_button.addClass("disabled").hide();b.disableBrowse(!0)}else{c.browse_button.removeClass("disabled")}if(!c.options.buttons.start){c.start_button.addClass("disabled").hide()}if(!c.options.buttons.stop){c.stop_button.addClass("disabled").hide()}if(!c.options.unique_names&&c.options.rename){c._enableRenaming()}if(c.options.dragdrop&&b.features.dragdrop){c.filelist.parent().addClass("plupload_dropbox")}c._enableViewSwitcher();c.start_button.click(function(b){if(!a(this).hasClass("disabled")){c.start()}b.preventDefault()});c.stop_button.click(function(a){c.stop();a.preventDefault()});c._trigger("ready",null,{up:b})});f.init();f.bind("FileFiltered",function(a,b){c._addFiles(b)});f.bind("FilesAdded",function(a,b){c._trigger("selected",null,{up:a,files:b});c._trigger("updatelist",null,{filelist:c.filelist});if(c.options.autostart){setTimeout(function(){c.start()},10)}});f.bind("FilesRemoved",function(b,d){a.each(d,function(b,c){a("#"+c.id).remove()});c._trigger("updatelist",null,{filelist:c.filelist});c._trigger("removed",null,{up:b,files:d})});f.bind("QueueChanged StateChanged",function(){c._handleState()});f.bind("UploadFile",function(a,b){c._handleFileStatus(b)});f.bind("FileUploaded",function(b,d,e){c._handleFileStatus(d);c._trigger("uploaded",null,{up:b,file:d,re:a.parseJSON(e.response)})});f.bind("UploadProgress",function(a,b){c._handleFileStatus(b);c._updateTotalProgress();c._trigger("progress",null,{up:a,file:b})});f.bind("UploadComplete",function(a,b){c._addFormFields();c._trigger("complete",null,{up:a,files:b})});f.bind("BeforeUpload",function(a,b){c._trigger("beforeupload",null,{up:a,file:b})})};i.prototype._setOption=function(b,c){var d=this;if("buttons"==b&&"object"==_typeof(c)){c=a.extend(d.options.buttons,c);if(!c.browse){d.browse_button.addClass("disabled").hide();d.uploader.disableBrowse(!0)}else{d.browse_button.removeClass("disabled").show();d.uploader.disableBrowse(!1)}if(!c.start){d.start_button.addClass("disabled").hide()}else{d.start_button.removeClass("disabled").show()}if(!c.stop){d.stop_button.addClass("disabled").hide()}else{d.start_button.removeClass("disabled").show()}}d.uploader.settings[b]=c};i.prototype.start=function(){this.uploader.start()};i.prototype.stop=function(){this.uploader.stop()};i.prototype.enable=function(){this.browse_button.removeClass("disabled");this.uploader.disableBrowse(!1)};i.prototype.disable=function(){this.browse_button.addClass("disabled");this.uploader.disableBrowse(!0)};i.prototype.getFile=function(a){var b;if("number"==typeof a){b=this.uploader.files[a]}else{b=this.uploader.getFile(a)}return b};i.prototype.getFiles=function(){return this.uploader.files};i.prototype.removeFile=function(a){if("string"===b.typeOf(a)){a=this.getFile(a)}this.uploader.removeFile(a)};i.prototype.clearQueue=function(){this.uploader.splice()};i.prototype.getUploader=function(){return this.uploader};i.prototype.refresh=function(){this.uploader.refresh()};i.prototype.notify=function(b,c){var d=a("<div class=\"plupload_message alert alert-dismissible mx-2\" role=\"alert\"><button type=\"button\" class=\"plupload_message_close close\" data-dismiss=\"alert\"><span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span></button > <p><span class=\"fa\"></span>&nbsp;"+c+"</p></div>");d.addClass("alert-"+("error"===b?"danger":"warning")).find(".fa").addClass("error"===b?"fa-exclamation-triangle":"fa-exclamation-circle").end().find(".plupload_message_close").click(function(){d.remove()}).end();a(".plupload_content",this.container).append(d)};i.prototype.destroy=function(){this.uploader.destroy();a(".plupload_button",this.element).unbind();this.element.empty().html(this.contents_bak);this.contents_bak="";i.prototype.destroy.apply(this)};i.prototype._handleState=function(){var c=this.uploader,e=c.files.length-(c.total.uploaded+c.total.failed),f=c.getOption("filters").max_file_count||0;if(b.STARTED===c.state){a([]).add(this.stop_button).add(".plupload_started",this.container).removeClass("plupload_hidden");this.start_button.addClass("disabled");if(!this.options.multiple_queues){this.browse_button.addClass("disabled");c.disableBrowse()}a(".plupload_upload_status",this.element).html(b.sprintf(d("Uploaded %d/%d files"),c.total.uploaded,c.files.length));a(".plupload_header_content",this.element).addClass("plupload_header_content_bw")}else if(b.STOPPED===c.state){a([]).add(this.stop_button).add(".plupload_started",this.container).addClass("plupload_hidden");if(e){this.start_button.removeClass("disabled")}else{this.start_button.addClass("disabled")}if(this.options.multiple_queues){a(".plupload_header_content",this.element).removeClass("plupload_header_content_bw")}if(this.options.multiple_queues&&f&&f>e){this.browse_button.removeClass("disabled");c.disableBrowse(!1)}this._updateTotalProgress()}if(0===c.total.queued){a(".ui-button-text",this.browse_button).html(d("Add Files"))}else{a(".ui-button-text",this.browse_button).html(b.sprintf(d("%d files queued"),c.total.queued))}this.container.toggleClass("plupload_files_queued",c.files.length);c.refresh()};i.prototype._handleFileStatus=function(c){var d=a("#"+c.id),e,f;if(!d.length){return}switch(c.status){case b.DONE:e="plupload_done";f="plupload_action_icon plupload_action_icon fa fa-minus-circle";d.find(".plupload_file_progress").removeClass("bg-success").addClass("bg-primary");break;case b.FAILED:e="plupload_failed";f="plupload_action_icon plupload_action_icon fa fa-minus-circle";break;case b.QUEUED:e="plupload_delete";f="plupload_action_icon plupload_action_icon fa fa-minus-circle";d.find(".plupload_file_progress").attr("aria-valuenow",0).css("width","0px");break;case b.UPLOADING:e="plupload_uploading";f="plupload_action_icon fa fa-cloud-upload";var g=a(".plupload_scroll",this.container),h=g.scrollTop(),i=g.height(),j=d.position().top+d.height();if(i<j){g.scrollTop(h+j-i)}d.find(".plupload_file_percent").html(c.percent+"%").end().find(".plupload_file_progress").addClass("bg-success").attr("aria-valuenow",c.percent).css("width",c.percent+"%").end().find(".plupload_file_size").html(b.formatSize(c.size));break;}e+=" plupload_file";d.attr("class",e).find(".plupload_action_icon").attr("class",f)};i.prototype._updateTotalProgress=function(){var a,c=this.uploader;this.filelist[0].scrollTop=this.filelist[0].scrollHeight;this.progressbar.progressbar("value",c.total.percent);var e="";if(c.getOption("filters").max_file_count!=a){e=c.files.length+" / "+c.getOption("filters").max_file_count}var f=b.formatSize(c.total.size);if(c.getOption("filters").total_max_file_size!=a){f+=" / "+b.formatSize(c.getOption("filters").total_max_file_size)}this.element.find(".plupload_total_status").html(c.total.percent+"%").end().find(".plupload_total_file_size").html(f).end().find(".plupload_total_file_count").html(e).end().find(".plupload_upload_status").html(b.sprintf(d("Uploaded %d/%d files"),c.total.uploaded,c.files.length))};i.prototype._displayThumbs=function(){var i=this,j,k,l,m=0,n=[],o=!1;if(!this.options.views.thumbs){return}function b(a,b,c){var d;a.on(b,function(){clearTimeout(d);d=setTimeout(function(){clearTimeout(d);c()},300)})}function c(){if(!j||!k){var b=a(".plupload_file:eq(0)",i.filelist);j=b.outerWidth(!0);k=b.outerHeight(!0)}var c=i.content.width(),d=i.content.height();l=Math.floor(c/j);m=l*(Math.ceil(d/k)+1)}function d(){var b=Math.floor(i.content.scrollTop()/k)*l;n=a(".plupload_file",i.filelist).slice(b,b+m).filter(".plupload_file_loading").get()}function e(){function e(){if("thumbs"!==i.view_mode){return}c();d();g()}b(a(window),"resize",e);b(i.content,"scroll",e);i.element.on("viewchanged selected",e);e()}function f(b,c){var d=new h.image.Image,e=h.core.utils.Url.resolveUrl;d.onload=function(){var c=a("#"+b.id+" .plupload_file_thumb",i.filelist).html("");this.embed(c[0],{width:i.options.thumb_width,height:i.options.thumb_height,crop:!0,swf_url:e(i.options.flash_swf_url),xap_url:e(i.options.silverlight_xap_url)})};d.bind("embedded error",function(){a("#"+b.id,i.filelist).removeClass("plupload_file_loading");this.destroy();setTimeout(c,1)});d.load(b.getSource())}function g(){if("thumbs"!==i.view_mode||o){return}d();if(!n.length){return}o=!0;f(i.getFile(a(n.shift()).attr("id")),function(){o=!1;g()})}this.element.on("selected",function a(){i.element.off("selected",a);e()})};i.prototype._addFiles=function(c){var d=this,e,f="";e="<li class=\"media plupload_file plupload_delete\" id=\"{id}\" style=\"width:{thumb_width}px;\"><div class=\"media-body mb-1\"><div class=\"plupload_file_thumb plupload_thumb_toload\" style=\"width: {thumb_width}px; height: {thumb_height}px;\"><div class=\"plupload_file_dummy\" style=\"line-height: {thumb_height}px;\">{ext}</div></div><div class=\"plupload_file_name media-body mb-1\" title=\"{name}\"><span class=\"plupload_file_name_wrapper font-weight-bold\">{name} </span><span class=\"plupload_file_size ml-2 small\">({size})</span><span class=\"plupload_file_fields ml-2\"> </span><span class=\"plupload_file_action ml-2\"><span class=\"plupload_action_icon fa fa-minus-circle text-danger cursor-pointer\"> </span></span></div><div class=\"plupload_file_status mb-2 progress\"><div class=\"plupload_file_progress progress-bar progress-bar-striped\" style=\"width: 0%\"><span class=\"plupload_file_percent\">{percent} </span></div > </div></div></li>";if("array"!==b.typeOf(c)){c=[c]}a.each(c,function(a,c){var g=h.core.utils.Mime.getFileExtension(c.name)||"none";f+=e.replace(/\{(\w+)\}/g,function(a,e){switch(e){case"thumb_width":case"thumb_height":return d.options[e];case"size":return b.formatSize(c.size);case"ext":return g;default:return c[e]||"";}})});d.filelist.append(f)};i.prototype._addFormFields=function(){var c=this;a(".plupload_file_fields",this.filelist).html("");b.each(this.uploader.files,function(d,e){var f="",g=c.id+"_"+e;if(d.target_name){f+="<input type=\"hidden\" name=\""+g+"_tmpname\" value=\""+b.xmlEncode(d.target_name)+"\" />"}f+="<input type=\"hidden\" name=\""+g+"_name\" value=\""+b.xmlEncode(d.name)+"\" />";f+="<input type=\"hidden\" name=\""+g+"_status\" value=\""+(d.status===b.DONE?"done":"failed")+"\" />";a("#"+d.id).find(".plupload_file_fields").html(f)});this.counter.val(this.uploader.files.length)};i.prototype._viewChanged=function(c){if(this.options.views.remember&&a.cookie){a.cookie("plupload_ui_view",c,{expires:7,path:"/"})}if("IE"===b.ua.browser&&7>b.ua.version){this.content.attr("style","height:expression(document.getElementById(\""+this.id+"_container\").clientHeight - "+("list"===c?132:102)+")")}this.container.removeClass("plupload_view_list plupload_view_thumbs").addClass("plupload_view_"+c);this.view_mode=c;this._trigger("viewchanged",null,{view:c})};i.prototype._enableViewSwitcher=function(){var c=this,d,e=a(".plupload_view_switch",this.container),f,g;b.each(["list","thumbs"],function(a){if(!c.options.views[a]){e.find("[for=\""+c.id+"_view_"+a+"\"], #"+c.id+"_view_"+a).remove()}});f=e.find(".plupload_button");if(1===f.length){e.hide();d=f.eq(0).data("view");this._viewChanged(d)}else if(1<f.length){if(this.options.views.remember&&a.cookie){d=a.cookie("plupload_ui_view")}if(!~b.inArray(d,["list","thumbs"])){d=this.options.views.active}e.show().find(".btn").click(function(b){d=a(this).data("view");c._viewChanged(d);b.preventDefault()});g=e.find("[for=\""+c.id+"_view_"+d+"\"]");if(g.length){g.trigger("click")}}else{e.show();this._viewChanged(this.options.views.active)}if(this.options.views.thumbs){this._displayThumbs()}};i.prototype._enableRenaming=function(){var b=this;this.filelist.dblclick(function(c){var d=a(c.target),e,f,g,h,i="";if(!d.hasClass("plupload_file_name_wrapper")){return}fileContainer=d.closest(".plupload_file");if(!fileContainer.hasClass("plupload_delete")){return}f=b.uploader.getFile(d.closest(".plupload_file")[0].id);h=f.name;g=/^(.+)(\.[^.]+)$/.exec(h);if(g){h=g[1];i=g[2]}e=a("<input class=\"plupload_file_rename\" type=\"text\" />").width(d.width()).insertAfter(d.hide());e.val(h).blur(function(){d.show().parent().scrollLeft(0).end().next().remove()}).keydown(function(b){var c=a(this);if(-1!==a.inArray(b.keyCode,[13,27])){b.preventDefault();if(13===b.keyCode){f.name=c.val()+i;d.html(f.name)}c.blur()}})[0].focus()})};i.prototype._enableSortingList=function(){};function f(b){return this.each(function(){var c=a(this),d=c.data("bs.bsupload"),e="object"==_typeof(b)&&b;if(!d){c.data("bs.bsupload",d=new i(this,e))}})}var j=a.fn.bsupload;a.fn.bsupload=f;a.fn.bsupload.Constructor=i;a.fn.bsupload.noConflict=function(){a.fn.bsupload=j;return this};a(document).on("ready.bs.bsupload.data-api",function(){a("[data-toggle=\"bsupload\"]").each(function(){var b=a(this),c=a.extend({},b.data());f.call(b,c)})})});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a,b){var c=function(){var a={};b.apply(a,arguments);return a.plupload};if("function"==typeof define&&define.amd){define ("mod_vod/plupload",["mod_vod/moxie"],c)}else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){module.exports=c(require("./moxie"))}else{a.plupload=c(a.moxie)}})(this||window,function(a){(function(a,b,c){var e=window.setTimeout,f={},g=b.core.utils,h=b.runtime.Runtime;function d(a){var c=a.required_features,d={};function b(a,b,c){var e={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};if(e[a]){d[e[a]]=b}else if(!c){d[a]=b}}if("string"==typeof c){j.each(c.split(/\s*,\s*/),function(a){b(a,!0)})}else if("object"===_typeof(c)){j.each(c,function(a,c){b(c,a)})}else if(!0===c){if(a.chunk_size&&0<a.chunk_size){d.slice_blob=!0}if(!j.isEmptyObj(a.resize)||!1===a.multipart){d.send_binary_string=!0}if(a.http_method){d.use_http_method=a.http_method}j.each(a,function(a,c){b(c,!!a,!0)})}return d}var j={VERSION:"2.3.6",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,moxie:b,mimeTypes:g.Mime.mimes,ua:g.Env,typeOf:g.Basic.typeOf,extend:g.Basic.extend,guid:g.Basic.guid,getAll:function(a){var b=[],c;if("array"!==j.typeOf(a)){a=[a]}var d=a.length;while(d--){c=j.get(a[d]);if(c){b.push(c)}}return b.length?b:null},get:g.Dom.get,each:g.Basic.each,getPos:g.Dom.getPos,getSize:g.Dom.getSize,xmlEncode:function xmlEncode(a){var b={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"};return a?(""+a).replace(/[<>&\"\']/g,function(a){return b[a]?"&"+b[a]+";":a}):a},toArray:g.Basic.toArray,inArray:g.Basic.inArray,inSeries:g.Basic.inSeries,addI18n:b.core.I18n.addI18n,translate:b.core.I18n.translate,sprintf:g.Basic.sprintf,isEmptyObj:g.Basic.isEmptyObj,hasClass:g.Dom.hasClass,addClass:g.Dom.addClass,removeClass:g.Dom.removeClass,getStyle:g.Dom.getStyle,addEvent:g.Events.addEvent,removeEvent:g.Events.removeEvent,removeAllEvents:g.Events.removeAllEvents,cleanName:function cleanName(a){var b,c;c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<c.length;b+=2){a=a.replace(c[b],c[b+1])}a=a.replace(/\s+/g,"_");a=a.replace(/[^a-z0-9_\-\.]+/gi,"");return a},buildUrl:function buildUrl(a,b){var c="";j.each(b,function(a,b){c+=(c?"&":"")+encodeURIComponent(b)+"="+encodeURIComponent(a)});if(c){a+=(0<a.indexOf("?")?"&":"?")+c}return a},formatSize:function formatSize(a){if(a===c||/\D/.test(a)){return j.translate("N/A")}function b(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}var d=Math.pow(1024,4);if(a>d){return b(a/d,1)+" "+j.translate("tb")}if(a>(d/=1024)){return b(a/d,1)+" "+j.translate("gb")}if(a>(d/=1024)){return b(a/d,1)+" "+j.translate("mb")}if(1024<a){return Math.round(a/1024)+" "+j.translate("kb")}return a+" "+j.translate("b")},parseSize:g.Basic.parseSizeStr,predictRuntime:function predictRuntime(a,b){var c,d;c=new j.Uploader(a);d=h.thatCan(c.getOption().required_features,b||a.runtimes);c.destroy();return d},addFileFilter:function addFileFilter(a,b){f[a]=b}};j.addFileFilter("mime_types",function(a,b,c){if(a.length&&!a.regexp.test(b.name)){this.trigger("Error",{code:j.FILE_EXTENSION_ERROR,message:j.translate("File extension error."),file:b});c(!1)}else{c(!0)}});j.addFileFilter("max_file_size",function(a,b,c){var d;a=j.parseSize(a);if(b.size!==d&&a&&b.size>a){this.trigger("Error",{code:j.FILE_SIZE_ERROR,message:j.translate("File size error."),file:b});c(!1)}else{c(!0)}});j.addFileFilter("prevent_duplicates",function(a,b,c){if(a){var d=this.files.length;while(d--){if(b.name===this.files[d].name&&b.size===this.files[d].size){this.trigger("Error",{code:j.FILE_DUPLICATE_ERROR,message:j.translate("Duplicate file error."),file:b});c(!1);return}}}c(!0)});j.addFileFilter("prevent_empty",function(a,b,d){if(a&&!b.size&&b.size!==c){this.trigger("Error",{code:j.FILE_SIZE_ERROR,message:j.translate("File size error."),file:b});d(!1)}else{d(!0)}});j.Uploader=function(a){var y=j.guid(),z,A=[],B={},C=[],D=[],E,F,G=!1,H;function g(){var a,b=0,c;if(this.state==j.STARTED){for(c=0;c<A.length;c++){if(!a&&A[c].status==j.QUEUED){a=A[c];if(this.trigger("BeforeUpload",a)){a.status=j.UPLOADING;this.trigger("UploadFile",a)}}else{b++}}if(b==A.length){if(this.state!==j.STOPPED){this.state=j.STOPPED;this.trigger("StateChanged")}this.trigger("UploadComplete",A)}}}function i(a){a.percent=0<a.size?Math.ceil(100*(a.loaded/a.size)):100;k()}function k(){var a,b,d,e=0;F.reset();for(a=0;a<A.length;a++){b=A[a];if(b.size!==c){F.size+=b.origSize;d=b.loaded*b.origSize/b.size;if(!b.completeTimestamp||b.completeTimestamp>E){e+=d}F.loaded+=d}else{F.size=c}if(b.status==j.DONE){F.uploaded++}else if(b.status==j.FAILED){F.failed++}else{F.queued++}}if(F.size===c){F.percent=0<A.length?Math.ceil(100*(F.uploaded/A.length)):0}else{F.bytesPerSec=Math.ceil(e/((+new Date-E||1)/1e3));F.percent=0<F.size?Math.ceil(100*(F.loaded/F.size)):0}}function l(){var a=C[0]||D[0];if(a){return a.getRuntime().uid}return!1}function m(){this.bind("FilesAdded FilesRemoved",function(a){a.trigger("QueueChanged");a.refresh()});this.bind("CancelUpload",u);this.bind("BeforeUpload",q);this.bind("UploadFile",r);this.bind("UploadProgress",s);this.bind("StateChanged",t);this.bind("QueueChanged",k);this.bind("Error",w);this.bind("FileUploaded",v);this.bind("Destroy",x)}function n(a,c){var d=this,e=0,f=[],g={runtime_order:a.runtimes,required_caps:a.required_features,preferred_caps:B,swf_url:a.flash_swf_url,xap_url:a.silverlight_xap_url};j.each(a.runtimes.split(/\s*,\s*/),function(b){if(a[b]){g[b]=a[b]}});if(a.browse_button){j.each(a.browse_button,function(c){f.push(function(f){var i=new b.file.FileInput(j.extend({},g,{accept:a.filters.mime_types,name:a.file_data_name,multiple:a.multi_selection,container:a.container,browse_button:c}));i.onready=function(){var a=h.getInfo(this.ruid);j.extend(d.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),multi_selection:a.can("select_multiple")});e++;C.push(this);f()};i.onchange=function(){d.addFile(this.files)};i.bind("mouseenter mouseleave mousedown mouseup",function(b){if(!G){if(a.browse_button_hover){if("mouseenter"===b.type){j.addClass(c,a.browse_button_hover)}else if("mouseleave"===b.type){j.removeClass(c,a.browse_button_hover)}}if(a.browse_button_active){if("mousedown"===b.type){j.addClass(c,a.browse_button_active)}else if("mouseup"===b.type){j.removeClass(c,a.browse_button_active)}}}});i.bind("mousedown",function(){d.trigger("Browse")});i.bind("error runtimeerror",function(){i=null;f()});i.init()})})}if(a.drop_element){j.each(a.drop_element,function(a){f.push(function(c){var f=new b.file.FileDrop(j.extend({},g,{drop_zone:a}));f.onready=function(){var a=h.getInfo(this.ruid);j.extend(d.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),dragdrop:a.can("drag_and_drop")});e++;D.push(this);c()};f.ondrop=function(){d.addFile(this.files)};f.bind("error runtimeerror",function(){f=null;c()});f.init()})})}j.inSeries(f,function(){if("function"==typeof c){c(e)}})}function o(a,d,e,f){var g=new b.image.Image;try{g.onload=function(){if(d.width>this.width&&d.height>this.height&&d.quality===c&&d.preserve_headers&&!d.crop){this.destroy();f(a)}else{g.downsize(d.width,d.height,d.crop,d.preserve_headers)}};g.onresize=function(){var b=this.getAsBlob(a.type,d.quality);this.destroy();f(b)};g.bind("error runtimeerror",function(){this.destroy();f(a)});g.load(a,e)}catch(b){f(a)}}function p(a,c,e){var g=this,i=!1;function f(a,c,d){var e=z[a];switch(a){case"max_file_size":if("max_file_size"===a){z.max_file_size=z.filters.max_file_size=c}break;case"chunk_size":if(c=j.parseSize(c)){z[a]=c;z.send_file_name=!0}break;case"multipart":z[a]=c;if(!c){z.send_file_name=!0}break;case"http_method":z[a]="PUT"===c.toUpperCase()?"PUT":"POST";break;case"unique_names":z[a]=c;if(c){z.send_file_name=!0}break;case"filters":if("array"===j.typeOf(c)){c={mime_types:c}}if(d){j.extend(z.filters,c)}else{z.filters=c}if(c.mime_types){if("string"===j.typeOf(c.mime_types)){c.mime_types=b.core.utils.Mime.mimes2extList(c.mime_types)}c.mime_types.regexp=function(a){var b=[];j.each(a,function(a){j.each(a.extensions.split(/,/),function(a){if(/^\s*\*\s*$/.test(a)){b.push("\\.*")}else{b.push("\\."+a.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))}})});return new RegExp("("+b.join("|")+")$","i")}(c.mime_types);z.filters.mime_types=c.mime_types}break;case"resize":if(c){z.resize=j.extend({preserve_headers:!0,crop:!1},c)}else{z.resize=!1}break;case"prevent_duplicates":z.prevent_duplicates=z.filters.prevent_duplicates=!!c;break;case"container":case"browse_button":case"drop_element":c="container"===a?j.get(c):j.getAll(c);case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":z[a]=c;if(!d){i=!0}break;default:z[a]=c;}if(!d){g.trigger("OptionChanged",a,c,e)}}if("object"===_typeof(a)){j.each(a,function(a,b){f(b,a,e)})}else{f(a,c,e)}if(e){z.required_features=d(j.extend({},z));B=d(j.extend({},z,{required_features:!0}))}else if(i){g.trigger("Destroy");n.call(g,z,function(a){if(a){g.runtime=h.getInfo(l()).type;g.trigger("Init",{runtime:g.runtime});g.trigger("PostInit")}else{g.trigger("Error",{code:j.INIT_ERROR,message:j.translate("Init error.")})}})}}function q(a,b){if(a.settings.unique_names){var c=b.name.match(/\.([^.]+)$/),d="part";if(c){d=c[1]}b.target_name=b.id+"."+d}}function r(a,c){var h=a.settings.url,i=a.settings.chunk_size,k=a.settings.max_retries,l=a.features,m=0,n,p={runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:B,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url};if(c.loaded){m=c.loaded=i?i*Math.floor(c.loaded/i):0}function d(){if(0<k--){e(f,1e3)}else{c.loaded=m;a.trigger("Error",{code:j.HTTP_ERROR,message:j.translate("HTTP Error."),file:c,response:H.responseText,status:H.status,responseHeaders:H.getAllResponseHeaders()})}}function f(){var b,d={},e;if(c.status!==j.UPLOADING||a.state===j.STOPPED){return}if(a.settings.send_file_name){d.name=c.target_name||c.name}if(i&&l.chunks&&n.size>i){e=Math.min(i,n.size-m);b=n.slice(m,m+e)}else{e=n.size;b=n}if(i&&l.chunks){if(a.settings.send_chunk_number){d.chunk=Math.ceil(m/i);d.chunks=Math.ceil(n.size/i)}else{d.offset=m;d.total=n.size}}if(a.trigger("BeforeChunkUpload",c,d,b,m)){g(d,b,e)}}function g(g,i,o){var q;H=new b.xhr.XMLHttpRequest;if(H.upload){H.upload.onprogress=function(b){c.loaded=Math.min(c.size,m+b.loaded);a.trigger("UploadProgress",c)}}H.onload=function(){if(200>H.status||400<=H.status){d();return}k=a.settings.max_retries;if(o<n.size){i.destroy();m+=o;c.loaded=Math.min(m,n.size);a.trigger("ChunkUploaded",c,{offset:c.loaded,total:n.size,response:H.responseText,status:H.status,responseHeaders:H.getAllResponseHeaders()});if("Android Browser"===j.ua.browser){a.trigger("UploadProgress",c)}}else{c.loaded=c.size}i=q=null;if(!m||m>=n.size){if(c.size!=c.origSize){n.destroy();n=null}a.trigger("UploadProgress",c);c.status=j.DONE;c.completeTimestamp=+new Date;a.trigger("FileUploaded",c,{response:H.responseText,status:H.status,responseHeaders:H.getAllResponseHeaders()})}else{e(f,1)}};H.onerror=function(){d()};H.onloadend=function(){this.destroy()};if(a.settings.multipart&&l.multipart){H.open(a.settings.http_method,h,!0);j.each(a.settings.headers,function(a,b){H.setRequestHeader(b,a)});q=new b.xhr.FormData;j.each(j.extend(g,a.settings.multipart_params),function(a,b){q.append(b,a)});q.append(a.settings.file_data_name,i);H.send(q,p)}else{h=j.buildUrl(a.settings.url,j.extend(g,a.settings.multipart_params));H.open(a.settings.http_method,h,!0);j.each(a.settings.headers,function(a,b){H.setRequestHeader(b,a)});if(!H.hasRequestHeader("Content-Type")){H.setRequestHeader("Content-Type","application/octet-stream")}H.send(i,p)}}n=c.getSource();if(!j.isEmptyObj(a.settings.resize)&&-1!==j.inArray(n.type,["image/jpeg","image/png"])){o(n,a.settings.resize,p,function(a){n=a;c.size=a.size;f()})}else{f()}}function s(a,b){i(b)}function t(a){if(a.state==j.STARTED){E=+new Date}else if(a.state==j.STOPPED){for(var b=a.files.length-1;0<=b;b--){if(a.files[b].status==j.UPLOADING){a.files[b].status=j.QUEUED;k()}}}}function u(){if(H){H.abort()}}function v(a){k();e(function(){g.call(a)},1)}function w(a,b){if(b.code===j.INIT_ERROR){a.destroy()}else if(b.code===j.HTTP_ERROR){b.file.status=j.FAILED;b.file.completeTimestamp=+new Date;i(b.file);if(a.state==j.STARTED){a.trigger("CancelUpload");e(function(){g.call(a)},1)}}}function x(a){a.stop();j.each(A,function(a){a.destroy()});A=[];if(C.length){j.each(C,function(a){a.destroy()});C=[]}if(D.length){j.each(D,function(a){a.destroy()});D=[]}B={};G=!1;E=H=null;F.reset()}z={chunk_size:0,file_data_name:"file",filters:{mime_types:[],max_file_size:0,prevent_duplicates:!1,prevent_empty:!0},flash_swf_url:"js/Moxie.swf",http_method:"POST",max_retries:0,multipart:!0,multi_selection:!0,resize:!1,runtimes:h.order,send_file_name:!0,send_chunk_number:!0,silverlight_xap_url:"js/Moxie.xap"};p.call(this,a,null,!0);F=new j.QueueProgress;j.extend(this,{id:y,uid:y,state:j.STOPPED,features:{},runtime:null,files:A,settings:z,total:F,init:function init(){var a=this,b,c;b=a.getOption("preinit");if("function"==typeof b){b(a)}else{j.each(b,function(b,c){a.bind(c,b)})}m.call(a);j.each(["container","browse_button","drop_element"],function(b){if(null===a.getOption(b)){c={code:j.INIT_ERROR,message:j.sprintf(j.translate("%s specified, but cannot be found."),b)};return!1}});if(c){return a.trigger("Error",c)}if(!z.browse_button&&!z.drop_element){return a.trigger("Error",{code:j.INIT_ERROR,message:j.translate("You must specify either browse_button or drop_element.")})}n.call(a,z,function(b){var c=a.getOption("init");if("function"==typeof c){c(a)}else{j.each(c,function(b,c){a.bind(c,b)})}if(b){a.runtime=h.getInfo(l()).type;a.trigger("Init",{runtime:a.runtime});a.trigger("PostInit")}else{a.trigger("Error",{code:j.INIT_ERROR,message:j.translate("Init error.")})}})},setOption:function setOption(a,b){p.call(this,a,b,!this.runtime)},getOption:function getOption(a){if(!a){return z}return z[a]},refresh:function refresh(){if(C.length){j.each(C,function(a){a.trigger("Refresh")})}this.trigger("Refresh")},start:function start(){if(this.state!=j.STARTED){this.state=j.STARTED;this.trigger("StateChanged");g.call(this)}},stop:function stop(){if(this.state!=j.STOPPED){this.state=j.STOPPED;this.trigger("StateChanged");this.trigger("CancelUpload")}},disableBrowse:function disableBrowse(){G=arguments[0]!==c?arguments[0]:!0;if(C.length){j.each(C,function(a){a.disable(G)})}this.trigger("DisableBrowse",G)},getFile:function getFile(a){var b;for(b=A.length-1;0<=b;b--){if(A[b].id===a){return A[b]}}},addFile:function addFile(a,c){var h=this,i=[],k=[],m;function d(a,b){var c=[];j.each(h.settings.filters,function(b,d){if(f[d]){c.push(function(c){f[d].call(h,b,a,function(a){c(!a)})})}});j.inSeries(c,b)}function g(a){var f=j.typeOf(a);if(a instanceof b.file.File){if(!a.ruid&&!a.isDetached()){if(!m){return!1}a.ruid=m;a.connectRuntime(m)}g(new j.File(a))}else if(a instanceof b.file.Blob){g(a.getSource());a.destroy()}else if(a instanceof j.File){if(c){a.name=c}i.push(function(b){d(a,function(c){if(!c){A.push(a);k.push(a);h.trigger("FileFiltered",a)}e(b,1)})})}else if(-1!==j.inArray(f,["file","blob"])){g(new b.file.File(null,a))}else if("node"===f&&"filelist"===j.typeOf(a.files)){j.each(a.files,g)}else if("array"===f){c=null;j.each(a,g)}}m=l();g(a);if(i.length){j.inSeries(i,function(){if(k.length){h.trigger("FilesAdded",k)}})}},removeFile:function removeFile(a){for(var b="string"==typeof a?a:a.id,c=A.length-1;0<=c;c--){if(A[c].id===b){return this.splice(c,1)[0]}}},splice:function splice(a,b){var d=A.splice(a===c?0:a,b===c?A.length:b),e=!1;if(this.state==j.STARTED){j.each(d,function(a){if(a.status===j.UPLOADING){e=!0;return!1}});if(e){this.stop()}}this.trigger("FilesRemoved",d);j.each(d,function(a){a.destroy()});if(e){this.start()}return d},dispatchEvent:function dispatchEvent(a){var b,c;a=a.toLowerCase();b=this.hasEventListener(a);if(b){b.sort(function(c,a){return a.priority-c.priority});c=[].slice.call(arguments);c.shift();c.unshift(this);for(var d=0;d<b.length;d++){if(!1===b[d].fn.apply(b[d].scope,c)){return!1}}}return!0},bind:function bind(a,b,c,d){j.Uploader.prototype.bind.call(this,a,b,d,c)},destroy:function destroy(){this.trigger("Destroy");z=F=null;this.unbindAll()}})};j.Uploader.prototype=b.core.EventTarget.instance;j.File=function(){var a={};return function(b){j.extend(this,{id:j.guid(),name:b.name||b.fileName,type:b.type||"",relativePath:b.relativePath||"",size:b.fileSize||b.size,origSize:b.fileSize||b.size,loaded:0,percent:0,status:j.QUEUED,lastModifiedDate:b.lastModifiedDate||new Date().toLocaleString(),completeTimestamp:0,getNative:function getNative(){var a=this.getSource().getSource();return-1!==j.inArray(j.typeOf(a),["blob","file"])?a:null},getSource:function getSource(){if(!a[this.id]){return null}return a[this.id]},destroy:function destroy(){var b=this.getSource();if(b){b.destroy();delete a[this.id]}}});a[this.id]=b}}();j.QueueProgress=function(){var a=this;a.size=0;a.loaded=0;a.uploaded=0;a.failed=0;a.queued=0;a.percent=0;a.bytesPerSec=0;a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}};a.plupload=j})(this,a)});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a,b){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=b(require("video.js"),require("global/document")):"function"==typeof define&&define.amd?define ("mod_vod/videojs-contrib-quality-levels",["media_videojs/video-lazy"],b):a.videojsContribQualityLevels=b(a.videojs)})(this,function(a,b){'use strict';a=a&&a.hasOwnProperty("default")?a["default"]:a;b=b&&b.hasOwnProperty("default")?b["default"]:b;function c(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a;a.__proto__=b}function d(a){if(void 0===a){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return a}var e=function c(d){var e=this;if(a.browser.IS_IE8){e=b.createElement("custom");for(var f in c.prototype){if("constructor"!=f){e[f]=c.prototype[f]}}}e.id=d.id;e.label=e.id;e.width=d.width;e.height=d.height;e.bitrate=d.bandwidth;e.enabled_=d.enabled;Object.defineProperty(e,"enabled",{get:function(){return e.enabled_()},set:function(a){e.enabled_(a)}});return e},f=function(f){c(g,f);function g(){var c=f.call(this)||this;var e=d(d(c));if(a.browser.IS_IE8){e=b.createElement("custom");for(var h in g.prototype){if("constructor"!=h){e[h]=g.prototype[h]}}}e.levels_=[];e.selectedIndex_=-1;Object.defineProperty(e,"selectedIndex",{get:function(){return e.selectedIndex_}});Object.defineProperty(e,"length",{get:function(){return e.levels_.length}});return e||d(c)}var h=g.prototype;h.addQualityLevel=function(a){var b=this.getQualityLevelById(a.id);if(b){return b}var c=this.levels_.length;b=new e(a);if(!(""+c in this)){Object.defineProperty(this,c,{get:function(){return this.levels_[c]}})}this.levels_.push(b);this.trigger({qualityLevel:b,type:"addqualitylevel"});return b};h.removeQualityLevel=function(a){for(var b=null,c=0,d=this.length;c<d;c++){if(this[c]===a){b=this.levels_.splice(c,1)[0];if(this.selectedIndex_===c){this.selectedIndex_=-1}else if(this.selectedIndex_>c){this.selectedIndex_--}break}}if(b){this.trigger({qualityLevel:a,type:"removequalitylevel"})}return b};h.getQualityLevelById=function(a){for(var b=0,c=this.length,d;b<c;b++){d=this[b];if(d.id===a){return d}}return null};h.dispose=function(){this.selectedIndex_=-1;this.levels_.length=0};return g}(a.EventTarget);f.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(var g in f.prototype.allowedEvents_){f.prototype["on"+g]=null}var h=a.registerPlugin||a.plugin,i=function(a){var b=a.qualityLevels,c=new f;a.on("dispose",function d(){c.dispose();a.qualityLevels=b;a.off("dispose",d)});a.qualityLevels=function(){return c};a.qualityLevels.VERSION="2.0.9";return c},j=function(b){return i(this,a.mergeOptions({},b))};h("qualityLevels",j);j.VERSION="2.0.9";return j});
function _typeof2(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof2=function(a){return typeof a}}else{_typeof2=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof2(a)}(function(a,b){"object"===("undefined"==typeof exports?"undefined":_typeof2(exports))&&"undefined"!=typeof module?module.exports=b(require("video.js")):"function"==typeof define&&define.amd?define ("mod_vod/videojs-hls-quality-selector",["media_videojs/video-lazy"],b):a.videojsHlsQualitySelector=b(a.videojs)})(this,function(a){'use strict';a=a&&a.hasOwnProperty("default")?a["default"]:a;var c="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(a){return _typeof2(a)}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":_typeof2(a)},d=function(){function a(a){this.value=a}function b(b){var e,f;function c(e,f){try{var g=b[e](f),h=g.value;if(h instanceof a){Promise.resolve(h.value).then(function(a){c("next",a)},function(a){c("throw",a)})}else{d(g.done?"return":"normal",g.value)}}catch(a){d("throw",a)}}function d(a,b){switch(a){case"return":e.resolve({value:b,done:!0});break;case"throw":e.reject(b);break;default:e.resolve({value:b,done:!1});break;}e=e.next;if(e){c(e.key,e.arg)}else{f=null}}this._invoke=function(a,b){return new Promise(function(d,g){var h={key:a,arg:b,resolve:d,reject:g,next:null};if(f){f=f.next=h}else{e=f=h;c(a,b)}})};if("function"!=typeof b.return){this.return=void 0}}if("function"==typeof Symbol&&Symbol.asyncIterator){b.prototype[Symbol.asyncIterator]=function(){return this}}b.prototype.next=function(a){return this._invoke("next",a)};b.prototype.throw=function(a){return this._invoke("throw",a)};b.prototype.return=function(a){return this._invoke("return",a)};return{wrap:function wrap(a){return function(){return new b(a.apply(this,arguments))}},await:function _await(b){return new a(b)}}}(),e=function(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}},f=function(a,b){if("function"!=typeof b&&null!==b){throw new TypeError("Super expression must either be null or a function, not "+_typeof2(b))}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b},g=function(a,b){if(!a){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return b&&("object"===_typeof2(b)||"function"==typeof b)?b:a},h=a.getComponent("MenuButton"),j=a.getComponent("Menu"),k=a.getComponent("Component"),l=a.dom;function b(a){if("string"!=typeof a){return a}return a.charAt(0).toUpperCase()+a.slice(1)}var m=function(a){f(c,a);function c(b){e(this,c);return g(this,a.call(this,b,{title:b.localize("Quality")}))}c.prototype.createItems=function(){return[]};c.prototype.createMenu=function(){var a=new j(this.player_,{menuButton:this});this.hideThreshold_=0;if(this.options_.title){var c=l.createEl("li",{className:"vjs-menu-title",innerHTML:b(this.options_.title),tabIndex:-1}),d=new k(this.player_,{el:c});this.hideThreshold_+=1;a.addItem(d)}this.items=this.createItems();if(this.items){for(var e=0;e<this.items.length;e++){a.addItem(this.items[e])}}return a};return c}(h),n=a.getComponent("MenuItem"),o=function(a){f(b,a);function b(c,d,f,h){e(this,b);var i=g(this,a.call(this,c,{label:d.label,selectable:!0,selected:d.selected||!1}));i.item=d;i.qualityButton=f;i.plugin=h;return i}b.prototype.handleClick=function(){for(var a=0;a<this.qualityButton.items.length;++a){this.qualityButton.items[a].selected(!1)}this.plugin.setQuality(this.item.value);this.selected(!0)};return b}(n),p={},q=a.registerPlugin||a.plugin,r=function(){function a(b){e(this,a);this.player=b;if(this.player.qualityLevels&&this.getHls()){this.createQualityButton();this.bindPlayerEvents()}}a.prototype.getHls=function(){return this.player.tech({IWillNotUseThisInPlugins:!0}).hls};a.prototype.bindPlayerEvents=function(){this.player.qualityLevels().on("addqualitylevel",this.onAddQualityLevel.bind(this))};a.prototype.createQualityButton=function(){var a=this.player;this._qualityButton=new m(a);var b=a.controlBar.children().length-2,c=a.controlBar.addChild(this._qualityButton,{componentClass:"qualitySelector"},b);c.addClass("vjs-quality-selector");c.menuButton_.$(".vjs-icon-placeholder").className+=" vjs-icon-hd";c.removeClass("vjs-hidden")};a.prototype.getQualityMenuItem=function(a){var b=this.player;return new o(b,a,this._qualityButton,this)};a.prototype.onAddQualityLevel=function(){for(var a=this,b=this.player,d=b.qualityLevels(),e=d.levels_||[],f=[],g=function(b){if(!f.filter(function(a){return a.item&&a.item.value===e[b].height}).length){var c=a.getQualityMenuItem.call(a,{label:e[b].height+"p",value:e[b].height});f.push(c)}},h=0;h<e.length;++h){g(h)}f.sort(function(a,b){if("object"!==("undefined"==typeof a?"undefined":c(a))||"object"!==("undefined"==typeof b?"undefined":c(b))){return-1}if(a.item.value<b.item.value){return-1}if(a.item.value>b.item.value){return 1}return 0});f.push(this.getQualityMenuItem.call(this,{label:b.localize("Auto"),value:"auto",selected:!0}));if(this._qualityButton){this._qualityButton.createItems=function(){return f};this._qualityButton.update()}};a.prototype.setQuality=function(a){for(var b=this.player.qualityLevels(),c=0,d;c<b.length;++c){d=b[c];d.enabled=d.height===a||"auto"===a}this._qualityButton.unpressButton()};return a}(),s=function(a,b){a.addClass("vjs-hls-quality-selector");a.hlsQualitySelector=new r(a,b)},t=function(b){var c=this;this.ready(function(){s(c,a.mergeOptions(p,b))})};q("hlsQualitySelector",t);t.VERSION="1.0.5";return t});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a,b){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module){module.exports=b(require("video.js"))}else if("function"==typeof define&&define.amd){define ("mod_vod/videojs-hotkeys",["media_videojs/video-lazy"],b)}else{a.hotkeys=b(a.videojs)}})(this,function(a){"use strict";if("undefined"!=typeof window){window.videojs_hotkeys={version:"0.2.20"}}var b=a.registerPlugin||a.plugin;b("hotkeys",function hotkeys(b){var c=this,d=c.el(),e=document,f=1,g=2,h=3,i=4,j=5,k=6,l=7,m=a.mergeOptions||a.util.mergeOptions;b=m({volumeStep:.1,seekStep:5,enableMute:!0,enableVolumeScroll:!0,enableFullscreen:!0,enableNumbers:!0,enableJogStyle:!1,alwaysCaptureHotkeys:!1,enableModifiersForNumbers:!0,enableInactiveFocus:!0,skipInitialFocus:!1,playPauseKey:function(a){return 32===a.which||179===a.which},rewindKey:function(a){return 37===a.which||177===a.which},forwardKey:function(a){return 39===a.which||176===a.which},volumeUpKey:function(a){return 38===a.which},volumeDownKey:function(a){return 40===a.which},muteKey:function(a){return 77===a.which},fullscreenKey:function(a){return 70===a.which},customKeys:{}},b||{});var n=b.volumeStep,o=b.seekStep,p=b.enableMute,q=b.enableVolumeScroll,r=b.enableFullscreen,s=b.enableNumbers,t=b.enableJogStyle,u=b.alwaysCaptureHotkeys,v=b.enableModifiersForNumbers,w=b.enableInactiveFocus,x=b.skipInitialFocus;if(!d.hasAttribute("tabIndex")){d.setAttribute("tabIndex","-1")}d.style.outline="none";if(u||!c.autoplay()){if(!x){c.one("play",function(){d.focus()})}}if(w){c.on("userinactive",function(){var a=function(){clearTimeout(b)},b=setTimeout(function(){c.off("useractive",a);if(e.activeElement.parentElement==d.querySelector(".vjs-control-bar")){d.focus()}},10);c.one("useractive",a)})}c.on("play",function(){var a=d.querySelector(".iframeblocker");if(a&&""===a.style.display){a.style.display="block";a.style.bottom="39px"}});var y=function(a){var m=a.which,q,w,x=a.preventDefault,y=c.duration();if(c.controls()){var z=e.activeElement;if(u||z==d||z==d.querySelector(".vjs-tech")||z==d.querySelector(".vjs-control-bar")||z==d.querySelector(".iframeblocker")){switch(A(a,c)){case f:x();if(u){a.stopPropagation()}if(c.paused()){c.play()}else{c.pause()}break;case g:q=!c.paused();x();if(q){c.pause()}w=c.currentTime()-o;if(c.currentTime()<=o){w=0}c.currentTime(w);if(q){c.play()}break;case h:q=!c.paused();x();if(q){c.pause()}w=c.currentTime()+o;if(w>=y){w=q?y-.001:y}c.currentTime(w);if(q){c.play()}break;case j:x();if(!t){c.volume(c.volume()-n)}else{w=c.currentTime()-1;if(1>=c.currentTime()){w=0}c.currentTime(w)}break;case i:x();if(!t){c.volume(c.volume()+n)}else{w=c.currentTime()+1;if(w>=y){w=y}c.currentTime(w)}break;case k:if(p){c.muted(!c.muted())}break;case l:if(r){if(c.isFullscreen()){c.exitFullscreen()}else{c.requestFullscreen()}}break;default:if(47<m&&59>m||95<m&&106>m){if(v||!(a.metaKey||a.ctrlKey||a.altKey)){if(s){var B=48;if(95<m){B=96}var C=m-B;x();c.currentTime(.1*(c.duration()*C))}}}for(var D in b.customKeys){var E=b.customKeys[D];if(E&&E.key&&E.handler){if(E.key(a)){x();E.handler(c,b,a)}}}}}}},z=function(a){if(c.controls()){var b=a.relatedTarget||a.toElement||e.activeElement;if(u||b==d||b==d.querySelector(".vjs-tech")||b==d.querySelector(".iframeblocker")||b==d.querySelector(".vjs-control-bar")){if(q){a=window.event||a;var f=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail));a.preventDefault();if(1==f){c.volume(c.volume()+n)}else if(-1==f){c.volume(c.volume()-n)}}}}},A=function(a,c){if(b.playPauseKey(a,c)){return f}if(b.rewindKey(a,c)){return g}if(b.forwardKey(a,c)){return h}if(b.volumeUpKey(a,c)){return i}if(b.volumeDownKey(a,c)){return j}if(b.muteKey(a,c)){return k}if(b.fullscreenKey(a,c)){return l}};c.on("keydown",y);c.on("dblclick",function(a){if(c.controls()){var b=a.relatedTarget||a.toElement||e.activeElement;if(b==d||b==d.querySelector(".vjs-tech")||b==d.querySelector(".iframeblocker")){if(r){if(c.isFullscreen()){c.exitFullscreen()}else{c.requestFullscreen()}}}}});c.on("mousewheel",z);c.on("DOMMouseScroll",z);return this})});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports,require("video.js")):"function"==typeof define&&define.amd?define ("mod_vod/videojs-http-streaming",["exports","media_videojs/video-lazy"],t):t(e.videojsHttpStreaming={},e.videojs)})(this,function(e,t){'use strict';t=t&&t.hasOwnProperty("default")?t["default"]:t;var ce="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(e,t){return t={exports:{}},e(t,t.exports),t.exports}var ge="undefined"!=typeof ce?ce:"undefined"!=typeof window?window:{},ye;if("undefined"!=typeof document){ye=document}else{ye=ge["__GLOBAL_DOCUMENT_CACHE@4"];if(!ye){ye=ge["__GLOBAL_DOCUMENT_CACHE@4"]={}}}var fe=ye,_e=a(function(e){(function(){var t={buildAbsoluteURL:function(e,a,i){i=i||{};e=e.trim();a=a.trim();if(!a){if(!i.alwaysNormalize){return e}var n=t.parseURL(e);if(!n){throw new Error("Error trying to parse base URL.")}n.path=t.normalizePath(n.path);return t.buildURLFromParts(n)}var r=t.parseURL(a);if(!r){throw new Error("Error trying to parse relative URL.")}if(r.scheme){if(!i.alwaysNormalize){return a}r.path=t.normalizePath(r.path);return t.buildURLFromParts(r)}var s=t.parseURL(e);if(!s){throw new Error("Error trying to parse base URL.")}if(!s.netLoc&&s.path&&"/"!==s.path[0]){var d=/^([^\/?#]*)(.*)$/.exec(s.path);s.netLoc=d[1];s.path=d[2]}if(s.netLoc&&!s.path){s.path="/"}var o={scheme:s.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc){o.netLoc=s.netLoc;if("/"!==r.path[0]){if(!r.path){o.path=s.path;if(!r.params){o.params=s.params;if(!r.query){o.query=s.query}}}else{var l=s.path,u=l.substring(0,l.lastIndexOf("/")+1)+r.path;o.path=t.normalizePath(u)}}}if(null===o.path){o.path=i.alwaysNormalize?t.normalizePath(r.path):r.path}return t.buildURLFromParts(o)},parseURL:function(e){var t=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/.exec(e);if(!t){return null}return{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}},normalizePath:function(e){e=e.split("").reverse().join("").replace(/(?:\/|^)\.(?=\/)/g,"");while(e.length!==(e=e.replace(/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,"")).length){}return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=t})(ce)}),he;if("undefined"!=typeof window){he=window}else if("undefined"!=typeof ce){he=ce}else if("undefined"!=typeof self){he=self}else{he={}}var be=he,Te=function(e,t){if(/^[a-z]+:/i.test(t)){return t}if(!/\/\//i.test(e)){e=_e.buildAbsoluteURL(be.location.href,e)}return _e.buildAbsoluteURL(e,t)},Se=function(e,t,a){if(e&&a.responseURL&&t!==a.responseURL){return a.responseURL}return t};function i(){i=Object.assign||function(e){for(var t=1,a;t<arguments.length;t++){a=arguments[t];for(var n in a){if(Object.prototype.hasOwnProperty.call(a,n)){e[n]=a[n]}}}return e};return i.apply(this,arguments)}function n(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}function r(e){if(void 0===e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}var ve=function(){function e(){this.listeners={}}var t=e.prototype;t.on=function(e,t){if(!this.listeners[e]){this.listeners[e]=[]}this.listeners[e].push(t)};t.off=function(e,t){if(!this.listeners[e]){return!1}var a=this.listeners[e].indexOf(t);this.listeners[e].splice(a,1);return-1<a};t.trigger=function(e){var t=this.listeners[e],a,n,r;if(!t){return}if(2===arguments.length){n=t.length;for(a=0;a<n;++a){t[a].call(this,arguments[1])}}else{r=Array.prototype.slice.call(arguments,1);n=t.length;for(a=0;a<n;++a){t[a].apply(this,r)}}};t.dispose=function(){this.listeners={}};t.pipe=function(e){this.on("data",function(t){e.push(t)})};return e}(),ke=function(e){n(t,e);function t(){var t=e.call(this)||this;t.buffer="";return t}var a=t.prototype;a.push=function(e){var t;this.buffer+=e;t=this.buffer.indexOf("\n");for(;-1<t;t=this.buffer.indexOf("\n")){this.trigger("data",this.buffer.substring(0,t));this.buffer=this.buffer.substring(t+1)}};return t}(ve),Ie=function(){return new RegExp("(?:^|,)("+("(?:[^=]*)=(?:"+"\"[^\"]*\"|[^,]*"+")")+")")},Ee=function(e){var t=e.split(Ie()),a={},n=t.length,r;while(n--){if(""===t[n]){continue}r=/([^=]*)=(.*)/.exec(t[n]).slice(1);r[0]=r[0].replace(/^\s+|\s+$/g,"");r[1]=r[1].replace(/^\s+|\s+$/g,"");r[1]=r[1].replace(/^['"](.*)['"]$/g,"$1");a[r[0]]=r[1]}return a},Le=function(e){n(t,e);function t(){var t=e.call(this)||this;t.customParsers=[];t.tagMappers=[];return t}var a=t.prototype;a.push=function(e){var t=this,a,i;e=e.trim();if(0===e.length){return}if("#"!==e[0]){this.trigger("data",{type:"uri",uri:e});return}var n=this.tagMappers.reduce(function(t,a){var i=a(e);if(i===e){return t}return t.concat([i])},[e]);n.forEach(function(e){for(var n=0;n<t.customParsers.length;n++){if(t.customParsers[n].call(t,e)){return}}if(0!==e.indexOf("#EXT")){t.trigger("data",{type:"comment",text:e.slice(1)});return}e=e.replace("\r","");a=/^#EXTM3U/.exec(e);if(a){t.trigger("data",{type:"tag",tagType:"m3u"});return}a=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e);if(a){i={type:"tag",tagType:"inf"};if(a[1]){i.duration=parseFloat(a[1])}if(a[2]){i.title=a[2]}t.trigger("data",i);return}a=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e);if(a){i={type:"tag",tagType:"targetduration"};if(a[1]){i.duration=parseInt(a[1],10)}t.trigger("data",i);return}a=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e);if(a){i={type:"tag",tagType:"totalduration"};if(a[1]){i.duration=parseInt(a[1],10)}t.trigger("data",i);return}a=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e);if(a){i={type:"tag",tagType:"version"};if(a[1]){i.version=parseInt(a[1],10)}t.trigger("data",i);return}a=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e);if(a){i={type:"tag",tagType:"media-sequence"};if(a[1]){i.number=parseInt(a[1],10)}t.trigger("data",i);return}a=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e);if(a){i={type:"tag",tagType:"discontinuity-sequence"};if(a[1]){i.number=parseInt(a[1],10)}t.trigger("data",i);return}a=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e);if(a){i={type:"tag",tagType:"playlist-type"};if(a[1]){i.playlistType=a[1]}t.trigger("data",i);return}a=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e);if(a){i={type:"tag",tagType:"byterange"};if(a[1]){i.length=parseInt(a[1],10)}if(a[2]){i.offset=parseInt(a[2],10)}t.trigger("data",i);return}a=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e);if(a){i={type:"tag",tagType:"allow-cache"};if(a[1]){i.allowed=!/NO/.test(a[1])}t.trigger("data",i);return}a=/^#EXT-X-MAP:?(.*)$/.exec(e);if(a){i={type:"tag",tagType:"map"};if(a[1]){var r=Ee(a[1]);if(r.URI){i.uri=r.URI}if(r.BYTERANGE){var s=r.BYTERANGE.split("@"),d=s[0],o=s[1];i.byterange={};if(d){i.byterange.length=parseInt(d,10)}if(o){i.byterange.offset=parseInt(o,10)}}}t.trigger("data",i);return}a=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e);if(a){i={type:"tag",tagType:"stream-inf"};if(a[1]){i.attributes=Ee(a[1]);if(i.attributes.RESOLUTION){var l=i.attributes.RESOLUTION.split("x"),u={};if(l[0]){u.width=parseInt(l[0],10)}if(l[1]){u.height=parseInt(l[1],10)}i.attributes.RESOLUTION=u}if(i.attributes.BANDWIDTH){i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)}if(i.attributes["PROGRAM-ID"]){i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10)}}t.trigger("data",i);return}a=/^#EXT-X-MEDIA:?(.*)$/.exec(e);if(a){i={type:"tag",tagType:"media"};if(a[1]){i.attributes=Ee(a[1])}t.trigger("data",i);return}a=/^#EXT-X-ENDLIST/.exec(e);if(a){t.trigger("data",{type:"tag",tagType:"endlist"});return}a=/^#EXT-X-DISCONTINUITY/.exec(e);if(a){t.trigger("data",{type:"tag",tagType:"discontinuity"});return}a=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e);if(a){i={type:"tag",tagType:"program-date-time"};if(a[1]){i.dateTimeString=a[1];i.dateTimeObject=new Date(a[1])}t.trigger("data",i);return}a=/^#EXT-X-KEY:?(.*)$/.exec(e);if(a){i={type:"tag",tagType:"key"};if(a[1]){i.attributes=Ee(a[1]);if(i.attributes.IV){if("0x"===i.attributes.IV.substring(0,2).toLowerCase()){i.attributes.IV=i.attributes.IV.substring(2)}i.attributes.IV=i.attributes.IV.match(/.{8}/g);i.attributes.IV[0]=parseInt(i.attributes.IV[0],16);i.attributes.IV[1]=parseInt(i.attributes.IV[1],16);i.attributes.IV[2]=parseInt(i.attributes.IV[2],16);i.attributes.IV[3]=parseInt(i.attributes.IV[3],16);i.attributes.IV=new Uint32Array(i.attributes.IV)}}t.trigger("data",i);return}a=/^#EXT-X-START:?(.*)$/.exec(e);if(a){i={type:"tag",tagType:"start"};if(a[1]){i.attributes=Ee(a[1]);i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]);i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)}t.trigger("data",i);return}a=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e);if(a){i={type:"tag",tagType:"cue-out-cont"};if(a[1]){i.data=a[1]}else{i.data=""}t.trigger("data",i);return}a=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e);if(a){i={type:"tag",tagType:"cue-out"};if(a[1]){i.data=a[1]}else{i.data=""}t.trigger("data",i);return}a=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e);if(a){i={type:"tag",tagType:"cue-in"};if(a[1]){i.data=a[1]}else{i.data=""}t.trigger("data",i);return}t.trigger("data",{type:"tag",data:e.slice(4)})})};a.addParser=function(e){var t=this,a=e.expression,i=e.customType,n=e.dataParser,r=e.segment;if("function"!=typeof n){n=function(e){return e}}this.customParsers.push(function(e){var s=a.exec(e);if(s){t.trigger("data",{type:"custom",data:n(e),customType:i,segment:r});return!0}})};a.addTagMapper=function(e){var t=e.expression,a=e.map;this.tagMappers.push(function(e){if(t.test(e)){return a(e)}return e})};return t}(ve);function s(e){for(var t=be.atob(e||""),a=new Uint8Array(t.length),n=0;n<t.length;n++){a[n]=t.charCodeAt(n)}return a}var Ce=function(e){n(t,e);function t(){var t=e.call(this)||this;t.lineStream=new ke;t.parseStream=new Le;t.lineStream.pipe(t.parseStream);var a=r(t),n=[],d={},o,l,u=function(){},p={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},m=0;t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};t.parseStream.on("data",function(e){var t,r;({tag:function(){(({"allow-cache":function(){this.manifest.allowCache=e.allowed;if(!("allowed"in e)){this.trigger("info",{message:"defaulting allowCache to YES"});this.manifest.allowCache=!0}},byterange:function t(){var t={};if("length"in e){d.byterange=t;t.length=e.length;if(!("offset"in e)){this.trigger("info",{message:"defaulting offset to zero"});e.offset=0}}if("offset"in e){d.byterange=t;t.offset=e.offset}},endlist:function(){this.manifest.endList=!0},inf:function(){if(!("mediaSequence"in this.manifest)){this.manifest.mediaSequence=0;this.trigger("info",{message:"defaulting media sequence to zero"})}if(!("discontinuitySequence"in this.manifest)){this.manifest.discontinuitySequence=0;this.trigger("info",{message:"defaulting discontinuity sequence to zero"})}if(0<e.duration){d.duration=e.duration}if(0===e.duration){d.duration=.01;this.trigger("info",{message:"updating zero segment duration to a small value"})}this.manifest.segments=n},key:function(){if(!e.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if("NONE"===e.attributes.METHOD){l=null;return}if(!e.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(e.attributes.KEYFORMAT==="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"){if(-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD)){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if("SAMPLE-AES-CENC"===e.attributes.METHOD){this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"})}if("data:text/plain;base64,"!==e.attributes.URI.substring(0,23)){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2))){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:s(e.attributes.URI.split(",")[1])}};return}if(!e.attributes.METHOD){this.trigger("warn",{message:"defaulting key method to AES-128"})}l={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI};if("undefined"!=typeof e.attributes.IV){l.iv=e.attributes.IV}},"media-sequence":function(){if(!isFinite(e.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number});return}this.manifest.mediaSequence=e.number},"discontinuity-sequence":function(){if(!isFinite(e.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number});return}this.manifest.discontinuitySequence=e.number;m=e.number},"playlist-type":function(){if(!/VOD|EVENT/.test(e.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist});return}this.manifest.playlistType=e.playlistType},map:function(){o={};if(e.uri){o.uri=e.uri}if(e.byterange){o.byterange=e.byterange}},"stream-inf":function(){this.manifest.playlists=n;this.manifest.mediaGroups=this.manifest.mediaGroups||p;if(!e.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}if(!d.attributes){d.attributes={}}i(d.attributes,e.attributes)},media:function(){this.manifest.mediaGroups=this.manifest.mediaGroups||p;if(!(e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}var a=this.manifest.mediaGroups[e.attributes.TYPE];a[e.attributes["GROUP-ID"]]=a[e.attributes["GROUP-ID"]]||{};t=a[e.attributes["GROUP-ID"]];r={default:/yes/i.test(e.attributes.DEFAULT)};if(r.default){r.autoselect=!0}else{r.autoselect=/yes/i.test(e.attributes.AUTOSELECT)}if(e.attributes.LANGUAGE){r.language=e.attributes.LANGUAGE}if(e.attributes.URI){r.uri=e.attributes.URI}if(e.attributes["INSTREAM-ID"]){r.instreamId=e.attributes["INSTREAM-ID"]}if(e.attributes.CHARACTERISTICS){r.characteristics=e.attributes.CHARACTERISTICS}if(e.attributes.FORCED){r.forced=/yes/i.test(e.attributes.FORCED)}t[e.attributes.NAME]=r},discontinuity:function(){m+=1;d.discontinuity=!0;this.manifest.discontinuityStarts.push(n.length)},"program-date-time":function(){if("undefined"==typeof this.manifest.dateTimeString){this.manifest.dateTimeString=e.dateTimeString;this.manifest.dateTimeObject=e.dateTimeObject}d.dateTimeString=e.dateTimeString;d.dateTimeObject=e.dateTimeObject},targetduration:function(){if(!isFinite(e.duration)||0>e.duration){this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration});return}this.manifest.targetDuration=e.duration},totalduration:function(){if(!isFinite(e.duration)||0>e.duration){this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration});return}this.manifest.totalDuration=e.duration},start:function(){if(!e.attributes||isNaN(e.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}},"cue-out":function(){d.cueOut=e.data},"cue-out-cont":function(){d.cueOutCont=e.data},"cue-in":function(){d.cueIn=e.data}})[e.tagType]||u).call(a)},uri:function(){d.uri=e.uri;n.push(d);if(this.manifest.targetDuration&&!("duration"in d)){this.trigger("warn",{message:"defaulting segment duration to the target duration"});d.duration=this.manifest.targetDuration}if(l){d.key=l}d.timeline=m;if(o){d.map=o}d={}},comment:function(){},custom:function(){if(e.segment){d.custom=d.custom||{};d.custom[e.customType]=e.data}else{this.manifest.custom=this.manifest.custom||{};this.manifest.custom[e.customType]=e.data}}})[e.type].call(a)});return t}var a=t.prototype;a.push=function(e){this.lineStream.push(e)};a.end=function(){this.lineStream.push("\n")};a.addParser=function(e){this.parseStream.addParser(e)};a.addTagMapper=function(e){this.parseStream.addTagMapper(e)};return t}(ve),De=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}},Pe=function(){function e(e,t){for(var a=0,n;a<t.length;a++){n=t[a];n.enumerable=n.enumerable||!1;n.configurable=!0;if("value"in n)n.writable=!0;Object.defineProperty(e,n.key,n)}}return function(t,a,i){if(a)e(t.prototype,a);if(i)e(t,i);return t}}(),Oe=function e(t,a,i){if(null===t)t=Function.prototype;var n=Object.getOwnPropertyDescriptor(t,a);if(n===void 0){var r=Object.getPrototypeOf(t);if(null===r){}else{return e(r,a,i)}}else if("value"in n){return n.value}else{var s=n.get;if(s===void 0){return}return s.call(i)}},xe=function(e,t){if("function"!=typeof t&&null!==t){throw new TypeError("Super expression must either be null or a function, not "+_typeof(t))}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t},Ue=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&("object"===_typeof(t)||"function"==typeof t)?t:e},Re=function(){function e(e,t){var a=[],i=!0,n=!1,r=void 0;try{for(var s=e[Symbol.iterator](),d;!(i=(d=s.next()).done);i=!0){a.push(d.value);if(t&&a.length===t)break}}catch(e){n=!0;r=e}finally{try{if(!i&&s["return"])s["return"]()}finally{if(n)throw r}}return a}return function(t,a){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,a)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}(),Ae=t.mergeOptions,Ne=t.EventTarget,we=t.log,Be=function(e,t){["AUDIO","SUBTITLES"].forEach(function(a){for(var i in e.mediaGroups[a]){for(var n in e.mediaGroups[a][i]){var r=e.mediaGroups[a][i][n];t(r,a,i,n)}}})},Me=function(e,t,a){var n=t.slice();a=a||0;for(var r=Math.min(e.length,t.length+a),s=a;s<r;s++){n[s-a]=Ae(e[s],n[s-a])}return n},qe=function(e,t){if(!e.resolvedUri){e.resolvedUri=Te(t,e.uri)}if(e.key&&!e.key.resolvedUri){e.key.resolvedUri=Te(t,e.key.uri)}if(e.map&&!e.map.resolvedUri){e.map.resolvedUri=Te(t,e.map.uri)}},Fe=function(e,t){var a=Ae(e,{}),n=a.playlists[t.id];if(!n){return null}if(n.segments&&t.segments&&n.segments.length===t.segments.length&&n.endList===t.endList&&n.mediaSequence===t.mediaSequence){return null}var r=Ae(n,t);if(n.segments){r.segments=Me(n.segments,t.segments,t.mediaSequence-n.mediaSequence)}r.segments.forEach(function(e){qe(e,r.resolvedUri)});for(var s=0;s<a.playlists.length;s++){if(a.playlists[s].id===t.id){a.playlists[s]=r}}a.playlists[t.id]=r;a.playlists[t.uri]=r;return a},He=function(e,t){return e+"-"+t},Ge=function(e){var t=e.playlists.length;while(t--){var a=e.playlists[t];a.resolvedUri=Te(e.uri,a.uri);a.id=He(t,a.uri);e.playlists[a.id]=a;e.playlists[a.uri]=a;if(!a.attributes){a.attributes={};we.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}},Ve=function(e){Be(e,function(t){if(t.uri){t.resolvedUri=Te(e.uri,t.uri)}})},We=function(e,t){var a=e.segments[e.segments.length-1],i=void 0;if(t&&a&&a.duration){i=1e3*a.duration}else{i=500*(e.targetDuration||10)}return i},ze=function(e){xe(t,e);function t(e,a){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};De(this,t);var n=Ue(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),r=i.withCredentials,s=r===void 0?!1:r,d=i.handleManifestRedirects,o=d===void 0?!1:d;n.srcUrl=e;n.hls_=a;n.withCredentials=s;n.handleManifestRedirects=o;var l=a.options_;n.customTagParsers=l&&l.customTagParsers||[];n.customTagMappers=l&&l.customTagMappers||[];if(!n.srcUrl){throw new Error("A non-empty playlist URL is required")}n.state="HAVE_NOTHING";n.on("mediaupdatetimeout",function(){if("HAVE_METADATA"!==n.state){return}n.state="HAVE_CURRENT_METADATA";n.request=n.hls_.xhr({uri:Te(n.master.uri,n.media().uri),withCredentials:n.withCredentials},function(e){if(!n.request){return}if(e){return n.playlistRequestError(n.request,n.media(),"HAVE_METADATA")}n.haveMetadata(n.request,n.media().uri,n.media().id)})});return n}Pe(t,[{key:"playlistRequestError",value:function(e,t,a){var i=t.uri,n=t.id;this.request=null;if(a){this.state=a}this.error={playlist:this.master.playlists[n],status:e.status,message:"HLS playlist request error at URL: "+i+".",responseText:e.responseText,code:500<=e.status?4:2};this.trigger("error")}},{key:"haveMetadata",value:function(e,t,a){var i=this;this.request=null;this.state="HAVE_METADATA";var n=new Ce;this.customTagParsers.forEach(function(e){return n.addParser(e)});this.customTagMappers.forEach(function(e){return n.addTagMapper(e)});n.push(e.responseText);n.end();n.manifest.uri=t;n.manifest.id=a;n.manifest.attributes=n.manifest.attributes||{};var r=Fe(this.master,n.manifest);this.targetDuration=n.manifest.targetDuration;if(r){this.master=r;this.media_=this.master.playlists[a]}else{this.trigger("playlistunchanged")}if(!this.media().endList){be.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=be.setTimeout(function(){i.trigger("mediaupdatetimeout")},We(this.media(),!!r))}this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.trigger("dispose");this.stopRequest();be.clearTimeout(this.mediaUpdateTimeout);be.clearTimeout(this.finalRenditionTimeout);this.off()}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null;e.onreadystatechange=null;e.abort()}}},{key:"media",value:function(e,t){var a=this;if(!e){return this.media_}if("HAVE_NOTHING"===this.state){throw new Error("Cannot switch media playlist from "+this.state)}if("string"==typeof e){if(!this.master.playlists[e]){throw new Error("Unknown playlist URI: "+e)}e=this.master.playlists[e]}be.clearTimeout(this.finalRenditionTimeout);if(t){var i=1e3*(e.targetDuration/2)||5000;this.finalRenditionTimeout=be.setTimeout(this.media.bind(this,e,!1),i);return}var n=this.state,r=!this.media_||e.id!==this.media_.id;if(this.master.playlists[e.id].endList){if(this.request){this.request.onreadystatechange=null;this.request.abort();this.request=null}this.state="HAVE_METADATA";this.media_=e;if(r){this.trigger("mediachanging");this.trigger("mediachange")}return}if(!r){return}this.state="SWITCHING_MEDIA";if(this.request){if(e.resolvedUri===this.request.url){return}this.request.onreadystatechange=null;this.request.abort();this.request=null}if(this.media_){this.trigger("mediachanging")}this.request=this.hls_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},function(t,i){if(!a.request){return}e.resolvedUri=Se(a.handleManifestRedirects,e.resolvedUri,i);if(t){return a.playlistRequestError(a.request,e,n)}a.haveMetadata(i,e.uri,e.id);if("HAVE_MASTER"===n){a.trigger("loadedmetadata")}else{a.trigger("mediachange")}})}},{key:"pause",value:function(){this.stopRequest();be.clearTimeout(this.mediaUpdateTimeout);if("HAVE_NOTHING"===this.state){this.started=!1}if("SWITCHING_MEDIA"===this.state){if(this.media_){this.state="HAVE_METADATA"}else{this.state="HAVE_MASTER"}}else if("HAVE_CURRENT_METADATA"===this.state){this.state="HAVE_METADATA"}}},{key:"load",value:function(e){var t=this;be.clearTimeout(this.mediaUpdateTimeout);var a=this.media();if(e){var i=a?1e3*(a.targetDuration/2):5000;this.mediaUpdateTimeout=be.setTimeout(function(){return t.load()},i);return}if(!this.started){this.start();return}if(a&&!a.endList){this.trigger("mediaupdatetimeout")}else{this.trigger("loadedplaylist")}}},{key:"start",value:function(){var e=this;this.started=!0;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(t,a){if(!e.request){return}e.request=null;if(t){e.error={status:a.status,message:"HLS playlist request error at URL: "+e.srcUrl+".",responseText:a.responseText,code:2};if("HAVE_NOTHING"===e.state){e.started=!1}return e.trigger("error")}var i=new Ce;e.customTagParsers.forEach(function(e){return i.addParser(e)});e.customTagMappers.forEach(function(e){return i.addTagMapper(e)});i.push(a.responseText);i.end();e.state="HAVE_MASTER";e.srcUrl=Se(e.handleManifestRedirects,e.srcUrl,a);i.manifest.uri=e.srcUrl;if(i.manifest.playlists){e.master=i.manifest;Ge(e.master);Ve(e.master);e.trigger("loadedplaylist");if(!e.request){e.media(i.manifest.playlists[0])}return}var n=He(0,e.srcUrl);e.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:be.location.href,playlists:[{uri:e.srcUrl,id:n,resolvedUri:e.srcUrl,attributes:{}}]};e.master.playlists[n]=e.master.playlists[0];e.master.playlists[e.srcUrl]=e.master.playlists[0];e.haveMetadata(a,e.srcUrl,n);return e.trigger("loadedmetadata")})}}]);return t}(Ne),je=t.createTimeRange,Ye=function(e,t){var a=0,n=t-e.mediaSequence,r=e.segments[n];if(r){if("undefined"!=typeof r.start){return{result:r.start,precise:!0}}if("undefined"!=typeof r.end){return{result:r.end-r.duration,precise:!0}}}while(n--){r=e.segments[n];if("undefined"!=typeof r.end){return{result:a+r.end,precise:!0}}a+=r.duration;if("undefined"!=typeof r.start){return{result:a+r.start,precise:!0}}}return{result:a,precise:!1}},Xe=function(e,t){var a=0,n=void 0,r=t-e.mediaSequence;for(;r<e.segments.length;r++){n=e.segments[r];if("undefined"!=typeof n.start){return{result:n.start-a,precise:!0}}a+=n.duration;if("undefined"!=typeof n.end){return{result:n.end-a,precise:!0}}}return{result:-1,precise:!1}},Ke=function(e,t,a){var i=void 0,n=void 0;if("undefined"==typeof t){t=e.mediaSequence+e.segments.length}if(t<e.mediaSequence){return 0}i=Ye(e,t);if(i.precise){return i.result}n=Xe(e,t);if(n.precise){return n.result}return i.result+a},Qe=function(e,t,a){if(!e){return 0}if("number"!=typeof a){a=0}if("undefined"==typeof t){if(e.totalDuration){return e.totalDuration}if(!e.endList){return be.Infinity}}return Ke(e,t,a)},$e=function(e,t,a){var n=0;if(t>a){var r=[a,t];t=r[0];a=r[1]}if(0>t){for(var s=t;s<Math.min(0,a);s++){n+=e.targetDuration}t=0}for(var d=t;d<a;d++){n+=e.segments[d].duration}return n},Ze=function(e,t){if(!e.segments.length){return 0}var a=e.segments.length,n=e.segments[a-1].duration||e.targetDuration,r="number"==typeof t?t:n+2*e.targetDuration;if(0===r){return a}var s=0;while(a--){s+=e.segments[a].duration;if(s>=r){break}}return Math.max(0,a)},Je=function(e,t,a,i){if(!e||!e.segments){return null}if(e.endList){return Qe(e)}if(null===t){return null}t=t||0;var n=a?Ze(e,i):e.segments.length;return Ke(e,e.mediaSequence+n,t)},et=function(e){return 0==e-Math.floor(e)},tt=function(e,t){if(et(t)){return t+.1*e}for(var a=t.toString().split(".")[1].length,n=1;n<=a;n++){var r=Math.pow(10,n),s=t*r;if(et(s)||n===a){return(s+e)/r}}},at=tt.bind(null,1),it=tt.bind(null,-1),nt=function(e,t,a,n){var r=void 0,s=void 0,d=e.segments.length,o=t-n;if(0>o){if(0<a){for(r=a-1;0<=r;r--){s=e.segments[r];o+=it(s.duration);if(0<o){return{mediaIndex:r,startTime:n-$e(e,a,r)}}}}return{mediaIndex:0,startTime:t}}if(0>a){for(r=a;0>r;r++){o-=e.targetDuration;if(0>o){return{mediaIndex:0,startTime:t}}}a=0}for(r=a;r<d;r++){s=e.segments[r];o-=at(s.duration);if(0>o){return{mediaIndex:r,startTime:n+$e(e,a,r)}}}return{mediaIndex:d-1,startTime:t}},rt=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},st=function(e){return e.excludeUntil&&e.excludeUntil===1/0},dt=function(e){var t=rt(e);return!e.disabled&&!t},ot=function(e,t){return t.attributes&&t.attributes[e]},lt=function(e,t){if(1===e.playlists.length){return!0}var a=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter(function(e){if(!dt(e)){return!1}return(e.attributes.BANDWIDTH||0)<a}).length},ut={duration:Qe,seekable:function(e,t,a){var i=Je(e,t,!0,a);if(null===i){return je()}return je(t||0,i)},safeLiveIndex:Ze,getMediaInfoForTime:nt,isEnabled:dt,isDisabled:function(e){return e.disabled},isBlacklisted:rt,isIncompatible:st,playlistEnd:Je,isAes:function(e){for(var t=0;t<e.segments.length;t++){if(e.segments[t].key){return!0}}return!1},isFmp4:function(e){for(var t=0;t<e.segments.length;t++){if(e.segments[t].map){return!0}}return!1},hasAttribute:ot,estimateSegmentRequestTime:function(e,t,a){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:0;if(!ot("BANDWIDTH",a)){return NaN}var n=e*a.attributes.BANDWIDTH;return(n-8*i)/t},isLowestEnabledRendition:lt},pt=t.xhr,mt=t.mergeOptions,ct=function(){var e=function e(a,i){a=mt({timeout:45e3},a);var n=e.beforeRequest||t.Hls.xhr.beforeRequest;if(n&&"function"==typeof n){var r=n(a);if(r){a=r}}var s=pt(a,function(e,t){var a=s.response;if(!e&&a){s.responseTime=Date.now();s.roundTripTime=s.responseTime-s.requestTime;s.bytesReceived=a.byteLength||a.length;if(!s.bandwidth){s.bandwidth=Math.floor(1e3*(8*(s.bytesReceived/s.roundTripTime)))}}if(t.headers){s.responseHeaders=t.headers}if(e&&"ETIMEDOUT"===e.code){s.timedout=!0}if(!e&&!s.aborted&&200!==t.statusCode&&206!==t.statusCode&&0!==t.statusCode){e=new Error("XHR Failed with a response of: "+(s&&(a||s.responseText)))}i(e,s)}),d=s.abort;s.abort=function(){s.aborted=!0;return d.apply(s,arguments)};s.uri=a.uri;s.requestTime=Date.now();return s};return e},gt=function(e){var t=void 0,a=void 0;a=e.offset+e.length-1;t=e.offset;return"bytes="+t+"-"+a},yt=function(e){var t={};if(e.byterange){t.Range=gt(e.byterange)}return t};function d(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var ft=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}},_t=function(){function e(e,t){for(var a=0,n;a<t.length;a++){n=t[a];n.enumerable=n.enumerable||!1;n.configurable=!0;if("value"in n)n.writable=!0;Object.defineProperty(e,n.key,n)}}return function(t,a,i){if(a)e(t.prototype,a);if(i)e(t,i);return t}}(),ht=function(e,t){if("function"!=typeof t&&null!==t){throw new TypeError("Super expression must either be null or a function, not "+_typeof(t))}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t},bt=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&("object"===_typeof(t)||"function"==typeof t)?t:e},Tt=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],a=e[1],n=t[4],r=a[4],o=void 0,l=void 0,u=void 0,p=[],d=[],m=void 0,c=void 0,g=void 0,y=void 0,f=void 0,_=void 0;for(o=0;256>o;o++){d[(p[o]=o<<1^283*(o>>7))^o]=o}for(l=u=0;!n[l];l^=m||1,u=d[u]||1){y=u^u<<1^u<<2^u<<3^u<<4;y=99^(y>>8^255&y);n[l]=y;r[y]=l;g=p[c=p[m=p[l]]];_=16843009*g^65537*c^257*m^16843008*l;f=257*p[y]^16843008*y;for(o=0;4>o;o++){t[o][l]=f=f<<24^f>>>8;a[o][y]=_=_<<24^_>>>8}}for(o=0;5>o;o++){t[o]=t[o].slice(0);a[o]=a[o].slice(0)}return e},St=null,vt=function(){function e(t){ft(this,e);if(!St){St=Tt()}this._tables=[[St[0][0].slice(),St[0][1].slice(),St[0][2].slice(),St[0][3].slice(),St[0][4].slice()],[St[1][0].slice(),St[1][1].slice(),St[1][2].slice(),St[1][3].slice(),St[1][4].slice()]];var a=void 0,n=void 0,r=void 0,s=void 0,d=void 0,o=this._tables[0][4],l=this._tables[1],u=t.length,p=1;if(4!==u&&6!==u&&8!==u){throw new Error("Invalid aes key size")}s=t.slice(0);d=[];this._key=[s,d];for(a=u;a<4*u+28;a++){r=s[a-1];if(0==a%u||8===u&&4==a%u){r=o[r>>>24]<<24^o[255&r>>16]<<16^o[255&r>>8]<<8^o[255&r];if(0==a%u){r=r<<8^r>>>24^p<<24;p=p<<1^283*(p>>7)}}s[a]=s[a-u]^r}for(n=0;a;n++,a--){r=s[3&n?a:a-4];if(4>=a||4>n){d[n]=r}else{d[n]=l[0][o[r>>>24]]^l[1][o[255&r>>16]]^l[2][o[255&r>>8]]^l[3][o[255&r]]}}}e.prototype.decrypt=function(e,t,n,r,s,o){var l=this._key[1],u=e^l[0],p=r^l[1],m=n^l[2],g=t^l[3],y=void 0,f=void 0,_=void 0,h=l.length/4-2,T=void 0,S=4,v=this._tables[1],k=v[0],I=v[1],E=v[2],L=v[3],C=v[4];for(T=0;T<h;T++){y=k[u>>>24]^I[255&p>>16]^E[255&m>>8]^L[255&g]^l[S];f=k[p>>>24]^I[255&m>>16]^E[255&g>>8]^L[255&u]^l[S+1];_=k[m>>>24]^I[255&g>>16]^E[255&u>>8]^L[255&p]^l[S+2];g=k[g>>>24]^I[255&u>>16]^E[255&p>>8]^L[255&m]^l[S+3];S+=4;u=y;p=f;m=_}for(T=0;4>T;T++){s[(3&-T)+o]=C[u>>>24]<<24^C[255&p>>16]<<16^C[255&m>>8]<<8^C[255&g]^l[S++];y=u;u=p;p=m;m=g;g=y}};return e}(),kt=function(){function e(){ft(this,e);this.listeners={}}e.prototype.on=function(e,t){if(!this.listeners[e]){this.listeners[e]=[]}this.listeners[e].push(t)};e.prototype.off=function(e,t){if(!this.listeners[e]){return!1}var a=this.listeners[e].indexOf(t);this.listeners[e].splice(a,1);return-1<a};e.prototype.trigger=function(e){var t=this.listeners[e];if(!t){return}if(2===arguments.length){for(var a=t.length,n=0;n<a;++n){t[n].call(this,arguments[1])}}else{for(var r=Array.prototype.slice.call(arguments,1),s=t.length,d=0;d<s;++d){t[d].apply(this,r)}}};e.prototype.dispose=function(){this.listeners={}};e.prototype.pipe=function(e){this.on("data",function(t){e.push(t)})};return e}(),It=function(e){ht(t,e);function t(){ft(this,t);var a=bt(this,e.call(this,kt));a.jobs=[];a.delay=1;a.timeout_=null;return a}t.prototype.processJob_=function(){this.jobs.shift()();if(this.jobs.length){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}else{this.timeout_=null}};t.prototype.push=function(e){this.jobs.push(e);if(!this.timeout_){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}};return t}(kt),Et=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},Lt=function(e,t,a){var i=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),n=new vt(Array.prototype.slice.call(t)),r=new Uint8Array(e.byteLength),s=new Int32Array(r.buffer),d=void 0,o=void 0,l=void 0,u=void 0,p=void 0,m=void 0,c=void 0,g=void 0,y=void 0;d=a[0];o=a[1];l=a[2];u=a[3];for(y=0;y<i.length;y+=4){p=Et(i[y]);m=Et(i[y+1]);c=Et(i[y+2]);g=Et(i[y+3]);n.decrypt(p,m,c,g,s,y);s[y]=Et(s[y]^d);s[y+1]=Et(s[y+1]^o);s[y+2]=Et(s[y+2]^l);s[y+3]=Et(s[y+3]^u);d=p;o=m;l=c;u=g}return r},Ct=function(){function e(t,a,n,r){ft(this,e);var s=e.STEP,o=new Int32Array(t.buffer),l=new Uint8Array(t.byteLength),u=0;this.asyncStream_=new It;this.asyncStream_.push(this.decryptChunk_(o.subarray(u,u+s),a,n,l));for(u=s;u<o.length;u+=s){n=new Uint32Array([Et(o[u-4]),Et(o[u-3]),Et(o[u-2]),Et(o[u-1])]);this.asyncStream_.push(this.decryptChunk_(o.subarray(u,u+s),a,n,l))}this.asyncStream_.push(function(){r(null,d(l))})}e.prototype.decryptChunk_=function(e,t,a,i){return function(){var n=Lt(e,t,a);i.set(n,e.byteOffset)}};_t(e,null,[{key:"STEP",get:function(){return 32e3}}]);return e}(),Dt=function(e,t){return e.start(t)+"-"+e.end(t)},Pt=function(t,e){var a=t.toString(16);return"00".substring(0,2-a.length)+a+(e%2?" ":"")},Ot=function(t){if(32<=t&&126>t){return String.fromCharCode(t)}return"."},xt=function(e){var t={};Object.keys(e).forEach(function(a){var i=e[a];if(ArrayBuffer.isView(i)){t[a]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}}else{t[a]=i}});return t},Ut=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},Rt=function(e){return e.resolvedUri},At=function(e){for(var t=Array.prototype.slice.call(e),a=16,i="",n=void 0,r=void 0,s=0;s<t.length/a;s++){n=t.slice(s*a,s*a+a).map(Pt).join("");r=t.slice(s*a,s*a+a).map(Ot).join("");i+=n+" "+r+"\n"}return i},Nt=Object.freeze({createTransferableMessage:xt,initSegmentId:Ut,segmentKeyId:Rt,hexDump:At,tagDump:function(e){var t=e.bytes;return At(t)},textRanges:function(e){var t="",a=void 0;for(a=0;a<e.length;a++){t+=Dt(e,a)+" "}return t}}),wt=.25,Bt=function(e,t){if(!t.dateTimeObject){return null}var a=t.videoTimingInfo.transmuxerPrependedSeconds,i=t.videoTimingInfo.transmuxedPresentationStart;return new Date(t.dateTimeObject.getTime()+1e3*(e-(i+a)))},Mt=function(e){return e.transmuxedPresentationEnd-e.transmuxedPresentationStart-e.transmuxerPrependedSeconds},qt=function(e,t){var a;try{a=new Date(e)}catch(t){return null}if(!t||!t.segments||0===t.segments.length){return null}var n=t.segments[0];if(a<n.dateTimeObject){return null}for(var r=0;r<t.segments.length-1;r++){n=t.segments[r];var s=t.segments[r+1].dateTimeObject;if(a<s){break}}var d=t.segments[t.segments.length-1],o=d.dateTimeObject,l=d.videoTimingInfo?Mt(d.videoTimingInfo):d.duration+d.duration*wt,u=new Date(o.getTime()+1e3*l);if(a>u){return null}if(a>o){n=d}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:ut.duration(t,t.mediaSequence+t.segments.indexOf(n)),type:n.videoTimingInfo?"accurate":"estimate"}},Ft=function(e,t){if(!t||!t.segments||0===t.segments.length){return null}for(var a=0,n=void 0,r=0;r<t.segments.length;r++){n=t.segments[r];a=n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationEnd:a+n.duration;if(e<=a){break}}var s=t.segments[t.segments.length-1];if(s.videoTimingInfo&&s.videoTimingInfo.transmuxedPresentationEnd<e){return null}if(e>a){if(e>a+s.duration*wt){return null}n=s}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:a-n.duration,type:n.videoTimingInfo?"accurate":"estimate"}},Ht=function(e,t){var a=void 0,i=void 0;try{a=new Date(e);i=new Date(t)}catch(t){}var n=a.getTime(),r=i.getTime();return(r-n)/1e3},Gt=function(e){if(!e.segments||0===e.segments.length){return!1}for(var t=0,a;t<e.segments.length;t++){a=e.segments[t];if(!a.dateTimeObject){return!1}}return!0},Vt=function(e){var t=e.playlist,a=e.time,i=a===void 0?void 0:a,n=e.callback;if(!n){throw new Error("getProgramTime: callback must be provided")}if(!t||i===void 0){return n({message:"getProgramTime: playlist and time must be provided"})}var r=Ft(i,t);if(!r){return n({message:"valid programTime was not found"})}if("estimate"===r.type){return n({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:r.estimatedStart})}var s={mediaSeconds:i},d=Bt(i,r.segment);if(d){s.programDateTime=d.toISOString()}return n(null,s)},Wt=function e(t){var a=t.programTime,i=t.playlist,n=t.retryCount,r=n===void 0?2:n,s=t.seekTo,d=t.pauseAfterSeek,o=d===void 0?!0:d,l=t.tech,u=t.callback;if(!u){throw new Error("seekToProgramTime: callback must be provided")}if("undefined"==typeof a||!i||!s){return u({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"})}if(!i.endList&&!l.hasStarted_){return u({message:"player must be playing a live stream to start buffering"})}if(!Gt(i)){return u({message:"programDateTime tags must be provided in the manifest "+i.resolvedUri})}var p=qt(a,i);if(!p){return u({message:a+" was not found in the stream"})}var m=p.segment,c=Ht(m.dateTimeObject,a);if("estimate"===p.type){if(0===r){return u({message:a+" is not buffered yet. Try again"})}s(p.estimatedStart+c);l.one("seeked",function(){e({programTime:a,playlist:i,retryCount:r-1,seekTo:s,pauseAfterSeek:o,tech:l,callback:u})});return}var g=m.start+c;l.one("seeked",function(){return u(null,l.currentTime())});if(o){l.pause()}s(g)},zt=1/30,jt=3*zt,Yt=function(e,a){var n=[],r=void 0;if(e&&e.length){for(r=0;r<e.length;r++){if(a(e.start(r),e.end(r))){n.push([e.start(r),e.end(r)])}}}return t.createTimeRanges(n)},Xt=function(e,t){return Yt(e,function(e,a){return e-jt<=t&&a+jt>=t})},Kt=function(e,t){return Yt(e,function(e){return e-zt>=t})},Qt=function(e){if(2>e.length){return t.createTimeRanges()}for(var a=[],n=1;n<e.length;n++){var r=e.end(n-1),s=e.start(n);a.push([r,s])}return t.createTimeRanges(a)},$t=function(e){var t=[];if(!e||!e.length){return""}for(var a=0;a<e.length;a++){t.push(e.start(a)+" => "+e.end(a))}return t.join(", ")},Zt=function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,i=e.length?e.end(e.length-1):0;return(i-t)/a},Jt=function(e){for(var t=[],a=0;a<e.length;a++){t.push({start:e.start(a),end:e.end(a)})}return t},ea=function(e,t,a){var i=t.player_;if(a.captions&&a.captions.length){if(!e.inbandTextTracks_){e.inbandTextTracks_={}}for(var n in a.captionStreams){if(!e.inbandTextTracks_[n]){i.tech_.trigger({type:"usage",name:"hls-608"});var r=i.textTracks().getTrackById(n);if(r){e.inbandTextTracks_[n]=r}else{e.inbandTextTracks_[n]=i.addRemoteTextTrack({kind:"captions",id:n,label:n},!1).track}}}}if(a.metadata&&a.metadata.length&&!e.metadataTrack_){e.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track;e.metadataTrack_.inBandMetadataTrackDispatchType=a.metadata.dispatchType}},ta=function(e,t,a){var n=void 0,r=void 0;if(!a){return}if(!a.cues){return}n=a.cues.length;while(n--){r=a.cues[n];if(r.startTime<=t&&r.endTime>=e){a.removeCue(r)}}},aa=function(e){Object.defineProperties(e.frame,{id:{get:function(){t.log.warn("cue.frame.id is deprecated. Use cue.value.key instead.");return e.value.key}},value:{get:function(){t.log.warn("cue.frame.value is deprecated. Use cue.value.data instead.");return e.value.data}},privateData:{get:function(){t.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead.");return e.value.data}}})},ia=function(e){var t;if(isNaN(e)||Math.abs(e)===1/0){t=Number.MAX_VALUE}else{t=e}return t},na=function(e,t,a){var n=be.WebKitDataCue||be.VTTCue;if(t){t.forEach(function(e){var t=e.stream;this.inbandTextTracks_[t].addCue(new n(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))},e)}if(a){var r=ia(e.mediaSource_.duration);a.forEach(function(e){var t=e.cueTime+this.timestampOffset;if("number"!=typeof t||be.isNaN(t)||0>t||!(t<1/0)){return}e.frames.forEach(function(e){var a=new n(t,t,e.value||e.url||e.data||"");a.frame=e;a.value=e;aa(a);this.metadataTrack_.addCue(a)},this)},e);if(e.metadataTrack_&&e.metadataTrack_.cues&&e.metadataTrack_.cues.length){for(var s=e.metadataTrack_.cues,d=[],o=0;o<s.length;o++){if(s[o]){d.push(s[o])}}var l=d.reduce(function(e,t){var a=e[t.startTime]||[];a.push(t);e[t.startTime]=a;return e},{}),u=Object.keys(l).sort(function(e,t){return+e-+t});u.forEach(function(e,t){var a=l[e],i=+u[t+1]||r;a.forEach(function(e){e.endTime=i})})}}},ra="undefined"!=typeof window?window:{},sa="undefined"==typeof Symbol?"__target":Symbol(),da=ra.BlobBuilder||ra.WebKitBlobBuilder||ra.MozBlobBuilder||ra.MSBlobBuilder,oa=ra.URL||ra.webkitURL||oa&&oa.msURL,la=ra.Worker;function o(e,t){return function(a){var i=this;if(!t){return new la(e)}else if(la&&!a){var n=t.toString().replace(/^function.+?{/,"").slice(0,-1),r=l(n);this[sa]=new la(r);u(this[sa],r);return this[sa]}else{var s={postMessage:function(e){if(i.onmessage){setTimeout(function(){i.onmessage({data:e,target:s})})}}};t.call(s);this.postMessage=function(e){setTimeout(function(){s.onmessage({data:e,target:i})})};this.isThisThread=!0}}}if(la){var ua,pa=l("self.onmessage = function () {}"),ma=new Uint8Array(1);try{ua=new la(pa);ua.postMessage(ma,[ma.buffer])}catch(t){la=null}finally{oa.revokeObjectURL(pa);if(ua){ua.terminate()}}}function l(t){try{return oa.createObjectURL(new Blob([t],{type:"application/javascript"}))}catch(i){var a=new da;a.append(t);return oa.createObjectURL(a.getBlob(type))}}function u(e,t){if(!e||!t)return;var a=e.terminate;e.objURL=t;e.terminate=function(){if(e.objURL)oa.revokeObjectURL(e.objURL);a.call(e)}}var ca=new o("./transmuxer-worker.worker.js",function(){var e=this,t=function(){var t=function(){this.init=function(){var e={};this.on=function(t,a){if(!e[t]){e[t]=[]}e[t]=e[t].concat(a)};this.off=function(t,a){var i;if(!e[t]){return!1}i=e[t].indexOf(a);e[t]=e[t].slice();e[t].splice(i,1);return-1<i};this.trigger=function(t){var a,n,r,s;a=e[t];if(!a){return}if(2===arguments.length){r=a.length;for(n=0;n<r;++n){a[n].call(this,arguments[1])}}else{s=[];n=arguments.length;for(n=1;n<arguments.length;++n){s.push(arguments[n])}r=a.length;for(n=0;n<r;++n){a[n].apply(this,s)}}};this.dispose=function(){e={}}}};t.prototype.pipe=function(e){this.on("data",function(t){e.push(t)});this.on("done",function(t){e.flush(t)});this.on("partialdone",function(t){e.partialFlush(t)});this.on("endedtimeline",function(t){e.endTimeline(t)});this.on("reset",function(t){e.reset(t)});return e};t.prototype.push=function(e){this.trigger("data",e)};t.prototype.flush=function(e){this.trigger("done",e)};t.prototype.partialFlush=function(e){this.trigger("partialdone",e)};t.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)};t.prototype.reset=function(e){this.trigger("reset",e)};var a=t,i=Math.pow(2,32)-1,n,r,s,d,o,l,u,p,m,c,g,y,f,_,h,b,T,S,v,k,I,E,L,C,D,P,O,x,U,R,A,N,w,B,M,q;(function(){L={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};if("undefined"==typeof Uint8Array){return}for(var e in L){if(L.hasOwnProperty(e)){L[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]}}C=new Uint8Array([105,115,111,109]);P=new Uint8Array([97,118,99,49]);D=new Uint8Array([0,0,0,1]);O=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);x=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);U={video:O,audio:x};N=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);A=new Uint8Array([0,0,0,0,0,0,0,0]);w=new Uint8Array([0,0,0,0,0,0,0,0]);B=w;M=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);q=w;R=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])})();n=function(e){var t=[],a=0,n,r,s;for(n=1;n<arguments.length;n++){t.push(arguments[n])}n=t.length;while(n--){a+=t[n].byteLength}r=new Uint8Array(a+8);s=new DataView(r.buffer,r.byteOffset,r.byteLength);s.setUint32(0,r.byteLength);r.set(e,4);for(n=0,a=8;n<t.length;n++){r.set(t[n],a);a+=t[n].byteLength}return r};r=function(){return n(L.dinf,n(L.dref,N))};s=function(e){return n(L.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))};d=function(){return n(L.ftyp,C,D,C,P)};b=function(e){return n(L.hdlr,U[e])};o=function(e){return n(L.mdat,e)};h=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,255&e.duration>>>24,255&e.duration>>>16,255&e.duration>>>8,255&e.duration,85,196,0,0]);if(e.samplerate){t[12]=255&e.samplerate>>>24;t[13]=255&e.samplerate>>>16;t[14]=255&e.samplerate>>>8;t[15]=255&e.samplerate}return n(L.mdhd,t)};_=function(e){return n(L.mdia,h(e),b(e.type),u(e))};l=function(e){return n(L.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))};u=function(e){return n(L.minf,"video"===e.type?n(L.vmhd,R):n(L.smhd,A),r(),S(e))};p=function(e,t){var a=[],r=t.length;while(r--){a[r]=k(t[r])}return n.apply(null,[L.moof,l(e)].concat(a))};m=function(e){var t=e.length,a=[];while(t--){a[t]=y(e[t])}return n.apply(null,[L.moov,g(4294967295)].concat(a).concat(c(e)))};c=function(e){var t=e.length,a=[];while(t--){a[t]=I(e[t])}return n.apply(null,[L.mvex].concat(a))};g=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return n(L.mvhd,t)};T=function(e){var t=e.samples||[],a=new Uint8Array(4+t.length),r,s;for(s=0;s<t.length;s++){r=t[s].flags;a[s+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy}return n(L.sdtp,a)};S=function(e){return n(L.stbl,v(e),n(L.stts,q),n(L.stsc,B),n(L.stsz,M),n(L.stco,w))};(function(){var e,t;v=function(a){return n(L.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===a.type?e(a):t(a))};e=function(e){var t=e.sps||[],a=e.pps||[],r=[],s=[],d,o;for(d=0;d<t.length;d++){r.push((65280&t[d].byteLength)>>>8);r.push(255&t[d].byteLength);r=r.concat(Array.prototype.slice.call(t[d]))}for(d=0;d<a.length;d++){s.push((65280&a[d].byteLength)>>>8);s.push(255&a[d].byteLength);s=s.concat(Array.prototype.slice.call(a[d]))}o=[L.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),n(L.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([t.length],r,[a.length],s))),n(L.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))];if(e.sarRatio){var l=e.sarRatio[0],u=e.sarRatio[1];o.push(n(L.pasp,new Uint8Array([(4278190080&l)>>24,(16711680&l)>>16,(65280&l)>>8,255&l,(4278190080&u)>>24,(16711680&u)>>16,(65280&u)>>8,255&u])))}return n.apply(null,o)};t=function(e){return n(L.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),s(e))}})();f=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return n(L.tkhd,t)};k=function(e){var t,a,r,s,d,o,l;t=n(L.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]));o=Math.floor(e.baseMediaDecodeTime/(i+1));l=Math.floor(e.baseMediaDecodeTime%(i+1));a=n(L.tfdt,new Uint8Array([1,0,0,0,255&o>>>24,255&o>>>16,255&o>>>8,255&o,255&l>>>24,255&l>>>16,255&l>>>8,255&l]));d=92;if("audio"===e.type){r=E(e,d);return n(L.traf,t,a,r)}s=T(e);r=E(e,s.length+d);return n(L.traf,t,a,r,s)};y=function(e){e.duration=e.duration||4294967295;return n(L.trak,f(e),_(e))};I=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);if("video"!==e.type){t[t.length-1]=0}return n(L.trex,t)};(function(){var e,t,a;a=function(e,t){var a=0,i=0,n=0,r=0;if(e.length){if(e[0].duration!==void 0){a=1}if(e[0].size!==void 0){i=2}if(e[0].flags!==void 0){n=4}if(e[0].compositionTimeOffset!==void 0){r=8}}return[0,0,a|i|n|r,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]};t=function(e,t){var r,s,d,o,l,u;o=e.samples||[];t+=20+16*o.length;d=a(o,t);s=new Uint8Array(d.length+16*o.length);s.set(d);r=d.length;for(u=0;u<o.length;u++){l=o[u];s[r++]=(4278190080&l.duration)>>>24;s[r++]=(16711680&l.duration)>>>16;s[r++]=(65280&l.duration)>>>8;s[r++]=255&l.duration;s[r++]=(4278190080&l.size)>>>24;s[r++]=(16711680&l.size)>>>16;s[r++]=(65280&l.size)>>>8;s[r++]=255&l.size;s[r++]=l.flags.isLeading<<2|l.flags.dependsOn;s[r++]=l.flags.isDependedOn<<6|l.flags.hasRedundancy<<4|l.flags.paddingValue<<1|l.flags.isNonSyncSample;s[r++]=l.flags.degradationPriority&61440;s[r++]=15&l.flags.degradationPriority;s[r++]=(4278190080&l.compositionTimeOffset)>>>24;s[r++]=(16711680&l.compositionTimeOffset)>>>16;s[r++]=(65280&l.compositionTimeOffset)>>>8;s[r++]=255&l.compositionTimeOffset}return n(L.trun,s)};e=function(e,t){var r,s,d,o,l,u;o=e.samples||[];t+=20+8*o.length;d=a(o,t);r=new Uint8Array(d.length+8*o.length);r.set(d);s=d.length;for(u=0;u<o.length;u++){l=o[u];r[s++]=(4278190080&l.duration)>>>24;r[s++]=(16711680&l.duration)>>>16;r[s++]=(65280&l.duration)>>>8;r[s++]=255&l.duration;r[s++]=(4278190080&l.size)>>>24;r[s++]=(16711680&l.size)>>>16;r[s++]=(65280&l.size)>>>8;r[s++]=255&l.size}return n(L.trun,r)};E=function(a,i){if("audio"===a.type){return e(a,i)}return t(a,i)}})();var F={ftyp:d,mdat:o,moof:p,moov:m,initSegment:function(e){var t=d(),a=m(e),i;i=new Uint8Array(t.byteLength+a.byteLength);i.set(t);i.set(a,t.byteLength);return i}},H=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},G=function(e,t){var a=H();a.dataOffset=t;a.compositionTimeOffset=e.pts-e.dts;a.duration=e.duration;a.size=4*e.length;a.size+=e.byteLength;if(e.keyFrame){a.flags.dependsOn=2;a.flags.isNonSyncSample=0}return a},V={groupNalsIntoFrames:function(e){var t,a,n=[],r=[];r.byteLength=0;r.nalCount=0;r.duration=0;n.byteLength=0;for(t=0;t<e.length;t++){a=e[t];if("access_unit_delimiter_rbsp"===a.nalUnitType){if(n.length){n.duration=a.dts-n.dts;r.byteLength+=n.byteLength;r.nalCount+=n.length;r.duration+=n.duration;r.push(n)}n=[a];n.byteLength=a.data.byteLength;n.pts=a.pts;n.dts=a.dts}else{if("slice_layer_without_partitioning_rbsp_idr"===a.nalUnitType){n.keyFrame=!0}n.duration=a.dts-n.dts;n.byteLength+=a.data.byteLength;n.push(a)}}if(r.length&&(!n.duration||0>=n.duration)){n.duration=r[r.length-1].duration}r.byteLength+=n.byteLength;r.nalCount+=n.length;r.duration+=n.duration;r.push(n);return r},groupFramesIntoGops:function(e){var t,a,n=[],r=[];n.byteLength=0;n.nalCount=0;n.duration=0;n.pts=e[0].pts;n.dts=e[0].dts;r.byteLength=0;r.nalCount=0;r.duration=0;r.pts=e[0].pts;r.dts=e[0].dts;for(t=0;t<e.length;t++){a=e[t];if(a.keyFrame){if(n.length){r.push(n);r.byteLength+=n.byteLength;r.nalCount+=n.nalCount;r.duration+=n.duration}n=[a];n.nalCount=a.length;n.byteLength=a.byteLength;n.pts=a.pts;n.dts=a.dts;n.duration=a.duration}else{n.duration+=a.duration;n.nalCount+=a.length;n.byteLength+=a.byteLength;n.push(a)}}if(r.length&&0>=n.duration){n.duration=r[r.length-1].duration}r.byteLength+=n.byteLength;r.nalCount+=n.nalCount;r.duration+=n.duration;r.push(n);return r},extendFirstKeyFrame:function(e){var t;if(!e[0][0].keyFrame&&1<e.length){t=e.shift();e.byteLength-=t.byteLength;e.nalCount-=t.nalCount;e[0][0].dts=t.dts;e[0][0].pts=t.pts;e[0][0].duration+=t.duration}return e},generateSampleTable:function(e,t){var a,n,r,s,d,o=t||0,l=[];for(a=0;a<e.length;a++){s=e[a];for(n=0;n<s.length;n++){d=s[n];r=G(d,o);o+=r.size;l.push(r)}}return l},concatenateNalData:function(e){var t,a,n,r,s,d,o=0,l=e.byteLength,u=e.nalCount,p=new Uint8Array(l+4*u),m=new DataView(p.buffer);for(t=0;t<e.length;t++){r=e[t];for(a=0;a<r.length;a++){s=r[a];for(n=0;n<s.length;n++){d=s[n];m.setUint32(o,d.data.byteLength);o+=4;p.set(d.data,o);o+=d.data.byteLength}}}return p},generateSampleTableForFrame:function(e,t){var a,i=[];a=G(e,t||0);i.push(a);return i},concatenateNalDataForFrame:function(e){var t,a,n=0,r=e.byteLength,s=e.length,d=new Uint8Array(r+4*s),o=new DataView(d.buffer);for(t=0;t<e.length;t++){a=e[t];o.setUint32(n,a.data.byteLength);n+=4;d.set(a.data,n);n+=a.data.byteLength}return d}},W=[33,16,5,32,164,27],z=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],j=function(e){var t=[];while(e--){t.push(0)}return t},Y=function(e){return Object.keys(e).reduce(function(t,a){t[a]=new Uint8Array(e[a].reduce(function(e,t){return e.concat(t)},[]));return t},{})},X,K=function(){if(!X){var e={96e3:[W,[227,64],j(154),[56]],88200:[W,[231],j(170),[56]],64e3:[W,[248,192],j(240),[56]],48e3:[W,[255,192],j(268),[55,148,128],j(54),[112]],44100:[W,[255,192],j(268),[55,163,128],j(84),[112]],32e3:[W,[255,192],j(268),[55,234],j(226),[112]],24e3:[W,[255,192],j(268),[55,255,128],j(268),[111,112],j(126),[224]],16e3:[W,[255,192],j(268),[55,255,128],j(268),[111,255],j(269),[223,108],j(195),[1,192]],12e3:[z,j(268),[3,127,248],j(268),[6,255,240],j(268),[13,255,224],j(268),[27,253,128],j(259),[56]],11025:[z,j(268),[3,127,248],j(268),[6,255,240],j(268),[13,255,224],j(268),[27,255,192],j(268),[55,175,128],j(108),[112]],8e3:[z,j(268),[3,121,16],j(47),[7]]};X=Y(e)}return X},Q=9e4,$,Z,J,ee,te,ae,ie;$=function(e){return e*Q};Z=function(e,t){return e*t};J=function(e){return e/Q};ee=function(e,t){return e/t};te=function(e,t){return $(ee(e,t))};ae=function(e,t){return Z(J(e),t)};ie=function(e,t,a){return J(a?e:e-t)};var ne={ONE_SECOND_IN_TS:Q,secondsToVideoTs:$,secondsToAudioTs:Z,videoTsToSeconds:J,audioTsToSeconds:ee,audioTsToVideoTs:te,videoTsToAudioTs:ae,metadataTsToSeconds:ie},re=function(e){var t,a,n=0;for(t=0;t<e.length;t++){a=e[t];n+=a.data.byteLength}return n},se={prefixWithSilence:function(e,t,a,n){var r,s=0,d=0,o=0,l=0,u,p,m;if(!t.length){return}r=ne.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate);s=Math.ceil(ne.ONE_SECOND_IN_TS/(e.samplerate/1024));if(a&&n){d=r-Math.max(a,n);o=Math.floor(d/s);l=o*s}if(1>o||l>ne.ONE_SECOND_IN_TS/2){return}u=K()[e.samplerate];if(!u){u=t[0].data}for(p=0;p<o;p++){m=t[0];t.splice(0,0,{data:u,dts:m.dts-s,pts:m.pts-s})}e.baseMediaDecodeTime-=Math.floor(ne.videoTsToAudioTs(l,e.samplerate))},trimAdtsFramesByEarliestDts:function(e,t,a){if(t.minSegmentDts>=a){return e}t.minSegmentDts=1/0;return e.filter(function(e){if(e.dts>=a){t.minSegmentDts=Math.min(t.minSegmentDts,e.dts);t.minSegmentPts=t.minSegmentDts;return!0}return!1})},generateSampleTable:function(e){var t,a,n=[];for(t=0;t<e.length;t++){a=e[t];n.push({size:a.data.byteLength,duration:1024})}return n},concatenateFrameData:function(e){var t,a,n=0,r=new Uint8Array(re(e));for(t=0;t<e.length;t++){a=e[t];r.set(a.data,n);n+=a.data.byteLength}return r}},de=ne.ONE_SECOND_IN_TS,oe={clearDtsInfo:function(e){delete e.minSegmentDts;delete e.maxSegmentDts;delete e.minSegmentPts;delete e.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(e,t){var a,i,n=e.minSegmentDts;if(!t){n-=e.timelineStartInfo.dts}a=e.timelineStartInfo.baseMediaDecodeTime;a+=n;a=Math.max(0,a);if("audio"===e.type){i=e.samplerate/de;a*=i;a=Math.floor(a)}return a},collectDtsInfo:function(e,t){if("number"==typeof t.pts){if(e.timelineStartInfo.pts===void 0){e.timelineStartInfo.pts=t.pts}if(e.minSegmentPts===void 0){e.minSegmentPts=t.pts}else{e.minSegmentPts=Math.min(e.minSegmentPts,t.pts)}if(e.maxSegmentPts===void 0){e.maxSegmentPts=t.pts}else{e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)}}if("number"==typeof t.dts){if(e.timelineStartInfo.dts===void 0){e.timelineStartInfo.dts=t.dts}if(e.minSegmentDts===void 0){e.minSegmentDts=t.dts}else{e.minSegmentDts=Math.min(e.minSegmentDts,t.dts)}if(e.maxSegmentDts===void 0){e.maxSegmentDts=t.dts}else{e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts)}}}},le=4,ue={parseSei:function(e){var t=0,a={payloadType:-1,payloadSize:0},n=0,r=0;while(t<e.byteLength){if(e[t]===128){break}while(255===e[t]){n+=255;t++}n+=e[t++];while(255===e[t]){r+=255;t++}r+=e[t++];if(!a.payload&&n===le){a.payloadType=n;a.payloadSize=r;a.payload=e.subarray(t,t+r);break}t+=r;n=0;r=0}return a},parseUserData:function(e){if(181!==e.payload[0]){return null}if(49!=(e.payload[1]<<8|e.payload[2])){return null}if("GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])){return null}if(3!==e.payload[7]){return null}return e.payload.subarray(8,e.payload.length-1)},parseCaptionPackets:function(e,t){var a=[],n,r,s,d;if(!(64&t[0])){return a}r=31&t[0];for(n=0;n<r;n++){s=3*n;d={type:3&t[s+2],pts:e};if(4&t[s+2]){d.ccData=t[s+3]<<8|t[s+4];a.push(d)}}return a},discardEmulationPreventionBytes:function(e){var t=e.byteLength,a=[],n=1,r,s;while(n<t-2){if(0===e[n]&&0===e[n+1]&&3===e[n+2]){a.push(n+2);n+=2}else{n++}}if(0===a.length){return e}r=t-a.length;s=new Uint8Array(r);var d=0;for(n=0;n<r;d++,n++){if(d===a[0]){d++;a.shift()}s[n]=e[d]}return s},USER_DATA_REGISTERED_ITU_T_T35:le},pe=function e(){e.prototype.init.call(this);this.captionPackets_=[];this.ccStreams_=[new _e(0,0),new _e(0,1),new _e(1,0),new _e(1,1)];this.reset();this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data"));e.on("partialdone",this.trigger.bind(this,"partialdone"));e.on("done",this.trigger.bind(this,"done"))},this)};pe.prototype=new a;pe.prototype.push=function(e){var t,a,i;if("sei_rbsp"!==e.nalUnitType){return}t=ue.parseSei(e.escapedRBSP);if(t.payloadType!==ue.USER_DATA_REGISTERED_ITU_T_T35){return}a=ue.parseUserData(t);if(!a){return}if(e.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;if(!this.numSameDts_){this.ignoreNextEqualDts_=!1}return}i=ue.parseCaptionPackets(e.pts,a);this.captionPackets_=this.captionPackets_.concat(i);if(this.latestDts_!==e.dts){this.numSameDts_=0}this.numSameDts_++;this.latestDts_=e.dts};pe.prototype.flushCCStreams=function(e){this.ccStreams_.forEach(function(t){return"flush"===e?t.flush():t.partialFlush()},this)};pe.prototype.flushStream=function(e){if(!this.captionPackets_.length){this.flushCCStreams(e);return}this.captionPackets_.forEach(function(e,t){e.presortIndex=t});this.captionPackets_.sort(function(e,t){if(e.pts===t.pts){return e.presortIndex-t.presortIndex}return e.pts-t.pts});this.captionPackets_.forEach(function(e){if(2>e.type){this.dispatchCea608Packet(e)}},this);this.captionPackets_.length=0;this.flushCCStreams(e)};pe.prototype.flush=function(){return this.flushStream("flush")};pe.prototype.partialFlush=function(){return this.flushStream("partialFlush")};pe.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=!1;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach(function(e){e.reset()})};pe.prototype.dispatchCea608Packet=function(e){if(this.setsTextOrXDSActive(e)){this.activeCea608Channel_[e.type]=null}else if(this.setsChannel1Active(e)){this.activeCea608Channel_[e.type]=0}else if(this.setsChannel2Active(e)){this.activeCea608Channel_[e.type]=1}if(null===this.activeCea608Channel_[e.type]){return}this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)};pe.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)};pe.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)};pe.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var me={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},ce=function(e){if(null===e){return""}e=me[e]||e;return String.fromCharCode(e)},ge=14,ye=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],fe=function(){var e=[],t=ge+1;while(t--){e.push("")}return e},_e=function e(t,a){e.prototype.init.call(this);this.field_=t||0;this.dataChannel_=a||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(e){var t,a,i,n,r;t=32639&e.ccData;if(t===this.lastControlCode_){this.lastControlCode_=null;return}if(4096==(61440&t)){this.lastControlCode_=t}else if(t!==this.PADDING_){this.lastControlCode_=null}i=t>>>8;n=255&t;if(t===this.PADDING_){}else if(t===this.RESUME_CAPTION_LOADING_){this.mode_="popOn"}else if(t===this.END_OF_CAPTION_){this.mode_="popOn";this.clearFormatting(e.pts);this.flushDisplayed(e.pts);a=this.displayed_;this.displayed_=this.nonDisplayed_;this.nonDisplayed_=a;this.startPts_=e.pts}else if(t===this.ROLL_UP_2_ROWS_){this.rollUpRows_=2;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_3_ROWS_){this.rollUpRows_=3;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_4_ROWS_){this.rollUpRows_=4;this.setRollUp(e.pts)}else if(t===this.CARRIAGE_RETURN_){this.clearFormatting(e.pts);this.flushDisplayed(e.pts);this.shiftRowsUp_();this.startPts_=e.pts}else if(t===this.BACKSPACE_){if("popOn"===this.mode_){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}}else if(t===this.ERASE_DISPLAYED_MEMORY_){this.flushDisplayed(e.pts);this.displayed_=fe()}else if(t===this.ERASE_NON_DISPLAYED_MEMORY_){this.nonDisplayed_=fe()}else if(t===this.RESUME_DIRECT_CAPTIONING_){if("paintOn"!==this.mode_){this.flushDisplayed(e.pts);this.displayed_=fe()}this.mode_="paintOn";this.startPts_=e.pts}else if(this.isSpecialCharacter(i,n)){i=(3&i)<<8;r=ce(i|n);this[this.mode_](e.pts,r);this.column_++}else if(this.isExtCharacter(i,n)){if("popOn"===this.mode_){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}i=(3&i)<<8;r=ce(i|n);this[this.mode_](e.pts,r);this.column_++}else if(this.isMidRowCode(i,n)){this.clearFormatting(e.pts);this[this.mode_](e.pts," ");this.column_++;if(14==(14&n)){this.addFormatting(e.pts,["i"])}if(1==(1&n)){this.addFormatting(e.pts,["u"])}}else if(this.isOffsetControlCode(i,n)){this.column_+=3&n}else if(this.isPAC(i,n)){var s=ye.indexOf(7968&t);if("rollUp"===this.mode_){if(0>s-this.rollUpRows_+1){s=this.rollUpRows_-1}this.setRollUp(e.pts,s)}if(s!==this.row_){this.clearFormatting(e.pts);this.row_=s}if(1&n&&-1===this.formatting_.indexOf("u")){this.addFormatting(e.pts,["u"])}if(16==(16&t)){this.column_=4*((14&t)>>1)}if(this.isColorPAC(n)){if(14==(14&n)){this.addFormatting(e.pts,["i"])}}}else if(this.isNormalChar(i)){if(0===n){n=null}r=ce(i);r+=ce(n);this[this.mode_](e.pts,r);this.column_+=r.length}}};_e.prototype=new a;_e.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(t){console.error("Skipping malformed caption.");return""}}).join("\n").replace(/^\n+|\n+$/g,"");if(t.length){this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})}};_e.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=fe();this.nonDisplayed_=fe();this.lastControlCode_=null;this.column_=0;this.row_=ge;this.rollUpRows_=2;this.formatting_=[]};_e.prototype.setConstants=function(){if(0===this.dataChannel_){this.BASE_=16;this.EXT_=17;this.CONTROL_=(20|this.field_)<<8;this.OFFSET_=23}else if(1===this.dataChannel_){this.BASE_=24;this.EXT_=25;this.CONTROL_=(28|this.field_)<<8;this.OFFSET_=31}this.PADDING_=0;this.RESUME_CAPTION_LOADING_=32|this.CONTROL_;this.END_OF_CAPTION_=47|this.CONTROL_;this.ROLL_UP_2_ROWS_=37|this.CONTROL_;this.ROLL_UP_3_ROWS_=38|this.CONTROL_;this.ROLL_UP_4_ROWS_=39|this.CONTROL_;this.CARRIAGE_RETURN_=45|this.CONTROL_;this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_;this.BACKSPACE_=33|this.CONTROL_;this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_;this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_};_e.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&63>=t};_e.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&63>=t};_e.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&47>=t};_e.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&35>=t};_e.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&127>=t};_e.prototype.isColorPAC=function(e){return 64<=e&&79>=e||96<=e&&127>=e};_e.prototype.isNormalChar=function(e){return 32<=e&&127>=e};_e.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_){this.row_=ge;this.mode_="rollUp";this.flushDisplayed(e);this.nonDisplayed_=fe();this.displayed_=fe()}if(t!==void 0&&t!==this.row_){for(var a=0;a<this.rollUpRows_;a++){this.displayed_[t-a]=this.displayed_[this.row_-a];this.displayed_[this.row_-a]=""}}if(t===void 0){t=this.row_}this.topRow_=t-this.rollUpRows_+1};_e.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var a=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,a)};_e.prototype.clearFormatting=function(e){if(!this.formatting_.length){return}var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[];this[this.mode_](e,t)};_e.prototype.popOn=function(e,t){var a=this.nonDisplayed_[this.row_];a+=t;this.nonDisplayed_[this.row_]=a};_e.prototype.rollUp=function(e,t){var a=this.displayed_[this.row_];a+=t;this.displayed_[this.row_]=a};_e.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++){this.displayed_[e]=""}for(e=this.row_+1;e<ge+1;e++){this.displayed_[e]=""}for(e=this.topRow_;e<this.row_;e++){this.displayed_[e]=this.displayed_[e+1]}this.displayed_[this.row_]=""};_e.prototype.paintOn=function(e,t){var a=this.displayed_[this.row_];a+=t;this.displayed_[this.row_]=a};var he={CaptionStream:pe,Cea608Stream:_e},be={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Te="shared",Se=function(e,t){var a=1;if(e>t){a=-1}while(Math.abs(t-e)>4294967296){e+=a*8589934592}return e},ve=function e(t){var a,i;e.prototype.init.call(this);this.type_=t||Te;this.push=function(e){if(this.type_!==Te&&e.type!==this.type_){return}if(i===void 0){i=e.dts}e.dts=Se(e.dts,i);e.pts=Se(e.pts,i);a=e.dts;this.trigger("data",e)};this.flush=function(){i=a;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.discontinuity=function(){i=void 0;a=void 0};this.reset=function(){this.discontinuity();this.trigger("reset")}};ve.prototype=new a;var ke=function(e,t,a){var n,r="";for(n=t;n<a;n++){r+="%"+("00"+e[n].toString(16)).slice(-2)}return r},Ie=function(e,t,a){return decodeURIComponent(ke(e,t,a))},Ee=function(e,t,a){return unescape(ke(e,t,a))},Le=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},Ce={TXXX:function(e){var t;if(3!==e.data[0]){return}for(t=1;t<e.data.length;t++){if(0===e.data[t]){e.description=Ie(e.data,1,t);e.value=Ie(e.data,t+1,e.data.length).replace(/\0*$/,"");break}}e.data=e.value},WXXX:function(e){var t;if(3!==e.data[0]){return}for(t=1;t<e.data.length;t++){if(0===e.data[t]){e.description=Ie(e.data,1,t);e.url=Ie(e.data,t+1,e.data.length);break}}},PRIV:function(e){var t;for(t=0;t<e.data.length;t++){if(0===e.data[t]){e.owner=Ee(e.data,0,t);break}}e.privateData=e.data.subarray(t+1);e.data=e.privateData}},De;De=function(e){var t={debug:!!(e&&e.debug),descriptor:e&&e.descriptor},a=0,n=[],r=0,s;De.prototype.init.call(this);this.dispatchType=be.METADATA_STREAM_TYPE.toString(16);if(t.descriptor){for(s=0;s<t.descriptor.length;s++){this.dispatchType+=("00"+t.descriptor[s].toString(16)).slice(-2)}}this.push=function(e){var s,o,l,u,p,m;if("timed-metadata"!==e.type){return}if(e.dataAlignmentIndicator){r=0;n.length=0}if(0===n.length&&(10>e.data.length||e.data[0]!==73||e.data[1]!==68||e.data[2]!==51)){if(t.debug){console.log("Skipping unrecognized metadata packet")}return}n.push(e);r+=e.data.byteLength;if(1===n.length){a=Le(e.data.subarray(6,10));a+=10}if(r<a){return}s={data:new Uint8Array(a),frames:[],pts:n[0].pts,dts:n[0].dts};for(p=0;p<a;){s.data.set(n[0].data.subarray(0,a-p),p);p+=n[0].data.byteLength;r-=n[0].data.byteLength;n.shift()}o=10;if(64&s.data[5]){o+=4;o+=Le(s.data.subarray(10,14));a-=Le(s.data.subarray(16,20))}do{l=Le(s.data.subarray(o+4,o+8));if(1>l){return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.")}m=String.fromCharCode(s.data[o],s.data[o+1],s.data[o+2],s.data[o+3]);u={id:m,data:s.data.subarray(o+10,o+l+10)};u.key=u.id;if(Ce[u.id]){Ce[u.id](u);if("com.apple.streaming.transportStreamTimestamp"===u.owner){var c=u.data,d=(1&c[3])<<30|c[4]<<22|c[5]<<14|c[6]<<6|c[7]>>>2;d*=4;d+=3&c[7];u.timeStamp=d;if(s.pts===void 0&&s.dts===void 0){s.pts=u.timeStamp;s.dts=u.timeStamp}this.trigger("timestamp",u)}}s.frames.push(u);o+=10;o+=l}while(o<a);this.trigger("data",s)}};De.prototype=new a;var Pe=De,Oe={TimestampRolloverStream:ve,handleRollover:Se}.TimestampRolloverStream,xe,Ue,Re,Ae=188,Ne=71;xe=function(){var e=new Uint8Array(Ae),t=0;xe.prototype.init.call(this);this.push=function(a){var i=0,n=Ae,r;if(t){r=new Uint8Array(a.byteLength+t);r.set(e.subarray(0,t));r.set(a,t);t=0}else{r=a}while(n<r.byteLength){if(r[i]===Ne&&r[n]===Ne){this.trigger("data",r.subarray(i,n));i+=Ae;n+=Ae;continue}i++;n++}if(i<r.byteLength){e.set(r.subarray(i),0);t=r.byteLength-i}};this.flush=function(){if(t===Ae&&e[0]===Ne){this.trigger("data",e);t=0}this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.reset=function(){t=0;this.trigger("reset")}};xe.prototype=new a;Ue=function(){var e,t,a,i;Ue.prototype.init.call(this);i=this;this.packetsWaitingForPmt=[];this.programMapTable=void 0;e=function(e,i){var n=0;if(i.payloadUnitStartIndicator){n+=e[n]+1}if("pat"===i.type){t(e.subarray(n),i)}else{a(e.subarray(n),i)}};t=function(e,t){t.section_number=e[7];t.last_section_number=e[8];i.pmtPid=(31&e[10])<<8|e[11];t.pmtPid=i.pmtPid};a=function(e,t){var a,n,r,s;if(!(1&e[5])){return}i.programMapTable={video:null,audio:null,"timed-metadata":{}};a=(15&e[1])<<8|e[2];n=3+a-4;r=(15&e[10])<<8|e[11];s=12+r;while(s<n){var d=e[s],o=(31&e[s+1])<<8|e[s+2];if(d===be.H264_STREAM_TYPE&&null===i.programMapTable.video){i.programMapTable.video=o}else if(d===be.ADTS_STREAM_TYPE&&null===i.programMapTable.audio){i.programMapTable.audio=o}else if(d===be.METADATA_STREAM_TYPE){i.programMapTable["timed-metadata"][o]=d}s+=((15&e[s+3])<<8|e[s+4])+5}t.programMapTable=i.programMapTable};this.push=function(t){var a={},i=4;a.payloadUnitStartIndicator=!!(64&t[1]);a.pid=31&t[1];a.pid<<=8;a.pid|=t[2];if(1<(48&t[3])>>>4){i+=t[i]+1}if(0===a.pid){a.type="pat";e(t.subarray(i),a);this.trigger("data",a)}else if(a.pid===this.pmtPid){a.type="pmt";e(t.subarray(i),a);this.trigger("data",a);while(this.packetsWaitingForPmt.length){this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}}else if(this.programMapTable===void 0){this.packetsWaitingForPmt.push([t,i,a])}else{this.processPes_(t,i,a)}};this.processPes_=function(e,t,a){if(a.pid===this.programMapTable.video){a.streamType=be.H264_STREAM_TYPE}else if(a.pid===this.programMapTable.audio){a.streamType=be.ADTS_STREAM_TYPE}else{a.streamType=this.programMapTable["timed-metadata"][a.pid]}a.type="pes";a.data=e.subarray(t);this.trigger("data",a)}};Ue.prototype=new a;Ue.STREAM_TYPES={h264:27,adts:15};Re=function(){var e=this,t={data:[],size:0},a={data:[],size:0},i={data:[],size:0},n,r=function(e,t){var a;t.packetLength=6+(e[4]<<8|e[5]);t.dataAlignmentIndicator=0!=(4&e[6]);a=e[7];if(192&a){t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3;t.pts*=4;t.pts+=(6&e[13])>>>1;t.dts=t.pts;if(64&a){t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3;t.dts*=4;t.dts+=(6&e[18])>>>1}}t.data=e.subarray(9+e[8])},s=function(t,a,n){var s=new Uint8Array(t.size),d={type:a},o=0,l=0,u=!1,p;if(!t.data.length||9>t.size){return}d.trackId=t.data[0].pid;for(o=0;o<t.data.length;o++){p=t.data[o];s.set(p.data,l);l+=p.data.byteLength}r(s,d);u="video"===a||d.packetLength<=t.size;if(n||u){t.size=0;t.data.length=0}if(u){e.trigger("data",d)}};Re.prototype.init.call(this);this.push=function(r){({pat:function(){},pes:function(){var e,n;switch(r.streamType){case be.H264_STREAM_TYPE:e=t;n="video";break;case be.ADTS_STREAM_TYPE:e=a;n="audio";break;case be.METADATA_STREAM_TYPE:e=i;n="timed-metadata";break;default:return;}if(r.payloadUnitStartIndicator){s(e,n,!0)}e.data.push(r);e.size+=r.data.byteLength},pmt:function(){var t={type:"metadata",tracks:[]};n=r.programMapTable;if(null!==n.video){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.video,codec:"avc",type:"video"})}if(null!==n.audio){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.audio,codec:"adts",type:"audio"})}e.trigger("data",t)}})[r.type]()};this.reset=function(){t.size=0;t.data.length=0;a.size=0;a.data.length=0;this.trigger("reset")};this.flushStreams_=function(){s(t,"video");s(a,"audio");s(i,"timed-metadata")};this.flush=function(){this.flushStreams_();this.trigger("done")}};Re.prototype=new a;var we={PAT_PID:0,MP2T_PACKET_LENGTH:Ae,TransportPacketStream:xe,TransportParseStream:Ue,ElementaryStream:Re,TimestampRolloverStream:Oe,CaptionStream:he.CaptionStream,Cea608Stream:he.Cea608Stream,MetadataStream:Pe};for(var Be in be){if(be.hasOwnProperty(Be)){we[Be]=be[Be]}}var Me=we,qe=ne.ONE_SECOND_IN_TS,Fe,He=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Fe=function(e){var t,a=0;Fe.prototype.init.call(this);this.push=function(n){var r=0,s,d,o,l,u,p;if(!e){a=0}if("audio"!==n.type){return}if(t){l=t;t=new Uint8Array(l.byteLength+n.data.byteLength);t.set(l);t.set(n.data,l.byteLength)}else{t=n.data}while(r+5<t.length){if(255!==t[r]||240!=(246&t[r+1])){r++;continue}d=2*(1&~t[r+1]);s=(3&t[r+3])<<11|t[r+4]<<3|(224&t[r+5])>>5;u=1024*((3&t[r+6])+1);p=u*qe/He[(60&t[r+2])>>>2];o=r+s;if(t.byteLength<o){return}this.trigger("data",{pts:n.pts+a*p,dts:n.dts+a*p,sampleCount:u,audioobjecttype:(3&t[r+2]>>>6)+1,channelcount:(1&t[r+2])<<2|(192&t[r+3])>>>6,samplerate:He[(60&t[r+2])>>>2],samplingfrequencyindex:(60&t[r+2])>>>2,samplesize:16,data:t.subarray(r+7+d,o)});a++;if(t.byteLength===o){t=void 0;return}t=t.subarray(o)}};this.flush=function(){a=0;this.trigger("done")};this.reset=function(){t=void 0;this.trigger("reset")};this.endTimeline=function(){t=void 0;this.trigger("endedtimeline")}};Fe.prototype=new a;var Ge=Fe,Ve;Ve=function(e){var t=e.byteLength,a=0,i=0;this.length=function(){return 8*t};this.bitsAvailable=function(){return 8*t+i};this.loadWord=function(){var n=e.byteLength-t,r=new Uint8Array(4),s=Math.min(4,t);if(0===s){throw new Error("no bytes available")}r.set(e.subarray(n,n+s));a=new DataView(r.buffer).getUint32(0);i=8*s;t-=s};this.skipBits=function(e){var n;if(i>e){a<<=e;i-=e}else{e-=i;n=Math.floor(e/8);e-=8*n;t-=n;this.loadWord();a<<=e;i-=e}};this.readBits=function(e){var n=Math.min(i,e),r=a>>>32-n;i-=n;if(0<i){a<<=n}else if(0<t){this.loadWord()}n=e-n;if(0<n){return r<<n|this.readBits(n)}return r};this.skipLeadingZeros=function(){var e;for(e=0;e<i;++e){if(0!=(a&2147483648>>>e)){a<<=e;i-=e;return e}}this.loadWord();return e+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1};this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();if(1&e){return 1+e>>>1}return-1*(e>>>1)};this.readBoolean=function(){return 1===this.readBits(1)};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};var We=Ve,ze,je,Ye;je=function(){var e=0,t,a;je.prototype.init.call(this);this.push=function(i){var n;if(!a){a=i.data}else{n=new Uint8Array(a.byteLength+i.data.byteLength);n.set(a);n.set(i.data,a.byteLength);a=n}var r=a.byteLength;for(;e<r-3;e++){if(1===a[e+2]){t=e+5;break}}while(t<r){switch(a[t]){case 0:if(0!==a[t-1]){t+=2;break}else if(0!==a[t-2]){t++;break}if(e+3!==t-2){this.trigger("data",a.subarray(e+3,t-2))}do{t++}while(1!==a[t]&&t<r);e=t-2;t+=3;break;case 1:if(0!==a[t-1]||0!==a[t-2]){t+=3;break}this.trigger("data",a.subarray(e+3,t-2));e=t-2;t+=3;break;default:t+=3;break;}}a=a.subarray(e);t-=e;e=0};this.reset=function(){a=null;e=0;this.trigger("reset")};this.flush=function(){if(a&&3<a.byteLength){this.trigger("data",a.subarray(e+3))}a=null;e=0;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")}};je.prototype=new a;Ye={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0};ze=function(){var e=new je,t,a,i,n,r,s,d;ze.prototype.init.call(this);t=this;this.push=function(t){if("video"!==t.type){return}a=t.trackId;i=t.pts;n=t.dts;e.push(t)};e.on("data",function(e){var d={trackId:a,pts:i,dts:n,data:e};switch(31&e[0]){case 5:d.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:d.nalUnitType="sei_rbsp";d.escapedRBSP=r(e.subarray(1));break;case 7:d.nalUnitType="seq_parameter_set_rbsp";d.escapedRBSP=r(e.subarray(1));d.config=s(d.escapedRBSP);break;case 8:d.nalUnitType="pic_parameter_set_rbsp";break;case 9:d.nalUnitType="access_unit_delimiter_rbsp";break;default:break;}t.trigger("data",d)});e.on("done",function(){t.trigger("done")});e.on("partialdone",function(){t.trigger("partialdone")});e.on("reset",function(){t.trigger("reset")});e.on("endedtimeline",function(){t.trigger("endedtimeline")});this.flush=function(){e.flush()};this.partialFlush=function(){e.partialFlush()};this.reset=function(){e.reset()};this.endTimeline=function(){e.endTimeline()};d=function(e,t){var a=8,i=8,n,r;for(n=0;n<e;n++){if(0!==i){r=t.readExpGolomb();i=(a+r+256)%256}a=0===i?a:i}};r=function(e){var t=e.byteLength,a=[],n=1,r,s;while(n<t-2){if(0===e[n]&&0===e[n+1]&&3===e[n+2]){a.push(n+2);n+=2}else{n++}}if(0===a.length){return e}r=t-a.length;s=new Uint8Array(r);var d=0;for(n=0;n<r;d++,n++){if(d===a[0]){d++;a.shift()}s[n]=e[d]}return s};s=function(e){var t=0,a=0,n=0,r=0,s=1,o,l,u,p,m,c,g,y,f,_,h,b,T,S;o=new We(e);l=o.readUnsignedByte();p=o.readUnsignedByte();u=o.readUnsignedByte();o.skipUnsignedExpGolomb();if(Ye[l]){m=o.readUnsignedExpGolomb();if(3===m){o.skipBits(1)}o.skipUnsignedExpGolomb();o.skipUnsignedExpGolomb();o.skipBits(1);if(o.readBoolean()){h=3!==m?8:12;for(S=0;S<h;S++){if(o.readBoolean()){if(6>S){d(16,o)}else{d(64,o)}}}}}o.skipUnsignedExpGolomb();c=o.readUnsignedExpGolomb();if(0===c){o.readUnsignedExpGolomb()}else if(1===c){o.skipBits(1);o.skipExpGolomb();o.skipExpGolomb();g=o.readUnsignedExpGolomb();for(S=0;S<g;S++){o.skipExpGolomb()}}o.skipUnsignedExpGolomb();o.skipBits(1);y=o.readUnsignedExpGolomb();f=o.readUnsignedExpGolomb();_=o.readBits(1);if(0===_){o.skipBits(1)}o.skipBits(1);if(o.readBoolean()){t=o.readUnsignedExpGolomb();a=o.readUnsignedExpGolomb();n=o.readUnsignedExpGolomb();r=o.readUnsignedExpGolomb()}if(o.readBoolean()){if(o.readBoolean()){T=o.readUnsignedByte();switch(T){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:{b=[o.readUnsignedByte()<<8|o.readUnsignedByte(),o.readUnsignedByte()<<8|o.readUnsignedByte()];break}}if(b){s=b[0]/b[1]}}}return{profileIdc:l,levelIdc:u,profileCompatibility:p,width:Math.ceil((16*(y+1)-2*t-2*a)*s),height:16*((2-_)*(f+1))-2*n-2*r,sarRatio:b}}};ze.prototype=new a;var Xe={H264Stream:ze,NalByteStream:je},Ke=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Qe=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},$e=function(e,t,a){var n,r="";for(n=t;n<a;n++){r+="%"+("00"+e[n].toString(16)).slice(-2)}return r},Ze=function(e,t,a){return unescape($e(e,t,a))},Je={isLikelyAacData:function(e){if(e[0]===73&&e[1]===68&&e[2]===51){return!0}return!1},parseId3TagSize:function(e,t){var a=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],i=e[t+5];if((16&i)>>4){return a+20}return a+10},parseAdtsSize:function(e,t){var a=(224&e[t+5])>>5,i=e[t+4]<<3,n=e[t+3]&6144;return n|i|a},parseType:function(e,t){if(e[t]===73&&e[t+1]===68&&e[t+2]===51){return"timed-metadata"}else if(e[t]&!0&&240==(240&e[t+1])){return"audio"}return null},parseSampleRate:function(e){var t=0;while(t+5<e.length){if(255!==e[t]||240!=(246&e[t+1])){t++;continue}return Ke[(60&e[t+2])>>>2]}return null},parseAacTimestamp:function(e){var t,a,n,r;t=10;if(64&e[5]){t+=4;t+=Qe(e.subarray(10,14))}do{a=Qe(e.subarray(t+4,t+8));if(1>a){return null}r=String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3]);if("PRIV"===r){n=e.subarray(t+10,t+a+10);for(var s=0;s<n.byteLength;s++){if(0===n[s]){var o=Ze(n,0,s);if("com.apple.streaming.transportStreamTimestamp"===o){var l=n.subarray(s+1),d=(1&l[3])<<30|l[4]<<22|l[5]<<14|l[6]<<6|l[7]>>>2;d*=4;d+=3&l[7];return d}break}}}t+=10;t+=a}while(t<e.byteLength);return null}},et;et=function(){var e=new Uint8Array,t=0;et.prototype.init.call(this);this.setTimestamp=function(e){t=e};this.push=function(a){var i=0,n=0,r,s,d,o;if(e.length){o=e.length;e=new Uint8Array(a.byteLength+o);e.set(e.subarray(0,o));e.set(a,o)}else{e=a}while(3<=e.length-n){if(e[n]===73&&e[n+1]===68&&e[n+2]===51){if(10>e.length-n){break}i=Je.parseId3TagSize(e,n);if(n+i>e.length){break}s={type:"timed-metadata",data:e.subarray(n,n+i)};this.trigger("data",s);n+=i;continue}else if(255==(255&e[n])&&240==(240&e[n+1])){if(7>e.length-n){break}i=Je.parseAdtsSize(e,n);if(n+i>e.length){break}d={type:"audio",data:e.subarray(n,n+i),pts:t,dts:t};this.trigger("data",d);n+=i;continue}n++}r=e.length-n;if(0<r){e=e.subarray(n)}else{e=new Uint8Array}};this.reset=function(){e=new Uint8Array;this.trigger("reset")};this.endTimeline=function(){e=new Uint8Array;this.trigger("endedtimeline")}};et.prototype=new a;var tt=et,at=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],it=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],nt=Xe.H264Stream,rt=Je.isLikelyAacData,st=ne.ONE_SECOND_IN_TS,dt,ot,lt,ut,pt=function(e,t){var a;if(e.length!==t.length){return!1}for(a=0;a<e.length;a++){if(e[a]!==t[a]){return!1}}return!0},mt=function(e,t,a,i,n,r){return{start:{dts:e,pts:e+(a-t)},end:{dts:e+(i-t),pts:e+(n-a)},prependedContentDuration:r,baseMediaDecodeTime:e}};ot=function(e,t){var a=[],i=0,n=0,r=0,s=1/0;t=t||{};ot.prototype.init.call(this);this.push=function(t){oe.collectDtsInfo(e,t);if(e){at.forEach(function(a){e[a]=t[a]})}a.push(t)};this.setEarliestDts=function(e){n=e};this.setVideoBaseMediaDecodeTime=function(e){s=e};this.setAudioAppendStart=function(e){r=e};this.flush=function(){var d,o,l,u,p;if(0===a.length){this.trigger("done","AudioSegmentStream");return}d=se.trimAdtsFramesByEarliestDts(a,e,n);e.baseMediaDecodeTime=oe.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps);se.prefixWithSilence(e,d,r,s);e.samples=se.generateSampleTable(d);l=F.mdat(se.concatenateFrameData(d));a=[];o=F.moof(i,[e]);u=new Uint8Array(o.byteLength+l.byteLength);i++;u.set(o);u.set(l,o.byteLength);oe.clearDtsInfo(e);p=Math.ceil(1024*st/e.samplerate);if(d.length){this.trigger("timingInfo",{start:d[0].pts,end:d[0].pts+d.length*p})}this.trigger("data",{track:e,boxes:u});this.trigger("done","AudioSegmentStream")};this.reset=function(){oe.clearDtsInfo(e);a=[];this.trigger("reset")}};ot.prototype=new a;dt=function(e,t){var a=0,i=[],n=[],r,s;t=t||{};dt.prototype.init.call(this);delete e.minPTS;this.gopCache_=[];this.push=function(t){oe.collectDtsInfo(e,t);if("seq_parameter_set_rbsp"===t.nalUnitType&&!r){r=t.config;e.sps=[t.data];it.forEach(function(t){e[t]=r[t]},this)}if("pic_parameter_set_rbsp"===t.nalUnitType&&!s){s=t.data;e.pps=[t.data]}i.push(t)};this.flush=function(){var r,s,d,o,l,u,p=0,m,c;while(i.length){if("access_unit_delimiter_rbsp"===i[0].nalUnitType){break}i.shift()}if(0===i.length){this.resetStream_();this.trigger("done","VideoSegmentStream");return}r=V.groupNalsIntoFrames(i);d=V.groupFramesIntoGops(r);if(!d[0][0].keyFrame){s=this.getGopForFusion_(i[0],e);if(s){p=s.duration;d.unshift(s);d.byteLength+=s.byteLength;d.nalCount+=s.nalCount;d.pts=s.pts;d.dts=s.dts;d.duration+=s.duration}else{d=V.extendFirstKeyFrame(d)}}if(n.length){var g;if(t.alignGopsAtEnd){g=this.alignGopsAtEnd_(d)}else{g=this.alignGopsAtStart_(d)}if(!g){this.gopCache_.unshift({gop:d.pop(),pps:e.pps,sps:e.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);i=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}oe.clearDtsInfo(e);d=g}oe.collectDtsInfo(e,d);e.samples=V.generateSampleTable(d);l=F.mdat(V.concatenateNalData(d));e.baseMediaDecodeTime=oe.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps);this.trigger("processedGopsInfo",d.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}}));m=d[0];c=d[d.length-1];this.trigger("segmentTimingInfo",mt(e.baseMediaDecodeTime,m.dts,m.pts,c.dts+c.duration,c.pts+c.duration,p));this.trigger("timingInfo",{start:d[0].pts,end:d[d.length-1].pts+d[d.length-1].duration});this.gopCache_.unshift({gop:d.pop(),pps:e.pps,sps:e.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);i=[];this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime);this.trigger("timelineStartInfo",e.timelineStartInfo);o=F.moof(a,[e]);u=new Uint8Array(o.byteLength+l.byteLength);a++;u.set(o);u.set(l,o.byteLength);this.trigger("data",{track:e,boxes:u});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.reset=function(){this.resetStream_();i=[];this.gopCache_.length=0;n.length=0;this.trigger("reset")};this.resetStream_=function(){oe.clearDtsInfo(e);r=void 0;s=void 0};this.getGopForFusion_=function(t){var a=1/0,n,r,s,d,o;for(o=0;o<this.gopCache_.length;o++){d=this.gopCache_[o];s=d.gop;if(!(e.pps&&pt(e.pps[0],d.pps[0]))||!(e.sps&&pt(e.sps[0],d.sps[0]))){continue}if(s.dts<e.timelineStartInfo.dts){continue}n=t.dts-s.dts-s.duration;if(n>=-10000&&n<=45000){if(!r||a>n){r=d;a=n}}}if(r){return r.gop}return null};this.alignGopsAtStart_=function(e){var t,a,i,r,s,d,o,l;s=e.byteLength;d=e.nalCount;o=e.duration;t=a=0;while(t<n.length&&a<e.length){i=n[t];r=e[a];if(i.pts===r.pts){break}if(r.pts>i.pts){t++;continue}a++;s-=r.byteLength;d-=r.nalCount;o-=r.duration}if(0===a){return e}if(a===e.length){return null}l=e.slice(a);l.byteLength=s;l.duration=o;l.nalCount=d;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsAtEnd_=function(e){var t,a,i,r,s,d;t=n.length-1;a=e.length-1;s=null;d=!1;while(0<=t&&0<=a){i=n[t];r=e[a];if(i.pts===r.pts){d=!0;break}if(i.pts>r.pts){t--;continue}if(t===n.length-1){s=a}a--}if(!d&&null===s){return null}var o;if(d){o=a}else{o=s}if(0===o){return e}var l=e.slice(o),u=l.reduce(function(e,t){e.byteLength+=t.byteLength;e.duration+=t.duration;e.nalCount+=t.nalCount;return e},{byteLength:0,duration:0,nalCount:0});l.byteLength=u.byteLength;l.duration=u.duration;l.nalCount=u.nalCount;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsWith=function(e){n=e}};dt.prototype=new a;ut=function(e,t){this.numberOfTracks=0;this.metadataStream=t;e=e||{};if("undefined"!=typeof e.remux){this.remuxTracks=!!e.remux}else{this.remuxTracks=!0}if("boolean"==typeof e.keepOriginalTimestamps){this.keepOriginalTimestamps=e.keepOriginalTimestamps}else{this.keepOriginalTimestamps=!1}this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;ut.prototype.init.call(this);this.push=function(e){if(e.text){return this.pendingCaptions.push(e)}if(e.frames){return this.pendingMetadata.push(e)}this.pendingTracks.push(e.track);this.pendingBytes+=e.boxes.byteLength;if("video"===e.track.type){this.videoTrack=e.track;this.pendingBoxes.push(e.boxes)}if("audio"===e.track.type){this.audioTrack=e.track;this.pendingBoxes.unshift(e.boxes)}}};ut.prototype=new a;ut.prototype.flush=function(e){var t=0,a={captions:[],captionStreams:{},metadata:[],info:{}},n,r,s,d=0,o;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e){return}else if(this.remuxTracks){return}else if(0===this.pendingTracks.length){this.emittedTracks++;if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}return}}if(this.videoTrack){d=this.videoTrack.timelineStartInfo.pts;it.forEach(function(e){a.info[e]=this.videoTrack[e]},this)}else if(this.audioTrack){d=this.audioTrack.timelineStartInfo.pts;at.forEach(function(e){a.info[e]=this.audioTrack[e]},this)}if(this.videoTrack||this.audioTrack){if(1===this.pendingTracks.length){a.type=this.pendingTracks[0].type}else{a.type="combined"}this.emittedTracks+=this.pendingTracks.length;s=F.initSegment(this.pendingTracks);a.initSegment=new Uint8Array(s.byteLength);a.initSegment.set(s);a.data=new Uint8Array(this.pendingBytes);for(o=0;o<this.pendingBoxes.length;o++){a.data.set(this.pendingBoxes[o],t);t+=this.pendingBoxes[o].byteLength}for(o=0;o<this.pendingCaptions.length;o++){n=this.pendingCaptions[o];n.startTime=ne.metadataTsToSeconds(n.startPts,d,this.keepOriginalTimestamps);n.endTime=ne.metadataTsToSeconds(n.endPts,d,this.keepOriginalTimestamps);a.captionStreams[n.stream]=!0;a.captions.push(n)}for(o=0;o<this.pendingMetadata.length;o++){r=this.pendingMetadata[o];r.cueTime=ne.metadataTsToSeconds(r.pts,d,this.keepOriginalTimestamps);a.metadata.push(r)}a.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",a);for(o=0;o<a.captions.length;o++){n=a.captions[o];this.trigger("caption",n)}for(o=0;o<a.metadata.length;o++){r=a.metadata[o];this.trigger("id3Frame",r)}}if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}};ut.prototype.setRemux=function(e){this.remuxTracks=e};lt=function(e){var t=this,a=!0,n,r;lt.prototype.init.call(this);e=e||{};this.baseMediaDecodeTime=e.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var a={};this.transmuxPipeline_=a;a.type="aac";a.metadataStream=new Me.MetadataStream;a.aacStream=new tt;a.audioTimestampRolloverStream=new Me.TimestampRolloverStream("audio");a.timedMetadataTimestampRolloverStream=new Me.TimestampRolloverStream("timed-metadata");a.adtsStream=new Ge;a.coalesceStream=new ut(e,a.metadataStream);a.headOfPipeline=a.aacStream;a.aacStream.pipe(a.audioTimestampRolloverStream).pipe(a.adtsStream);a.aacStream.pipe(a.timedMetadataTimestampRolloverStream).pipe(a.metadataStream).pipe(a.coalesceStream);a.metadataStream.on("timestamp",function(e){a.aacStream.setTimestamp(e.timeStamp)});a.aacStream.on("data",function(i){if("timed-metadata"===i.type&&!a.audioSegmentStream){r=r||{timelineStartInfo:{baseMediaDecodeTime:t.baseMediaDecodeTime},codec:"adts",type:"audio"};a.coalesceStream.numberOfTracks++;a.audioSegmentStream=new ot(r,e);a.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo"));a.adtsStream.pipe(a.audioSegmentStream).pipe(a.coalesceStream)}t.trigger("trackinfo",{hasAudio:!!r,hasVideo:!!n})});a.coalesceStream.on("data",this.trigger.bind(this,"data"));a.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setupTsPipeline=function(){var a={};this.transmuxPipeline_=a;a.type="ts";a.metadataStream=new Me.MetadataStream;a.packetStream=new Me.TransportPacketStream;a.parseStream=new Me.TransportParseStream;a.elementaryStream=new Me.ElementaryStream;a.timestampRolloverStream=new Me.TimestampRolloverStream;a.adtsStream=new Ge;a.h264Stream=new nt;a.captionStream=new Me.CaptionStream;a.coalesceStream=new ut(e,a.metadataStream);a.headOfPipeline=a.packetStream;a.packetStream.pipe(a.parseStream).pipe(a.elementaryStream).pipe(a.timestampRolloverStream);a.timestampRolloverStream.pipe(a.h264Stream);a.timestampRolloverStream.pipe(a.adtsStream);a.timestampRolloverStream.pipe(a.metadataStream).pipe(a.coalesceStream);a.h264Stream.pipe(a.captionStream).pipe(a.coalesceStream);a.elementaryStream.on("data",function(s){var d,o=!e.keepOriginalTimestamps?t.baseMediaDecodeTime:0;if("metadata"===s.type){d=s.tracks.length;while(d--){if(!n&&"video"===s.tracks[d].type){n=s.tracks[d];n.timelineStartInfo.baseMediaDecodeTime=o}else if(!r&&"audio"===s.tracks[d].type){r=s.tracks[d];r.timelineStartInfo.baseMediaDecodeTime=o}}if(n&&!a.videoSegmentStream){a.coalesceStream.numberOfTracks++;a.videoSegmentStream=new dt(n,e);a.videoSegmentStream.on("timelineStartInfo",function(i){if(r&&!e.keepOriginalTimestamps){r.timelineStartInfo=i;a.audioSegmentStream.setEarliestDts(i.dts-t.baseMediaDecodeTime)}});a.videoSegmentStream.on("processedGopsInfo",t.trigger.bind(t,"gopInfo"));a.videoSegmentStream.on("segmentTimingInfo",t.trigger.bind(t,"videoSegmentTimingInfo"));a.videoSegmentStream.on("baseMediaDecodeTime",function(e){if(r){a.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}});a.videoSegmentStream.on("timingInfo",t.trigger.bind(t,"videoTimingInfo"));a.h264Stream.pipe(a.videoSegmentStream).pipe(a.coalesceStream)}if(r&&!a.audioSegmentStream){a.coalesceStream.numberOfTracks++;a.audioSegmentStream=new ot(r,e);a.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo"));a.adtsStream.pipe(a.audioSegmentStream).pipe(a.coalesceStream)}t.trigger("trackinfo",{hasAudio:!!r,hasVideo:!!n})}});a.coalesceStream.on("data",this.trigger.bind(this,"data"));a.coalesceStream.on("id3Frame",function(e){e.dispatchType=a.metadataStream.dispatchType;t.trigger("id3Frame",e)});a.coalesceStream.on("caption",this.trigger.bind(this,"caption"));a.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setBaseMediaDecodeTime=function(e){var t=this.transmuxPipeline_;this.baseMediaDecodeTime=e;if(r){r.timelineStartInfo.dts=void 0;r.timelineStartInfo.pts=void 0;oe.clearDtsInfo(r);if(t.audioTimestampRolloverStream){t.audioTimestampRolloverStream.discontinuity()}}if(n){if(t.videoSegmentStream){t.videoSegmentStream.gopCache_=[]}n.timelineStartInfo.dts=void 0;n.timelineStartInfo.pts=void 0;oe.clearDtsInfo(n);t.captionStream.reset()}if(t.timestampRolloverStream){t.timestampRolloverStream.discontinuity()}};this.setAudioAppendStart=function(e){if(r){this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)}};this.setRemux=function(t){var a=this.transmuxPipeline_;e.remux=t;if(a&&a.coalesceStream){a.coalesceStream.setRemux(t)}};this.alignGopsWith=function(e){if(n&&this.transmuxPipeline_.videoSegmentStream){this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)}};this.push=function(e){if(a){var t=rt(e);if(t&&"aac"!==this.transmuxPipeline_.type){this.setupAacPipeline()}else if(!t&&"ts"!==this.transmuxPipeline_.type){this.setupTsPipeline()}a=!1}this.transmuxPipeline_.headOfPipeline.push(e)};this.flush=function(){a=!0;this.transmuxPipeline_.headOfPipeline.flush()};this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()};this.reset=function(){if(this.transmuxPipeline_.headOfPipeline){this.transmuxPipeline_.headOfPipeline.reset()}};this.resetCaptions=function(){if(this.transmuxPipeline_.captionStream){this.transmuxPipeline_.captionStream.reset()}}};lt.prototype=new a;var ct={Transmuxer:lt,VideoSegmentStream:dt,AudioSegmentStream:ot,AUDIO_PROPERTIES:at,VIDEO_PROPERTIES:it,generateVideoSegmentTimingInfo:mt},gt=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}},yt=function(){function e(e,t){for(var a=0,n;a<t.length;a++){n=t[a];n.enumerable=n.enumerable||!1;n.configurable=!0;if("value"in n)n.writable=!0;Object.defineProperty(e,n.key,n)}}return function(t,a,i){if(a)e(t.prototype,a);if(i)e(t,i);return t}}(),ft=function(e,t){t.on("data",function(t){var a=t.initSegment;t.initSegment={data:a.buffer,byteOffset:a.byteOffset,byteLength:a.byteLength};var i=t.data;t.data=i.buffer;e.postMessage({action:"data",segment:t,byteOffset:i.byteOffset,byteLength:i.byteLength},[t.data])});if(t.captionStream){t.captionStream.on("data",function(t){e.postMessage({action:"caption",data:t})})}t.on("done",function(){e.postMessage({action:"done"})});t.on("gopInfo",function(t){e.postMessage({action:"gopInfo",gopInfo:t})});t.on("videoSegmentTimingInfo",function(t){e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})})},_t=function(){function e(t,a){gt(this,e);this.options=a||{};this.self=t;this.init()}yt(e,[{key:"init",value:function(){if(this.transmuxer){this.transmuxer.dispose()}this.transmuxer=new ct.Transmuxer(this.options);ft(this.self,this.transmuxer)}},{key:"push",value:function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*t))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}]);return e}(),ht=new function(e){e.onmessage=function(t){if("init"===t.data.action&&t.data.options){this.messageHandlers=new _t(e,t.data.options);return}if(!this.messageHandlers){this.messageHandlers=new _t(e)}if(t.data&&t.data.action&&"init"!==t.data.action){if(this.messageHandlers[t.data.action]){this.messageHandlers[t.data.action](t.data)}}}}(e);return ht}()}),ga={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},ya=function(e){return e.map(function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,a){var i=("00"+(+t).toString(16)).slice(-2),n=("00"+(+a).toString(16)).slice(-2);return"avc1."+i+"00"+n})})},fa=function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",t={codecCount:0},a=void 0;t.codecCount=e.split(",").length;t.codecCount=t.codecCount||2;a=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(e);if(a){t.videoCodec=a[2];t.videoObjectTypeIndicator=a[3]}t.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(e);t.audioProfile=t.audioProfile&&t.audioProfile[2];return t},_a=function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e){return ya([e])[0]})},ha=function(e,t,a){return e+"/"+t+"; codecs=\""+a.filter(function(e){return!!e}).join(", ")+"\""},ba=function(e){if(e.segments&&e.segments.length&&e.segments[0].map){return"mp4"}return"mp2t"},Ta=function(e){var t=e.attributes||{};if(t.CODECS){return fa(t.CODECS)}return ga},Sa=function(e,t){if(!e.mediaGroups.AUDIO||!t){return null}var a=e.mediaGroups.AUDIO[t];if(!a){return null}for(var i in a){var n=a[i];if(n.default&&n.playlists){return fa(n.playlists[0].attributes.CODECS).audioProfile}}return null},va=function(e,a){var i=ba(a),n=Ta(a),r=a.attributes||{},s=!0,d=!1;if(!a){return[]}if(e.mediaGroups.AUDIO&&r.AUDIO){var o=e.mediaGroups.AUDIO[r.AUDIO];if(o){d=!0;s=!1;for(var l in o){if(!o[l].uri&&!o[l].playlists){s=!0;break}}}}if(d&&!n.audioProfile){if(!s){n.audioProfile=Sa(e,r.AUDIO)}if(!n.audioProfile){t.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)");n.audioProfile=ga.audioProfile}}var u={};if(n.videoCodec){u.video=""+n.videoCodec+n.videoObjectTypeIndicator}if(n.audioProfile){u.audio="mp4a.40."+n.audioProfile}var p=ha("audio",i,[u.audio]),m=ha("video",i,[u.video]),c=ha("video",i,[u.video,u.audio]);if(d){if(!s&&u.video){return[m,p]}if(!s&&!u.video){return[p,p]}return[c,p]}if(!u.video){return[p]}return[c]},ka=function(e){var t={type:"",parameters:{}},a=e.trim().split(";");t.type=a.shift().trim();a.forEach(function(e){var a=e.trim().split("=");if(1<a.length){var i=a[0].replace(/"/g,"").trim(),n=a[1].replace(/"/g,"").trim();t.parameters[i]=n}});return t},Ia=function(e){return /mp4a\.\d+.\d+/i.test(e)},Ea=function(e){return /avc1\.[\da-f]+/i.test(e)},La=function(e,t,a){if("undefined"==typeof t||null===t||!e.length){return[]}var n=Math.ceil(9e4*(t-a+3)),r=void 0;for(r=0;r<e.length;r++){if(e[r].pts>n){break}}return e.slice(r)},Ca=function(e,t,a){if(!t.length){return e}if(a){return t.slice()}var n=t[0].pts,r=0;for(r;r<e.length;r++){if(e[r].pts>=n){break}}return e.slice(0,r).concat(t)},Da=function(e,t,a,n){var r=Math.ceil(9e4*(t-n)),s=Math.ceil(9e4*(a-n)),d=e.slice(),o=e.length;while(o--){if(e[o].pts<=s){break}}if(-1===o){return d}var l=o+1;while(l--){if(e[l].pts<=r){break}}l=Math.max(l,0);d.splice(l,o-l+1);return d},Pa=function(e,a,i){var n=null,r=null,s=0,d=[],o=[];if(!e&&!a){return t.createTimeRange()}if(!e){return a.buffered}if(!a){return e.buffered}if(i){return e.buffered}if(0===e.buffered.length&&0===a.buffered.length){return t.createTimeRange()}var l=e.buffered,u=a.buffered,p=l.length;while(p--){d.push({time:l.start(p),type:"start"});d.push({time:l.end(p),type:"end"})}p=u.length;while(p--){d.push({time:u.start(p),type:"start"});d.push({time:u.end(p),type:"end"})}d.sort(function(e,t){return e.time-t.time});for(p=0;p<d.length;p++){if("start"===d[p].type){s++;if(2===s){n=d[p].time}}else if("end"===d[p].type){s--;if(1===s){r=d[p].time}}if(null!==n&&null!==r){o.push([n,r]);n=null;r=null}}return t.createTimeRanges(o)},Oa=9e4,xa=function(e,t){var a=e.addSourceBuffer(t),i=Object.create(null);i.updating=!1;i.realBuffer_=a;var n=function(e){if("function"==typeof a[e]){i[e]=function(){return a[e].apply(a,arguments)}}else if("undefined"==typeof i[e]){Object.defineProperty(i,e,{get:function(){return a[e]},set:function(t){return a[e]=t}})}};for(var r in a){n(r)}return i},Ua=function(e){xe(a,e);function a(e,i){De(this,a);var n=Ue(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t.EventTarget));n.timestampOffset_=0;n.pendingBuffers_=[];n.bufferUpdating_=!1;n.mediaSource_=e;n.codecs_=i;n.audioCodec_=null;n.videoCodec_=null;n.audioDisabled_=!1;n.appendAudioInitSegment_=!0;n.gopBuffer_=[];n.timeMapping_=0;n.safeAppend_=11<=t.browser.IE_VERSION;var r={remux:!1,alignGopsAtEnd:n.safeAppend_};n.codecs_.forEach(function(e){if(Ia(e)){n.audioCodec_=e}else if(Ea(e)){n.videoCodec_=e}});n.transmuxer_=new ca;n.transmuxer_.postMessage({action:"init",options:r});n.transmuxer_.onmessage=function(e){if("data"===e.data.action){return n.data_(e)}if("done"===e.data.action){return n.done_(e)}if("gopInfo"===e.data.action){return n.appendGopInfo_(e)}if("videoSegmentTimingInfo"===e.data.action){return n.videoSegmentTimingInfo_(e.data.videoSegmentTimingInfo)}};Object.defineProperty(n,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){if("number"==typeof e&&0<=e){this.timestampOffset_=e;this.appendAudioInitSegment_=!0;this.gopBuffer_.length=0;this.timeMapping_=0;this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e})}}});Object.defineProperty(n,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){if(this.videoBuffer_){this.videoBuffer_.appendWindowStart=e}if(this.audioBuffer_){this.audioBuffer_.appendWindowStart=e}}});Object.defineProperty(n,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}});Object.defineProperty(n,"buffered",{get:function(){return Pa(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}});return n}Pe(a,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength);t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength);ea(this,this.mediaSource_,t);this.pendingBuffers_.push(t)}},{key:"done_",value:function(){if("closed"===this.mediaSource_.readyState){this.pendingBuffers_.length=0;return}this.processPendingSegments_()}},{key:"videoSegmentTimingInfo_",value:function(e){var t={start:{decode:e.start.dts/Oa,presentation:e.start.pts/Oa},end:{decode:e.end.dts/Oa,presentation:e.end.pts/Oa},baseMediaDecodeTime:e.baseMediaDecodeTime/Oa};if(e.prependedContentDuration){t.prependedContentDuration=e.prependedContentDuration/Oa}this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}},{key:"createRealSourceBuffers_",value:function(){var e=this,t=["audio","video"];t.forEach(function(a){if(!e[a+"Codec_"]){return}if(e[a+"Buffer_"]){return}var i=null;if(e.mediaSource_[a+"Buffer_"]){i=e.mediaSource_[a+"Buffer_"];i.updating=!1}else{var n=a+"/mp4;codecs=\""+e[a+"Codec_"]+"\"";i=xa(e.mediaSource_.nativeMediaSource_,n);e.mediaSource_[a+"Buffer_"]=i}e[a+"Buffer_"]=i;["update","updatestart","updateend"].forEach(function(n){i.addEventListener(n,function(){if("audio"===a&&e.audioDisabled_){return}if("updateend"===n){e[a+"Buffer_"].updating=!1}var i=t.every(function(i){if("audio"===i&&e.audioDisabled_){return!0}if(a!==i&&e[i+"Buffer_"]&&e[i+"Buffer_"].updating){return!1}return!0});if(i){return e.trigger(n)}})})})}},{key:"appendBuffer",value:function(e){this.bufferUpdating_=!0;if(this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}if(this.videoBuffer_){this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:La(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)})}this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]);this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=Ca(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_){this.videoBuffer_.updating=!0;this.videoBuffer_.remove(e,t);this.gopBuffer_=Da(this.gopBuffer_,e,t,this.timeMapping_)}if(!this.audioDisabled_&&this.audioBuffer_){this.audioBuffer_.updating=!0;this.audioBuffer_.remove(e,t)}ta(e,t,this.metadataTrack_);if(this.inbandTextTracks_){for(var a in this.inbandTextTracks_){ta(e,t,this.inbandTextTracks_[a])}}}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};if(!this.pendingBuffers_.length){this.trigger("updateend");this.bufferUpdating_=!1;return}e=this.pendingBuffers_.reduce(function(e,t){var a=t.type,i=t.data,n=t.initSegment;e[a].segments.push(i);e[a].bytes+=i.byteLength;e[a].initSegment=n;if(t.captions){e.captions=e.captions.concat(t.captions)}if(t.info){e[a].info=t.info}if(t.metadata){e.metadata=e.metadata.concat(t.metadata)}return e},e);if(!this.videoBuffer_&&!this.audioBuffer_){if(0===e.video.bytes){this.videoCodec_=null}if(0===e.audio.bytes){this.audioCodec_=null}this.createRealSourceBuffers_()}if(e.audio.info){this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info})}if(e.video.info){this.mediaSource_.trigger({type:"videoinfo",info:e.video.info})}if(this.appendAudioInitSegment_){if(!this.audioDisabled_&&this.audioBuffer_){e.audio.segments.unshift(e.audio.initSegment);e.audio.bytes+=e.audio.initSegment.byteLength}this.appendAudioInitSegment_=!1}var t=!1;if(this.videoBuffer_&&e.video.bytes){e.video.segments.unshift(e.video.initSegment);e.video.bytes+=e.video.initSegment.byteLength;this.concatAndAppendSegments_(e.video,this.videoBuffer_)}else if(this.videoBuffer_&&(this.audioDisabled_||!this.audioBuffer_)){t=!0}na(this,e.captions,e.metadata);if(!this.audioDisabled_&&this.audioBuffer_){this.concatAndAppendSegments_(e.audio,this.audioBuffer_)}this.pendingBuffers_.length=0;if(t){this.trigger("updateend")}this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var a=0,i=void 0;if(e.bytes){i=new Uint8Array(e.bytes);e.segments.forEach(function(e){i.set(e,a);a+=e.byteLength});try{t.updating=!0;t.appendBuffer(i)}catch(e){if(this.mediaSource_.player_){this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}}},{key:"abort",value:function(){if(this.videoBuffer_){this.videoBuffer_.abort()}if(!this.audioDisabled_&&this.audioBuffer_){this.audioBuffer_.abort()}if(this.transmuxer_){this.transmuxer_.postMessage({action:"reset"})}this.pendingBuffers_.length=0;this.bufferUpdating_=!1}},{key:"dispose",value:function(){if(this.transmuxer_){this.transmuxer_.terminate()}this.trigger("dispose");this.off()}}]);return a}(t.EventTarget),Ra=function(e){xe(a,e);function a(){De(this,a);var e=Ue(this,(a.__proto__||Object.getPrototypeOf(a)).call(this)),i=void 0;e.nativeMediaSource_=new be.MediaSource;for(i in e.nativeMediaSource_){if(!(i in a.prototype)&&"function"==typeof e.nativeMediaSource_[i]){e[i]=e.nativeMediaSource_[i].bind(e.nativeMediaSource_)}}e.duration_=NaN;Object.defineProperty(e,"duration",{get:function(){if(this.duration_===1/0){return this.duration_}return this.nativeMediaSource_.duration},set:function(e){this.duration_=e;if(e!==1/0){this.nativeMediaSource_.duration=e}}});Object.defineProperty(e,"seekable",{get:function(){if(this.duration_===1/0){return t.createTimeRanges([[0,this.nativeMediaSource_.duration]])}return this.nativeMediaSource_.seekable}});Object.defineProperty(e,"readyState",{get:function(){return this.nativeMediaSource_.readyState}});Object.defineProperty(e,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}});e.sourceBuffers=[];e.activeSourceBuffers_=[];e.updateActiveSourceBuffers_=function(){e.activeSourceBuffers_.length=0;if(1===e.sourceBuffers.length){var t=e.sourceBuffers[0];t.appendAudioInitSegment_=!0;t.audioDisabled_=!t.audioCodec_;e.activeSourceBuffers_.push(t);return}for(var a=!1,n=!0,r=0,s;r<e.player_.audioTracks().length;r++){s=e.player_.audioTracks()[r];if(s.enabled&&"main"!==s.kind){a=!0;n=!1;break}}e.sourceBuffers.forEach(function(t,i){t.appendAudioInitSegment_=!0;if(t.videoCodec_&&t.audioCodec_){t.audioDisabled_=a}else if(t.videoCodec_&&!t.audioCodec_){t.audioDisabled_=!0;n=!1}else if(!t.videoCodec_&&t.audioCodec_){t.audioDisabled_=i?n:!n;if(t.audioDisabled_){return}}e.activeSourceBuffers_.push(t)})};e.onPlayerMediachange_=function(){e.sourceBuffers.forEach(function(e){e.appendAudioInitSegment_=!0})};e.onHlsReset_=function(){e.sourceBuffers.forEach(function(e){if(e.transmuxer_){e.transmuxer_.postMessage({action:"resetCaptions"})}})};e.onHlsSegmentTimeMapping_=function(t){e.sourceBuffers.forEach(function(e){return e.timeMapping_=t.mapping})};["sourceopen","sourceclose","sourceended"].forEach(function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))},e);e.on("sourceopen",function(){var a=fe.querySelector("[src=\""+e.url_+"\"]");if(!a){return}e.player_=t(a.parentNode);if(!e.player_){return}e.player_.tech_.on("hls-reset",e.onHlsReset_);e.player_.tech_.on("hls-segment-time-mapping",e.onHlsSegmentTimeMapping_);if(e.player_.audioTracks&&e.player_.audioTracks()){e.player_.audioTracks().on("change",e.updateActiveSourceBuffers_);e.player_.audioTracks().on("addtrack",e.updateActiveSourceBuffers_);e.player_.audioTracks().on("removetrack",e.updateActiveSourceBuffers_)}e.player_.on("mediachange",e.onPlayerMediachange_)});e.on("sourceended",function(){for(var t=ia(e.duration),a=0;a<e.sourceBuffers.length;a++){var n=e.sourceBuffers[a],r=n.metadataTrack_&&n.metadataTrack_.cues;if(r&&r.length){r[r.length-1].endTime=t}}});e.on("sourceclose",function(){this.sourceBuffers.forEach(function(e){if(e.transmuxer_){e.transmuxer_.terminate()}});this.sourceBuffers.length=0;if(!this.player_){return}if(this.player_.audioTracks&&this.player_.audioTracks()){this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_);this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_);this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)}if(this.player_.el_){this.player_.off("mediachange",this.onPlayerMediachange_)}if(this.player_.tech_&&this.player_.tech_.el_){this.player_.tech_.off("hls-reset",this.onHlsReset_);this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)}});return e}Pe(a,[{key:"addSeekableRange_",value:function(e,t){var a;if(this.duration!==1/0){a=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity");a.name="InvalidStateError";a.code=11;throw a}if(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration)){this.nativeMediaSource_.duration=t}}},{key:"addSourceBuffer",value:function(e){var t=void 0,a=ka(e);if(/^(video|audio)\/mp2t$/i.test(a.type)){var i=[];if(a.parameters&&a.parameters.codecs){i=a.parameters.codecs.split(",");i=ya(i);i=i.filter(function(e){return Ia(e)||Ea(e)})}if(0===i.length){i=["avc1.4d400d","mp4a.40.2"]}t=new Ua(this,i);if(0!==this.sourceBuffers.length){this.sourceBuffers[0].createRealSourceBuffers_();t.createRealSourceBuffers_();this.sourceBuffers[0].audioDisabled_=!0}}else{t=this.nativeMediaSource_.addSourceBuffer(e)}this.sourceBuffers.push(t);return t}},{key:"dispose",value:function(){this.trigger("dispose");this.off();this.sourceBuffers.forEach(function(e){if(e.dispose){e.dispose()}});this.sourceBuffers.length=0}}]);return a}(t.EventTarget),Aa=0;t.mediaSources={};var Na=function(e,a){var i=t.mediaSources[e];if(i){i.trigger({type:"sourceopen",swfId:a})}else{throw new Error("Media Source not found (Video.js)")}},wa=function(){return!!be.MediaSource&&!!be.MediaSource.isTypeSupported&&be.MediaSource.isTypeSupported("video/mp4;codecs=\"avc1.4d400d,mp4a.40.2\"")},Ba=function(){this.MediaSource={open:Na,supportsNativeMediaSources:wa};if(wa()){return new Ra}throw new Error("Cannot use create a virtual MediaSource for this video")};Ba.open=Na;Ba.supportsNativeMediaSources=wa;var Ma={createObjectURL:function(e){var a=void 0;if(e instanceof Ra){a=be.URL.createObjectURL(e.nativeMediaSource_);e.url_=a;return a}if(!(e instanceof Ra)){a=be.URL.createObjectURL(e);e.url_=a;return a}a="blob:vjs-media-source/"+Aa;Aa++;t.mediaSources[a]=e;return a}};t.MediaSource=Ba;t.URL=Ma;function p(e){return e&&"object"===_typeof(e)&&"default"in e?e["default"]:e}var qa=p(_e),Fa=p(be),Ha=function(e,t){if(/^[a-z]+:/i.test(t)){return t}if(!/\/\//i.test(e)){e=qa.buildAbsoluteURL(Fa.location&&Fa.location.href||"",e)}return qa.buildAbsoluteURL(e,t)};function m(e){return e&&"object"===_typeof(e)&&"default"in e?e["default"]:e}var Ga=m(be),Va=function(e){return Ga.atob?Ga.atob(e):Buffer.from(e,"base64").toString("binary")};var Wa=function(e){for(var t=Va(e),a=new Uint8Array(t.length),n=0;n<t.length;n++){a[n]=t.charCodeAt(n)}return a},za=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,ja=new RegExp("[\\-\\.0-9"+za.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Ya=new RegExp("^"+za.source+ja.source+"*(?::"+za.source+ja.source+"*)?$"),Xa=0,Ka=1,Qa=2,$a=3,Za=4,Ja=5,ei=6,ti=7;function c(){}c.prototype={parse:function(e,t,a){var i=this.domBuilder;i.startDocument();T(t,t={});g(e,t,a,i,this.errorHandler);i.endDocument()}};function g(e,t,n,r,s){function d(e){if(65535<e){e-=65536;var t=55296+(e>>10),a=56320+(1023&e);return String.fromCharCode(t,a)}else{return String.fromCharCode(e)}}function o(e){var t=e.slice(1,-1);if(t in n){return n[t]}else if("#"===t.charAt(0)){return d(parseInt(t.substr(1).replace("x","0x")))}else{s.error("entity not found:"+e);return e}}function l(t){if(t>C){var a=e.substring(C,t).replace(/&#?\w+;/g,o);I&&u(C);r.characters(a,0,t-C);C=t}}function u(t,a){while(t>=g&&(a=T.exec(e))){c=a.index;g=c+a[0].length;I.lineNumber++}I.columnNumber=t-c+1}var c=0,g=0,T=/.*(?:\r\n?|\n)|.*$/g,I=r.locator,E=[{currentNSMap:t}],L={},C=0;while(!0){try{var D=e.indexOf("<",C);if(0>D){if(!e.substr(C).match(/^\s*$/)){var P=r.doc,O=P.createTextNode(e.substr(C));P.appendChild(O);r.currentElement=O}return}if(D>C){l(D)}switch(e.charAt(D+1)){case"/":var x=e.indexOf(">",D+3),U=e.substring(D+2,x),R=E.pop();if(0>x){U=e.substring(D+2).replace(/[\s<].*/,"");s.error("end tag name: "+U+" is not complete:"+R.tagName);x=D+1+U.length}else if(U.match(/\s</)){U=U.replace(/[\s<].*/,"");s.error("end tag name: "+U+" maybe not complete");x=D+1+U.length}var A=R.localNSMap,N=R.tagName==U,w=N||R.tagName&&R.tagName.toLowerCase()==U.toLowerCase();if(w){r.endElement(R.uri,R.localName,U);if(A){for(var B in A){r.endPrefixMapping(B)}}if(!N){s.fatalError("end tag name: "+U+" is not match the current start tagName:"+R.tagName)}}else{E.push(R)}x++;break;case"?":I&&u(D);x=v(e,D,r);break;case"!":I&&u(D);x=S(e,D,r,s);break;default:I&&u(D);var M=new k,p=E[E.length-1].currentNSMap,x=f(e,D,M,p,o,s),m=M.length;if(!M.closed&&b(e,x,M.tagName,L)){M.closed=!0;if(!n.nbsp){s.warning("unclosed xml attribute")}}if(I&&m){for(var q=y(I,{}),F=0,H;F<m;F++){H=M[F];u(H.offset);H.locator=y(I,{})}r.locator=q;if(_(M,r,p)){E.push(M)}r.locator=I}else{if(_(M,r,p)){E.push(M)}}if("http://www.w3.org/1999/xhtml"===M.uri&&!M.closed){x=h(e,x,M.tagName,o,r)}else{x++}}}catch(t){s.error("element parse error: "+t);x=-1}if(x>C){C=x}else{l(Math.max(D,C)+1)}}}function y(e,a){a.lineNumber=e.lineNumber;a.columnNumber=e.columnNumber;return a}function f(e,t,a,i,n,r){var d,o,l=++t,u=Xa;while(!0){var m=e.charAt(l);switch(m){case"=":if(u===Ka){d=e.slice(t,l);u=$a}else if(u===Qa){u=$a}else{throw new Error("attribute equal must after attrName")}break;case"'":case"\"":if(u===$a||u===Ka){if(u===Ka){r.warning("attribute value must after \"=\"");d=e.slice(t,l)}t=l+1;l=e.indexOf(m,t);if(0<l){o=e.slice(t,l).replace(/&#?\w+;/g,n);a.add(d,o,t-1);u=Ja}else{throw new Error("attribute value no end '"+m+"' match")}}else if(u==Za){o=e.slice(t,l).replace(/&#?\w+;/g,n);a.add(d,o,t);r.warning("attribute \""+d+"\" missed start quot("+m+")!!");t=l+1;u=Ja}else{throw new Error("attribute value must after \"=\"")}break;case"/":switch(u){case Xa:a.setTagName(e.slice(t,l));case Ja:case ei:case ti:u=ti;a.closed=!0;case Za:case Ka:case Qa:break;default:throw new Error("attribute invalid close char('/')");}break;case"":r.error("unexpected end of input");if(u==Xa){a.setTagName(e.slice(t,l))}return l;case">":switch(u){case Xa:a.setTagName(e.slice(t,l));case Ja:case ei:case ti:break;case Za:case Ka:o=e.slice(t,l);if("/"===o.slice(-1)){a.closed=!0;o=o.slice(0,-1)}case Qa:if(u===Qa){o=d}if(u==Za){r.warning("attribute \""+o+"\" missed quot(\")!!");a.add(d,o.replace(/&#?\w+;/g,n),t)}else{if("http://www.w3.org/1999/xhtml"!==i[""]||!o.match(/^(?:disabled|checked|selected)$/i)){r.warning("attribute \""+o+"\" missed value!! \""+o+"\" instead!!")}a.add(o,o,t)}break;case $a:throw new Error("attribute value missed!!");}return l;case"\x80":m=" ";default:if(" ">=m){switch(u){case Xa:a.setTagName(e.slice(t,l));u=ei;break;case Ka:d=e.slice(t,l);u=Qa;break;case Za:var o=e.slice(t,l).replace(/&#?\w+;/g,n);r.warning("attribute \""+o+"\" missed quot(\")!!");a.add(d,o,t);case Ja:u=ei;break;}}else{switch(u){case Qa:a.tagName;if("http://www.w3.org/1999/xhtml"!==i[""]||!d.match(/^(?:disabled|checked|selected)$/i)){r.warning("attribute \""+d+"\" missed value!! \""+d+"\" instead2!!")}a.add(d,d,t);t=l;u=Ka;break;case Ja:r.warning("attribute space is required\""+d+"\"!!");case ei:u=Ka;t=l;break;case $a:u=Za;t=l;break;case ti:throw new Error("elements closed character '/' and '>' must be connected to");}}}l++}}function _(e,t,n){var r=e.tagName,s=null,d=e.length;while(d--){var o=e[d],l=o.qName,u=o.value,p=l.indexOf(":");if(0<p){var m=o.prefix=l.slice(0,p),c=l.slice(p+1),g="xmlns"===m&&c}else{c=l;m=null;g="xmlns"===l&&""}o.localName=c;if(!1!==g){if(null==s){s={};T(n,n={})}n[g]=s[g]=u;o.uri="http://www.w3.org/2000/xmlns/";t.startPrefixMapping(g,u)}}var d=e.length;while(d--){o=e[d];var m=o.prefix;if(m){if("xml"===m){o.uri="http://www.w3.org/XML/1998/namespace"}if("xmlns"!==m){o.uri=n[m||""]}}}var p=r.indexOf(":");if(0<p){m=e.prefix=r.slice(0,p);c=e.localName=r.slice(p+1)}else{m=null;c=e.localName=r}var y=e.uri=n[m||""];t.startElement(y,c,r,e);if(e.closed){t.endElement(y,c,r);if(s){for(m in s){t.endPrefixMapping(m)}}}else{e.currentNSMap=n;e.localNSMap=s;return!0}}function h(e,t,a,i,n){if(/^(?:script|textarea)$/i.test(a)){var r=e.indexOf("</"+a+">",t),s=e.substring(t+1,r);if(/[&<]/.test(s)){if(/^script$/i.test(a)){n.characters(s,0,s.length);return r}s=s.replace(/&#?\w+;/g,i);n.characters(s,0,s.length);return r}}return t+1}function b(e,t,a,i){var n=i[a];if(null==n){n=e.lastIndexOf("</"+a+">");if(n<t){n=e.lastIndexOf("</"+a)}i[a]=n}return n<t}function T(e,t){for(var a in e){t[a]=e[a]}}function S(e,t,a,i){var n=e.charAt(t+2);switch(n){case"-":if("-"===e.charAt(t+3)){var r=e.indexOf("-->",t+4);if(r>t){a.comment(e,t+4,r-t-4);return r+3}else{i.error("Unclosed comment");return-1}}else{return-1}default:if("CDATA["==e.substr(t+3,6)){var r=e.indexOf("]]>",t+9);a.startCDATA();a.characters(e,t+9,r-t-9);a.endCDATA();return r+3}var s=E(e,t),d=s.length;if(1<d&&/!doctype/i.test(s[0][0])){var o=s[1][0],l=3<d&&/^public$/i.test(s[2][0])&&s[3][0],u=4<d&&s[4][0],p=s[d-1];a.startDTD(o,l&&l.replace(/^(['"])(.*?)\1$/,"$2"),u&&u.replace(/^(['"])(.*?)\1$/,"$2"));a.endDTD();return p.index+p[0].length}}return-1}function v(e,t,a){var i=e.indexOf("?>",t);if(i){var n=e.substring(t,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(n){n[0].length;a.processingInstruction(n[1],n[2]);return i+2}else{return-1}}return-1}function k(){}k.prototype={setTagName:function(e){if(!Ya.test(e)){throw new Error("invalid tagName:"+e)}this.tagName=e},add:function(e,t,a){if(!Ya.test(e)){throw new Error("invalid attribute:"+e)}this[this.length++]={qName:e,value:t,offset:a}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};function I(e,t){e.__proto__=t;return e}if(!(I({},I.prototype)instanceof I)){I=function(e,t){function a(){}a.prototype=t;a=new a;for(t in e){a[t]=e[t]}return a}}function E(e,t){var a,i=[],n=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;n.lastIndex=t;n.exec(e);while(a=n.exec(e)){i.push(a);if(a[1])return i}}var ai={XMLReader:c};function L(e,t){for(var a in e){t[a]=e[a]}}function C(e,a){var i=e.prototype;if(Object.create){var n=Object.create(a.prototype);i.__proto__=n}if(!(i instanceof a)){var r=function(){};r.prototype=a.prototype;r=new r;L(i,r);e.prototype=i=r}if(i.constructor!=e){if("function"!=typeof e){console.error("unknow Class:"+e)}i.constructor=e}}var ii={},ni=ii.ELEMENT_NODE=1,ri=ii.ATTRIBUTE_NODE=2,si=ii.TEXT_NODE=3,di=ii.CDATA_SECTION_NODE=4,oi=ii.ENTITY_REFERENCE_NODE=5,li=ii.ENTITY_NODE=6,ui=ii.PROCESSING_INSTRUCTION_NODE=7,pi=ii.COMMENT_NODE=8,mi=ii.DOCUMENT_NODE=9,ci=ii.DOCUMENT_TYPE_NODE=10,gi=ii.DOCUMENT_FRAGMENT_NODE=11,yi=ii.NOTATION_NODE=12,fi={},_i={},hi=fi.INDEX_SIZE_ERR=(_i[1]="Index size error",1),bi=fi.DOMSTRING_SIZE_ERR=(_i[2]="DOMString size error",2),Ti=fi.HIERARCHY_REQUEST_ERR=(_i[3]="Hierarchy request error",3),Si=fi.WRONG_DOCUMENT_ERR=(_i[4]="Wrong document",4),vi=fi.INVALID_CHARACTER_ERR=(_i[5]="Invalid character",5),ki=fi.NO_DATA_ALLOWED_ERR=(_i[6]="No data allowed",6),Ii=fi.NO_MODIFICATION_ALLOWED_ERR=(_i[7]="No modification allowed",7),Ei=fi.NOT_FOUND_ERR=(_i[8]="Not found",8),Li=fi.NOT_SUPPORTED_ERR=(_i[9]="Not supported",9),Ci=fi.INUSE_ATTRIBUTE_ERR=(_i[10]="Attribute in use",10),Di=fi.INVALID_STATE_ERR=(_i[11]="Invalid state",11),Pi=fi.SYNTAX_ERR=(_i[12]="Syntax error",12),Oi=fi.INVALID_MODIFICATION_ERR=(_i[13]="Invalid modification",13),xi=fi.NAMESPACE_ERR=(_i[14]="Invalid namespace",14),Ui=fi.INVALID_ACCESS_ERR=(_i[15]="Invalid access",15);function D(e,t){if(t instanceof Error){var a=t}else{a=this;Error.call(this,_i[e]);this.message=_i[e];if(Error.captureStackTrace)Error.captureStackTrace(this,D)}a.code=e;if(t)this.message=this.message+": "+t;return a}D.prototype=Error.prototype;L(fi,D);function P(){}P.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var a=[],n=0;n<this.length;n++){oe(this[n],a,e,t)}return a.join("")}};function O(e,t){this._node=e;this._refresh=t;x(this)}function x(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var a=e._refresh(e._node);pe(e,"length",a.length);L(a,e);e._inc=t}}O.prototype.item=function(e){x(this);return this[e]};C(O,P);function U(){}function R(e,t){var a=e.length;while(a--){if(e[a]===t){return a}}}function A(e,t,a,i){if(i){t[R(t,i)]=a}else{t[t.length++]=a}if(e){a.ownerElement=e;var n=e.ownerDocument;if(n){i&&G(n,e,i);H(n,e,a)}}}function N(e,t,a){var n=R(t,a);if(0<=n){var r=t.length-1;while(n<r){t[n]=t[++n]}t.length=r;if(e){var s=e.ownerDocument;if(s){G(s,e,a);a.ownerElement=null}}}else{throw D(Ei,new Error(e.tagName+"@"+a))}}U.prototype={length:0,item:P.prototype.item,getNamedItem:function(e){var t=this.length;while(t--){var a=this[t];if(a.nodeName==e){return a}}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement){throw new D(Ci)}var a=this.getNamedItem(e.nodeName);A(this._ownerElement,this,e,a);return a},setNamedItemNS:function(e){var t=e.ownerElement,a;if(t&&t!=this._ownerElement){throw new D(Ci)}a=this.getNamedItemNS(e.namespaceURI,e.localName);A(this._ownerElement,this,e,a);return a},removeNamedItem:function(e){var t=this.getNamedItem(e);N(this._ownerElement,this,t);return t},removeNamedItemNS:function(e,t){var a=this.getNamedItemNS(e,t);N(this._ownerElement,this,a);return a},getNamedItemNS:function(e,t){var a=this.length;while(a--){var n=this[a];if(n.localName==t&&n.namespaceURI==e){return n}}return null}};function w(e){this._features={};if(e){for(var t in e){this._features=e[t]}}}w.prototype={hasFeature:function(e,t){var a=this._features[e.toLowerCase()];if(a&&(!t||t in a)){return!0}else{return!1}},createDocument:function(e,t,a){var i=new F;i.implementation=this;i.childNodes=new P;i.doctype=a;if(a){i.appendChild(a)}if(t){var n=i.createElementNS(e,t);i.appendChild(n)}return i},createDocumentType:function(e,t,a){var i=new J;i.name=e;i.nodeName=e;i.publicId=t;i.systemId=a;return i}};function B(){}B.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return z(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t);if(t){this.removeChild(t)}},removeChild:function(e){return W(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return ue(this.ownerDocument||this,this,e)},normalize:function(){var e=this.firstChild;while(e){var t=e.nextSibling;if(t&&t.nodeType==si&&e.nodeType==si){this.removeChild(t);e.appendData(t.data)}else{e.normalize();e=t}}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(e){var t=this;while(t){var a=t._nsMap;if(a){for(var i in a){if(a[i]==e){return i}}}t=t.nodeType==ri?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){var t=this;while(t){var a=t._nsMap;if(a){if(e in a){return a[e]}}t=t.nodeType==ri?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){var t=this.lookupPrefix(e);return null==t}};function M(e){return"<"==e&&"&lt;"||">"==e&&"&gt;"||"&"==e&&"&amp;"||"\""==e&&"&quot;"||"&#"+e.charCodeAt()+";"}L(ii,B);L(ii,B.prototype);function q(e,t){if(t(e)){return!0}if(e=e.firstChild){do{if(q(e,t)){return!0}}while(e=e.nextSibling)}}function F(){}function H(e,t,a){e&&e._inc++;var i=a.namespaceURI;if("http://www.w3.org/2000/xmlns/"==i){t._nsMap[a.prefix?a.localName:""]=a.value}}function G(e,t,a){e&&e._inc++;var i=a.namespaceURI;if("http://www.w3.org/2000/xmlns/"==i){delete t._nsMap[a.prefix?a.localName:""]}}function V(e,t,a){if(e&&e._inc){e._inc++;var n=t.childNodes;if(a){n[n.length++]=a}else{var r=t.firstChild,s=0;while(r){n[s++]=r;r=r.nextSibling}n.length=s}}}function W(e,t){var a=t.previousSibling,i=t.nextSibling;if(a){a.nextSibling=i}else{e.firstChild=i}if(i){i.previousSibling=a}else{e.lastChild=a}V(e.ownerDocument,e);return t}function z(e,t,a){var i=t.parentNode;if(i){i.removeChild(t)}if(t.nodeType===gi){var n=t.firstChild;if(null==n){return t}var r=t.lastChild}else{n=r=t}var s=a?a.previousSibling:e.lastChild;n.previousSibling=s;r.nextSibling=a;if(s){s.nextSibling=n}else{e.firstChild=n}if(null==a){e.lastChild=r}else{a.previousSibling=r}do{n.parentNode=e}while(n!==r&&(n=n.nextSibling));V(e.ownerDocument||e,e);if(t.nodeType==gi){t.firstChild=t.lastChild=null}return t}function j(e,t){var a=t.parentNode;if(a){var i=e.lastChild;a.removeChild(t);var i=e.lastChild}var i=e.lastChild;t.parentNode=e;t.previousSibling=i;t.nextSibling=null;if(i){i.nextSibling=t}else{e.firstChild=t}e.lastChild=t;V(e.ownerDocument,e,t);return t}F.prototype={nodeName:"#document",nodeType:mi,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==gi){var a=e.firstChild;while(a){var i=a.nextSibling;this.insertBefore(a,t);a=i}return e}if(null==this.documentElement&&e.nodeType==ni){this.documentElement=e}return z(this,e,t),e.ownerDocument=this,e},removeChild:function(e){if(this.documentElement==e){this.documentElement=null}return W(this,e)},importNode:function(e,t){return le(this,e,t)},getElementById:function(e){var t=null;q(this.documentElement,function(a){if(a.nodeType==ni){if(a.getAttribute("id")==e){t=a;return!0}}});return t},createElement:function(e){var t=new Y;t.ownerDocument=this;t.nodeName=e;t.tagName=e;t.childNodes=new P;var a=t.attributes=new U;a._ownerElement=t;return t},createDocumentFragment:function(){var e=new ie;e.ownerDocument=this;e.childNodes=new P;return e},createTextNode:function(e){var t=new Q;t.ownerDocument=this;t.appendData(e);return t},createComment:function(e){var t=new $;t.ownerDocument=this;t.appendData(e);return t},createCDATASection:function(e){var t=new Z;t.ownerDocument=this;t.appendData(e);return t},createProcessingInstruction:function(e,t){var a=new ne;a.ownerDocument=this;a.tagName=a.target=e;a.nodeValue=a.data=t;return a},createAttribute:function(e){var t=new X;t.ownerDocument=this;t.name=e;t.nodeName=e;t.localName=e;t.specified=!0;return t},createEntityReference:function(e){var t=new ae;t.ownerDocument=this;t.nodeName=e;return t},createElementNS:function(e,t){var a=new Y,i=t.split(":"),n=a.attributes=new U;a.childNodes=new P;a.ownerDocument=this;a.nodeName=t;a.tagName=t;a.namespaceURI=e;if(2==i.length){a.prefix=i[0];a.localName=i[1]}else{a.localName=t}n._ownerElement=a;return a},createAttributeNS:function(e,t){var a=new X,i=t.split(":");a.ownerDocument=this;a.nodeName=t;a.name=t;a.namespaceURI=e;a.specified=!0;if(2==i.length){a.prefix=i[0];a.localName=i[1]}else{a.localName=t}return a}};C(F,B);function Y(){this._nsMap={}}Y.prototype={nodeType:ni,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var a=this.ownerDocument.createAttribute(e);a.value=a.nodeValue=""+t;this.setAttributeNode(a)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){if(e.nodeType===gi){return this.insertBefore(e,null)}else{return j(this,e)}},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var a=this.getAttributeNodeNS(e,t);a&&this.removeAttributeNode(a)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var a=this.getAttributeNodeNS(e,t);return a&&a.value||""},setAttributeNS:function(e,t,a){var i=this.ownerDocument.createAttributeNS(e,t);i.value=i.nodeValue=""+a;this.setAttributeNode(i)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new O(this,function(t){var a=[];q(t,function(i){if(i!==t&&i.nodeType==ni&&("*"===e||i.tagName==e)){a.push(i)}});return a})},getElementsByTagNameNS:function(e,t){return new O(this,function(a){var i=[];q(a,function(n){if(n!==a&&n.nodeType===ni&&("*"===e||n.namespaceURI===e)&&("*"===t||n.localName==t)){i.push(n)}});return i})}};F.prototype.getElementsByTagName=Y.prototype.getElementsByTagName;F.prototype.getElementsByTagNameNS=Y.prototype.getElementsByTagNameNS;C(Y,B);function X(){}X.prototype.nodeType=ri;C(X,B);function K(){}K.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e;this.nodeValue=this.data=e;this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(){throw new Error(_i[Ti])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,a){var i=this.data.substring(0,e),n=this.data.substring(e+t);a=i+a+n;this.nodeValue=this.data=a;this.length=a.length}};C(K,B);function Q(){}Q.prototype={nodeName:"#text",nodeType:si,splitText:function(e){var t=this.data,a=t.substring(e);t=t.substring(0,e);this.data=this.nodeValue=t;this.length=t.length;var i=this.ownerDocument.createTextNode(a);if(this.parentNode){this.parentNode.insertBefore(i,this.nextSibling)}return i}};C(Q,K);function $(){}$.prototype={nodeName:"#comment",nodeType:pi};C($,K);function Z(){}Z.prototype={nodeName:"#cdata-section",nodeType:di};C(Z,K);function J(){}J.prototype.nodeType=ci;C(J,B);function ee(){}ee.prototype.nodeType=yi;C(ee,B);function te(){}te.prototype.nodeType=li;C(te,B);function ae(){}ae.prototype.nodeType=oi;C(ae,B);function ie(){}ie.prototype.nodeName="#document-fragment";ie.prototype.nodeType=gi;C(ie,B);function ne(){}ne.prototype.nodeType=ui;C(ne,B);function re(){}re.prototype.serializeToString=function(e,t,a){return se.call(e,t,a)};B.prototype.toString=se;function se(e,t){var a=[],i=9==this.nodeType?this.documentElement:this,n=i.prefix,r=i.namespaceURI;if(r&&null==n){var n=i.lookupPrefix(r);if(null==n){var s=[{namespace:r,prefix:null}]}}oe(this,a,e,t,s);return a.join("")}function de(e,t,a){var n=e.prefix||"",r=e.namespaceURI;if(!n&&!r){return!1}if("xml"===n&&"http://www.w3.org/XML/1998/namespace"===r||"http://www.w3.org/2000/xmlns/"==r){return!1}var s=a.length;while(s--){var d=a[s];if(d.prefix==n){return d.namespace!=r}}return!0}function oe(e,t,a,n,r){if(n){e=n(e);if(e){if("string"==typeof e){t.push(e);return}}else{return}}switch(e.nodeType){case ni:if(!r)r=[];var s=r.length,d=e.attributes,o=d.length,l=e.firstChild,u=e.tagName;a="http://www.w3.org/1999/xhtml"===e.namespaceURI||a;t.push("<",u);for(var p=0,m;p<o;p++){m=d.item(p);if("xmlns"==m.prefix){r.push({prefix:m.localName,namespace:m.value})}else if("xmlns"==m.nodeName){r.push({prefix:"",namespace:m.value})}}for(var p=0,m;p<o;p++){m=d.item(p);if(de(m,a,r)){var c=m.prefix||"",g=m.namespaceURI,y=c?" xmlns:"+c:" xmlns";t.push(y,"=\"",g,"\"");r.push({prefix:c,namespace:g})}oe(m,t,a,n,r)}if(de(e,a,r)){var c=e.prefix||"",g=e.namespaceURI,y=c?" xmlns:"+c:" xmlns";t.push(y,"=\"",g,"\"");r.push({prefix:c,namespace:g})}if(l||a&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){t.push(">");if(a&&/^script$/i.test(u)){while(l){if(l.data){t.push(l.data)}else{oe(l,t,a,n,r)}l=l.nextSibling}}else{while(l){oe(l,t,a,n,r);l=l.nextSibling}}t.push("</",u,">")}else{t.push("/>")}return;case mi:case gi:var l=e.firstChild;while(l){oe(l,t,a,n,r);l=l.nextSibling}return;case ri:return t.push(" ",e.name,"=\"",e.value.replace(/[<&"]/g,M),"\"");case si:return t.push(e.data.replace(/[<&]/g,M));case di:return t.push("<![CDATA[",e.data,"]]>");case pi:return t.push("<!--",e.data,"-->");case ci:var f=e.publicId,_=e.systemId;t.push("<!DOCTYPE ",e.name);if(f){t.push(" PUBLIC \"",f);if(_&&"."!=_){t.push("\" \"",_)}t.push("\">")}else if(_&&"."!=_){t.push(" SYSTEM \"",_,"\">")}else{var h=e.internalSubset;if(h){t.push(" [",h,"]")}t.push(">")}return;case ui:return t.push("<?",e.target," ",e.data,"?>");case oi:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName);}}function le(e,t,a){var i;switch(t.nodeType){case ni:i=t.cloneNode(!1);i.ownerDocument=e;case gi:break;case ri:a=!0;break;}if(!i){i=t.cloneNode(!1)}i.ownerDocument=e;i.parentNode=null;if(a){var n=t.firstChild;while(n){i.appendChild(le(e,n,a));n=n.nextSibling}}return i}function ue(e,t,a){var r=new t.constructor;for(var s in t){var n=t[s];if("object"!=_typeof(n)){if(n!=r[s]){r[s]=n}}}if(t.childNodes){r.childNodes=new P}r.ownerDocument=e;switch(r.nodeType){case ni:var d=t.attributes,o=r.attributes=new U,l=d.length;o._ownerElement=r;for(var u=0;u<l;u++){r.setAttributeNode(ue(e,d.item(u),!0))}break;case ri:a=!0;}if(a){var p=t.firstChild;while(p){r.appendChild(ue(e,p,a));p=p.nextSibling}}return r}function pe(e,t,a){e[t]=a}try{if(Object.defineProperty){var Ri=function e(t){switch(t.nodeType){case ni:case gi:var a=[];t=t.firstChild;while(t){if(7!==t.nodeType&&8!==t.nodeType){a.push(e(t))}t=t.nextSibling}return a.join("");default:return t.nodeValue;}};Object.defineProperty(O.prototype,"length",{get:function(){x(this);return this.$$length}});Object.defineProperty(B.prototype,"textContent",{get:function(){return Ri(this)},set:function(e){switch(this.nodeType){case ni:case gi:while(this.firstChild){this.removeChild(this.firstChild)}if(e||e+""){this.appendChild(this.ownerDocument.createTextNode(e))}break;default:this.data=e;this.value=e;this.nodeValue=e;}}});pe=function(e,t,a){e["$$"+t]=a}}}catch(t){}var Ai={DOMImplementation:w,XMLSerializer:re},Ni=a(function(e,t){function a(e){this.options=e||{locator:{}}}a.prototype.parseFromString=function(e,t){var a=this.options,r=new l,s=a.domBuilder||new n,d=a.errorHandler,o=a.locator,u=a.xmlns||{},p={lt:"<",gt:">",amp:"&",quot:"\"",apos:"'"};if(o){s.setDocumentLocator(o)}r.errorHandler=i(d,s,o);r.domBuilder=a.domBuilder||s;if(/\/x?html?$/.test(t)){p.nbsp="\xA0";p.copy="\xA9";u[""]="http://www.w3.org/1999/xhtml"}u.xml=u.xml||"http://www.w3.org/XML/1998/namespace";if(e){r.parse(e,u,p)}else{r.errorHandler.error("invalid doc source")}return s.doc};function i(e,t,a){if(!e){if(t instanceof n){return t}e=t}var r={},d=e instanceof Function;a=a||{};function i(t){var i=e[t];if(!i&&d){i=2==e.length?function(a){e(t,a)}:e}r[t]=i&&function(e){i("[xmldom "+t+"]\t"+e+s(a))}||function(){}}i("warning");i("error");i("fatalError");return r}function n(){this.cdata=!1}function r(e,t){t.lineNumber=e.lineNumber;t.columnNumber=e.columnNumber}n.prototype={startDocument:function(){this.doc=new u().createDocument(null,null,null);if(this.locator){this.doc.documentURI=this.locator.systemId}},startElement:function(e,t,a,n){var s=this.doc,d=s.createElementNS(e,a||t),l=n.length;o(this,d);this.currentElement=d;this.locator&&r(this.locator,d);for(var u=0;u<l;u++){var e=n.getURI(u),p=n.getValue(u),a=n.getQName(u),m=s.createAttributeNS(e,a);this.locator&&r(n.getLocator(u),m);m.value=m.nodeValue=p;d.setAttributeNode(m)}},endElement:function(){var e=this.currentElement,t=e.tagName;this.currentElement=e.parentNode},startPrefixMapping:function(){},endPrefixMapping:function(){},processingInstruction:function(e,t){var a=this.doc.createProcessingInstruction(e,t);this.locator&&r(this.locator,a);o(this,a)},ignorableWhitespace:function(){},characters:function(e){e=d.apply(this,arguments);if(e){if(this.cdata){var t=this.doc.createCDATASection(e)}else{var t=this.doc.createTextNode(e)}if(this.currentElement){this.currentElement.appendChild(t)}else if(/^\s*$/.test(e)){this.doc.appendChild(t)}this.locator&&r(this.locator,t)}},skippedEntity:function(){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){if(this.locator=e){e.lineNumber=0}},comment:function(e){e=d.apply(this,arguments);var t=this.doc.createComment(e);this.locator&&r(this.locator,t);o(this,t)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,a){var i=this.doc.implementation;if(i&&i.createDocumentType){var n=i.createDocumentType(e,t,a);this.locator&&r(this.locator,n);o(this,n)}},warning:function(e){console.warn("[xmldom warning]\t"+e,s(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,s(this.locator))},fatalError:function(e){console.error("[xmldom fatalError]\t"+e,s(this.locator));throw e}};function s(e){if(e){return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}}function d(e,t,a){if("string"==typeof e){return e.substr(t,a)}else{if(e.length>=t+a||t){return new java.lang.String(e,t,a)+""}return e}}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){n.prototype[e]=function(){return null}});function o(e,t){if(!e.currentElement){e.doc.appendChild(t)}else{e.currentElement.appendChild(t)}}var l=ai.XMLReader,u=t.DOMImplementation=Ai.DOMImplementation;t.XMLSerializer=Ai.XMLSerializer;t.DOMParser=a}),wi=Ni.DOMImplementation,Bi=Ni.XMLSerializer,Mi=Ni.DOMParser,qi=function(e){return!!e&&"object"===_typeof(e)},Fi=function e(){for(var t=arguments.length,a=Array(t),i=0;i<t;i++){a[i]=arguments[i]}return a.reduce(function(t,a){Object.keys(a).forEach(function(i){if(Array.isArray(t[i])&&Array.isArray(a[i])){t[i]=t[i].concat(a[i])}else if(qi(t[i])&&qi(a[i])){t[i]=e(t[i],a[i])}else{t[i]=a[i]}});return t},{})},Hi=function(e){return Object.keys(e).map(function(t){return e[t]})},Gi=function(e,t){for(var a=[],n=e;n<t;n++){a.push(n)}return a},Vi=function(e){return e.reduce(function(e,t){return e.concat(t)},[])},Wi=function(e){if(!e.length){return[]}for(var t=[],a=0;a<e.length;a++){t.push(e[a])}return t},zi=function(e,t){return e.reduce(function(n,a,e){if(a[t]){n.push(e)}return n},[])},ji={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"},Yi=function(e){var t=e.baseUrl,a=void 0===t?"":t,i=e.source,n=void 0===i?"":i,r=e.range,s=void 0===r?"":r,d=e.indexRange,o=void 0===d?"":d,l={uri:n,resolvedUri:Ha(a||"",n)};if(s||o){var u=s?s:o,p=u.split("-"),m=parseInt(p[0],10),c=parseInt(p[1],10);l.byterange={length:c-m+1,offset:m}}return l},Xi=function(e){var t=e.offset+e.length-1;return e.offset+"-"+t},Ki={static:function(e){var t=e.duration,a=e.timescale,i=void 0===a?1:a,n=e.sourceDuration;return{start:0,end:Math.ceil(n/(t/i))}},dynamic:function(e){var t=e.NOW,a=e.clientOffset,i=e.availabilityStartTime,n=e.timescale,r=void 0===n?1:n,s=e.duration,d=e.start,o=void 0===d?0:d,l=e.minimumUpdatePeriod,u=void 0===l?0:l,p=e.timeShiftBufferDepth,m=void 0===p?1/0:p,c=(t+a)/1e3,g=i+o,y=Math.ceil((c+u-g)*r/s),f=Math.floor((c-g-m)*r/s),_=Math.floor((c-g)*r/s);return{start:Math.max(0,f),end:Math.min(y,_)}}},Qi=function(e){return function(t,a){var i=e.duration,n=e.timescale,r=void 0===n?1:n,s=e.periodIndex,d=e.startNumber,o=void 0===d?1:d;return{number:o+t,duration:i/r,timeline:s,time:a*i}}},$i=function(e){var t=e.type,a=void 0===t?"static":t,i=e.duration,n=e.timescale,r=void 0===n?1:n,s=e.sourceDuration,d=Ki[a](e),o=d.start,l=d.end,u=Gi(o,l).map(Qi(e));if("static"===a){var p=u.length-1;u[p].duration=s-i/r*p}return u},Zi=function(e){var t=e.baseUrl,a=e.initialization,i=void 0===a?{}:a,n=e.sourceDuration,r=e.timescale,s=void 0===r?1:r,d=e.indexRange,o=void 0===d?"":d,l=e.duration;if(!t){throw new Error(ji.NO_BASE_URL)}var u=Yi({baseUrl:t,source:i.sourceURL,range:i.range}),p=Yi({baseUrl:t,source:t,indexRange:o});p.map=u;if(l){var m=$i(e);if(m.length){p.duration=m[0].duration;p.timeline=m[0].timeline}}else if(n){p.duration=n/s;p.timeline=0}p.number=0;return[p]},Ji=function(e,t,a){for(var n=e.sidx.map?e.sidx.map:null,r=e.sidx.duration,s=e.timeline||0,d=e.sidx.byterange,o=d.offset+d.length,l=t.timescale,u=t.references.filter(function(e){return 1!==e.referenceType}),p=[],m=o+t.firstOffset,c=0;c<u.length;c++){var g=t.references[c],y=g.referencedSize,f=g.subsegmentDuration,_=m+y-1,h=m+"-"+_,b=Zi({baseUrl:a,timescale:l,timeline:s,periodIndex:s,duration:f,sourceDuration:r,indexRange:h})[0];if(n){b.map=n}p.push(b);m+=y}e.segments=p;return e},en=function(e){var t=Hi(e.reduce(function(e,t){var a=t.attributes.id+(t.attributes.lang||"");if(e[a]){var i;if(t.segments[0]){t.segments[0].discontinuity=!0}(i=e[a].segments).push.apply(i,t.segments);if(t.attributes.contentProtection){e[a].attributes.contentProtection=t.attributes.contentProtection}}else{e[a]=t}return e},{}));return t.map(function(e){e.discontinuityStarts=zi(e.segments,"discontinuity");return e})},tn=function(e,t){if(void 0===t){t={}}if(!Object.keys(t).length){return e}for(var a in e){var i=e[a];if(!i.sidx){continue}var n=i.sidx.uri+"-"+Xi(i.sidx.byterange),r=t[n]&&t[n].sidx;if(i.sidx&&r){Ji(i,r,i.sidx.resolvedUri)}}return e},an=function(e){var t,a=e.attributes,i=e.segments,n=e.sidx,r={attributes:(t={NAME:a.id,BANDWIDTH:a.bandwidth,CODECS:a.codecs},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(a.type||"static"),timeline:a.periodIndex,resolvedUri:"",targetDuration:a.duration,segments:i,mediaSequence:i.length?i[0].number:1};if(a.contentProtection){r.contentProtection=a.contentProtection}if(n){r.sidx=n}return r},nn=function(e){var t,a=e.attributes,i=e.segments;if("undefined"==typeof i){i=[{uri:a.baseUrl,timeline:a.periodIndex,resolvedUri:a.baseUrl||"",duration:a.sourceDuration,number:0}];a.duration=a.sourceDuration}return{attributes:(t={NAME:a.id,BANDWIDTH:a.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(a.type||"static"),timeline:a.periodIndex,resolvedUri:a.baseUrl||"",targetDuration:a.duration,segments:i,mediaSequence:i.length?i[0].number:1}},rn=function(e,t){if(void 0===t){t={}}var i,n=e.reduce(function(e,a){var n=a.attributes.role&&a.attributes.role.value||"",r=a.attributes.lang||"",s="main";if(r){var d=n?" ("+n+")":"";s=""+a.attributes.lang+d}if(e[s]&&e[s].playlists[0].attributes.BANDWIDTH>a.attributes.bandwidth){return e}e[s]={language:r,autoselect:!0,default:"main"===n,playlists:tn([an(a)],t),uri:""};if("undefined"==typeof i&&"main"===n){i=a;i.default=!0}return e},{});if(!i){var r=Object.keys(n)[0];n[r].default=!0}return n},sn=function(e,t){if(void 0===t){t={}}return e.reduce(function(e,a){var i=a.attributes.lang||"text";if(e[i]){return e}e[i]={language:i,default:!1,autoselect:!1,playlists:tn([nn(a)],t),uri:""};return e},{})},dn=function(e){var t,a=e.attributes,i=e.segments,n=e.sidx,r={attributes:(t={NAME:a.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:a.width,height:a.height},CODECS:a.codecs,BANDWIDTH:a.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(a.type||"static"),timeline:a.periodIndex,resolvedUri:"",targetDuration:a.duration,segments:i,mediaSequence:i.length?i[0].number:1};if(a.contentProtection){r.contentProtection=a.contentProtection}if(n){r.sidx=n}return r},on=function(e,t){var a;if(void 0===t){t={}}if(!e.length){return{}}var i=e[0].attributes,n=i.sourceDuration,r=i.type,s=void 0===r?"static":r,d=i.suggestedPresentationDelay,o=i.minimumUpdatePeriod,l=void 0===o?0:o,u=en(e.filter(function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType})).map(dn),p=en(e.filter(function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType})),m=e.filter(function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType}),c={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(a={AUDIO:{},VIDEO:{}},a["CLOSED-CAPTIONS"]={},a.SUBTITLES={},a),uri:"",duration:n,playlists:tn(u,t),minimumUpdatePeriod:1e3*l};if("dynamic"===s){c.suggestedPresentationDelay=d}if(p.length){c.mediaGroups.AUDIO.audio=rn(p,t)}if(m.length){c.mediaGroups.SUBTITLES.subs=sn(m,t)}return c},ln=function(e,t,a){var i=e.NOW,n=e.clientOffset,r=e.availabilityStartTime,s=e.timescale,d=void 0===s?1:s,o=e.start,l=void 0===o?0:o,u=e.minimumUpdatePeriod,p=void 0===u?0:u;return Math.ceil((((i+n)/1e3+p-(r+l))*d-t)/a)},un=function(e,t){for(var a=e.type,i=void 0===a?"static":a,n=e.minimumUpdatePeriod,r=void 0===n?0:n,s=e.media,d=void 0===s?"":s,o=e.sourceDuration,l=e.timescale,u=void 0===l?1:l,p=e.startNumber,m=void 0===p?1:p,c=e.periodIndex,g=[],y=-1,f=0;f<t.length;f++){var _=t[f],h=_.d,b=_.r||0,T=_.t||0;if(0>y){y=T}if(T&&T>y){y=T}var S=void 0;if(0>b){var v=f+1;if(v===t.length){if("dynamic"===i&&0<r&&0<d.indexOf("$Number$")){S=ln(e,y,h)}else{S=(o*u-y)/h}}else{S=(t[v].t-y)/h}}else{S=b+1}var k=m+g.length+S,I=m+g.length;while(I<k){g.push({number:I,duration:h/u,time:y,timeline:c});y+=h;I++}}return g},pn=function(e){return function(t,a,i,n){if("$$"===t){return"$"}if("undefined"==typeof e[a]){return t}var r=""+e[a];if("RepresentationID"===a){return r}if(!i){n=1}else{n=parseInt(n,10)}if(r.length>=n){return r}return""+Array(n-r.length+1).join("0")+r}},mn=function(e,t){return e.replace(/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,pn(t))},cn=function(e,t){if(!e.duration&&!t){return[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]}if(e.duration){return $i(e)}return un(e,t)},gn=function(e,t){var a={RepresentationID:e.id,Bandwidth:e.bandwidth||0},i=e.initialization,n=void 0===i?{sourceURL:"",range:""}:i,r=Yi({baseUrl:e.baseUrl,source:mn(n.sourceURL,a),range:n.range}),s=cn(e,t);return s.map(function(t){a.Number=t.number;a.Time=t.time;var i=mn(e.media||"",a);return{uri:i,timeline:t.timeline,duration:t.duration,resolvedUri:Ha(e.baseUrl||"",i),map:r,number:t.number}})},yn=function(e,t){var a=e.baseUrl,i=e.initialization,n=void 0===i?{}:i,r=Yi({baseUrl:a,source:n.sourceURL,range:n.range}),s=Yi({baseUrl:a,source:t.media,range:t.mediaRange});s.map=r;return s},fn=function(e,t){var a=e.duration,i=e.segmentUrls,n=void 0===i?[]:i;if(!a&&!t||a&&t){throw new Error(ji.SEGMENT_TIME_UNSPECIFIED)}var r=n.map(function(t){return yn(e,t)}),s;if(a){s=$i(e)}if(t){s=un(e,t)}var d=s.map(function(e,t){if(r[t]){var a=r[t];a.timeline=e.timeline;a.duration=e.duration;a.number=e.number;return a}}).filter(function(e){return e});return d},_n=function(e){var t=e.attributes,a=e.segmentInfo,i,n;if(a.template){n=gn;i=Fi(t,a.template)}else if(a.base){n=Zi;i=Fi(t,a.base)}else if(a.list){n=fn;i=Fi(t,a.list)}var r={attributes:t};if(!n){return r}var s=n(i,a.timeline);if(i.duration){var d=i,o=d.duration,l=d.timescale,u=void 0===l?1:l;i.duration=o/u}else if(s.length){i.duration=s.reduce(function(e,t){return Math.max(e,Math.ceil(t.duration))},0)}else{i.duration=0}r.attributes=i;r.segments=s;if(a.base&&i.indexRange){r.sidx=s[0];r.segments=[]}return r},hn=function(e){return e.map(_n)},bn=function(e,t){return Wi(e.childNodes).filter(function(e){var a=e.tagName;return a===t})},Tn=function(e){return e.textContent.trim()},Sn=function(e){var t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!t){return 0}var a=t.slice(1),i=a[0],n=a[1],r=a[2],s=a[3],d=a[4],o=a[5];return parseFloat(i||0)*31536000+parseFloat(n||0)*2592000+parseFloat(r||0)*86400+parseFloat(s||0)*3600+parseFloat(d||0)*60+parseFloat(o||0)},vn=function(e){if(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)){e+="Z"}return Date.parse(e)},kn={mediaPresentationDuration:function(e){return Sn(e)},availabilityStartTime:function(e){return vn(e)/1e3},minimumUpdatePeriod:function(e){return Sn(e)},suggestedPresentationDelay:function(e){return Sn(e)},type:function(e){return e},timeShiftBufferDepth:function(e){return Sn(e)},start:function(e){return Sn(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);if(isNaN(t)){return Sn(e)}return t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},In=function(e){if(!(e&&e.attributes)){return{}}return Wi(e.attributes).reduce(function(t,a){var e=kn[a.name]||kn.DEFAULT;t[a.name]=e(a.value);return t},{})},En={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},Ln=function(e,t){if(!t.length){return e}return Vi(e.map(function(e){return t.map(function(t){return Ha(e,Tn(t))})}))},Cn=function(e){var t=bn(e,"SegmentTemplate")[0],a=bn(e,"SegmentList")[0],i=a&&bn(a,"SegmentURL").map(function(e){return Fi({tag:"SegmentURL"},In(e))}),n=bn(e,"SegmentBase")[0],r=a||t,s=r&&bn(r,"SegmentTimeline")[0],d=a||n||t,o=d&&bn(d,"Initialization")[0],l=t&&In(t);if(l&&o){l.initialization=o&&In(o)}else if(l&&l.initialization){l.initialization={sourceURL:l.initialization}}var u={template:l,timeline:s&&bn(s,"S").map(function(e){return In(e)}),list:a&&Fi(In(a),{segmentUrls:i,initialization:In(o)}),base:n&&Fi(In(n),{initialization:In(o)})};Object.keys(u).forEach(function(e){if(!u[e]){delete u[e]}});return u},Dn=function(e,t,a){return function(i){var n=bn(i,"BaseURL"),r=Ln(t,n),s=Fi(e,In(i)),d=Cn(i);return r.map(function(e){return{segmentInfo:Fi(a,d),attributes:Fi(s,{baseUrl:e})}})}},Pn=function(e){return e.reduce(function(e,t){var a=In(t),i=En[a.schemeIdUri];if(i){e[i]={attributes:a};var n=bn(t,"cenc:pssh")[0];if(n){var r=Tn(n),s=r&&Wa(r);e[i].pssh=s}}return e},{})},On=function(e,t,a){return function(i){var n=In(i),r=Ln(t,bn(i,"BaseURL")),s=bn(i,"Role")[0],d={role:In(s)},o=Fi(e,n,d),l=Pn(bn(i,"ContentProtection"));if(Object.keys(l).length){o=Fi(o,{contentProtection:l})}var u=Cn(i),p=bn(i,"Representation"),m=Fi(a,u);return Vi(p.map(Dn(o,r,m)))}},xn=function(e,t){return function(a,i){var n=Ln(t,bn(a,"BaseURL")),r=In(a),s=parseInt(r.id,10),d=be.isNaN(s)?i:s,o=Fi(e,{periodIndex:d}),l=bn(a,"AdaptationSet"),u=Cn(a);return Vi(l.map(On(o,n,u)))}},Un=function(e,t){if(void 0===t){t={}}var a=t,i=a.manifestUri,n=void 0===i?"":i,r=a.NOW,s=void 0===r?Date.now():r,d=a.clientOffset,o=void 0===d?0:d,l=bn(e,"Period");if(!l.length){throw new Error(ji.INVALID_NUMBER_OF_PERIOD)}var u=In(e),p=Ln([n],bn(e,"BaseURL"));u.sourceDuration=u.mediaPresentationDuration||0;u.NOW=s;u.clientOffset=o;return Vi(l.map(xn(u,p)))},Rn=function(e){if(""===e){throw new Error(ji.DASH_EMPTY_MANIFEST)}var t=new Mi,a=t.parseFromString(e,"application/xml"),i=a&&"MPD"===a.documentElement.tagName?a.documentElement:null;if(!i||i&&0<i.getElementsByTagName("parsererror").length){throw new Error(ji.DASH_INVALID_XML)}return i},An=function(e){var t=bn(e,"UTCTiming")[0];if(!t){return null}var a=In(t);switch(a.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":a.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":a.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":a.method="DIRECT";a.value=Date.parse(a.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(ji.UNSUPPORTED_UTC_TIMING_SCHEME);}return a},Nn=function(e,t){if(void 0===t){t={}}return on(hn(Un(Rn(e),t)),t.sidxMapping)},wn=function(e){return An(Rn(e))},Bn={toUnsigned:function(e){return e>>>0},toHexString:function(e){return("00"+e.toString(16)).slice(-2)}},Mn,qn,Fn=Bn.toUnsigned,Hn=function(e){return new Date(1e3*e-20828448e5)},Gn=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},Vn=function(e){var t="";t+=String.fromCharCode(e[0]);t+=String.fromCharCode(e[1]);t+=String.fromCharCode(e[2]);t+=String.fromCharCode(e[3]);return t},Wn=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=[],n,r;for(n=0;n+4<e.length;n+=r){r=t.getUint32(n);n+=4;if(0>=r){a.push("<span style='color:red;'>MALFORMED DATA</span>");continue}switch(31&e[n]){case 1:a.push("slice_layer_without_partitioning_rbsp");break;case 5:a.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:a.push("sei_rbsp");break;case 7:a.push("seq_parameter_set_rbsp");break;case 8:a.push("pic_parameter_set_rbsp");break;case 9:a.push("access_unit_delimiter_rbsp");break;default:a.push(31&"UNKNOWN NAL - "+e[n]);break;}}return a},zn={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:Mn(e.subarray(78,e.byteLength))}},avcC:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},n=31&e[5],r,s,d,o;d=6;for(o=0;o<n;o++){s=t.getUint16(d);d+=2;a.sps.push(new Uint8Array(e.subarray(d,d+s)));d+=s}r=e[d];d++;for(o=0;o<r;o++){s=t.getUint16(d);d+=2;a.pps.push(new Uint8Array(e.subarray(d,d+s)));d+=s}return a},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:63&e[12]>>>2,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:31&e[26]>>>3,samplingFrequencyIndex:(7&e[26])<<1|1&e[27]>>>7,channelConfiguration:15&e[27]>>>3}}}},ftyp:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={majorBrand:Vn(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},n=8;while(n<e.byteLength){a.compatibleBrands.push(Vn(e.subarray(n,n+4)));n+=4}return a},dinf:function(e){return{boxes:Mn(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:Mn(e.subarray(8))}},hdlr:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:Vn(e.subarray(8,12)),name:""},n=8;for(n=24;n<e.byteLength;n++){if(0===e[n]){n++;break}a.name+=String.fromCharCode(e[n])}a.name=decodeURIComponent(escape(a.name));return a},mdat:function(e){return{byteLength:e.byteLength,nals:Wn(e)}},mdhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=4,n,r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};if(1===r.version){a+=4;r.creationTime=Hn(t.getUint32(a));a+=8;r.modificationTime=Hn(t.getUint32(a));a+=4;r.timescale=t.getUint32(a);a+=8;r.duration=t.getUint32(a)}else{r.creationTime=Hn(t.getUint32(a));a+=4;r.modificationTime=Hn(t.getUint32(a));a+=4;r.timescale=t.getUint32(a);a+=4;r.duration=t.getUint32(a)}a+=4;n=t.getUint16(a);r.language+=String.fromCharCode((n>>10)+96);r.language+=String.fromCharCode(((992&n)>>5)+96);r.language+=String.fromCharCode((31&n)+96);return r},mdia:function(e){return{boxes:Mn(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:Mn(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};if(28<e.byteLength){a.streamDescriptor=Mn(e.subarray(28))[0]}return a},moof:function(e){return{boxes:Mn(e)}},moov:function(e){return{boxes:Mn(e)}},mvex:function(e){return{boxes:Mn(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=4,n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};if(1===n.version){a+=4;n.creationTime=Hn(t.getUint32(a));a+=8;n.modificationTime=Hn(t.getUint32(a));a+=4;n.timescale=t.getUint32(a);a+=8;n.duration=t.getUint32(a)}else{n.creationTime=Hn(t.getUint32(a));a+=4;n.modificationTime=Hn(t.getUint32(a));a+=4;n.timescale=t.getUint32(a);a+=4;n.duration=t.getUint32(a)}a+=4;n.rate=t.getUint16(a)+t.getUint16(a+2)/16;a+=4;n.volume=t.getUint8(a)+t.getUint8(a+1)/8;a+=2;a+=2;a+=8;n.matrix=new Uint32Array(e.subarray(a,a+36));a+=36;a+=24;n.nextTrackId=t.getUint32(a);return n},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},a;for(a=4;a<e.byteLength;a++){t.samples.push({dependsOn:(48&e[a])>>4,isDependedOn:(12&e[a])>>2,hasRedundancy:3&e[a]})}return t},sidx:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8),earliestPresentationTime:t.getUint32(12),firstOffset:t.getUint32(16)},n=t.getUint16(22),r;for(r=24;n;r+=12,n--){a.references.push({referenceType:(128&e[r])>>>7,referencedSize:2147483647&t.getUint32(r),subsegmentDuration:t.getUint32(r+4),startsWithSap:!!(128&e[r+8]),sapType:(112&e[r+8])>>>4,sapDeltaTime:268435455&t.getUint32(r+8)})}return a},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:Mn(e)}},stco:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},n=t.getUint32(4),r;for(r=8;n;r+=4,n--){a.chunkOffsets.push(t.getUint32(r))}return a},stsc:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=t.getUint32(4),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]},r;for(r=8;a;r+=12,a--){n.sampleToChunks.push({firstChunk:t.getUint32(r),samplesPerChunk:t.getUint32(r+4),sampleDescriptionIndex:t.getUint32(r+8)})}return n},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:Mn(e.subarray(8))}},stsz:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:t.getUint32(4),entries:[]},n;for(n=12;n<e.byteLength;n+=4){a.entries.push(t.getUint32(n))}return a},stts:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},n=t.getUint32(4),r;for(r=8;n;r+=8,n--){a.timeToSamples.push({sampleCount:t.getUint32(r),sampleDelta:t.getUint32(r+4)})}return a},styp:function(e){return zn.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:Fn(e[4]<<24|e[5]<<16|e[6]<<8|e[7])};if(1===t.version){t.baseMediaDecodeTime*=Math.pow(2,32);t.baseMediaDecodeTime+=Fn(e[8]<<24|e[9]<<16|e[10]<<8|e[11])}return t},tfhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4)},n=1&a.flags[2],r=2&a.flags[2],s=8&a.flags[2],d=16&a.flags[2],o=32&a.flags[2],l=65536&a.flags[0],u=131072&a.flags[0],p;p=8;if(n){p+=4;a.baseDataOffset=t.getUint32(12);p+=4}if(r){a.sampleDescriptionIndex=t.getUint32(p);p+=4}if(s){a.defaultSampleDuration=t.getUint32(p);p+=4}if(d){a.defaultSampleSize=t.getUint32(p);p+=4}if(o){a.defaultSampleFlags=t.getUint32(p)}if(l){a.durationIsEmpty=!0}if(!n&&u){a.baseDataOffsetIsMoof=!0}return a},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=4,n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};if(1===n.version){a+=4;n.creationTime=Hn(t.getUint32(a));a+=8;n.modificationTime=Hn(t.getUint32(a));a+=4;n.trackId=t.getUint32(a);a+=4;a+=8;n.duration=t.getUint32(a)}else{n.creationTime=Hn(t.getUint32(a));a+=4;n.modificationTime=Hn(t.getUint32(a));a+=4;n.trackId=t.getUint32(a);a+=4;a+=4;n.duration=t.getUint32(a)}a+=4;a+=8;n.layer=t.getUint16(a);a+=2;n.alternateGroup=t.getUint16(a);a+=2;n.volume=t.getUint8(a)+t.getUint8(a+1)/8;a+=2;a+=2;n.matrix=new Uint32Array(e.subarray(a,a+36));a+=36;n.width=t.getUint16(a)+t.getUint16(a+2)/65536;a+=4;n.height=t.getUint16(a)+t.getUint16(a+2)/65536;return n},traf:function(e){return{boxes:Mn(e)}},trak:function(e){return{boxes:Mn(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},a=new DataView(e.buffer,e.byteOffset,e.byteLength),i=1&t.flags[2],n=4&t.flags[2],r=1&t.flags[1],s=2&t.flags[1],d=4&t.flags[1],o=8&t.flags[1],l=a.getUint32(4),u=8,p;if(i){t.dataOffset=a.getInt32(u);u+=4}if(n&&l){p={flags:Gn(e.subarray(u,u+4))};u+=4;if(r){p.duration=a.getUint32(u);u+=4}if(s){p.size=a.getUint32(u);u+=4}if(o){p.compositionTimeOffset=a.getUint32(u);u+=4}t.samples.push(p);l--}while(l--){p={};if(r){p.duration=a.getUint32(u);u+=4}if(s){p.size=a.getUint32(u);u+=4}if(d){p.flags=Gn(e.subarray(u,u+4));u+=4}if(o){p.compositionTimeOffset=a.getUint32(u);u+=4}t.samples.push(p)}return t},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}};Mn=function(e){for(var t=0,a=[],n,r,s,d,o,l=new ArrayBuffer(e.length),u=new Uint8Array(l),p=0;p<e.length;++p){u[p]=e[p]}n=new DataView(l);while(t<e.byteLength){r=n.getUint32(t);s=Vn(e.subarray(t+4,t+8));d=1<r?t+r:e.byteLength;o=(zn[s]||function(e){return{data:e}})(e.subarray(t+8,d));o.size=r;o.type=s;a.push(o);t=d}return a};qn=function(e,t){var a;t=t||0;a=Array(2*t+1).join(" ");return e.map(function(e){return a+e.type+"\n"+Object.keys(e).filter(function(e){return"type"!==e&&"boxes"!==e}).map(function(t){var i=a+"  "+t+": ",n=e[t];if(n instanceof Uint8Array||n instanceof Uint32Array){var r=Array.prototype.slice.call(new Uint8Array(n.buffer,n.byteOffset,n.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);if(!r){return i+"<>"}if(1===r.length){return i+"<"+r.join("").slice(1)+">"}return i+"<\n"+r.map(function(e){return a+"  "+e}).join("\n")+"\n"+a+"  >"}return i+JSON.stringify(n,null,2).split("\n").map(function(e,t){if(0===t){return e}return a+"  "+e}).join("\n")}).join("\n")+(e.boxes?"\n"+qn(e.boxes,t+1):"")}).join("\n")};var jn={inspect:Mn,textify:qn,parseType:Vn,findBox:function e(t,a){var n=[],r,s,d,o,l;if(!a.length){return null}for(r=0;r<t.byteLength;){s=Fn(t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]);d=Vn(t.subarray(r+4,r+8));o=1<s?r+s:t.byteLength;if(d===a[0]){if(1===a.length){n.push(t.subarray(r+8,o))}else{l=e(t.subarray(r+8,o),a.slice(1));if(l.length){n=n.concat(l)}}}r=o}return n},parseTraf:zn.traf,parseTfdt:zn.tfdt,parseHdlr:zn.hdlr,parseTfhd:zn.tfhd,parseTrun:zn.trun,parseSidx:zn.sidx},Yn=t.EventTarget,Xn=t.mergeOptions,Kn=function(e,t){for(var a=void 0,n=Xn(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),r=0,s;r<t.playlists.length;r++){s=Fe(n,t.playlists[r]);if(s){n=s}else{a=!0}}Be(t,function(e,t,i,r){if(e.playlists&&e.playlists.length){var s=e.playlists[0].id,d=Fe(n,e.playlists[0]);if(d){n=d;n.mediaGroups[t][i][r].playlists[0]=n.playlists[s];a=!1}}});if(a){return null}return n},Qn=function(e){var t=e.byterange.offset+e.byterange.length-1;return e.uri+"-"+e.byterange.offset+"-"+t},$n=function(e,t){var a=!!(!e.map&&!t.map),i=a||!!(e.map&&t.map&&e.map.byterange.offset===t.map.byterange.offset&&e.map.byterange.length===t.map.byterange.length);return i&&e.uri===t.uri&&e.byterange.offset===t.byterange.offset&&e.byterange.length===t.byterange.length},Zn=function(e,t){var a={};for(var i in e){var n=e[i],r=n.sidx;if(r){var s=Qn(r);if(!t[s]){break}var d=t[s].sidxInfo;if($n(d,r)){a[s]=t[s]}}}return a},Jn=function(e,t,a,i){var n=Nn(e,{manifestUri:t,clientOffset:a}),r=Zn(n.playlists,i),s=r;Be(n,function(e){if(e.playlists&&e.playlists.length){var t=e.playlists;s=Xn(s,Zn(t,i))}});return s},er=function(e,a,i,n,r){var s={uri:Se(n.handleManifestRedirects,e.resolvedUri),byterange:e.byterange,playlist:a},d=t.mergeOptions(s,{responseType:"arraybuffer",headers:yt(s)});return i(d,r)},tr=function(e){xe(t,e);function t(e,a){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},n=arguments[3];De(this,t);var r=Ue(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),s=i.withCredentials,d=s===void 0?!1:s,o=i.handleManifestRedirects,l=o===void 0?!1:o;r.hls_=a;r.withCredentials=d;r.handleManifestRedirects=l;if(!e){throw new Error("A non-empty playlist URL or playlist is required")}r.on("minimumUpdatePeriod",function(){r.refreshXml_()});r.on("mediaupdatetimeout",function(){r.refreshMedia_(r.media().id)});r.state="HAVE_NOTHING";r.loadedPlaylists_={};if("string"==typeof e){r.srcUrl=e;r.sidxMapping_={};return Ue(r)}r.setupChildLoader(n,e);return r}Pe(t,[{key:"setupChildLoader",value:function(e,t){this.masterPlaylistLoader_=e;this.childPlaylist_=t}},{key:"dispose",value:function(){this.trigger("dispose");this.stopRequest();this.loadedPlaylists_={};be.clearTimeout(this.minimumUpdatePeriodTimeout_);be.clearTimeout(this.mediaRequest_);be.clearTimeout(this.mediaUpdateTimeout);this.off()}},{key:"hasPendingRequest",value:function(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null;e.onreadystatechange=null;e.abort()}}},{key:"sidxRequestFinished_",value:function(e,t,a,i){var n=this;return function(r,s){if(!n.request){return}n.request=null;if(r){n.error={status:s.status,message:"DASH playlist request error at URL: "+e.uri,response:s.response,code:2};if(a){n.state=a}n.trigger("error");return i(t,null)}var d=new Uint8Array(s.response),o=jn.parseSidx(d.subarray(8));return i(t,o)}}},{key:"media",value:function(e){var t=this;if(!e){return this.media_}if("HAVE_NOTHING"===this.state){throw new Error("Cannot switch media playlist from "+this.state)}var a=this.state;if("string"==typeof e){if(!this.master.playlists[e]){throw new Error("Unknown playlist URI: "+e)}e=this.master.playlists[e]}var i=!this.media_||e.id!==this.media_.id;if(i&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA";this.media_=e;if(i){this.trigger("mediachanging");this.trigger("mediachange")}return}if(!i){return}if(this.media_){this.trigger("mediachanging")}if(!e.sidx){this.mediaRequest_=be.setTimeout(this.haveMetadata.bind(this,{startingState:a,playlist:e}),0);return}var n=void 0,r=void 0;if(this.masterPlaylistLoader_){n=this.masterPlaylistLoader_.master;r=this.masterPlaylistLoader_.sidxMapping_}else{n=this.master;r=this.sidxMapping_}var s=Qn(e.sidx);r[s]={sidxInfo:e.sidx};this.request=er(e.sidx,e,this.hls_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(e,n,a,function(i,n){if(!i||!n){throw new Error("failed to request sidx")}r[s].sidx=n;t.haveMetadata({startingState:a,playlist:i.playlists[e.id]})}))}},{key:"haveMetadata",value:function(e){var t=e.startingState,a=e.playlist;this.state="HAVE_METADATA";this.loadedPlaylists_[a.id]=a;this.mediaRequest_=null;this.refreshMedia_(a.id);if("HAVE_MASTER"===t){this.trigger("loadedmetadata")}else{this.trigger("mediachange")}}},{key:"pause",value:function(){this.stopRequest();be.clearTimeout(this.mediaUpdateTimeout);be.clearTimeout(this.minimumUpdatePeriodTimeout_);if("HAVE_NOTHING"===this.state){this.started=!1}}},{key:"load",value:function(e){var t=this;be.clearTimeout(this.mediaUpdateTimeout);be.clearTimeout(this.minimumUpdatePeriodTimeout_);var a=this.media();if(e){var i=a?1e3*(a.targetDuration/2):5000;this.mediaUpdateTimeout=be.setTimeout(function(){return t.load()},i);return}if(!this.started){this.start();return}if(a&&!a.endList){this.trigger("mediaupdatetimeout")}else{this.trigger("loadedplaylist")}}},{key:"parseMasterXml",value:function(){var e=Nn(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_});e.uri=this.srcUrl;for(var t=0,a;t<e.playlists.length;t++){a="placeholder-uri-"+t;e.playlists[t].uri=a}Be(e,function(t,a,i,n){if(t.playlists&&t.playlists.length){var r="placeholder-uri-"+a+"-"+i+"-"+n,s=He(0,r);t.playlists[0].uri=r;t.playlists[0].id=s;e.playlists[s]=t.playlists[0];e.playlists[r]=t.playlists[0]}});Ge(e);Ve(e);return e}},{key:"start",value:function(){var e=this;this.started=!0;if(this.masterPlaylistLoader_){this.mediaRequest_=be.setTimeout(this.haveMaster_.bind(this),0);return}this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(t,a){if(!e.request){return}e.request=null;if(t){e.error={status:a.status,message:"DASH playlist request error at URL: "+e.srcUrl,responseText:a.responseText,code:2};if("HAVE_NOTHING"===e.state){e.started=!1}return e.trigger("error")}e.masterXml_=a.responseText;if(a.responseHeaders&&a.responseHeaders.date){e.masterLoaded_=Date.parse(a.responseHeaders.date)}else{e.masterLoaded_=Date.now()}e.srcUrl=Se(e.handleManifestRedirects,e.srcUrl,a);e.syncClientServerClock_(e.onClientServerClockSync_.bind(e))})}},{key:"syncClientServerClock_",value:function(e){var t=this,a=wn(this.masterXml_);if(null===a){this.clientOffset_=this.masterLoaded_-Date.now();return e()}if("DIRECT"===a.method){this.clientOffset_=a.value-Date.now();return e()}this.request=this.hls_.xhr({uri:Te(this.srcUrl,a.value),method:a.method,withCredentials:this.withCredentials},function(i,n){if(!t.request){return}if(i){t.clientOffset_=t.masterLoaded_-Date.now();return e()}var r;if("HEAD"===a.method){if(!n.responseHeaders||!n.responseHeaders.date){r=t.masterLoaded_}else{r=Date.parse(n.responseHeaders.date)}}else{r=Date.parse(n.responseText)}t.clientOffset_=r-Date.now();e()})}},{key:"haveMaster_",value:function(){this.state="HAVE_MASTER";this.mediaRequest_=null;if(!this.masterPlaylistLoader_){this.master=this.parseMasterXml();this.trigger("loadedplaylist")}else if(!this.media_){this.media(this.childPlaylist_)}}},{key:"onClientServerClockSync_",value:function(){var e=this;this.haveMaster_();if(!this.hasPendingRequest()&&!this.media_){this.media(this.master.playlists[0])}if(this.master&&this.master.minimumUpdatePeriod){this.minimumUpdatePeriodTimeout_=be.setTimeout(function(){e.trigger("minimumUpdatePeriod")},this.master.minimumUpdatePeriod)}}},{key:"refreshXml_",value:function(){var e=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(t,a){if(!e.request){return}e.request=null;if(t){e.error={status:a.status,message:"DASH playlist request error at URL: "+e.srcUrl,responseText:a.responseText,code:2};if("HAVE_NOTHING"===e.state){e.started=!1}return e.trigger("error")}e.masterXml_=a.responseText;e.sidxMapping_=Jn(e.masterXml_,e.srcUrl,e.clientOffset_,e.sidxMapping_);var i=e.parseMasterXml(),n=Kn(e.master,i),r=e.media().sidx;if(n){if(r){var s=Qn(r);if(!e.sidxMapping_[s]){var d=e.media();e.request=er(d.sidx,d,e.hls_.xhr,{handleManifestRedirects:e.handleManifestRedirects},e.sidxRequestFinished_(d,i,e.state,function(t,a){if(!t||!a){throw new Error("failed to request sidx on minimumUpdatePeriod")}e.sidxMapping_[s].sidx=a;e.minimumUpdatePeriodTimeout_=be.setTimeout(function(){e.trigger("minimumUpdatePeriod")},e.master.minimumUpdatePeriod);e.refreshMedia_(e.media().id)}))}}else{e.master=n}}e.minimumUpdatePeriodTimeout_=be.setTimeout(function(){e.trigger("minimumUpdatePeriod")},e.master.minimumUpdatePeriod)})}},{key:"refreshMedia_",value:function(e){var t=this;if(!e){throw new Error("refreshMedia_ must take a media id")}var a=void 0,i=void 0;if(this.masterPlaylistLoader_){a=this.masterPlaylistLoader_.master;i=this.masterPlaylistLoader_.parseMasterXml()}else{a=this.master;i=this.parseMasterXml()}var n=Kn(a,i);if(n){if(this.masterPlaylistLoader_){this.masterPlaylistLoader_.master=n}else{this.master=n}this.media_=n.playlists[e]}else{this.media_=i.playlists[e];this.trigger("playlistunchanged")}if(!this.media().endList){this.mediaUpdateTimeout=be.setTimeout(function(){t.trigger("mediaupdatetimeout")},We(this.media(),!!n))}this.trigger("loadedplaylist")}}]);return t}(Yn),ar=function(e){if(t.log.debug){return t.log.debug.bind(t,"VHS:",e+" >")}return function(){}};function me(){}var ir=function(){function e(t,a,i,n){De(this,e);this.callbacks_=[];this.pendingCallback_=null;this.timestampOffset_=0;this.mediaSource=t;this.processedAppend_=!1;this.type_=i;this.mimeType_=a;this.logger_=ar("SourceUpdater["+i+"]["+a+"]");if("closed"===t.readyState){t.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,a,n))}else{this.createSourceBuffer_(a,n)}}Pe(e,[{key:"createSourceBuffer_",value:function(e,t){var a=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(e);this.logger_("created SourceBuffer");if(t){t.trigger("sourcebufferadded");if(2>this.mediaSource.sourceBuffers.length){t.on("sourcebufferadded",function(){a.start_()});return}}this.start_()}},{key:"start_",value:function(){var e=this;this.started_=!0;this.onUpdateendCallback_=function(){var t=e.pendingCallback_;e.pendingCallback_=null;e.sourceBuffer_.removing=!1;e.logger_("buffered ["+$t(e.buffered())+"]");if(t){t()}e.runCallback_()};this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_);this.runCallback_()}},{key:"abort",value:function(e){var t=this;if(this.processedAppend_){this.queueCallback_(function(){t.sourceBuffer_.abort()},e)}}},{key:"appendBuffer",value:function(e,t){var a=this;this.processedAppend_=!0;this.queueCallback_(function(){if(e.videoSegmentTimingInfoCallback){a.sourceBuffer_.addEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback)}a.sourceBuffer_.appendBuffer(e.bytes)},function(){if(e.videoSegmentTimingInfoCallback){a.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback)}t()})}},{key:"buffered",value:function(){if(!this.sourceBuffer_){return t.createTimeRanges()}return this.sourceBuffer_.buffered}},{key:"remove",value:function(e,t){var a=this,i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:me;if(this.processedAppend_){this.queueCallback_(function(){a.logger_("remove ["+e+" => "+t+"]");a.sourceBuffer_.removing=!0;a.sourceBuffer_.remove(e,t)},i)}}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==me}},{key:"timestampOffset",value:function(e){var t=this;if("undefined"!=typeof e){this.queueCallback_(function(){t.sourceBuffer_.timestampOffset=e;t.runCallback_()});this.timestampOffset_=e}return this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]);this.runCallback_()}},{key:"runCallback_",value:function(){var e;if(!this.updating()&&this.callbacks_.length&&this.started_){e=this.callbacks_.shift();this.pendingCallback_=e[1];e[0]()}}},{key:"dispose",value:function(){var e=this,t=function t(){if(e.sourceBuffer_&&"open"===e.mediaSource.readyState){e.sourceBuffer_.abort()}e.sourceBuffer_.removeEventListener("updateend",t)};this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_);if(this.sourceBuffer_.removing){this.sourceBuffer_.addEventListener("updateend",t)}else{t()}}}]);return e}(),nr={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},rr=Bn.toUnsigned,sr=Bn.toHexString,dr,or,lr,ur,pr;dr=function(e){var t=jn.findBox(e,["moov","trak"]);return t.reduce(function(e,t){var a,i,n,r,s;a=jn.findBox(t,["tkhd"])[0];if(!a){return null}i=a[0];n=0===i?12:20;r=rr(a[n]<<24|a[n+1]<<16|a[n+2]<<8|a[n+3]);s=jn.findBox(t,["mdia","mdhd"])[0];if(!s){return null}i=s[0];n=0===i?12:20;e[r]=rr(s[n]<<24|s[n+1]<<16|s[n+2]<<8|s[n+3]);return e},{})};or=function(e,t){var a,i,n;a=jn.findBox(t,["moof","traf"]);i=[].concat.apply([],a.map(function(t){return jn.findBox(t,["tfhd"]).map(function(a){var i,n,r;i=rr(a[4]<<24|a[5]<<16|a[6]<<8|a[7]);n=e[i]||9e4;r=jn.findBox(t,["tfdt"]).map(function(e){var t,a;t=e[0];a=rr(e[4]<<24|e[5]<<16|e[6]<<8|e[7]);if(1===t){a*=Math.pow(2,32);a+=rr(e[8]<<24|e[9]<<16|e[10]<<8|e[11])}return a})[0];r=r||1/0;return r/n})}));n=Math.min.apply(null,i);return isFinite(n)?n:0};lr=function(e,t){var a=jn.findBox(t,["moof","traf"]),n=0,r=0,s;if(a&&a.length){for(var d=jn.parseTraf(a[0]),o=0;o<d.boxes.length;o++){if("tfhd"===d.boxes[o].type){s=d.boxes[o].trackId}else if("tfdt"===d.boxes[o].type){n=d.boxes[o].baseMediaDecodeTime}else if("trun"===d.boxes[o].type&&d.boxes[o].samples.length){r=d.boxes[o].samples[0].compositionTimeOffset||0}}}var l=e[s]||9e4;return(n+r)/l};ur=function(e){var t=jn.findBox(e,["moov","trak"]),a=[];t.forEach(function(e){var t=jn.findBox(e,["mdia","hdlr"]),i=jn.findBox(e,["tkhd"]);t.forEach(function(e,t){var n=jn.parseType(e.subarray(8,12)),r=i[t],s,d,o;if("vide"===n){s=new DataView(r.buffer,r.byteOffset,r.byteLength);d=s.getUint8(0);o=0===d?s.getUint32(12):s.getUint32(20);a.push(o)}})});return a};pr=function(e){var t=jn.findBox(e,["moov","trak"]),a=[];t.forEach(function(e){var t={},i=jn.findBox(e,["tkhd"])[0],n,r;if(i){n=new DataView(i.buffer,i.byteOffset,i.byteLength);r=n.getUint8(0);t.id=0===r?n.getUint32(12):n.getUint32(20)}var s=jn.findBox(e,["mdia","hdlr"])[0];if(s){var d=jn.parseType(s.subarray(8,12));if("vide"===d){t.type="video"}else if("soun"===d){t.type="audio"}else{t.type=d}}var o=jn.findBox(e,["mdia","minf","stbl","stsd"])[0];if(o){var l=o.subarray(8);t.codec=jn.parseType(l.subarray(4,8));var u=jn.findBox(l,[t.codec])[0],p,m;if(u){if(/^[a-z]vc[1-9]$/i.test(t.codec)){p=u.subarray(78);m=jn.parseType(p.subarray(4,8));if("avcC"===m&&11<p.length){t.codec+=".";t.codec+=sr(p[9]);t.codec+=sr(p[10]);t.codec+=sr(p[11])}else{t.codec="avc1.4d400d"}}else if(/^mp4[a,v]$/i.test(t.codec)){p=u.subarray(28);m=jn.parseType(p.subarray(4,8));if("esds"===m&&20<p.length&&0!==p[19]){t.codec+="."+sr(p[19]);t.codec+="."+sr(63&p[20]>>>2).replace(/^0/,"")}else{t.codec="mp4a.40.2"}}}}var c=jn.findBox(e,["mdia","mdhd"])[0];if(c&&i){var g=0===r?12:20;t.timescale=rr(c[g]<<24|c[g+1]<<16|c[g+2]<<8|c[g+3])}a.push(t)});return a};var mr={findBox:jn.findBox,parseType:jn.parseType,timescale:dr,startTime:or,compositionStartTime:lr,videoTrackIds:ur,tracks:pr},cr={FAILURE:2,TIMEOUT:-101,ABORTED:-102},gr=function(e){e.forEach(function(e){e.abort()})},yr=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}},fr=function(e){var t=e.target,a=Date.now()-t.requestTime,i={bandwidth:1/0,bytesReceived:0,roundTripTime:a||0};i.bytesReceived=e.loaded;i.bandwidth=Math.floor(1e3*(8*(i.bytesReceived/i.roundTripTime)));return i},_r=function(e,t){if(t.timedout){return{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:cr.TIMEOUT,xhr:t}}if(t.aborted){return{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:cr.ABORTED,xhr:t}}if(e){return{status:t.status,message:"HLS request errored at URL: "+t.uri,code:cr.FAILURE,xhr:t}}return null},hr=function(e,t){return function(a,i){var n=i.response,r=_r(a,i);if(r){return t(r,e)}if(16!==n.byteLength){return t({status:i.status,message:"Invalid HLS key at URL: "+i.uri,code:cr.FAILURE,xhr:i},e)}var s=new DataView(n);e.key.bytes=new Uint32Array([s.getUint32(0),s.getUint32(4),s.getUint32(8),s.getUint32(12)]);return t(null,e)}},br=function(e,t,a){return function(i,n){var r=n.response,s=_r(i,n);if(s){return a(s,e)}if(0===r.byteLength){return a({status:n.status,message:"Empty HLS segment content at URL: "+n.uri,code:cr.FAILURE,xhr:n},e)}e.map.bytes=new Uint8Array(n.response);if(t&&!t.isInitialized()){t.init()}e.map.timescales=mr.timescale(e.map.bytes);e.map.videoTrackIds=mr.videoTrackIds(e.map.bytes);return a(null,e)}},Tr=function(e,t,a){return function(i,n){var r=n.response,s=_r(i,n),d=void 0;if(s){return a(s,e)}if(0===r.byteLength){return a({status:n.status,message:"Empty HLS segment content at URL: "+n.uri,code:cr.FAILURE,xhr:n},e)}e.stats=yr(n);if(e.key){e.encryptedBytes=new Uint8Array(n.response)}else{e.bytes=new Uint8Array(n.response)}if(t&&e.map&&e.map.bytes){if(!t.isInitialized()){t.init()}d=t.parse(e.bytes,e.map.videoTrackIds,e.map.timescales);if(d&&d.captions){e.captionStreams=d.captionStreams;e.fmp4Captions=d.captions}}return a(null,e)}},Sr=function(e,t,a){e.addEventListener("message",function i(n){if(n.data.source===t.requestId){e.removeEventListener("message",i);var r=n.data.decrypted;t.bytes=new Uint8Array(r.bytes,r.byteOffset,r.byteLength);return a(null,t)}});var i;if(t.key.bytes.slice){i=t.key.bytes.slice()}else{i=new Uint32Array(Array.prototype.slice.call(t.key.bytes))}e.postMessage(xt({source:t.requestId,encrypted:t.encryptedBytes,key:i,iv:t.key.iv}),[t.encryptedBytes.buffer,i.buffer])},vr=function(e,t,a){var i=0,n=!1;return function(r,s){if(n){return}if(r){n=!0;gr(e);return a(r,s)}i+=1;if(i===e.length){s.endOfAllRequests=Date.now();if(s.encryptedBytes){return Sr(t,s,a)}return a(null,s)}}},kr=function(e,a){return function(i){e.stats=t.mergeOptions(e.stats,fr(i));if(!e.stats.firstBytesReceivedAt&&e.stats.bytesReceived){e.stats.firstBytesReceivedAt=Date.now()}return a(i,e)}},Ir=function(e,a,i,n,r,s,d){var o=[],l=vr(o,i,d);if(r.key&&!r.key.bytes){var u=t.mergeOptions(a,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),p=hr(r,l),m=e(u,p);o.push(m)}if(r.map&&!r.map.bytes){var c=t.mergeOptions(a,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:yt(r.map)}),g=br(r,n,l),y=e(c,g);o.push(y)}var f=t.mergeOptions(a,{uri:r.resolvedUri,responseType:"arraybuffer",headers:yt(r)}),_=Tr(r,n,l),h=e(f,_);h.addEventListener("progress",kr(r,s));o.push(h);return function(){return gr(o)}},Er=function(e,t){var a;if(!e){return""}a=be.getComputedStyle(e);if(!a){return""}return a[t]},Lr=function(e,t){var a=e.slice();e.sort(function(e,i){var n=t(e,i);if(0===n){return a.indexOf(e)-a.indexOf(i)}return n})},Cr=function(e,t){var a=void 0,i=void 0;if(e.attributes.BANDWIDTH){a=e.attributes.BANDWIDTH}a=a||be.Number.MAX_VALUE;if(t.attributes.BANDWIDTH){i=t.attributes.BANDWIDTH}i=i||be.Number.MAX_VALUE;return a-i},Dr=function(e,t,a,i,n){var r=e.playlists.map(function(e){var t=void 0,a=void 0,i=void 0;t=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width;a=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height;i=e.attributes.BANDWIDTH;i=i||be.Number.MAX_VALUE;return{bandwidth:i,width:t,height:a,playlist:e}});Lr(r,function(e,t){return e.bandwidth-t.bandwidth});r=r.filter(function(e){return!ut.isIncompatible(e.playlist)});var s=r.filter(function(e){return ut.isEnabled(e.playlist)});if(!s.length){s=r.filter(function(e){return!ut.isDisabled(e.playlist)})}var d=s.filter(function(e){return e.bandwidth*nr.BANDWIDTH_VARIANCE<t}),o=d[d.length-1],l=d.filter(function(e){return e.bandwidth===o.bandwidth})[0];if(!1===n){var u=l||s[0]||r[0];return u?u.playlist:null}var p=d.filter(function(e){return e.width&&e.height});Lr(p,function(e,t){return e.width-t.width});var m=p.filter(function(e){return e.width===a&&e.height===i});o=m[m.length-1];var c=m.filter(function(e){return e.bandwidth===o.bandwidth})[0],g=void 0,y=void 0,f=void 0;if(!c){g=p.filter(function(e){return e.width>a||e.height>i});y=g.filter(function(e){return e.width===g[0].width&&e.height===g[0].height});o=y[y.length-1];f=y.filter(function(e){return e.bandwidth===o.bandwidth})[0]}var _=f||c||l||s[0]||r[0];return _?_.playlist:null},Pr=function(e){var t=e.master,a=e.currentTime,i=e.bandwidth,n=e.duration,r=e.segmentDuration,s=e.timeUntilRebuffer,d=e.currentTimeline,o=e.syncController,l=t.playlists.filter(function(e){return!ut.isIncompatible(e)}),u=l.filter(ut.isEnabled);if(!u.length){u=l.filter(function(e){return!ut.isDisabled(e)})}var p=u.filter(ut.hasAttribute.bind(null,"BANDWIDTH")),m=p.map(function(e){var t=o.getSyncPoint(e,n,d,a),l=t?1:2,u=ut.estimateSegmentRequestTime(r,i,e);return{playlist:e,rebufferingImpact:u*l-s}}),c=m.filter(function(e){return 0>=e.rebufferingImpact});Lr(c,function(e,t){return Cr(t.playlist,e.playlist)});if(c.length){return c[0]}Lr(m,function(e,t){return e.rebufferingImpact-t.rebufferingImpact});return m[0]||null},Or=function(e,t,a){for(var i in a){if(!e[i]){t.trigger({type:"usage",name:"hls-608"});var n=t.textTracks().getTrackById(i);if(n){e[i]=n}else{e[i]=t.addRemoteTextTrack({kind:"captions",id:i,label:i},!1).track}}}},xr=function(e){var t=e.inbandTextTracks,a=e.captionArray,i=e.timestampOffset;if(!a){return}var n=window.WebKitDataCue||window.VTTCue;a.forEach(function(e){var a=e.stream,r=e.startTime,s=e.endTime;if(!t[a]){return}r+=i;s+=i;t[a].addCue(new n(r,s,e.text))})},Ur=4,Rr={parseSei:function(e){var t=0,a={payloadType:-1,payloadSize:0},n=0,r=0;while(t<e.byteLength){if(e[t]===128){break}while(255===e[t]){n+=255;t++}n+=e[t++];while(255===e[t]){r+=255;t++}r+=e[t++];if(!a.payload&&n===Ur){a.payloadType=n;a.payloadSize=r;a.payload=e.subarray(t,t+r);break}t+=r;n=0;r=0}return a},parseUserData:function(e){if(181!==e.payload[0]){return null}if(49!=(e.payload[1]<<8|e.payload[2])){return null}if("GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])){return null}if(3!==e.payload[7]){return null}return e.payload.subarray(8,e.payload.length-1)},parseCaptionPackets:function(e,t){var a=[],n,r,s,d;if(!(64&t[0])){return a}r=31&t[0];for(n=0;n<r;n++){s=3*n;d={type:3&t[s+2],pts:e};if(4&t[s+2]){d.ccData=t[s+3]<<8|t[s+4];a.push(d)}}return a},discardEmulationPreventionBytes:function(e){var t=e.byteLength,a=[],n=1,r,s;while(n<t-2){if(0===e[n]&&0===e[n+1]&&3===e[n+2]){a.push(n+2);n+=2}else{n++}}if(0===a.length){return e}r=t-a.length;s=new Uint8Array(r);var d=0;for(n=0;n<r;d++,n++){if(d===a[0]){d++;a.shift()}s[n]=e[d]}return s},USER_DATA_REGISTERED_ITU_T_T35:Ur},Ar=function(){this.init=function(){var e={};this.on=function(t,a){if(!e[t]){e[t]=[]}e[t]=e[t].concat(a)};this.off=function(t,a){var i;if(!e[t]){return!1}i=e[t].indexOf(a);e[t]=e[t].slice();e[t].splice(i,1);return-1<i};this.trigger=function(t){var a,n,r,s;a=e[t];if(!a){return}if(2===arguments.length){r=a.length;for(n=0;n<r;++n){a[n].call(this,arguments[1])}}else{s=[];n=arguments.length;for(n=1;n<arguments.length;++n){s.push(arguments[n])}r=a.length;for(n=0;n<r;++n){a[n].apply(this,s)}}};this.dispose=function(){e={}}}};Ar.prototype.pipe=function(e){this.on("data",function(t){e.push(t)});this.on("done",function(t){e.flush(t)});this.on("partialdone",function(t){e.partialFlush(t)});this.on("endedtimeline",function(t){e.endTimeline(t)});this.on("reset",function(t){e.reset(t)});return e};Ar.prototype.push=function(e){this.trigger("data",e)};Ar.prototype.flush=function(e){this.trigger("done",e)};Ar.prototype.partialFlush=function(e){this.trigger("partialdone",e)};Ar.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)};Ar.prototype.reset=function(e){this.trigger("reset",e)};var Nr=Ar,wr=function e(){e.prototype.init.call(this);this.captionPackets_=[];this.ccStreams_=[new Gr(0,0),new Gr(0,1),new Gr(1,0),new Gr(1,1)];this.reset();this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data"));e.on("partialdone",this.trigger.bind(this,"partialdone"));e.on("done",this.trigger.bind(this,"done"))},this)};wr.prototype=new Nr;wr.prototype.push=function(e){var t,a,i;if("sei_rbsp"!==e.nalUnitType){return}t=Rr.parseSei(e.escapedRBSP);if(t.payloadType!==Rr.USER_DATA_REGISTERED_ITU_T_T35){return}a=Rr.parseUserData(t);if(!a){return}if(e.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;if(!this.numSameDts_){this.ignoreNextEqualDts_=!1}return}i=Rr.parseCaptionPackets(e.pts,a);this.captionPackets_=this.captionPackets_.concat(i);if(this.latestDts_!==e.dts){this.numSameDts_=0}this.numSameDts_++;this.latestDts_=e.dts};wr.prototype.flushCCStreams=function(e){this.ccStreams_.forEach(function(t){return"flush"===e?t.flush():t.partialFlush()},this)};wr.prototype.flushStream=function(e){if(!this.captionPackets_.length){this.flushCCStreams(e);return}this.captionPackets_.forEach(function(e,t){e.presortIndex=t});this.captionPackets_.sort(function(e,t){if(e.pts===t.pts){return e.presortIndex-t.presortIndex}return e.pts-t.pts});this.captionPackets_.forEach(function(e){if(2>e.type){this.dispatchCea608Packet(e)}},this);this.captionPackets_.length=0;this.flushCCStreams(e)};wr.prototype.flush=function(){return this.flushStream("flush")};wr.prototype.partialFlush=function(){return this.flushStream("partialFlush")};wr.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=!1;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach(function(e){e.reset()})};wr.prototype.dispatchCea608Packet=function(e){if(this.setsTextOrXDSActive(e)){this.activeCea608Channel_[e.type]=null}else if(this.setsChannel1Active(e)){this.activeCea608Channel_[e.type]=0}else if(this.setsChannel2Active(e)){this.activeCea608Channel_[e.type]=1}if(null===this.activeCea608Channel_[e.type]){return}this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)};wr.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)};wr.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)};wr.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var Br={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Mr=function(e){if(null===e){return""}e=Br[e]||e;return String.fromCharCode(e)},qr=14,Fr=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Hr=function(){var e=[],t=qr+1;while(t--){e.push("")}return e},Gr=function e(t,a){e.prototype.init.call(this);this.field_=t||0;this.dataChannel_=a||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(e){var t,a,i,n,r;t=32639&e.ccData;if(t===this.lastControlCode_){this.lastControlCode_=null;return}if(4096==(61440&t)){this.lastControlCode_=t}else if(t!==this.PADDING_){this.lastControlCode_=null}i=t>>>8;n=255&t;if(t===this.PADDING_){}else if(t===this.RESUME_CAPTION_LOADING_){this.mode_="popOn"}else if(t===this.END_OF_CAPTION_){this.mode_="popOn";this.clearFormatting(e.pts);this.flushDisplayed(e.pts);a=this.displayed_;this.displayed_=this.nonDisplayed_;this.nonDisplayed_=a;this.startPts_=e.pts}else if(t===this.ROLL_UP_2_ROWS_){this.rollUpRows_=2;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_3_ROWS_){this.rollUpRows_=3;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_4_ROWS_){this.rollUpRows_=4;this.setRollUp(e.pts)}else if(t===this.CARRIAGE_RETURN_){this.clearFormatting(e.pts);this.flushDisplayed(e.pts);this.shiftRowsUp_();this.startPts_=e.pts}else if(t===this.BACKSPACE_){if("popOn"===this.mode_){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}}else if(t===this.ERASE_DISPLAYED_MEMORY_){this.flushDisplayed(e.pts);this.displayed_=Hr()}else if(t===this.ERASE_NON_DISPLAYED_MEMORY_){this.nonDisplayed_=Hr()}else if(t===this.RESUME_DIRECT_CAPTIONING_){if("paintOn"!==this.mode_){this.flushDisplayed(e.pts);this.displayed_=Hr()}this.mode_="paintOn";this.startPts_=e.pts}else if(this.isSpecialCharacter(i,n)){i=(3&i)<<8;r=Mr(i|n);this[this.mode_](e.pts,r);this.column_++}else if(this.isExtCharacter(i,n)){if("popOn"===this.mode_){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}i=(3&i)<<8;r=Mr(i|n);this[this.mode_](e.pts,r);this.column_++}else if(this.isMidRowCode(i,n)){this.clearFormatting(e.pts);this[this.mode_](e.pts," ");this.column_++;if(14==(14&n)){this.addFormatting(e.pts,["i"])}if(1==(1&n)){this.addFormatting(e.pts,["u"])}}else if(this.isOffsetControlCode(i,n)){this.column_+=3&n}else if(this.isPAC(i,n)){var s=Fr.indexOf(7968&t);if("rollUp"===this.mode_){if(0>s-this.rollUpRows_+1){s=this.rollUpRows_-1}this.setRollUp(e.pts,s)}if(s!==this.row_){this.clearFormatting(e.pts);this.row_=s}if(1&n&&-1===this.formatting_.indexOf("u")){this.addFormatting(e.pts,["u"])}if(16==(16&t)){this.column_=4*((14&t)>>1)}if(this.isColorPAC(n)){if(14==(14&n)){this.addFormatting(e.pts,["i"])}}}else if(this.isNormalChar(i)){if(0===n){n=null}r=Mr(i);r+=Mr(n);this[this.mode_](e.pts,r);this.column_+=r.length}}};Gr.prototype=new Nr;Gr.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(t){console.error("Skipping malformed caption.");return""}}).join("\n").replace(/^\n+|\n+$/g,"");if(t.length){this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})}};Gr.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=Hr();this.nonDisplayed_=Hr();this.lastControlCode_=null;this.column_=0;this.row_=qr;this.rollUpRows_=2;this.formatting_=[]};Gr.prototype.setConstants=function(){if(0===this.dataChannel_){this.BASE_=16;this.EXT_=17;this.CONTROL_=(20|this.field_)<<8;this.OFFSET_=23}else if(1===this.dataChannel_){this.BASE_=24;this.EXT_=25;this.CONTROL_=(28|this.field_)<<8;this.OFFSET_=31}this.PADDING_=0;this.RESUME_CAPTION_LOADING_=32|this.CONTROL_;this.END_OF_CAPTION_=47|this.CONTROL_;this.ROLL_UP_2_ROWS_=37|this.CONTROL_;this.ROLL_UP_3_ROWS_=38|this.CONTROL_;this.ROLL_UP_4_ROWS_=39|this.CONTROL_;this.CARRIAGE_RETURN_=45|this.CONTROL_;this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_;this.BACKSPACE_=33|this.CONTROL_;this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_;this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_};Gr.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&63>=t};Gr.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&63>=t};Gr.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&47>=t};Gr.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&35>=t};Gr.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&127>=t};Gr.prototype.isColorPAC=function(e){return 64<=e&&79>=e||96<=e&&127>=e};Gr.prototype.isNormalChar=function(e){return 32<=e&&127>=e};Gr.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_){this.row_=qr;this.mode_="rollUp";this.flushDisplayed(e);this.nonDisplayed_=Hr();this.displayed_=Hr()}if(t!==void 0&&t!==this.row_){for(var a=0;a<this.rollUpRows_;a++){this.displayed_[t-a]=this.displayed_[this.row_-a];this.displayed_[this.row_-a]=""}}if(t===void 0){t=this.row_}this.topRow_=t-this.rollUpRows_+1};Gr.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var a=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,a)};Gr.prototype.clearFormatting=function(e){if(!this.formatting_.length){return}var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[];this[this.mode_](e,t)};Gr.prototype.popOn=function(e,t){var a=this.nonDisplayed_[this.row_];a+=t;this.nonDisplayed_[this.row_]=a};Gr.prototype.rollUp=function(e,t){var a=this.displayed_[this.row_];a+=t;this.displayed_[this.row_]=a};Gr.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++){this.displayed_[e]=""}for(e=this.row_+1;e<qr+1;e++){this.displayed_[e]=""}for(e=this.topRow_;e<this.row_;e++){this.displayed_[e]=this.displayed_[e+1]}this.displayed_[this.row_]=""};Gr.prototype.paintOn=function(e,t){var a=this.displayed_[this.row_];a+=t;this.displayed_[this.row_]=a};var Vr=Rr.discardEmulationPreventionBytes,Wr={CaptionStream:wr,Cea608Stream:Gr}.CaptionStream,zr=function(e,t){for(var a=e,n=0,r;n<t.length;n++){r=t[n];if(a<r.size){return r}a-=r.size}return null},jr=function(e,t,a){var n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[],s,d,o,l;for(d=0;d+4<e.length;d+=o){o=n.getUint32(d);d+=4;if(0>=o){continue}switch(31&e[d]){case 6:var u=e.subarray(d+1,d+1+o),p=zr(d,t);s={nalUnitType:"sei_rbsp",size:o,data:u,escapedRBSP:Vr(u),trackId:a};if(p){s.pts=p.pts;s.dts=p.dts;l=p}else if(l){s.pts=l.pts;s.dts=l.dts}else{console.log("We've encountered a nal unit without data. See mux.js#233.");break}r.push(s);break;default:break;}}return r},Yr=function(e,t,a){var i=t,n=a.defaultSampleDuration||0,r=a.defaultSampleSize||0,s=a.trackId,d=[];e.forEach(function(e){var t=jn.parseTrun(e),a=t.samples;a.forEach(function(e){if(e.duration===void 0){e.duration=n}if(e.size===void 0){e.size=r}e.trackId=s;e.dts=i;if(e.compositionTimeOffset===void 0){e.compositionTimeOffset=0}e.pts=i+e.compositionTimeOffset;i+=e.duration});d=d.concat(a)});return d},Xr=function(e,t){var a=mr.findBox(e,["moof","traf"]),i=mr.findBox(e,["mdat"]),n={},r=[];i.forEach(function(e,t){var i=a[t];r.push({mdat:e,traf:i})});r.forEach(function(e){var a=e.mdat,i=e.traf,r=mr.findBox(i,["tfhd"]),s=jn.parseTfhd(r[0]),d=s.trackId,o=mr.findBox(i,["tfdt"]),l=0<o.length?jn.parseTfdt(o[0]).baseMediaDecodeTime:0,u=mr.findBox(i,["trun"]),p,m;if(t===d&&0<u.length){p=Yr(u,l,s);m=jr(a,p,d);if(!n[d]){n[d]=[]}n[d]=n[d].concat(m)}});return n},Kr=function(e,t,a){var i;if(null===t){return null}i=Xr(e,t);return{seiNals:i[t],timescale:a}},Qr=function(){var e=!1,t,a,i,n,r,s;this.isInitialized=function(){return e};this.init=function(a){t=new Wr;e=!0;s=a?a.isPartial:!1;t.on("data",function(e){e.startTime=e.startPts/n;e.endTime=e.endPts/n;r.captions.push(e);r.captionStreams[e.stream]=!0})};this.isNewInit=function(e,t){if(e&&0===e.length||t&&"object"===_typeof(t)&&0===Object.keys(t).length){return!1}return i!==e[0]||n!==t[i]};this.parse=function(e,t,s){var d;if(!this.isInitialized()){return null}else if(!t||!s){return null}else if(this.isNewInit(t,s)){i=t[0];n=s[i]}else if(null===i||!n){a.push(e);return null}while(0<a.length){var o=a.shift();this.parse(o,t,s)}d=Kr(e,i,n);if(null===d||!d.seiNals){return null}this.pushNals(d.seiNals);this.flushStream();return r};this.pushNals=function(e){if(!this.isInitialized()||!e||0===e.length){return null}e.forEach(function(e){t.push(e)})};this.flushStream=function(){if(!this.isInitialized()){return null}if(!s){t.flush()}else{t.partialFlush()}};this.clearParsedCaptions=function(){r.captions=[];r.captionStreams={}};this.resetCaptionStream=function(){if(!this.isInitialized()){return null}t.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){a=[];i=null;n=null;if(!r){r={captions:[],captionStreams:{}}}else{this.clearParsedCaptions()}this.resetCaptionStream()};this.reset()},$r=function(e,t,a){if(!e||!t){return!1}var i=e.segments,n=a===i.length;return e.endList&&"open"===t.readyState&&n},Zr=function(e){return"number"==typeof e&&isFinite(e)},Jr=function(e,t,a){if("main"!==e||!t||!a){return null}if(!a.containsAudio&&!a.containsVideo){return"Neither audio nor video found in segment."}if(t.containsVideo&&!a.containsVideo){return"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest."}if(!t.containsVideo&&a.containsVideo){return"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest."}return null},es=function(e,t,a){var i=t-30;if(e.length){i=Math.max(i,e.start(0))}return Math.min(t-a,i)},ts=function(e){var t=e.segment,a=t.start,i=t.end,n=e.playlist,r=n.mediaSequence,s=n.id,d=n.segments,o=d===void 0?[]:d,l=e.mediaIndex,u=e.timeline;return["appending ["+l+"] of ["+r+", "+(r+o.length)+"] from playlist ["+s+"]","["+a+" => "+i+"] in timeline ["+u+"]"].join(" ")},as=function(e){xe(a,e);function a(e){De(this,a);var t=Ue(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));if(!e){throw new TypeError("Initialization settings are required")}if("function"!=typeof e.currentTime){throw new TypeError("No currentTime getter specified")}if(!e.mediaSource){throw new TypeError("No MediaSource specified")}t.bandwidth=e.bandwidth;t.throughput={rate:0,count:0};t.roundTrip=NaN;t.resetStats_();t.mediaIndex=null;t.hasPlayed_=e.hasPlayed;t.currentTime_=e.currentTime;t.seekable_=e.seekable;t.seeking_=e.seeking;t.duration_=e.duration;t.mediaSource_=e.mediaSource;t.hls_=e.hls;t.loaderType_=e.loaderType;t.startingMedia_=void 0;t.segmentMetadataTrack_=e.segmentMetadataTrack;t.goalBufferLength_=e.goalBufferLength;t.sourceType_=e.sourceType;t.inbandTextTracks_=e.inbandTextTracks;t.state_="INIT";t.checkBufferTimeout_=null;t.error_=void 0;t.currentTimeline_=-1;t.pendingSegment_=null;t.mimeType_=null;t.sourceUpdater_=null;t.xhrOptions_=null;t.activeInitSegmentId_=null;t.initSegments_={};t.cacheEncryptionKeys_=e.cacheEncryptionKeys;t.keyCache_={};if("main"===t.loaderType_){t.captionParser_=new Qr}else{t.captionParser_=null}t.decrypter_=e.decrypter;t.syncController_=e.syncController;t.syncPoint_={segmentIndex:0,time:0};t.triggerSyncInfoUpdate_=function(){return t.trigger("syncinfoupdate")};t.syncController_.on("syncinfoupdate",t.triggerSyncInfoUpdate_);t.mediaSource_.addEventListener("sourceopen",function(){return t.ended_=!1});t.fetchAtBuffer_=!1;t.logger_=ar("SegmentLoader["+t.loaderType_+"]");Object.defineProperty(t,"state",{get:function(){return this.state_},set:function(e){if(e!==this.state_){this.logger_(this.state_+" -> "+e);this.state_=e}}});return t}Pe(a,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0;this.mediaRequests=0;this.mediaRequestsAborted=0;this.mediaRequestsTimedout=0;this.mediaRequestsErrored=0;this.mediaTransferDuration=0;this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.trigger("dispose");this.state="DISPOSED";this.pause();this.abort_();if(this.sourceUpdater_){this.sourceUpdater_.dispose()}this.resetStats_();if(this.captionParser_){this.captionParser_.reset()}if(this.checkBufferTimeout_){be.clearTimeout(this.checkBufferTimeout_)}if(this.syncController_&&this.triggerSyncInfoUpdate_){this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_)}this.off()}},{key:"abort",value:function(){if("WAITING"!==this.state){if(this.pendingSegment_){this.pendingSegment_=null}return}this.abort_();this.state="READY";if(!this.paused()){this.monitorBuffer_()}}},{key:"abort_",value:function(){if(this.pendingSegment_){this.pendingSegment_.abortRequests()}this.pendingSegment_=null}},{key:"error",value:function(e){if("undefined"!=typeof e){this.error_=e}this.pendingSegment_=null;return this.error_}},{key:"endOfStream",value:function(){this.ended_=!0;this.pause();this.trigger("ended")}},{key:"buffered_",value:function(){if(!this.sourceUpdater_){return t.createTimeRanges()}return this.sourceUpdater_.buffered()}},{key:"initSegment",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1;if(!e){return null}var a=Ut(e),i=this.initSegments_[a];if(t&&!i&&e.bytes){this.initSegments_[a]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,timescales:e.timescales,videoTrackIds:e.videoTrackIds}}return i||e}},{key:"segmentKey",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1;if(!e){return null}var a=Rt(e),i=this.keyCache_[a];if(this.cacheEncryptionKeys_&&t&&!i&&e.bytes){this.keyCache_[a]=i={resolvedUri:e.resolvedUri,bytes:e.bytes}}var n={resolvedUri:(i||e).resolvedUri};if(i){n.bytes=i.bytes}return n}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){this.monitorBuffer_();if(!this.playlist_){return}this.syncController_.setDateTimeMapping(this.playlist_);if("INIT"===this.state&&this.couldBeginLoading_()){return this.init_()}if(!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state){return}this.state="READY"}},{key:"init_",value:function(){this.state="READY";this.sourceUpdater_=new ir(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_);this.resetEverything();return this.monitorBuffer_()}},{key:"playlist",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(!e){return}var a=this.playlist_,i=this.pendingSegment_;this.playlist_=e;this.xhrOptions_=t;if("INIT"===this.state){e.syncInfo={mediaSequence:e.mediaSequence,time:0}}var n=null;if(a){if(a.id){n=a.id}else if(a.uri){n=a.uri}}this.logger_("playlist update ["+n+" => "+(e.id||e.uri)+"]");this.trigger("syncinfoupdate");if("INIT"===this.state&&this.couldBeginLoading_()){return this.init_()}if(!a||a.uri!==e.uri){if(null!==this.mediaIndex){this.resyncLoader()}return}var r=e.mediaSequence-a.mediaSequence;this.logger_("live window shift ["+r+"]");if(null!==this.mediaIndex){this.mediaIndex-=r}if(i){i.mediaIndex-=r;if(0<=i.mediaIndex){i.segment=e.segments[i.mediaIndex]}}this.syncController_.saveExpiredSegmentInfo(a,e)}},{key:"pause",value:function(){if(this.checkBufferTimeout_){be.clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=null}}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e,t){if(this.mimeType_){return}this.mimeType_=e;this.sourceBufferEmitter_=t;if("INIT"===this.state&&this.couldBeginLoading_()){this.init_()}}},{key:"resetEverything",value:function(e){this.ended_=!1;this.resetLoader();this.remove(0,1/0,e);if(this.captionParser_){this.captionParser_.clearAllCaptions()}this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1;this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null;this.syncPoint_=null;this.abort()}},{key:"remove",value:function(e,t,a){if(t===1/0){t=this.duration_()}if(this.sourceUpdater_){this.sourceUpdater_.remove(e,t,a)}ta(e,t,this.segmentMetadataTrack_);if(this.inbandTextTracks_){for(var i in this.inbandTextTracks_){ta(e,t,this.inbandTextTracks_[i])}}}},{key:"monitorBuffer_",value:function(){if(this.checkBufferTimeout_){be.clearTimeout(this.checkBufferTimeout_)}this.checkBufferTimeout_=be.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){if("READY"===this.state){this.fillBuffer_()}if(this.checkBufferTimeout_){be.clearTimeout(this.checkBufferTimeout_)}this.checkBufferTimeout_=be.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function(){if(this.sourceUpdater_.updating()){return}if(!this.syncPoint_){this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_())}var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(!e){return}if(this.isEndOfStream_(e.mediaIndex)){this.endOfStream();return}if(e.mediaIndex===this.playlist_.segments.length-1&&"ended"===this.mediaSource_.readyState&&!this.seeking_()){return}if(e.timeline!==this.currentTimeline_){this.syncController_.reset();e.timestampOffset=e.startOfSegment;if(this.captionParser_){this.captionParser_.clearAllCaptions()}}this.loadSegment_(e)}},{key:"isEndOfStream_",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.playlist_;return $r(t,this.mediaSource_,e)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function(e,t,a,i,n,r){var s=0,d=void 0;if(e.length){s=e.end(e.length-1)}var o=Math.max(0,s-n);if(!t.segments.length){return null}if(o>=this.goalBufferLength_()){return null}if(!i&&1<=o){return null}if(null===r){a=this.getSyncSegmentCandidate_(t);return this.generateSegmentInfo_(t,a,null,!0)}if(null!==a){t.segments[a];d=s;return this.generateSegmentInfo_(t,a+1,d,!1)}if(this.fetchAtBuffer_){var l=ut.getMediaInfoForTime(t,s,r.segmentIndex,r.time);a=l.mediaIndex;d=l.startTime}else{var u=ut.getMediaInfoForTime(t,n,r.segmentIndex,r.time);a=u.mediaIndex;d=u.startTime}return this.generateSegmentInfo_(t,a,d,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(-1===this.currentTimeline_){return 0}var a=e.segments.map(function(e,t){return{timeline:e.timeline,segmentIndex:t}}).filter(function(e){return e.timeline===t.currentTimeline_});if(a.length){return a[Math.min(a.length-1,1)].segmentIndex}return Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,a,i){if(0>t||t>=e.segments.length){return null}var n=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:n.resolvedUri,mediaIndex:t,isSyncRequest:i,startOfSegment:a,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:n.timeline,duration:n.duration,segment:n}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH){return!1}if(1e3>Date.now()-(e.firstBytesReceivedAt||Date.now())){return!1}var t=this.currentTime_(),a=e.bandwidth,i=this.pendingSegment_.duration,n=ut.estimateSegmentRequestTime(i,a,this.playlist_,e.bytesReceived),r=Zt(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(n<=r){return!1}var s=Pr({master:this.hls_.playlists.master,currentTime:t,bandwidth:a,duration:this.duration_(),segmentDuration:i,timeUntilRebuffer:r,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!s){return}var d=n-r-s.rebufferingImpact,o=.5;if(r<=zt){o=1}if(!s.playlist||s.playlist.uri===this.playlist_.uri||d<o){return!1}this.bandwidth=s.playlist.attributes.BANDWIDTH*nr.BANDWIDTH_VARIANCE+1;this.abort();this.trigger("earlyabort");return!0}},{key:"handleProgress_",value:function(e,t){if(!this.pendingSegment_||t.requestId!==this.pendingSegment_.requestId||this.abortRequestEarly_(t.stats)){return}this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING";this.pendingSegment_=e;this.trimBackBuffer_(e);e.abortRequests=Ir(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(){var e=es(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);if(0<e){this.remove(0,e)}}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,a={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};if(t.key){var i=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);a.key=this.segmentKey(t.key);a.key.iv=i}if(t.map){a.map=this.initSegment(t.map)}return a}},{key:"segmentRequestFinished_",value:function(e,t){this.mediaRequests+=1;if(t.stats){this.mediaBytesTransferred+=t.stats.bytesReceived;this.mediaTransferDuration+=t.stats.roundTripTime}if(!this.pendingSegment_){this.mediaRequestsAborted+=1;return}if(t.requestId!==this.pendingSegment_.requestId){return}if(e){this.pendingSegment_=null;this.state="READY";if(e.code===cr.ABORTED){this.mediaRequestsAborted+=1;return}this.pause();if(e.code===cr.TIMEOUT){this.mediaRequestsTimedout+=1;this.bandwidth=1;this.roundTrip=NaN;this.trigger("bandwidthupdate");return}this.mediaRequestsErrored+=1;this.error(e);this.trigger("error");return}this.bandwidth=t.stats.bandwidth;this.roundTrip=t.stats.roundTripTime;if(t.map){t.map=this.initSegment(t.map,!0)}if(t.key){this.segmentKey(t.key,!0)}this.processSegmentResponse_(t)}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes;if(e.map){t.segment.map.bytes=e.map.bytes}t.endOfAllRequests=e.endOfAllRequests;if(e.fmp4Captions){Or(this.inbandTextTracks_,this.hls_.tech_,e.captionStreams);xr({inbandTextTracks:this.inbandTextTracks_,captionArray:e.fmp4Captions,timestampOffset:0});if(this.captionParser_){this.captionParser_.clearParsedCaptions()}}this.handleSegment_()}},{key:"handleSegment_",value:function(){var e=this;if(!this.pendingSegment_){this.state="READY";return}var t=this.pendingSegment_,a=t.segment,i=this.syncController_.probeSegmentInfo(t);if("undefined"==typeof this.startingMedia_&&i&&(i.containsAudio||i.containsVideo)){this.startingMedia_={containsAudio:i.containsAudio,containsVideo:i.containsVideo}}var n=Jr(this.loaderType_,this.startingMedia_,i);if(n){this.error({message:n,blacklistDuration:1/0});this.trigger("error");return}if(t.isSyncRequest){this.trigger("syncinfoupdate");this.pendingSegment_=null;this.state="READY";return}if(null!==t.timestampOffset&&t.timestampOffset!==this.sourceUpdater_.timestampOffset()){if(i&&i.segmentTimestampInfo){var r=i.segmentTimestampInfo[0].ptsTime,s=i.segmentTimestampInfo[0].dtsTime;t.timestampOffset-=r-s}this.sourceUpdater_.timestampOffset(t.timestampOffset);this.trigger("timestampoffset")}var d=this.syncController_.mappingForTimeline(t.timeline);if(null!==d){this.trigger({type:"segmenttimemapping",mapping:d})}this.state="APPENDING";if(a.map){var o=Ut(a.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==o){var l=this.initSegment(a.map);this.sourceUpdater_.appendBuffer({bytes:l.bytes},function(){e.activeInitSegmentId_=o})}}t.byteLength=t.bytes.byteLength;if("number"==typeof a.start&&"number"==typeof a.end){this.mediaSecondsLoaded+=a.end-a.start}else{this.mediaSecondsLoaded+=a.duration}this.logger_(ts(t));this.sourceUpdater_.appendBuffer({bytes:t.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,t.requestId)},this.handleUpdateEnd_.bind(this))}},{key:"handleVideoSegmentTimingInfo_",value:function(e,t){if(!this.pendingSegment_||e!==this.pendingSegment_.requestId){return}var a=this.pendingSegment_.segment;if(!a.videoTimingInfo){a.videoTimingInfo={}}a.videoTimingInfo.transmuxerPrependedSeconds=t.videoSegmentTimingInfo.prependedContentDuration||0;a.videoTimingInfo.transmuxedPresentationStart=t.videoSegmentTimingInfo.start.presentation;a.videoTimingInfo.transmuxedPresentationEnd=t.videoSegmentTimingInfo.end.presentation;a.videoTimingInfo.baseMediaDecodeTime=t.videoSegmentTimingInfo.baseMediaDecodeTime}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_){this.state="READY";if(!this.paused()){this.monitorBuffer_()}return}var e=this.pendingSegment_,t=e.segment,a=null!==this.mediaIndex;this.pendingSegment_=null;this.recordThroughput_(e);this.addSegmentMetadataCue_(e);this.state="READY";this.mediaIndex=e.mediaIndex;this.fetchAtBuffer_=!0;this.currentTimeline_=e.timeline;this.trigger("syncinfoupdate");if(t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration){this.resetEverything();return}if(a){this.trigger("bandwidthupdate")}this.trigger("progress");if(this.isEndOfStream_(e.mediaIndex+1,e.playlist)){this.endOfStream()}if(!this.paused()){this.monitorBuffer_()}}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,a=Date.now()-e.endOfAllRequests+1,i=Math.floor(1e3*(8*(e.byteLength/a)));this.throughput.rate+=(i-t)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(e){if(!this.segmentMetadataTrack_){return}var t=e.segment,a=t.start,i=t.end;if(!Zr(a)||!Zr(i)){return}ta(a,i,this.segmentMetadataTrack_);var n=be.WebKitDataCue||be.VTTCue,r={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:a,end:i},s=JSON.stringify(r),d=new n(a,i,s);d.value=r;this.segmentMetadataTrack_.addCue(d)}}]);return a}(t.EventTarget),is=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))},ns=new Uint8Array(["\n","\n"].map(function(e){return e.charCodeAt(0)})),rs=function(e){xe(a,e);function a(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};De(this,a);var i=Ue(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t));i.mediaSource_=null;i.subtitlesTrack_=null;i.featuresNativeTextTracks_=e.featuresNativeTextTracks;return i}Pe(a,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length){return t.createTimeRanges()}var e=this.subtitlesTrack_.cues,a=e[0].startTime,i=e[e.length-1].startTime;return t.createTimeRanges([[a,i]])}},{key:"initSegment",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1;if(!e){return null}var a=Ut(e),i=this.initSegments_[a];if(t&&!i&&e.bytes){var n=ns.byteLength+e.bytes.byteLength,r=new Uint8Array(n);r.set(e.bytes);r.set(ns,e.bytes.byteLength);this.initSegments_[a]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:r}}return i||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){this.state="READY";this.resetEverything();return this.monitorBuffer_()}},{key:"track",value:function(e){if("undefined"==typeof e){return this.subtitlesTrack_}this.subtitlesTrack_=e;if("INIT"===this.state&&this.couldBeginLoading_()){this.init_()}return this.subtitlesTrack_}},{key:"remove",value:function(e,t){ta(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;if(!this.syncPoint_){this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_())}var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);t=this.skipEmptySegments_(t);if(!t){return}if(null===this.syncController_.timestampOffsetForTimeline(t.timeline)){var a=function(){e.state="READY";if(!e.paused()){e.monitorBuffer_()}};this.syncController_.one("timestampoffset",a);this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(t)}},{key:"skipEmptySegments_",value:function(e){while(e&&e.segment.empty){e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest)}return e}},{key:"handleSegment_",value:function(){var e=this;if(!this.pendingSegment_||!this.subtitlesTrack_){this.state="READY";return}this.state="APPENDING";var t=this.pendingSegment_,a=t.segment;if("function"!=typeof be.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var i=void 0,n=function(){e.subtitlesTrack_.tech_.off("vttjsloaded",i);e.error({message:"Error loading vtt.js"});e.state="READY";e.pause();e.trigger("error")};i=function(){e.subtitlesTrack_.tech_.off("vttjserror",n);e.handleSegment_()};this.state="WAITING_ON_VTTJS";this.subtitlesTrack_.tech_.one("vttjsloaded",i);this.subtitlesTrack_.tech_.one("vttjserror",n);return}a.requested=!0;try{this.parseVTTCues_(t)}catch(t){this.error({message:t.message});this.state="READY";this.pause();return this.trigger("error")}this.updateTimeMapping_(t,this.syncController_.timelines[t.timeline],this.playlist_);if(t.isSyncRequest){this.trigger("syncinfoupdate");this.pendingSegment_=null;this.state="READY";return}t.byteLength=t.bytes.byteLength;this.mediaSecondsLoaded+=a.duration;if(t.cues.length){this.remove(t.cues[0].endTime,t.cues[t.cues.length-1].endTime)}t.cues.forEach(function(t){e.subtitlesTrack_.addCue(e.featuresNativeTextTracks_?new be.VTTCue(t.startTime,t.endTime,t.text):t)});this.handleUpdateEnd_()}},{key:"parseVTTCues_",value:function(e){var a=void 0,i=!1;if("function"==typeof be.TextDecoder){a=new be.TextDecoder("utf8")}else{a=be.WebVTT.StringDecoder();i=!0}var n=new be.WebVTT.Parser(be,be.vttjs,a);e.cues=[];e.timestampmap={MPEGTS:0,LOCAL:0};n.oncue=e.cues.push.bind(e.cues);n.ontimestampmap=function(t){return e.timestampmap=t};n.onparsingerror=function(e){t.log.warn("Error encountered when parsing cues: "+e.message)};if(e.segment.map){var r=e.segment.map.bytes;if(i){r=is(r)}n.parse(r)}var s=e.bytes;if(i){s=is(s)}n.parse(s);n.flush()}},{key:"updateTimeMapping_",value:function(e,t,a){var i=e.segment;if(!t){return}if(!e.cues.length){i.empty=!0;return}var n=e.timestampmap,r=n.MPEGTS/9e4-n.LOCAL+t.mapping;e.cues.forEach(function(e){e.startTime+=r;e.endTime+=r});if(!a.syncInfo){var s=e.cues[0].startTime,d=e.cues[e.cues.length-1].startTime;a.syncInfo={mediaSequence:a.mediaSequence+e.mediaIndex,time:Math.min(s,d-i.duration)}}}}]);return a}(as),ss=function(e,t){for(var a=e.cues,n=0,r;n<a.length;n++){r=a[n];if(t>=r.adStartTime&&t<=r.adEndTime){return r}}return null},ds=function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;if(!e.segments){return}for(var n=a,r=void 0,s=0,d;s<e.segments.length;s++){d=e.segments[s];if(!r){r=ss(t,n+d.duration/2)}if(r){if("cueIn"in d){r.endTime=n;r.adEndTime=n;n+=d.duration;r=null;continue}if(n<r.endTime){n+=d.duration;continue}r.endTime+=d.duration}else{if("cueOut"in d){r=new be.VTTCue(n,n+d.duration,d.cueOut);r.adStartTime=n;r.adEndTime=n+parseFloat(d.cueOut);t.addCue(r)}if("cueOutCont"in d){var o=void 0,l=void 0,u=d.cueOutCont.split("/").map(parseFloat),p=Re(u,2);o=p[0];l=p[1];r=new be.VTTCue(n,n+d.duration,"");r.adStartTime=n-o;r.adEndTime=r.adStartTime+l;t.addCue(r)}}n+=d.duration}},os={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},ls="shared",us=function(e,t){var a=1;if(e>t){a=-1}while(Math.abs(t-e)>4294967296){e+=a*8589934592}return e},ps=function e(t){var a,i;e.prototype.init.call(this);this.type_=t||ls;this.push=function(e){if(this.type_!==ls&&e.type!==this.type_){return}if(i===void 0){i=e.dts}e.dts=us(e.dts,i);e.pts=us(e.pts,i);a=e.dts;this.trigger("data",e)};this.flush=function(){i=a;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.discontinuity=function(){i=void 0;a=void 0};this.reset=function(){this.discontinuity();this.trigger("reset")}};ps.prototype=new Nr;var ms=function(e){var t=31&e[1];t<<=8;t|=e[2];return t},cs=function(e){return!!(64&e[1])},gs=function(e){var t=0;if(1<(48&e[3])>>>4){t+=e[4]+1}return t},ys=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null;}},fs=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],_s=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},hs=function(e,t,a){var n,r="";for(n=t;n<a;n++){r+="%"+("00"+e[n].toString(16)).slice(-2)}return r},bs=function(e,t,a){return unescape(hs(e,t,a))},Ts=9e4,Ss,vs,ks,Is,Es,Ls,Cs;Ss=function(e){return e*Ts};vs=function(e,t){return e*t};ks=function(e){return e/Ts};Is=function(e,t){return e/t};Es=function(e,t){return Ss(Is(e,t))};Ls=function(e,t){return vs(ks(e),t)};Cs=function(e,t,a){return ks(a?e:e-t)};var Ds={ONE_SECOND_IN_TS:Ts,secondsToVideoTs:Ss,secondsToAudioTs:vs,videoTsToSeconds:ks,audioTsToSeconds:Is,audioTsToVideoTs:Es,videoTsToAudioTs:Ls,metadataTsToSeconds:Cs},Ps={TimestampRolloverStream:ps,handleRollover:us}.handleRollover,Os={};Os.ts={parseType:function(e,t){var a=ms(e);if(0===a){return"pat"}else if(a===t){return"pmt"}else if(t){return"pes"}return null},parsePat:function(e){var t=cs(e),a=4+gs(e);if(t){a+=e[a]+1}return(31&e[a+10])<<8|e[a+11]},parsePmt:function(e){var t={},a=cs(e),n=4+gs(e);if(a){n+=e[n]+1}if(!(1&e[n+5])){return}var r,s,d;r=(15&e[n+1])<<8|e[n+2];s=3+r-4;d=(15&e[n+10])<<8|e[n+11];var o=12+d;while(o<s){var l=n+o;t[(31&e[l+1])<<8|e[l+2]]=e[l];o+=((15&e[l+3])<<8|e[l+4])+5}return t},parsePayloadUnitStartIndicator:cs,parsePesType:function(e,t){var a=ms(e),i=t[a];switch(i){case os.H264_STREAM_TYPE:return"video";case os.ADTS_STREAM_TYPE:return"audio";case os.METADATA_STREAM_TYPE:return"timed-metadata";default:return null;}},parsePesTime:function(e){var t=cs(e);if(!t){return null}var a=4+gs(e);if(a>=e.byteLength){return null}var i=null,n;n=e[a+7];if(192&n){i={};i.pts=(14&e[a+9])<<27|(255&e[a+10])<<20|(254&e[a+11])<<12|(255&e[a+12])<<5|(254&e[a+13])>>>3;i.pts*=4;i.pts+=(6&e[a+13])>>>1;i.dts=i.pts;if(64&n){i.dts=(14&e[a+14])<<27|(255&e[a+15])<<20|(254&e[a+16])<<12|(255&e[a+17])<<5|(254&e[a+18])>>>3;i.dts*=4;i.dts+=(6&e[a+18])>>>1}}return i},videoPacketContainsKeyFrame:function(e){var t=4+gs(e),a=e.subarray(t),i=0,n=0,r=!1,s;for(;n<a.byteLength-3;n++){if(1===a[n+2]){i=n+5;break}}while(i<a.byteLength){switch(a[i]){case 0:if(0!==a[i-1]){i+=2;break}else if(0!==a[i-2]){i++;break}if(n+3!==i-2){s=ys(31&a[n+3]);if("slice_layer_without_partitioning_rbsp_idr"===s){r=!0}}do{i++}while(1!==a[i]&&i<a.length);n=i-2;i+=3;break;case 1:if(0!==a[i-1]||0!==a[i-2]){i+=3;break}s=ys(31&a[n+3]);if("slice_layer_without_partitioning_rbsp_idr"===s){r=!0}n=i-2;i+=3;break;default:i+=3;break;}}a=a.subarray(n);i-=n;n=0;if(a&&3<a.byteLength){s=ys(31&a[n+3]);if("slice_layer_without_partitioning_rbsp_idr"===s){r=!0}}return r}};Os.aac={isLikelyAacData:function(e){if(e[0]===73&&e[1]===68&&e[2]===51){return!0}return!1},parseId3TagSize:function(e,t){var a=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],i=e[t+5];if((16&i)>>4){return a+20}return a+10},parseAdtsSize:function(e,t){var a=(224&e[t+5])>>5,i=e[t+4]<<3,n=e[t+3]&6144;return n|i|a},parseType:function(e,t){if(e[t]===73&&e[t+1]===68&&e[t+2]===51){return"timed-metadata"}else if(e[t]&!0&&240==(240&e[t+1])){return"audio"}return null},parseSampleRate:function(e){var t=0;while(t+5<e.length){if(255!==e[t]||240!=(246&e[t+1])){t++;continue}return fs[(60&e[t+2])>>>2]}return null},parseAacTimestamp:function(e){var t,a,n,r;t=10;if(64&e[5]){t+=4;t+=_s(e.subarray(10,14))}do{a=_s(e.subarray(t+4,t+8));if(1>a){return null}r=String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3]);if("PRIV"===r){n=e.subarray(t+10,t+a+10);for(var s=0;s<n.byteLength;s++){if(0===n[s]){var o=bs(n,0,s);if("com.apple.streaming.transportStreamTimestamp"===o){var l=n.subarray(s+1),d=(1&l[3])<<30|l[4]<<22|l[5]<<14|l[6]<<6|l[7]>>>2;d*=4;d+=3&l[7];return d}break}}}t+=10;t+=a}while(t<e.byteLength);return null}};var xs=Ds.ONE_SECOND_IN_TS,Us=188,Rs=71,As=function(e,t){var a=0,i=Us,n,r;while(i<e.byteLength){if(e[a]===Rs&&e[i]===Rs){n=e.subarray(a,i);r=Os.ts.parseType(n,t.pid);switch(r){case"pat":if(!t.pid){t.pid=Os.ts.parsePat(n)}break;case"pmt":if(!t.table){t.table=Os.ts.parsePmt(n)}break;default:break;}if(t.pid&&t.table){return}a+=Us;i+=Us;continue}a++;i++}},Ns=function(e,t,a){var i=0,n=Us,r,s,d,o,l,u=!1;while(n<=e.byteLength){if(e[i]===Rs&&(e[n]===Rs||n===e.byteLength)){r=e.subarray(i,n);s=Os.ts.parseType(r,t.pid);switch(s){case"pes":d=Os.ts.parsePesType(r,t.table);o=Os.ts.parsePayloadUnitStartIndicator(r);if("audio"===d&&o){l=Os.ts.parsePesTime(r);if(l){l.type="audio";a.audio.push(l);u=!0}}break;default:break;}if(u){break}i+=Us;n+=Us;continue}i++;n++}n=e.byteLength;i=n-Us;u=!1;while(0<=i){if(e[i]===Rs&&(e[n]===Rs||n===e.byteLength)){r=e.subarray(i,n);s=Os.ts.parseType(r,t.pid);switch(s){case"pes":d=Os.ts.parsePesType(r,t.table);o=Os.ts.parsePayloadUnitStartIndicator(r);if("audio"===d&&o){l=Os.ts.parsePesTime(r);if(l){l.type="audio";a.audio.push(l);u=!0}}break;default:break;}if(u){break}i-=Us;n-=Us;continue}i--;n--}},ws=function(e,t,a){var n=0,r=Us,s,d,o,l,u,p,m,c,g=!1,y={data:[],size:0};while(r<e.byteLength){if(e[n]===Rs&&e[r]===Rs){s=e.subarray(n,r);d=Os.ts.parseType(s,t.pid);switch(d){case"pes":o=Os.ts.parsePesType(s,t.table);l=Os.ts.parsePayloadUnitStartIndicator(s);if("video"===o){if(l&&!g){u=Os.ts.parsePesTime(s);if(u){u.type="video";a.video.push(u);g=!0}}if(!a.firstKeyFrame){if(l){if(0!==y.size){p=new Uint8Array(y.size);m=0;while(y.data.length){c=y.data.shift();p.set(c,m);m+=c.byteLength}if(Os.ts.videoPacketContainsKeyFrame(p)){var f=Os.ts.parsePesTime(p);if(f){a.firstKeyFrame=f;a.firstKeyFrame.type="video"}else{console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}}y.size=0}}y.data.push(s);y.size+=s.byteLength}}break;default:break;}if(g&&a.firstKeyFrame){break}n+=Us;r+=Us;continue}n++;r++}r=e.byteLength;n=r-Us;g=!1;while(0<=n){if(e[n]===Rs&&e[r]===Rs){s=e.subarray(n,r);d=Os.ts.parseType(s,t.pid);switch(d){case"pes":o=Os.ts.parsePesType(s,t.table);l=Os.ts.parsePayloadUnitStartIndicator(s);if("video"===o&&l){u=Os.ts.parsePesTime(s);if(u){u.type="video";a.video.push(u);g=!0}}break;default:break;}if(g){break}n-=Us;r-=Us;continue}n--;r--}},Bs=function(e,t){if(e.audio&&e.audio.length){var a=t;if("undefined"==typeof a){a=e.audio[0].dts}e.audio.forEach(function(e){e.dts=Ps(e.dts,a);e.pts=Ps(e.pts,a);e.dtsTime=e.dts/xs;e.ptsTime=e.pts/xs})}if(e.video&&e.video.length){var i=t;if("undefined"==typeof i){i=e.video[0].dts}e.video.forEach(function(e){e.dts=Ps(e.dts,i);e.pts=Ps(e.pts,i);e.dtsTime=e.dts/xs;e.ptsTime=e.pts/xs});if(e.firstKeyFrame){var n=e.firstKeyFrame;n.dts=Ps(n.dts,i);n.pts=Ps(n.pts,i);n.dtsTime=n.dts/xs;n.ptsTime=n.dts/xs}}},Ms=function(e){var t=!1,a=0,i=null,n=null,r=0,s=0,d;while(3<=e.length-s){var o=Os.aac.parseType(e,s);switch(o){case"timed-metadata":if(10>e.length-s){t=!0;break}r=Os.aac.parseId3TagSize(e,s);if(r>e.length){t=!0;break}if(null===n){d=e.subarray(s,s+r);n=Os.aac.parseAacTimestamp(d)}s+=r;break;case"audio":if(7>e.length-s){t=!0;break}r=Os.aac.parseAdtsSize(e,s);if(r>e.length){t=!0;break}if(null===i){d=e.subarray(s,s+r);i=Os.aac.parseSampleRate(d)}a++;s+=r;break;default:s++;break;}if(t){return null}}if(null===i||null===n){return null}var l=xs/i,u={audio:[{type:"audio",dts:n,pts:n},{type:"audio",dts:n+1024*a*l,pts:n+1024*a*l}]};return u},qs=function(e){var t={pid:null,table:null},a={};As(e,t);for(var i in t.table){if(t.table.hasOwnProperty(i)){var n=t.table[i];switch(n){case os.H264_STREAM_TYPE:a.video=[];ws(e,t,a);if(0===a.video.length){delete a.video}break;case os.ADTS_STREAM_TYPE:a.audio=[];Ns(e,t,a);if(0===a.audio.length){delete a.audio}break;default:break;}}}return a},Fs={inspect:function(e,t){var a=Os.aac.isLikelyAacData(e),i;if(a){i=Ms(e)}else{i=qs(e)}if(!i||!i.audio&&!i.video){return null}Bs(i,t);return i},parseAudioPes_:Ns}.inspect,Hs=[{name:"VOD",run:function(e,t,a){if(a!==1/0){return{time:0,segmentIndex:0}}return null}},{name:"ProgramDateTime",run:function(e,t,a,n,r){if(!e.datetimeToDisplayTime){return null}var s=t.segments||[],d=null,o=null;r=r||0;for(var l=0,u;l<s.length;l++){u=s[l];if(u.dateTimeObject){var p=u.dateTimeObject.getTime()/1e3,m=p+e.datetimeToDisplayTime,c=Math.abs(r-m);if(null!==o&&(0===c||o<c)){break}o=c;d={time:m,segmentIndex:l}}}return d}},{name:"Segment",run:function(e,t,a,n,r){var s=t.segments||[],d=null,o=null;r=r||0;for(var l=0,u;l<s.length;l++){u=s[l];if(u.timeline===n&&"undefined"!=typeof u.start){var p=Math.abs(r-u.start);if(null!==o&&o<p){break}if(!d||null===o||o>=p){o=p;d={time:u.start,segmentIndex:l}}}}return d}},{name:"Discontinuity",run:function(e,t,a,n,r){var s=null;r=r||0;if(t.discontinuityStarts&&t.discontinuityStarts.length){for(var d=null,o=0;o<t.discontinuityStarts.length;o++){var l=t.discontinuityStarts[o],u=t.discontinuitySequence+o+1,p=e.discontinuities[u];if(p){var m=Math.abs(r-p.time);if(null!==d&&d<m){break}if(!s||null===d||d>=m){d=m;s={time:p.time,segmentIndex:l}}}}}return s}},{name:"Playlist",run:function(e,t){if(t.syncInfo){var a={time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence};return a}return null}}],Gs=function(e){xe(t,e);function t(){De(this,t);var e=Ue(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e.inspectCache_=void 0;e.timelines=[];e.discontinuities=[];e.datetimeToDisplayTime=null;e.logger_=ar("SyncController");return e}Pe(t,[{key:"getSyncPoint",value:function(e,t,a,i){var n=this.runStrategies_(e,t,a,i);if(!n.length){return null}return this.selectSyncPoint_(n,{key:"time",value:i})}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments){return null}var a=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!a.length){return null}var i=this.selectSyncPoint_(a,{key:"segmentIndex",value:0});if(0<i.segmentIndex){i.time*=-1}return Math.abs(i.time+$e(e,i.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,a,n){for(var r=[],s=0;s<Hs.length;s++){var d=Hs[s],o=d.run(this,e,t,a,n);if(o){o.strategy=d.name;r.push({strategy:d.name,syncPoint:o})}}return r}},{key:"selectSyncPoint_",value:function(e,t){for(var a=e[0].syncPoint,n=Math.abs(e[0].syncPoint[t.key]-t.value),r=e[0].strategy,s=1,d;s<e.length;s++){d=Math.abs(e[s].syncPoint[t.key]-t.value);if(d<n){n=d;a=e[s].syncPoint;r=e[s].strategy}}this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy"+(" ["+r+"]: [time:"+a.time+",")+(" segmentIndex:"+a.segmentIndex+"]"));return a}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var a=t.mediaSequence-e.mediaSequence,n=a-1,r;0<=n;n--){r=e.segments[n];if(r&&"undefined"!=typeof r.start){t.syncInfo={mediaSequence:e.mediaSequence+n,time:r.start};this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+","+(" mediaSequence: "+t.syncInfo.mediaSequence+"]"));this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t=e.segment,a=e.playlist,i=void 0;if(t.map){i=this.probeMp4Segment_(e)}else{i=this.probeTsSegment_(e)}if(i){if(this.calculateSegmentTimeMapping_(e,i)){this.saveDiscontinuitySyncInfo_(e);if(!a.syncInfo){a.syncInfo={mediaSequence:a.mediaSequence+e.mediaIndex,time:t.start}}}}return i}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,a=mr.timescale(t.map.bytes),i=mr.compositionStartTime(a,e.bytes);if(null!==e.timestampOffset){e.timestampOffset-=i}return{start:i,end:i+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=Fs(e.bytes,this.inspectCache_),a=void 0,i=void 0,n=void 0;if(!t){return null}if(t.video&&2===t.video.length){this.inspectCache_=t.video[1].dts;a=t.video[0].dtsTime;i=t.video[1].dtsTime;n=t.video}else if(t.audio&&2===t.audio.length){this.inspectCache_=t.audio[1].dts;a=t.audio[0].dtsTime;i=t.audio[1].dtsTime;n=t.audio}var r={segmentTimestampInfo:n,start:a,end:i,containsVideo:t.video&&2===t.video.length,containsAudio:t.audio&&2===t.audio.length};return r}},{key:"timestampOffsetForTimeline",value:function(e){if("undefined"==typeof this.timelines[e]){return null}return this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){if("undefined"==typeof this.timelines[e]){return null}return this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var a=e.segment,i=this.timelines[e.timeline];if(null!==e.timestampOffset){i={time:e.startOfSegment,mapping:e.startOfSegment-t.start};this.timelines[e.timeline]=i;this.trigger("timestampoffset");this.logger_("time mapping for timeline "+e.timeline+": "+("[time: "+i.time+"] [mapping: "+i.mapping+"]"));a.start=e.startOfSegment;a.end=t.end+i.mapping}else if(i){a.start=t.start+i.mapping;a.end=t.end+i.mapping}else{return!1}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,a=e.segment;if(a.discontinuity){this.discontinuities[a.timeline]={time:a.start,accuracy:0}}else if(t.discontinuityStarts&&t.discontinuityStarts.length){for(var n=0;n<t.discontinuityStarts.length;n++){var r=t.discontinuityStarts[n],s=t.discontinuitySequence+n+1,d=r-e.mediaIndex,o=Math.abs(d);if(!this.discontinuities[s]||this.discontinuities[s].accuracy>o){var l=void 0;if(0>d){l=a.start-$e(t,e.mediaIndex,r)}else{l=a.end+$e(t,e.mediaIndex+1,r)}this.discontinuities[s]={time:l,accuracy:o}}}}}},{key:"dispose",value:function(){this.trigger("dispose");this.off()}}]);return t}(t.EventTarget),Vs=new o("./decrypter-worker.worker.js",function(){var e=this,t=function(){function t(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var a=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}},i=function(){function e(e,t){for(var a=0,n;a<t.length;a++){n=t[a];n.enumerable=n.enumerable||!1;n.configurable=!0;if("value"in n)n.writable=!0;Object.defineProperty(e,n.key,n)}}return function(t,a,i){if(a)e(t.prototype,a);if(i)e(t,i);return t}}(),n=function(e,t){if("function"!=typeof t&&null!==t){throw new TypeError("Super expression must either be null or a function, not "+_typeof(t))}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t},r=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&("object"===_typeof(t)||"function"==typeof t)?t:e},s=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],a=e[1],n=t[4],r=a[4],o=void 0,l=void 0,u=void 0,p=[],d=[],m=void 0,c=void 0,g=void 0,y=void 0,f=void 0,_=void 0;for(o=0;256>o;o++){d[(p[o]=o<<1^283*(o>>7))^o]=o}for(l=u=0;!n[l];l^=m||1,u=d[u]||1){y=u^u<<1^u<<2^u<<3^u<<4;y=99^(y>>8^255&y);n[l]=y;r[y]=l;g=p[c=p[m=p[l]]];_=16843009*g^65537*c^257*m^16843008*l;f=257*p[y]^16843008*y;for(o=0;4>o;o++){t[o][l]=f=f<<24^f>>>8;a[o][y]=_=_<<24^_>>>8}}for(o=0;5>o;o++){t[o]=t[o].slice(0);a[o]=a[o].slice(0)}return e},d=null,o=function(){function e(t){a(this,e);if(!d){d=s()}this._tables=[[d[0][0].slice(),d[0][1].slice(),d[0][2].slice(),d[0][3].slice(),d[0][4].slice()],[d[1][0].slice(),d[1][1].slice(),d[1][2].slice(),d[1][3].slice(),d[1][4].slice()]];var n=void 0,r=void 0,o=void 0,l=void 0,u=void 0,p=this._tables[0][4],m=this._tables[1],c=t.length,g=1;if(4!==c&&6!==c&&8!==c){throw new Error("Invalid aes key size")}l=t.slice(0);u=[];this._key=[l,u];for(n=c;n<4*c+28;n++){o=l[n-1];if(0==n%c||8===c&&4==n%c){o=p[o>>>24]<<24^p[255&o>>16]<<16^p[255&o>>8]<<8^p[255&o];if(0==n%c){o=o<<8^o>>>24^g<<24;g=g<<1^283*(g>>7)}}l[n]=l[n-c]^o}for(r=0;n;r++,n--){o=l[3&r?n:n-4];if(4>=n||4>r){u[r]=o}else{u[r]=m[0][p[o>>>24]]^m[1][p[255&o>>16]]^m[2][p[255&o>>8]]^m[3][p[255&o]]}}}e.prototype.decrypt=function(e,t,n,r,s,o){var l=this._key[1],u=e^l[0],p=r^l[1],m=n^l[2],g=t^l[3],y=void 0,f=void 0,_=void 0,h=l.length/4-2,T=void 0,S=4,v=this._tables[1],k=v[0],I=v[1],E=v[2],L=v[3],C=v[4];for(T=0;T<h;T++){y=k[u>>>24]^I[255&p>>16]^E[255&m>>8]^L[255&g]^l[S];f=k[p>>>24]^I[255&m>>16]^E[255&g>>8]^L[255&u]^l[S+1];_=k[m>>>24]^I[255&g>>16]^E[255&u>>8]^L[255&p]^l[S+2];g=k[g>>>24]^I[255&u>>16]^E[255&p>>8]^L[255&m]^l[S+3];S+=4;u=y;p=f;m=_}for(T=0;4>T;T++){s[(3&-T)+o]=C[u>>>24]<<24^C[255&p>>16]<<16^C[255&m>>8]<<8^C[255&g]^l[S++];y=u;u=p;p=m;m=g;g=y}};return e}(),l=function(){function e(){a(this,e);this.listeners={}}e.prototype.on=function(e,t){if(!this.listeners[e]){this.listeners[e]=[]}this.listeners[e].push(t)};e.prototype.off=function(e,t){if(!this.listeners[e]){return!1}var a=this.listeners[e].indexOf(t);this.listeners[e].splice(a,1);return-1<a};e.prototype.trigger=function(e){var t=this.listeners[e];if(!t){return}if(2===arguments.length){for(var a=t.length,n=0;n<a;++n){t[n].call(this,arguments[1])}}else{for(var r=Array.prototype.slice.call(arguments,1),s=t.length,d=0;d<s;++d){t[d].apply(this,r)}}};e.prototype.dispose=function(){this.listeners={}};e.prototype.pipe=function(e){this.on("data",function(t){e.push(t)})};return e}(),u=function(e){n(t,e);function t(){a(this,t);var i=r(this,e.call(this,l));i.jobs=[];i.delay=1;i.timeout_=null;return i}t.prototype.processJob_=function(){this.jobs.shift()();if(this.jobs.length){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}else{this.timeout_=null}};t.prototype.push=function(e){this.jobs.push(e);if(!this.timeout_){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}};return t}(l),p=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},m=function(e,t,a){var i=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),n=new o(Array.prototype.slice.call(t)),r=new Uint8Array(e.byteLength),s=new Int32Array(r.buffer),d=void 0,l=void 0,u=void 0,m=void 0,c=void 0,g=void 0,y=void 0,f=void 0,_=void 0;d=a[0];l=a[1];u=a[2];m=a[3];for(_=0;_<i.length;_+=4){c=p(i[_]);g=p(i[_+1]);y=p(i[_+2]);f=p(i[_+3]);n.decrypt(c,g,y,f,s,_);s[_]=p(s[_]^d);s[_+1]=p(s[_+1]^l);s[_+2]=p(s[_+2]^u);s[_+3]=p(s[_+3]^m);d=c;l=g;u=y;m=f}return r},c=function(){function e(n,r,s,d){a(this,e);var o=e.STEP,l=new Int32Array(n.buffer),m=new Uint8Array(n.byteLength),c=0;this.asyncStream_=new u;this.asyncStream_.push(this.decryptChunk_(l.subarray(c,c+o),r,s,m));for(c=o;c<l.length;c+=o){s=new Uint32Array([p(l[c-4]),p(l[c-3]),p(l[c-2]),p(l[c-1])]);this.asyncStream_.push(this.decryptChunk_(l.subarray(c,c+o),r,s,m))}this.asyncStream_.push(function(){d(null,t(m))})}e.prototype.decryptChunk_=function(e,t,a,i){return function(){var n=m(e,t,a);i.set(n,e.byteOffset)}};i(e,null,[{key:"STEP",get:function(){return 32e3}}]);return e}(),g=function(e){var t={};Object.keys(e).forEach(function(a){var i=e[a];if(ArrayBuffer.isView(i)){t[a]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}}else{t[a]=i}});return t},y=new function(e){e.onmessage=function(t){var a=t.data,i=new Uint8Array(a.encrypted.bytes,a.encrypted.byteOffset,a.encrypted.byteLength),n=new Uint32Array(a.key.bytes,a.key.byteOffset,a.key.byteLength/4),r=new Uint32Array(a.iv.bytes,a.iv.byteOffset,a.iv.byteLength/4);new c(i,n,r,function(t,i){e.postMessage(g({source:a.source,decrypted:i}),[i.buffer])})}}(e);return y}()}),Ws=function(e){var t=e.default?"main":"alternative";if(e.characteristics&&0<=e.characteristics.indexOf("public.accessibility.describes-video")){t="main-desc"}return t},zs=function(e,t){e.abort();e.pause();if(t&&t.activePlaylistLoader){t.activePlaylistLoader.pause();t.activePlaylistLoader=null}},js=function(e,t){t.activePlaylistLoader=e;e.load()},Ys=function(e,t){return function(){var a=t.segmentLoaders,i=a[e],n=a.main,r=t.mediaTypes[e],s=r.activeTrack(),d=r.activeGroup(s),o=r.activePlaylistLoader;zs(i,r);if(!d){return}if(!d.playlistLoader){if(o){n.resetEverything()}return}i.resyncLoader();js(d.playlistLoader,r)}},Xs=function(e,t){return function(){var a=t.segmentLoaders,i=a[e],n=a.main,r=t.mediaTypes[e],s=r.activeTrack(),d=r.activeGroup(s),o=r.activePlaylistLoader;zs(i,r);if(!d){return}if(!d.playlistLoader){n.resetEverything();return}if(o===d.playlistLoader){js(d.playlistLoader,r);return}if(i.track){i.track(s)}i.resetEverything();js(d.playlistLoader,r)}},Ks={AUDIO:function(e,a){return function(){var i=a.segmentLoaders[e],n=a.mediaTypes[e],r=a.blacklistCurrentPlaylist;zs(i,n);var s=n.activeTrack(),d=n.activeGroup(),o=(d.filter(function(e){return e.default})[0]||d[0]).id,l=n.tracks[o];if(s===l){r({message:"Problem encountered loading the default audio track."});return}t.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(var u in n.tracks){n.tracks[u].enabled=n.tracks[u]===l}n.onTrackChanged()}},SUBTITLES:function(e,a){return function(){var i=a.segmentLoaders[e],n=a.mediaTypes[e];t.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");zs(i,n);var r=n.activeTrack();if(r){r.mode="disabled"}n.onTrackChanged()}}},Qs={AUDIO:function(e,t,a){if(!t){return}var i=a.tech,n=a.requestOptions,r=a.segmentLoaders[e];t.on("loadedmetadata",function(){var e=t.media();r.playlist(e,n);if(!i.paused()||e.endList&&"none"!==i.preload()){r.load()}});t.on("loadedplaylist",function(){r.playlist(t.media(),n);if(!i.paused()){r.load()}});t.on("error",Ks[e](e,a))},SUBTITLES:function(e,t,a){var i=a.tech,n=a.requestOptions,r=a.segmentLoaders[e],s=a.mediaTypes[e];t.on("loadedmetadata",function(){var e=t.media();r.playlist(e,n);r.track(s.activeTrack());if(!i.paused()||e.endList&&"none"!==i.preload()){r.load()}});t.on("loadedplaylist",function(){r.playlist(t.media(),n);if(!i.paused()){r.load()}});t.on("error",Ks[e](e,a))}},$s={AUDIO:function(e,a){var i=a.hls,n=a.sourceType,r=a.segmentLoaders[e],s=a.requestOptions,d=a.master.mediaGroups,o=a.mediaTypes[e],l=o.groups,u=o.tracks,p=a.masterPlaylistLoader;if(!d[e]||0===Object.keys(d[e]).length){d[e]={main:{default:{default:!0}}}}for(var m in d[e]){if(!l[m]){l[m]=[]}for(var c in d[e][m]){var g=d[e][m][c],y=void 0;if(g.resolvedUri){y=new ze(g.resolvedUri,i,s)}else if(g.playlists&&"dash"===n){y=new tr(g.playlists[0],i,s,p)}else{y=null}g=t.mergeOptions({id:c,playlistLoader:y},g);Qs[e](e,g.playlistLoader,a);l[m].push(g);if("undefined"==typeof u[c]){var f=new t.AudioTrack({id:c,kind:Ws(g),enabled:!1,language:g.language,default:g.default,label:c});u[c]=f}}}r.on("error",Ks[e](e,a))},SUBTITLES:function(e,a){var i=a.tech,n=a.hls,r=a.sourceType,s=a.segmentLoaders[e],d=a.requestOptions,o=a.master.mediaGroups,l=a.mediaTypes[e],u=l.groups,p=l.tracks,m=a.masterPlaylistLoader;for(var c in o[e]){if(!u[c]){u[c]=[]}for(var g in o[e][c]){if(o[e][c][g].forced){continue}var y=o[e][c][g],f=void 0;if("hls"===r){f=new ze(y.resolvedUri,n,d)}else if("dash"===r){f=new tr(y.playlists[0],n,d,m)}y=t.mergeOptions({id:g,playlistLoader:f},y);Qs[e](e,y.playlistLoader,a);u[c].push(y);if("undefined"==typeof p[g]){var _=i.addRemoteTextTrack({id:g,kind:"subtitles",default:y.default&&y.autoselect,language:y.language,label:g},!1).track;p[g]=_}}}s.on("error",Ks[e](e,a))},"CLOSED-CAPTIONS":function(e,a){var i=a.tech,n=a.master.mediaGroups,r=a.mediaTypes[e],s=r.groups,d=r.tracks;for(var o in n[e]){if(!s[o]){s[o]=[]}for(var l in n[e][o]){var u=n[e][o][l];if(!u.instreamId.match(/CC\d/)){continue}s[o].push(t.mergeOptions({id:l},u));if("undefined"==typeof d[l]){var p=i.addRemoteTextTrack({id:u.instreamId,kind:"captions",default:u.default&&u.autoselect,language:u.language,label:l},!1).track;d[l]=p}}}}},Zs=function(e,t){return function(a){var i=t.masterPlaylistLoader,n=t.mediaTypes[e].groups,r=i.media();if(!r){return null}var s=null;if(r.attributes[e]){s=n[r.attributes[e]]}s=s||n.main;if("undefined"==typeof a){return s}if(null===a){return null}return s.filter(function(e){return e.id===a.id})[0]||null}},Js={AUDIO:function(e,t){return function(){var a=t.mediaTypes[e].tracks;for(var i in a){if(a[i].enabled){return a[i]}}return null}},SUBTITLES:function(e,t){return function(){var a=t.mediaTypes[e].tracks;for(var i in a){if("showing"===a[i].mode||"hidden"===a[i].mode){return a[i]}}return null}}},ed=function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){$s[t](t,e)});var t=e.mediaTypes,a=e.masterPlaylistLoader,i=e.tech,n=e.hls;["AUDIO","SUBTITLES"].forEach(function(a){t[a].activeGroup=Zs(a,e);t[a].activeTrack=Js[a](a,e);t[a].onGroupChanged=Ys(a,e);t[a].onTrackChanged=Xs(a,e)});var r=t.AUDIO.activeGroup(),s=(r.filter(function(e){return e.default})[0]||r[0]).id;t.AUDIO.tracks[s].enabled=!0;t.AUDIO.onTrackChanged();a.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(e){return t[e].onGroupChanged()})});var d=function(){t.AUDIO.onTrackChanged();i.trigger({type:"usage",name:"hls-audio-change"})};i.audioTracks().addEventListener("change",d);i.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged);n.on("dispose",function(){i.audioTracks().removeEventListener("change",d);i.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)});i.clearTracks("audio");for(var o in t.AUDIO.tracks){i.audioTracks().addTrack(t.AUDIO.tracks[o])}},td=function(){var e={};["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){e[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:me,activeTrack:me,onGroupChanged:me,onTrackChanged:me}});return e},ad=void 0,id=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],nd=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]},rd=function(e){var a=e.currentPlaylist,i=e.nextPlaylist,n=e.forwardBuffer,r=e.bufferLowWaterLine,s=e.duration,d=e.log;if(!i){t.log.warn("We received no playlist to switch to. Please check your stream.");return!1}if(!a.endList){return!0}if(s<nr.MAX_BUFFER_LOW_WATER_LINE){return!0}if(i.attributes.BANDWIDTH<a.attributes.BANDWIDTH){return!0}if(n>=r){return!0}return!1},sd=function(e){xe(a,e);function a(e){De(this,a);var i=Ue(this,(a.__proto__||Object.getPrototypeOf(a)).call(this)),n=e.url,r=e.handleManifestRedirects,s=e.withCredentials,d=e.tech,o=e.bandwidth,l=e.externHls,u=e.useCueTags,p=e.blacklistDuration,m=e.enableLowInitialPlaylist,c=e.cacheEncryptionKeys,g=e.sourceType;if(!n){throw new Error("A non-empty playlist URL is required")}ad=l;i.withCredentials=s;i.tech_=d;i.hls_=d.hls;i.sourceType_=g;i.useCueTags_=u;i.blacklistDuration=p;i.enableLowInitialPlaylist=m;if(i.useCueTags_){i.cueTagsTrack_=i.tech_.addTextTrack("metadata","ad-cues");i.cueTagsTrack_.inBandMetadataTrackDispatchType=""}i.requestOptions_={withCredentials:s,handleManifestRedirects:r,timeout:null};i.mediaTypes_=td();i.mediaSource=new t.MediaSource;i.mediaSource.addEventListener("sourceopen",i.handleSourceOpen_.bind(i));i.seekable_=t.createTimeRanges();i.hasPlayed_=!1;i.syncController_=new Gs(e);i.segmentMetadataTrack_=d.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track;i.decrypter_=new Vs;i.inbandTextTracks_={};var y={hls:i.hls_,mediaSource:i.mediaSource,currentTime:i.tech_.currentTime.bind(i.tech_),seekable:function(){return i.seekable()},seeking:function(){return i.tech_.seeking()},duration:function(){return i.mediaSource.duration},hasPlayed:function(){return i.hasPlayed_},goalBufferLength:function(){return i.goalBufferLength()},bandwidth:o,syncController:i.syncController_,decrypter:i.decrypter_,sourceType:i.sourceType_,inbandTextTracks:i.inbandTextTracks_,cacheEncryptionKeys:c};i.masterPlaylistLoader_="dash"===i.sourceType_?new tr(n,i.hls_,i.requestOptions_):new ze(n,i.hls_,i.requestOptions_);i.setupMasterPlaylistLoaderListeners_();i.mainSegmentLoader_=new as(t.mergeOptions(y,{segmentMetadataTrack:i.segmentMetadataTrack_,loaderType:"main"}),e);i.audioSegmentLoader_=new as(t.mergeOptions(y,{loaderType:"audio"}),e);i.subtitleSegmentLoader_=new rs(t.mergeOptions(y,{loaderType:"vtt",featuresNativeTextTracks:i.tech_.featuresNativeTextTracks}),e);i.setupSegmentLoaderListeners_();id.forEach(function(e){i[e+"_"]=nd.bind(i,e)});i.logger_=ar("MPC");i.masterPlaylistLoader_.load();return i}Pe(a,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var a=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var e=a.masterPlaylistLoader_.media(),i=1e3*(1.5*e.targetDuration);if(lt(a.masterPlaylistLoader_.master,a.masterPlaylistLoader_.media())){a.requestOptions_.timeout=0}else{a.requestOptions_.timeout=i}if(e.endList&&"none"!==a.tech_.preload()){a.mainSegmentLoader_.playlist(e,a.requestOptions_);a.mainSegmentLoader_.load()}ed({sourceType:a.sourceType_,segmentLoaders:{AUDIO:a.audioSegmentLoader_,SUBTITLES:a.subtitleSegmentLoader_,main:a.mainSegmentLoader_},tech:a.tech_,requestOptions:a.requestOptions_,masterPlaylistLoader:a.masterPlaylistLoader_,hls:a.hls_,master:a.master(),mediaTypes:a.mediaTypes_,blacklistCurrentPlaylist:a.blacklistCurrentPlaylist.bind(a)});a.triggerPresenceUsage_(a.master(),e);try{a.setupSourceBuffers_()}catch(i){t.log.warn("Failed to create SourceBuffers",i);return a.mediaSource.endOfStream("decode")}a.setupFirstPlay();if(!a.mediaTypes_.AUDIO.activePlaylistLoader||a.mediaTypes_.AUDIO.activePlaylistLoader.media()){a.trigger("selectedinitialmedia")}else{a.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){a.trigger("selectedinitialmedia")})}});this.masterPlaylistLoader_.on("loadedplaylist",function(){var e=a.masterPlaylistLoader_.media();if(!e){a.excludeUnsupportedVariants_();var t;if(a.enableLowInitialPlaylist){t=a.selectInitialPlaylist()}if(!t){t=a.selectPlaylist()}a.initialMedia_=t;a.masterPlaylistLoader_.media(a.initialMedia_);return}if(a.useCueTags_){a.updateAdCues_(e)}a.mainSegmentLoader_.playlist(e,a.requestOptions_);a.updateDuration();if(!a.tech_.paused()){a.mainSegmentLoader_.load();if(a.audioSegmentLoader_){a.audioSegmentLoader_.load()}}if(!e.endList){var i=function(){var e=a.seekable();if(0!==e.length){a.mediaSource.addSeekableRange_(e.start(0),e.end(0))}};if(a.duration()!==1/0){var n=function e(){if(a.duration()===1/0){i()}else{a.tech_.one("durationchange",e)}};a.tech_.one("durationchange",n)}else{i()}}});this.masterPlaylistLoader_.on("error",function(){a.blacklistCurrentPlaylist(a.masterPlaylistLoader_.error)});this.masterPlaylistLoader_.on("mediachanging",function(){a.mainSegmentLoader_.abort();a.mainSegmentLoader_.pause()});this.masterPlaylistLoader_.on("mediachange",function(){var e=a.masterPlaylistLoader_.media(),t=1e3*(1.5*e.targetDuration);if(lt(a.masterPlaylistLoader_.master,a.masterPlaylistLoader_.media())){a.requestOptions_.timeout=0}else{a.requestOptions_.timeout=t}a.mainSegmentLoader_.playlist(e,a.requestOptions_);a.mainSegmentLoader_.load();a.tech_.trigger({type:"mediachange",bubbles:!0})});this.masterPlaylistLoader_.on("playlistunchanged",function(){var e=a.masterPlaylistLoader_.media(),t=a.stuckAtPlaylistEnd_(e);if(t){a.blacklistCurrentPlaylist({message:"Playlist no longer updating."});a.tech_.trigger("playliststuck")}});this.masterPlaylistLoader_.on("renditiondisabled",function(){a.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})});this.masterPlaylistLoader_.on("renditionenabled",function(){a.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function(e,t){var a=e.mediaGroups||{},i=!0,n=Object.keys(a.AUDIO);for(var r in a.AUDIO){for(var s in a.AUDIO[r]){var d=a.AUDIO[r][s];if(!d.uri){i=!1}}}if(i){this.tech_.trigger({type:"usage",name:"hls-demuxed"})}if(Object.keys(a.SUBTITLES).length){this.tech_.trigger({type:"usage",name:"hls-webvtt"})}if(ad.Playlist.isAes(t)){this.tech_.trigger({type:"usage",name:"hls-aes"})}if(ad.Playlist.isFmp4(t)){this.tech_.trigger({type:"usage",name:"hls-fmp4"})}if(n.length&&1<Object.keys(a.AUDIO[n[0]]).length){this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})}if(this.useCueTags_){this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}}},{key:"setupSegmentLoaderListeners_",value:function(){var e=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var t=e.selectPlaylist(),a=e.masterPlaylistLoader_.media(),i=e.tech_.buffered(),n=i.length?i.end(i.length-1)-e.tech_.currentTime():0,r=e.bufferLowWaterLine();if(rd({currentPlaylist:a,nextPlaylist:t,forwardBuffer:n,bufferLowWaterLine:r,duration:e.duration(),log:e.logger_})){e.masterPlaylistLoader_.media(t)}e.tech_.trigger("bandwidthupdate")});this.mainSegmentLoader_.on("progress",function(){e.trigger("progress")});this.mainSegmentLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())});this.mainSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()});this.mainSegmentLoader_.on("timestampoffset",function(){e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})});this.audioSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()});this.mainSegmentLoader_.on("ended",function(){e.onEndOfStream()});this.mainSegmentLoader_.on("earlyabort",function(){e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)});this.mainSegmentLoader_.on("reseteverything",function(){e.tech_.trigger("hls-reset")});this.mainSegmentLoader_.on("segmenttimemapping",function(t){e.tech_.trigger({type:"hls-segment-time-mapping",mapping:t.mapping})});this.audioSegmentLoader_.on("ended",function(){e.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.load()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.load()}}},{key:"smoothQualityChange_",value:function(){var e=this.selectPlaylist();if(e!==this.masterPlaylistLoader_.media()){this.masterPlaylistLoader_.media(e);this.mainSegmentLoader_.resetLoader()}}},{key:"fastQualityChange_",value:function(){var e=this,a=this.selectPlaylist();if(a===this.masterPlaylistLoader_.media()){return}this.masterPlaylistLoader_.media(a);this.mainSegmentLoader_.resetEverything(function(){if(t.browser.IE_VERSION||t.browser.IS_EDGE){e.tech_.setCurrentTime(e.tech_.currentTime()+.04)}else{e.tech_.setCurrentTime(e.tech_.currentTime())}})}},{key:"play",value:function(){if(this.setupFirstPlay()){return}if(this.tech_.ended()){this.tech_.setCurrentTime(0)}if(this.hasPlayed_){this.load()}var e=this.tech_.seekable();if(this.tech_.duration()===1/0){if(this.tech_.currentTime()<e.start(0)){return this.tech_.setCurrentTime(e.end(e.length-1))}}}},{key:"setupFirstPlay",value:function(){var e=this,a=this.masterPlaylistLoader_.media();if(!a||this.tech_.paused()||this.hasPlayed_){return!1}if(!a.endList){var i=this.seekable();if(!i.length){return!1}if(t.browser.IE_VERSION&&0===this.tech_.readyState()){this.tech_.one("loadedmetadata",function(){e.trigger("firstplay");e.tech_.setCurrentTime(i.end(0));e.hasPlayed_=!0});return!1}this.trigger("firstplay");this.tech_.setCurrentTime(i.end(0))}this.hasPlayed_=!0;this.load();return!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(a){t.log.warn("Failed to create Source Buffers",a);return this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var e=this.tech_.play();if("undefined"!=typeof e&&"function"==typeof e.then){e.then(null,function(){})}}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo){e=e&&this.audioSegmentLoader_.ended_}else{e=this.audioSegmentLoader_.ended_}}if(!e){return}this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(a){t.log.warn("Failed to call media source endOfStream",a)}}},{key:"stuckAtPlaylistEnd_",value:function(e){var t=this.seekable();if(!t.length){return!1}var a=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(null===a){return!1}var i=ad.Playlist.playlistEnd(e,a),n=this.tech_.currentTime(),r=this.tech_.buffered();if(!r.length){return i-n<=jt}var s=r.end(r.length-1);return s-n<=jt&&i-s<=jt}},{key:"blacklistCurrentPlaylist",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},a=arguments[1],i=void 0,n=void 0;i=e.playlist||this.masterPlaylistLoader_.media();a=a||e.blacklistDuration||this.blacklistDuration;if(!i){this.error=e;try{return this.mediaSource.endOfStream("network")}catch(t){return this.trigger("error")}}var r=1===this.masterPlaylistLoader_.master.playlists.filter(dt).length,s=this.masterPlaylistLoader_.master.playlists;if(1===s.length){t.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist.");this.tech_.trigger("retryplaylist");return this.masterPlaylistLoader_.load(r)}if(r){t.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted.");s.forEach(function(e){if(e.excludeUntil!==1/0){delete e.excludeUntil}});this.tech_.trigger("retryplaylist")}i.excludeUntil=Date.now()+1e3*a;this.tech_.trigger("blacklistplaylist");this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});n=this.selectPlaylist();t.log.warn("Problem encountered with the current HLS playlist."+(e.message?" "+e.message:"")+" Switching to another playlist.");return this.masterPlaylistLoader_.media(n,r)}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.pause()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.pause()}}},{key:"setCurrentTime",value:function(e){var t=Xt(this.tech_.buffered(),e);if(!(this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media())){return 0}if(!this.masterPlaylistLoader_.media().segments){return 0}if(t&&t.length){return e}this.mainSegmentLoader_.resetEverything();this.mainSegmentLoader_.abort();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.resetEverything();this.audioSegmentLoader_.abort()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.resetEverything();this.subtitleSegmentLoader_.abort()}this.load()}},{key:"duration",value:function(){if(!this.masterPlaylistLoader_){return 0}if(this.mediaSource){return this.mediaSource.duration}return ad.Playlist.duration(this.masterPlaylistLoader_.media())}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e;if(!this.masterPlaylistLoader_){return}var a=this.masterPlaylistLoader_.media();if(!a){return}var i=this.syncController_.getExpiredTime(a,this.mediaSource.duration);if(null===i){return}var n=this.masterPlaylistLoader_.master.suggestedPresentationDelay,r=ad.Playlist.seekable(a,i,n);if(0===r.length){return}if(this.mediaTypes_.AUDIO.activePlaylistLoader){a=this.mediaTypes_.AUDIO.activePlaylistLoader.media();i=this.syncController_.getExpiredTime(a,this.mediaSource.duration);if(null===i){return}e=ad.Playlist.seekable(a,i,n);if(0===e.length){return}}var s=void 0,d=void 0;if(this.seekable_&&this.seekable_.length){s=this.seekable_.end(0);d=this.seekable_.start(0)}if(!e){this.seekable_=r}else if(e.start(0)>r.end(0)||r.start(0)>e.end(0)){this.seekable_=r}else{this.seekable_=t.createTimeRanges([[e.start(0)>r.start(0)?e.start(0):r.start(0),e.end(0)<r.end(0)?e.end(0):r.end(0)]])}if(this.seekable_&&this.seekable_.length){if(this.seekable_.end(0)===s&&this.seekable_.start(0)===d){return}}this.logger_("seekable updated ["+$t(this.seekable_)+"]");this.tech_.trigger("seekablechanged")}},{key:"updateDuration",value:function(){var e=this,a=this.mediaSource.duration,i=ad.Playlist.duration(this.masterPlaylistLoader_.media()),n=this.tech_.buffered(),r=function a(){e.logger_("Setting duration from "+e.mediaSource.duration+" => "+i);try{e.mediaSource.duration=i}catch(a){t.log.warn("Failed to set media source duration",a)}e.tech_.trigger("durationchange");e.mediaSource.removeEventListener("sourceopen",a)};if(0<n.length){i=Math.max(i,n.end(n.length-1))}if(a!==i){if("open"!==this.mediaSource.readyState){this.mediaSource.addEventListener("sourceopen",r)}else{r()}}}},{key:"dispose",value:function(){var e=this;this.trigger("dispose");if(this.decrypter_){this.decrypter_.terminate()}this.masterPlaylistLoader_.dispose();this.mainSegmentLoader_.dispose();["AUDIO","SUBTITLES"].forEach(function(t){var a=e.mediaTypes_[t].groups;for(var i in a){a[i].forEach(function(e){if(e.playlistLoader){e.playlistLoader.dispose()}})}});this.audioSegmentLoader_.dispose();this.subtitleSegmentLoader_.dispose();this.off();if(this.mediaSource.dispose){this.mediaSource.dispose()}}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e=this.masterPlaylistLoader_.media(),t=void 0;if(!e||"open"!==this.mediaSource.readyState){return}t=va(this.masterPlaylistLoader_.master,e);if(1>t.length){this.error="No compatible SourceBuffer configuration for the variant stream:"+e.resolvedUri;return this.mediaSource.endOfStream("decode")}this.configureLoaderMimeTypes_(t);this.excludeIncompatibleVariants_(e)}},{key:"configureLoaderMimeTypes_",value:function(e){var a=1<e.length&&-1===e[0].indexOf(",")&&e[0]!==e[1]?new t.EventTarget:null;this.mainSegmentLoader_.mimeType(e[0],a);if(e[1]){this.audioSegmentLoader_.mimeType(e[1],a)}}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach(function(e){if(e.attributes.CODECS&&be.MediaSource&&be.MediaSource.isTypeSupported&&!be.MediaSource.isTypeSupported("video/mp4; codecs=\""+_a(e.attributes.CODECS)+"\"")){e.excludeUntil=1/0}})}},{key:"excludeIncompatibleVariants_",value:function(e){var t=2,a=null,i=void 0;if(e.attributes.CODECS){i=fa(e.attributes.CODECS);a=i.videoCodec;t=i.codecCount}this.master().playlists.forEach(function(e){var i={codecCount:2,videoCodec:null};if(e.attributes.CODECS){i=fa(e.attributes.CODECS)}if(i.codecCount!==t){e.excludeUntil=1/0}if(i.videoCodec!==a){e.excludeUntil=1/0}})}},{key:"updateAdCues_",value:function(e){var t=0,a=this.seekable();if(a.length){t=a.start(0)}ds(e,this.cueTagsTrack_,t)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=nr.GOAL_BUFFER_LENGTH,a=nr.GOAL_BUFFER_LENGTH_RATE,i=Math.max(t,nr.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*a,i)}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=nr.BUFFER_LOW_WATER_LINE,a=nr.BUFFER_LOW_WATER_LINE_RATE,i=Math.max(t,nr.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*a,i)}}]);return a}(t.EventTarget),dd=function(e,t,a){return function(i){var n=e.master.playlists[t],r=st(n),s=dt(n);if("undefined"==typeof i){return s}if(i){delete n.disabled}else{n.disabled=!0}if(i!==s&&!r){a();if(i){e.trigger("renditionenabled")}else{e.trigger("renditiondisabled")}}return i}},od=function e(t,a,i){De(this,e);var n=t.masterPlaylistController_,r=t.options_.smoothQualityChange,s=r?"smooth":"fast",d=n[s+"QualityChange_"].bind(n);if(a.attributes.RESOLUTION){var o=a.attributes.RESOLUTION;this.width=o.width;this.height=o.height}this.bandwidth=a.attributes.BANDWIDTH;this.id=i;this.enabled=dd(t.playlists,a.id,d)},ld=function(t){var a=t.playlists;t.representations=function(){if(!a||!a.master||!a.master.playlists){return[]}return a.master.playlists.filter(function(e){return!st(e)}).map(function(a){return new od(t,a,a.id)})}},ud=["seeking","seeked","pause","playing","error"],pd=function(){function e(t){var a=this;De(this,e);this.tech_=t.tech;this.seekable=t.seekable;this.allowSeeksWithinUnsafeLiveWindow=t.allowSeeksWithinUnsafeLiveWindow;this.media=t.media;this.consecutiveUpdates=0;this.lastRecordedTime=null;this.timer_=null;this.checkCurrentTimeTimeout_=null;this.logger_=ar("PlaybackWatcher");this.logger_("initialize");var i=function(){return a.monitorCurrentTime_()},n=function(){return a.techWaiting_()},r=function(){return a.cancelTimer_()},s=function(){return a.fixesBadSeeks_()};this.tech_.on("seekablechanged",s);this.tech_.on("waiting",n);this.tech_.on(ud,r);this.tech_.on("canplay",i);this.dispose=function(){a.logger_("dispose");a.tech_.off("seekablechanged",s);a.tech_.off("waiting",n);a.tech_.off(ud,r);a.tech_.off("canplay",i);if(a.checkCurrentTimeTimeout_){be.clearTimeout(a.checkCurrentTimeTimeout_)}a.cancelTimer_()}}Pe(e,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_();if(this.checkCurrentTimeTimeout_){be.clearTimeout(this.checkCurrentTimeTimeout_)}this.checkCurrentTimeTimeout_=be.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_()){this.consecutiveUpdates=0;this.lastRecordedTime=this.tech_.currentTime();return}if(this.tech_.paused()||this.tech_.seeking()){return}var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+jt>=t.end(t.length-1))){return this.techWaiting_()}if(5<=this.consecutiveUpdates&&e===this.lastRecordedTime){this.consecutiveUpdates++;this.waiting_()}else if(e===this.lastRecordedTime){this.consecutiveUpdates++}else{this.consecutiveUpdates=0;this.lastRecordedTime=e}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0;if(this.timer_){this.logger_("cancelTimer_");clearTimeout(this.timer_)}this.timer_=null}},{key:"fixesBadSeeks_",value:function(){var e=this.tech_.seeking();if(!e){return!1}var t=this.seekable(),a=this.tech_.currentTime(),i=this.afterSeekableWindow_(t,a,this.media(),this.allowSeeksWithinUnsafeLiveWindow),n=void 0;if(i){var r=t.end(t.length-1);n=r}if(this.beforeSeekableWindow_(t,a)){var s=t.start(0);n=s+jt}if("undefined"!=typeof n){this.logger_("Trying to seek outside of seekable at time "+a+" with "+("seekable range "+$t(t)+". Seeking to ")+(n+"."));this.tech_.setCurrentTime(n);return!0}return!1}},{key:"waiting_",value:function(){if(this.techWaiting_()){return}var e=this.tech_.currentTime(),t=this.tech_.buffered(),a=Xt(t,e);if(a.length&&e+3<=a.end(0)){this.cancelTimer_();this.tech_.setCurrentTime(e);this.logger_("Stopped at "+e+" while inside a buffered region "+("["+a.start(0)+" -> "+a.end(0)+"]. Attempting to resume playback by seeking to the current time."));this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})}}},{key:"techWaiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_()){return!0}if(this.tech_.seeking()||null!==this.timer_){return!0}if(this.beforeSeekableWindow_(e,t)){var a=e.end(e.length-1);this.logger_("Fell out of live window at time "+t+". Seeking to "+("live point (seekable end) "+a));this.cancelTimer_();this.tech_.setCurrentTime(a);this.tech_.trigger({type:"usage",name:"hls-live-resync"});return!0}var i=this.tech_.buffered(),n=Kt(i,t);if(this.videoUnderflow_(n,i,t)){this.cancelTimer_();this.tech_.setCurrentTime(t);this.tech_.trigger({type:"usage",name:"hls-video-underflow"});return!0}if(0<n.length){var r=n.start(0)-t;this.logger_("Stopped at "+t+", setting timer for "+r+", seeking "+("to "+n.start(0)));this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*r,t);return!0}return!1}},{key:"afterSeekableWindow_",value:function(e,t,a){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:!1;if(!e.length){return!1}var n=e.end(e.length-1)+jt,r=!a.endList;if(r&&i){n=e.end(e.length-1)+3*a.targetDuration}if(t>n){return!0}return!1}},{key:"beforeSeekableWindow_",value:function(e,t){if(e.length&&0<e.start(0)&&t<e.start(0)-jt){return!0}return!1}},{key:"videoUnderflow_",value:function(e,t,a){if(0===e.length){var i=this.gapFromVideoUnderflow_(t,a);if(i){this.logger_("Encountered a gap in video from "+i.start+" to "+i.end+". "+("Seeking to current time "+a));return!0}}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),a=this.tech_.currentTime(),i=Kt(t,a);this.cancelTimer_();if(0===i.length||a!==e){return}this.logger_("skipTheGap_:","currentTime:",a,"scheduled currentTime:",e,"nextRange start:",i.start(0));this.tech_.setCurrentTime(i.start(0)+zt);this.tech_.trigger({type:"usage",name:"hls-gap-skip"})}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var a=Qt(e),n=0;n<a.length;n++){var r=a.start(n),s=a.end(n);if(4>t-r&&2<t-r){return{start:r,end:s}}}return null}}]);return e}(),md={errorInterval:30,getSource:function(e){var t=this.tech({IWillNotUseThisInPlugins:!0}),a=t.currentSource_;return e(a)}},cd=function e(a,i){var n=0,r=0,s=t.mergeOptions(md,i);a.ready(function(){a.trigger({type:"usage",name:"hls-error-reload-initialized"})});var d=function(){if(r){a.currentTime(r)}},o=function(e){if(null===e||e===void 0){return}r=a.duration()!==1/0&&a.currentTime()||0;a.one("loadedmetadata",d);a.src(e);a.trigger({type:"usage",name:"hls-error-reload"});a.play()},l=function(){if(Date.now()-n<1e3*s.errorInterval){a.trigger({type:"usage",name:"hls-error-reload-canceled"});return}if(!s.getSource||"function"!=typeof s.getSource){t.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}n=Date.now();return s.getSource.call(a,o)},u=function e(){a.off("loadedmetadata",d);a.off("error",l);a.off("dispose",e)};a.on("error",l);a.on("dispose",u);a.reloadSourceOnError=function(t){u();e(a,t)}},gd=function(e){cd(this,e)},yd={PlaylistLoader:ze,Playlist:ut,Decrypter:Ct,AsyncStream:It,decrypt:Lt,utils:Nt,STANDARD_PLAYLIST_SELECTOR:function(){var e=this.useDevicePixelRatio?be.devicePixelRatio||1:1;return Dr(this.playlists.master,this.systemBandwidth,parseInt(Er(this.tech_.el(),"width"),10)*e,parseInt(Er(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions)},INITIAL_PLAYLIST_SELECTOR:function(){var e=this.playlists.master.playlists.filter(ut.isEnabled);Lr(e,function(e,t){return Cr(e,t)});var t=e.filter(function(e){return fa(e.attributes.CODECS).videoCodec});return t[0]||null},comparePlaylistBandwidth:Cr,comparePlaylistResolution:function(e,t){var a=void 0,i=void 0;if(e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width){a=e.attributes.RESOLUTION.width}a=a||be.Number.MAX_VALUE;if(t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width){i=t.attributes.RESOLUTION.width}i=i||be.Number.MAX_VALUE;if(a===i&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH){return e.attributes.BANDWIDTH-t.attributes.BANDWIDTH}return a-i},xhr:ct()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(e){Object.defineProperty(yd,e,{get:function(){t.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing");return nr[e]},set:function(a){t.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing");if("number"!=typeof a||0>a){t.log.warn("value of Hls."+e+" must be greater than or equal to 0");return}nr[e]=a}})});var fd=function(e){if(/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(e)){return"hls"}if(/^application\/dash\+xml/i.test(e)){return"dash"}return null},_d=function(e,t){for(var a=t.media(),n=-1,r=0;r<e.length;r++){if(e[r].id===a.id){n=r;break}}e.selectedIndex_=n;e.trigger({selectedIndex:n,type:"change"})},hd=function(e,t){t.representations().forEach(function(t){e.addQualityLevel(t)});_d(e,t.playlists)};yd.canPlaySource=function(){return t.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var bd=function(e,a,i){if(!e){return e}var n=void 0,r=void 0;if(i.mimeType_){n=a.mimeType_;r=i.mimeType_}else{var s=ka(a.mimeType_),d=s.parameters.codecs.split(","),o=void 0,l=void 0;d.forEach(function(e){e=e.trim();if(Ia(e)){o=e}else if(Ea(e)){l=e}});n=s.type+"; codecs=\""+l+"\"";r=s.type.replace("video","audio")+"; codecs=\""+o+"\""}var u={},p=a.playlist_;for(var m in e){u[m]={audioContentType:r,videoContentType:n};if(p.contentProtection&&p.contentProtection[m]&&p.contentProtection[m].pssh){u[m].pssh=p.contentProtection[m].pssh}if("string"==typeof e[m]){u[m].url=e[m]}}return t.mergeOptions(e,u)},Td=function(e){var a=e.masterPlaylistController_.mainSegmentLoader_,i=e.masterPlaylistController_.audioSegmentLoader_,n=t.players[e.tech_.options_.playerId];if(n.eme){var r=bd(e.source_.keySystems,a,i);if(r){n.currentSource().keySystems=r;if(!(11===t.browser.IE_VERSION)&&n.eme.initializeMediaKeys){n.eme.initializeMediaKeys()}}}},Sd=function(){if(!window.localStorage){return null}var e=window.localStorage.getItem("videojs-vhs");if(!e){return null}try{return JSON.parse(e)}catch(t){return null}},vd=function(e){if(!window.localStorage){return!1}var a=Sd();a=a?t.mergeOptions(a,e):e;try{window.localStorage.setItem("videojs-vhs",JSON.stringify(a))}catch(t){return!1}return a};yd.supportsNativeHls=function(){var e=fe.createElement("video");if(!t.getTech("Html5").isSupported()){return!1}return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(t){return /maybe|probably/i.test(e.canPlayType(t))})}();yd.supportsNativeDash=function(){if(!t.getTech("Html5").isSupported()){return!1}return /maybe|probably/i.test(fe.createElement("video").canPlayType("application/dash+xml"))}();yd.supportsTypeNatively=function(e){if("hls"===e){return yd.supportsNativeHls}if("dash"===e){return yd.supportsNativeDash}return!1};yd.isSupported=function(){return t.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var kd=t.getComponent("Component"),Id=function(e){xe(a,e);function a(e,i,n){De(this,a);var r=Ue(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,i,n.hls));if(i.options_&&i.options_.playerId){var s=t(i.options_.playerId);if(!s.hasOwnProperty("hls")){Object.defineProperty(s,"hls",{get:function(){t.log.warn("player.hls is deprecated. Use player.tech().hls instead.");i.trigger({type:"usage",name:"hls-player-access"});return r},configurable:!0})}s.vhs=r;s.dash=r;r.player_=s}r.tech_=i;r.source_=e;r.stats={};r.ignoreNextSeekingEvent_=!1;r.setOptions_();if(r.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks){i.overrideNativeAudioTracks(!0);i.overrideNativeVideoTracks(!0)}else if(r.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks)){throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB")}r.on(fe,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(){var e=fe.fullscreenElement||fe.webkitFullscreenElement||fe.mozFullScreenElement||fe.msFullscreenElement;if(e&&e.contains(r.tech_.el())){r.masterPlaylistController_.smoothQualityChange_()}});r.on(r.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())});r.on(r.tech_,"error",function(){if(this.masterPlaylistController_){this.masterPlaylistController_.pauseLoading()}});r.on(r.tech_,"play",r.play);return r}Pe(a,[{key:"setOptions_",value:function(){var e=this;this.options_.withCredentials=this.options_.withCredentials||!1;this.options_.handleManifestRedirects=this.options_.handleManifestRedirects||!1;this.options_.limitRenditionByPlayerDimensions=!1===this.options_.limitRenditionByPlayerDimensions?!1:!0;this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1;this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1;this.options_.useBandwidthFromLocalStorage="undefined"!=typeof this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1;this.options_.customTagParsers=this.options_.customTagParsers||[];this.options_.customTagMappers=this.options_.customTagMappers||[];this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1;if("number"!=typeof this.options_.blacklistDuration){this.options_.blacklistDuration=300}if("number"!=typeof this.options_.bandwidth){if(this.options_.useBandwidthFromLocalStorage){var t=Sd();if(t&&t.bandwidth){this.options_.bandwidth=t.bandwidth;this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})}if(t&&t.throughput){this.options_.throughput=t.throughput;this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"})}}}if("number"!=typeof this.options_.bandwidth){this.options_.bandwidth=nr.INITIAL_BANDWIDTH}this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===nr.INITIAL_BANDWIDTH;["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys"].forEach(function(t){if("undefined"!=typeof e.source_[t]){e.options_[t]=e.source_[t]}});this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions;this.useDevicePixelRatio=this.options_.useDevicePixelRatio}},{key:"src",value:function(e,a){var i=this;if(!e){return}this.setOptions_();this.options_.url=this.source_.src;this.options_.tech=this.tech_;this.options_.externHls=yd;this.options_.sourceType=fd(a);this.options_.seekTo=function(e){i.tech_.setCurrentTime(e)};this.masterPlaylistController_=new sd(this.options_);this.playbackWatcher_=new pd(t.mergeOptions(this.options_,{seekable:function(){return i.seekable()},media:function(){return i.masterPlaylistController_.media()}}));this.masterPlaylistController_.on("error",function(){var e=t.players[i.tech_.options_.playerId];e.error(i.masterPlaylistController_.error)});this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):yd.STANDARD_PLAYLIST_SELECTOR.bind(this);this.masterPlaylistController_.selectInitialPlaylist=yd.INITIAL_PLAYLIST_SELECTOR.bind(this);this.playlists=this.masterPlaylistController_.masterPlaylistLoader_;this.mediaSource=this.masterPlaylistController_.mediaSource;Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e;this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e;this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e=1/(this.bandwidth||1),t=void 0;if(0<this.throughput){t=1/this.throughput}else{t=0}var a=Math.floor(1/(e+t));return a},set:function(){t.log.error("The \"systemBandwidth\" property is read-only")}}});if(this.options_.bandwidth){this.bandwidth=this.options_.bandwidth}if(this.options_.throughput){this.throughput=this.options_.throughput}Object.defineProperties(this.stats,{bandwidth:{get:function(){return i.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return i.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return i.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return i.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return i.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return i.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return i.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return i.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return Jt(i.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return i.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return i.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return i.tech_.name_},enumerable:!0},duration:{get:function(){return i.tech_.duration()},enumerable:!0},master:{get:function(){return i.playlists.master},enumerable:!0},playerDimensions:{get:function(){return i.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Jt(i.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return i.tech_.getVideoPlaybackQuality()},enumerable:!0}});this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_));this.tech_.on("bandwidthupdate",function(){if(i.options_.useBandwidthFromLocalStorage){vd({bandwidth:i.bandwidth,throughput:Math.round(i.throughput)})}});this.masterPlaylistController_.on("selectedinitialmedia",function(){ld(i);Td(i)});this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")});this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0});this.setupQualityLevels_();if(!this.tech_.el()){return}this.tech_.src(t.URL.createObjectURL(this.masterPlaylistController_.mediaSource))}},{key:"setupQualityLevels_",value:function(){var e=this,a=t.players[this.tech_.options_.playerId];if(!a||!a.qualityLevels||this.qualityLevels_){return}this.qualityLevels_=a.qualityLevels();this.masterPlaylistController_.on("selectedinitialmedia",function(){hd(e.qualityLevels_,e)});this.playlists.on("mediachange",function(){_d(e.qualityLevels_,e.playlists)})}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){if(this.playbackWatcher_){this.playbackWatcher_.dispose()}if(this.masterPlaylistController_){this.masterPlaylistController_.dispose()}if(this.qualityLevels_){this.qualityLevels_.dispose()}if(this.player_){delete this.player_.vhs;delete this.player_.dash;delete this.player_.hls}if(this.tech_&&this.tech_.hls){delete this.tech_.hls}Oe(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function(e,t){return Vt({playlist:this.masterPlaylistController_.media(),time:e,callback:t})}},{key:"seekToProgramTime",value:function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:2;return Wt({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:i,pauseAfterSeek:a,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}]);return a}(kd),Ed={name:"videojs-http-streaming",VERSION:"1.13.3",canHandleSource:function(e){var a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},i=t.mergeOptions(t.options,a);return Ed.canPlayType(e.type,i)},handleSource:function(e,a){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},n=t.mergeOptions(t.options,i);a.hls=new Id(e,a,n);a.hls.xhr=ct();a.hls.src(e.src,e.type);return a.hls},canPlayType:function(e){var a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},i=t.mergeOptions(t.options,a),n=i.hls.overrideNative,r=fd(e),s=r&&(!yd.supportsTypeNatively(r)||n);return s?"maybe":""}};if("undefined"==typeof t.MediaSource||"undefined"==typeof t.URL){t.MediaSource=Ba;t.URL=Ma}if(Ba.supportsNativeMediaSources()){t.getTech("Html5").registerSourceHandler(Ed,0)}t.HlsHandler=Id;t.HlsSourceHandler=Ed;t.Hls=yd;if(!t.use){t.registerComponent("Hls",yd)}t.options.hls=t.options.hls||{};if(t.registerPlugin){t.registerPlugin("reloadSourceOnError",gd)}else{t.plugin("reloadSourceOnError",gd)}e.LOCAL_STORAGE_KEY="videojs-vhs";e.Hls=yd;e.HlsHandler=Id;e.HlsSourceHandler=Ed;e.emeKeySystems=bd;e.simpleTypeFromSourceType=fd;Object.defineProperty(e,"__esModule",{value:!0})});
define ("mod_vod/vod",["jquery","media_videojs/video-lazy","media_videojs/videojs-flash-lazy","theme_coursemos/bootstrap","theme_coursemos/jsencrypt","theme_coursemos/jquery.base64"],function(a,b){var c={isLogin:!0,isProgress:!0,attempt:0,vodTagID:null,actionurl:M.cfg.wwwroot+"/mod/vod/action.php",isRSA:!1,publicKey:null,coursemosProgressbarClass:"vjs-coursemos-progress",videojsModule:function(a){window.videojs=b;var c=["media_videojs/Youtube-lazy","mod_vod/videojs-hotkeys","mod_vod/videojs-contrib-quality-levels"];if(a){c.push("mod_vod/videojs-hls-quality-selector")}return c}};c.progress=function(d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D){c.isProgress=0!=f?!0:!1;c.attempt=g;c.vodTagID=d;c.isRSA=0<s?!0:!1;c.publicKey=t;var E=c.videojsModule(o);require(E,function(){var e=a("#"+d).data("setup-lazy");console.log("config",d,e);var g=b(d,e);g.on("error",function(){var b=g.error();if("4"==b.code){var c=M.util.get_string("not_support_browser","vod",navigator.userAgent);a(".vjs-error-display .vjs-modal-dialog-content").append(c)}});if(v&&o){g.hlsQualitySelector()}var p={current:0,max:l,old:0,previous:0,isMaxMove:!1,moveOld:0,moveNew:0},s=null;c.ajax(j,k,"1",0,0);a("#viewer .vod-header .btn-close").click(function(){g.pause();setTimeout(function(){self.close()},500)});a(window).bind("beforeunload",function(a){if(!g.paused()){g.pause()}setTimeout(function(){c.ajax(j,k,"99",g.currentTime(),g.currentTime())},100);if(c.isProgress){var b=M.util.get_string("track_window_close","vod");(a||window.event).returnValue=b;return b}});g.ready(function(){var b=this.textTrackSettings;b.setValues({backgroundOpacity:"0.5",edgeStyle:"none"});b.updateDisplay();this.hotkeys({enableNumbers:!1,seekStep:c.skipSecond(z),forwardKey:function forwardKey(a,b){var d=39===a.which||176===a.which;if(f){if(d&&!h){var e=b.duration(),g=!b.paused();a.stopPropagation();a.stopImmediatePropagation();a.preventDefault();if(g){b.pause()}var i=b.currentTime()+this.seekStep;if(i>p.max){c.maxMoveError(b,p.max);i=p.max-1;if(i>=e){i=g?e-.001:e}b.currentTime(i);if(g){b.play()}return!1}}}return d}});var e=this;if("Youtube"==e.techName_){var i=g.tech_.ytPlayer;i.addEventListener("onStateChange",function(a){switch(a.data){case YT.PlayerState.PLAYING:case YT.PlayerState.BUFFERING:g.focus();break;}})}if(0<a("#"+d+" .vjs-progress-control .vjs-progress-holder").length){a("#"+d+" .vjs-progress-control .vjs-progress-holder").append("<div class=\""+c.coursemosProgressbarClass+"\" />")}if(!h&&0<l){if(confirm(M.util.get_string("prev_playback","vod",c.secondToTime(l)))){setTimeout(function(){g.currentTime(l);g.play();if("Youtube"==g.techName_){g.currentTime(l)}},1e3);setTimeout(function(){c.ajax(j,k,"3",l,l)},1500)}}});s=g.setInterval(function(){c.ajax(j,k,"8",p.current,p.current)},n);if(!h){var t=b.getComponent("SeekBar");t.prototype.handleMouseMove=function(a){var b=this.calculateDistance(a)*this.player_.duration();if(b===this.player_.duration()){b=b-.1}if(b<p.max){this.player_.currentTime(b)}else{c.maxMoveError(this.player_,p.max)}}}g.on("timeupdate",function(){var b=g.playbackRate();if(!r&&1<b){g.playbackRate(1);c.alertMessage("alert-danger",M.util.get_string("can_not_playbackrate","vod"))}else if(r&&b>u){g.playbackRate(u);c.alertMessage("alert-danger",M.util.get_string("can_not_playbackrate_max","vod",u))}p.previous=p.current;p.current=g.currentTime();if(p.previous<p.current){p.old=p.previous;p.previous=p.current}if(!0!=g.paused()){if(p.current>=p.max){p.max=Math.floor(p.current)}}if("NaN"!=this.duration()&&i&&q){var d=0;if(f){d=p.max}else{d=m}var e=100*(d/this.duration());e=e.toFixed(2);a(".vod-viewer .video-js ."+c.coursemosProgressbarClass).css("width",e+"%")}});g.on("play",function(){if(!g.seeking()){c.ajax(j,k,"3",g.currentTime(),g.currentTime())}});g.on("pause",function(){if(g.paused()&&!g.seeking()&&!g.ended()){c.ajax(j,k,"2",g.currentTime(),g.currentTime())}});g.on("seeking",function(){var a=Math.floor(g.currentTime());if(0<a&&0<y){a-=y;if(0>a){a=0}}if(a>p.max&&!h){c.maxMoveError(g,p.max)}else{if(p.moveOld!=p.old&&p.moveNew!=a){c.ajax(j,k,"2",p.old,a)}p.moveOld=p.old;p.moveNew=a}});g.on("ended",function(){c.ajax(j,k,"10",g.currentTime(),g.currentTime());g.clearInterval(s)});if(c.isProgress){if(c.isMobile()){c.alertMessage("alert-danger",M.util.get_string("mobile_message","vod"),1e4)}if(!i){c.alertMessage("alert-danger",M.util.get_string("no_progress_period","vod"))}else{c.alertMessage("alert-info",M.util.get_string("window_close_message","vod"))}if(!q){c.alertMessage("alert-danger",M.util.get_string("error_study_end","local_ubonattend"))}}if(""!=w&&null!==w){require.config({enforceDefine:!1,paths:{externalLearningChecker:w}});require(["externalLearningChecker"],function(a){var d=null;if(b.getPlayers()[c.vodTagID]){d=b.getPlayers()[c.vodTagID]}a.init(x,d)})}console.log("vjsPluginChaptersMoreUrl : ",A);if(""!=A&&null!==A){require.config({enforceDefine:!1,paths:{extVjsPluginChaptersMoreUrl:A}});require(["extVjsPluginChaptersMoreUrl"],function(){var a=document.createElement("link");a.type="text/css";a.rel="stylesheet";a.href="https://cdn.coursemos.kr/vjspg/videojs-chapters-more/fade.css";var b=document.createElement("link");b.type="text/css";b.href="https://cdn.coursemos.kr/vjspg/videojs-chapters-more/videojs-chapters-more.css";b.rel="stylesheet";document.head.appendChild(a);document.head.appendChild(b);g.chaptersMore({src:D+"/"+C+"/chapter/"+e.language+"/"+C+"-"+e.language+".json"})})}if(""!=B&&null!==B){require.config({enforceDefine:!1,paths:{vjsPluginYtubeMoreUrl:B}});require(["vjsPluginYtubeMoreUrl"],function(){var a=document.createElement("link");a.type="text/css";a.href="https://cdn.coursemos.kr/vjspg/videojs-ytube-more/videojs-ytube-more.css";a.rel="stylesheet";document.head.appendChild(a);g.ytubeMore({apiUrlViewCount:"https://vcount.coursemos.kr/v1/vod",chaptersJson:D+"/"+C+"/chapter/"+e.language+"/"+C+"-"+e.language+".json",viewCountJson:D+"/"+C+"/viewCount/"+e.language+"/"+C+".json",infoCardsJson:D+"/"+C+"/infoCards/"+e.language+"/"+C+".json"})})}})};c.maxMoveError=function(a,b){if(a.isFullscreen()){a.exitFullscreen()}c.alertMessage("alert-danger alert-max-move",M.util.get_string("can_not_play","vod",c.secondToTime(Math.floor(b))));a.currentTime(b-1)};c.alertMessage=function(b,c,d){d="undefined"!=typeof d?d:5e3;var e=null;if(0<a(".vod-viewer .alert-message").length){e=parseInt(a(".vod-viewer .alert-message:last-child").css("top"))+parseInt(a(".vod-viewer .alert-message:last-child").outerHeight())+10}var f=null,g=!0;if(0<b.indexOf("alert-max-move")){if(0<a(".vod-viewer .alert-max-move").length){f=a(".vod-viewer .alert-max-move");f.html(c);g=!1}}if(g){f=a("<div class=\"alert alert-message\"></div>");if(null!==e){f.css("top",e)}f.addClass(b).html(c);a(".vod-viewer").append(f)}f.show();var h=setTimeout(function(){f.remove()},d);f.click(function(){a(this).remove();clearTimeout(h)})};c.ajax=function(d,e,f,g,h){if(0<e&&c.isLogin&&c.isProgress){var i={courseid:d,cmid:e,sesskey:M.cfg.sesskey},j={attempt:c.attempt,state:f,positionfrom:g,positionto:h,unixtime:Math.floor(new Date().getTime()/1e3)};if(c.isRSA){var k=new JSEncrypt;k.setPublicKey(c.publicKey);i=a.extend({},i,{progress:encodeURI(a.base64.encode(k.encrypt(JSON.stringify(j))))})}else{i=a.extend({},i,j)}i[coursemostype]="trackDetail";a.ajax({url:c.actionurl,data:i,cache:!1,global:!1,type:"post",success:function success(a){if(a.code==mesg.failure){alert(a.msg);return!1}else if(a.code==mesg.failureNotLogin){if(c.vodTagID){if(b.getPlayers()[c.vodTagID]){c.isLogin=!1;b.getPlayers()[c.vodTagID].pause();b.getPlayers()[c.vodTagID].dispose()}}alert(a.msg);if(opener){self.close();opener.document.replace(opener.document.location.href)}else{location.replace(location.href)}}return!0},error:function error(a,b){if(a.responseText){alert(b+" : "+a.responseText)}}})}};c.embeded=function(d,e,f,g){var h=c.videojsModule(e);require(h,function(){var e=a("#"+d).data("setup-lazy"),f=b("my-video",e);f.ready(function(){var a=this.textTrackSettings;a.setValues({backgroundOpacity:"0.5",edgeStyle:"none"});a.updateDisplay();this.hotkeys({seekStep:c.skipSecond(g)})})})};c.secondToTime=function(a){var b=new Date(null);b.setSeconds(a);return b.toISOString().substr(11,8)};c.app=function(a){window.location=a};c.isMobile=function(){if(navigator.userAgentData){return navigator.userAgentData.mobile}else{return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}};c.skipSecond=function(a){var b=5;if(/^[-+]?(\d+|Infinity)$/.test(a)){b=+a}return b};return{progress:c.progress,embeded:c.embeded,app:c.app}});
define ("mod_vpl/evaluationmonitor",["mod_vpl/vplutil"],function(a){return{init:function init(b){b.next=function(){window.location=b.nexturl};function c(c){a.showErrorMessage(c,{next:b.next})}var d,e={ajaxurl:b.ajaxurl,run:c,getLastAction:function getLastAction(){d()}};d=function(){a.requestAction("evaluate","evaluating",{},b.ajaxurl).done(function(d){a.webSocketMonitor(d,"evaluate","evaluating",e).done(b.next).fail(c)}).fail(c)};d()}}});
define ("mod_vpl/vplclipboard",["jquery","jqueryui","mod_vpl/vplutil"],function(a,b,c){return function VPLClipboard(b,d,e,f,g,h){var i=a("#"+b),j=i.find(".vpl_clipboard_label1"),k=i.find(".vpl_clipboard_label2"),l=i.find(".vpl_clipboard_entry1"),m=i.find(".vpl_clipboard_entry2");j.html(d);k.html(f);if(e){j.button().click(e)}if(g){k.button().click(g)}i.dialog({title:c.str("clipboard"),closeOnEscape:!0,autoOpen:!1,width:"auto",height:"auto",resizable:!0,dialogClass:"vpl_clipboard vpl_ide"});if(h){i.on("click",h)}this.show=function(){i.dialog("open")};this.hide=function(){i.dialog("close")};this.setEntry1=function(a){l.val(a);l.select()};this.getEntry1=function(){return l.val()};this.setEntry2=function(a){m.val(a)};this.getEntry2=function(){return m.val()};var n=i.siblings().find(".ui-dialog-title"),o=c.genIcon("clipboard","sw");o+=" "+c.str("clipboard");n.html(o);i.parent().css("overflow","")}});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}define ("mod_vpl/vplide",["jquery","jqueryui","mod_vpl/vplutil","mod_vpl/vplidefile","mod_vpl/vplidebutton","mod_vpl/vplterminal","mod_vpl/vplvnc"],function(t,e,l,n,a,o,d){var s,r=function(e,c){var C=this,V,k,S,I,N,H,P=c.minfiles||0,W=c.maxfiles||0,O=c.restrictededitor||c.example,R=c.example,E=c.isTeacher,j=!1,D=l.scrollBarWidth(),B=l.str,q=t("#"+e);t("head").append("<meta name=\"viewport\" content=\"initial-scale=1\">").append("<meta name=\"viewport\" width=\"device-width\">").append("<link rel=\"stylesheet\" href=\"../editor/VPLIDE.css\"/>");if("object"!=_typeof(q)){throw new Error("VPL: constructor tag_id not found")}var K={new:!0,rename:!0,delete:!0,save:!0,run:!0,edit:!0,debug:!0,evaluate:!0,import:!0,resetfiles:!0,sort:!0,multidelete:!0,acetheme:!0,console:!0,comments:!0};if("undefined"==typeof c.loadajaxurl){c.loadajaxurl=c.ajaxurl}(function(){var e=P<W;c.new=e;c.rename=e;c.delete=e;c.comments=c.comments&&!c.example;c.acetheme=!0})();c.sort=2<=W-P;c.multidelete=c.sort;c.import=!O;var U=function(e){if(!K[e]){return!0}return c[e]};c.console=U("run")||U("debug");if("undefined"==typeof c.fontSize){c.fontSize=12}c.fontSize=parseInt(c.fontSize);function p(i){if(O){i.originalEvent.dataTransfer.dropEffect="none"}else{i.originalEvent.dataTransfer.dropEffect="copy"}i.preventDefault()}function u(i){if(O){i.stopImmediatePropagation();return!1}var e=i.originalEvent.dataTransfer;if(0<e.files.length){l.readSelectedFiles(e.files,function(e){return V.addFile(e,!0,N,I)},function(){V.fileListVisibleIfNeeded()});i.stopImmediatePropagation();return!1}return!1}q.on("drop",u);q.on("dragover",p);function g(i){if(O){i.stopPropagation();return!1}return!0}var G=t("#vpl_menu"),X=new a(G,U),Y=t("#vpl_tr"),r=t("#vpl_filelist"),Q=t("#vpl_filelist_header"),J=t("#vpl_filelist_content"),Z=t("#vpl_tabs_ul"),$=t("#vpl_tabs"),ee=t("#vpl_results"),ie=t("#vpl_results_accordion");r.vplMinWidth=80;ee.vplMinWidth=100;function m(e,i){if("newHeader"in i){if(i.newHeader.hasClass("vpl_ide_accordion_t_grade")){return!1}}return!0}function h(){var a=t("#vpl_tabs_ul");t("#vpl_tabs").tabs();var o=t("#vpl_tabs").tabs("widget"),d=[],m=[],h=!0,f=this;(function(){var e;f.setVersion=function(i){e=i};f.getVersion=function(){return e}})();this.updateFileList=function(){f.generateFileList()};this.fileNameExists=function(e){for(var t=e.toLowerCase(),l=0;l<d.length;l++){if(d[l].getFileName().toLowerCase()==t){return l}}return-1};function e(e){for(var t=e.toLowerCase()+"/",l=0,n;l<d.length;l++){n=d[l].getFileName().toLowerCase()+"/";if(0===n.indexOf(t)||0===t.indexOf(n)){return!0}}return!1}function i(e,t){if(l.isBlockly(e)){return!1}if(l.isBlockly(t)){for(var n=0;n<d.length;n++){if(l.isBlockly(d[n].getFileName())){return!0}}}return!1}this.restrictedPaste=g;this.dropHandler=u;this.dragoverHandler=p;this.readOnly=R;this.restrictedEdit=O;this.adjustTabsTitles=k;this.minNumberOfFiles=P;this.scrollBarWidth=D;var v="";this.setClipboard=function(e){v=e};this.getClipboard=function(){return v};this.getTabPos=function(e){for(var t=0;t<m.length;t++){if(m[t]==e){return t}}return m.length};this.getTheme=function(){return c.theme};this.setTheme=function(e){c.theme=e;for(var t=0;t<d.length;t++){d[t].setTheme(e)}};this.addTab=function(e){a.append("<li id=\"vpl_tab_name"+e+"\">"+("<a href=\"#vpl_file"+e+"\"></a>")+"</li>");o.append("<div id=\"vpl_file"+e+"\" class=\"vpl_ide_file\"></div>")};this.removeTab=function(e){a.find("#vpl_tab_name"+e).remove();o.find("#vpl_file"+e).remove()};this.open=function(e){var i;if("object"==_typeof(e)){i=e}else{i=d[e]}if(i.isOpen()){return}var t=i.getId();f.addTab(t);m.push(i);X.setGetkeys(i.open());o.tabs("refresh");k(!1);l.delay("updateFileList",f.updateFileList);l.delay("updateMenu",N)};this.close=function(e){if(!e.isOpen()){return}var i,t=e.getId();e.close();f.removeTab(t);var n=f.getTabPos(e);m.splice(n,1);o.tabs("refresh");k(!1);f.fileListVisible(!0);l.delay("updateFileList",f.updateFileList);l.delay("adjustTabsTitles",k,!1);if(m.length>n){i=f.getFilePosById(m[n].getId());f.gotoFile(i,"c");return}if(0<n){i=f.getFilePosById(m[n-1].getId());f.gotoFile(i,"c")}};this.isClosed=function(e){return!d[e].isOpen()};this.fileListVisible=function(e){if(e===r.vplVisible){return}if(e){l.delay("fileListVisible",function(){r.vplVisible=!0;f.updateFileList();r.show();S()})}else{l.delay("fileListVisible",function(){r.vplVisible=!1;r.hide();S()})}};this.isFileListVisible=function(){return r.vplVisible};this.fileListVisibleIfNeeded=function(){if(this.isFileListVisible()){return}for(var e=0;e<d.length;e++){if(!d[e].isOpen()){this.fileListVisible(!0);return}}};this.setFontSize=function(e){c.fontSize=e;for(var t=0;t<d.length;t++){d[t].setFontSize(e)}we.setFontSize(e)};this.getFontSize=function(){return c.fontSize};this.addFile=function(t,a,o,r){if("string"!=typeof t.name||!l.validPath(t.name)){r(B("incorrect_file_name")+" ("+t.name+")");return!1}if(!0!==a){a=!1}var c=this.fileNameExists(t.name);if(-1!=c){if(a){d[c].setContent(t.contents);f.setModified();o();l.delay("updateFileList",f.updateFileList);return t}else{r(B("filenotadded",t.name));return!1}}if(e(t.name)||i("",t.name)){r(B("filenotadded",t.name));return!1}if(d.length>=W){r(B("maxfilesexceeded")+" ("+W+")");return!1}var p=l.getUniqueId(),u=new n(p,t.name,t.contents,this,s);if(1==t.encoding){u.extendToBinary()}else{if(l.isBlockly(t.name)){u.extendToBlockly()}else{u.extendToCodeEditor()}}u.setFileName(t.name);d.push(u);f.setModified();if(5<d.length){f.fileListVisible(!0)}o();return u};this.renameFile=function(t,n,a){var o=this.fileNameExists(t);try{if(-1==o){throw new Error("Internal error: File name not found")}if(o<P){throw new Error("Internal error: Renaming requested filename")}if(d[o].getFileName()==n){return!0}if(!l.validPath(n)||e(n)||i(t,n)){throw B("incorrect_file_name")}if(l.isBinary(t)&&l.fileExtension(t)!=l.fileExtension(n)){throw B("incorrect_file_name")}if(l.isBlockly(t)!=l.isBlockly(n)){throw B("incorrect_file_name")}d[o].setFileName(n)}catch(i){a(B("filenotrenamed",n)+": "+i);return!1}f.setModified();k(!1);l.delay("updateFileList",f.updateFileList);return!0};this.deleteFile=function(e,i,t){var n=this.fileNameExists(e);if(-1==n){t(B("filenotdeleted",e));return!1}if(n<P){t(B("filenotdeleted",e));return!1}f.setModified();f.close(d[n]);d.splice(n,1);l.delay("updateFileList",f.updateFileList);return!0};this.currentFile=function(){var e=o.tabs("option","active");if(e in m){var i=m[e];if(0===arguments.length){return i}var t=arguments[0];if("function"==typeof i[t]){var l=i[t],n=Array.prototype.slice(arguments);n.shift();return l.apply(i,n)}}return!1};this.currentPos=function(){return o.tabs("option","active")};this.getFileTab=function(e){for(var t=0;t<m.length;t++){if(m[t].getId()==e){return t}}return-1};this.getFilePosById=function(e){for(var t=0;t<d.length;t++){if(d[t].getId()==e){return t}}return-1};this.gotoFile=function(e,i){var t=d[e];f.open(t);o.tabs("option","active",f.getFileTab(t.getId()));if("c"!==i){t.gotoLine(parseInt(i,10))}t.focus()};this.gotoFileLink=function(e){var i=t(e),l=i.data("file"),n=-1;if(""<l){n=this.fileNameExists(l)}else{n=f.getFilePosById(i.data("fileid"))}if(0<=n){var a=i.data("line");if("undefined"==typeof a){a="c"}f.gotoFile(n,a);return!0}return!1};this.getFilesToSave=function(){for(var e=[],t=0,l;t<d.length;t++){l={};l.name=d[t].getFileName();l.contents=d[t].getContent();l.encoding=d[t].isBinary()?1:0;e.push(l)}return e};this.resetModified=function(){h=!1;for(var e=0;e<d.length;e++){d[e].resetModified()}l.delay("updateMenu",N);l.delay("updateFileList",f.updateFileList)};this.setModified=function(){h=!0;l.delay("updateFileList",f.updateFileList);l.delay("updateMenu",N)};this.isModified=function(){return h};this.length=function(){return d.length};this.clearAnnotations=function(){for(var e=0;e<d.length;e++){d[e].clearAnnotations()}};this.getFile=function(e){return d[e]};this.getFiles=function(){return d};this.getDirectoryStructure=function(){var t={isDir:!0,content:{}};function e(e){var i=d[e],l=i.getFileName(),n=l.split("/"),a=t;for(var o in n){if(n.hasOwnProperty(o)){var s=n[o];if(o==n.length-1){a.content[s]={isDir:!1,content:i,pos:e}}else{if(!a.content[s]){a.content[s]={isDir:!0,content:{}}}a=a.content[s]}}}}for(var l in d){if(d.hasOwnProperty(l)){e(l)}}return t};this.generateFileList=function(){if(!f.isFileListVisible()){return}function e(i,t,n){for(var a in i.content){if(i.content.hasOwnProperty(a)){var o=i.content[a];if(o.isDir){n.push(t+l.iconFolder()+l.sanitizeText(a));e(o,t+"<span class=\"vpl_ide_dirindent\"></span>",n)}else{var d=o.content,s=l.sanitizeText(a),r=l.sanitizeText(d.getFileName());if(d.isOpen()){s="<b>"+s+"</b>"}var c="href=\"#\" data-fileid=\""+d.getId()+"\" title=\""+r+"\"",p="<a "+c+">"+s+"</a>";if(d.isModified()){p=l.iconModified()+p}if(o.pos<P){p=p+l.iconRequired()}n.push(t+p)}}}}var t=f.getDirectoryStructure(),n=[],a="";e(t,"",n);for(var o=0;o<n.length;o++){a+=n[o]+"<br>"}J.html("<div>"+a+"</div>")};a.on("click","span.vpl_ide_closeicon",function(){V.close(V.currentFile())});a.on("dblclick","span.vpl_ide_closeicon",X.getAction("delete"));a.on("dblclick","a",X.getAction("rename"));J.on("dblclick","a",X.getAction("rename"))}this.updateEvaluationNumber=function(e){if("undefined"!=typeof e.nevaluations){var i=e.nevaluations;if("undefined"!=typeof e.reductionbyevaluation&&""<e.reductionbyevaluation&&0!=e.reductionbyevaluation){if(0!=e.freeevaluations){i=i+"/"+e.freeevaluations}i=i+" -"+e.reductionbyevaluation}X.setExtracontent("evaluate",i)}};this.lastResult=null;this.getTerminal=function(){return we};this.setResultGrade=function(e,i){var t="vpl_ide_accordion_t_grade",l="vpl_ide_accordion_c_grade";if(0==ie.find("."+l).length){ie.append("<div class=\""+t+"\"></div>");ie.append("<div class=\""+l+"\"></div>")}if("undefined"==typeof i){return 0<ie.find("h4."+t).length}var n=ie.find("."+t);if(""<e){n.replaceWith("<h4 class=\""+t+"\">"+e+"</h4>");return!0}else{n.replaceWith("<div class=\""+t+"\"></div>");return!1}};this.setResultTab=function(e,i,l){var n="vpl_ide_accordion_t_"+e,a="vpl_ide_accordion_c_"+e;if(0==ie.find("."+a).length){ie.append("<div class=\""+n+"\"></div>");ie.append("<div class=\""+a+"\"></div>")}if("undefined"==typeof l){return 0<ie.find("h4."+n).length}var o=ie.find("."+n),d=ie.find("."+a),s=t("<div>"+i+"</div>");s.find("h4").replaceWith(function(){return t("<h5>").append(t(this).contents())});if(d.html()==s.html()){return""<i}if(""<i){o.replaceWith("<h4 class=\""+n+"\">"+B(e)+"</h4>");d.replaceWith("<div class=\"ui-widget "+a+"\">"+s.html()+"</div>");return!0}else{o.replaceWith("<div class=\""+n+"\"></div>");d.replaceWith("<div class=\""+a+"\"></div>");return!1}};this.setResult=function(e,t){C.updateEvaluationNumber(e);var n=V.getFiles(),a=[],o;for(o=0;o<n.length;o++){a[o]=n[o].getFileName();n[o].clearAnnotations()}var d=!1,s,r=l.sanitizeText(e.grade),c,p;c=C.setResultGrade(r,e.grade);d=d||c;s=C.setResultTab("variables",e.variables,e.variables);d=d||s;p=l.processResult(e.compilation,a,n,!0,!1);s=C.setResultTab("compilation",p,e.compilation);d=d||s;p=l.processResult(e.evaluation,a,n,!1,!1);s=C.setResultTab("comments",p,e.evaluation);d=d||s;p=l.sanitizeText(e.execution);s=C.setResultTab("execution",p,e.execution);d=d||s;s=C.setResultTab("description",window.VPLDescription,window.VPLDescription);if(s&&"object"==("undefined"==typeof MathJax?"undefined":_typeof(MathJax))){var u=ie.find(".vpl_ide_accordion_c_description")[0];MathJax.Hub.Queue(["Typeset",MathJax.Hub,u])}d=d||s;if(d){ee.show();ee.vplVisible=!0;ie.accordion("refresh");ie.accordion("option","active",c?1:0);for(o=0;o<n.length;o++){for(var g=n[o].getAnnotations(),m=0;m<g.length;m++){if(t||"error"==g[m].type){V.gotoFile(o,g[m].row+1);break}}}}else{ee.hide();ee.vplVisible=!1}l.delay("autoResizeTab",S)};ie.accordion({heightStyle:"fill",header:"h4",animate:!1,beforeActivate:m});ee.width(2*ee.vplMinWidth);ie.on("click","a",function(e){if(V.gotoFileLink(e.currentTarget)){e.preventDefault()}});ee.vplVisible=!1;ee.hide();r.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");Q.text(B("filelist"));Q.html(l.iconFolder()+Q.html());Q.addClass("ui-widget-header ui-button-text-only ui-corner-all");J.addClass("ui-widget ui-corner-all");r.width(2*r.vplMinWidth);r.on("click","a",function(e){e.preventDefault();V.gotoFileLink(e.currentTarget)});r.vplVisible=!1;r.hide();var te=!1;function f(){if(!1===te){te=($.outerWidth(!0)-$.width())/2}return te}function v(i,e){var t=e.position.left-e.originalPosition.left,l;if(0!=t){l=$.width()+r.width()-r.vplMinWidth;$.resizable("option","maxWidth",l);r.width(r.vplOriginalWidth+t)}else{l=$.width()+ee.width()-ee.vplMinWidth;$.resizable("option","maxWidth",l);var n=e.size.width-e.originalSize.width;ee.width(ee.vplOriginalWidth-n)}V.currentFile("adjustSize")}var le={containment:"parent",resize:v,start:function start(){t(window).off("resize",S);$.resizable("option","minWidth",100);if(ee.vplVisible){ee.vplOriginalWidth=ee.width()}if(r.vplVisible){r.vplOriginalWidth=r.width()}},stop:function stop(i,e){v(i,e);$.resizable("option","maxWidth",1e5);$.resizable("option","minWidth",0);S();t(window).on("resize",S)},handles:""};$.resizable(le);function _(){var e=0;e+=r.vplVisible?1:0;e+=ee.vplVisible?2:0;$.resizable("destroy");le.handles=["e","w","e","e, w"][e];le.disable=0===e;$.resizable(le)}function b(){var e=t(window).outerHeight();e-=G.offset().top+G.height()+(j?f():20);if(150>e){e=150}Y.height(e);var i=e-3*f();$.height(i);if(ee.vplVisible){ee.height(i+f());ie.accordion("refresh")}if(r.vplVisible){J.height(i-(Q.outerHeight()+f()));r.height(i)}}k=function(e){var i=$.width(),l=0;Z.width(1e5);var n=Z.children("li:visible").last();if(n.length){var a=Z.parent().scrollLeft();l=a+n.position().left+n.width()+te;Z.width(l);var o=V.currentFile();if(o&&e){var d=t(o.getTabNameId()),s=a+d.position().left;s-=(i-d.outerWidth())/2;if(0>s){s=0}Z.parent().finish().animate({scrollLeft:s},"slow")}}if(l<i){Z.width("")}};S=function(){var e=$.width(),i=G.width(),t=!1;_();Y.width(G.outerWidth());if(r.vplVisible){var l=r.outerWidth()+te;e+=l;if(100<=l){i-=l;$.css("left",l)}else{t=!0}}else{$.css("left",0)}if(ee.vplVisible){var n=ee.outerWidth()+te;e+=n;i-=n;if(100>i){t=!0}}if(t){var a=G.width()/e,o=0;if(r.vplVisible){o=r.width()*a;r.width(o-te);o+=te;$.css("left",o)}$.width($.width()*a);if(ee.vplVisible){ee.width(G.width()-(o+$.width()+te))}}else{$.width(i)}k(!0);b();V.currentFile("adjustSize")};function F(){V.currentFile("focus")}var ne=t.extend({},{close:F},l.dialogbaseOptions);function T(e,i){return l.showMessage(e,t.extend({},ne,i))}I=function(e){return l.showErrorMessage(e,{close:F})};var ae=t("#vpl_ide_dialog_new");function w(e){if(!("click"==e.type||"keypress"==e.type&&13==e.keyCode)){return!0}ae.dialog("close");var i={name:t("#vpl_ide_input_newfilename").val(),contents:"",encoding:0},l=V.addFile(i,!1,N,I);if(l){V.open(l);$.tabs("option","active",V.getTabPos(l));l.focus();return!0}return!1}var oe={};oe[B("ok")]=w;oe[B("cancel")]=function(){t(this).dialog("close")};ae.find("input").on("keypress",w);ae.dialog(t.extend({},ne,{title:B("create_new_file"),buttons:oe}));l.setDialogTitleIcon(ae,"new");var de=t("#vpl_ide_dialog_rename");function y(e){if(!("click"==e.type||"keypress"==e.type&&13==e.keyCode)){return}de.dialog("close");V.renameFile(V.currentFile("getFileName"),t("#vpl_ide_input_renamefilename").val(),I);e.preventDefault()}de.find("input").on("keypress",y);oe[B("ok")]=y;de.dialog(t.extend({},ne,{open:function open(){t("#vpl_ide_input_renamefilename").val(V.currentFile("getFileName"))},title:B("rename_file"),buttons:oe}));l.setDialogTitleIcon(de,"rename");oe[B("ok")]=function(){t(this).dialog("close")};var se=t("#vpl_ide_dialog_comments");se.dialog(t.extend({},ne,{title:B("comments"),width:"40em",buttons:oe}));l.setDialogTitleIcon(se,"comments");t("#vpl_ide_input_comments").width("30em");var re=t("#vpl_ide_dialog_about"),ce={};ce[B("ok")]=function(){t(this).dialog("close")};var pe=t("#vpl_ide_dialog_shortcuts");pe.dialog(t.extend({},ne,{open:function open(){var e=X.getShortcuts(V.currentFile("getEditor"));t("#vpl_ide_dialog_shortcuts").html(e)},title:B("shortcuts"),width:400,height:300,buttons:ce}));pe.dialog("option","height",300);l.setDialogTitleIcon(pe,"shortcuts");ce[B("shortcuts")]=function(){t(this).dialog("close");pe.dialog("open")};re.dialog(t.extend({},ne,{open:function open(){var e=X.getShortcuts(V.currentFile("getEditor"));re.next().find("button").filter(function(){return t(this).text()==B("shortcuts")}).button(""!=e?"enable":"disable")},title:B("about"),width:400,height:300,buttons:ce}));re.dialog("option","height",300);l.setDialogTitleIcon(re,"about");var ue=t("#vpl_ide_dialog_sort"),ge={};ge[B("ok")]=function(){var e=V.getFiles(),l=[],n=0,a=t("#vpl_sort_list li");if(a.length!=e.length){return}a.each(function(){var i=parseInt(this.id.replace(/[^\d]*/,""));l.push(e[i])});for(n=0;n<a.length;n++){e[n]=l[n]}V.setModified();t(this).dialog("close")};ge[B("cancel")]=function(){t(this).dialog("close")};ue.dialog(t.extend({},ne,{title:B("sort"),buttons:ge,open:function open(){var e=t("#vpl_sort_list");e.html("");for(var l=V.getFiles(),n=0,a;n<l.length;n++){a=t("<li id=\"vpl_fsort_"+n+"\"class=\"ui-widget-content\"></li>");if(n<P){a.addClass("ui-state-disabled")}a.text(n+1+"-"+l[n].getFileName());e.append(a)}e.sortable({items:"li:not(.ui-state-disabled)",placeholder:"ui-state-highlight",start:function start(e,i){i.item.addClass("ui-state-highlight")},stop:function stop(e,i){i.item.removeClass("ui-state-highlight")}});e.disableSelection()},maxHeight:400}));l.setDialogTitleIcon(ue,"sort");var me=t("#vpl_ide_dialog_multidelete"),he={};he[B("selectall")]=function(){t(this).find("input").prop("checked",!0)};he[B("deselectall")]=function(){t(this).find("input").prop("checked",!1)};he[B("deleteselected")]=function(){var e=V.getFiles(),n=[],a=t("#vpl_multidelete_list label");a.each(function(){var i=t(this);if(i.find("input").prop("checked")){var l=i.data("fileid");n.push(e[l].getFileName())}});for(var o=0;o<n.length;o++){V.deleteFile(n[o],!1,I)}l.delay("updateMenu",N);l.delay("updateFileList",V.updateFileList);t(this).dialog("close")};he[B("cancel")]=function(){t(this).dialog("close")};me.dialog(t.extend({},ne,{title:B("multidelete"),buttons:he,open:function open(){var e=t("#vpl_multidelete_list");e.html("");for(var n=V.getFiles(),a=P;a<n.length;a++){var o=l.sanitizeText(n[a].getFileName()),d=t("<label><input type=\"checkbox\"> "+o+"</label>");d.data("fileid",a);e.append(d);e.append("<br>")}e.find("label").button()},maxHeight:400,maxWidth:400}));l.setDialogTitleIcon(me,"multidelete");var fe=t("#vpl_ide_dialog_fontsize"),ve=t("#vpl_ide_dialog_fontsize .vpl_fontsize_slider"),_e={};_e[B("ok")]=function(){var e=ve.slider("value");V.setFontSize(e);t(this).dialog("close");t.ajax({async:!0,type:"POST",url:"../editor/userpreferences.json.php",data:JSON.stringify({fontSize:e}),contentType:"application/json; charset=utf-8",dataType:"json"})};_e[B("cancel")]=function(){V.setFontSize(ve.data("vpl_fontsize"));t(this).dialog("close")};_e[B("reset")]=function(){ve.slider("value",12)};fe.dialog(t.extend({},ne,{title:B("fontsize"),buttons:_e,open:function open(){ve.data("vpl_fontsize",V.getFontSize());ve.slider("value",V.getFontSize())}}));ve.slider({min:1,max:48,change:function change(){var e=ve.slider("value");V.setFontSize(e);fe.find(".vpl_fontsize_slider_value").text(e)}});l.setDialogTitleIcon(fe,"fontsize");var be=t("#vpl_ide_dialog_acetheme"),Fe=t("#vpl_ide_dialog_acetheme select"),Te={};Te[B("ok")]=function(){V.setTheme(Fe.val());t(this).dialog("close");l.setUserPreferences({aceTheme:Fe.val()})};Te[B("cancel")]=function(){V.setTheme(Fe.data("acetheme"));t(this).dialog("close")};Te[B("reset")]=function(){Fe.val(Fe.data("acetheme"));V.setTheme(Fe.val())};be.dialog(t.extend({},ne,{title:B("theme"),buttons:Te,modal:!1,open:function open(){Fe.data("acetheme",V.getTheme());Fe.val(V.getTheme())}}));Fe.on("change",function(){V.setTheme(Fe.val())});l.setDialogTitleIcon(be,"theme");var we=new o("vpl_dialog_terminal","vpl_terminal",B),ye=new d("vpl_dialog_vnc",B),xe=we,Le=t("#vpl_ide_input_file");Le.on("change",function fileSelectHandler(){l.readSelectedFiles(this.files,function(e){return V.addFile(e,!0,N,I)},function(){V.fileListVisibleIfNeeded()})});X.add({name:"filelist",originalAction:function originalAction(){V.fileListVisible(!V.isFileListVisible());l.delay("updateMenu",N);l.delay("autoResizeTab",S);l.delay("updateFileList",V.updateFileList)},bindKey:{win:"Ctrl-L",mac:"Ctrl-L"}});X.add({name:"new",originalAction:function originalAction(){if(V.length()<W){ae.dialog("open")}},bindKey:{win:"Alt-N",mac:"Option-N"}});X.add({name:"rename",originalAction:function originalAction(){var e=V.currentFile();if(e&&V.getFilePosById(e.getId())>=P){de.dialog("open")}},bindKey:{win:"Ctrl-R",mac:"Ctrl-R"}});X.add({name:"delete",originalAction:function originalAction(){var e=V.currentFile();if(!e){return}var i=e.getFileName(),t=B("delete_file_fq",i);T(t,{ok:function ok(){V.deleteFile(i,I)},title:B("delete_file_q"),icon:"trash"})},bindKey:{win:"Ctrl-D",mac:"Ctrl-D"}});X.add({name:"close",originalAction:function originalAction(){var e=V.currentFile();if(!e){return}V.close(e)},bindKey:{win:"Alt-W",mac:"Option-W"}});X.add({name:"import",originalAction:function originalAction(){Le.val("");Le.trigger("click")},bindKey:{win:"Ctrl-I",mac:"Ctrl-I"}});X.add({name:"sort",originalAction:function originalAction(){ue.dialog("open")},bindKey:{win:"Ctrl-O",mac:"Ctrl-O"}});X.add({name:"multidelete",originalAction:function originalAction(){me.dialog("open")}});X.add({name:"fontsize",originalAction:function originalAction(){fe.dialog("open")}});X.add({name:"theme",originalAction:function originalAction(){be.dialog("open")}});X.add({name:"print",originalAction:function originalAction(){window.print()},bindKey:{win:"Alt-P",mac:"Command-P"}});X.add({name:"undo",originalAction:function originalAction(){V.currentFile("undo")}});X.add({name:"redo",originalAction:function originalAction(){V.currentFile("redo")}});X.add({name:"select_all",editorName:"selectall",originalAction:function originalAction(){V.currentFile("selectAll")}});X.add({name:"find",originalAction:function originalAction(){V.currentFile("find")}});X.add({name:"find_replace",editorName:"replace",originalAction:function originalAction(){V.currentFile("replace")}});X.add({name:"next",editorName:"findnext",originalAction:function originalAction(){V.currentFile("next")}});X.add({name:"fullscreen",originalAction:function originalAction(){var e="header, nav, footer, aside, .dropdown, #page-header, div.navbar, #nav-drawer";e+=", div.tabtree, #dock, .breadcrumb-nav, .moodle-actionmenu";if(j){q.removeClass("vpl_ide_root_fullscreen");t("body").removeClass("vpl_body_fullscreen");X.setText("fullscreen","fullscreen");t(e).show();t("#vpl_ide_user").hide();j=!1}else{t("body").addClass("vpl_body_fullscreen").scrollTop(0);t(e).hide();q.addClass("vpl_ide_root_fullscreen");X.setText("fullscreen","regularscreen");if(c.username){t("#vpl_ide_user").show()}j=!0}F();setTimeout(S,10)},bindKey:{win:"Alt-F",mac:"Ctrl-F"}});X.add({name:"download",originalAction:function originalAction(){window.location=c.download}});function x(){l.requestAction("resetfiles","",{},c.ajaxurl).done(function(e){var i=e.files;for(var t in i){if(i.hasOwnProperty(t)){V.addFile(i[t],!0,l.doNothing,I)}}V.fileListVisibleIfNeeded();l.delay("updateMenu",N)}).fail(I)}X.add({name:"resetfiles",originalAction:function originalAction(){T(B("sureresetfiles"),{title:B("resetfiles"),ok:x,icon:"resetfiles"})}});X.add({name:"save",originalAction:function originalAction(){var i={files:V.getFilesToSave(),comments:t("#vpl_ide_input_comments").val(),version:V.getVersion()};if(JSON.stringify(i).length>c.postMaxSize){I(B("maxpostsizeexceeded"));return}function e(){l.requestAction("save","saving",i,c.ajaxurl).done(function(t){if(t.requestsconfirmation){T(t.question,{title:B("saving"),icon:"alert",yes:function yes(){i.version=t.version;e()}})}else{V.resetModified();V.setVersion(t.version);X.setTimeLeft(t);l.delay("updateMenu",N);if(l.monitorRunning()){l.requestAction("update","updating",i,c.ajaxurl)}}}).fail(I)}e()},bindKey:{win:"Ctrl-S",mac:"Command-S"}});function L(e,i,t){if(!t){t={}}if(!xe.isConnected()){l.requestAction(e,"",t,c.ajaxurl).done(function(t){l.webSocketMonitor(t,e,i,H)}).fail(I)}}function M(){L("run","running",{XGEOMETRY:ye.getCanvasSize()})}X.add({name:"run",originalAction:function originalAction(){H.setLastAction(M);M()},bindKey:{win:"Ctrl-F11",mac:"Command-U"}});function A(){L("debug","debugging",{XGEOMETRY:ye.getCanvasSize()})}X.add({name:"debug",originalAction:function originalAction(){H.setLastAction(A);A()},bindKey:{win:"Alt-F11",mac:"Option-U"}});function z(){L("evaluate","evaluating")}X.add({name:"evaluate",originalAction:function originalAction(){H.setLastAction(z);z()},bindKey:{win:"Shift-F11",mac:"Command-Option-U"}});X.add({name:"comments",originalAction:function originalAction(){se.dialog("open")}});X.add({name:"console",originalAction:function originalAction(){if(xe.isOpen()){xe.close()}else{xe.show()}}});X.add({name:"user"});X.add({name:"about",originalAction:function originalAction(){re.dialog("open")}});X.add({name:"timeleft",originalAction:function originalAction(){X.toggleTimeLeft()}});X.add({name:"more",originalAction:function originalAction(){var e=t("#vpl_ide_menuextra");if(e.is(":visible")){X.setText("more","more",l.str("more"));e.hide()}else{X.setText("more","less",l.str("less"));e.show()}l.delay("updateMenu",N);l.delay("autoResizeTab",S)}});G.addClass("ui-widget-header ui-corner-all");var Me="";Me+=X.getHTML("more");Me+=X.getHTML("save");Me+="<span id='vpl_ide_mexecution'>";Me+=X.getHTML("run");Me+=X.getHTML("debug");Me+=X.getHTML("evaluate");Me+=X.getHTML("comments");Me+=X.getHTML("console");Me+="</span> ";Me+="<span id='vpl_ide_menuextra'>";Me+="<span id='vpl_ide_file'>";Me+=X.getHTML("filelist");Me+=X.getHTML("new");Me+=X.getHTML("rename");Me+=X.getHTML("delete");Me+=X.getHTML("import");Me+=X.getHTML("download");Me+=X.getHTML("resetfiles");Me+=X.getHTML("sort");Me+=X.getHTML("multidelete");Me+=X.getHTML("fontsize");Me+=X.getHTML("theme");Me+="</span> ";Me+="<span id='vpl_ide_edit'>";Me+=X.getHTML("undo");Me+=X.getHTML("redo");Me+=X.getHTML("select_all");Me+=X.getHTML("find");Me+=X.getHTML("find_replace");Me+=X.getHTML("next");Me+="</span> ";Me+="</span> ";Me+=X.getHTML("fullscreen")+" ";Me+=X.getHTML("about")+" ";Me+=X.getHTML("user")+" ";Me+=X.getHTML("timeleft");Me+="<div class=\"clearfix\"></div>";G.append(Me);t("#vpl_ide_more").button();t("#vpl_ide_save").button();t("#vpl_ide_menuextra").hide();t("#vpl_ide_file").controlgroup();t("#vpl_ide_edit").controlgroup();t("#vpl_ide_mexecution").controlgroup();t("#vpl_ide_fullscreen").button();t("#vpl_ide_acetheme").button();t("#vpl_ide_about").button();t("#vpl_ide_user").button().css("float","right").hide();t("#vpl_ide_timeleft").button().css("float","right").hide();t("#vpl_menu .ui-button").css("padding","6px");t("#vpl_menu .ui-button-text").css("padding","0");for(var Ae=["filelist","more","fullscreen","about","resetfiles","download","comments","console","import","fontsize","timeleft"],ze=0;ze<Ae.length;ze++){X.enable(Ae[ze],!0)}X.setExtracontent("user",c.username);X.setTimeLeft(c);N=function(){var e,t=V.currentFile(),n=V.length();if(n){$.show()}else{$.hide()}if(V.isFileListVisible()){X.setText("filelist","filelistclose",l.str("filelist"))}else{X.setText("filelist","filelist",l.str("filelist"))}var a=V.isModified();X.enable("save",a);var o=l.monitorRunning();if(o){X.setText("run","running")}else{X.setText("run","run")}X.enable("run",!o&&(!a||c.example)&&U("run"));X.enable("debug",!o&&(!a||c.example)&&U("debug"));X.enable("evaluate",!o&&(!a||c.example)&&U("evaluate"));X.enable("download",!a);X.enable("new",n<W);X.enable("sort",1<n-P);X.enable("multidelete",1<n-P);X.enable("theme",!0);var d;if(!t||0===n){d=["rename","delete","undo","redo","select_all","find","find_replace","next"];for(e=0;e<d.length;e++){X.enable(d[e],!1)}return}var s=V.getFilePosById(t.getId());X.enable("rename",s>=P&&0!==n);X.enable("delete",s>=P&&0!==n);X.enable("undo",t.hasUndo());X.enable("redo",t.hasRedo());X.enable("select_all",t.hasSelectAll());X.enable("find",t.hasFind());X.enable("find_replace",t.hasFindReplace());X.enable("next",t.hasNext());l.delay("updateFileList",V.updateFileList)};H={open:N,close:N,getConsole:function getConsole(){return xe},setResult:C.setResult,ajaxurl:c.ajaxurl,run:function run(e,i,n){var a=/^([^:]*):?(.*)/i.exec(e),o=a[1];if("terminal"==o||"webterminal"==o){if(xe&&xe.isOpen()){xe.close()}xe=we;we.connect(i.executionURL,function(){n.close();F()});if("webterminal"==o){var d=(i.secure?"https":"http")+"://"+i.server+":"+i.portToUse;d+="/favicon.ico";var s=t("<img>");s.attr("src",d);s.attr("style","display:none");t("body").append(s)}}else if("vnc"==o){if(xe&&xe.isOpen()){xe.close()}xe=ye;ye.connect(i.secure,i.server,i.portToUse,i.VNCpassword,i.executionPath,function(){n.close();F()})}else if("browser"==o){var r=(i.secure?"https":"http")+"://"+i.server+":"+i.portToUse+"/";r+=a[2]+"/httpPassthrough";if(E){r+="?private"}var c="<a href=\""+r+"\" target=\"_blank\">";c+=l.str("open")+"</a>";var p={width:200,icon:"run",title:l.str("run")};T(c,p)}else{l.log("Type of run error "+e,!0)}},lastAction:!1,getLastAction:function getLastAction(){var e=this.lastAction;this.lastAction=!1;return e},setLastAction:function setLastAction(e){this.lastAction=e}};$.on("tabsactivate",function(){V.currentFile("focus");l.delay("updateMenu",N);l.delay("autoResizeTab",S)});var Ce=t(window);Ce.on("resize",S);if(!c.example){Ce.on("beforeunload",function(){if(V.isModified()){return B("changesNotSaved")}})}V=new h;S();(function(){var i=G.width();function e(){var e=G.width();if(i!=e){i=e;S()}}e();setInterval(e,1e3)})();V.resetModified();l.requestAction("load","loading",c,c.loadajaxurl).done(function(e){for(var n=!0,a=e.files,o=!1,d=0;d<a.length;d++){var s=a[d],p=V.addFile(s,!1,N,I);if(p){p.resetModified();if(d<P||5>=a.length){V.open(p)}else{o=!0}}else{n=!1}}$.tabs("option","active",0);if(e.compilationexecution){C.setResult(e.compilationexecution,!1)}X.setTimeLeft(e);if(""<e.comments){t("#vpl_ide_input_comments").val(e.comments)}if(n){V.resetModified()}else{V.setModified()}if(0===V.length()&&0<W){X.getAction("new")()}else if(!c.saved){V.setModified()}V.setFontSize(c.fontSize);V.setVersion(e.version);V.fileListVisible(o);l.afterAll("AfterLoadFiles",function(){N();S();k(!0)})}).fail(I)};window.VPLIDE=r;return{init:function init(e,i){s=new r(e,i)}}});
define ("mod_vpl/vplidebinaryfile",["jquery","mod_vpl/vplutil"],function(a,b){return function(){this.isBinary=function(){return!0};var d=this.setContent;this.setContent=function(a){d.call(this,a);this.setModified();this.updateDataURL()};this.updateDataURL=function(){var c=this.getFileName(),d=this.getContent(),e=this.getTId();if(b.isImage(c)){var f="data:"+b.getMIME(c)+";base64,";a(e).find("img").attr("src",f+d)}else{a(e).find("img").attr("src","")}};this.adjustSize=function(){if(!this.isOpen()){return!1}var b=a(this.getTId());if(0===b.length){return!1}var c=b.parent(),d=c.height();d-=b.position().top;if(d!=b.height()){b.height(d);return!0}return!1};this.open=function(){this.showFileName();var c=this.getFileName(),d=this.getTId();this.setOpen(!0);if(b.isImage(c)){a(d).addClass("vpl_ide_img").append("<img />");this.updateDataURL()}else{a(d).addClass("vpl_ide_binary").text(b.str("binaryfile"))}};this.close=function(){this.setOpen(!1)}}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("mod_vpl/vplideblocklyfile",["jquery","mod_vpl/vplutil"],function(a,b){return function(){var c=this,d=this.getVPLIDE();this.firstContent=!0;this.workspaceInstance=!1;var e=function(){if("undefined"==typeof Blockly.PHP.workspaceToCodeOld){Blockly.PHP.workspaceToCodeOld=Blockly.PHP.workspaceToCode;Blockly.PHP.workspaceToCode=function(a){return"<?php\n"+Blockly.PHP.workspaceToCodeOld(a)}}if("undefined"==typeof Blockly.Python.workspaceToCodeOld){Blockly.Python.workspaceToCodeOld=Blockly.Python.workspaceToCode;Blockly.Python.workspaceToCode=function(a){return"# -*- coding: utf-8 -*-\n"+Blockly.Python.workspaceToCodeOld(a)}}},f=this.adjustSize;this.adjustSize=function(){if(f.call(this)){var b=a(this.getTId());if(0===b.length){return!1}var c=b.parent(),d=c.height();d-=b.position().top;b.height(d);a("#"+this.bdiv).height(d);a("#"+this.bdiv).width(b.width());Blockly.svgResize(this.workspaceInstance);return!1}return!1};this.undo=function(){if(this.isOpen()){this.workspaceInstance.undo(!1)}};this.redo=function(){if(this.isOpen()){this.workspaceInstance.undo(!0)}};this.interpreter=!1;this.animateRun=!1;this.RUNSTATE=1;this.STEPSTATE=2;this.STOPSTATE=3;this.executionState=this.STOPSTATE;this.goNext=!1;this.initRun=function(a){var e=d.getTerminal();if(e.isConnected()){e.closeLocal()}this.animateRun=a;Blockly.JavaScript.STATEMENT_PREFIX="highlightBlock(%1);\n";Blockly.JavaScript.addReservedWords("highlightBlock");var f=Blockly.JavaScript.workspaceToCode(c.workspaceInstance);c.interpreter=new Interpreter(f,function initApi(a,f){a.setProperty(f,"alert",a.createNativeFunction(function wrapperAlert(b){b="string"!=typeof b?b.toString()+"\r\n":b+"\r\n";return a.createPrimitive(e.writeLocal(b))}));a.setProperty(f,"prompt",a.createAsyncFunction(function wrapperPrompt(a,b){a="string"!=typeof a?a.toString():""+a;e.writeLocal(a);e.setDataCallback(function(a){e.writeLocal("\n");b(a)})}));a.setProperty(f,"highlightBlock",a.createNativeFunction(function wrapperHighlightBlock(a){if(a==c.getBreakpoint()){c.executionState=c.STEPSTATE;c.updateRunButtons();d.getTerminal().setMessage(b.str("breakpoint"))}if(c.animateRun||c.executionState==c.STEPSTATE){c.workspaceInstance.highlightBlock(a)}c.goNext=!1}))});e.connectLocal(c.stop,b.doNothing)};this.reservedWords={Infinity:!0,Array:!0,Boolean:!0,Date:!0,Error:!0,EvalError:!0,Function:!0,JSON:!0,Math:!0,NaN:!0,Number:!0,Object:!0,RangeError:!0,ReferenceError:!0,RegExp:!0,String:!0,SyntaxError:!0,TypeError:!0,URIError:!0,alert:!0,arguments:!0,constructor:!0,eval:!0,highlightBlock:!0,isFinite:!0,isNaN:!0,parseFloat:!0,parseInt:!0,prompt:!0,self:!0,this:!0,window:!0};(function(){var a=null,b=null;c.getBreakpoint=function(){return a};c.setBreakpoint=function(){a=b};c.removeBreakpoint=function(){a=null};c.setLastSelection=function(a){b=a};c.isSelectingBreakpoint=function(){return null===a&&null!==b}})();this.getVarValue=function(a){var d="";if(null===a){d="<b>null</b>"}else if(a!=void 0){var e=_typeof(a);if("string"==e){d="\""+b.sanitizeText(a)+"\""}else if("boolean"==e){d="<b>"+a+"</b>"}else if("object"==e&&"Array"===a.class){d="[";for(var f=a.properties,g=0;g<f.length;g++){d+=c.getVarValue(f[g]);if(g!=f.length-1){d+=", "}}d+="]"}else if("object"==e){d="<b>"+a.toString()+"</b>"}else{d+=""+a}}return d};this.getVariables=function(a){var d="";for(var e in a){if(!0===this.reservedWords[e]){continue}var f=a[e];if(f!=void 0&&!("Function"===f.class)){var g=b.sanitizeText(c.getVarValue(f));d+="<b>"+e+"</b>:&nbsp;"+g+"<br>\n"}}return d};this.getParameters=function(a){for(var b="(",c=0;c<a.length;c++){b+=""+a[c];if(c<a.length-1){b+=", "}}return b+")"};this.showStack=function(a){for(var b=0,e="<table class=\"generaltable\">",f=a.stateStack,g="<tr><td>0</td><td><b>Globals</b></td>",h=0,j;h<f.length;h++){j=f[h];if(""<g&&("CallExpression"==j.node.type||h==f.length-1)){e+=g+"<td>"+c.getVariables(j.scope.properties);e+="</td></tr>"}if("CallExpression"==j.node.type){if(!0!==c.reservedWords[j.node.callee.name]&&j.node.callee.name!=void 0){b++;g="<tr><td>"+b+"</td>";g+="<td>"+j.node.callee.name+c.getParameters(j.arguments_)+"</td>"}else{g=""}}}e+="</table>";d.setResult({variables:e})};this.runLoop=function(){if(!c.interpreter){return}c.goNext=!0;for(var a=0;3e4>a&&c.goNext;a++){if(c.executionState==c.STOPSTATE){break}if(!c.interpreter||!c.interpreter.step()){c.executionState=c.STOPSTATE;c.updateRunButtons();break}}if(c.executionState==c.STOPSTATE){c.workspaceInstance.highlightBlock(-1);d.getTerminal().closeLocal();d.setResult({variables:""});return}if(c.executionState==c.RUNSTATE){if(c.animateRun){setTimeout(c.runLoop,1e3);c.showStack(c.interpreter)}else{setTimeout(c.runLoop,0)}}else{c.showStack(c.interpreter)}};this.start=function(){if(c.executionState!=c.STOPSTATE){return}c.initRun(!1);c.executionState=c.RUNSTATE;c.updateRunButtons();d.getTerminal().setMessage(b.str("start"));c.runLoop()};this.startAnimate=function(){if(c.executionState!=c.STOPSTATE){return}c.initRun(!0);c.executionState=c.RUNSTATE;c.updateRunButtons();d.getTerminal().setMessage(b.str("startanimate"));c.runLoop()};this.stop=function(){c.executionState=c.STOPSTATE;c.workspaceInstance.highlightBlock(-1);c.updateRunButtons();d.getTerminal().setMessage(b.str("stop"));d.getTerminal().closeLocal();c.interpreter=!1;d.setResult({variables:""})};this.pause=function(){if(c.executionState!=c.RUNSTATE){return}c.executionState=c.STEPSTATE;d.getTerminal().setMessage(b.str("pause"));c.updateRunButtons()};this.resume=function(){if(c.executionState!=c.STEPSTATE){return}c.executionState=c.RUNSTATE;d.getTerminal().setMessage(b.str("resume"));c.updateRunButtons();c.runLoop()};this.step=function(){if(c.executionState==c.STOPSTATE){c.initRun(!0)}c.executionState=c.STEPSTATE;c.updateRunButtons();d.getTerminal().setMessage(b.str("step"));c.runLoop()};this.hasUndo=function(){return!0};this.hasRedo=function(){return!0};this.oldSetFileName=this.setFileName;this.generatorMap={py:"Python",dart:"Dart",js:"JavaScript",lua:"Lua",php:"PHP"};this.generator="";this.setFileName=function(a){var d=this.getFileName(),e=b.fileExtension(d);if(!c.oldSetFileName(a)){b.log("Blockly setFileName: name no acepted "+a);return!1}b.log("Blockly set filename "+a);var f=/\.([^.]+)\.blockly[123]?$/.exec(a),g=/(.+)\.blockly[123]?$/.exec(a);if(null!==f&&null!==g&&"string"==typeof this.generatorMap[f[1]]){this.generator=this.generatorMap[f[1]];this.generatedFilename=g[1];b.log("Blockly generator "+this.generator+" for filename "+this.generatedFilename);this.updateGeneratedCode()}else{this.generator=""}if(e!=b.fileExtension(a)){b.log("Blockly extension changed");b.afterAll("reopenBlockly",function(){b.log("reopenBlockly");c.close();c.open()})}return!0};this.updateGeneratedCode=function(){if(c.blocklyNotLoaded){return}var a=c.getFileManager();if(""!=c.generator){b.log("Blockly generate "+c.generator);var d=Blockly[c.generator].workspaceToCode(c.workspaceInstance),e=a.fileNameExists(c.generatedFilename);if(-1==e){b.log("try to create "+c.generatedFilename+" files");a.addFile({name:c.generatedFilename,contents:""},!1,b.doNothing,b.doNothing);e=a.fileNameExists(c.generatedFilename)}if(-1!=e){var f=a.getFile(e);if(f.getContent()!=d){f.setContent(d);f.change();f.gotoLine(1);f.setReadOnly(!0)}}}};this.changeCode=function(a){b.log(a);if("ui"==a.type&&"selected"==a.element){c.setLastSelection(a.newValue);return}if("ui"==a.type&&"category"==a.element&&a.newValue==b.str("run")){b.longDelay("updateRunButtons",c.updateRunButtons);return}if(c.firstContent){if("finished_loading"==a.type){c.firstContent=!1;c.workspaceInstance.clearUndo()}else{return}}if(!a.recordUndo){return}b.log("Call change due changeCode");c.change();if(""!=c.generator){b.afterAll("generate"+c.getFileName(),c.updateGeneratedCode)}};var g=0;this.updateRunButtons=function(){if(0==a(".blocklySelectBreakpointC").length){g++;if(g>20){g=0;b.log("Giving up to tries of updateRunButtons");return}b.longDelay("updateRunButtons",c.updateRunButtons);return}b.log("updateRunButtons");g=0;if(c.isSelectingBreakpoint()){a(".blocklySelectBreakpointC").removeClass("vpl_dimmed")}else{a(".blocklySelectBreakpointC").addClass("vpl_dimmed")}if(null===c.getBreakpoint()){a(".blocklyRemoveBreakpointC").addClass("vpl_dimmed")}else{a(".blocklyRemoveBreakpointC").removeClass("vpl_dimmed")}switch(c.executionState){case c.RUNSTATE:{a(".blocklyStartC").addClass("vpl_dimmed");a(".blocklyStartAnimateC").addClass("vpl_dimmed");a(".blocklyStopC").removeClass("vpl_dimmed");a(".blocklyPauseC").removeClass("vpl_dimmed");a(".blocklyResumeC").addClass("vpl_dimmed");a(".blocklyStepC").addClass("vpl_dimmed");break}case c.STEPSTATE:{a(".blocklyStartC").addClass("vpl_dimmed");a(".blocklyStartAnimateC").addClass("vpl_dimmed");a(".blocklyStopC").removeClass("vpl_dimmed");a(".blocklyPauseC").addClass("vpl_dimmed");a(".blocklyResumeC").removeClass("vpl_dimmed");a(".blocklyStepC").removeClass("vpl_dimmed");break}case c.STOPSTATE:{a(".blocklyStartC").removeClass("vpl_dimmed");a(".blocklyStartAnimateC").removeClass("vpl_dimmed");a(".blocklyStopC").addClass("vpl_dimmed");a(".blocklyPauseC").addClass("vpl_dimmed");a(".blocklyResumeC").addClass("vpl_dimmed");a(".blocklyStepC").removeClass("vpl_dimmed");break}}};this.setToolbox=function(){var d=b.fileExtension(this.getFileName()),e=d+"Toolbox";if(!1===c[e]){a.ajax({url:"../editor/blocklytoolboxes/"+e+".xml",dataType:"text",success:function success(a){c[e]=c.blocklyIn18(a);c.setToolbox()}});return}var f=function(a){return function(){a();c.updateRunButtons()}},g={blocklyStartButton:this.start,blocklyStartAnimateButton:this.startAnimate,blocklyStopButton:this.stop,blocklyPauseButton:this.pause,blocklyResumeButton:this.resume,blocklyStepButton:this.step,blocklySelectBreakpointButton:this.setBreakpoint,blocklyRemoveBreakpointButton:this.removeBreakpoint},h=this.workspaceInstance;h.updateToolbox(this[e]);for(var i in g){h.registerButtonCallback(i,f(g[i]))}this.adjustSize()};this.open=function(){this.showFileName();if(c.blocklyNotLoaded){b.loadScript(["../editor/blockly/blockly_compressed.js","../editor/blockly/msg/js/en.js","../editor/blockly/blocks_compressed.js","../editor/blockly/python_compressed.js","../editor/blockly/javascript_compressed.js","../editor/blockly/php_compressed.js","../editor/blockly/lua_compressed.js","../editor/blockly/dart_compressed.js","../editor/acorn/acorn.js","../editor/acorn/interpreter.js"],function(){b.log("Blocklyloaded",!0);e();c.blocklyNotLoaded=!1;c.open()});return!1}var d=this.getContent();this.setOpen(!0);var f=this.getFileName(),g=!1;if(/.*[0-9]$/.test(b.fileExtension(f))){g=!0}var h=this.getTId();a(h).removeClass("ui-widget-content ui-tabs-panel");a(h).addClass("ui-corner-bottom");this.bdiv="bkdiv"+this.getId();a(h).html("<div id=\""+this.bdiv+"\" style=\"height: 480px; width: 600px;\"></div>");var i={toolbox:"<xml><category name=\"\" colour=\"330\"><block type=\"math_number\"></block></category></xml>",media:"../editor/blockly/media/",horizontalLayout:g,zoom:{controls:!0,wheel:!0,startScale:1,maxScale:3,minScale:.2,scaleSpeed:.3}};this.workspaceInstance=Blockly.inject(this.bdiv,i);this.setToolbox();this.firstContent=!0;c.workspaceInstance.addChangeListener(c.changeCode);this.setContent(d);b.adjustBlockly(c.workspaceInstance,10,10);c.workspaceInstance.scrollX=0;c.workspaceInstance.scrollY=0;Blockly.svgResize(c.workspaceInstance);Blockly.resizeSvgContents(c.workspaceInstance);c.adjustSize();return!1};var h=this.getContent;this.getContent=function(){if(!this.isOpen()){return h.call(this)}var a=Blockly.Xml.workspaceToDom(this.workspaceInstance),b=Blockly.Xml.domToPrettyText(a);return b};var i=this.setContent;this.setContent=function(a){i.call(this,a);if(0<a.length&&this.isOpen()){this.workspaceInstance.clear();var b=Blockly.Xml.textToDom(a);Blockly.Xml.domToWorkspace(b,this.workspaceInstance)}};this.close=function(){if(this.isOpen()){i.call(this,this.getContent());this.workspaceInstance.dispose();this.workspaceInstance=!1;this.setOpen(!1)}};this.blocklyNotLoaded=!0;this.blocklyToolbox=!1;this.blockly0Toolbox=!1;this.blockly1Toolbox=!1;this.blockly2Toolbox=!1;this.blockly3Toolbox=!1;this.blocklyStrs=["basic","intermediate","advanced","variables","operatorsvalues","control","inputoutput","functions","lists","math","text","run","start","startanimate","stop","pause","resume","step","breakpoint","selectbreakpoint","removebreakpoint"];this.blocklyIn18=function(a){for(var c=this.blocklyStrs.length,d=0;d<c;d++){var e=this.blocklyStrs[d],f=new RegExp("\\[\\["+e+"\\]\\]","g"),g=b.str(e);a=a.replace(f,g)}return a}}});
define ("mod_vpl/vplidebutton",["jquery","jqueryui","mod_vpl/vplutil"],function(a,b,c){var d=function(b,d){var e=this,f={};this.notAdded=function(a){return!f[a]};this.setText=function(b,d,g){if(e.notAdded(b)){return}if(!d){d=f[b].icon}if(!g){g=f[b].title}if(!g){g=c.str(d)}f[b].icon=d;f[b].title=g;if(f[b].hasOwnProperty("key")){g+=" ("+f[b].key+")"}a("#vpl_ide_"+b).attr("title",g);a("#vpl_ide_"+b+" i").replaceWith(c.genIcon(d))};this.setExtracontent=function(b,c){if(e.notAdded(b)){return}var d=a("#vpl_ide_"+b+" i");if(0==d.find(".bt_extrahtml").length){d.append(" <span class=\"bt_extrahtml\"><span>")}d.find(".bt_extrahtml").html(c)};this.add=function(a){if("string"==typeof a){var b=a;a={name:b}}if(!d(a.name)){return}if(!a.hasOwnProperty("icon")){a.icon=a.name}if(!a.hasOwnProperty("title")){a.title=c.str(a.name)}if(!a.hasOwnProperty("active")){a.active=!0}if(!a.hasOwnProperty("editorName")){a.editorName=a.name}if(!a.hasOwnProperty("originalAction")){a.originalAction=c.doNothing}if(e.notAdded(a.name)){f[a.name]=a}else{throw new Error("Button already set "+a.name)}e.setAction(a.name,a.originalAction);if(a.hasOwnProperty("bindKey")){a.command={name:a.editorName,bindKey:a.bindKey,exec:a.action};var g="win";if(navigator.platform.startsWith("Mac")){g="mac"}a.key=a.bindKey[g]}};this.getHTML=function(a){if(e.notAdded(a)){return""}else{var b=f[a].title;if(f[a].hasOwnProperty("key")){b+=" ("+f[a].key+")"}var d="<a id='vpl_ide_"+a+"' href='#' title='"+b+"'>";d+=c.genIcon(a)+"</a>";return d}};this.enable=function(b,c){if(e.notAdded(b)){return}var d=a("#vpl_ide_"+b);f[b].active=c;d.data("vpl-active",c);if(!c){d.addClass("ui-button-disabled ui-state-disabled")}else{d.removeClass("ui-button-disabled ui-state-disabled")}};this.setAction=function(a,b){if(e.notAdded(a)){return}f[a].originalAction=b;f[a].action=function(){if(f[a].active){b()}}};this.getAction=function(a){if(e.notAdded(a)){return c.doNothing}return f[a].action};this.launchAction=function(a){if(e.notAdded(a)){return}f[a].originalAction()};this.setGetkeys=function(a){if(!a){return}var b=a.commands.commands,c=a.commands.platform;for(var d in f){if(f.hasOwnProperty(d)){var g=f[d].editorName;if(b[g]&&b[g].bindKey&&!f[d].Key){f[d].key=b[g].bindKey[c];e.setText(d)}else{if(f[d].bindKey&&!f[d].hasOwnProperty("key")){f[d].key=f[d].bindKey[c];e.setText(d)}}}}};this.getShortcuts=function(a){var b="<ul>";for(var d in f){if(f[d].hasOwnProperty("key")){b+="<li>";b+=f[d].title+" ("+f[d].key+")";b+="</li>"}}b+="</ul>";if(a){b+="<h5>"+c.str("edit")+"</h5>";var e=a.commands.commands,g=a.commands.platform;b+="<ul>";for(var h in e){if(e[h].hasOwnProperty("bindKey")&&""<e[h].bindKey[g]){b+="<li>";b+=h+" ("+e[h].bindKey[g]+")";b+="</li>"}}b+="</ul>"}if("<ul></ul>"==b){return""}return b};a(b).on("click","a",function(b){if(a(this).data("vpl-active")){var c=a(this).attr("id");if("string"==typeof c&&c.startsWith("vpl_ide_")){c=c.replace("vpl_ide_","")}else{return!0}if(e.notAdded(c)){return!0}if(f[c]&&!f[c].active){return!0}var d=e.getAction(c);if("import"!=c){setTimeout(d,10)}else{d()}}b.stopImmediatePropagation();return!1});a("body").on("keydown",function(a){var b=!1,c="";if(a.shiftKey){c+="shift-"}if(a.altKey){c+="alt-";b=!0}if(a.ctrlKey){c+="ctrl-";b=!0}if(a.metaKey){c+="meta-";b=!0}if(112<=a.which&&123>=a.which){c+="f"+(a.which-111);b=!0}else{var d=String.fromCharCode(a.which).toLowerCase();if("a">d||"z"<d){b=!1}else{c+=d}}if(b){for(var e in f){if(f[e].hasOwnProperty("key")){if(c==f[e].key.toLowerCase()){a.preventDefault();a.stopImmediatePropagation();f[e].action();return!1}}}}return!0});this.multiple=function(a,b){return a-a%b};(function(){var b=0,d=0,f=!1,g=3600,h=!1,i=null,j=5,k=1e3,l=0,m=function(a){j=5;k=1e3;if(a>g){j=60;k=5e3}else if(a>24*g){j=300;k=25000}},n=function(){var a=e.multiple(c.getCurrentTime(),j);if(a===d||null===i){return}d=a;var f=l-(d-b),g="";if(0>=f){g="vpl_buttonleft_black"}else if(f<=300){h=!0;g="vpl_buttonleft_red"}else if(f<=900){g="vpl_buttonleft_orange"}else{m(f)}var k="<span class=\""+g+"\">"+c.genIcon("timeleft");if(h){k+=" "+c.getTimeLeft(f)}k+="</span>";i.html(k);i.removeClass("vpl_buttonleft_orange vpl_buttonleft_red vpl_buttonleft_black");i.addClass(g)};e.toggleTimeLeft=function(){h=!h;d=0;n()};e.setTimeLeft=function(g){i=a("#vpl_ide_timeleft");if(!1!==f){clearInterval(f);f=!1}if(g.hasOwnProperty("timeLeft")){l=g.timeLeft;m(l);var h=l%j;l=e.multiple(l,j);b=e.multiple(c.getCurrentTime(),j);d=b-j;setTimeout(function(){f=setInterval(n,k)},1e3*h);a("#vpl_ide_timeleft").show();n()}else{a("#vpl_ide_timeleft").hide()}}})()};window.VPLIDEButtons=d;return d});
define ("mod_vpl/vplidecodefile",["jquery","mod_vpl/vplutil"],function(a,b){return function(){var c=this,d=null,e=null,f=c.getFileManager().readOnly,g=this.getContent;this.getContent=function(){if(!this.isOpen()){return g.call(this)}return d.getValue()};var h=this.setContent;this.setContent=function(a){h.call(this,a);if(this.isOpen()){d.setValue(a)}};var i=this.destroy;this.destroy=function(){if(this.isOpen()){d.destroy()}i.call(this)};this.setFontSize=function(a){if(this.isOpen()){d.setFontSize(a)}};var j=this.adjustSize;this.adjustSize=function(){if(j.call(this)){d.resize(!0);return!0}return!1};this.gotoLine=function(a){if(!this.isOpen()){return}d.gotoLine(a,0);d.scrollToLine(a,!0);d.focus()};this.setReadOnly=function(a){f=a;if(this.isOpen()){d.setReadOnly(a)}};this.focus=function(){if(!this.isOpen()){return}var b=this.getTId();a(b).removeClass("ui-widget-content ui-tabs-panel");d.focus()};this.blur=function(){if(!this.isOpen()){return}d.blur()};this.undo=function(){if(!this.isOpen()){return}d.undo();d.focus()};this.redo=function(){if(!this.isOpen()){return}d.redo();d.focus()};this.selectAll=function(){if(!this.isOpen()){return}d.selectAll();d.focus()};this.hasUndo=function(){if(!this.isOpen()){return!1}return e.getUndoManager().hasUndo()};this.hasRedo=function(){if(!this.isOpen()){return!1}return e.getUndoManager().hasRedo()};this.hasSelectAll=b.returnTrue;this.hasFind=b.returnTrue;this.hasFindReplace=b.returnTrue;this.hasNext=b.returnTrue;this.find=function(){if(!this.isOpen()){return}d.execCommand("find")};this.replace=function(){if(!this.isOpen()){return}d.execCommand("replace")};this.next=function(){if(!this.isOpen()){return}d.execCommand("findnext")};this.getAnnotations=function(){if(!this.isOpen()){return[]}return e.getAnnotations()};this.setAnnotations=function(b){if(!this.isOpen()){return!1}return e.setAnnotations(b)};this.clearAnnotations=function(){if(!this.isOpen()){return!1}return e.clearAnnotations()};this.langSelection=function(){if(!this.isOpen()){return}var a=b.fileExtension(this.getFileName()),c="text";if(""!==a){c=b.langType(a)}e.setMode("ace/mode/"+c)};this.getEditor=function(){if(!this.isOpen()){return!1}return d};this.setTheme=function(a){if(!this.isOpen()){return}d.setTheme("ace/theme/"+a)};this.open=function(){this.showFileName();if("undefined"==typeof ace){b.loadScript(["../editor/ace9/ace.js","../editor/ace9/ext-language_tools.js"],function(){c.open()});return!1}if(this.isOpen()){return d}var g=this.getFileManager(),h=this.getTId();a(h).removeClass("ui-widget-content ui-tabs-panel");ace.require("ext/language_tools");d=ace.edit("vpl_file"+this.getId());e=d.getSession();d.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0});d.setValue(this.getContent());d.setFontSize(g.getFontSize());d.setTheme("ace/theme/"+g.getTheme());d.$blockScrolling=1/0;d.gotoLine(1,0);d.setReadOnly(f);e.setUseSoftTabs(!0);e.setTabSize(4);e.setUndoManager(new ace.UndoManager);this.setOpen(!0);this.langSelection();d.execCommand("replace");var i=function(){var b=a(h+" div.ace_search");if(b.length){b.on("drop",g.dropHandler);var c=a(".ace_searchbtn_close");c.trigger("click")}else{setTimeout(i,50)}};d.on("change",function(){c.change()});setTimeout(i,5);var j=d.onPaste;d.onPaste=function(a){if(g.restrictedEdit){d.insert(g.getClipboard())}else{j.call(d,a)}};d.on("copy",function(a){g.setClipboard(a.text)});a(h).on("paste","*",g.restrictedPaste);a(h+" div.ace_content").on("drop",g.dropHandler);a(h+" div.ace_content").on("dragover",g.dragoverHandler);a(h).find("div.ace_scroller").css("position","static");this.adjustSize();a(h).find("div.ace_scroller").css("position","absolute");return d};this.close=function(){this.setOpen(!1);if(null===d){return}this.setContent(d.getValue());d.destroy();d=null;e=null}}});
define ("mod_vpl/vplidefile",["jquery","jqueryui","mod_vpl/vplutil","mod_vpl/vplidecodefile","mod_vpl/vplideblocklyfile","mod_vpl/vplidebinaryfile"],function(a,b,c,d,e,f){return function(b,g,h,i,j){var k="#vpl_file"+b,l="#vpl_tab_name"+b,m=g,n=!0,o=!1,p=this;this.getContent=function(){return h};this.setContent=function(a){h=a};this.getFileManager=function(){return i};this.getFileName=function(){return m};this.getId=function(){return b};this.getTabNameId=function(){return l};this.getTId=function(){return k};this.getFileName=function(){return m};this.isModified=function(){return n};this.resetModified=function(){n=!1;this.showFileName()};this.setModified=function(){n=!0;this.showFileName()};this.getTabPos=function(){return i.getTabPos(this)};this.isOpen=function(){return o};this.setOpen=function(a){o=a};this.getVPLIDE=function(){return j};this.change=function(){if(!n){this.setModified();i.generateFileList();this.showFileName();c.longDelay("setModified",i.setModified)}};this.setFileName=function(a){if(!c.validPath(a)){return!1}if(a!=m){m=a;p.change()}if(!this.isOpen()){return!0}this.showFileName();this.langSelection();return!0};this.showFileName=function(){var b=this.getFileName(),d=c.getFileName(b);if(20<d.length){d=d.substring(0,16)+"..."}var e=(n?c.iconModified():"")+d;if(this.getTabPos()<i.minNumberOfFiles){e=e+c.iconRequired()}else{e=e+c.iconClose()}a(l+" a").html(e);if(d!=b){a(l+" a").attr("title",b)}c.afterAll("adjustTabsTitles"+p.id,function(){i.adjustTabsTitles(!0);c.delay("adjustTabsTitles"+p.id,function(){p.adjustSize()})})};this.destroy=function(){a(l).remove();a(k).remove()};this.adjustSize=function(){if(!this.isOpen()){return!1}var b=a(k),c=b.parent();if(0===b.length){return!1}var d=b.height(),e=b.width(),f=c.height();f-=b.position().top;var g=a("#vpl_tabs_scroll").width();if(f!=d||g!=e){a(b).height(f);a(b).width(g);return!0}return!1};this.gotoLine=c.doNothing;this.setReadOnly=c.doNothing;this.focus=c.doNothing;this.blur=c.doNothing;this.undo=c.doNothing;this.redo=c.doNothing;this.selectAll=c.doNothing;this.open=c.doNothing;this.hasUndo=c.returnFalse;this.hasRedo=c.returnFalse;this.hasSelectAll=c.returnFalse;this.hasFind=c.returnFalse;this.hasFindReplace=c.returnFalse;this.hasNext=c.returnFalse;this.find=c.doNothing;this.replace=c.doNothing;this.next=c.doNothing;this.getAnnotations=function(){return[]};this.setAnnotations=c.doNothing;this.setFontSize=c.doNothing;this.setTheme=c.doNothing;this.clearAnnotations=c.doNothing;this.langSelection=c.doNothing;this.isBinary=c.returnFalse;this.extendToCodeEditor=d;this.extendToBlockly=e;this.extendToBinary=f}});
define ("mod_vpl/vplterminal",["jquery","jqueryui","mod_vpl/vplutil","mod_vpl/vplclipboard"],function(a,b,c,d){var e=function(b,e,f){var m=this,n=null,o=c.doNothing,p="",q="",r=a("#"+b),s=a("#vplide"),t="",u=null,v=64e3,w="",x,y=a("#"+e);this.updateTitle=function(){var a=p;if(""!==q){a+=" ("+q+")"}t.text(f("console")+": "+a)};this.setTitle=function(a){p=a;this.updateTitle()};this.setMessage=function(a){q=a;this.updateTitle()};function g(a){w+=a;if(w.length>v){var b=w.length-v/2;w=w.substr(b)}}function h(){if(n&&n.readyState==n.OPEN){n.send(u.getEntry2())}}function i(){u.setEntry1(w)}function j(){i();u.show()}this.write=function(a){x.write(a);return a};this.connect=function(a,b){o=b;if("WebSocket"in window){x.reset();x.startBlink();m.show();if(n){n.close()}w="";m.setMessage("");m.setTitle(f("connecting"));n=new WebSocket(a);n.writeBuffer="";n.writeIt=function(){x.write(n.writeBuffer);g(n.writeBuffer);n.writeBuffer=""};n.onmessage=function(a){if(0<n.writeBuffer.length){n.writeBuffer+=a.data}else{n.writeBuffer=a.data;setTimeout(n.writeIt,35)}};n.onopen=function(){m.setMessage("");m.setTitle(f("connected"))};n.onclose=function(){m.setTitle(f("connection_closed"));x.blur();x.stopBlink();b();n.stopOutput=!0}}else{x.write("WebSocket not available: Upgrade your browser")}};this.writeLocal=function(a){n.onmessage({data:a});return a};this.setDataCallback=function(a){n.onData=a};this.closeLocal=function(){if(n){n.writeIt();n.close();x.stopBlink();m.setTitle(f("connection_closed"))}};this.connectLocal=function(a,b){o=a;x.reset();x.startBlink();m.show();if(n){n.close()}w="";m.setMessage("");m.setTitle(f("running"));n={};n.onData=b;n.writeBuffer="";n.readBuffer="";n.readyState=1;n.OPEN=1;n.close=function(){n=!1};n.onmessage=function(a){n.writeBuffer=a.data;n.writeIt()};n.writeIt=function(){if(n){x.write(n.writeBuffer);g(n.writeBuffer);n.writeBuffer=""}};n.send=function(a){if("\x7F"==a){if(0<n.readBuffer.length){m.writeLocal("\b \b");n.readBuffer=n.readBuffer.substr(0,n.readBuffer.length-1)}}else{m.writeLocal(a);n.readBuffer+=a}var b=n.readBuffer.indexOf("\r");if(-1!=b){var c=n.readBuffer.substr(0,b);n.readBuffer=n.readBuffer.substr(b+1);n.onData(c)}}};this.isOpen=function(){return r.dialog("isOpen")};this.close=function(){r.dialog("close")};this.isConnected=function(){return n&&n.readyState!=n.CLOSED};this.disconnect=function(){if(n&&n.readyState==n.OPEN){o();if(n){n.close()}x.stopBlink()}};var z=c.genIcon("copy","sw")+" "+f("copy"),A=c.genIcon("paste","sw")+" "+f("paste");u=new d("vpl_dialog_terminal_clipboard",z,function(){i();document.execCommand("copy")},A,h);this.closeDialog=function(){u.hide();m.disconnect()};function k(a){r.data("terminal_theme",a);c.setUserPreferences({terminalTheme:a});for(var b=0;b<5;b++){r.removeClass("vpl_terminal_theme"+b)}r.addClass("vpl_terminal_theme"+a)}function l(){var a=s.width(),b=s.height();if(r.width()>a){r.dialog("option","width",a)}if(r.parent().height()>b){r.dialog("option","height",b-r.prev().outerHeight())}}r.dialog({closeOnEscape:!1,autoOpen:!1,width:"auto",height:"auto",resizable:!0,dragStop:l,open:l,focus:function focus(){l();x.focus()},dialogClass:"vpl_ide vpl_vnc",create:function create(){t=c.setTitleBar(r,"console","console",["clipboard","keyboard","theme"],[j,function(){x.focus()},function(){var a=(r.data("terminal_theme")+1)%5;k(a)}])},close:function close(){m.closeDialog()},resizeStop:function resizeStop(){r.width(r.parent().width());r.height(r.parent().height()-r.prev().outerHeight());l();x.focus()}});this.setFontSize=function(a){y.css("font-size",a+"px")};c.getUserPreferences(function(a){k(a.preferences.terminalTheme)});r.css("padding","1px");r.parent().css("z-index",2e3);this.show=function(){r.dialog("open");x.focus()};this.init=function(){if("undefined"==typeof Terminal){c.loadScript(["../../vpl/editor/xterm/term.js"],function(){m.init()});return}x=new Terminal({cols:80,rows:24,useStyle:!0,screenKeys:!0});x.on("data",function(a){if(n&&n.readyState==n.OPEN){n.send(a)}});x.open(y[0]);x.reset();x.stopBlink();x.setLineCallback(function(a,b){var c=y.height(),d=r.scrollTop(),e=r.innerHeight();if(e>=c){return}var f=c/b,g=a*f;if(g>=d&&g<e+d-f){return}if(g<d){r.scrollTop(g)}else{r.scrollTop(g-e+2*f)}})};this.init()};window.VPLTerminal=e;return e});
define ("mod_vpl/vplutil",["jquery","jqueryui","core/log"],function(a,b,c){var d={doNothing:a.noop,returnFalse:function(){return!1},returnTrue:function(){return!0}},e=!1;d.log=function(a,b){if(e||b){c.debug(a)}};d.setUserPreferences=function(b){a.ajax({async:!0,type:"POST",url:"../editor/userpreferences.json.php",data:JSON.stringify(b),contentType:"application/json; charset=utf-8",dataType:"json"})};d.getUserPreferences=function(b){a.ajax({async:!0,type:"POST",url:"../editor/userpreferences.json.php",data:JSON.stringify({getPreferences:!0}),contentType:"application/json; charset=utf-8",dataType:"json"}).done(b)};d.scrollBarWidth=function(){var b,c,d;b=a("<div style=\"width:50px;height:50px;overflow:auto\"><div/></div>").appendTo("body");c=b.children();d=c.innerWidth()-c.height(99).innerWidth();b.remove();return d};d.sanitizeHTML=function(b){if("undefined"==typeof b||""==b.replace(/^\s+$/g,"")){return""}return a("<div>"+b+"</div>").html()};d.sanitizeText=function(a){if("undefined"==typeof a||""==a.replace(/^\s+$/g,"")){return""}return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};d.setProtocol=function(a){var b;if(0==a.securePort||0==a.port){b=0==a.port}else{switch(a.wsProtocol){case"always_use_wss":b=!0;break;case"always_use_ws":b=!1;break;default:b="https:"==window.location.protocol;}}var c=(b?"wss://":"ws://")+a.server;a.secure=b;a.portToUse=b?a.securePort:a.port;c+=":"+a.portToUse+"/";a.monitorURL=c+a.monitorPath;a.executionURL=c+a.executionPath};d.ArrayBuffer2String=function(a){var b=new Uint8Array(a),c=[],d=32e3,e,f;for(e=0,f=b.length;e<f;e+=d){c.push(String.fromCharCode.apply(String,b.subarray(e,Math.min(e+d,f))))}return c.join("")};d.String2ArrayBuffer=function(a){for(var b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c),e=0;e<b;e++){d[e]=a.charCodeAt(e)}return c};(function(){var a=0;d.getUniqueId=function(){return a++}})();(function(){d.fileExtension=function(a){var b=/\.([^.]*)$/.exec(a);return null!==b?b[1]:""};d.isImage=function(a){return /^(gif|jpg|jpeg|png|ico)$/i.test(d.fileExtension(a))};d.isBinary=function(a){return d.isImage(a)||/^(zip|jar|pdf|tar|bin|7z|arj|deb|gzip|rar|rpm|dat|db|dll|rtf|doc|docx|odt|exe|com)$/i.test(d.fileExtension(a))};d.isBlockly=function(a){return /^blockly[0123]?$/.test(d.fileExtension(a))};d.validFileName=function(a){if(1>a.length){return!1}if(128<a.length){return!1}return!/[\cA-\cZ]|[:-@]|[{-~]|\\|\[|\]|[/^`´]|^-|^ | $|\.\./.test(a)}})();d.getCurrentTime=function(){return parseInt(new Date().valueOf()/1e3)};d.encodeBinary=function(a,b){if(!d.isBinary(a)){return btoa(unescape(encodeURIComponent(b)))}return btoa(d.ArrayBuffer2String(b))};d.decodeBinary=function(a,b){var c=atob(b);if(!d.isBinary(a)){return decodeURIComponent(escape(c))}return d.String2ArrayBuffer(c)};d.validPath=function(a){if(256<a.length){return!1}for(var b=a.split("/"),c=0;c<b.length;c++){if(!d.validFileName(b[c])){return!1}}return!0};d.getFileName=function(a){var b=a.split("/");return b[b.length-1]};d.dataFromURLData=function(a){return a.substr(a.indexOf(",")+1)};d.readZipFile=function(a,b,c,e){if(!e){e=d.doNothing}if("undefined"==typeof JUnzip){d.loadScript(["../editor/zip/inflate.js","../editor/zip/unzip.js"],function(){d.readZipFile(a,b,c,e)});return}var g=d.ArrayBuffer2String(a),h=new JUnzip(g);if(!h.isZipFile()){d.log("Not a ZIP file");e();return}h.readEntries();var j=h.entries.length;function f(a){if(a>=j||c.isClosed()){e();return}var g=h.entries[a],k=g.fileName,l;if(k.match(/\/$/)){f(a+1)}else{c.processFile(k);var m="";if(0===g.compressionMethod){m=g.data}else if(8===g.compressionMethod){m=JSInflate.inflate(g.data)}if(d.isBinary(k)){b({name:k,contents:btoa(m),encoding:1});f(a+1)}else{l=d.String2ArrayBuffer(m);var n=new Blob([l],{type:"text/plain"}),o=new FileReader;o.onload=function(c){b({name:k,contents:c.target.result,encoding:0});f(a+1)};o.onerror=function(b){d.log(b);a=j;f(a+1)};o.readAsText(n)}}}f(0)};d.readSelectedFiles=function(a,b,c){var h=new d.progressBar("import","import"),i="";if(!c){c=d.doNothing}h.processFile=function(a){h.setLabel(a)};function g(j){if(j>=a.length||h.isClosed()){c();h.close();if(""<i){d.showErrorMessage(i)}return}var k=a[j];h.processFile(k.name);var f=d.isBinary(k.name),l=new FileReader,m=d.fileExtension(k.name).toLowerCase();l.onload=function(a){if(f){if("zip"==m){try{d.readZipFile(a.target.result,b,h,function(){g(j+1)});return}catch(a){d.showErrorMessage(a+" : "+k.name)}}else{var c=d.dataFromURLData(a.target.result);b({name:k.name,contents:c,encoding:1})}}else{b({name:k.name,contents:a.target.result,encoding:0})}g(j+1)};l.onerror=function(a){i+="Error \""+a.target.error+"\" reading "+k.name+"\n";g(j+1)};if(f){if("zip"==m){l.readAsArrayBuffer(k)}else{l.readAsDataURL(k)}}else{l.readAsText(k)}}g(0)};(function(){var a={gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",ico:"image/vnd.microsoft.icon",pdf:"application/pdf"};d.getMIME=function(b){var c=d.fileExtension(b);if(c in a){return a[c]}return"application/octet-stream"};d.getTimeLeft=function(a){var b="",c=60,d=60*c,e=24*d;if(0>a){b+="-";a=-a}var f=a,g=parseInt(f/e);f-=g*e;if(0!==g){b+=g+"T"}var h=parseInt(f/d);f-=h*d;var i=parseInt(f/c);f-=i*c;var j=parseInt(f);b+=("00"+h).substr(-2)+":";b+=("00"+i).substr(-2);if(a<d){b+=":"+("00"+j).substr(-2)}return b}})();(function(){var a={abap:"abap",abc:"abc",ada:"ada",ads:"ada",adb:"ada",as:"actionscript",as3:"actionscript",asm:"assembly_x86",bash:"sh",bat:"batchfile",c:"c_cpp",C:"c_cpp",cc:"c_cpp",cpp:"c_cpp","c++":"c_cpp",hxx:"c_cpp",h:"c_cpp",H:"c_cpp",cases:"cases",cbl:"cobol",cob:"cobol",coffee:"coffee",clj:"clojure",cs:"csharp",css:"css",d:"d",dart:"dart",e:"eiffel",erl:"erlang",hrl:"erlang",f:"fortran",f77:"fortran",f90:"fortran",for:"fortran",go:"golang",groovy:"groovy",gv:"dot",hs:"haskell",htm:"html",html:"html",hx:"haxe",java:"java",jl:"julia",js:"javascript",json:"json",jsp:"jsp",jsx:"jsx",kt:"kotlin",kts:"kotlin",m:"matlab",md:"markdown",less:"less",lisp:"lisp",lsp:"lisp",lua:"lua",pas:"pascal",p:"pascal",perl:"perl",prl:"perl",php:"php",pro:"prolog",pl:"prolog",py:"python",R:"r",r:"r",rb:"ruby",ruby:"ruby",s:"assembly_x86",sass:"sass",scala:"scala",scm:"scheme",scss:"scss",sh:"sh",swift:"swift",sql:"sql",svg:"svg",tex:"tex",tcl:"tcl",ts:"typescript",twig:"twig",vbs:"vbscript",v:"verilog",vh:"verilog",vhd:"vhdl",vhdl:"vhdl",xml:"xml",yaml:"yaml"};d.langType=function(b){if(b in a){return a[b]}return"plain_text"}})();(function(){var a={};d.str=function(b,c){if(!a[b]){return"{"+b+"}"}if("undefined"!=typeof c){return a[b].replace(/\{\\*\$a\\*}/g,c)}else{return a[b]}};d.setStr=function(b){for(var c in b){if(b.hasOwnProperty(c)){a[c]=b[c]}}d.dialogbaseOptions={minWidth:200,autoOpen:!1,width:"auto",closeText:d.str("cancel"),modal:!0,dialogClass:"vpl_ide vpl_ide_dialog"}};d.setStr(window.VPLi18n)})();(function(){var a={},b={},c=100,e=0;d.delay=function(b,c,d,f){if("undefined"!=typeof a[b]){clearTimeout(a[b]);e--}e++;a[b]=setTimeout(function(){e--;c(d,f);delete a[b]},20)};d.longDelay=function(b,d,f,g){if("undefined"!=typeof a[b]){clearTimeout(a[b]);e--}e++;a[b]=setTimeout(function(){e--;d(f,g);delete a[b]},c)};var f=function(a,d,g,h){if("undefined"!=typeof b[a]){clearTimeout(b[a])}return setTimeout(function(){if(0<e){b[a]=f(a,d,g,h)}else{d(g,h);delete b[a]}},c)};d.afterAll=function(a,c,d,e){b[a]=f(a,c,d,e)}})();d.iconModified=function(){var a="<span title=\""+d.str("modified")+"\" class=\"vpl_ide_charicon\">";a+="<i class=\"fa fa-star\"></i></span> ";return a};d.iconDelete=function(){var a=" <span title=\""+d.str("delete")+"\" class=\"vpl_ide_charicon vpl_ide_delicon\">";a+="<i class=\"fa fa-trash\"></i></span> ";return a};d.iconClose=function(){var a=" <span title=\""+d.str("closebuttontitle");a+="\" class=\"vpl_ide_charicon vpl_ide_closeicon\"><i class=\"fa fa-remove\"></i></span> ";return a};d.iconRequired=function(){var a=" <span title=\""+d.str("required")+"\" class=\"vpl_ide_charicon\">";a+="<i class=\"fa fa-shield\"></i></span> ";return a};d.iconFolder=function(){return"<i class=\"fa fa-folder-open-o\"></i>"};(function(){var a={filelist:"folder-o",filelistclose:"folder-open-o",new:"file-code-o",rename:"pencil",delete:"trash",multidelete:"trash|list",close:"remove",comments:"commenting",import:"upload",print:"print",edit:"edit",undo:"undo",redo:"repeat",select_all:"location-arrow",find:"search",find_replace:"exchange",next:"search-plus",resetfiles:"refresh",download:"download",fullscreen:"expand",regularscreen:"compress",save:"save",shortcuts:"flash",sort:"list-ol",run:"rocket",running:"rocket fa-spin",debug:"bug",evaluate:"check-square-o",console:"terminal",about:"question",info:"info-circle",alert:"warning",trash:"trash",retrieve:"download",spinner:"refresh fa-spin",keyboard:"keyboard-o",clipboard:"clipboard",timeleft:"clock-o",copy:"copy",paste:"paste",more:"plus-square",less:"minus-square",resize:"arrows-alt",graphic:"picture-o",send:"send",theme:"paint-brush",user:"user",fontsize:"text-height"};d.genIcon=function(b,c){if(!a[b]){return""}var d="fa fa-";if(!c){d+="lg"}else{d+=c}for(var e=a[b].split("|"),f="",g=0;g<e.length;g++){f+="<i class='"+d+" fa-"+e[g]+"'></i>"}return f}})();d.setTitleBar=function(b,c,e,f,g){var j=a(b).parent().find("span.ui-dialog-title");function h(a){var b="<a id='vpl_"+c+"_"+a+"' href='#' title='"+d.str(a)+"'>";b+=d.genIcon(a,"fw")+"</a>";return b}var k=d.genIcon(e);k+=" <span class='"+c+"-title-buttons'></span>";k+="<span class='"+c+"-title-text'></span>";j.html(k);var l=j.find("span."+c+"-title-buttons"),m=j.find("span."+c+"-title-text");k="";for(var n=0;n<f.length;n++){k+=h(f[n])}l.html(k);for(var o=0,p;o<g.length;o++){p=j.find("#vpl_"+c+"_"+f[o]);p.button().click(g[o]);p.css("padding","1px 3px")}l.on("focus","*",function(){a(this).blur()});return m};d.setDialogTitleIcon=function(b,c){var e=a(b).parent().find("span.ui-dialog-title");e.html(d.genIcon(c)+" "+e.html())};d.progressBar=function(b,c,e){var f="<div class=\"vpl_ide_progressbaricon\">"+d.genIcon("spinner")+"</div>",g=a("<div class=\"vpl_ide_dialog\" style=\"display:none;\">"+(" <div class=\"vpl_ide_progressbar\">"+f+"<span class=\"vpl_ide_progressbarlabel\"></span>"+"</div>")+"</div>");a("body").append(g);var h=g.find(".vpl_ide_progressbar"),i=h.find(".vpl_ide_progressbarlabel");g.dialog({title:d.str(b),resizable:!1,autoOpen:!1,width:200,height:20,minHeight:20,modal:!0,dialogClass:"vpl_ide vpl_ide_dialog",close:function close(a){if(g){if(e&&a.originalEvent){e()}e=!1}}});this.setLabel=function(a,b){if(g){i.text(a);if(b){i.html(d.genIcon(b)+" "+i.html())}}};this.close=function(){if(g){g.dialog("destroy");a(g).remove();g=!1}};this.isClosed=function(){return!1===g};var j=g.siblings().find(".ui-dialog-title");j.html(d.genIcon(b)+" "+j.html());this.setLabel(d.str(c));g.dialog("open");g.dialog("option","height","auto")};d.showMessage=function(b,c){var e=a.extend({},d.dialogbaseOptions,c),f=a("<div class=\"vpl_ide_dialog\" style=\"display:none\"></div>"),g="",h=" <span class=\"dmessage\">"+b.replace(/\n/g,"<br>")+"</span>";f.html(h);if("undefined"==typeof e.icon){g="info"}else{g=e.icon;delete e.icon}if(!e.title){e.title=d.str("warning")}a("body").append(f);var i={};if("function"==typeof c.ok){i[d.str("ok")]=function(){a(this).dialog("close");c.ok()};i[d.str("cancel")]=function(){a(this).dialog("close")};delete e.ok}else if("function"==typeof c.yes){i[d.str("yes")]=function(){a(this).dialog("close");c.yes()};i[d.str("no")]=function(){a(this).dialog("close")};delete e.yes}else{i[d.str("close")]=function(){a(this).dialog("close")}}if(e.next){i[d.str("next")]=function(){a(this).dialog("close");c.next()}}e.close=function(){a(this).remove();if(c.close){c.close()}};e.buttons=i;f.dialog(e);var j=f.siblings().find(".ui-dialog-title");j.html(d.genIcon(g)+" "+j.html());f.setMessage=function(b){a(f).find(".dmessage").html(b.replace(/\n/g,"<br>"))};f.dialog("open");return f};d.showErrorMessage=function(b,c){var e=a.extend({},d.dialogbaseOptions,{title:d.str("error"),icon:"alert"});if(c){e=a.extend(e,c)}return d.showMessage(b,e)};d.requestAction=function(b,c,f,g){var h=a.Deferred(),i=null,j=!1;if(""===c){c="connecting"}var k=new d.progressBar(b,c,function(){if(4!=i.readyState){if(j&&j.abort){j.abort()}}});i=a.ajax({beforeSend:function beforeSend(a){j=a;return!0},async:!0,type:"POST",url:g+b,data:JSON.stringify(f),contentType:"application/json; charset=utf-8",dataType:"json"}).always(function(){k.close()}).done(function(a){if(!a.success){h.reject(a.error)}else{h.resolve(a.response)}}).fail(function(a,b,c){var f=d.str("connection_fail")+": "+b;if(e){f+="<br>"+c.message;f+="<br>"+a.responseText.substr(0,80)}d.log(f);h.reject(f)});return h};d.supportWebSocket=function(){if("WebSocket"in window){return!0}return!1};d.isAndroid=function(){return-1<window.navigator.userAgent.indexOf("Android")};d.isFirefox=function(){return-1<window.navigator.userAgent.indexOf("Firefox")};d.isMac=function(){return-1<window.navigator.userAgent.indexOf("Mac")};d.clickServer=function(b){var c=450,e=screen.width/2-275,f=screen.height/2-c/2;try{var g="toolbar=no, location=no, directories=no, status=no, menubar=no";g+=", resizable=yes, scrollbars=yes, copyhistory=no, width=550";g+=", height="+c+", top="+f+", left="+e;var h=window.open(a(this).attr("href"),"_blank",g);if(!h){return!0}}catch(a){d.log(a);return!0}b.preventDefault();a(this).parent().hide();return!1};d.acceptCertificates=function(b,c){if(0<b.length){var e=d.str("acceptcertificatesnote");e+="<ol>";for(var f in b){if(b.hasOwnProperty(f)){var g=1+f;e+="<li><a href=\""+b[f]+"\" target=\"_blank\">Server ";e+=g+"</a></li>"}}e+="</ol>";var h=d.showMessage(e,{ok:function ok(){var a=c();if(a){a()}},icon:"unlocked",title:d.str("acceptcertificates")});a(h).find("a").on("click keypress",d.clickServer)}else{d.log("servers.length == 0");d.showErrorMessage(d.str("connection_fail"))}};d.monitorRunning=d.returnFalse;d.webSocketMonitor=function(b,c,e,f){d.setProtocol(b);var g=null,h=null,i=a.Deferred(),j=function(a){i.reject(a)},k=!1,l={message:function message(a){var b=/^([^:]*):?([^]*)/.exec(a),c=b[1],g=b[2];if("running"==c){c=e}var i=d.str(c);if(""<g){i+=": "+g}if(null!==h&&!h.isClosed()){h.setLabel(i)}else if(f.getConsole&&f.getConsole().isOpen()){f.getConsole().setMessage(i)}else{d.log("Error: no dialogo. Message not shown: "+i)}},compilation:function compilation(a){if(f.setResult){f.setResult({compilation:a},!1)}},retrieve:function retrieve(){h.close();k=!0;d.requestAction("retrieve","","",f.ajaxurl).done(function(a){i.resolve();if(f.setResult){f.setResult(a,!0)}}).fail(j)},run:function run(a){h.close();f.run(a,b,g)},close:function close(){d.log("ws close message from jail");g.close()}};try{if(d.supportWebSocket()){g=new WebSocket(b.monitorURL)}else{d.log("ws not available");i.reject(d.str("browserupdate"));return i}}catch(a){d.log("ws new say "+a);i.reject(a.message);return i}h=new d.progressBar(c,"connecting",function(){i.reject("Stopped by user");g.close()});g.notOpen=!0;g.onopen=function(){g.notOpen=!1;h.setLabel(d.str("connected"));if(f.open){f.open()}};g.onerror=function(a){d.log("ws error "+a);h.close();if(b.secure&&g.notOpen){d.requestAction("getjails","retrieve",{},f.ajaxurl).done(function(a){d.acceptCertificates(a.servers,function(){return f.getLastAction()})}).fail(j)}else{i.reject(d.str("connection_fail"))}if(f.close){d.delay("externalActions.close",f.close)}};g.onclose=function(){if(f.getConsole){f.getConsole().disconnect()}if(!g.notOpen){h.close();if(!k&&"rejected"!=i.state()){i.resolve()}}if(f.close){f.close()}};g.onmessage=function(a){var b=/^([^:]+):([^]*)/.exec(a.data);if(null!==b){var c=b[1],e=b[2];if(l[c]){l[c](e)}}else{h.setLabel(d.str("error")+": "+a.data)}};d.monitorRunning=function(){return null!==g&&g.readyState!=WebSocket.CLOSED};return i};d.processResult=function(a,b,c,e,f){if("undefined"==typeof a||""==a.replace(/^\s+$/gm,"")){return""}function g(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/,"\\$&")}var p=/^\s*>/,q=new RegExp("\\[err\\]|error|"+g(d.str("error")),"i"),r=new RegExp("\\[warn\\]|warning|note|"+g(d.str("warning")),"i"),s="",t="",u="",v="",w=a.split(/\r\n|\n|\r/),x=[],y=!1,z=!1,A=!1;function h(a){if("undefined"==typeof c[a].getTagId){return"href=\"#\" "}else{return"href=\"#"+c[a].getTagId()+"\" "}}(function(){for(var a=0;a<b.length;a++){var c=g(b[a]);x[a]=new RegExp("(^| |/)"+c+"( on line | line |:|\\()(\\d+)(:|,)?(\\d+)?(\\))?","m")}})();function j(a,e){for(var f=!1,g=0;g<x.length;g++){var j=x[g],k;while(null!==(k=j.exec(a))){var l=c[g].getAnnotations();z=g;f=!0;var m;if(-1<a.search(q)){m="error"}else if(-1<a.search(r)){m="warning"}else if(-1<a.search(/\[info\]|information/i)){m="info"}else{m="error"}y={row:k[3]-1,column:k[5],type:m,text:e};l.push(y);var n=b[g],o=h(g),p=d.sanitizeText(n),s="data-file=\""+n+"\" data-line=\""+k[3]+"\"";a=a.replace(j,"$1<a "+o+" class=\"vpl_fl\" "+s+">"+p+"$2$3$4$5$6</a>");c[g].setAnnotations(l)}}if(!f&&y){if(""!==e){y.text+="\n"+e;c[z].setAnnotations(c[z].getAnnotations())}else{y=!1}}return a}function k(a){y=!1;a=a.substr(1);var b=/\([-]?[\d]+[.]?[\d]*\)\s*$/.exec(a);if(null!==b){a=a.substr(0,a.length-b[0].length)}var c="";if(f){c+="<a href=\"javascript:void(0)\" onclick=\"VPLUtil.showHideDiv(this)\">[+]</a>"}c+="<b class=\"ui-widget-header ui-corner-all\">"+d.sanitizeText(a)+"</b><br>";c=j(c,a);return c}function l(){y=!1;var a=u;u="";return a}function m(a){var b=d.sanitizeText(a);u+=j(b,a)+"<br>"}function n(a){var b=d.sanitizeText(a);v+=j(b,a)+"\n"}function o(){y=!1;var a=v;v="";return"<pre><i>"+a+"</i></pre>"}for(var B=0,C;B<w.length;B++){C=w[B];if(e){t+=j(d.sanitizeText(C),C)+"\n";continue}var D=p.exec(C),E=p.test(C);if(null!==D!=E){d.log("error")}if(/^-.*/.test(C)){switch(s){case"comment":t+=l();break;case"case":t+=o();break;}if(A){t+="</div>"}t+=k(C);t+=f?"<div style=\"display:none\">":"<div>";A=!0;s=""}else if(E){if("comment"==s){t+=l()}n(C.substr(D[0].length));s="case"}else{if("case"==s){t+=o()}m(C);s="comment"}}switch(s){case"comment":t+=l();break;case"case":t+=o();break;}if(A){t+="</div>"}return t};(function(){var a=[];d.loadScript=function(b,c){if(0==b.length){c();return}var e=b[0];if("undefined"==typeof a[e]){b.shift();a[e]=1;var f=document.createElement("script");f.type="text/javascript";f.src=d.options.scriptPath+e;f.onload=function(){a[e]=2;d.loadScript(b,c)};document.head.appendChild(f)}else if(2==a[e]){b.shift();d.loadScript(b,c)}else{d.log("Error loading js "+e+" "+a[e]);setTimeout(function(){d.loadScript(b,c)},50)}};d.isScriptLoading=function(b){if("undefined"==typeof a[b]){return!1}return 1==a[b]};d.isScriptLoaded=function(b){if("undefined"==typeof a[b]){return!1}return 2==a[b]}})();d.adjustBlockly=function(a,b,c){for(var d=a.getAllBlocks(),e=2e4,f=-2e4,g=2e4,h=-2e4,k=0,l;k<d.length;k++){l=d[k].getRelativeToSurfaceXY();e=Math.min(e,l.y);f=Math.max(f,l.y);g=Math.min(g,l.x);h=Math.max(h,l.x)}d=a.getTopBlocks();for(var m=0;m<d.length;m++){d[m].moveBy(b-g,c-e)}return f-e+100+c};(function(){var c=[],e=[],f=[];function b(a,b){var c=this;this.files=a;this.results=b;setTimeout(function(){c.highlight()},10)}b.prototype.highlightBlockly=function(b){d.loadScript(["../editor/blockly/blockly_compressed.js","../editor/blockly/msg/js/en.js","../editor/blockly/blocks_compressed.js"],function(){var e=a("#"+b),f=e.html();a("#"+b+"load").remove();e.html("");e.show();f=a("<div />").html(f).text().replace(/\n/g,"");var g=Blockly.Xml.textToDom(f);e.html("").height(300).width(e.parent().width());var i=Blockly.inject(b,{toolbox:"",readOnly:!0,media:"../editor/blockly/media/"});Blockly.Xml.domToWorkspace(g,i);var j=d.adjustBlockly(i,10,10);e.height(j);e.width("100%");Blockly.svgResize(i);Blockly.resizeSvgContents(i);var k=e.html();i.dispose();e.html(k)})};b.prototype.highlight=function(){for(var b=this,c=!1,e=this.files,g=0,h;g<e.length;g++){h=e[g];if(d.isBinary(h.fileName)||d.isBlockly(h.fileName)){continue}else{c=!0;break}}if(c&&"undefined"==typeof ace){d.loadScript(["../editor/ace9/ace.js"],function(){b.highlight()});return}for(var j=this.results,k=[],l=[],m=0;m<e.length;m++){var n=e[m],o="code"+n.tagId;if(d.isBlockly(n.fileName)){b.highlightBlockly(o);continue}var p=d.fileExtension(n.fileName),q=d.langType(p);a("#"+o).show();a("#"+o+"load").remove();var r=ace.edit(o);r.setTheme("ace/theme/"+n.theme);r.getSession().setMode("ace/mode/"+q);r.renderer.setShowGutter(n.showln);r.setReadOnly(!0);r.setHighlightActiveLine(!1);r.setAutoScrollEditorIntoView(!0);r.setOption("maxLines",n.nl);r.getAnnotations=function(){return this.getSession().getAnnotations()};r.setAnnotations=function(b){return this.getSession().setAnnotations(b)};r.getTagId=function(){return this.vplTagId};r.vplTagId=n.tagId;k.push(r);l.push(n.fileName);f[n.tagId]=r}for(var s=0;s<j.length;s++){var t=document.getElementById(j[s].tagId),u=t.textContent||t.innerText;t.innerHTML=d.processResult(u,l,k,j[s].noFormat,j[s].folding)}};d.addResults=function(a,b,c){e.push({tagId:a,noFormat:b,folding:c})};d.syntaxHighlightFile=function(a,b,d,e,f){c.push({tagId:a,fileName:b,theme:d,showln:e,nl:f})};d.syntaxHighlight=function(){new b(c,e);c=[];e=[]};d.flEventHandler=function(a){var b=a.target.getAttribute("href").substring(1),c=a.target.getAttribute("data-line"),d=f[b];d.gotoLine(c,0);d.scrollToLine(c,!0)};d.setflEventHandler=function(){for(var a=document.getElementsByClassName("vpl_fl"),b=0;b<a.length;b++){a[b].onclick=d.flEventHandler}};d.showHideDiv=function(b){var a=b,c=b;if(!c.nextSibling){c=c.parentNode}c=c.nextSibling;while("DIV"!=c.nodeName&&"PRE"!=c.nodeName){c=c.nextSibling;if(!c){return}}if(a){if("[+]"==a.innerHTML){if(c.savedDisplay){c.style.display=c.savedDisplay}else{c.style.display=""}a.innerHTML="[-]"}else{c.savedDisplay=c.style.display;c.style.display="none";a.innerHTML="[+]"}}}})();d.options={scriptPath:""};if("undefined"!=typeof window.VPLDebugMode){e=window.VPLDebugMode}d.init=function(b){d.options={scriptPath:""};a.extend(d.options,b);if("undefined"!=typeof window.VPLDebugMode){e=window.VPLDebugMode}d.log(d.options)};window.VPLUtil=d;return d});
define ("mod_vpl/vplvnc",["jquery","jqueryui","mod_vpl/vplutil","mod_vpl/vplclipboard","core/log"],function(a,b,c,d,e){window.INCLUDE_URI="../editor/noVNC/include/";function f(){if("undefined"==typeof Util){c.delay("loadVNCScripts",f)}else{Util.load_scripts(["webutil.js","base64.js","websock.js","des.js","keysymdef.js","keyboard.js","input.js","display.js","jsunzip.js","rfb.js","keysym.js"])}}c.delay("loadVNCScripts",f);return function VPLVNCClient(b,f){var q=this,r,s="",u="",v="",x=a("#"+b),y=a("#"+b+" canvas"),z=c.doNothing,A,B=!0,C,D=window.document.createElement("input");D.style.position="absolute";D.style.left="0px";D.style.top="-10000px";D.style.width="1em";D.style.height="1ex";D.style.opacity="0";D.style.backgroundColor="transparent";D.style.borderStyle="none";D.style.outlineStyle="none";D.autocapitalize="off";D.autocomplete="off";D.autocorrect="off";D.wrap="off";D.spellcheck="false";x.append(D);function g(){if(a(D).is(":focus")){D.blur()}else{D.focus()}}function h(){if(q.isConnected()){r.clipboardPasteFrom(A.getEntry2())}}function i(a,b){A.setEntry1(b)}function j(){A.show()}function k(){if(q.isConnected()){r.get_keyboard().set_focused(!0)}}function l(){if(q.isConnected()){r.get_keyboard().set_focused(!1)}}function m(){A.setEntry1(A.getEntry1());document.execCommand("copy")}var E=c.genIcon("copy","sw")+" "+f("copy"),F=c.genIcon("paste","sw")+" "+f("paste");A=new d("vpl_dialog_vnc_clipboard",E,m,F,h,l);y.on("click",function(a){if(a.target==y[0]){k()}else{l()}});this.displayResize=function(){if(q.isConnected()){var a=x.width(),b=x.height();q.setCanvasSize(a,b);r.get_display().viewportChange(0,0,a,b)}};function n(){var b=a("html").width(),c=a(window).height();if(x.width()>b){B=!0;x.dialog("option","width",b)}if(x.parent().height()>c){B=!0;x.dialog("option","height",c-x.prev().outerHeight())}}x.dialog({closeOnEscape:!1,autoOpen:!1,modal:!0,width:"auto",height:"auto",dialogClass:"vpl_ide vpl_vnc",create:function create(){C=c.setTitleBar(x,"vnc","graphic",["clipboard","keyboard"],[j,g])},dragStop:n,focus:k,open:n,beforeClose:function beforeClose(){if(B){var a=x.width(),b=x.height();B=!1;q.setCanvasSize(a,b)}},close:function close(){q.disconnect()},resizeStop:function resizeStop(){n();B=!0}});x.css("padding","1px");x.parent().css("z-index",2e3);this.updateTitle=function(){var a=s;if(""!==u){a+=" ("+u+")"}C.text(f("console")+": "+a)};this.setTitle=function(a){s=a;this.updateTitle()};this.setMessage=function(a){u=a;this.updateTitle()};function o(a,b,c,d){v=b;switch(b){case"normal":q.setMessage("");q.setTitle(f("connected"));break;case"disconnect":case"disconnected":q.setTitle(f("connection_closed"));break;case"failed":q.setTitle(f("connection_fail"));e.log("VNC client: "+d);break;default:q.setMessage("");q.setTitle(f("connecting"));}}this.connect=function(c,d,e,f,g,h){A.setEntry1("");z=h;q.show();var j=a("#"+b+" canvas")[0];if(!r){r=new RFB({target:j,encrypt:c,repeaterID:"",true_color:!0,local_cursor:!0,shared:!1,view_only:!1,onUpdateState:o,onPasswordRequired:null,onClipboard:i});r.set_local_cursor(r.get_display().get_cursor_uri())}if(!e){e=c?443:80}r.connect(d,e,f,g)};this.isOpen=function(){return x.dialog("isOpen")};this.close=function(){x.dialog("close")};this.isConnected=function(){return r&&"disconnected"!=v};this.disconnect=function(){if(r){r.disconnect()}z();A.hide()};function p(a){if(100>a){a=100}return 2*Math.floor(a/2)}this.getCanvasSize=function(){return y.width()+"x"+y.height()};this.setCanvasSize=function(a,b){y.width(p(a));y.height(p(b))};this.show=function(){x.dialog("open");x.width("auto");x.height("auto")};q.setCanvasSize(a(window).width()-150,a(window).height()-150)}});
define ("mod_workshop/modform",["jquery"],function(a){var e={text:{available:null,required:null,requiredHidden:null},file:{available:null,required:null,requiredHidden:null}};function b(a,b){if(!a.available.prop("checked")){a.required.prop("disabled",!0);a.required.prop("checked",!1);if(b.available.prop("checked")){b.required.prop("disabled",!0);b.required.prop("checked",!0);b.requiredHidden.val(1)}}}function c(a){a.required.prop("disabled",!1);a.required.prop("checked",!1);a.requiredHidden.val(0)}function d(){b(e.file,e.text);b(e.text,e.file);if(e.text.available.prop("checked")&&e.file.available.prop("checked")){c(e.text);c(e.file)}}return{init:function init(){e.text.available=a("#id_submissiontypetextavailable");e.text.required=a("#id_submissiontypetextrequired");e.text.requiredHidden=a("input[name=\"submissiontypetextrequired\"][type=\"hidden\"]");e.file.available=a("#id_submissiontypefileavailable");e.file.required=a("#id_submissiontypefilerequired");e.file.requiredHidden=a("input[name=\"submissiontypefilerequired\"][type=\"hidden\"]");e.text.available.on("change",d);e.file.available.on("change",d);d()}}});
define ("mod_workshop/workshopview",["jquery"],function(a){function b(b){var c=0;b.height("auto");b.each(function(){var b=a(this).height();if(b>c){c=b}});b.height(c)}return{init:function init(){var c=a(".path-mod-workshop .userplan dt"),d=a(".path-mod-workshop .userplan dd");b(c);b(d);a(window).on("resize",function(){b(c);b(d)})}}});
define ("mod_xncommons/management",["jquery","jqueryui","theme_coursemos/bootstrap"],function(a){var b={win:null,divwin:null,loaded:0,iframeXnCommonsName:"xncommons-window",iframeGetName:"ifcmsget",moduleurl:M.cfg.wwwroot+"/mod/xncommons"};b.actionurl=b.moduleurl+"/action.php";b.containerid="xncommons_container";b.init=function(){b.loaded=1};b.mform=function(c,d,e,f,g){b.modal();a("#id_selectcontentbtn").click(function(){b.load(c,d,e,f,g);a("#"+b.containerid).modal("show")});a("#id_add_grade_item").change(function(){if(1==a(this).val()){a("#id_autograde").val(1)}else{a("#id_autograde").val(0)}})};b.modal=function(){if(0==a("#"+b.containerid).length){var c=a("<div id=\""+b.containerid+"\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\"></div>"),d=a("<div class=\"modal-dialog modal-xl\" role=\"document\"></div>"),e=a("<div class=\"modal-content\"></div>"),f=a("<div class=\"modal-header\"></div>");f.append("<h5 class=\"modal-title\">"+M.util.get_string("selectcontent","xncommons")+"</h5>");var g="<button type=\"button\" class=\"btn-close\">";g+="<span aria-hidden=\"true\">&times;</span>";g+="</button>";f.append(g);var h=a("<iframe>");h.attr({id:b.iframeXnCommonsName,name:b.iframeXnCommonsName,src:"",width:1e3,height:645}).css("border",0);var i=a("<iframe>");i.attr({id:b.iframeGetName,name:b.iframeGetName,src:"",width:893,height:40}).hide();var j=a("<div id=\"vod-bd\" class=\"modal-body\"></div>");j.append(h);j.append(i);e.append(f).append(j);d.append(e);c.append(d);a("body").append(c);a("#"+b.containerid+" .modal-header .btn-close").click(function(){window.top.frames[b.iframeXnCommonsName].location.href="/mod/xncommons/blank.php";a("#"+b.containerid).modal("hide")});window.closeModal=function(){a("#"+b.containerid).modal("hide")}}};b.load=function(c,d,e,f,g){if(1==b.loaded){var h="";if(0<a("form#xncommons-submit-form").length){h=a("form#xncommons-submit-form")}else{h=a("<form />");h.attr("id","xncommons-submit-form");h.append(b.addElement("UserID",c));h.append(b.addElement("UserName",d));h.append(b.addElement("UserType",e));h.append(b.addElement("Email",""));h.append(b.addElement("SiteAuthKey",f));h.append(b.addElement("TargetUrl",M.cfg.wwwroot));h.append(b.addElement("Action","embed"));h.append(b.addElement("OutputType","ContentID"));h.append(b.addElement("LaunchMode",""));h.append(b.addElement("ReturnURL",M.cfg.wwwroot+"/mod/xncommons/cmsget.php"));h.attr({action:g,target:b.iframeXnCommonsName,method:"post"});a("body").append(h)}h.submit()}};b.cmsget=function(c,d,e,f,g,h,i){if(0<d.length){d.replace(/\n/g,"<br />")}a("form[action=\"modedit.php\"] input[name=\"name\"]",window.parent.document).val(c);a("form[action=\"modedit.php\"] #id_introeditoreditable",window.parent.document).html(d).trigger("change");a("form[action=\"modedit.php\"] input[name=\"contentid\"]",window.parent.document).val(e);a("form[action=\"modedit.php\"] input[name=\"playtime\"]",window.parent.document).val(f);a("form[action=\"modedit.php\"] input[name=\"viewurl\"]",window.parent.document).val(g);a("form[action=\"modedit.php\"] input[name=\"tag\"]",window.parent.document).val(h);a("form[action=\"modedit.php\"] input[name=\"filesize\"]",window.parent.document).val(i);window.parent.closeModal();window.top.frames[b.iframeXnCommonsName].location.href="/mod/xncommons/blank.php"};b.addElement=function(b,c){var d=a("<input />");d.attr({type:"hidden",name:b,value:c});return d};return b});
define ("mod_xncommons/xncommons",["jquery","theme_coursemos/bootstrap"],function(a){var b={isLogin:!0,isProgress:!0,attempt:0,actionurl:M.cfg.wwwroot+"/mod/xncommons/action.php"};b.progress=function(c,d,e,f,g,h,i,j){b.isProgress=0!=c?!0:!1;b.attempt=d;b.ajax(f,g,"1",0,0);a("#viewer .viewer-header .btn-close").click(function(){setTimeout(function(){self.close()},500)});if(b.isProgress){if(!e){b.alertMessage("alert-danger",M.util.get_string("no_progress_period","xncommons"))}else{b.alertMessage("alert-info",M.util.get_string("window_close_message","xncommons"))}if(!h){b.alertMessage("alert-danger",M.util.get_string("error_study_end","local_ubonattend"))}}if(""!=i&&null!==i){require.config({enforceDefine:!1,paths:{externalLearningChecker:i}});require(["externalLearningChecker"],function(a){a.init(j,null)})}};b.alertMessage=function(b,c,d){d="undefined"!=typeof d?d:5e3;var e=null;if(0<a(".viewer-content .alert-message").length){e=parseInt(a(".viewer-content .alert-message:last-child").css("top"))+parseInt(a(".viewer-content .alert-message:last-child").outerHeight())+10}var f=null,g=!0;if(0<b.indexOf("alert-max-move")){if(0<a(".viewer-content .alert-max-move").length){f=a(".viewer-content .alert-max-move");f.html(c);g=!1}}if(g){f=a("<div class=\"alert alert-message\"></div>");if(null!==e){f.css("top",e)}f.addClass(b).html(c);a(".viewer-content").append(f)}f.show();var h=setTimeout(function(){f.remove()},d);f.click(function(){a(this).remove();clearTimeout(h)})};b.ajax=function(c,d,e,f,g){if(0<d&&b.isLogin&&b.isProgress){var h={courseid:c,cmid:d,sesskey:M.cfg.sesskey},i={attempt:b.attempt,state:e,positionfrom:f,positionto:g,unixtime:Math.floor(new Date().getTime()/1e3)};h=a.extend({},h,i);h[coursemostype]="trackDetail";a.ajax({url:b.actionurl,data:h,cache:!1,global:!1,type:"post",success:function success(a){if(a.code==mesg.failure){alert(a.msg);return!1}else if(a.code==mesg.failureNotLogin){alert(a.msg);if(opener){self.close();opener.document.replace(opener.document.location.href)}else{location.replace(location.href)}}return!0},error:function error(a,b){if(a.responseText){alert(b+" : "+a.responseText)}}})}};return{progress:b.progress}});
define ("mod_zoom/form",["jquery","core/form-autocomplete","core/str","core/notification"],function(a,b,c,d){var e={REPEAT_SELECT:"select[name=\"recurrence_type\"]",REPEAT_INTERVAL:".repeat_interval",REPEAT_INTERVAL_DAILY:"#interval_daily",REPEAT_INTERVAL_WEEKLY:"#interval_weekly",REPEAT_INTERVAL_MONTHLY:"#interval_monthly",REPEAT_INTERVAL_OPTIONS:"select[name=\"repeat_interval\"] option",START_TIME:"select[name*=\"start_time\"]",DURATION:"*[name*=\"duration\"]",RECURRING:"input[name=\"recurring\"][type!=\"hidden\"]",OPTION_JBH:"input[name=\"option_jbh\"][type!=\"hidden\"]",OPTION_WAITING_ROOM:"input[name=\"option_waiting_room\"][type!=\"hidden\"]"},f={REPEAT_OPTION_NONE:0,REPEAT_OPTION_DAILY:1,REPEAT_OPTION_WEEKLY:2,REPEAT_OPTION_MONTHLY:3},g={REPEAT_OPTION_DAILY:90,REPEAT_OPTION_WEEKLY:12,REPEAT_OPTION_MONTHLY:3},h=function(){var b=!1,c=parseInt(a(e.REPEAT_SELECT).val(),10);if(a(e.RECURRING).prop("checked")&&c===f.REPEAT_OPTION_NONE){b=!0}a(e.START_TIME).prop("disabled",b);a(e.DURATION).prop("disabled",b)},i=function(){a(e.REPEAT_INTERVAL).hide();var b=parseInt(a(e.REPEAT_SELECT).val(),10);if(b===f.REPEAT_OPTION_DAILY){a(e.REPEAT_INTERVAL_DAILY).show()}else if(b===f.REPEAT_OPTION_WEEKLY){a(e.REPEAT_INTERVAL_WEEKLY).show()}else if(b===f.REPEAT_OPTION_MONTHLY){a(e.REPEAT_INTERVAL_MONTHLY).show()}},j=function(){var b=parseInt(a(e.REPEAT_SELECT).val(),10);a(e.REPEAT_INTERVAL_OPTIONS).each(function(){if(b===f.REPEAT_OPTION_WEEKLY){if(this.value>g.REPEAT_OPTION_WEEKLY){a(this).hide()}}else if(b===f.REPEAT_OPTION_MONTHLY){if(this.value>g.REPEAT_OPTION_MONTHLY){a(this).hide()}}else{a(this).show()}})},k=function(b,c,d,e){this.tabsColumn=b;this.tabsContentColumn=c;this.emptyAlert=e;this.countTabs=d;this.buildTab=function(b){var c=b.tab.element,d=a(".nav-link",c);c.attr("id","tab-"+this.countTabs);a(".tab-name",d).text(b.tab.name);d.attr("href","#link"+this.countTabs);a("li a",this.tabsColumn).removeClass("active");d.addClass("active");return c};this.buildTabContent=function(b){var c=b.tabContent.element;c.attr("id","link"+this.countTabs);a(".tab-pane",this.tabsContentColumn).removeClass("active");c.addClass("active");return c};this.addTab=function(b){var c=this.buildTab(b),d=this.buildTabContent(b);this.emptyAlert.addClass("hidden");a("ul",this.tabsColumn).append(c);a(".tab-content",this.tabsContentColumn).append(d);return{element:c,content:d}};this.deleteTab=function(b){var c=b,d=a(a("a",c).attr("href"));c.remove();d.remove();var e=a("li",this.tabsColumn).length;if(!e){this.emptyAlert.removeClass("hidden")}else{var f=a("li a.active",this.tabsColumn).length;if(!f){a("li:first-child a",this.tabsColumn).trigger("click")}}}},l=function(){this.roomsListColumn=a("#meeting-rooms-list");this.roomsList=a("ul",this.roomsListColumn);this.addBtn=a("#add-room",this.roomsListColumn);this.emptyAlert=a(".empty-alert",this.roomsListColumn);this.deleteBtn=a(".delete-room",this.roomsListColumn);this.roomsDataColumn=a("#meeting-rooms-data");this.roomItemToClone=a("#rooms-list-item").html();this.roomItemDataToClone=a("#rooms-list-item-data").html();this.initialRoomsCount=parseInt(this.roomsListColumn.attr("data-initial-rooms-count"));this.tabsComponent=new k(this.roomsListColumn,this.roomsDataColumn,this.initialRoomsCount,this.emptyAlert);this.init=function(){c.get_strings([{key:"room",component:"zoom"}]).then().fail(d.exception);this.addRoomEvent();this.deleteRoomEvent();var b=a("li",this.roomsListColumn).length;if(b){this.changeRoomNameEvent();this.buildAutocompleteComponents()}else{this.emptyAlert.removeClass("hidden")}};this.addRoomEvent=function(){var b=this;b.addBtn.click(function(){b.tabsComponent.countTabs++;var c=M.util.get_string("room","zoom")+" "+b.tabsComponent.countTabs,d=a(b.roomItemToClone),e=a(b.roomItemDataToClone),f=b.tabsComponent.countTabs,g="room-name-"+f;a("input[type=text]",e).prev().attr("for",g);a("input[type=text]",e).attr("id",g);a("input[type=text]",e).attr("name",g);a("input[type=text]",e).val(c);a("input[type=text]",e).next().attr("name","rooms["+f+"]");a("input[type=text]",e).next().val(c);var h="participants-"+f;a(".room-participants",e).attr("id",h);a(".room-participants",e).attr("name","roomsparticipants["+f+"][]");var i="groups-"+f;a(".room-groups",e).attr("id",i);a(".room-groups",e).attr("name","roomsgroups["+f+"][]");var j=b.tabsComponent.addTab({tab:{name:c,element:d},tabContent:{element:e}});a("li:last .delete-room",b.roomsList).click(function(){var c=a(this).closest("li");b.tabsComponent.deleteTab(c)});a("input[type=text]",j.content).on("change keyup paste",function(){var b=this.value;a(this).next().val(b);a(".tab-name",j.element).text(this.value)});b.buildAutocompleteComponent(h,"addparticipant");b.buildAutocompleteComponent(i,"addparticipantgroup")})};this.deleteRoomEvent=function(){var b=this;b.deleteBtn.click(function(){var c=a(this).closest("li");b.tabsComponent.deleteTab(c)})};this.changeRoomNameEvent=function(){var b=this;a("li",this.roomsListColumn).each(function(){var c=a(this).attr("id").split("-"),d=c[1];a("input[name=\"room-name-"+d+"\"]",b.roomsDataColumn).on("change keyup paste",function(){var b=this.value;a(this).next().val(b);a("#tab-"+d+" .tab-name").text(this.value)})})};this.buildAutocompleteComponents=function(){var b=this;a(".room-participants",b.roomsDataColumn).each(function(){var c=a(this).attr("id");b.buildAutocompleteComponent(c,"addparticipant")});a(".room-groups",b.roomsDataColumn).each(function(){var c=a(this).attr("id");b.buildAutocompleteComponent(c,"addparticipantgroup")})};this.buildAutocompleteComponent=function(a,e){c.get_strings([{key:e,component:"zoom"},{key:"selectionarea",component:"zoom"}]).then(function(c){var d=c[0],e=c[1];b.enhance("#"+a,!1,"",d,!1,!0,e,!0);return null}).fail(d.exception)}};return{init:function init(){var b=a(e.OPTION_JBH),c=a(e.OPTION_WAITING_ROOM);b.change(function(){if(!0===b.is(":checked")){c.prop("checked",!1)}});c.change(function(){if(!0===c.is(":checked")){b.prop("checked",!1)}});h();i();j();a(e.REPEAT_SELECT).change(function(){h();i();j()});a(e.RECURRING).change(function(){h()});var d=new l;d.init()}}});
define ("mod_zoom/ubzoom",["jquery","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a){return{userParticipationDetail:function userParticipationDetail(b,c,d){a("#participants-search").submit(function(){a("#participants-search input[name='page']").val("0")});a(".btn-user-detail").click(function(){var e=a(this).attr("title"),f=a(this).attr("data-userid");a.ajax({url:"ub_action.php",data:"type="+"USER_P_DETAIL"+"&courseid="+b+"&tableid="+d+"&userid="+f+"&multiple="+c,type:"post",success:function success(b){var c=a("#participantModal .modal-body");c.empty();if(b.code==mesg.success){if(b.html){c.append(b.html);a("#participantModal .modal-header .modal-title").text(e);a("#participantModal").modal("show")}}else{alert(b.msg)}return!1}})})},apiCall:function apiCall(b,c,d,e){a(".btn-api-hostinfo").click(function(){a("#zoomApiModal .modal-body .param-value").empty();a("#zoomApiModal .modal-body .param-value-div").empty();a("#zoomApiModal .modal-header .modal-title").text("Zoom User-Info for Host");a("#zoomApiModal .modal-body .param").text("Host-ID : ");a("#zoomApiModal .modal-body .param-value").text(c);var b=a("#zoomApiModal .modal-body #api-result");a("#zoomapiForm")[0].reset();a.ajax({url:"ub_action.php",data:"type=API_CALL_HOSTINFO&hostid="+c,type:"post",success:function success(c){if(c.code==mesg.success){if(c.info){b.text(c.info);a("#zoomApiModal").modal("show")}}else{alert(c.msg)}return!1}})});a(".btn-api-zoominfo").click(function(){a("#zoomApiModal .modal-body .param-value").empty();a("#zoomApiModal .modal-body .param-value-div").empty();a("#zoomApiModal .modal-header .modal-title").text("Zoom Course Meeting-Info for Host");a("#zoomApiModal .modal-body .param").text("Course Meeting-ID : ");a("#zoomApiModal .modal-body .param-value").text(b);var c=a("#zoomApiModal .modal-body #api-result");a("#zoomapiForm")[0].reset();a.ajax({url:"ub_action.php",data:"type=API_CALL_MEETINGINFO&meetingid="+b,type:"post",success:function success(b){if(b.code==mesg.success){if(b.info){c.val(b.info);a("#zoomApiModal").modal("show")}}else{alert(b.msg)}return!1}})});a(".btn-api-sessionsinfo").click(function(){a("#zoomApiModal .modal-body .param-value").empty();a("#zoomApiModal .modal-body .param-value-div").empty();a("#zoomApiModal .modal-header .modal-title").text("Prgress Meeting History for Host");a("#zoomApiModal .modal-body .param").text("Host-ID & Condition period");var b=new Date(1e3*d).toLocaleDateString("ko-KR");a("#zoomApiModal .modal-body .param-value-div").html("- Host id : "+c+"<br/>- Period : "+b+" 00:00:00 ~ "+b+" 23:29:59");var e=a("#zoomApiModal .modal-body #api-result");a("#zoomapiForm")[0].reset();a.ajax({url:"ub_action.php",data:"type=API_CALL_SESSIONS&hostid="+c+"&starttime="+d,type:"post",success:function success(b){if(b.code==mesg.success){if(b.info){e.val(b.info);a("#zoomApiModal").modal("show")}}else{alert(b.msg)}return!1}})});a(".btn-api-participants").click(function(){var b=a(this).attr("data-uuid");a("#zoomApiModal .modal-body .param-value").empty();a("#zoomApiModal .modal-body .param-value-div").empty();a("#zoomApiModal .modal-header .modal-title").text("Participants List");a("#zoomApiModal .modal-body .param").text("UUID");a("#zoomApiModal .modal-body .param-value").text(b);var c=a("#zoomApiModal .modal-body #api-result");a("#zoomapiForm")[0].reset();a.ajax({url:"ub_action.php",data:"type=API_CALL_PARTICIPANTS&uuid="+b,type:"post",success:function success(b){if(b.code==mesg.success){if(b.info){c.val(b.info);a("#zoomApiModal").modal("show")}}else{alert(b.msg)}return!1}})});a(".btn-setting-attend-save").click(function(){var b=a("#zoomattendsettingForm").serialize();a("#zoomattendsettingForm")[0].reset();a.ajax({url:"ub_action.php",data:"type=ATTENDANCE_SETTING&"+b,type:"post",success:function success(a){if(a.code==mesg.success){alert(a.msg);location.reload()}else{alert(a.msg)}return!1}})});a(".btn-api-recording").click(function(){var b=a(this).attr("data-id");showSubmitProgress();a.ajax({url:"ub_action.php",data:"type=API_CALL_RECORDING&id="+b,type:"post",success:function success(a){if(a.code==mesg.success){alert(a.msg);location.reload()}else{alert(a.msg)}hideSubmitProgress();return!1}})});a(".btn-recordings-list").click(function(){var b=a(this).attr("data-id");a.ajax({url:"ub_action.php",data:"type=RECORDING_LIST&id="+b,type:"post",success:function success(b){if(b.code==mesg.success){a("#zoomRecordingModal .modal-body").html(b.html);a("#zoomRecordingModal").modal("show")}else{alert(b.html)}return!1}})});a(".btn-recordigs-visible").click(function(){var b=a(this).attr("data-params"),c=a(this).attr("data-showrecording");a.ajax({url:"ub_action.php",data:"type=RECORDING_VISIBLE&"+b+"&showrecording="+c,type:"get",success:function success(b){if(b.code==mesg.success){alert(b.msg);if("0"==c){a(this.element).addClass("btn-dark").removeClass("btn-primary");a(this.element).attr("data-showrecording","1");a(this.element).text(M.util.get_string("ublang_recording_show_to_paticipants","mod_zoom"))}else{a(this.element).addClass("btn-primary").removeClass("btn-dark");a(this.element).attr("data-showrecording","0");a(this.element).text(M.util.get_string("ublang_recording_hide_to_paticipants","mod_zoom"))}location.reload()}else{alert(b.msg)}return!1}})});a(".btn-api-recordinginfo").click(function(){var b=a(this).attr("data-id");a("#zoomApiModal .modal-body .param-value").empty();a("#zoomApiModal .modal-body .param-value-div").empty();a("#zoomApiModal .modal-header .modal-title").text("Recodings Info");a("#zoomApiModal .modal-body .param").text("");a("#zoomApiModal .modal-body .param-value").text("");var c=a("#zoomApiModal .modal-body #api-result");a("#zoomapiForm")[0].reset();a.ajax({url:"ub_action.php",data:"type=RECORDING_DOWNLOADINFO&id="+b,type:"get",success:function success(b){if(b.info){c.val(b.info);a("#zoomApiModal").modal("show")}return!1}})});a(".btn-recording-download").click(function(){var b=a(this);if("35"<=e){var c=b.find(".spinner-border-logining");b.attr("disabled","disabled");c.removeClass("d-none")}else{var d=b.text(),f=b.data("loading-text");b.html(f)}var g=b.attr("data-params");a.ajax({url:"ub_action.php",data:"type=RECORDING_DOWNLOAD&"+g,type:"get",success:function success(a){if(a.code==mesg.success){var f=a.filename,g=document.createElement("a");g.href=a.url;g.download=f;document.body.appendChild(g);g.click();g.remove()}else{alert(a.msg)}if("35"<=e){b.removeAttr("disabled");c.addClass("d-none")}else{b.html(d);b.button("reset")}return!1}})});a(".btn-recording-uploadvod").click(function(){var b=a(this);if("35"<=e){var c=b.find(".spinner-border-logining");b.attr("disabled","disabled");c.removeClass("d-none")}else{var d=b.text(),f=b.data("loading-text");b.html(f)}var g=b.attr("data-params");a.ajax({url:"ub_action.php",data:"type=RECORDING_UPLOAD_VOD&"+g,type:"get",success:function success(a){if(a.code==mesg.success){alert(M.util.get_string("ublang_upload_success","mod_zoom"));location.reload()}else{alert(a.msg+"\n[Error Code : "+a.code+"]")}if("35"<=e){b.removeAttr("disabled");c.addClass("d-none")}else{b.html(d);b.button("reset")}return!1}})});a(".btn-recordings-import").click(function(){var b=a(this).attr("data-id");a.ajax({url:"ub_action.php",data:"type=RECORDINGS_IMPORT&id="+b,type:"get",success:function success(a){if(a.code==mesg.success){console.log(JSON.stringify(a.result));alert(JSON.stringify(a.result))}else{console.log(JSON.stringify(a.result));alert(a.result)}return!1}})})}}});
define ("mod_zoom/scheduleforchooser",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;var b={fields:{selector:"[data-scheduleforchooser-field=\"selector\"]",updateButton:"[data-scheduleforchooser-field=\"updateButton\"]"}};a.init=function init(){document.querySelector(b.fields.selector).addEventListener("change",function(a){var c=a.target.closest("form"),d=c.querySelector(b.fields.updateButton),e=d.closest("fieldset"),f=new URL(c.action);f.hash=e.id;c.action=f.toString();d.click()})}});
define ("mod_zoom/toggle_text",["exports","core/str"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;function c(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function d(a){return function(){var b=this,d=arguments;return new Promise(function(e,f){var i=a.apply(b,d);function g(a){c(i,e,f,g,h,"next",a)}function h(a){c(i,e,f,g,h,"throw",a)}g(void 0)})}}a.init=function init(){var a=document.querySelector("#show-more-button");if(null!==a){var c=document.querySelector("#show-more-body");a.addEventListener("click",d(regeneratorRuntime.mark(function d(){return regeneratorRuntime.wrap(function(d){while(1){switch(d.prev=d.next){case 0:if(!(""===c.style.display)){d.next=7;break}c.style.display="none";d.next=4;return(0,b.get_string)("meeting_invite_show","mod_zoom");case 4:a.innerHTML=d.sent;d.next=11;break;case 7:c.style.display="";d.next=10;return(0,b.get_string)("meeting_invite_hide","mod_zoom");case 10:a.innerHTML=d.sent;case 11:case"end":return d.stop();}}},d)})))}}});
define ("enrol_manual/form-potential-user-selector",["jquery","core/ajax","core/templates","core/str"],function(a,b,c,d){return{processResults:function processResults(b,c){var d=[];if(a.isArray(c)){a.each(c,function(a,b){d.push({value:b.id,label:b._label})});return d}else{return c}},transport:function transport(e,f,g,h){var i,j=a(e).attr("courseid"),k=a(e).attr("userfields").split(",");if("undefined"==typeof j){j="1"}var l=a(e).attr("enrolid");if("undefined"==typeof l){l=""}var m=parseInt(a(e).attr("perpage"));if(isNaN(m)){m=100}i=b.call([{methodname:"core_enrol_get_potential_users",args:{courseid:j,enrolid:l,search:f,searchanywhere:!0,page:0,perpage:m+1}}]);i[0].then(function(b){var e=[],f=0;if(b.length<=m){a.each(b,function(b,d){var f=d,g=[];a.each(k,function(a,b){if("undefined"!=typeof d[b]&&""!==d[b]){f.hasidentity=!0;g.push(d[b])}});f.identity=g.join(", ");e.push(c.render("enrol_manual/form-user-selector-suggestion",f))});return a.when.apply(a.when,e).then(function(){var c=arguments;a.each(b,function(a,b){b._label=c[f];f++});g(b)})}else{return d.get_string("toomanyuserstoshow","core",">"+m).then(function(a){g(a)})}}).fail(h)}}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("enrol_manual/quickenrolment",["exports","core_table/dynamic","core/str","core/toast","core/config","core/fragment","core/modal_events","core/modal_factory","core/notification","jquery","core/pending","core/prefetch"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=o(b);c=o(c);d=o(d);e=m(e);f=m(f);g=m(g);h=m(h);i=m(i);j=m(j);k=m(k);l=m(l);function m(a){return a&&a.__esModule?a:{default:a}}function n(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;n=function(){return a};return a}function o(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=n();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function p(a,b){return u(a)||t(a,b)||r(a,b)||q()}function q(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(a,b){if(!a)return;if("string"==typeof a)return s(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return s(a,b)}function s(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function t(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function u(a){if(Array.isArray(a))return a}var v={cohortSelector:"#id_cohortlist",triggerButtons:".enrolusersbutton.enrol_manual_plugin [type='submit']",unwantedHiddenFields:"input[value='_qf__force_multiselect_submission']",buttonWrapper:"[data-region=\"wrapper\"]"},w=function(a){return f.default.loadFragment("enrol_manual","enrol_users_form",a,{})},x=function(a){var c=a.closest(v.buttonWrapper);return b.getTableFromId(c.dataset.tableUniqueid)},y=function(a){document.addEventListener("click",function(b){if(b.target.closest(v.triggerButtons)){b.preventDefault();z(x(b.target),a)}})},z=function(a,b){var d=new k.default("enrol_manual/quickenrolment:showModal");return h.default.create({type:h.default.types.SAVE_CANCEL,large:!0,title:c.get_string("enrolusers","enrol_manual"),body:w(b)}).then(function(b){b.getRoot().on(g.default.save,function(a){a.preventDefault();b.getRoot().find("form").submit()});b.getRoot().on("submit","form",function(c){c.preventDefault();A(a,b)});b.getRoot().on(g.default.hidden,function(){b.destroy()});return b}).then(function(a){a.show();return a}).then(function(a){a.setSaveButtonText(c.get_string("enrolusers","enrol_manual"));a.getBodyPromise().then(function(b){if(b.get(0).querySelector(v.cohortSelector)){a.setSaveButtonText(c.get_string("enroluserscohorts","enrol_manual"))}return b}).catch();d.resolve();return a}).catch(i.default.exception)},A=function(a,f){var g=f.getRoot().find("form");g.get(0).querySelectorAll(v.unwantedHiddenFields).forEach(function(a){return a.remove()});f.hide();f.destroy();j.default.ajax("".concat(e.default.wwwroot,"/enrol/manual/ajax.php?").concat(g.serialize()),{type:"GET",processData:!1,contentType:"application/json"}).then(function(a){if(a.error){throw new Error(a.error)}return a.count}).then(function(d){return Promise.all([c.get_string("totalenrolledusers","enrol",d),b.refreshTableContent(a)])}).then(function(a){var b=p(a,1),c=b[0];return c}).then(function(a){return d.add(a)}).catch(function(a){i.default.addNotification({message:a.message,type:"error"})})},B=function(a){var b=a.contextid;y(b);l.default.prefetchStrings("enrol_manual",["enrolusers","enroluserscohorts"]);l.default.prefetchString("enrol","totalenrolledusers")};a.init=B});
define ("message_popup/notification_area_content_area",["jquery","core/templates","core/notification","core/custom_interaction_events","message_popup/notification_repository","message_popup/notification_area_events"],function(a,b,c,d,e,f){var g={CONTAINER:"[data-region=\"notification-area\"]",CONTENT:"[data-region=\"content\"]",HEADER:"[data-region=\"header\"]",FOOTER:"[data-region=\"footer\"]",TOGGLE_MODE:"[data-action=\"toggle-mode\"]"},h={HEADER:"message_popup/notification_area_content_area_header",CONTENT:"message_popup/notification_area_content_area_content",FOOTER:"message_popup/notification_area_content_area_footer"},i=function(b,c){this.root=a(b);this.container=this.root.closest(g.CONTAINER);this.userId=c;this.header=this.root.find(g.HEADER);this.content=this.root.find(g.CONTENT);this.footer=this.root.find(g.FOOTER);this.registerEventListeners()};i.prototype.getRoot=function(){return this.root};i.prototype.getContainer=function(){return this.container};i.prototype.getUserId=function(){return this.userId};i.prototype.getHeader=function(){return this.header};i.prototype.getContent=function(){return this.content};i.prototype.getFooter=function(){return this.footer};i.prototype.show=function(){this.getContainer().addClass("show-content-area")};i.prototype.hide=function(){this.getContainer().removeClass("show-content-area")};i.prototype.setHeaderHTML=function(a){this.getHeader().empty().html(a)};i.prototype.setContentHTML=function(a){this.getContent().empty().html(a)};i.prototype.setFooterHTML=function(a){this.getFooter().empty().html(a)};i.prototype.showNotification=function(c){var d=b.render(h.HEADER,c).done(function(a){this.setHeaderHTML(a)}.bind(this)),e=b.render(h.CONTENT,c).done(function(a){this.setContentHTML(a)}.bind(this)),g=b.render(h.FOOTER,c).done(function(a){this.setFooterHTML(a)}.bind(this));return a.when(d,e,g).done(function(){this.show();this.getContainer().trigger(f.notificationShown,[c])}.bind(this))};i.prototype.registerEventListeners=function(){d.define(this.getRoot(),[d.events.activate]);this.getRoot().on(d.events.activate,g.VIEW_TOGGLE,function(){this.hide()}.bind(this));this.getContainer().on(f.showNotification,function(a,b){this.showNotification(b)}.bind(this))};return i});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("message_popup/notification_area_control_area",["jquery","core/templates","core/notification","core/custom_interaction_events","message_popup/notification_repository","message_popup/notification_area_events"],function(a,b,c,d,e,f){var g={CONTAINER:"[data-region=\"notification-area\"]",CONTENT:"[data-region=\"content\"]",NOTIFICATION:"[data-region=\"notification-content-item-container\"]",CAN_RECEIVE_FOCUS:"input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]"},h={NOTIFICATION:"message_popup/notification_content_item"},i=function(b,c){this.root=a(b);this.container=this.root.closest(g.CONTAINER);this.userId=c;this.content=this.root.find(g.CONTENT);this.offset=0;this.limit=20;this.initialLoad=!1;this.isLoading=!1;this.loadedAll=!1;this.notifications={};this.registerEventListeners()};i.prototype.getRoot=function(){return this.root};i.prototype.getContainer=function(){return this.container};i.prototype.getUserId=function(){return this.userId};i.prototype.getContent=function(){return this.content};i.prototype.getOffset=function(){return this.offset};i.prototype.getLimit=function(){return this.limit};i.prototype.setOffset=function(a){this.offset=a};i.prototype.setLimit=function(a){this.limit=a};i.prototype.incrementOffset=function(){this.offset+=this.limit};i.prototype.startLoading=function(){this.isLoading=!0;this.getRoot().addClass("loading")};i.prototype.stopLoading=function(){this.isLoading=!1;this.getRoot().removeClass("loading")};i.prototype.hasDoneInitialLoad=function(){return this.initialLoad};i.prototype.hasLoadedAllContent=function(){return this.loadedAll};i.prototype.setLoadedAllContent=function(a){this.loadedAll=a};i.prototype.setCacheNotification=function(a){this.notifications[a.id]=a};i.prototype.getCacheNotification=function(a){return this.notifications[a]};i.prototype.getNotificationElement=function(a){var b=this.getRoot().find(g.NOTIFICATION+"[data-id=\""+a+"\"]");return 1==b.length?b:null};i.prototype.scrollNotificationIntoView=function(a){var b=a.position(),c=this.getRoot(),d=b.top-c.scrollTop();if(d>c.innerHeight()){var e=a.outerHeight();e=4*e;var f=b.top-e;c.scrollTop(f)}};i.prototype.showNotification=function(b){if("object"!==_typeof(b)){b=this.getNotificationElement(b)}if(b&&b.length){this.getRoot().find(g.NOTIFICATION).removeClass("selected");b.addClass("selected").find(g.CAN_RECEIVE_FOCUS).focus();var c=b.attr("data-id"),d=this.getCacheNotification(c);this.scrollNotificationIntoView(b);this.getContainer().trigger(f.showNotification,[a.extend({},d)])}};i.prototype.markNotificationAsRead=function(a){return e.markAsRead(a.attr("data-id")).done(function(){a.removeClass("unread")})};i.prototype.renderNotifications=function(c){var d=[],e=this.getContent();a.each(c,function(a,c){var e=c.contexturl;delete c.contexturl;var f=b.render(h.NOTIFICATION,c).then(function(a,b){c.contexturl=e;this.setCacheNotification(c);return{html:a,js:b}}.bind(this));d.push(f)}.bind(this));return a.when.apply(a,d).then(function(){a.each(arguments,function(a,c){e.append(c.html);b.runTemplateJS(c.js)})})};i.prototype.loadMoreNotifications=function(){if(this.isLoading||this.hasLoadedAllContent()){return a.Deferred().resolve()}this.startLoading();var b={limit:this.getLimit(),offset:this.getOffset(),useridto:this.getUserId()};if(!this.initialLoad){b.limit=this.getOffset()+this.getLimit();b.offset=0}var c=e.query(b).then(function(a){var b=a.notifications;this.unreadCount=a.unreadcount;this.setLoadedAllContent(!b.length||b.length<this.getLimit());this.initialLoad=!0;if(b.length){this.incrementOffset();return this.renderNotifications(b)}return!1}.bind(this)).always(function(){this.stopLoading()}.bind(this));return c};i.prototype.registerEventListeners=function(){d.define(this.getRoot(),[d.events.activate,d.events.scrollBottom,d.events.scrollLock,d.events.up,d.events.down]);this.getRoot().on(d.events.scrollBottom,function(){this.loadMoreNotifications()}.bind(this));this.getRoot().on(d.events.activate,g.NOTIFICATION,function(b){var c=a(b.target).closest(g.NOTIFICATION);this.showNotification(c)}.bind(this));this.getRoot().on(d.events.up,g.NOTIFICATION,function(b,c){var d=a(b.target).closest(g.NOTIFICATION);this.showNotification(d.prev());c.originalEvent.preventDefault()}.bind(this));this.getRoot().on(d.events.down,g.NOTIFICATION,function(b,c){var d=a(b.target).closest(g.NOTIFICATION);this.showNotification(d.next());c.originalEvent.preventDefault()}.bind(this));this.getContainer().on(f.notificationShown,function(a,b){if(!b.read){var c=this.getNotificationElement(b.id);if(c){this.markNotificationAsRead(c)}var d=this.getCacheNotification(b.id);if(d){d.read=!0}}}.bind(this))};return i});
define ("message_popup/notification_area_events",[],function(){return{showNotification:"notification-area-events:showNotification",notificationShown:"notification-area-events:notificationShown"}});
define ("message_popup/notification_popover_controller",["jquery","core/ajax","core/templates","core/str","core/url","core/notification","core/custom_interaction_events","core/popover_region_controller","message_popup/notification_repository","message_popup/notification_area_events"],function(a,b,c,d,e,f,g,h,i,j){var k={MARK_ALL_READ_BUTTON:"[data-action=\"mark-all-read\"]",ALL_NOTIFICATIONS_CONTAINER:"[data-region=\"all-notifications\"]",NOTIFICATION:"[data-region=\"notification-content-item-container\"]",UNREAD_NOTIFICATION:"[data-region=\"notification-content-item-container\"].unread",NOTIFICATION_LINK:"[data-action=\"content-item-link\"]",EMPTY_MESSAGE:"[data-region=\"empty-message\"]",COUNT_CONTAINER:"[data-region=\"count-container\"]"},l=function(a){h.call(this,a);this.markAllReadButton=this.root.find(k.MARK_ALL_READ_BUTTON);this.unreadCount=0;this.lastQueried=0;this.userId=this.root.attr("data-userid");this.container=this.root.find(k.ALL_NOTIFICATIONS_CONTAINER);this.limit=20;this.offset=0;this.loadedAll=!1;this.initialLoad=!1;this.unreadCount=this.root.find(k.COUNT_CONTAINER).html()};l.prototype=Object.create(h.prototype);l.prototype.constructor=l;l.prototype.updateButtonAriaLabel=function(){if(this.isMenuOpen()){d.get_string("hidenotificationwindow","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))}else{if(this.unreadCount){d.get_string("shownotificationwindowwithcount","message",this.unreadCount).done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))}else{d.get_string("shownotificationwindownonew","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))}}};l.prototype.getContent=function(){return this.container};l.prototype.getOffset=function(){return this.offset};l.prototype.incrementOffset=function(){this.offset+=this.limit};l.prototype.hasDoneInitialLoad=function(){return this.initialLoad};l.prototype.hasLoadedAllContent=function(){return this.loadedAll};l.prototype.setLoadedAllContent=function(a){this.loadedAll=a};l.prototype.renderUnreadCount=function(){var a=this.root.find(k.COUNT_CONTAINER);if(this.unreadCount){a.text(this.unreadCount);a.removeClass("hidden")}else{a.addClass("hidden")}};l.prototype.hideUnreadCount=function(){this.root.find(k.COUNT_CONTAINER).addClass("hidden")};l.prototype.getNotificationElement=function(a){var b=this.root.find(k.NOTIFICATION+"[data-id=\""+a+"\"]");return 1==b.length?b:null};l.prototype.renderNotifications=function(b,d){var f=[];a.each(b,function(a,b){var d=this.getOffset()-this.limit;b.viewmoreurl=e.relativeUrl("/message/output/popup/notifications.php",{notificationid:b.id,offset:d});var g={notificationid:b.id};b.contexturl=e.relativeUrl("message/output/popup/mark_notification_read.php",g);var h=c.render("message_popup/notification_content_item",b).then(function(a,b){return{html:a,js:b}});f.push(h)}.bind(this));return a.when.apply(a,f).then(function(){a.each(arguments,function(a,b){d.append(b.html);c.runTemplateJS(b.js)})})};l.prototype.loadMoreNotifications=function(){if(this.isLoading||this.hasLoadedAllContent()){return a.Deferred().resolve()}this.startLoading();var b={limit:this.limit,offset:this.getOffset(),useridto:this.userId},c=this.getContent();return i.query(b).then(function(a){var b=a.notifications;this.unreadCount=a.unreadcount;this.lastQueried=Math.floor(new Date().getTime()/1e3);this.setLoadedAllContent(!b.length||b.length<this.limit);this.initialLoad=!0;this.updateButtonAriaLabel();if(b.length){this.incrementOffset();return this.renderNotifications(b,c)}return!1}.bind(this)).always(function(){this.stopLoading()}.bind(this))};l.prototype.markAllAsRead=function(){this.markAllReadButton.addClass("loading");var a={useridto:this.userId,timecreatedto:this.lastQueried};return i.markAllAsRead(a).then(function(){this.unreadCount=0;this.root.find(k.UNREAD_NOTIFICATION).removeClass("unread")}.bind(this)).always(function(){this.markAllReadButton.removeClass("loading")}.bind(this))};l.prototype.registerEventListeners=function(){g.define(this.root,[g.events.activate]);this.root.on(g.events.activate,k.MARK_ALL_READ_BUTTON,function(a,b){this.markAllAsRead();a.stopPropagation();b.originalEvent.preventDefault()}.bind(this));this.root.on(g.events.activate,k.NOTIFICATION_LINK,function(b){var c=a(b.target).closest(k.NOTIFICATION);if(c.hasClass("unread")){this.unreadCount--;c.removeClass("unread")}b.stopPropagation()}.bind(this));this.root.on(this.events().menuOpened,function(){this.hideUnreadCount();this.updateButtonAriaLabel();if(!this.hasDoneInitialLoad()){this.loadMoreNotifications()}}.bind(this));this.root.on(this.events().menuClosed,function(){this.renderUnreadCount();this.updateButtonAriaLabel()}.bind(this));this.root.on(this.events().startLoading,function(){this.getContent().attr("aria-busy","true")}.bind(this));this.root.on(this.events().stopLoading,function(){this.getContent().attr("aria-busy","false")}.bind(this));this.getContentContainer().on(g.events.scrollBottom,function(){if(!this.isLoading&&!this.hasLoadedAllContent()){this.loadMoreNotifications()}}.bind(this));g.define(this.getContentContainer(),[g.events.scrollLock]);a(document).on(j.notificationShown,function(a,b){if(!b.read){var c=this.getNotificationElement(b.id);if(c){c.removeClass("unread")}this.unreadCount--;this.renderUnreadCount()}}.bind(this))};return l});
define ("message_popup/notification_repository",["core/ajax","core/notification"],function(a,b){return{query:function query(c){if("undefined"==typeof c.limit){c.limit=20}if("undefined"==typeof c.offset){c.offset=0}var d=a.call([{methodname:"message_popup_get_popup_notifications",args:c}])[0];d.fail(b.exception);return d},countUnread:function countUnread(c){var d=a.call([{methodname:"message_popup_get_unread_popup_notification_count",args:c}])[0];d.fail(b.exception);return d},markAllAsRead:function markAllAsRead(c){var d=a.call([{methodname:"core_message_mark_all_notifications_as_read",args:c}])[0];d.fail(b.exception);return d},markAsRead:function markAsRead(c,d){var e={notificationid:c};if(d){e.timeread=d}var f=a.call([{methodname:"core_message_mark_notification_read",args:e}])[0];f.fail(b.exception);return f}}});
define ("block_myoverview/main",["jquery","block_myoverview/view","block_myoverview/view_nav"],function(a,b,c){return{init:function init(d){d=a(d);c.init(d);b.init(d)}}});
define ("block_myoverview/repository",["core/ajax","core/notification"],function(a,b){return{getEnrolledCoursesByTimeline:function getEnrolledCoursesByTimeline(b){var c=a.call([{methodname:"core_course_get_enrolled_courses_by_timeline_classification",args:b}])[0];return c},setFavouriteCourses:function setFavouriteCourses(b){var c=a.call([{methodname:"core_course_set_favourite_courses",args:b}])[0];return c},updateUserPreferences:function updateUserPreferences(c){a.call([{methodname:"core_user_update_user_preferences",args:c}])[0].fail(b.exception)}}});
define ("block_myoverview/selectors",[],function(){return{courseView:{region:"[data-region=\"courses-view\"]",regionContent:"[data-region=\"course-view-content\"]"}}});
define ("block_myoverview/view",["jquery","block_myoverview/repository","core/paged_content_factory","core/pubsub","core/custom_interaction_events","core/notification","core/templates","core_course/events","block_myoverview/selectors","core/paged_content_events"],function(a,b,c,d,e,f,g,h,i,j){var k={COURSE_REGION:"[data-region=\"course-view-content\"]",ACTION_HIDE_COURSE:"[data-action=\"hide-course\"]",ACTION_SHOW_COURSE:"[data-action=\"show-course\"]",ACTION_ADD_FAVOURITE:"[data-action=\"add-favourite\"]",ACTION_REMOVE_FAVOURITE:"[data-action=\"remove-favourite\"]",FAVOURITE_ICON:"[data-region=\"favourite-icon\"]",ICON_IS_FAVOURITE:"[data-region=\"is-favourite\"]",ICON_NOT_FAVOURITE:"[data-region=\"not-favourite\"]",PAGED_CONTENT_CONTAINER:"[data-region=\"page-container\"]"},l={COURSES_CARDS:"block_myoverview/view-cards",COURSES_LIST:"block_myoverview/view-list",COURSES_SUMMARY:"block_myoverview/view-summary",NOCOURSES:"core_course/no-courses"},m={GROUPING_ALLINCLUDINGHIDDEN:"allincludinghidden",GROUPING_ALL:"all",GROUPING_INPROGRESS:"inprogress",GROUPING_FUTURE:"future",GROUPING_PAST:"past",GROUPING_FAVOURITES:"favourites",GROUPING_HIDDEN:"hidden"},n=[12,24,48,96,0],o=[],p=0,q=0,r=0,s=null,t=function(a){var b=a.find(i.courseView.region);return{display:b.attr("data-display"),grouping:b.attr("data-grouping"),sort:b.attr("data-sort"),displaycategories:b.attr("data-displaycategories"),customfieldname:b.attr("data-customfieldname"),customfieldvalue:b.attr("data-customfieldvalue")}},u={ignoreControlWhileLoading:!0,controlPlacementBottom:!0,persistentLimitKey:"block_myoverview_user_paging_preference"},v=function(a,c){return b.getEnrolledCoursesByTimeline({offset:p,limit:c,classification:a.grouping,sort:a.sort,customfieldname:a.customfieldname,customfieldvalue:a.customfieldvalue})},w=function(a,b){return a.find(k.FAVOURITE_ICON+"[data-course-id=\""+b+"\"]")},x=function(a,b){return a.find("[data-region=\"paged-content-page\"][data-page=\""+b+"\"]")},y=function(a){return a.attr("data-course-id")},z=function(a,b){var c=w(a,b),d=c.find(k.ICON_IS_FAVOURITE);d.addClass("hidden");d.attr("aria-hidden",!0);var e=c.find(k.ICON_NOT_FAVOURITE);e.removeClass("hidden");e.attr("aria-hidden",!1)},A=function(a,b){var c=w(a,b),d=c.find(k.ICON_IS_FAVOURITE);d.removeClass("hidden");d.attr("aria-hidden",!1);var e=c.find(k.ICON_NOT_FAVOURITE);e.addClass("hidden");e.attr("aria-hidden",!0)},B=function(a,b){return a.find("[data-action=\"add-favourite\"][data-course-id=\""+b+"\"]")},C=function(a,b){return a.find("[data-action=\"remove-favourite\"][data-course-id=\""+b+"\"]")},D=function(a,b){var c=C(a,b),e=B(a,b);L(b,!0).then(function(g){if(g){d.publish(h.favourited,b);c.removeClass("hidden");e.addClass("hidden");A(a,b)}else{f.alert("Starring course failed","Could not change favourite state")}}).catch(f.exception)},E=function(a,b){var c=C(a,b),e=B(a,b);L(b,!1).then(function(g){if(g){d.publish(h.unfavorited,b);c.addClass("hidden");e.removeClass("hidden");z(a,b)}else{f.alert("Starring course failed","Could not change favourite state")}}).catch(f.exception)},F=function(a,b){return a.find("[data-action=\"hide-course\"][data-course-id=\""+b+"\"]")},G=function(a,b){return a.find("[data-action=\"show-course\"][data-course-id=\""+b+"\"]")},H=function(a,b){var c=F(a,b),d=G(a,b),e=t(a);J(b,!0);if(e.grouping!=m.GROUPING_ALLINCLUDINGHIDDEN){K(a,b)}c.addClass("hidden");d.removeClass("hidden")},I=function(a,b){var c=F(a,b),d=G(a,b),e=t(a);J(b,null);if(e.grouping!=m.GROUPING_ALLINCLUDINGHIDDEN){K(a,b)}c.removeClass("hidden");d.addClass("hidden")},J=function(a,c){if(!1===c){c=null}return b.updateUserPreferences({preferences:[{type:"block_myoverview_hidden_course_"+a,value:c}]})},K=function(b,d){var e=b.find("[data-region=\"paging-bar\"]"),h=parseInt(e.attr("data-active-page-number")),i=o[h],j=i.courses.reduce(function(a,b){if(d!=b.id){a.push(b)}return a},[]);if(o[h+1]!=void 0){var k=o[h+1].courses.slice(0,1);o.forEach(function(b,c){if(c>h){var d=[];if(o[c+1]!=void 0){d=o[c+1].courses.slice(0,1)}o[c].courses=a.merge(o[c].courses.slice(1),d)}});j=a.merge(j,k)}if(q==h+1&&0==o[h+1].courses.length){var l=b.find("[data-region=\"paged-content-container\"]");c.resetLastPageNumber(a(l).attr("id"),h)}o[h].courses=j;p--;var m=x(b,h);M(b,o[h]).then(function(a,b){return g.replaceNodeContents(m,a,b)}).catch(f.exception);o.forEach(function(a,c){if(c>h){var d=x(b,c);d.remove()}})},L=function(a,c){return b.setFavouriteCourses({courses:[{id:a,favourite:c}]}).then(function(b){if(0==b.warnings.length){o.forEach(function(b){b.courses.forEach(function(d,e){if(d.id==a){b.courses[e].isfavourite=c}})});return!0}else{return!1}}).catch(f.exception)},M=function(a,b){var c=t(a),d="";if("card"==c.display){d=l.COURSES_CARDS}else if("list"==c.display){d=l.COURSES_LIST}else{d=l.COURSES_SUMMARY}b.courses=b.courses.map(function(a){a.showcoursecategory="on"==c.displaycategories?!0:!1;return a});if(b.courses.length){return g.render(d,{courses:b.courses})}else{var e=a.find(i.courseView.region).attr("data-nocoursesimg");return g.render(l.NOCOURSES,{nocoursesimg:e})}},N=function(a){this.find(i.courseView.region).attr("data-paging",a)},O=function(a,b){var c=b+j.SET_ITEMS_PER_PAGE_LIMIT;d.subscribe(c,N.bind(a))},P=function(b){s="block_myoverview_"+b.attr("id")+"_"+Math.random();var d=parseInt(b.find(i.courseView.region).attr("data-paging"),10),e=n.map(function(a){var b=!1;if(a==d){b=!0}return{value:a,active:b}}),h=parseInt(b.find(i.courseView.region).attr("data-totalcoursecount"),10);e=e.filter(function(a){return a.value<h||0===a.value});var j=t(b),k=a.extend({},u);k.eventNamespace=s;var l=c.createWithLimit(e,function(c,d){var e=[];c.forEach(function(c){var g=c.pageNumber,h=0<c.limit?c.limit:0;if(r!=h){o=[];p=0;q=0}if(q==g){d.allItemsLoaded(q);e.push(M(b,o[g]));return}r=h;if(o[g+1]==void 0){if(o[g]==void 0){h*=2}}var i=v(j,h).then(function(e){var f=e.courses,h=0,i=[];if(o[g]!=void 0){i=o[g].courses;var j=i.length;if(j<c.limit){h=c.limit-j;i=a.merge(o[g].courses,f.slice(0,h))}}else{h=c.limit||!1;i=0<c.limit?f.slice(0,c.limit):f}o[g]={courses:i};var k=!1!==h?f.slice(h,f.length):[];if(k.length){o[g+1]={courses:k}}if(o[g].courses.length<c.limit||!k.length){q=g;d.allItemsLoaded(g)}else if(o[g+1]!=void 0&&o[g+1].courses.length<c.limit){q=g+1}p=e.nextoffset;return M(b,o[g])}).catch(f.exception);e.push(i)});return e},k);l.then(function(a,c){O(b,s);return g.replaceNodeContents(b.find(i.courseView.region),a,c)}).catch(f.exception)},Q=function(b){e.define(b,[e.events.activate]);b.on(e.events.activate,k.ACTION_ADD_FAVOURITE,function(c,d){var e=a(c.target).closest(k.ACTION_ADD_FAVOURITE),f=y(e);D(b,f);d.originalEvent.preventDefault()});b.on(e.events.activate,k.ACTION_REMOVE_FAVOURITE,function(c,d){var e=a(c.target).closest(k.ACTION_REMOVE_FAVOURITE),f=y(e);E(b,f);d.originalEvent.preventDefault()});b.on(e.events.activate,k.FAVOURITE_ICON,function(a,b){b.originalEvent.preventDefault()});b.on(e.events.activate,k.ACTION_HIDE_COURSE,function(c,d){var e=a(c.target).closest(k.ACTION_HIDE_COURSE),f=y(e);H(b,f);d.originalEvent.preventDefault()});b.on(e.events.activate,k.ACTION_SHOW_COURSE,function(c,d){var e=a(c.target).closest(k.ACTION_SHOW_COURSE),f=y(e);I(b,f);d.originalEvent.preventDefault()})},R=function(b){b=a(b);o=[];q=0;p=0;P(b);if(!b.attr("data-init")){Q(b);b.attr("data-init",!0)}},S=function(a){if(0<o.length){o.forEach(function(b,c){var d=x(a,c);M(a,b).then(function(a,b){return g.replaceNodeContents(d,a,b)}).catch(f.exception)})}else{R(a)}};return{init:R,reset:S}});
define ("block_myoverview/view_nav",["jquery","core/custom_interaction_events","block_myoverview/repository","block_myoverview/view","block_myoverview/selectors"],function(a,b,c,d,f){var g={FILTERS:"[data-region=\"filter\"]",FILTER_OPTION:"[data-filter]",DISPLAY_OPTION:"[data-display-option]"},h=function(a,b){var d=null;if("display"==a){d="block_myoverview_user_view_preference"}else if("sort"==a){d="block_myoverview_user_sort_preference"}else if("customfieldvalue"==a){d="block_myoverview_user_grouping_customfieldvalue_preference"}else{d="block_myoverview_user_grouping_preference"}c.updateUserPreferences({preferences:[{type:d,value:b}]})},i=function(c){var e=c.find(g.FILTERS);b.define(e,[b.events.activate]);e.on(b.events.activate,g.FILTER_OPTION,function(b,e){var g=a(b.target);if(g.hasClass("active")){return}var i=g.attr("data-filter"),j=g.attr("data-pref"),k=g.attr("data-customfieldvalue");c.find(f.courseView.region).attr("data-"+i,g.attr("data-value"));h(i,j);if(k){c.find(f.courseView.region).attr("data-customfieldvalue",k);h("customfieldvalue",k)}d.init(c);e.originalEvent.preventDefault()});b.define(e,[b.events.activate]);e.on(b.events.activate,g.DISPLAY_OPTION,function(b,e){var g=a(b.target);if(g.hasClass("active")){return}var i=g.attr("data-display-option"),j=g.attr("data-pref");c.find(f.courseView.region).attr("data-display",g.attr("data-value"));h(i,j);d.reset(c);e.originalEvent.preventDefault()})};return{init:function init(b){b=a(b);i(b)}}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("block_navigation/ajax_response_renderer",["jquery","core/templates","core/notification","core/url"],function(a,b,c,d){var f={ACTIVITY:40,RESOURCE:50};function e(g,h){var i=a("<ul></ul>");i.attr("role","group");i.attr("aria-hidden",!0);a.each(h,function(g,h){if("object"!==_typeof(h)){return}var j=a("<li></li>"),k=a("<p></p>"),l=h.id||h.key+"_tree_item",m=null,n=h.expandable||h.haschildren?!0:!1;k.addClass("tree_item");k.attr("id",l);k.attr("role","treeitem");k.attr("tabindex","-1");if(h.requiresajaxloading){k.attr("data-requires-ajax",!0);k.attr("data-node-id",h.id);k.attr("data-node-key",h.key);k.attr("data-node-type",h.type)}if(n){j.addClass("collapsed contains_branch");k.attr("aria-expanded",!1);k.addClass("branch")}var o=null;if(h.link){var p=a("<a title=\""+h.title+"\" href=\""+h.link+"\"></a>");o=p;p.append("<span class=\"item-content-wrap\">"+h.name+"</span>");if(h.hidden){p.addClass("dimmed")}k.append(p)}else{var q=a("<span></span>");o=q;q.append("<span class=\"item-content-wrap\">"+h.name+"</span>");if(h.hidden){q.addClass("dimmed")}k.append(q)}if(h.icon&&(!n||h.type===f.ACTIVITY||h.type===f.RESOURCE)){j.addClass("item_with_icon");k.addClass("hasicon");if(h.type===f.ACTIVITY||h.type===f.RESOURCE){m=a("<img/>");m.attr("alt",h.icon.alt);m.attr("title",h.icon.title);m.attr("src",d.imageUrl(h.icon.pix,h.icon.component));a.each(h.icon.classes,function(a,b){m.addClass(b)});o.prepend(m)}else{if("moodle"==h.icon.component){h.icon.component="core"}b.renderPix(h.icon.pix,h.icon.component,h.icon.title).then(function(a){o.prepend(a)}).catch(c.exception)}}j.append(k);i.append(j);if(h.children&&h.children.length){e(k,h.children)}else if(n&&!h.requiresajaxloading){j.removeClass("contains_branch");k.addClass("emptybranch")}});g.parent().append(i);var j=g.attr("id")+"_group";i.attr("id",j);g.attr("aria-owns",j);g.attr("role","treeitem")}return{render:function render(a,b){if(b.children&&b.children.length){e(a,b.children);var c=a.children("[role='treeitem']").first(),d=a.find("#"+c.attr("aria-owns"));c.attr("aria-expanded",!0);d.attr("aria-hidden",!1)}else{if(a.parent().hasClass("contains_branch")){a.parent().removeClass("contains_branch");a.addClass("emptybranch")}}}}});
define ("block_navigation/nav_loader",["jquery","core/ajax","core/config","block_navigation/ajax_response_renderer"],function(a,b,c,d){var f=c.wwwroot+"/lib/ajax/getnavbranch.php";function e(a){return a.closest("[data-block]").attr("data-instanceid")}return{load:function load(b){b=a(b);var g=a.Deferred(),h={elementid:b.attr("data-node-id"),id:b.attr("data-node-key"),type:b.attr("data-node-type"),sesskey:c.sesskey,instance:e(b)};a.ajax(f,{type:"POST",dataType:"json",data:h}).done(function(a){d.render(b,a);g.resolve()});return g}}});
define ("block_navigation/navblock",["jquery","core/tree"],function(a,b){return{init:function init(a){var c=new b(".block_navigation .block_tree");c.finishExpandingGroup=function(c){b.prototype.finishExpandingGroup.call(this,c);Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})};c.collapseGroup=function(c){b.prototype.collapseGroup.call(this,c);Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})}}}});
define ("block_navigation/site_admin_loader",["jquery","core/ajax","core/config","block_navigation/ajax_response_renderer"],function(a,b,c,d){var e=c.wwwroot+"/lib/ajax/getsiteadminbranch.php";return{load:function load(b){b=a(b);var f=a.Deferred(),g={type:71,sesskey:c.sesskey};a.ajax(e,{type:"POST",dataType:"json",data:g}).done(function(a){d.render(b,a);f.resolve()});return f}}});
define ("block_online_users/change_user_visibility",["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){var e={CHANGE_VISIBILITY_LINK:"#change-user-visibility",CHANGE_VISIBILITY_ICON:"#change-user-visibility .icon"},f=function(a,c){var e="show"==a?1:0;b.call([{methodname:"core_user_set_user_preferences",args:{preferences:[{name:"block_online_users_uservisibility",value:e,userid:c}]}}])[0].then(function(b){if(b.saved){var c=g(a);h(c);i(c)}}).catch(d.exception)},g=function(a){return"show"==a?"hide":"show"},h=function(b){k(b).then(function(c){a(e.CHANGE_VISIBILITY_LINK).attr({"data-action":b,title:c})}).catch(d.exception)},i=function(b){var c=a(e.CHANGE_VISIBILITY_ICON);k(b).then(function(d){a(c).attr({title:d,"aria-label":d});if(c.is("img")){a(c).attr({src:M.util.image_url("t/"+b),alt:d})}else{a(c).addClass(j(b));a(c).removeClass(j(g(b)))}}).catch(d.exception)},j=function(a){return"show"==a?"fa-eye-slash":"fa-eye"},k=function(a){return c.get_string("online_status:"+a,"block_online_users")};return{init:function init(){a(e.CHANGE_VISIBILITY_LINK).on("click",function(b){b.preventDefault();var c=a(this).attr("data-action"),d=a(this).attr("data-userid");f(c,d)})}}});
define ("block_recentlyaccessedcourses/main",["jquery","core/custom_interaction_events","core/notification","core/pubsub","core/paged_content_paging_bar","core/templates","core_course/events","core_course/repository"],function(a,b,c,d,e,f,g,h){var i={BLOCK_CONTAINER:"[data-region=\"recentlyaccessedcourses\"]",CARD_CONTAINER:"[data-region=\"card-deck\"]",COURSE_IS_FAVOURITE:"[data-region=\"is-favourite\"]",CONTENT:"[data-region=\"view-content\"]",EMPTY_MESSAGE:"[data-region=\"empty-message\"]",LOADING_PLACEHOLDER:"[data-region=\"loading-placeholder\"]",PAGING_BAR:"[data-region=\"paging-bar\"]",PAGING_BAR_NEXT:"[data-control=\"next\"]",PAGING_BAR_PREVIOUS:"[data-control=\"previous\"]"},j=!1,k=[],l=null,m=null,n=0,o=1,p=function(a){a.find(i.EMPTY_MESSAGE).removeClass("hidden");a.find(i.LOADING_PLACEHOLDER).addClass("hidden");a.find(i.CONTENT).addClass("hidden")},q=function(a){a.find(i.CONTENT).removeClass("hidden");a.find(i.EMPTY_MESSAGE).addClass("hidden");a.find(i.LOADING_PLACEHOLDER).addClass("hidden")},r=function(a){var b=a.find(i.PAGING_BAR);b.css("opacity",1);b.css("visibility","visible");b.attr("aria-hidden","false")},s=function(a){var b=a.find(i.PAGING_BAR);b.css("opacity",0);b.css("visibility","hidden");b.attr("aria-hidden","true")},t=function(a,b){k.forEach(function(a){if(a.attr("data-course-id")==b){a.find(i.COURSE_IS_FAVOURITE).removeClass("hidden")}})},u=function(a,b){k.forEach(function(a){if(a.attr("data-course-id")==b){a.find(i.COURSE_IS_FAVOURITE).addClass("hidden")}})},v=function(b){var d=a(i.BLOCK_CONTAINER).data("displaycoursecategory"),e=b.map(function(a){a.showcoursecategory=d;return f.render("block_recentlyaccessedcourses/course-card",a)});return a.when.apply(null,e).then(function(){var b=[];e.forEach(function(d){d.then(function(c){b.push(a(c))}).catch(c.exception)});return b})},w=function(a){return h.getLastAccessedCourses(a,10).then(function(a){return v(a)})},x=function(a){var b=a.find(i.CONTENT).find(i.CARD_CONTAINER),c=parseFloat(a.css("width")),d=k.length,f=0;if(!m){b.html(k[0]);m=k[0].outerWidth(!0)}o=Math.floor(c/m);if(n+o<d){f=n}else{var g=n+o-d;f=n-g;f=0<=f?f:0}if(0===o){o=1}var h=k.slice(f,f+o),j=h.reduce(function(a,b){return a+b.attr("data-course-id")},"");if(k.length>h.length){b.addClass("justify-content-center");b.removeClass("justify-content-start")}else{b.removeClass("justify-content-center");b.addClass("justify-content-start")}if(l!=j){var p=a.find(e.rootSelector);b.html(h);l=j;if(o>=k.length){s(a)}else{r(a);if(0===n){e.disablePreviousControlButtons(p)}else{e.enablePreviousControlButtons(p)}if(n+o>=k.length){e.disableNextControlButtons(p)}else{e.enableNextControlButtons(p)}}}},y=function(c){var e=null,f=!1;d.subscribe(g.favourited,function(a){t(c,a)});d.subscribe(g.unfavorited,function(a){u(c,a)});d.subscribe("nav-drawer-toggle-start",function(){if(!j||!k.length||f){return}f=!0;var a=0,b=function(){setTimeout(function(){x(c);a++;if(5>a&&f){b()}},100)};b(c)});d.subscribe("nav-drawer-toggle-end",function(){f=!1});a(window).on("resize",function(){if(!j||!k.length){return}if(!e){e=setTimeout(function(){e=null;x(c)},66)}});b.define(c,[b.events.activate]);c.on(b.events.activate,i.PAGING_BAR_NEXT,function(b,d){var e=a(b.target).closest(i.PAGING_BAR_NEXT);if(!e.hasClass("disabled")){n=n+o;x(c)}d.originalEvent.preventDefault()});c.on(b.events.activate,i.PAGING_BAR_PREVIOUS,function(b,d){var e=a(b.target).closest(i.PAGING_BAR_PREVIOUS);if(!e.hasClass("disabled")){n=n-o;n=0>n?0:n;x(c)}d.originalEvent.preventDefault()})};return{init:function init(b,d){d=a(d);y(d);w(b).then(function(a){k=a;j=!0;if(k.length){q(d);x(d)}else{p(d)}}).catch(c.exception)}}});
define ("block_recentlyaccesseditems/main",["jquery","block_recentlyaccesseditems/repository","core/templates","core/notification"],function(a,b,c,d){var e={CARDDECK_CONTAINER:"[data-region=\"recentlyaccesseditems-view\"]",CARDDECK:"[data-region=\"recentlyaccesseditems-view-content\"]"},f=function(a){return b.getRecentItems(a)},g=function(a,b){if(0<b.length){return c.render("block_recentlyaccesseditems/view-cards",{items:b})}else{var d=a.attr("data-noitemsimgurl");return c.render("block_recentlyaccesseditems/no-items",{noitemsimgurl:d})}};return{init:function init(b){b=a(b);var h=b.find(e.CARDDECK_CONTAINER),i=b.find(e.CARDDECK),j=f(9);j.then(function(a){var b=g(h,a);b.then(function(a,b){return c.replaceNodeContents(i,a,b)}).catch(d.exception);return j}).catch(d.exception)}}});
define ("block_recentlyaccesseditems/repository",["core/ajax"],function(a){return{getRecentItems:function getRecentItems(b){var c={};if("undefined"!=typeof b){c.limit=b}return a.call([{methodname:"block_recentlyaccesseditems_get_recent_items",args:c}])[0]}}});
define ("block_settings/settingsblock",["jquery","core/tree"],function(a,b){return{init:function init(a,c){var d=new b(".block_settings .block_tree");if(c){var e=d.treeRoot.find("#"+c),f=e.children("a").first();f.replaceWith("<span tabindex=\"0\">"+f.html()+"</span>")}d.finishExpandingGroup=function(c){b.prototype.finishExpandingGroup.call(this,c);Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})};d.collapseGroup=function(c){b.prototype.collapseGroup.call(this,c);Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})}}}});
define ("block_starredcourses/main",["jquery","core/notification","block_starredcourses/repository","core/pubsub","core/templates","core_course/events"],function(a,b,c,d,e,f){var g={BLOCK_CONTAINER:"[data-region=\"starred-courses\"]",STARRED_COURSES_REGION_VIEW:"[data-region=\"starred-courses-view\"]",STARRED_COURSES_REGION:"[data-region=\"starred-courses-view-content\"]"},h=function(a,b){if(0<b.length){return e.render("core_course/view-cards",{courses:b})}else{var c=a.find(g.STARRED_COURSES_REGION_VIEW).attr("data-nocoursesimg");return e.render("block_starredcourses/no-courses",{nocoursesimg:c})}},i=function(d){var f=d.find(g.STARRED_COURSES_REGION);return c.getStarredCourses({limit:0,offset:0}).then(function(b){var c=a(g.BLOCK_CONTAINER).data("displaycoursecategory");b=b.map(function(a){a.showcoursecategory=c;return a});return h(d,b)}).then(function(a,b){return e.replaceNodeContents(f,a,b)}).catch(b.exception)},j=function(a){d.subscribe(f.favourited,function(){i(a)});d.subscribe(f.unfavorited,function(){i(a)})};return{init:function init(b){b=a(b);j(b);i(b)}}});
define ("block_starredcourses/repository",["jquery","core/ajax","core/notification"],function(a,b,c){return{getStarredCourses:function getStarredCourses(a){var d=b.call([{methodname:"block_starredcourses_get_starred_courses",args:a}])[0];d.fail(c.exception);return d}}});
define ("block_timeline/calendar_events_repository",["jquery","core/ajax","core/notification"],function(a,b,c){return{queryByTime:function queryByTime(a){if(!a.hasOwnProperty("limit")){a.limit=20}a.limitnum=a.limit;delete a.limit;if(a.hasOwnProperty("starttime")){a.timesortfrom=a.starttime;delete a.starttime}if(a.hasOwnProperty("endtime")){a.timesortto=a.endtime;delete a.endtime}a.limittononsuspendedevents=!0;var d=b.call([{methodname:"core_calendar_get_action_events_by_timesort",args:a}])[0];d.fail(c.exception);return d},queryByCourse:function queryByCourse(a){if(!a.hasOwnProperty("limit")){a.limit=20}a.limitnum=a.limit;delete a.limit;if(a.hasOwnProperty("starttime")){a.timesortfrom=a.starttime;delete a.starttime}if(a.hasOwnProperty("endtime")){a.timesortto=a.endtime;delete a.endtime}var d=b.call([{methodname:"core_calendar_get_action_events_by_course",args:a}])[0];d.fail(c.exception);return d},queryByCourses:function queryByCourses(a){if(!a.hasOwnProperty("limit")){a.limit=10}a.limitnum=a.limit;delete a.limit;if(a.hasOwnProperty("starttime")){a.timesortfrom=a.starttime;delete a.starttime}if(a.hasOwnProperty("endtime")){a.timesortto=a.endtime;delete a.endtime}var d=b.call([{methodname:"core_calendar_get_action_events_by_courses",args:a}])[0];d.fail(c.exception);return d}}});
define ("block_timeline/event_list",["jquery","core/notification","core/templates","core/paged_content_factory","core/str","core/user_date","block_timeline/calendar_events_repository"],function(a,b,c,d,e,f,g){var h={EMPTY_MESSAGE:"[data-region=\"empty-message\"]",ROOT:"[data-region=\"event-list-container\"]",EVENT_LIST_CONTENT:"[data-region=\"event-list-content\"]",EVENT_LIST_LOADING_PLACEHOLDER:"[data-region=\"event-list-loading-placeholder\"]"},i={EVENT_LIST_CONTENT:"block_timeline/event-list-content"},j={ignoreControlWhileLoading:!0,controlPlacementBottom:!0,ariaLabels:{itemsperpagecomponents:"ariaeventlistpagelimit, block_timeline"}},k=function(a){a.find(h.EVENT_LIST_CONTENT).addClass("hidden");a.find(h.EMPTY_MESSAGE).removeClass("hidden")},l=function(a){a.find(h.EVENT_LIST_CONTENT).removeClass("hidden");a.find(h.EMPTY_MESSAGE).addClass("hidden")},m=function(a){a.find(h.EVENT_LIST_CONTENT).empty()},n=function(a,b){var c={},d={eventsbyday:[]};a.forEach(function(a){var d=f.getUserMidnightForTimestamp(a.timesort,b);if(c[d]){c[d].push(a)}else{c[d]=[a]}});Object.keys(c).forEach(function(a){var e=c[a];d.eventsbyday.push({past:a<b,dayTimestamp:a,events:e})});return d},o=function(a,b){var d=n(a,b),e=i.EVENT_LIST_CONTENT;return c.render(e,d)},p=function(a,b,c,d,e,f){var h=d!=void 0?a+d*86400:!1,i={starttime:a+c*86400,limit:b};if(e){i.aftereventid=e}if(h){i.endtime=h}if(f){i.courseid=f;return g.queryByCourse(i)}else{return g.queryByTime(i)}},q=function(a,b,c,d,e,g,h,i){var j=a.pageNumber,k=a.limit,l=j;while(!d.hasOwnProperty(l)){l--}var m=d[l],n=null;if(e&&e.hasOwnProperty(j)){n=e[j]}else{n=p(c,k+1,h,i,m,g)}return n.then(function(a){if(!a.events.length){b.allItemsLoaded(j);return[]}var d=a.events.filter(function(a){if("open"==a.eventtype||"opensubmission"==a.eventtype){var b=f.getUserMidnightForTimestamp(a.timesort,c);return b>c}return!0}),e=d.length<=k;if(e){b.allItemsLoaded(j)}else{d.pop()}return d})},r=function(c,f,g,h,i,k,l,m,n){var p={1:0},r=!1,s=a.extend({},j,n);return e.get_string("ariaeventlistpagelimit","block_timeline",a.isArray(c)?c[0].value:c).then(function(a){s.ariaLabels.itemsperpage=a;s.ariaLabels.paginationnav=m;return a}).then(function(){return d.createWithLimit(c,function(c,d){var e=[];c.forEach(function(a){var c=a.pageNumber,h=q(a,d,g,p,f,i,k,l).then(function(a){if(a.length){r=!0;var b=a[a.length-1].id;p[c+1]=b;return o(a,g)}else{return a}}).catch(b.exception);e.push(h)});a.when.apply(a,e).then(function(){h.resolve(r)}).catch(function(){h.resolve(r)});return e},s)})};return{init:function init(d,e,f,g,i){d=a(d);var j=a.Deferred(),n=d.find(h.EVENT_LIST_CONTENT),o=d.find(h.EVENT_LIST_LOADING_PLACEHOLDER),p=d.attr("data-course-id"),q=parseInt(d.attr("data-days-offset"),10),s=d.attr("data-days-limit"),t=parseInt(d.attr("data-midnight"),10);m(d);l(d);o.removeClass("hidden");if(s!=void 0){s=parseInt(s,10)}return r(e,f,t,j,p,q,s,g,i).then(function(b,e){b=a(b);b.addClass("hidden");c.replaceNodeContents(n,b,e);j.then(function(a){b.removeClass("hidden");o.addClass("hidden");if(!a){k(d)}return a}).catch(function(){return!1});return b}).catch(b.exception)},rootSelector:h.ROOT}});
define ("block_timeline/main",["jquery","block_timeline/view_nav","block_timeline/view"],function(a,b,c){var d={TIMELINE_VIEW:"[data-region=\"timeline-view\"]"};return{init:function init(e){e=a(e);var f=e.find(d.TIMELINE_VIEW);b.init(e,f);c.init(f)}}});
define ("block_timeline/view",["jquery","block_timeline/view_dates","block_timeline/view_courses"],function(a,b,c){var d={TIMELINE_DATES_VIEW:"[data-region=\"view-dates\"]",TIMELINE_COURSES_VIEW:"[data-region=\"view-courses\"]"};return{init:function init(e){e=a(e);var f=e.find(d.TIMELINE_DATES_VIEW),g=e.find(d.TIMELINE_COURSES_VIEW);b.init(f);c.init(g)},reset:function reset(a){var e=a.find(d.TIMELINE_DATES_VIEW),f=a.find(d.TIMELINE_COURSES_VIEW);b.reset(e);c.reset(f)},shown:function shown(a){var e=a.find(d.TIMELINE_DATES_VIEW),f=a.find(d.TIMELINE_COURSES_VIEW);if(e.hasClass("active")){b.shown(e)}else{c.shown(f)}}}});
define ("block_timeline/view_courses",["jquery","core/notification","core/custom_interaction_events","core/str","core/templates","block_timeline/event_list","core_course/repository","block_timeline/calendar_events_repository"],function(a,b,c,d,e,f,g,h){var i={MORE_COURSES_BUTTON:"[data-action=\"more-courses\"]",MORE_COURSES_BUTTON_CONTAINER:"[data-region=\"more-courses-button-container\"]",NO_COURSES_EMPTY_MESSAGE:"[data-region=\"no-courses-empty-message\"]",COURSES_LIST:"[data-region=\"courses-list\"]",COURSE_ITEMS_LOADING_PLACEHOLDER:"[data-region=\"course-items-loading-placeholder\"]",COURSE_EVENTS_CONTAINER:"[data-region=\"course-events-container\"]",COURSE_NAME:"[data-region=\"course-name\"]",LOADING_ICON:".loading-icon"},j={COURSE_ITEMS:"block_timeline/course-items",LOADING_ICON:"core/loading"},k=5,l=86400,m=function(a){a.find(i.COURSE_ITEMS_LOADING_PLACEHOLDER).addClass("hidden")},n=function(a){a.find(i.MORE_COURSES_BUTTON_CONTAINER).addClass("hidden")},o=function(a){a.find(i.MORE_COURSES_BUTTON_CONTAINER).removeClass("hidden")},p=function(a){var b=a.find(i.MORE_COURSES_BUTTON);b.prop("disabled",!0);e.render(j.LOADING_ICON,{}).then(function(a){b.append(a);return a}).catch(function(){return!1})},q=function(a){var b=a.find(i.MORE_COURSES_BUTTON);b.prop("disabled",!1);b.find(i.LOADING_ICON).remove()},r=function(a){a.find(i.NO_COURSES_EMPTY_MESSAGE).removeClass("hidden")},s=function(a,b){var c=a.find(i.COURSES_LIST);e.appendNodeContents(c,b,"")},t=function(a){return 0<a.find(i.COURSE_EVENTS_CONTAINER).length},u=function(a){return parseInt(a.attr("data-offset"),10)},v=function(a,b){a.attr("data-offset",b)},w=function(a){return parseInt(a.attr("data-limit"),10)},x=function(a){return parseInt(a.attr("data-days-offset"),10)},y=function(a){var b=a.attr("data-days-limit");return b!=void 0?parseInt(b,10):void 0},z=function(a){return parseInt(a.attr("data-midnight"),10)},A=function(a){var b=z(a),c=x(a);return b+c*l},B=function(a){var b=z(a),c=y(a);return c!=void 0?b+c*l:!1},C=function(a,b,c,d){var e={courseids:a,starttime:b,limit:c};if(d){e.endtime=d}return h.queryByCourses(e)},D=function(a){return a.data("last-event-load-time")},E=function(a,b){a.data("last-event-load-time",b)},F=function(a,b){return D(a)>b},G=function(a,b,c){var d=a.map(function(a){return a.id});return C(d,b,k+1,c)},H=function(a,b,c,d,f,g){return e.render(j.COURSE_ITEMS,{courses:a,midnight:c,hasdaysoffset:!0,hasdayslimit:f!=void 0,daysoffset:d,dayslimit:f,nodayslimit:f==void 0,urls:{noevents:g}}).then(function(a){m(b);if(a){s(b,a)}else{if(!t(b)){r(b)}}return a}).then(function(c){if(a.length<2){n(b)}else{o(b)}return c}).catch(function(){m(b)})},I=function(c){var e=u(c),h=w(c);return g.getEnrolledCoursesByTimelineClassification("inprogress",h,e,"fullname asc").then(function(b){var e=Date.now(),g=b.courses,h=b.nextoffset,i=x(c),j=y(c),l=z(c),m=A(c),n=B(c),o=c.attr("data-no-events-url");v(c,h);var p=G(g,m,n),q=H(g,c,l,i,j,o);return a.when(p,q).then(function(b){if(F(c,e)){return b}g.forEach(function(e){var g=e.id,h=[],i=c.find("[data-region=\"course-events-container\"][data-course-id=\""+g+"\"]"),j=i.find(f.rootSelector),l=b.groupedbycourse.filter(function(a){return a.courseid==g});if(l.length){h=l[0].events}var m=a.Deferred().resolve({events:h}).promise();d.get_string("ariaeventlistpaginationnavcourses","block_timeline",e.fullnamedisplay).then(function(a){f.init(j,k,{1:m},a);return a}).catch(function(){f.init(j,k,{1:m})})});return b})}).catch(b.exception)},J=function(c){var e=Date.now(),g=A(c),h=B(c),j=c.find(i.COURSE_EVENTS_CONTAINER),l=j.map(function(){return a(this).attr("data-course-id")}).get();E(c,e);return C(l,g,k+1,h).then(function(b){if(F(c,e)){return b}j.each(function(c,e){e=a(e);var g=e.attr("data-course-id"),h=e.find(i.COURSE_NAME).text(),j=e.find(f.rootSelector),l=a.Deferred(),m=[],n=b.groupedbycourse.filter(function(a){return a.courseid==g});if(n.length){m=n[0].events}l.resolve({events:m});d.get_string("ariaeventlistpaginationnavcourses","block_timeline",h).then(function(a){f.init(j,k,{1:l.promise()},a);return a}).catch(function(){f.init(j,k,{1:l.promise()})})});return b}).catch(b.exception)},K=function(a){c.define(a,[c.events.activate]);a.on(c.events.activate,i.MORE_COURSES_BUTTON,function(b,c){p(a);I(a).then(function(){q(a)}).catch(function(){q(a)});if(c){c.originalEvent.preventDefault();c.originalEvent.stopPropagation()}b.stopPropagation()})},L=function(a){if(!a.attr("data-seen")){if(t(a)){J(a)}else{I(a)}a.attr("data-seen",!0)}};return{init:function init(b){b=a(b);E(b,Date.now());if(b.hasClass("active")){I(b);b.attr("data-seen",!0)}K(b)},reset:function reset(a){a.removeAttr("data-seen");if(a.hasClass("active")){L(a)}},shown:L}});
define ("block_timeline/view_dates",["jquery","core/str","block_timeline/event_list","core/pubsub","core/paged_content_events"],function(a,b,c,d,e){var f={EVENT_LIST_CONTAINER:"[data-region=\"event-list-container\"]"},g=[5,10,25],h=function(a){var b=parseInt(a.data("limit"),10),c=!1,d=g.map(function(a){if(b==a){c=!0}return{value:a,active:b==a}});if(!c){d[0].active=!0}return d},i=function(b,c){var f=c+e.SET_ITEMS_PER_PAGE_LIMIT;d.subscribe(f,function(c){a(b).data("limit",c)})},j=function(d){var e=d.find(f.EVENT_LIST_CONTAINER),g=a(e).attr("id")+"user_block_timeline"+Math.random();i(d,g);var j=h(d),k={persistentLimitKey:"block_timeline_user_limit_preference",eventNamespace:g};b.get_string("ariaeventlistpaginationnavdates","block_timeline").then(function(a){c.init(e,j,{},a,k);return a}).catch(function(){c.init(e,j,{},"",k)})};return{init:function init(b){b=a(b);if(b.hasClass("active")){j(b);b.data("seen",!0)}},reset:function reset(a){a.removeAttr("data-seen");if(a.hasClass("active")){j(a);a.data("seen",!0)}},shown:function shown(a){if(!a.data("seen")){j(a);a.data("seen",!0)}}}});
define ("block_timeline/view_nav",["jquery","core/custom_interaction_events","block_timeline/view","core/ajax","core/notification"],function(a,b,c,d,e){var f={TIMELINE_DAY_FILTER:"[data-region=\"day-filter\"]",TIMELINE_DAY_FILTER_OPTION:"[data-from]",TIMELINE_VIEW_SELECTOR:"[data-region=\"view-selector\"]",DATA_DAYS_OFFSET:"[data-days-offset]",DATA_DAYS_LIMIT:"[data-days-limit]"},g=function(a,b){d.call([{methodname:"core_user_update_user_preferences",args:{preferences:[{type:a,value:b}]}}])[0].fail(e.exception)},h=function(d,h){var i=d.find(f.TIMELINE_DAY_FILTER);b.define(i,[b.events.activate]);i.on(b.events.activate,f.TIMELINE_DAY_FILTER_OPTION,function(b,e){var i=a(b.currentTarget).data("filtername");g("block_timeline_user_filter_preference",i);var j=a(b.target).closest(f.TIMELINE_DAY_FILTER_OPTION);if("true"==j.attr("aria-current")){return}var k=j.attr("data-from"),l=j.attr("data-to"),m=d.find(f.DATA_DAYS_OFFSET);m.attr("data-days-offset",k);if(l!=void 0){m.attr("data-days-limit",l)}else{m.removeAttr("data-days-limit")}c.reset(h);e.originalEvent.preventDefault()})},i=function(d,h){var i=d.find(f.TIMELINE_VIEW_SELECTOR);i.on("shown shown.bs.tab",function(b){c.shown(h);a(b.target).removeClass("active")});b.define(i,[b.events.activate]);i.on(b.events.activate,"[data-toggle='tab']",function(b){var c=a(b.currentTarget).data("filtername");g("block_timeline_user_sort_preference",c)})};return{init:function init(b,c){b=a(b);h(b,c);i(b,c)}}});
define ("media_videojs/document",[],function(){return document});
define ("media_videojs/loader",["jquery","core/event"],function(a,b){var c,d=function(b,d){d.find(".mediaplugin_videojs").addBack(".mediaplugin_videojs").find("audio, video").each(function(){var b=a(this).attr("id"),d=a(this).data("setup-lazy"),e=["media_videojs/video-lazy"];if(d.techOrder&&-1!==d.techOrder.indexOf("youtube")){e.push("media_videojs/Youtube-lazy")}if(d.techOrder&&-1!==d.techOrder.indexOf("flash")){e.push("media_videojs/videojs-flash-lazy")}require(e,function(a){if(c){c(a);c=null}a(b,d)})})};return{setUp:function setUp(e){c=e;d(null,a("body"));b.getLegacyEvents().done(function(b){a(document).on(b.FILTER_CONTENT_UPDATED,d)})}}});
define ("media_videojs/window",[],function(){return window});
define ("format_ubstopics/ubstopics",["jquery","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/bootstrap-tabs"],function(a){return{tabs:function(b){a(".nav-course-format-tabs").bootstrapResponsiveTabs({maxTabWidth:120,currentTab:b,showNav:!0})},courseFilter:function(){a("#select-course-filter").change(function(){var b=a(this).val();if(""==b){a(".course-content .total-sections .section .activity").show()}else{a(".course-content .total-sections .section .activity").each(function(){if(a(this).hasClass(b)){a(this).show()}else{a(this).hide()}})}})}}});
define ("format_ubsweeks/ubsweeks",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/bootstrap-tabs","theme_coursemos/bootstrap-datepicker"],function(a,b,c){return{tabs:function(b){a(".nav-course-format-tabs").bootstrapResponsiveTabs({maxTabWidth:120,currentTab:b,showNav:!0})},courseFilter:function(){a("#select-course-filter").change(function(){var b=a(this).val();if(""==b){a(".course-content .total-sections .section .activity").show()}else{a(".course-content .total-sections .section .activity").each(function(){if(a(this).hasClass(b)){a(this).show()}else{a(this).hide()}return!0})}})},holiday:function(d){a(".format_ubsweeks_holiday .btn-insert").click(function(){a("#modal-holiday").modal("show");a(".form-modal-holiday").each(function(){this.reset()});a(".form-modal-holiday input[name='"+coursemostype+"']").val("insert");a("#modal-holiday .modal-title").text(M.util.get_string("holiday_add","format_ubsweeks"))});a(".format_ubsweeks_holiday .btn-delete").each(function(){var e=a(this),f=e.closest("tr").find(".holiday-name").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("holiday_delete_confirm","format_ubsweeks",f)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();var c=a(this).attr("data-id"),e={id:c};e[coursemostype]="delete";formSubmit(d,e)})})});a(".format_ubsweeks_holiday .all_checked").click(function(){var b=a(this).is(":checked");a(".format_ubsweeks_holiday .form-holiday .form-holidays").prop("checked",b)});a(".format_ubsweeks_holiday .btn-checked-delete").click(function(){var d=a(".format_ubsweeks_holiday .form-holiday .form-holidays:checked").length;if(0<d){var e=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("selected_item_delete","format_ubsweeks",d)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a(".format_ubsweeks_holiday .form-holiday").submit()})});e.trigger("click")}else{alert(M.util.get_string("selected_noitem","format_ubsweeks"))}return!1});a(".format_ubsweeks_holiday .btn-update").click(function(){var b=a(this).attr("data-id"),c={id:b};c[coursemostype]="view";a.ajax({data:c,url:d,success:function success(c){if(c.code==mesg.success){a(".form-modal-holiday input[name='id']").val(b);a(".form-modal-holiday input[name='"+coursemostype+"']").val("update");a(".form-modal-holiday input[name='day']").val(c.holiday.day_string).datepicker("update");a(".form-modal-holiday input[name='name']").val(c.holiday.name);var d=1==c.holiday.repeated?!0:!1;a(".form-modal-holiday input[name='repeat']").prop("checked",d);a(".form-modal-holiday input[name='visible'][value='"+c.holiday.visible+"']").prop("checked",!0);a("#modal-holiday").modal("show")}else{alert(c.msg)}}});return!1});a(".form-modal-holiday").validate({submitHandler:function submitHandler(b){a.ajax({data:a(b).serialize(),url:d,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}}});return!1}})}}});
define ("report_competency/grading_popup",["jquery","core/notification","core/str","core/ajax","core/log","core/templates","tool_lp/dialogue"],function(a,b,c,d,f,g,h){var i=function(b,c){this._regionSelector=b;this._userCompetencySelector=c;a(this._regionSelector).on("click",this._userCompetencySelector,this._handleClick.bind(this))};i.prototype._handleClick=function(c){var e=a(c.target).closest(this._userCompetencySelector),g=a(e).data("competencyid"),h=a(e).data("courseid"),i=a(e).data("userid");f.debug("Clicked on cell: competencyId="+g+", courseId="+h+", userId="+i);var j=d.call([{methodname:"tool_lp_data_for_user_competency_summary_in_course",args:{userid:i,competencyid:g,courseid:h}},{methodname:"core_competency_user_competency_viewed_in_course",args:{userid:i,competencyid:g,courseid:h}}]);a.when(j[0],j[1]).then(this._contextLoaded.bind(this)).catch(b.exception)};i.prototype._contextLoaded=function(b){b.displayuser=!0;M.util.js_pending("report_competency/grading_popup:_contextLoaded");return a.when(c.get_string("usercompetencysummary","report_competency"),g.render("tool_lp/user_competency_summary_in_course",b)).then(function(a,b){return new h(a,b[0],function(){g.runTemplateJS(b[1]);M.util.js_complete("report_competency/grading_popup:_contextLoaded")},this._refresh.bind(this),!0)}.bind(this))};i.prototype._refresh=function(){var c=a(this._regionSelector),e=c.data("courseid"),f=c.data("moduleid"),g=c.data("userid");if(""===f){f=0}return d.call([{methodname:"report_competency_data_for_report",args:{courseid:e,userid:g,moduleid:f},done:this._pageContextLoaded.bind(this),fail:b.exception}])};i.prototype._pageContextLoaded=function(a){g.render("report_competency/report",a).then(function(a,b){g.replaceNode(this._regionSelector,a,b)}.bind(this)).catch(b.exception)};i.prototype._regionSelector=null;i.prototype._userCompetencySelector=null;return i});
define ("report_competency/user_course_navigation",["jquery"],function(a){var b=function(b,c,d,e,f,g){this._baseUrl=d;this._userId=e+"";this._courseId=f;this._moduleId=g;a(b).on("change",this._userChanged.bind(this));a(c).on("change",this._moduleChanged.bind(this))};b.prototype._userChanged=function(b){M.util.js_pending("report_competency/user_course_navigation:_userChanged");var c=a(b.target).val(),d="?user="+c+"&id="+this._courseId+"&mod="+this._moduleId;document.location=this._baseUrl+d};b.prototype._moduleChanged=function(b){M.util.js_pending("report_competency/user_course_navigation:_moduleChanged");var c=a(b.target).val(),d="?mod="+c+"&id="+this._courseId+"&user="+this._userId;document.location=this._baseUrl+d};b.prototype._userId=null;b.prototype._moduleId=null;b.prototype._courseId=null;b.prototype._baseUrl=null;return b});
define ("report_insights/actions",["jquery","core/str","core/ajax","core/notification","core/url","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f,g){return{initBulk:function initBulk(h){var i=function(a,b,f){return c.call([{methodname:"report_insights_action_executed",args:{predictionids:a,actionname:f}}])[0].then(function(){var a=!1;b.forEach(function(b){if(!1===a){a=b.closest("table")}b.remove()});if(0===a.find("tbody > tr").length){var c={contextid:a.closest("div.insight-container").data("context-id"),modelid:a.closest("div.insight-container").data("model-id")};window.location.assign(e.relativeUrl("report/insights/insights.php",c,!1))}}).catch(d.exception)};a(h+" [data-bulk-actionname]").on("click",function(c){c.preventDefault();var e=a(c.currentTarget),h=e.data("bulk-actionname"),j=e.text().trim(),k=[],l=[];a(".insights-list input[data-togglegroup^=\"insight-bulk-action-\"][data-toggle=\"slave\"]:checked").each(function(){var b=a(this).closest("tr[data-prediction-id]");l.push(b);k.push(b.data("prediction-id"))});if(0===k.length){return this}var m=[];b.get_strings([{key:"confirmbulkaction",component:"report_insights",param:{action:j,nitems:k.length}},{key:"confirm",component:"moodle"}]).then(function(a){m=a;return f.create({type:f.types.SAVE_CANCEL,title:j,body:m[0]})}).then(function(a){a.setSaveButtonText(m[1]);a.show();a.getRoot().on(g.save,function(){return i(k,l,h)});return a}).catch(d.exception);return this})}}});
define ("report_insights/message_users",["jquery","core/str","core/log","core/modal_factory","core/modal_events","core/templates","core/notification","core/ajax"],function(a,b,c,d,e,f,g,h){var i={BULKACTIONSELECT:"#formactionid"},j=function(a,b){this.actionName=b;this.attachEventListeners(a)};j.prototype.actionName=null;j.prototype.modal=null;j.prototype.attachEventListeners=function(b){a(b+" button[data-bulk-sendmessage]").on("click",function(b){b.preventDefault();var d=a(b.currentTarget),e={},f=d.data("prediction-to-user-id");a(".insights-list input[data-togglegroup^=\"insight-bulk-action\"][data-toggle=\"slave\"]:checked").each(function(b,d){var g=a(d).closest("tr[data-prediction-id]").data("prediction-id");if("undefined"==typeof f[g]){c.error("Unknown user for prediction "+g);return}var h=f[g];e[g]=h});if(0===Object.keys(e).length){return this}this.showSendMessage(e);return this}.bind(this))};j.prototype.showSendMessage=function(c){var g=new Set(Object.values(c));if(0==g.length){return a.Deferred().resolve().promise()}var h=null;if(1==g.size){h=b.get_string("sendbulkmessagesingle","core_message")}else{h=b.get_string("sendbulkmessage","core_message",g.size)}return a.when(d.create({type:d.types.SAVE_CANCEL,body:f.render("core_user/send_bulk_message",{})}),h).then(function(b,d){this.modal=b;this.modal.setTitle(d);this.modal.setSaveButtonText(d);this.modal.getRoot().on(e.hidden,function(){a(i.BULKACTIONSELECT).focus();this.modal.getRoot().remove()}.bind(this));this.modal.getRoot().on(e.save,this.submitSendMessage.bind(this,c));this.modal.show();return this.modal}.bind(this))};j.prototype.submitSendMessage=function(a){var c=this.modal.getRoot().find("form textarea").val(),d=[],e=new Set(Object.values(a));e.forEach(function(a){d.push({touserid:a,text:c})});var f=this.actionName,i=null;return h.call([{methodname:"core_message_send_instant_messages",args:{messages:d}}])[0].then(function(a){if(1==a.length){return b.get_string("sendbulkmessagesentsingle","core_message")}else{return b.get_string("sendbulkmessagesent","core_message",a.length)}}).then(function(b){i=b;return h.call([{methodname:"report_insights_action_executed",args:{actionname:f,predictionids:Object.keys(a)}}])[0]}).then(function(){g.addNotification({message:i,type:"success"});return!0}).catch(g.exception)};return{init:function init(a,b){return new j(a,b)}}});
define ("report_participation/participants",["exports","jquery","core/custom_interaction_events","core/modal_events","core/notification","core_user/local/participants/bulkactions"],function(a,b,c,d,e,f){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=g(b);c=g(c);d=g(d);e=g(e);function g(a){return a&&a.__esModule?a:{default:a}}var h={bulkActionSelect:"#formactionid",bulkUserSelectedCheckBoxes:"input[data-togglegroup^='participants-table'][data-toggle='slave']:checked",participantsForm:"#participantsform"};a.init=function init(){var a=document.querySelector(h.participantsForm),g=function(){c.default.define(h.bulkActionSelect,[c.default.events.accessibleChange]);(0,b.default)(h.bulkActionSelect).on(c.default.events.accessibleChange,function(b){var c=b.target.value,g=a.querySelectorAll(h.bulkUserSelectedCheckBoxes);if(-1!==c.indexOf("#")){b.preventDefault();var j=[];g.forEach(function(a){j.push(a.getAttribute("name").replace("user",""))});if("#messageselect"===c){(0,f.showSendMessage)(j).then(function(b){b.getRoot().on(d.default.hidden,function(){var b=a.querySelector(h.bulkActionSelect);i(b);b.focus()});return b}).catch(e.default.exception)}}else if(""!==c&&g.length){b.target.form().submit()}i(b.target)})},i=function(a){a.value=""};g()}});
define ("report_progress/completion_override",["jquery","core/ajax","core/str","core/modal_factory","core/modal_events","core/notification","core/custom_interaction_events","core/templates"],function(a,b,c,d,e,f,g,h){var i,j,k=function(a,b){return 0<a?"i/completion-"+b+"-y-override":"i/completion-"+b+"-n-override"},l=function(a){h.render("core/loading",{}).then(function(c){j.append(c);return b.call([{methodname:"core_completion_override_activity_completion_status",args:a}])[0]}).then(function(b){var d=0<b.state?1:0,e=d?"completion-y-override":"completion-n-override";c.get_string(e,"completion",i).then(function(a){var b={state:a,date:"",user:j.attr("data-userfullname"),activity:j.attr("data-activityname")};return c.get_string("progress-title","completion",b)}).then(function(a){var b=j.attr("data-completiontracking");return h.renderPix(k(d,b),"core",a)}).then(function(b){var c=0<d?0:1;j.find(".loading-icon").remove();j.data("changecompl",a.userid+"-"+a.cmid+"-"+c);j.attr("data-changecompl",a.userid+"-"+a.cmid+"-"+c);j.children("img").replaceWith(b)}).catch(f.exception)}).catch(f.exception)},m=function(b,g){g.originalEvent.preventDefault();g.originalEvent.stopPropagation();b.preventDefault();b.stopPropagation();j=a(b.currentTarget);var h=j.data("changecompl").split("-"),i={userid:h[0],cmid:h[1],newstate:h[2]},k=1==i.newstate?"completion-y":"completion-n";c.get_strings([{key:k,component:"completion"}]).then(function(a){return c.get_strings([{key:"confirm",component:"moodle"},{key:"areyousureoverridecompletion",component:"completion",param:a[0]}])}).then(function(a){return d.create({type:d.types.SAVE_CANCEL,title:a[0],body:a[1]})}).then(function(a){a.getRoot().on(e.save,function(){l(i)});a.getRoot().on(e.hidden,function(){j.focus();a.destroy()});a.show()}).catch(f.exception)};return{init:function init(b){i=b;a("#completion-progress a.changecompl").each(function(a,b){g.define(b,[g.events.activate])});a("#completion-progress").on(g.events.activate,"a.changecompl",function(a,b){m(a,b)})}}});
define ("report_ublogs/chart",["jquery","theme_coursemos/chart","theme_coursemos/chartjs-datalables"],function(a,b){return{dashboard:function(c,d,e){var f,g,h=[],i=0;b.defaults.global.defaultFontFamily=c;a.each(e,function(a,c){f=document.getElementById("chart-"+c.name);g=f.getContext("2d");h[c.name]=new b(g,{type:"pie",data:{labels:c.data.label,datasets:[{backgroundColor:c.data.backgroundColor,data:c.data.data}]},options:{maintainAspectRatio:!1,layout:{padding:{top:0,bottom:10}},legend:{position:"bottom",labels:{padding:15}},title:{display:!0,text:c.title,fontSize:d,padding:15},onClick:function onClick(a,b){if(b[0]!==void 0){h[c.name].update();b[0]._model.outerRadius+=5}},tooltips:{callbacks:{label:function label(a,b){var c=b.datasets[a.datasetIndex],d=c._meta[Object.keys(c._meta)[0]],e=d.total,f=c.data[a.index],g=parseFloat((100*(f/e)).toFixed(1));return f+" ("+g+"%)"},title:function title(a,b){return b.labels[a[0].index]}}},plugins:{datalabels:{formatter:function formatter(a,b){var c=0,d=b.chart.data.datasets[0].data;d.map(function(a){c+=parseInt(a)});var e=(100*a/c).toFixed(2)+"%";return e},color:"#fff"}}}});if(h[c.name].data.datasets[0]._meta[i].data[0]!==void 0){h[c.name].data.datasets[0]._meta[i].data[0]._model.outerRadius+=5}i++})},module:function(a,c,d,e){var f=document.getElementById("myChart"),g=f.getContext("2d");b.defaults.global.defaultFontFamily=a;new b(g,{type:"bar",data:{labels:d,datasets:e},options:{legend:{position:"bottom"},title:{display:!0,text:M.util.get_string("chart_module_title","report_ublogs"),fontSize:c},scales:{yAxes:[{ticks:{beginAtZero:!0},scaleLabel:{display:!0,labelString:M.util.get_string("chart_module_y","report_ublogs")}}]},plugins:{datalabels:{formatter:function formatter(){return""},color:"#fff"}}}})}}});
define ("report_ublogs/completion",["jquery","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery.filedownload","theme_coursemos/jquery.tableHeadFixer"],function(a){return{pluginname:"report_ublogs",index:function(b){a(".report-ublogs-completion .form-search .form-control-listsize").change(function(){location_search("ls",a(this).val())});a(".report-ublogs-completion .form-search .form-control-group").change(function(){location_search("groupid",a(this).val())});a(".report-ublogs-completion .form-search .form-control-section").change(function(){location_search("section",a(this).val())});var c=3;if(b){c++}a(".report-ublogs-completion .table-completion").tableHeadFixer({head:!1,left:c});a(".report-ublogs-completion .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})}}});
define ("report_ublogs/log",["jquery","theme_coursemos/bootstrap"],function(a){return{init:function(){a(".report-ublogs-log .form-control-userid").change(function(){var b=a(this).val(),c=a(".report-ublogs-log select[name=\"keyfield\"]"),d=a(".report-ublogs-log input[name=\"keyword\"]");if(""!=b){c.attr("disabled","disabled");d.attr("disabled","disabled")}else{c.removeAttr("disabled");d.removeAttr("disabled")}})}}});
define ("report_ublogs/modules",["jquery","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a){return{index:function(b){a(".report-ublogs-modules .btn-popup-list").click(function(){var c=a(this).data("cmid"),d=a(this).data("type"),e=coursemostype+"=userLists&action="+d+"&cmid="+c;a.ajax({url:b,data:e,success:function success(b){if(b.code==mesg.success){var c="report-ublogs-modal";if("notaccess"==d){c="report-ublogs-modal-notaccess"}else{if("notcomplete"==d){b.isCMCompletion=0}a("#"+c+" .cm-completion").attr("data-completion",b.isCMCompletion)}a("#"+c+" .modal-title").html(b.title);a("#"+c+" .table-user-lists tbody").empty().html(b.html);a("#"+c).modal("show")}else{alert(b.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})}}});
define ("report_ublogs/statistics",["jquery","core/templates","theme_coursemos/bootstrap","theme_coursemos/jquery.tableHeadFixer","theme_coursemos/jquery.filedownload"],function(a,b){return{init:function(c,d,e){a(".user_statistics .btn-tooltip").tooltip({container:".user_statistics",trigger:"hover"});var f=3;if(e){f++}a(".table-statistics").tableHeadFixer({head:!1,left:f});a(".report-statistics .form-search .form-control-auto-submit").change(function(){a(".report-statistics .form-search").submit()});a(".table-statistics .module_icon").tooltip();a(".modal-log-detail").modal({show:!1,backdrop:!0});a(".report-statistics .btn-logdetail").click(function(){var e=a(this).attr("data-title"),f=a(this).attr("data-modname"),g=a(this).attr("data-userid"),h=a(this).attr("data-cmid"),i=a(this).attr("data-viewtype");a(".modal-log-detail .modal-title").text(e);var j=coursemostype+"=detail&id="+c+"&userid="+g+"&modname="+f+"&cmid="+h+"&viewtype="+i;a.ajax({data:j,method:"post",url:d,success:function success(c){a(".modal-log-detail .modal-body table tbody").empty();if(c.code==mesg.success){if(0<c.logsCount){var d={logs:c.logs};b.render("report_ublogs/log_detail",d).then(function(c,d){b.replaceNodeContents(".modal-log-detail .modal-body",c,d);a(".modal-log-detail").modal("show");return!1}).fail(function(){})}else{alert(M.util.get_string("not_exists_log","report_ublogs"));a(".modal-log-detail").modal("hide")}}else{alert(c.msg)}return!1}})});a(".report-statistics .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})}}});
define ("gradingform_guide/grades/grader/gradingpanel/comments/selectors",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;a.default={frequentComment:"[data-gradingform_guide-role=\"frequent-comment\"]",criterion:"[data-gradingform-guide-role=\"criterion\"]",remark:"[data-gradingform-guide-role=\"remark\"]"};return a.default});
define ("gradingform_guide/grades/grader/gradingpanel/comments",["exports","./comments/selectors"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);a.init=function init(a){var c=document.querySelector("#".concat(a));c.addEventListener("click",function(a){if(!a.target.matches(b.default.frequentComment)){return}a.preventDefault();var c=a.target.closest(b.default.frequentComment),d=c.closest(b.default.criterion),e=d.querySelector(b.default.remark);if(!e){return}if(e.value.trim()){e.value+="\n".concat(c.innerHTML)}else{e.value+=c.innerHTML}})}});
define ("gradingform_guide/grades/grader/gradingpanel",["exports","core/ajax","core_grades/grades/grader/gradingpanel/normalise","core_grades/grades/grader/gradingpanel/comparison","jquery"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.storeCurrentGrade=a.fetchCurrentGrade=void 0;e=function(a){return a&&a.__esModule?a:{default:a}}(e);function f(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function g(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var i=a.apply(b,c);function g(a){f(i,d,e,g,h,"next",a)}function h(a){f(i,d,e,g,h,"throw",a)}g(void 0)})}}a.fetchCurrentGrade=function fetchCurrentGrade(a,c,d,e){return(0,b.call)([{methodname:"gradingform_guide_grader_gradingpanel_fetch",args:{component:a,contextid:c,itemname:d,gradeduserid:e}}])[0]};var h=function(){var a=g(regeneratorRuntime.mark(function a(f,g,h,i,j,k){var l;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:l=k.querySelector("form");if(!(!0===(0,d.compareData)(l))){a.next=9;break}a.t0=c.normaliseResult;a.next=5;return(0,b.call)([{methodname:"gradingform_guide_grader_gradingpanel_store",args:{component:f,contextid:g,itemname:h,gradeduserid:i,notifyuser:j,formdata:(0,e.default)(l).serialize()}}])[0];case 5:a.t1=a.sent;return a.abrupt("return",(0,a.t0)(a.t1));case 9:return a.abrupt("return","");case 10:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.storeCurrentGrade=h});
define ("gradingform_guide/comment_chooser",["jquery","core/templates","core/notification","core/yui"],function(a,b,c){return{initialise:function initialise(d,e,f,g){function h(b,c){var e="<label>"+M.util.get_string("insertcomment","gradingform_guide")+"</label>",g="comment-chooser-"+d+"-cancel",h="<button id=\""+g+"\">"+M.util.get_string("cancel","moodle")+"</button>",i=new M.core.dialogue({modal:!0,headerContent:e,bodyContent:b,footerContent:h,focusAfterHide:"#"+f,id:"comments-chooser-dialog-"+d});a("#"+g).click(function(){i.hide()});a.each(c,function(b,c){var e="#comment-option-"+d+"-"+c.id;a(e).click(function(){var b=a("#"+f),d=b.val();if(""!==d.trim()){d+="\n"}d+=c.description;b.val(d);i.hide()});a(document).off("keypress",e).on("keypress",e,function(){var b=event.which||event.keyCode;if(13==b||32==b){a(e).click()}})});i.after("visibleChange",function(a){if(a.prevVal&&!a.newVal){this.destroy()}},i);i.show()}function i(){b.render("gradingform_guide/comment_chooser",{criterionId:d,comments:g}).done(function(a){h(a,g)}).fail(c.exception)}a("#"+e).click(function(a){a.preventDefault();i()})}}});
define ("gradingform_rubric/grades/grader/gradingpanel",["exports","core/ajax","core_grades/grades/grader/gradingpanel/normalise","core_grades/grades/grader/gradingpanel/comparison","jquery"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.storeCurrentGrade=a.fetchCurrentGrade=void 0;e=function(a){return a&&a.__esModule?a:{default:a}}(e);function f(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function g(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var i=a.apply(b,c);function g(a){f(i,d,e,g,h,"next",a)}function h(a){f(i,d,e,g,h,"throw",a)}g(void 0)})}}a.fetchCurrentGrade=function fetchCurrentGrade(a,c,d,e){return(0,b.call)([{methodname:"gradingform_rubric_grader_gradingpanel_fetch",args:{component:a,contextid:c,itemname:d,gradeduserid:e}}])[0]};var h=function(){var a=g(regeneratorRuntime.mark(function a(f,g,h,i,j,k){var l;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:l=k.querySelector("form");if(!(!0===(0,d.compareData)(l))){a.next=9;break}a.t0=c.normaliseResult;a.next=5;return(0,b.call)([{methodname:"gradingform_rubric_grader_gradingpanel_store",args:{component:f,contextid:g,itemname:h,gradeduserid:i,notifyuser:j,formdata:(0,e.default)(l).serialize()}}])[0];case 5:a.t1=a.sent;return a.abrupt("return",(0,a.t0)(a.t1));case 9:return a.abrupt("return","");case 10:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.storeCurrentGrade=h});
define ("search_elastic/enrich",["jquery","core/fragment"],function(a,b){var e={},f;function c(b,c){c="undefined"!=typeof c?c:!0;var e=a("[name=fileindexing]").is(":checked");if(!0===e){a("[name=imageindexselect]").prop("disabled",!1);a("[name=fileindexselect]").prop("disabled",!1)}else{a("[name=imageindexselect]").prop("disabled",!0).val("0");a("[name=fileindexselect]").prop("disabled",!0).val("0");if(!0===c){d()}}}function d(){var e=a(".form_container form").serialize(),g={jsonformdata:JSON.stringify(e)};b.loadFragment("search_elastic","new_enrich_form",f,g).done(function(b){a(".form_container").html(b);a("[name=imageindexselect]").change(d);a("[name=fileindexselect]").change(d);a("[name=fileindexing]").change(c);c(!1,!1)})}e.init=function(b){f=b;a("[name=imageindexselect]").change(d);a("[name=fileindexselect]").change(d);a("[name=fileindexing]").change(c);c()};return e});
define ("plagiarism_copykillerbridge/bridge",["jquery"],function(a){var b={scripturl:"",bridgeurl:""};b.init=function(a,c){b.scripturl=a;b.bridgeurl=c};b.modform=function(c,d){var e=!0;if(""==b.scripturl){alert(M.util.get_string("url_script_empty","plagiarism_copykillerbridge"));e=!1}if(""==b.bridgeurl){alert(M.util.get_string("url_bridge_empty","plagiarism_copykillerbridge"));e=!1}if(e){a.getScript(b.scripturl,function(){CopykillerBridge.setUrl(M.cfg.wwwroot+b.bridgeurl);if("ko"!=d){d="en"}CopykillerBridge.setLang(d);CopykillerBridge.initStatusCopykillerGroup("input[name=isenabled]",c);CopykillerBridge.initConfigCopykillerGroup(".btn-copykillerbridge-setting",c);a("input[name=temp_configid]").val(CopykillerBridge.temp_config_id)})}a("#id_copykillerdesc #id_isenabled").change(function(){var b=a("#id_feedbacktypes input[name=\"assignfeedback_copykillerbridge_enabled\"]"),c=a(this).is(":checked");if(0<b.length){b.prop("checked",c)}})};return b});
define ("tool_analytics/log_info",["jquery","core/str","core/modal_factory","core/notification"],function(a,b,c,d){return{loadInfo:function loadInfo(e,f){var g=a("[data-model-log-id=\""+e+"\"]");b.get_string("loginfo","tool_analytics").then(function(b){var d=a("<ul>");f.forEach(function(a){d.append("<li>"+a+"</li>")});d.append("</ul>");return c.create({title:b,body:d.html(),large:!0},g)}).catch(d.exception)}}});
define ("tool_analytics/model",["jquery","core/str","core/log","core/notification","core/modal_factory","core/modal_events","core/templates"],function(b,c,d,e,f,g,h){var i={clear:{title:{key:"clearpredictions",component:"tool_analytics"},body:{key:"clearmodelpredictions",component:"tool_analytics"}},delete:{title:{key:"delete",component:"tool_analytics"},body:{key:"deletemodelconfirmation",component:"tool_analytics"}}},j=function(a){var c=b(a).closest("[data-model-name]");if(c.length){return c.attr("data-model-name")}else{d.error("Unexpected DOM error - unable to obtain the model name");return""}};return{confirmAction:function confirmAction(a,h){b("[data-action-id=\""+a+"\"]").on("click",function(k){k.preventDefault();var l=b(k.currentTarget);if("undefined"==typeof i[h]){d.error("Action \""+h+"\" is not allowed.");return}var a=[i[h].title,i[h].body];a[1].param=j(l);var m=c.get_strings(a),n=f.create({type:f.types.SAVE_CANCEL});b.when(m,n).then(function(a,b){b.setTitle(a[0]);b.setBody(a[1]);b.setSaveButtonText(a[0]);b.getRoot().on(g.save,function(){window.location.href=l.attr("href")});b.show();return b}).fail(e.exception)})},selectEvaluationOptions:function selectEvaluationOptions(a,d){b("[data-action-id=\""+a+"\"]").on("click",function(i){i.preventDefault();var j=b(i.currentTarget),a=b(this).attr("data-timesplitting-methods"),k=c.get_strings([{key:"evaluatemodel",component:"tool_analytics"},{key:"evaluate",component:"tool_analytics"}]),l=f.create({type:f.types.SAVE_CANCEL}),m=h.render("tool_analytics/evaluation_options",{trainedexternally:d,timesplittingmethods:JSON.parse(a)});b.when(k,l).then(function(a,c){c.getRoot().on(g.hidden,c.destroy.bind(c));c.setTitle(a[0]);c.setSaveButtonText(a[1]);c.setBody(m);c.getRoot().on(g.save,function(){var a=b("input[name='evaluationmode']:checked").val();if("trainedmodel"==a){j.attr("href",j.attr("href")+"&mode=trainedmodel")}var c=b("#id-evaluation-timesplitting").val();j.attr("href",j.attr("href")+"&timesplitting="+c);window.location.href=j.attr("href")});c.show();return c}).fail(e.exception)})},selectExportOptions:function selectExportOptions(a,d){b("[data-action-id=\""+a+"\"]").on("click",function(i){i.preventDefault();var j=b(i.currentTarget);if(!d){j.attr("href",j.attr("href")+"&action=exportmodel&includeweights=0");window.location.href=j.attr("href");return}var a=c.get_strings([{key:"export",component:"tool_analytics"}]),k=f.create({type:f.types.SAVE_CANCEL}),l=h.render("tool_analytics/export_options",{});b.when(a,k).then(function(a,c){c.getRoot().on(g.hidden,c.destroy.bind(c));c.setTitle(a[0]);c.setSaveButtonText(a[0]);c.setBody(l);c.getRoot().on(g.save,function(){var a=b("input[name='exportoption']:checked").val();if("exportdata"==a){j.attr("href",j.attr("href")+"&action=exportdata")}else{j.attr("href",j.attr("href")+"&action=exportmodel");if(b("#id-includeweights").is(":checked")){j.attr("href",j.attr("href")+"&includeweights=1")}else{j.attr("href",j.attr("href")+"&includeweights=0")}}window.location.href=j.attr("href")});c.show();return c}).fail(e.exception)})}}});
define ("tool_analytics/potential-contexts",["jquery","core/ajax"],function(a,b){return{processResults:function processResults(b,c){var d=[];if(a.isArray(c)){a.each(c,function(a,b){d.push({value:b.id,label:b.name})});return d}else{return c}},transport:function transport(c,d,e,f){var g,h=a(c).attr("modelid")||null;g=b.call([{methodname:"tool_analytics_potential_contexts",args:{query:d,modelid:h}}]);g[0].then(e).fail(f)}}});
define ("tool_dataprivacy/add_category",["jquery","core/str","core/ajax","core/notification","core/modal_factory","core/modal_events","core/fragment"],function(a,b,c,d,e,f,g){var h={CATEGORY_LINK:"[data-add-element=\"category\"]"},i=function(a){this.contextId=a;this.strings=b.get_strings([{key:"addcategory",component:"tool_dataprivacy"},{key:"save",component:"admin"}]);this.registerEventListeners()};i.prototype.contextId=0;i.prototype.strings=0;i.prototype.registerEventListeners=function(){var b=a(h.CATEGORY_LINK);b.on("click",function(){return this.strings.then(function(a){e.create({type:e.types.SAVE_CANCEL,title:a[0],body:""},b).done(function(b){this.setupFormModal(b,a[1])}.bind(this))}.bind(this)).fail(d.exception)}.bind(this))};i.prototype.getBody=function(a){var b=null;if("undefined"!=typeof a){b={jsonformdata:JSON.stringify(a)}}return g.loadFragment("tool_dataprivacy","addcategory_form",this.contextId,b)};i.prototype.setupFormModal=function(a,b){a.setLarge();a.setSaveButtonText(b);a.getRoot().on(f.hidden,this.destroy.bind(this));a.setBody(this.getBody());a.getRoot().on(f.save,this.submitForm.bind(this));a.getRoot().on("submit","form",this.submitFormAjax.bind(this));this.modal=a;a.show()};i.prototype.submitForm=function(a){a.preventDefault();this.modal.getRoot().find("form").submit()};i.prototype.submitFormAjax=function(a){a.preventDefault();var b=this.modal.getRoot().find("form").serialize();c.call([{methodname:"tool_dataprivacy_create_category_form",args:{jsonformdata:JSON.stringify(b)},done:function(a){if(a.validationerrors){this.modal.setBody(this.getBody(b))}else{this.close()}}.bind(this),fail:d.exception}])};i.prototype.close=function(){this.destroy();document.location.reload()};i.prototype.destroy=function(){Y.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()});this.modal.destroy()};i.prototype.removeListeners=function(){a(h.CATEGORY_LINK).off("click")};return{getInstance:function getInstance(a){return new i(a)}}});
define ("tool_dataprivacy/add_purpose",["jquery","core/str","core/ajax","core/notification","core/modal_factory","core/modal_events","core/fragment"],function(a,b,c,d,e,f,g){var h={PURPOSE_LINK:"[data-add-element=\"purpose\"]"},i=function(a){this.contextId=a;this.strings=b.get_strings([{key:"addpurpose",component:"tool_dataprivacy"},{key:"save",component:"admin"}]);this.registerEventListeners()};i.prototype.contextId=0;i.prototype.strings=0;i.prototype.registerEventListeners=function(){var b=a(h.PURPOSE_LINK);b.on("click",function(){return this.strings.then(function(a){e.create({type:e.types.SAVE_CANCEL,title:a[0],body:""},b).done(function(b){this.setupFormModal(b,a[1])}.bind(this))}.bind(this)).fail(d.exception)}.bind(this))};i.prototype.getBody=function(a){var b=null;if("undefined"!=typeof a){b={jsonformdata:JSON.stringify(a)}}return g.loadFragment("tool_dataprivacy","addpurpose_form",this.contextId,b)};i.prototype.setupFormModal=function(a,b){a.setLarge();a.setSaveButtonText(b);a.getRoot().on(f.hidden,this.destroy.bind(this));a.setBody(this.getBody());a.getRoot().on(f.save,this.submitForm.bind(this));a.getRoot().on("submit","form",this.submitFormAjax.bind(this));this.modal=a;a.show()};i.prototype.submitForm=function(a){a.preventDefault();this.modal.getRoot().find("form").submit()};i.prototype.submitFormAjax=function(a){a.preventDefault();var b=this.modal.getRoot().find("form").serialize();c.call([{methodname:"tool_dataprivacy_create_purpose_form",args:{jsonformdata:JSON.stringify(b)},done:function(a){if(a.validationerrors){this.modal.setBody(this.getBody(b))}else{this.close()}}.bind(this),fail:d.exception}])};i.prototype.close=function(){this.destroy();document.location.reload()};i.prototype.destroy=function(){Y.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()});this.modal.destroy()};i.prototype.removeListeners=function(){a(h.PURPOSE_LINK).off("click")};return{getInstance:function getInstance(a){return new i(a)}}});
define ("tool_dataprivacy/categoriesactions",["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){var g={DELETE:"[data-action=\"deletecategory\"]"},h=function(){this.registerEvents()};h.prototype.registerEvents=function(){a(g.DELETE).click(function(g){g.preventDefault();var h=a(this).data("id"),i=a(this).data("name");d.get_strings([{key:"deletecategory",component:"tool_dataprivacy"},{key:"deletecategorytext",component:"tool_dataprivacy",param:i},{key:"delete"}]).then(function(d){var g=d[0],i=d[1],j=d[2];return e.create({title:g,body:i,type:e.types.SAVE_CANCEL}).then(function(d){d.setSaveButtonText(j);d.getRoot().on(f.save,function(){b.call([{methodname:"tool_dataprivacy_delete_category",args:{id:h}}])[0].done(function(b){if(b.result){a("tr[data-categoryid=\""+h+"\"]").remove()}else{c.addNotification({message:b.warnings[0].message,type:"error"})}}).fail(c.exception)});d.getRoot().on(f.hidden,function(){d.destroy()});return d})}).done(function(a){a.show()}).fail(c.exception)})};return{init:function init(){return new h}}});
define ("tool_dataprivacy/data_deletion",["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){var h={MARK_FOR_DELETION:"[data-action=\"markfordeletion\"]",SELECT_ALL:"[data-action=\"selectall\"]"},i={SELECTCONTEXT:".selectcontext"},j=function(){this.registerEvents()};j.prototype.registerEvents=function(){a(h.MARK_FOR_DELETION).click(function(b){b.preventDefault();var c=[];a(i.SELECTCONTEXT).each(function(){var b=a(this);if(b.is(":checked")){c.push(b.val())}});g(c)});a(h.SELECT_ALL).change(function(b){b.preventDefault();var c=a(this);if(c.is(":checked")){a(i.SELECTCONTEXT).attr("checked","checked")}else{a(i.SELECTCONTEXT).removeAttr("checked")}})};function g(a){var g="";d.get_strings([{key:"confirm",component:"moodle"},{key:"confirmcontextdeletion",component:"tool_dataprivacy"}]).then(function(a){g=a[0];var b=a[1];return e.create({title:g,body:b,type:e.types.SAVE_CANCEL})}).then(function(d){d.setSaveButtonText(g);d.getRoot().on(f.save,function(){b.call([{methodname:"tool_dataprivacy_confirm_contexts_for_deletion",args:{ids:a}}])[0].done(function(a){if(a.result){window.location.reload()}else{c.addNotification({message:a.warnings[0].message,type:"error"})}}).fail(c.exception)});d.getRoot().on(f.hidden,function(){d.destroy()});return d}).done(function(a){a.show()}).fail(c.exception)}return j});
define ("tool_dataprivacy/data_registry",["jquery","core/str","core/ajax","core/notification","core/templates","core/modal_factory","core/modal_events","core/fragment","tool_dataprivacy/add_purpose","tool_dataprivacy/add_category"],function(a,b,c,d,e,f,g,h,i,j){var k={TREE_NODES:"[data-context-tree-node=1]",FORM_CONTAINER:"#context-form-container"},l=function(a,b,c){this.systemContextId=a;this.currentContextLevel=b;this.currentContextId=c;this.init()};l.prototype.systemContextId=0;l.prototype.currentContextLevel=0;l.prototype.currentContextId=0;l.prototype.addpurpose=null;l.prototype.addcategory=null;l.prototype.init=function(){this.addpurpose=i.getInstance(this.systemContextId);this.addcategory=j.getInstance(this.systemContextId);this.strings=b.get_strings([{key:"changessaved",component:"moodle"},{key:"contextpurposecategorysaved",component:"tool_dataprivacy"},{key:"noblockstoload",component:"tool_dataprivacy"},{key:"noactivitiestoload",component:"tool_dataprivacy"},{key:"nocoursestoload",component:"tool_dataprivacy"}]);this.registerEventListeners();if(this.currentContextId){this.loadForm("context_form",[this.currentContextId],this.submitContextFormAjax.bind(this))}else{this.loadForm("contextlevel_form",[this.currentContextLevel],this.submitContextLevelFormAjax.bind(this))}};l.prototype.registerEventListeners=function(){a(k.TREE_NODES).on("click",function(b){b.preventDefault();var c=a(b.currentTarget);a(k.TREE_NODES).removeClass("active");c.addClass("active");var d=c.data("contextlevel"),e=c.data("contextid");if(d){window.history.pushState({},null,"?contextlevel="+d);this.addpurpose.removeListeners();this.addcategory.removeListeners();this.currentContextLevel=d;this.loadForm("contextlevel_form",[this.currentContextLevel],this.submitContextLevelFormAjax.bind(this))}else if(e){window.history.pushState({},null,"?contextid="+e);this.addpurpose.removeListeners();this.addcategory.removeListeners();this.currentContextId=e;this.loadForm("context_form",[this.currentContextId],this.submitContextFormAjax.bind(this))}else{var f=c.data("expandcontextid"),g=c.data("expandelement"),h=c.data("expanded");if(g){if(!h){if(c.data("loaded")||!f||!g){this.expand(c)}else{c.find("> i").removeClass("fa-plus");c.find("> i").addClass("fa-circle-o-notch fa-spin");this.loadExtra(c,f,g)}}else{this.collapse(c)}}}}.bind(this))};l.prototype.removeListeners=function(){a(k.TREE_NODES).off("click")};l.prototype.loadForm=function(b,c,f){this.clearForm();var g=h.loadFragment("tool_dataprivacy",b,this.systemContextId,c);g.done(function(b,c){a(k.FORM_CONTAINER).html(b);e.runTemplateJS(c);this.addpurpose.registerEventListeners();this.addcategory.registerEventListeners();a(k.FORM_CONTAINER).on("submit","form",f)}.bind(this)).fail(d.exception)};l.prototype.clearForm=function(){Y.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()});a(k.FORM_CONTAINER).off("submit","form")};l.prototype.submitForm=function(b){b.preventDefault();a(k.FORM_CONTAINER).find("form").submit()};l.prototype.submitContextLevelFormAjax=function(a){this.submitFormAjax(a,"tool_dataprivacy_set_contextlevel_form")};l.prototype.submitContextFormAjax=function(a){this.submitFormAjax(a,"tool_dataprivacy_set_context_form")};l.prototype.submitFormAjax=function(b,e){b.preventDefault();var f=a(k.FORM_CONTAINER).find("form").serialize();return this.strings.then(function(a){c.call([{methodname:e,args:{jsonformdata:JSON.stringify(f)},done:function done(){d.alert(a[0],a[1])},fail:d.exception}])}).catch(d.exception)};l.prototype.loadExtra=function(a,b,f){c.call([{methodname:"tool_dataprivacy_tree_extra_branches",args:{contextid:b,element:f},done:function(b){if(0==b.branches.length){this.noElements(a,f);return}e.render("tool_dataprivacy/context_tree_branches",b).then(function(b){a.after(b);this.removeListeners();this.registerEventListeners();this.expand(a);a.data("loaded",1)}.bind(this)).fail(d.exception)}.bind(this),fail:d.exception}])};l.prototype.noElements=function(a,b){a.data("expandcontextid","");a.data("expandelement","");this.strings.then(function(c){var d=2;if("module"==b){d=3}else if("course"==b){d=4}a.text(c[d])}).fail(d.exception)};l.prototype.collapse=function(a){a.data("expanded",0);a.siblings("nav").addClass("hidden");a.find("> i").removeClass("fa-minus");a.find("> i").addClass("fa-plus")};l.prototype.expand=function(a){a.data("expanded",1);a.siblings("nav").removeClass("hidden");a.find("> i").removeClass("fa-plus");a.find("> i").removeClass("fa-circle-o-notch fa-spin");a.find("> i").addClass("fa-minus")};return{init:function init(a,b,c){return new l(a,b,c)}}});
define ("tool_dataprivacy/data_request_modal",["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","tool_dataprivacy/events"],function(a,b,c,d,e,f){var g=!1,h={APPROVE_BUTTON:"[data-action=\"approve\"]",DENY_BUTTON:"[data-action=\"deny\"]",COMPLETE_BUTTON:"[data-action=\"complete\"]"},i=function(a){d.call(this,a)};i.TYPE="tool_dataprivacy-data_request";i.prototype=Object.create(d.prototype);i.prototype.constructor=i;i.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this);this.getModal().on(c.events.activate,h.APPROVE_BUTTON,function(b,c){var d=a.Event(f.approve);this.getRoot().trigger(d,this);if(!d.isDefaultPrevented()){this.hide();c.originalEvent.preventDefault()}}.bind(this));this.getModal().on(c.events.activate,h.DENY_BUTTON,function(b,c){var d=a.Event(f.deny);this.getRoot().trigger(d,this);if(!d.isDefaultPrevented()){this.hide();c.originalEvent.preventDefault()}}.bind(this));this.getModal().on(c.events.activate,h.COMPLETE_BUTTON,function(b,c){var d=a.Event(f.complete);this.getRoot().trigger(d,this);if(!d.isDefaultPrevented()){this.hide();c.originalEvent.preventDefault()}}.bind(this))};if(!g){e.register(i.TYPE,i,"tool_dataprivacy/data_request_modal");g=!0}return i});
define ("tool_dataprivacy/defaultsactions",["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events","core/templates"],function(a,b,c,d,f,g,h){var k={EDIT_LEVEL_DEFAULTS:"[data-action=\"edit-level-defaults\"]",NEW_ACTIVITY_DEFAULTS:"[data-action=\"new-activity-defaults\"]",EDIT_ACTIVITY_DEFAULTS:"[data-action=\"edit-activity-defaults\"]",DELETE_ACTIVITY_DEFAULTS:"[data-action=\"delete-activity-defaults\"]"},l=-1,m=function(){this.registerEvents()};m.prototype.registerEvents=function(){a(k.EDIT_LEVEL_DEFAULTS).click(function(f){f.preventDefault();var e=a(this),g=e.data("contextlevel"),h=e.data("category"),j=e.data("purpose"),k=b.call([{methodname:"tool_dataprivacy_get_category_options",args:{}},{methodname:"tool_dataprivacy_get_purpose_options",args:{}}]),l=d.get_string("editdefaults","tool_dataprivacy",a("#defaults-header").text());a.when(k[0],k[1],l).then(function(a,b,c){var d=a.options,e=b.options;i(c,g,h,j,null,d,e,null);return!0}).catch(c.exception)});a(k.NEW_ACTIVITY_DEFAULTS).click(function(f){f.preventDefault();var e=a(this),g=e.data("contextlevel"),h=b.call([{methodname:"tool_dataprivacy_get_category_options",args:{}},{methodname:"tool_dataprivacy_get_purpose_options",args:{}},{methodname:"tool_dataprivacy_get_activity_options",args:{nodefaults:!0}}]),j=d.get_string("addnewdefaults","tool_dataprivacy");a.when(h[0],h[1],h[2],j).then(function(a,b,c,d){var e=a.options,f=b.options,h=c.options;i(d,g,null,null,null,e,f,h);return!0}).catch(c.exception)});a(k.EDIT_ACTIVITY_DEFAULTS).click(function(f){f.preventDefault();var e=a(this),g=e.data("contextlevel"),h=e.data("category"),j=e.data("purpose"),k=e.data("activityname"),l=b.call([{methodname:"tool_dataprivacy_get_category_options",args:{}},{methodname:"tool_dataprivacy_get_purpose_options",args:{}},{methodname:"tool_dataprivacy_get_activity_options",args:{}}]),m=d.get_string("editmoduledefaults","tool_dataprivacy");a.when(l[0],l[1],l[2],m).then(function(a,b,c,d){var e=a.options,f=b.options,l=c.options;i(d,g,h,j,k,e,f,l);return!0}).catch(c.exception)});a(k.DELETE_ACTIVITY_DEFAULTS).click(function(b){b.preventDefault();var e=a(this),i=e.data("contextlevel"),k=e.data("activityname"),m=e.data("activitydisplayname");f.create({title:d.get_string("deletedefaults","tool_dataprivacy",m),body:h.render("tool_dataprivacy/delete_activity_defaults",{activityname:m}),type:f.types.SAVE_CANCEL,large:!0}).then(function(a){a.setSaveButtonText(d.get_string("delete"));a.getRoot().on(g.save,function(){j(i,l,l,k,!1)});a.getRoot().on(g.hidden,function(){a.destroy()});a.show();return!0}).catch(c.exception)})};function i(b,d,e,i,k,l,m,n){if(null!==e){l.forEach(function(a){if(a.id===e){a.selected=!0}})}if(null!==i){m.forEach(function(a){if(a.id===i){a.selected=!0}})}var o={contextlevel:d,categoryoptions:l,purposeoptions:m};if(null!==n&&n.length){if(null===k){o.newactivitydefaults=!0}else{n.forEach(function(a){if(k===a.name){a.selected=!0}})}o.modemodule=!0;o.activityoptions=n}f.create({title:b,body:h.render("tool_dataprivacy/category_purpose_form",o),type:f.types.SAVE_CANCEL,large:!0}).then(function(b){b.getRoot().on(g.save,function(){var b=a("#activity"),c="undefined"!=typeof b?b.val():null,d=a("#override"),e="undefined"!=typeof d?d.is(":checked"):!1;j(a("#contextlevel").val(),a("#category").val(),a("#purpose").val(),c,e)});b.getRoot().on(g.hidden,function(){b.destroy()});b.show();return b}).catch(c.exception)}function j(a,c,d,e,f){b.call([{methodname:"tool_dataprivacy_set_context_defaults",args:{contextlevel:a,category:c,purpose:d,override:f,activity:e}}])[0].done(function(a){if(a.result){window.location.reload()}})}return{init:function init(){return new m}}});
define ("tool_dataprivacy/effective_retention_period",["jquery"],function(a){var b={PURPOSE_SELECT:"#id_purposeid",RETENTION_FIELD:"#fitem_id_retention_current [data-fieldtype=static]"},c=function(a){this.purposeRetentionPeriods=a;this.registerEventListeners()},d=function(){a(b.PURPOSE_SELECT).off("change")};c.prototype.purposeRetentionPeriods=[];c.prototype.registerEventListeners=function(){a(b.PURPOSE_SELECT).on("change",function(c){var d=a(c.currentTarget).val(),e=this.purposeRetentionPeriods[d];a(b.RETENTION_FIELD).text(e)}.bind(this))};return{init:function init(a){d();return new c(a)}}});
define ("tool_dataprivacy/events",[],function(){return{approve:"tool_dataprivacy-data_request:approve",bulkApprove:"tool_dataprivacy-data_request:bulk_approve",deny:"tool_dataprivacy-data_request:deny",bulkDeny:"tool_dataprivacy-data_request:bulk_deny",complete:"tool_dataprivacy-data_request:complete"}});
define ("tool_dataprivacy/expand_contract",["jquery","core/url","core/str"],function(a,b,c){var d=a("<img alt=\"\" src=\""+b.imageUrl("t/expanded")+"\"/>"),e=a("<img alt=\"\" src=\""+b.imageUrl("t/collapsed")+"\"/>"),f={EXPAND:"fa-caret-right",COLLAPSE:"fa-caret-down"};return{expandCollapse:function expandCollapse(a,b){if(a.hasClass("hide")){a.removeClass("hide");a.addClass("visible");a.attr("aria-expanded",!0);b.find(":header i.fa").removeClass(f.EXPAND);b.find(":header i.fa").addClass(f.COLLAPSE);b.find(":header img.icon").attr("src",d.attr("src"))}else{a.removeClass("visible");a.addClass("hide");a.attr("aria-expanded",!1);b.find(":header i.fa").removeClass(f.COLLAPSE);b.find(":header i.fa").addClass(f.EXPAND);b.find(":header img.icon").attr("src",e.attr("src"))}},expandCollapseAll:function expandCollapseAll(b){var g="visible"==b?"hide":"visible",h="visible"==b?!0:!1,i="visible"==b?f.EXPAND:f.COLLAPSE,j="visible"==b?f.COLLAPSE:f.EXPAND,k="visible"==b?d.attr("src"):e.attr("src");a("."+g).each(function(){a(this).removeClass(g);a(this).addClass(b);a(this).attr("aria-expanded",h)});a(".tool_dataprivacy-expand-all").data("visibilityState",g);c.get_string(g,"tool_dataprivacy").then(function(b){a(".tool_dataprivacy-expand-all").html(b)}).catch(Notification.exception);a(":header i.fa").each(function(){a(this).removeClass(i);a(this).addClass(j)});a(":header img.icon").each(function(){a(this).attr("src",k)})}}});
define ("tool_dataprivacy/form-user-selector",["jquery","core/ajax","core/templates"],function(a,b,c){return{processResults:function processResults(b,c){var d=[];a.each(c,function(a,b){d.push({value:b.id,label:b._label})});return d},transport:function transport(d,e,f,g){var h=b.call([{methodname:"tool_dataprivacy_get_users",args:{query:e}}]);h[0].then(function(b){var d=[],e=0;a.each(b,function(a,b){d.push(c.render("tool_dataprivacy/form-user-selector-suggestion",b))});return a.when.apply(a.when,d).then(function(){var c=arguments;a.each(b,function(a,b){b._label=c[e];e++});f(b)})}).fail(g)}}});
define ("tool_dataprivacy/myrequestactions",["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events","core/templates","core/pending"],function(a,b,c,d,e,f,g,h){var j={CANCEL_REQUEST:"[data-action=\"cancel\"]",CONTACT_DPO:"[data-action=\"contactdpo\"]"},k=function(){this.registerEvents()};k.prototype.registerEvents=function(){a(j.CANCEL_REQUEST).click(function(g){g.preventDefault();var h=a(this).data("requestid");d.get_strings([{key:"cancelrequest",component:"tool_dataprivacy"},{key:"cancelrequestconfirmation",component:"tool_dataprivacy"}]).then(function(a){var d=a[0],g=a[1];return e.create({title:d,body:g,type:e.types.SAVE_CANCEL}).then(function(a){a.setSaveButtonText(d);a.getRoot().on(f.save,function(){b.call([{methodname:"tool_dataprivacy_cancel_data_request",args:{requestid:h}}])[0].done(function(a){if(a.result){window.location.reload()}else{c.addNotification({message:a.warnings[0].message,type:"error"})}}).fail(c.exception)});a.getRoot().on(f.hidden,function(){a.destroy()});return a})}).done(function(a){a.show()}).fail(c.exception)});a(j.CONTACT_DPO).click(function(b){var j=new h("dataprivacy/crud:initModal:contactdpo");b.preventDefault();var k=a(this).data("replytoemail"),l="";d.get_strings([{key:"contactdataprotectionofficer",component:"tool_dataprivacy"},{key:"send",component:"tool_dataprivacy"}]).then(function(a){var b=a[0];l=a[1];return e.create({title:b,body:g.render("tool_dataprivacy/contact_dpo",{replytoemail:k}),type:e.types.SAVE_CANCEL,large:!0})}).then(function(b){b.setSaveButtonText(l);b.show();b.getRoot().on(f.save,function(b){var c=a("#message").val().trim();if(0===c.length){b.preventDefault();a("[data-region=\"messageinput\"]").addClass("has-danger notifyproblem");a("#id_error_message").removeAttr("hidden")}else{i(c)}});b.getRoot().on(f.hidden,function(){b.destroy()})}).then(j.resolve).catch(c.exception)})};function i(a){var e="success";b.call([{methodname:"tool_dataprivacy_contact_dpo",args:{message:a}}])[0].then(function(a){if(a.result){return d.get_string("requestsubmitted","tool_dataprivacy")}e="error";return a.warnings.join("<br>")}).done(function(a){c.addNotification({message:a,type:e})}).fail(c.exception)}return{init:function init(){return new k}}});
define ("tool_dataprivacy/purposesactions",["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){var g={DELETE:"[data-action=\"deletepurpose\"]"},h=function(){this.registerEvents()};h.prototype.registerEvents=function(){a(g.DELETE).click(function(g){g.preventDefault();var h=a(this).data("id"),i=a(this).data("name");d.get_strings([{key:"deletepurpose",component:"tool_dataprivacy"},{key:"deletepurposetext",component:"tool_dataprivacy",param:i},{key:"delete"}]).then(function(d){var g=d[0],i=d[1],j=d[2];return e.create({title:g,body:i,type:e.types.SAVE_CANCEL}).then(function(d){d.setSaveButtonText(j);d.getRoot().on(f.save,function(){b.call([{methodname:"tool_dataprivacy_delete_purpose",args:{id:h}}])[0].done(function(b){if(b.result){a("tr[data-purposeid=\""+h+"\"]").remove()}else{c.addNotification({message:b.warnings[0].message,type:"error"})}}).fail(c.exception)});d.getRoot().on(f.hidden,function(){d.destroy()});return d})}).done(function(a){a.show()}).fail(c.exception)})};return{init:function init(){return new h}}});
define ("tool_dataprivacy/request_filter",["jquery","core/form-autocomplete","core/str","core/notification"],function(a,b,c,d){var e={REQUEST_FILTERS:"#request-filters"},f=function init(){c.get_strings([{key:"filter",component:"moodle"},{key:"nofiltersapplied",component:"moodle"}]).then(function(a){var c=a[0],d=a[1];return b.enhance(e.REQUEST_FILTERS,!1,"",c,!1,!0,d,!0)}).fail(d.exception);var f=a(e.REQUEST_FILTERS).val();a(e.REQUEST_FILTERS).on("change",function(){var b=a(this).val();if(f.join(",")!==b.join(",")){if(0===b.length){a("#filters-cleared").val(1)}a(this.form).submit()}})};return{init:function init(){f()}}});
define ("tool_dataprivacy/requestactions",["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events","core/templates","tool_dataprivacy/data_request_modal","tool_dataprivacy/events"],function(a,b,c,d,e,f,g,h,i){var q={APPROVE_REQUEST:"[data-action=\"approve\"]",DENY_REQUEST:"[data-action=\"deny\"]",VIEW_REQUEST:"[data-action=\"view\"]",MARK_COMPLETE:"[data-action=\"complete\"]",CHANGE_BULK_ACTION:"[id=\"bulk-action\"]",CONFIRM_BULK_ACTION:"[id=\"confirm-bulk-action\"]",SELECT_ALL:"[data-action=\"selectall\"]"},r={APPROVE:1,DENY:2},s={SELECT_REQUEST:".selectrequests"},t=function(){this.registerEvents()};t.prototype.registerEvents=function(){a(q.VIEW_REQUEST).click(function(d){d.preventDefault();var k=a(this).data("requestid"),m=b.call([{methodname:"tool_dataprivacy_get_data_request",args:{requestid:k}}]);a.when(m[0]).then(function(a){if(a.result){return a.result}c.addNotification({message:a.warnings[0].message,type:"error"});return!1}).then(function(a){var b=g.render("tool_dataprivacy/request_details",a),c={approvedeny:a.approvedeny,canmarkcomplete:a.canmarkcomplete};return e.create({title:a.typename,body:b,type:h.TYPE,large:!0,templateContext:c})}).then(function(a){a.getRoot().on(i.approve,function(){o(i.approve,j(k))});a.getRoot().on(i.deny,function(){o(i.deny,l(k))});a.getRoot().on(i.complete,function(){p("tool_dataprivacy_mark_complete",{requestid:k})});a.getRoot().on(f.hidden,function(){a.destroy()});a.show()}).catch(c.exception)});a(q.APPROVE_REQUEST).click(function(b){b.preventDefault();var c=a(this).data("requestid");o(i.approve,j(c))});a(q.DENY_REQUEST).click(function(b){b.preventDefault();var c=a(this).data("requestid");o(i.deny,l(c))});a(q.MARK_COMPLETE).click(function(b){b.preventDefault();var c=a(this).data("requestid");o(i.complete,n(c))});a(q.CONFIRM_BULK_ACTION).click(function(){var b=[],e="",f={},g=[{key:"selectbulkaction",component:"tool_dataprivacy"},{key:"selectdatarequests",component:"tool_dataprivacy"},{key:"ok"}],h=parseInt(a("#bulk-action").val());if(h!=r.APPROVE&&h!=r.DENY){d.get_strings(g).done(function(a){c.alert("",a[0],a[2])}).fail(c.exception);return}a(".selectrequests:checked").each(function(){b.push(a(this).val())});if(1>b.length){d.get_strings(g).done(function(a){c.alert("",a[1],a[2])}).fail(c.exception);return}switch(h){case r.APPROVE:e=i.bulkApprove;f=k(b);break;case r.DENY:e=i.bulkDeny;f=m(b);}o(e,f)});a(q.SELECT_ALL).change(function(b){b.preventDefault();var c=a(this).is(":checked");a(s.SELECT_REQUEST).prop("checked",c)})};function j(a){return{wsfunction:"tool_dataprivacy_approve_data_request",wsparams:{requestid:a}}}function k(a){return{wsfunction:"tool_dataprivacy_bulk_approve_data_requests",wsparams:{requestids:a}}}function l(a){return{wsfunction:"tool_dataprivacy_deny_data_request",wsparams:{requestid:a}}}function m(a){return{wsfunction:"tool_dataprivacy_bulk_deny_data_requests",wsparams:{requestids:a}}}function n(a){return{wsfunction:"tool_dataprivacy_mark_complete",wsparams:{requestid:a}}}function o(a,b){var g=[];switch(a){case i.approve:g=[{key:"approverequest",component:"tool_dataprivacy"},{key:"confirmapproval",component:"tool_dataprivacy"}];break;case i.bulkApprove:g=[{key:"bulkapproverequests",component:"tool_dataprivacy"},{key:"confirmbulkapproval",component:"tool_dataprivacy"}];break;case i.deny:g=[{key:"denyrequest",component:"tool_dataprivacy"},{key:"confirmdenial",component:"tool_dataprivacy"}];break;case i.bulkDeny:g=[{key:"bulkdenyrequests",component:"tool_dataprivacy"},{key:"confirmbulkdenial",component:"tool_dataprivacy"}];break;case i.complete:g=[{key:"markcomplete",component:"tool_dataprivacy"},{key:"confirmcompletion",component:"tool_dataprivacy"}];break;}var h="";d.get_strings(g).then(function(a){h=a[0];var b=a[1];return e.create({title:h,body:b,type:e.types.SAVE_CANCEL})}).then(function(a){a.setSaveButtonText(h);a.getRoot().on(f.save,function(){p(b.wsfunction,b.wsparams)});a.getRoot().on(f.hidden,function(){a.destroy()});a.show()}).catch(c.exception)}function p(a,d){b.call([{methodname:a,args:d}])[0].done(function(a){if(a.result){window.location.reload()}else{c.addNotification({message:a.warnings[0].message,type:"error"})}}).fail(c.exception)}return t});
define ("tool_licensemanager/delete_license",["jquery","core/modal_factory","core/modal_events","core/url","core/str"],function(a,b,c,d,e){var f=a(".delete-license");b.create({type:b.types.SAVE_CANCEL,title:e.get_string("deletelicense","tool_licensemanager"),body:e.get_string("deletelicenseconfirmmessage","tool_licensemanager"),preShowCallback:function preShowCallback(b,c){b=a(b);var e={action:"delete",license:b.data("license")};c.deleteURL=d.relativeUrl("/admin/tool/licensemanager/index.php",e,!0)},large:!0},f).done(function(a){a.getRoot().on(c.save,function(b){b.preventDefault();window.location.href=a.deleteURL})})});
define ("tool_lp/actionselector",["jquery","core/notification","core/ajax","core/templates","tool_lp/dialogue","tool_lp/event_base"],function(a,b,c,d,e,f){var g=function(a,b,c,d,e){var g=this;f.prototype.constructor.apply(this,[]);g._title=a;g._message=b;g._actions=c;g._confirm=d;g._cancel=e;g._selectedValue=null;g._reset()};g.prototype=Object.create(f.prototype);g.prototype._selectedValue=null;g.prototype._popup=null;g.prototype._title=null;g.prototype._message=null;g.prototype._actions=null;g.prototype._confirm=null;g.prototype._cancel=null;g.prototype._afterRender=function(){var b=this;b._find("[data-action=\"action-selector-confirm\"]").attr("disabled","disabled");b._find("[data-region=\"action-selector-radio-buttons\"]").change(function(){b._selectedValue=a("input[type='radio']:checked").val();b._find("[data-action=\"action-selector-confirm\"]").removeAttr("disabled");b._refresh.bind(b)});b._find("[data-action=\"action-selector-cancel\"]").click(function(a){a.preventDefault();b.close()});b._find("[data-action=\"action-selector-confirm\"]").click(function(a){a.preventDefault();if(!b._selectedValue.length){return}b._trigger("save",{action:b._selectedValue});b.close()})};g.prototype.close=function(){var a=this;a._popup.close();a._reset()};g.prototype.display=function(){var a=this;return a._render().then(function(b){a._popup=new e(a._title,b,a._afterRender.bind(a))}).fail(b.exception)};g.prototype._find=function(b){return a(this._popup.getContent()).find(b)};g.prototype._refresh=function(){var a=this;return a._render().then(function(b){a._find("[data-region=\"action-selector\"]").replaceWith(b);a._afterRender()})};g.prototype._render=function(){var a=this,b=[];for(var c in a._actions){b.push(a._actions[c])}var e={message:a._message,choices:b,confirm:a._confirm,cancel:a._cancel};return d.render("tool_lp/action_selector",e)};g.prototype._reset=function(){this._popup=null;this._selectedValue=""};return g});
define ("tool_lp/scaleconfig",["jquery","core/notification","core/templates","core/ajax","tool_lp/dialogue","tool_lp/scalevalues"],function(a,b,c,d,e,f){var g=function(b,c,d){this.selectSelector=b;this.inputSelector=c;this.triggerSelector=d;this.originalscaleid=a(b).val();a(b).on("change",this.scaleChangeHandler.bind(this)).change();a(d).click(this.showConfig.bind(this))};g.prototype.selectSelector=null;g.prototype.inputSelector=null;g.prototype.triggerSelector=null;g.prototype.scalevalues=null;g.prototype.originalscaleid=0;g.prototype.scaleid=0;g.prototype.popup=null;g.prototype.showConfig=function(){var d=this;this.scaleid=a(this.selectSelector).val();if(0>=this.scaleid){return}var f=a(this.selectSelector).find("option:selected").text();this.getScaleValues(this.scaleid).done(function(){var a={scalename:f,scales:d.scalevalues};c.render("tool_lp/scale_configuration_page",a).done(function(a){new e(f,a,d.initScaleConfig.bind(d))}).fail(b.exception)}).fail(b.exception)};g.prototype.retrieveOriginalScaleConfig=function(){var b=a(this.inputSelector).val();if(""!==b){var c=a.parseJSON(b),d=c.shift();if(d.scaleid===this.originalscaleid){return c}}return""};g.prototype.initScaleConfig=function(b){this.popup=b;var c=a(b.getContent());if(this.originalscaleid===this.scaleid){var d=this.retrieveOriginalScaleConfig();if(""!==d){d.forEach(function(a){if(1===a.scaledefault){c.find("[data-field=\"tool_lp_scale_default_"+a.id+"\"]").attr("checked",!0)}if(1===a.proficient){c.find("[data-field=\"tool_lp_scale_proficient_"+a.id+"\"]").attr("checked",!0)}})}}c.on("click","[data-action=\"close\"]",function(){this.setScaleConfig();b.close()}.bind(this));c.on("click","[data-action=\"cancel\"]",function(){b.close()})};g.prototype.setScaleConfig=function(){var b=a(this.popup.getContent()),c=[{scaleid:this.scaleid}];this.scalevalues.forEach(function(a){var d=0,e=0;if(b.find("[data-field=\"tool_lp_scale_default_"+a.id+"\"]").is(":checked")){d=1}if(b.find("[data-field=\"tool_lp_scale_proficient_"+a.id+"\"]").is(":checked")){e=1}if(!d&&!e){return}c.push({id:a.id,scaledefault:d,proficient:e})});var d=JSON.stringify(c);a(this.inputSelector).val(d);this.originalscaleid=this.scaleid};g.prototype.getScaleValues=function(a){return f.get_values(a).then(function(a){this.scalevalues=a;return a}.bind(this))};g.prototype.scaleChangeHandler=function(b){if(0>=a(b.target).val()){a(this.triggerSelector).prop("disabled",!0)}else{a(this.triggerSelector).prop("disabled",!1)}};return{init:function init(a,b,c){return new g(a,b,c)}}});
define ("tool_lp/competencies",["jquery","core/notification","core/ajax","core/templates","core/str","tool_lp/competencypicker","tool_lp/dragdrop-reorder","core/pending"],function(a,b,c,d,e,f,g,h){var i=function(b,c,d){this.itemid=b;this.itemtype=c;this.pageContextId=d;this.pickerInstance=null;a("[data-region=\"actions\"] button").prop("disabled",!1);this.registerEvents();this.registerDragDrop()};i.prototype.registerDragDrop=function(){var a=this;e.get_string("movecompetency","tool_lp").done(function(b){g.dragdrop("movecompetency",b,{identifier:"movecompetency",component:"tool_lp"},{identifier:"movecompetencyafter",component:"tool_lp"},"drag-samenode","drag-parentnode","drag-handlecontainer",function(b,c){a.handleDrop(b,c)})}).fail(b.exception)};i.prototype.handleDrop=function(d,e){var f=a(d).data("id"),g=a(e).data("id"),h=this,i=[];if("course"==h.itemtype){i=c.call([{methodname:"core_competency_reorder_course_competency",args:{courseid:h.itemid,competencyidfrom:f,competencyidto:g}}])}else if("template"==h.itemtype){i=c.call([{methodname:"core_competency_reorder_template_competency",args:{templateid:h.itemid,competencyidfrom:f,competencyidto:g}}])}else if("plan"==h.itemtype){i=c.call([{methodname:"core_competency_reorder_plan_competency",args:{planid:h.itemid,competencyidfrom:f,competencyidto:g}}])}else{return}i[0].fail(b.exception)};i.prototype.pickCompetency=function(){var g=this,i,j,k,l;if(!g.pickerInstance){if("template"===g.itemtype||"course"===g.itemtype){l="parents"}g.pickerInstance=new f(g.pageContextId,!1,l);g.pickerInstance.on("save",function(f,e){var l=e.competencyIds,m=new h;if("course"===g.itemtype){i=[];a.each(l,function(a,b){i.push({methodname:"core_competency_add_competency_to_course",args:{courseid:g.itemid,competencyid:b}})});i.push({methodname:"tool_lp_data_for_course_competencies_page",args:{courseid:g.itemid,moduleid:0}});j="tool_lp/course_competencies_page";k="coursecompetenciespage"}else if("template"===g.itemtype){i=[];a.each(l,function(a,b){i.push({methodname:"core_competency_add_competency_to_template",args:{templateid:g.itemid,competencyid:b}})});i.push({methodname:"tool_lp_data_for_template_competencies_page",args:{templateid:g.itemid,pagecontext:{contextid:g.pageContextId}}});j="tool_lp/template_competencies_page";k="templatecompetenciespage"}else if("plan"===g.itemtype){i=[];a.each(l,function(a,b){i.push({methodname:"core_competency_add_competency_to_plan",args:{planid:g.itemid,competencyid:b}})});i.push({methodname:"tool_lp_data_for_plan_page",args:{planid:g.itemid}});j="tool_lp/plan_page";k="plan-page"}c.call(i)[i.length-1].then(function(a){return d.render(j,a)}).then(function(b,c){d.replaceNode(a("[data-region=\""+k+"\"]"),b,c)}).then(m.resolve).catch(b.exception)})}return g.pickerInstance.display()};i.prototype.doDelete=function(e){var f=this,g=[],h="",i="";if("course"==f.itemtype){g=c.call([{methodname:"core_competency_remove_competency_from_course",args:{courseid:f.itemid,competencyid:e}},{methodname:"tool_lp_data_for_course_competencies_page",args:{courseid:f.itemid,moduleid:0}}]);h="tool_lp/course_competencies_page";i="coursecompetenciespage"}else if("template"==f.itemtype){g=c.call([{methodname:"core_competency_remove_competency_from_template",args:{templateid:f.itemid,competencyid:e}},{methodname:"tool_lp_data_for_template_competencies_page",args:{templateid:f.itemid,pagecontext:{contextid:f.pageContextId}}}]);h="tool_lp/template_competencies_page";i="templatecompetenciespage"}else if("plan"==f.itemtype){g=c.call([{methodname:"core_competency_remove_competency_from_plan",args:{planid:f.itemid,competencyid:e}},{methodname:"tool_lp_data_for_plan_page",args:{planid:f.itemid}}]);h="tool_lp/plan_page";i="plan-page"}g[1].done(function(c){d.render(h,c).done(function(b,c){a("[data-region=\""+i+"\"]").replaceWith(b);d.runTemplateJS(c)}).fail(b.exception)}).fail(b.exception)};i.prototype.deleteHandler=function(a){var d=this,f=[],g;if("course"==d.itemtype){g="unlinkcompetencycourse"}else if("template"==d.itemtype){g="unlinkcompetencytemplate"}else if("plan"==d.itemtype){g="unlinkcompetencyplan"}else{return}f=c.call([{methodname:"core_competency_read_competency",args:{id:a}}]);f[0].done(function(c){e.get_strings([{key:"confirm",component:"moodle"},{key:g,component:"tool_lp",param:c.shortname},{key:"confirm",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){d.doDelete(a)})}).fail(b.exception)}).fail(b.exception)};i.prototype.registerEvents=function(){var f=this;if("course"==f.itemtype){a("[data-region=\"coursecompetenciespage\"]").on("change","select[data-field=\"ruleoutcome\"]",function(g){var e=new h,i=[],j=a(g.target).data("id"),k=a(g.target).val();i=c.call([{methodname:"core_competency_set_course_competency_ruleoutcome",args:{coursecompetencyid:j,ruleoutcome:k}},{methodname:"tool_lp_data_for_course_competencies_page",args:{courseid:f.itemid,moduleid:0}}]);i[1].then(function(a){return d.render("tool_lp/course_competencies_page",a)}).then(function(b,c){return d.replaceNode(a("[data-region=\""+"coursecompetenciespage"+"\"]"),b,c)}).then(e.resolve).catch(b.exception)})}a("[data-region=\"actions\"] button").click(function(a){var b=new h;a.preventDefault();f.pickCompetency().then(b.resolve).catch()});a("[data-action=\"delete-competency-link\"]").click(function(b){b.preventDefault();var c=a(b.target).closest("[data-id]").data("id");f.deleteHandler(c)})};return i});
define ("tool_lp/competency_outcomes",["jquery","core/str"],function(a,b){return{NONE:0,EVIDENCE:1,COMPLETE:2,RECOMMEND:3,getAll:function getAll(){var a=this;return b.get_strings([{key:"competencyoutcome_none",component:"tool_lp"},{key:"competencyoutcome_evidence",component:"tool_lp"},{key:"competencyoutcome_recommend",component:"tool_lp"},{key:"competencyoutcome_complete",component:"tool_lp"}]).then(function(b){var c={};c[a.NONE]={code:a.NONE,name:b[0]};c[a.EVIDENCE]={code:a.EVIDENCE,name:b[1]};c[a.RECOMMEND]={code:a.RECOMMEND,name:b[2]};c[a.COMPLETE]={code:a.COMPLETE,name:b[3]};return c})},getString:function getString(b){var c=this,d=c.getAll();return d.then(function(c){if("undefined"==typeof c[b]){return a.Deferred().reject().promise()}return c[b].name})}}});
define ("tool_lp/frameworkactions",["jquery","core/templates","core/ajax","core/notification","core/str"],function(a,b,c,d,e){var f=0,g=0,h=function(c,d){a("[data-region=\"managecompetencies\"]").replaceWith(c);b.runTemplateJS(d)},i=function(a){b.render("tool_lp/manage_competency_frameworks_page",a).done(h).fail(d.exception)},j=function(b){b.preventDefault();g=a(this).attr("data-frameworkid");var e=c.call([{methodname:"core_competency_duplicate_competency_framework",args:{id:g}},{methodname:"tool_lp_data_for_competency_frameworks_manage_page",args:{pagecontext:{contextid:f}}}]);e[1].done(i).fail(d.exception)},k=function(){var a=c.call([{methodname:"core_competency_delete_competency_framework",args:{id:g}},{methodname:"tool_lp_data_for_competency_frameworks_manage_page",args:{pagecontext:{contextid:f}}}]);a[0].done(function(a){if(!1===a){var b=c.call([{methodname:"core_competency_read_competency_framework",args:{id:g}}]);b[0].done(function(a){e.get_strings([{key:"frameworkcannotbedeleted",component:"tool_lp",param:a.shortname},{key:"cancel",component:"moodle"}]).done(function(a){d.alert(null,a[0])}).fail(d.exception)})}}).fail(d.exception);a[1].done(i).fail(d.exception)},l=function(b){b.preventDefault();var f=a(this).attr("data-frameworkid");g=f;var h=c.call([{methodname:"core_competency_read_competency_framework",args:{id:g}}]);h[0].done(function(a){e.get_strings([{key:"confirm",component:"moodle"},{key:"deletecompetencyframework",component:"tool_lp",param:a.shortname},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],k)}).fail(d.exception)}).fail(d.exception)};return{deleteHandler:l,duplicateHandler:j,init:function init(a){f=a}}});
define ("tool_lp/competency_plan_navigation",["jquery"],function(a){var b=function(b,c,d,e,f){this._baseUrl=c;this._userId=d+"";this._competencyId=e+"";this._planId=f;this._ignoreFirstCompetency=!0;a(b).on("change",this._competencyChanged.bind(this))};b.prototype._competencyChanged=function(b){if(this._ignoreFirstCompetency){this._ignoreFirstCompetency=!1;return}var c=a(b.target).val(),d="?userid="+this._userId+"&planid="+this._planId+"&competencyid="+c;document.location=this._baseUrl+d};b.prototype._competencyId=null;b.prototype._userId=null;b.prototype._planId=null;b.prototype._baseUrl=null;b.prototype._ignoreFirstCompetency=null;return b});
define ("tool_lp/scalevalues",["jquery","core/ajax"],function(a,b){var c=[];return{get_values:function get_values(d){var e=a.Deferred();if("undefined"==typeof c[d]){b.call([{methodname:"core_competency_get_scale_values",args:{scaleid:d},done:function done(a){c[d]=a;e.resolve(a)},fail:e.reject}])}else{e.resolve(c[d])}return e.promise()}}});
define ("tool_lp/competency_rule",["jquery"],function(a){var b=function(b){this._eventNode=a("<div>");this._ready=a.Deferred();this._tree=b};b.prototype._competency=null;b.prototype._eventNode=null;b.prototype._ready=null;b.prototype._tree=null;b.prototype.canConfig=function(){return this._tree.hasChildren(this._competency.id)};b.prototype.getConfig=function(){return null};b.prototype.getType=function(){throw new Error("Not implemented")};b.prototype.init=function(){return this._load()};b.prototype.injectTemplate=function(){return a.Deferred().reject().promise()};b.prototype.isValid=function(){return!1};b.prototype._load=function(){return a.when()};b.prototype.on=function(a,b){this._eventNode.on(a,b)};b.prototype.setTargetCompetency=function(a){this._competency=a};b.prototype._trigger=function(a,b){this._eventNode.trigger(a,[b])};b.prototype._triggerChange=function(){this._trigger("change",this)};return b});
define ("tool_lp/templateactions",["jquery","core/templates","core/ajax","core/notification","core/str","tool_lp/actionselector"],function(a,b,c,d,e,f){var g=0,h=0,i=!0,j=function(c,d){a("[data-region=\"managetemplates\"]").replaceWith(c);b.runTemplateJS(d)},k=function(a){b.render("tool_lp/manage_templates_page",a).done(j).fail(d.exception)},l=function(){var a=c.call([{methodname:"core_competency_delete_template",args:{id:h,deleteplans:i}},{methodname:"tool_lp_data_for_templates_manage_page",args:{pagecontext:{contextid:g}}}]);a[1].done(k).fail(d.exception)},m=function(b){b.preventDefault();h=a(this).attr("data-templateid");var e=c.call([{methodname:"core_competency_duplicate_template",args:{id:h}},{methodname:"tool_lp_data_for_templates_manage_page",args:{pagecontext:{contextid:g}}}]);e[1].done(k).fail(d.exception)},n=function(b){b.preventDefault();var g=a(this).attr("data-templateid");h=g;i=!0;var j=c.call([{methodname:"core_competency_read_template",args:{id:h}},{methodname:"core_competency_template_has_related_data",args:{id:h}}]);j[0].done(function(a){j[1].done(function(b){if(b){e.get_strings([{key:"deletetemplate",component:"tool_lp",param:a.shortname},{key:"deletetemplatewithplans",component:"tool_lp"},{key:"deleteplans",component:"tool_lp"},{key:"unlinkplanstemplate",component:"tool_lp"},{key:"confirm",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(a){var b=[{text:a[2],value:"delete"},{text:a[3],value:"unlink"}],c=new f(a[0],a[1],b,a[4],a[5]);c.display();c.on("save",function(a,b){if("delete"!=b.action){i=!1}l()})}).fail(d.exception)}else{e.get_strings([{key:"confirm",component:"moodle"},{key:"deletetemplate",component:"tool_lp",param:a.shortname},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],l)}).fail(d.exception)}}).fail(d.exception)}).fail(d.exception)};return{deleteHandler:n,duplicateHandler:m,init:function init(a){g=a}}});
define ("tool_lp/competency_rule_all",["jquery","core/str","tool_lp/competency_rule"],function(a,b,c){var d=function(){c.apply(this,arguments)};d.prototype=Object.create(c.prototype);d.prototype.getType=function(){return"core_competency\\competency_rule_all"};d.prototype.isValid=function(){return!0};return d});
define ("tool_lp/frameworks_datasource",["jquery","core/ajax","core/notification"],function(a,b,c){return{list:function list(c,d){var e={context:{contextid:c}};a.extend(e,"undefined"==typeof d?{}:d);return b.call([{methodname:"core_competency_list_competency_frameworks",args:e}])[0]},processResults:function processResults(b,c){var d=[];a.each(c,function(a,b){d.push({value:b.id,label:b.shortname+" "+b.idnumber})});return d},transport:function transport(b,d,e){var f=a(b),g=f.data("contextid"),h=f.data("onlyvisible");if(!g){throw new Error("The attribute data-contextid is required on "+b)}this.list(g,{query:d,onlyvisible:h}).then(e).catch(c.exception)}}});
define ("tool_lp/competency_rule_points",["jquery","core/str","core/templates","tool_lp/competency_rule"],function(a,b,c,d){var e=function(){d.apply(this,arguments)};e.prototype=Object.create(d.prototype);e.prototype._container=null;e.prototype._templateLoaded=!1;e.prototype.getConfig=function(){return JSON.stringify({base:{points:this._getRequiredPoints()},competencies:this._getCompetenciesConfig()})};e.prototype._getCompetenciesConfig=function(){var b=[];this._container.find("[data-competency]").each(function(){var c=a(this),d=c.data("competency"),e=parseInt(c.find("[name=\"points\"]").val(),10),f=c.find("[name=\"required\"]").prop("checked");b.push({id:d,points:e,required:f?1:0})});return b};e.prototype._getRequiredPoints=function(){return parseInt(this._container.find("[name=\"requiredpoints\"]").val()||1,10)};e.prototype.getType=function(){return"core_competency\\competency_rule_points"};e.prototype.injectTemplate=function(b){var d=this,e=this._tree.getChildren(this._competency.id),f,g={base:{points:2},competencies:[]};this._templateLoaded=!1;if(d._competency.ruletype==d.getType()){try{g=JSON.parse(d._competency.ruleconfig)}catch(a){}}f={requiredpoints:g&&g.base?g.base.points:2,competency:d._competency,children:[]};a.each(e,function(b,c){var d={id:c.id,shortname:c.shortname,required:!1,points:0};if(g){a.each(g.competencies,function(a,b){if(b.id==d.id){d.required=b.required?!0:!1;d.points=b.points}})}f.children.push(d)});return c.render("tool_lp/competency_rule_points",f).then(function(a){d._container=b;b.html(a);b.find("input").change(function(){d._triggerChange()});d._templateLoaded=!0;d._triggerChange()})};e.prototype.isValid=function(){if(!this._templateLoaded){return!1}var b=this._getRequiredPoints(),c=0,d=!0;a.each(this._getCompetenciesConfig(),function(a,b){if(0>b.points){d=!1}c+=b.points});d=d&&c>=b;return d};return e});
define ("tool_lp/grade_dialogue",["jquery","core/notification","core/templates","tool_lp/dialogue","tool_lp/event_base","core/str"],function(a,b,c,d,e,f){var g=function(a){e.prototype.constructor.apply(this,[]);this._ratingOptions=a};g.prototype=Object.create(e.prototype);g.prototype._popup=null;g.prototype._ratingOptions=null;g.prototype._afterRender=function(){var b=this._find("[data-action=\"rate\"]"),c=this._find("[name=\"rating\"]"),d=this._find("[name=\"comment\"]");this._find("[data-action=\"cancel\"]").click(function(a){a.preventDefault();this._trigger("cancelled");this.close()}.bind(this));c.change(function(){var c=a(this);if(!c.val()){b.prop("disabled",!0)}else{b.prop("disabled",!1)}}).change();b.click(function(a){a.preventDefault();var b=c.val();if(!b){return}this._trigger("rated",{rating:b,note:d.val()});this.close()}.bind(this))};g.prototype.close=function(){this._popup.close();this._popup=null};g.prototype.display=function(){M.util.js_pending("tool_lp/grade_dialogue:display");return a.when(f.get_string("rate","tool_lp"),this._render()).then(function(a,b){this._popup=new d(a,b[0],function(){this._afterRender();M.util.js_complete("tool_lp/grade_dialogue:display")}.bind(this));return this._popup}.bind(this)).catch(b.exception)};g.prototype._find=function(b){return a(this._popup.getContent()).find(b)};g.prototype._render=function(){var a={cangrade:this._canGrade,ratings:this._ratingOptions};return c.render("tool_lp/competency_grader",a)};return g});
define ("tool_lp/tree",["jquery","core/url","core/log"],function(a,b,c){var d=a("<img alt=\"\" src=\""+b.imageUrl("t/expanded")+"\"/>"),e=a("<img alt=\"\" src=\""+b.imageUrl("t/collapsed")+"\"/>"),f=function(b,c){this.treeRoot=a(b);this.multiSelect="undefined"==typeof c||!0===c;this.items=this.treeRoot.find("li");this.expandAll=20>this.items.length;this.parents=this.treeRoot.find("li:has(ul)");if(c){this.treeRoot.attr("aria-multiselectable","true")}this.items.attr("aria-selected","false");this.visibleItems=null;this.activeItem=null;this.lastActiveItem=null;this.keys={tab:9,enter:13,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,eight:56,asterisk:106};this.init();this.bindEventHandlers()};f.prototype.init=function(){this.parents.attr("aria-expanded","true");this.parents.prepend(d.clone());this.items.attr("role","tree-item");this.items.attr("tabindex","-1");this.parents.attr("role","group");this.treeRoot.attr("role","tree");this.visibleItems=this.treeRoot.find("li");var b=this;if(!this.expandAll){this.parents.each(function(){b.collapseGroup(a(this))});this.expandGroup(this.parents.first())}};f.prototype.expandGroup=function(a){var b=a.children("ul");b.show().attr("aria-hidden","false");a.attr("aria-expanded","true");a.children("img").attr("src",d.attr("src"));this.visibleItems=this.treeRoot.find("li:visible")};f.prototype.collapseGroup=function(a){var b=a.children("ul");b.hide().attr("aria-hidden","true");a.attr("aria-expanded","false");a.children("img").attr("src",e.attr("src"));this.visibleItems=this.treeRoot.find("li:visible")};f.prototype.toggleGroup=function(a){if("true"==a.attr("aria-expanded")){this.collapseGroup(a)}else{this.expandGroup(a)}};f.prototype.triggerChange=function(){var a=this.items.filter("[aria-selected=true]");if(!this.multiSelect){a=a.first()}this.treeRoot.trigger("selectionchanged",{selected:a})};f.prototype.multiSelectItem=function(b){if(!this.multiSelect){this.items.attr("aria-selected","false")}else if(null!==this.lastActiveItem){var c=this.visibleItems.index(this.lastActiveItem),d=this.visibleItems.index(this.activeItem),e=null;while(c<d){e=a(this.visibleItems.get(c));e.attr("aria-selected","true");c++}while(c>d){e=a(this.visibleItems.get(c));e.attr("aria-selected","true");c--}}b.attr("aria-selected","true");this.triggerChange()};f.prototype.selectItem=function(a){var b=a.parent();while("tree"!=b.attr("role")){b=b.parent();if("false"==b.attr("aria-expanded")){this.expandGroup(b)}b=b.parent()}this.items.attr("aria-selected","false");a.attr("aria-selected","true");this.triggerChange()};f.prototype.toggleItem=function(a){if(!this.multiSelect){this.selectItem(a);return}var b=a.attr("aria-selected");if("true"===b){b="false"}else{b="true"}a.attr("aria-selected",b);this.triggerChange()};f.prototype.updateFocus=function(a){this.lastActiveItem=this.activeItem;this.activeItem=a;var b=a.parent();while("tree"!=b.attr("role")){b=b.parent();if("false"==b.attr("aria-expanded")){this.expandGroup(b)}b=b.parent()}this.items.attr("tabindex","-1");a.attr("tabindex",0)};f.prototype.handleKeyDown=function(b,c){var d=this.visibleItems.index(b),e=null,f=c.shiftKey||c.ctrlKey||c.metaKey||c.altKey,g=this;switch(c.keyCode){case this.keys.home:{e=this.parents.first();e.focus();if(c.shiftKey){this.multiSelectItem(e)}else if(!f){this.selectItem(e)}c.stopPropagation();return!1}case this.keys.end:{e=this.visibleItems.last();e.focus();if(c.shiftKey){this.multiSelectItem(e)}else if(!f){this.selectItem(e)}c.stopPropagation();return!1}case this.keys.enter:case this.keys.space:{if(c.shiftKey){this.multiSelectItem(b)}else if(c.metaKey||c.ctrlKey){this.toggleItem(b)}else{this.selectItem(b)}c.stopPropagation();return!1}case this.keys.left:{if(b.has("ul")&&"true"==b.attr("aria-expanded")){this.collapseGroup(b)}else{var h=b.parent(),i=h.parent();if(i.is("li")){i.focus();if(c.shiftKey){this.multiSelectItem(i)}else if(!f){this.selectItem(i)}}}c.stopPropagation();return!1}case this.keys.right:{if(b.has("ul")&&"false"==b.attr("aria-expanded")){this.expandGroup(b)}else{e=b.children("ul").children("li").first();if(0<e.length){e.focus();if(c.shiftKey){this.multiSelectItem(e)}else if(!f){this.selectItem(e)}}}c.stopPropagation();return!1}case this.keys.up:{if(0<d){var j=this.visibleItems.eq(d-1);j.focus();if(c.shiftKey){this.multiSelectItem(j)}else if(!f){this.selectItem(j)}}c.stopPropagation();return!1}case this.keys.down:{if(d<this.visibleItems.length-1){var k=this.visibleItems.eq(d+1);k.focus();if(c.shiftKey){this.multiSelectItem(k)}else if(!f){this.selectItem(k)}}c.stopPropagation();return!1}case this.keys.asterisk:{this.parents.each(function(){g.expandGroup(a(this))});c.stopPropagation();return!1}case this.keys.eight:{if(c.shiftKey){this.parents.each(function(){g.expandGroup(a(this))});c.stopPropagation()}return!1}}return!0};f.prototype.handleKeyPress=function(a,b){if(b.altKey||b.ctrlKey||b.shiftKey||b.metaKey){return!0}switch(b.keyCode){case this.keys.tab:{return!0}case this.keys.enter:case this.keys.home:case this.keys.end:case this.keys.left:case this.keys.right:case this.keys.up:case this.keys.down:{b.stopPropagation();return!1}default:{var c=String.fromCharCode(b.which),d=!1,e=this.visibleItems.index(a),f=this.visibleItems.length,g=e+1;if(g==f){g=0}while(g!=e){var h=this.visibleItems.eq(g),i=h.text().charAt(0);if(h.has("ul")){i=h.find("span").text().charAt(0)}if(i.toLowerCase()==c){d=!0;break}g=g+1;if(g==f){g=0}}if(!0===d){this.updateFocus(this.visibleItems.eq(g))}b.stopPropagation();return!1}}return!0};f.prototype.on=function(a,b){if("selectionchanged"!==a){c.warning("Invalid custom event name for tree. Only \"selectionchanged\" is supported.")}else{this.treeRoot.on(a,b)}};f.prototype.handleDblClick=function(a,b){if(b.altKey||b.ctrlKey||b.shiftKey||b.metaKey){return!0}this.updateFocus(a);this.toggleGroup(a);b.stopPropagation();return!1};f.prototype.handleExpandCollapseClick=function(a,b){this.toggleGroup(a);b.stopPropagation();return!1};f.prototype.handleClick=function(a,b){if(b.shiftKey){this.multiSelectItem(a)}else if(b.metaKey||b.ctrlKey){this.toggleItem(a)}else{this.selectItem(a)}this.updateFocus(a);b.stopPropagation();return!1};f.prototype.handleBlur=function(){return!0};f.prototype.handleFocus=function(a){this.updateFocus(a);return!0};f.prototype.bindEventHandlers=function(){var b=this;this.parents.dblclick(function(c){return b.handleDblClick(a(this),c)});this.items.click(function(c){return b.handleClick(a(this),c)});this.items.children("img").click(function(c){return b.handleExpandCollapseClick(a(this).parent(),c)});this.items.keydown(function(c){return b.handleKeyDown(a(this),c)});this.items.keypress(function(c){return b.handleKeyPress(a(this),c)});this.items.focus(function(c){return b.handleFocus(a(this),c)});this.items.blur(function(c){return b.handleBlur(a(this),c)})};return f});
define ("tool_lp/competencyactions",["jquery","core/url","core/templates","core/notification","core/str","core/ajax","tool_lp/dragdrop-reorder","tool_lp/tree","tool_lp/dialogue","tool_lp/menubar","tool_lp/competencypicker","tool_lp/competency_outcomes","tool_lp/competencyruleconfig","core/pending"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=null,p=null,q=null,r,s,t,u,v,w,x=null,y=function(){var c=a("[data-region=\"competencyactions\"]").data("competency"),f={competencyframeworkid:o.getCompetencyFrameworkId(),pagecontextid:r};if(null!==c){f.parentid=c.id}var g=function(){var c=a.param(f);window.location=b.relativeUrl("/admin/tool/lp/editcompetency.php?"+c)};if(null!==c&&o.hasRule(c.id)){e.get_strings([{key:"confirm",component:"moodle"},{key:"addingcompetencywillresetparentrule",component:"tool_lp",param:c.shortname},{key:"yes",component:"core"},{key:"no",component:"core"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],g)}).fail(d.exception)}else{g()}},z=function(){var b=a("[data-region=\"filtercompetencies\"]").data("frameworkid"),c=f.call([{methodname:"core_competency_set_parent_competency",args:{competencyid:p,parentid:q}},{methodname:"tool_lp_data_for_competencies_manage_page",args:{competencyframeworkid:b,search:a("[data-region=\"filtercompetencies\"] input").val()}}]);c[1].done(F).fail(d.exception)},A=function(){q="undefined"==typeof q?0:q;if(q==p){return}var a=o.getCompetency(q)||{},b=o.getCompetency(p)||{},c="movecompetencywillresetrules",f=!1;if(b.parentid==q){return}if(a.path&&0<=a.path.indexOf("/"+b.id+"/")){c="movecompetencytochildofselfwillresetrules";f=f||o.hasRule(b.id)}f=f||o.hasRule(a.id)||o.hasRule(b.parentid);if(f){e.get_strings([{key:"confirm",component:"moodle"},{key:c,component:"tool_lp"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],z)}).fail(d.exception)}else{z()}},B=function(b){var c=a(b.getContent()),d=c.find("[data-enhance=movetree]"),e=new h(d,!1);e.on("selectionchanged",function(b,c){var d=c.selected;q=a(d).data("id")});d.show();c.on("click","[data-action=\"move\"]",function(){b.close();A()});c.on("click","[data-action=\"cancel\"]",function(){b.close()})},C=function(a,b){var c;for(c=0;c<b.length;c++){if(b[c].parentid==a.id){a.haschildren=!0;b[c].children=[];b[c].haschildren=!1;a.children[a.children.length]=b[c];C(b[c],b)}}},D=function(b){b.preventDefault();var g=a("[data-region=\"competencyactions\"]").data("competency");p=g.id;var h=f.call([{methodname:"core_competency_search_competencies",args:{competencyframeworkid:g.competencyframeworkid,searchtext:""}},{methodname:"core_competency_read_competency_framework",args:{id:g.competencyframeworkid}}]);a.when.apply(null,h).done(function(a,b){var f,h=[];for(f=0;f<a.length;f++){var j=a[f];if("0"==j.parentid){j.children=[];j.haschildren=0;h[h.length]=j;C(j,a)}}e.get_strings([{key:"movecompetency",component:"tool_lp",param:g.shortname},{key:"move",component:"tool_lp"},{key:"cancel",component:"moodle"}]).done(function(a){c.render("tool_lp/competencies_move_tree",{framework:b,competencies:h}).done(function(b){new i(a[0],b,B)}).fail(d.exception)}).fail(d.exception)}).fail(d.exception)},E=function(){var c=a("[data-region=\"competencyactions\"]").data("competency"),d={competencyframeworkid:o.getCompetencyFrameworkId(),id:c.id,parentid:c.parentid,pagecontextid:r},e=a.param(d);window.location=b.relativeUrl("/admin/tool/lp/editcompetency.php?"+e)},F=function(b){c.render("tool_lp/manage_competencies_page",b).done(function(b,d){a("[data-region=\"managecompetencies\"]").replaceWith(b);c.runTemplateJS(d)}).fail(d.exception)},G=function(b){b.preventDefault();var c=a("[data-region=\"filtercompetencies\"]").data("frameworkid"),e=f.call([{methodname:"tool_lp_data_for_competencies_manage_page",args:{competencyframeworkid:c,search:a("[data-region=\"filtercompetencies\"] input").val()}}]);e[0].done(F).fail(d.exception)},H=function(){var b=a("[data-region=\"competencyactions\"]").data("competency"),c=f.call([{methodname:"core_competency_move_up_competency",args:{id:b.id}},{methodname:"tool_lp_data_for_competencies_manage_page",args:{competencyframeworkid:b.competencyframeworkid,search:a("[data-region=\"filtercompetencies\"] input").val()}}]);c[1].done(F).fail(d.exception)},I=function(){var b=a("[data-region=\"competencyactions\"]").data("competency"),c=f.call([{methodname:"core_competency_move_down_competency",args:{id:b.id}},{methodname:"tool_lp_data_for_competencies_manage_page",args:{competencyframeworkid:b.competencyframeworkid,search:a("[data-region=\"filtercompetencies\"] input").val()}}]);c[1].done(F).fail(d.exception)},J=function(){var b=a("[data-region=\"competencyactions\"]").data("competency"),g=f.call([{methodname:"tool_lp_list_courses_using_competency",args:{id:b.id}}]);g[0].done(function(a){c.render("tool_lp/linked_courses_summary",{courses:a}).done(function(a){e.get_string("linkedcourses","tool_lp").done(function(b){new i(b,a,B)}).fail(d.exception)}).fail(d.exception)}).fail(d.exception)},K=function(){u=a("[data-region=\"competencyactions\"]").data("competency");if(!s){s=new k(r,u.competencyframeworkid);s.on("save",function(b,e){var g=new n,h=e.competencyIds,i=[];a.each(h,function(a,b){i.push({methodname:"core_competency_add_related_competency",args:{competencyid:b,relatedcompetencyid:u.id}})});i.push({methodname:"tool_lp_data_for_related_competencies_section",args:{competencyid:u.id}});var j=f.call(i);j[i.length-1].then(function(a){return c.render("tool_lp/related_competencies",a)}).then(function(b,d){a("[data-region=\"relatedcompetencies\"]").replaceWith(b);c.runTemplateJS(d);V()}).then(g.resolve).catch(d.exception)})}s.setDisallowedCompetencyIDs([u.id]);s.display()},L=function(b){b.preventDefault();u=a("[data-region=\"competencyactions\"]").data("competency");t.setTargetCompetencyId(u.id);t.display()},M=function(a,b){var c={id:u.id,shortname:u.shortname,idnumber:u.idnumber,description:u.description,descriptionformat:u.descriptionformat,ruletype:b.ruletype,ruleoutcome:b.ruleoutcome,ruleconfig:b.ruleconfig},e=f.call([{methodname:"core_competency_update_competency",args:{competency:c}}]);e[0].then(function(a){if(a){u.ruletype=b.ruletype;u.ruleoutcome=b.ruleoutcome;u.ruleconfig=b.ruleconfig;Y(u)}}).catch(d.exception)},N=function(){var b=a("[data-region=\"competencyactions\"]").data("competency"),c=f.call([{methodname:"core_competency_delete_competency",args:{id:b.id}},{methodname:"tool_lp_data_for_competencies_manage_page",args:{competencyframeworkid:b.competencyframeworkid,search:a("[data-region=\"filtercompetencies\"] input").val()}}]);c[0].done(function(a){if(!1===a){e.get_strings([{key:"competencycannotbedeleted",component:"tool_lp",param:b.shortname},{key:"cancel",component:"moodle"}]).done(function(a){d.alert(null,a[0])}).fail(d.exception)}}).fail(d.exception);c[1].done(F).fail(d.exception)},O=function(){var b=a("[data-region=\"competencyactions\"]").data("competency"),c="deletecompetency";if(o.hasRule(b.parentid)){c="deletecompetencyparenthasrule"}e.get_strings([{key:"confirm",component:"moodle"},{key:c,component:"tool_lp",param:b.shortname},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],N)}).fail(d.exception)},P=function(b){b.originalEvent.dataTransfer.setData("text",a(b.target).parent().data("id"))},Q=function(a){a.originalEvent.dataTransfer.dropEffect="move";a.preventDefault()},R=function(b){b.preventDefault();a(this).addClass("currentdragtarget")},S=function(b){b.preventDefault();a(this).removeClass("currentdragtarget")},T=function(b){b.preventDefault();p=b.originalEvent.dataTransfer.getData("text");q=a(b.target).parent().data("id");a(this).removeClass("currentdragtarget");A()},U=function(b){b.preventDefault();var e=this.id.substr(11),g=a("[data-region=\"competencyactions\"]").data("competency"),h=f.call([{methodname:"core_competency_remove_related_competency",args:{relatedcompetencyid:e,competencyid:g.id}},{methodname:"tool_lp_data_for_related_competencies_section",args:{competencyid:g.id}}]);h[1].done(function(b){c.render("tool_lp/related_competencies",b).done(function(b){a("[data-region=\"relatedcompetencies\"]").replaceWith(b);V()}).fail(d.exception)}).fail(d.exception)},V=function(){a("[data-action=\"deleterelation\"]").on("click",U)},W=function(a){if(a.id!==x){x=a.id;f.call([{methodname:"core_competency_competency_viewed",args:{id:a.id}}])}},X=function(a){var b=v[a];if(!b){b="competency"}return b},Y=function(e){var g=a.Deferred().resolve().promise(),h={};h.competency=e;h.showdeleterelatedaction=!0;h.showrelatedcompetencies=!0;h.showrule=!1;h.pluginbaseurl=b.relativeUrl("/admin/tool/lp");if(e.ruleoutcome!=l.NONE){g=l.getString(e.ruleoutcome).then(function(b){var c;a.each(w,function(a,b){if(b.type==e.ruletype){c=b.name}});return[b,c]})}g.then(function(a){if("undefined"!=typeof a){h.showrule=!0;h.rule={outcome:a[0],type:a[1]}}return h}).then(function(a){return c.render("tool_lp/competency_summary",a)}).then(function(b){a("[data-region=\"competencyinfo\"]").html(b);a("[data-action=\"deleterelation\"]").on("click",U);return c.render("tool_lp/loading",{})}).then(function(a,b){c.replaceNodeContents("[data-region=\"relatedcompetencies\"]",a,b);return f.call([{methodname:"tool_lp_data_for_related_competencies_section",args:{competencyid:e.id}}])[0]}).then(function(a){return c.render("tool_lp/related_competencies",a)}).then(function(b,d){a("[data-region=\"relatedcompetencies\"]").replaceWith(b);c.runTemplateJS(d);V()}).catch(d.exception)},Z=function(a){return e.get_string("taxonomy_add_"+X(a),"tool_lp")},$=function(a){return e.get_string("taxonomy_selected_"+X(a),"tool_lp")},_=function(b,c){var e=c.selected,f=a(e).data("id"),g=a("[data-region=\"competencyactions\"] [data-action=\"add\"]"),h=a("[data-region=\"competencyactionsmenu\"]"),i=a("[data-region=\"selected-competency\"]"),k=0,l=1;j.closeAll();if("undefined"==typeof f){a("[data-region=\"competencyinfo\"]").html(e.clone().children().remove().end().text());a("[data-region=\"competencyactions\"]").data("competency",null);h.hide()}else{var m=o.getCompetency(f);k=o.getCompetencyLevel(f);l=k+1;h.show();a("[data-region=\"competencyactions\"]").data("competency",m);Y(m);W(m)}$(k).then(function(a){i.text(a)}).catch(d.exception);Z(l).then(function(a){g.show().find("[data-region=\"term\"]").text(a)}).catch(d.exception);b.preventDefault();return!1},aa=function(a){var b=a.split(",");b.unshift("");delete b[0];return b};return{init:function init(b,c,d,e){o=b;r=c;v=aa(d);w=e;a("[data-region=\"competencyactions\"] [data-action=\"add\"]").on("click",y);j.enhance(".competencyactionsmenu",{'[data-action="edit"]':E,'[data-action="delete"]':O,'[data-action="move"]':D,'[data-action="moveup"]':H,'[data-action="movedown"]':I,'[data-action="linkedcourses"]':J,'[data-action="relatedcompetencies"]':K.bind(this),'[data-action="competencyrules"]':L.bind(this)});a("[data-region=\"competencyactionsmenu\"]").hide();a("[data-region=\"competencyactions\"] [data-action=\"add\"]").hide();a("[data-region=\"filtercompetencies\"]").on("submit",G);var f=a("[data-region=\"managecompetencies\"] [data-enhance=\"tree\"]");f.on("dragstart","li>span",P).on("dragover","li>span",Q).on("dragenter","li>span",R).on("dragleave","li>span",S).on("drop","li>span",T);b.on("selectionchanged",_);t=new m(o,w);t.on("save",M.bind(this))}}});
define ("tool_lp/user_competency_info",["jquery","core/notification","core/ajax","core/templates"],function(a,b,c,d){var e=function(a,b,c,d,e,f){this._rootElement=a;this._competencyId=b;this._userId=c;this._planId=d;this._courseId=e;this._valid=!0;this._displayuser="undefined"!=typeof f?f:!1;if(this._planId){this._methodName="tool_lp_data_for_user_competency_summary_in_plan";this._args={competencyid:this._competencyId,planid:this._planId};this._templateName="tool_lp/user_competency_summary_in_plan"}else if(this._courseId){this._methodName="tool_lp_data_for_user_competency_summary_in_course";this._args={userid:this._userId,competencyid:this._competencyId,courseid:this._courseId};this._templateName="tool_lp/user_competency_summary_in_course"}else{this._methodName="tool_lp_data_for_user_competency_summary";this._args={userid:this._userId,competencyid:this._competencyId};this._templateName="tool_lp/user_competency_summary"}};e.prototype.reload=function(){var a=this,e=[];if(!this._valid){return}e=c.call([{methodname:this._methodName,args:this._args}]);e[0].done(function(c){if(a._displayuser){c.displayuser=!0}d.render(a._templateName,c).done(function(b,c){d.replaceNode(a._rootElement,b,c)}).fail(b.exception)}).fail(b.exception)};e.prototype._rootElement=null;e.prototype._courseId=null;e.prototype._valid=null;e.prototype._planId=null;e.prototype._competencyId=null;e.prototype._userId=null;e.prototype._methodName=null;e.prototype._args=null;e.prototype._templateName=null;e.prototype._displayuser=!1;return e});
define ("tool_lp/competencydialogue",["jquery","core/notification","core/ajax","core/templates","core/str","tool_lp/dialogue"],function(a,b,c,d,e,f){var g,h=function(){};h.prototype.triggerCompetencyViewedEvent=function(a){c.call([{methodname:"core_competency_competency_viewed",args:{id:a}}])};h.prototype.showDialogue=function(a,c){var e=this.getCompetencyDataPromise(a,c),g=this;e.done(function(c){d.render("tool_lp/competency_summary",c).done(function(b){g.triggerCompetencyViewedEvent(a);new f(c.competency.shortname,b)}).fail(b.exception)}).fail(b.exception)};h.prototype.showDialogueFromData=function(a){var c=this;d.render("tool_lp/competency_summary",a).done(function(b){c.triggerCompetencyViewedEvent(a.id);new f(a.shortname,b,c.enhanceDialogue)}).fail(b.exception)};h.prototype.clickEventHandler=function(b){var c=b.data.compdialogue,d=a(b.currentTarget),e=d.data("id"),f=!d.data("excluderelated"),g=d.data("includecourses");c.showDialogue(e,{includerelated:f,includecourses:g});b.preventDefault()};h.prototype.getCompetencyDataPromise=function(a,d){var e=c.call([{methodname:"tool_lp_data_for_competency_summary",args:{competencyid:a,includerelated:d.includerelated||!1,includecourses:d.includecourses||!1}}]);return e[0].then(function(a){return a}).fail(b.exception)};return{init:function init(){if("undefined"!=typeof g){return}g=new h;a("body").delegate("[data-action=\"competency-dialogue\"]","click",{compdialogue:g},g.clickEventHandler.bind(g))}}});
define ("tool_lp/user_competency_plan_popup",["jquery","core/notification","core/str","core/ajax","core/templates","tool_lp/dialogue"],function(a,b,c,d,e,f){var g=function(b,c,d){this._regionSelector=b;this._userCompetencySelector=c;this._planId=d;a(this._regionSelector).on("click",this._userCompetencySelector,this._handleClick.bind(this))};g.prototype._handleClick=function(c){c.preventDefault();var e=a(c.target).closest("tr"),f=a(e).data("competencyid"),g=a(e).data("userid"),h=this._planId,i=d.call([{methodname:"tool_lp_data_for_user_competency_summary_in_plan",args:{competencyid:f,planid:h},done:this._contextLoaded.bind(this),fail:b.exception}]);i[0].then(function(a){var b="core_competency_user_competency_viewed_in_plan";if(a.plan.iscompleted){b="core_competency_user_competency_plan_viewed"}return d.call([{methodname:b,args:{competencyid:f,userid:g,planid:h}}])[0]}).catch(b.exception)};g.prototype._contextLoaded=function(a){var d=this;e.render("tool_lp/user_competency_summary_in_plan",a).done(function(a,g){c.get_string("usercompetencysummary","report_competency").done(function(b){new f(b,a,e.runTemplateJS.bind(e,g),d._refresh.bind(d),!0)}).fail(b.exception)}).fail(b.exception)};g.prototype._refresh=function(){var a=this._planId;d.call([{methodname:"tool_lp_data_for_plan_page",args:{planid:a},done:this._pageContextLoaded.bind(this),fail:b.exception}])};g.prototype._pageContextLoaded=function(a){var c=this;e.render("tool_lp/plan_page",a).done(function(a,b){e.replaceNode(c._regionSelector,a,b)}).fail(b.exception)};g.prototype._regionSelector=null;g.prototype._userCompetencySelector=null;g.prototype._planId=null;return g});
define ("tool_lp/competencypicker",["jquery","core/notification","core/ajax","core/templates","tool_lp/dialogue","core/str","tool_lp/tree","core/pending"],function(a,b,c,d,e,f,g,h){var i=function(b,c,d,e){var f=this;f._eventNode=a("<div></div>");f._frameworks=[];f._reset();f._pageContextId=b;f._pageContextIncludes=d||"children";f._multiSelect="undefined"==typeof e||!0===e;if(c){f._frameworkId=c;f._singleFramework=!0}};i.prototype._competencies=null;i.prototype._disallowedCompetencyIDs=null;i.prototype._eventNode=null;i.prototype._frameworks=null;i.prototype._frameworkId=null;i.prototype._pageContextId=null;i.prototype._pageContextIncludes=null;i.prototype._popup=null;i.prototype._searchText="";i.prototype._selectedCompetencies=null;i.prototype._singleFramework=!1;i.prototype._multiSelect=!0;i.prototype._onlyVisible=!0;i.prototype._afterRender=function(){var c=this,d=new g(c._find("[data-enhance=linktree]"),c._multiSelect);c._find("[data-enhance=linktree]").show();d.on("selectionchanged",function(b,d){var e=d.selected;b.preventDefault();var f=[];a.each(e,function(b,d){var e=a(d).data("id"),g=!0;if("undefined"==typeof e){g=!1}else{a.each(c._disallowedCompetencyIDs,function(a,b){if(b==e){g=!1}})}if(g){f.push(e)}});c._selectedCompetencies=f;if(!c._selectedCompetencies.length){c._find("[data-region=\"competencylinktree\"] [data-action=\"add\"]").attr("disabled","disabled")}else{c._find("[data-region=\"competencylinktree\"] [data-action=\"add\"]").removeAttr("disabled")}});if(!c._singleFramework){c._find("[data-action=\"chooseframework\"]").change(function(d){c._frameworkId=a(d.target).val();c._loadCompetencies().then(c._refresh.bind(c)).catch(b.exception)})}c._find("[data-region=\"filtercompetencies\"] button").click(function(b){b.preventDefault();a(b.target).attr("disabled","disabled");c._searchText=c._find("[data-region=\"filtercompetencies\"] input").val()||"";return c._refresh().always(function(){a(b.target).removeAttr("disabled")})});c._find("[data-region=\"competencylinktree\"] [data-action=\"cancel\"]").click(function(a){a.preventDefault();c.close()});c._find("[data-region=\"competencylinktree\"] [data-action=\"add\"]").click(function(a){a.preventDefault();var b=new h;if(!c._selectedCompetencies.length){return}if(c._multiSelect){c._trigger("save",{competencyIds:c._selectedCompetencies})}else{c._trigger("save",{competencyId:c._selectedCompetencies[0]})}c.close();b.resolve()});var e=c._selectedCompetencies.slice(0);a.each(e,function(a,b){var e=c._find("[data-id="+b+"]");if(e.length){d.toggleItem(e);d.updateFocus(e)}})};i.prototype.close=function(){var a=this;a._popup.close();a._reset()};i.prototype.display=function(){var c=this;return a.when(f.get_string("competencypicker","tool_lp"),c._render()).then(function(a,b){c._popup=new e(a,b[0],c._afterRender.bind(c))}).catch(b.exception)};i.prototype._fetchCompetencies=function(a,d){var e=this;return c.call([{methodname:"core_competency_search_competencies",args:{searchtext:d,competencyframeworkid:a}}])[0].done(function(a){function b(a,c){for(var d=0;d<c.length;d++){if(c[d].parentid==a.id){a.haschildren=!0;c[d].children=[];c[d].haschildren=!1;a.children[a.children.length]=c[d];b(c[d],c)}}}var c,d,f=[];for(c=0;c<a.length;c++){d=a[c];if("0"==d.parentid){d.children=[];d.haschildren=0;f[f.length]=d;b(d,a)}}e._competencies=f}).fail(b.exception)};i.prototype._find=function(b){return a(this._popup.getContent()).find(b)};i.prototype._getFramework=function(b){var c;a.each(this._frameworks,function(a,d){if(d.id==b){c=d}});return c};i.prototype._loadCompetencies=function(){return this._fetchCompetencies(this._frameworkId,this._searchText)};i.prototype._loadFrameworks=function(){var d,e=this;if(0<e._frameworks.length){return a.when()}if(e._singleFramework){d=c.call([{methodname:"core_competency_read_competency_framework",args:{id:this._frameworkId}}])[0].then(function(a){return[a]})}else{d=c.call([{methodname:"core_competency_list_competency_frameworks",args:{sort:"shortname",context:{contextid:e._pageContextId},includes:e._pageContextIncludes,onlyvisible:e._onlyVisible}}])[0]}return d.done(function(a){e._frameworks=a}).fail(b.exception)};i.prototype.on=function(a,b){this._eventNode.on(a,b)};i.prototype._preRender=function(){var b=this;return b._loadFrameworks().then(function(){if(!b._frameworkId&&0<b._frameworks.length){b._frameworkId=b._frameworks[0].id}if(!b._frameworkId){b._frameworks=[];return a.when()}return b._loadCompetencies()})};i.prototype._refresh=function(){var a=this;return a._render().then(function(b){a._find("[data-region=\"competencylinktree\"]").replaceWith(b);a._afterRender()})};i.prototype._render=function(){var b=this;return b._preRender().then(function(){if(!b._singleFramework){a.each(b._frameworks,function(a,c){if(c.id==b._frameworkId){c.selected=!0}else{c.selected=!1}})}var c={competencies:b._competencies,framework:b._getFramework(b._frameworkId),frameworks:b._frameworks,search:b._searchText,singleFramework:b._singleFramework};return d.render("tool_lp/competency_picker",c)})};i.prototype._reset=function(){this._competencies=[];this._disallowedCompetencyIDs=[];this._popup=null;this._searchText="";this._selectedCompetencies=[]};i.prototype.setDisallowedCompetencyIDs=function(a){this._disallowedCompetencyIDs=a};i.prototype._trigger=function(a,b){this._eventNode.trigger(a,[b])};return i});
define ("tool_lp/competencypicker_user_plans",["jquery","core/notification","core/ajax","core/templates","core/str","tool_lp/tree","tool_lp/competencypicker"],function(a,b,c,d,e,f,g){var h=function(a,b,c){g.prototype.constructor.apply(this,[1,!1,"self",c]);this._userId=a;this._plans=[];if(b){this._planId=b;this._singlePlan=!0}};h.prototype=Object.create(g.prototype);h.prototype._plans=null;h.prototype._planId=null;h.prototype._singlePlan=!1;h.prototype._userId=null;h.prototype._afterRender=function(){var c=this;g.prototype._afterRender.apply(c,arguments);if(!c._singlePlan){c._find("[data-action=\"chooseplan\"]").change(function(d){c._planId=a(d.target).val();c._loadCompetencies().then(c._refresh.bind(c)).catch(b.exception)})}};h.prototype._fetchCompetencies=function(a,d){var e=this;return c.call([{methodname:"core_competency_list_plan_competencies",args:{id:a}}])[0].done(function(a){var b,c,f=[];for(b=0;b<a.length;b++){c=a[b].competency;if(0>c.shortname.toLowerCase().indexOf(d.toLowerCase())){continue}c.children=[];c.haschildren=0;f.push(c)}e._competencies=f}).fail(b.exception)};h.prototype._getPlan=function(b){var c;a.each(this._plans,function(a,d){if(d.id==b){c=d}});return c};h.prototype._loadCompetencies=function(){return this._fetchCompetencies(this._planId,this._searchText)};h.prototype._loadPlans=function(){var d,e=this;if(0<e._plans.length){return a.when()}if(e._singlePlan){d=c.call([{methodname:"core_competency_read_plan",args:{id:this._planId}}])[0].then(function(a){return[a]})}else{d=c.call([{methodname:"core_competency_list_user_plans",args:{userid:e._userId}}])[0]}return d.done(function(a){e._plans=a}).fail(b.exception)};h.prototype._preRender=function(){var b=this;return b._loadPlans().then(function(){if(!b._planId&&0<b._plans.length){b._planId=b._plans[0].id}if(!b._planId){b._plans=[];return a.when()}return b._loadCompetencies()})};h.prototype._render=function(){var b=this;return b._preRender().then(function(){if(!b._singlePlan){a.each(b._plans,function(a,c){if(c.id==b._planId){c.selected=!0}else{c.selected=!1}})}var c={competencies:b._competencies,plan:b._getPlan(b._planId),plans:b._plans,search:b._searchText,singlePlan:b._singlePlan};return d.render("tool_lp/competency_picker_user_plans",c)})};return h});
define ("tool_lp/form_competency_element",["jquery","tool_lp/competencypicker","core/ajax","core/notification","core/templates"],function(a,b,c,d,e){var f=null,g=1,h=function(){var b=a("[data-action=\"competencies\"]").val(),f=[],g=0;if(""!=b){b=b.split(",");for(g=0;g<b.length;g++){f[f.length]={methodname:"core_competency_read_competency",args:{id:b[g]}}}}a.when.apply(a,c.call(f,!1)).then(function(){var a=0,b=[];for(a=0;a<arguments.length;a++){b[a]=arguments[a]}return e.render("tool_lp/form_competency_list",{competencies:b})}).then(function(b,c){e.replaceNode(a("[data-region=\"competencies\"]"),b,c);return!0}).fail(d.exception);return!0},i=function(b){var c=a("[data-action=\"competencies\"]").val().split(","),d=[],e,f=a(b.currentTarget).data("id");for(e=0;e<c.length;e++){if(c[e]!=f){d[d.length]=c[e]}}a("[data-action=\"competencies\"]").val(d.join(","));return h()},j=function(){var c=a("[data-action=\"competencies\"]").val().split(",");if(!f){f=new b(g,!1,"parents",!0);f.on("save",function(b,c){var d=a("[data-action=\"competencies\"]").val(),e=c.competencyIds;if(""!=d){e=e.concat(d.split(","))}var f=e.join(",");a("[data-action=\"competencies\"]").val(f);return h()})}f.setDisallowedCompetencyIDs(c);f.display()};return{init:function init(b){g=b;h();a("[data-action=\"select-competencies\"]").on("click",j);a("body").on("click","[data-action=\"deselect-competency\"]",i)}}});
define ("tool_lp/user_competency_workflow",["jquery","core/templates","core/ajax","core/notification","core/str","tool_lp/menubar","tool_lp/event_base"],function(a,b,c,d,e,f,g){var h=function(){g.prototype.constructor.apply(this,[])};h.prototype=Object.create(g.prototype);h.prototype._nodeSelector="[data-node=\"user-competency\"]";h.prototype._cancelReviewRequest=function(a){var b={methodname:"core_competency_user_competency_cancel_review_request",args:{userid:a.userid,competencyid:a.competencyid}};c.call([b])[0].then(function(){this._trigger("review-request-cancelled",a);this._trigger("status-changed",a)}.bind(this)).catch(function(){this._trigger("error-occured",a)}.bind(this))};h.prototype.cancelReviewRequest=function(a){this._cancelReviewRequest(a)};h.prototype._cancelReviewRequestHandler=function(b){b.preventDefault();var c=this._findUserCompetencyData(a(b.target));this.cancelReviewRequest(c)};h.prototype._requestReview=function(a){var b={methodname:"core_competency_user_competency_request_review",args:{userid:a.userid,competencyid:a.competencyid}};c.call([b])[0].then(function(){this._trigger("review-requested",a);this._trigger("status-changed",a)}.bind(this)).catch(function(){this._trigger("error-occured",a)}.bind(this))};h.prototype.requestReview=function(a){this._requestReview(a)};h.prototype._requestReviewHandler=function(b){b.preventDefault();var c=this._findUserCompetencyData(a(b.target));this.requestReview(c)};h.prototype._startReview=function(a){var b={methodname:"core_competency_user_competency_start_review",args:{userid:a.userid,competencyid:a.competencyid}};c.call([b])[0].then(function(){this._trigger("review-started",a);this._trigger("status-changed",a)}.bind(this)).catch(function(){this._trigger("error-occured",a)}.bind(this))};h.prototype.startReview=function(a){this._startReview(a)};h.prototype._startReviewHandler=function(b){b.preventDefault();var c=this._findUserCompetencyData(a(b.target));this.startReview(c)};h.prototype._stopReview=function(a){var b={methodname:"core_competency_user_competency_stop_review",args:{userid:a.userid,competencyid:a.competencyid}};c.call([b])[0].then(function(){this._trigger("review-stopped",a);this._trigger("status-changed",a)}.bind(this)).catch(function(){this._trigger("error-occured",a)}.bind(this))};h.prototype.stopReview=function(a){this._stopReview(a)};h.prototype._stopReviewHandler=function(b){b.preventDefault();var c=this._findUserCompetencyData(a(b.target));this.stopReview(c)};h.prototype.enhanceMenubar=function(a){f.enhance(a,{'[data-action="request-review"]':this._requestReviewHandler.bind(this),'[data-action="cancel-review-request"]':this._cancelReviewRequestHandler.bind(this)})};h.prototype._findUserCompetencyData=function(a){var b=a.parents(this._nodeSelector),c;if(1!=b.length){throw new Error("The evidence node was not located.")}c=b.data();if("undefined"==typeof c||"undefined"==typeof c.userid||"undefined"==typeof c.competencyid){throw new Error("User competency data could not be found.")}return c};h.prototype.enhanceMenubar=function(a){f.enhance(a,{'[data-action="request-review"]':this._requestReviewHandler.bind(this),'[data-action="cancel-review-request"]':this._cancelReviewRequestHandler.bind(this),'[data-action="start-review"]':this._startReviewHandler.bind(this),'[data-action="stop-review"]':this._stopReviewHandler.bind(this)})};h.prototype.registerEvents=function(b){var c=a(b);c.find("[data-action=\"request-review\"]").click(this._requestReviewHandler.bind(this));c.find("[data-action=\"cancel-review-request\"]").click(this._cancelReviewRequestHandler.bind(this));c.find("[data-action=\"start-review\"]").click(this._startReviewHandler.bind(this));c.find("[data-action=\"stop-review\"]").click(this._stopReviewHandler.bind(this))};return h});
define ("tool_lp/competencyruleconfig",["jquery","core/notification","core/templates","tool_lp/dialogue","tool_lp/competency_outcomes","core/str"],function(a,b,c,d,e,f){var g=function(b,c){this._eventNode=a("<div></div>");this._tree=b;this._rulesModules=c;this._setUp()};g.prototype._competency=null;g.prototype._eventNode=null;g.prototype._outcomesOption=null;g.prototype._popup=null;g.prototype._ready=null;g.prototype._rules=null;g.prototype._rulesModules=null;g.prototype._tree=null;g.prototype._afterChange=function(){if(!this._isValid()){this._find("[data-action=\"save\"]").prop("disabled",!0)}else{this._find("[data-action=\"save\"]").prop("disabled",!1)}};g.prototype._afterRuleConfigChange=function(a,b){if(b!=this._getRule()){return}this._afterChange()};g.prototype._afterRender=function(){var a=this;a._find("[name=\"outcome\"]").on("change",function(){a._switchedOutcome()}).trigger("change");a._find("[name=\"rule\"]").on("change",function(){a._switchedRule()}).trigger("change");a._find("[data-action=\"save\"]").on("click",function(){a._trigger("save",a._getConfig());a.close()});a._find("[data-action=\"cancel\"]").on("click",function(){a.close()})};g.prototype.canBeConfigured=function(){var b=!1;a.each(this._rules,function(a,c){if(c.canConfig()){b=!0}});return b};g.prototype.close=function(){this._popup.close();this._popup=null};g.prototype.display=function(){var c=this;if(!c._competency){return!1}return a.when(f.get_string("competencyrule","tool_lp"),c._render()).then(function(a,b){c._popup=new d(a,b[0],c._afterRender.bind(c))}).fail(b.exception)};g.prototype._find=function(b){return a(this._popup.getContent()).find(b)};g.prototype._getApplicableOutcomesOptions=function(){var b=this,c=[];a.each(b._outcomesOption,function(a,d){c.push({code:d.code,name:d.name,selected:d.code==b._competency.ruleoutcome?!0:!1})});return c};g.prototype._getApplicableRulesOptions=function(){var b=this,c=[];a.each(b._rules,function(a,d){if(!d.canConfig()){return}c.push({name:b._getRuleName(d.getType()),type:d.getType(),selected:d.getType()==b._competency.ruletype?!0:!1})});return c};g.prototype._getConfig=function(){var a=this._getRule();return{ruletype:a?a.getType():null,ruleconfig:a?a.getConfig():null,ruleoutcome:this._getOutcome()}};g.prototype._getOutcome=function(){return this._find("[name=\"outcome\"]").val()};g.prototype._getRule=function(){var b,c=this._find("[name=\"rule\"]").val();a.each(this._rules,function(a,d){if(d.getType()==c){b=d}});return b};g.prototype._getRuleName=function(b){var c=this,d;a.each(c._rulesModules,function(a,c){if(c.type==b){d=c.name}});return d};g.prototype._initOutcomes=function(){var a=this;return e.getAll().then(function(b){a._outcomesOption=b})};g.prototype._initRules=function(){var b=this,c=[];a.each(b._rules,function(d,e){var f=e.init().then(function(){e.setTargetCompetency(b._competency);e.on("change",b._afterRuleConfigChange.bind(b))},function(){b._rules.splice(d,1);return a.when()});c.push(f)});return a.when.apply(a.when,c)};g.prototype._isValid=function(){var a=this._getOutcome(),b=this._getRule();if(a==e.NONE){return!0}else if(!b){return!1}return b.isValid()};g.prototype.on=function(a,b){this._eventNode.on(a,b)};g.prototype._preRender=function(){return this.ready()};g.prototype.ready=function(){return this._ready.promise()};g.prototype._render=function(){var a=this;return this._preRender().then(function(){var b;if(!a.canBeConfigured()){b=!1}else{b={};b.outcomes=a._getApplicableOutcomesOptions();b.rules=a._getApplicableRulesOptions()}var d={competencyshortname:a._competency.shortname,config:b};return c.render("tool_lp/competency_rule_config",d)})};g.prototype.setTargetCompetencyId=function(b){var c=this;c._competency=c._tree.getCompetency(b);a.each(c._rules,function(a,b){b.setTargetCompetency(c._competency)})};g.prototype._setUp=function(){var b=this,c=[],d=[];b._ready=a.Deferred();b._rules=[];a.each(b._rulesModules,function(a,b){d.push(b.amd)});require(d,function(){a.each(arguments,function(a,c){var d=new c(b._tree);b._rules.push(d)});c.push(b._initRules());c.push(b._initOutcomes());a.when.apply(a.when,c).always(function(){b._ready.resolve()})})};g.prototype._switchedOutcome=function(){var a=this,b=a._getOutcome();if(b==e.NONE){a._find("[data-region=\"rule-type\"]").hide().find("[name=\"rule\"]").val(-1);a._find("[data-region=\"rule-config\"]").empty().hide();a._afterChange();return}a._find("[data-region=\"rule-type\"]").show();a._find("[data-region=\"rule-config\"]").show();a._afterChange()};g.prototype._switchedRule=function(){var a=this,b=a._find("[data-region=\"rule-config\"]"),c=a._getRule();if(!c){b.empty().hide();a._afterChange();return}c.injectTemplate(b).then(function(){b.show()}).always(function(){a._afterChange()}).catch(function(){b.empty().hide()})};g.prototype._trigger=function(a,b){this._eventNode.trigger(a,[b])};return g});
define ("tool_lp/competencytree",["core/ajax","core/notification","core/templates","tool_lp/tree","tool_lp/competency_outcomes","jquery"],function(a,b,c,d,e,f){var g={},h=0,j="",k="",l="",m=!1,n=function(a,b){var c=0,d=!1;a.haschildren=!1;a.children=[];for(c=0;c<b.length;c++){d=b[c];if(d.parentid==a.id){a.haschildren=!0;a.children.push(d);n(d,b)}}},o=function(b){var e=f.Deferred();c.render("tool_lp/loading",{}).done(function(i,o){c.replaceNodeContents(f(k),i,o);var p=a.call([{methodname:"core_competency_search_competencies",args:{searchtext:b,competencyframeworkid:h}}]);p[0].done(function(a){g={};var b=0;for(b=0;b<a.length;b++){g[a[b].id]=a[b]}var h=[],o=!1;for(b=0;b<a.length;b++){o=a[b];if(0===parseInt(o.parentid,10)){h.push(o);n(o,a)}}var p={shortname:j,canmanage:m,competencies:h};c.render("tool_lp/competencies_tree_root",p).done(function(a,b){c.replaceNodeContents(f(k),f(a).html(),b);var h=new d(k,!1);if(l){var i=f(k).find("[data-id="+l+"]");if(i.length){h.selectItem(i);h.updateFocus(i)}}e.resolve(g)}).fail(e.reject)}).fail(e.reject)});return e.promise()},p=function(a,b){var c=b.selected;l=c.attr("data-id")};return{init:function init(a,c,d,e,f,g){h=a;j=c;m=f;k=e;o(d).fail(b.exception);if(0<g){l=g}this.on("selectionchanged",p)},on:function on(a,b){f(k).on(a,b)},getChildren:function getChildren(a){var b=[];f.each(g,function(c,d){if(d.parentid==a){b.push(d)}});return b},getCompetencyFrameworkId:function getCompetencyFrameworkId(){return h},getCompetency:function getCompetency(a){return g[a]},getCompetencyLevel:function getCompetencyLevel(a){var b=this.getCompetency(a),c=b.path.replace(/^\/|\/$/g,"").split("/").length;return c},hasChildren:function hasChildren(a){return 0<this.getChildren(a).length},hasRule:function hasRule(a){var b=this.getCompetency(a);if(b){return b.ruleoutcome!=e.OUTCOME_NONE&&b.ruletype}return!1},reloadCompetencies:function reloadCompetencies(){return o("").fail(b.exception)},listCompetencies:function listCompetencies(){return g}}});
define ("tool_lp/parentcompetency_form",["jquery","core/ajax","core/str","tool_lp/competencypicker","core/templates","core/notification"],function(a,b,c,d,e,f){var g=function(a,b,c,d,e){this.buttonSelector=a;this.inputHiddenSelector=b;this.staticElementSelector=c;this.frameworkId=d;this.pageContextId=e;this.registerEvents()};g.prototype.buttonSelector=null;g.prototype.inputHiddenSelector=null;g.prototype.staticElementSelector=null;g.prototype.frameworkId=null;g.prototype.pageContextId=null;g.prototype.setParent=function(d){var e=this;if(0!==d.competencyId){b.call([{methodname:"core_competency_read_competency",args:{id:d.competencyId}}])[0].done(function(b){a(e.staticElementSelector).html(b.shortname);a(e.inputHiddenSelector).val(b.id)}).fail(f.exception)}else{c.get_string("competencyframeworkroot","tool_lp").then(function(b){a(e.staticElementSelector).html(b);a(e.inputHiddenSelector).val(d.competencyId)}).fail(f.exception)}};g.prototype.registerEvents=function(){var b=this;a(b.buttonSelector).on("click",function(a){a.preventDefault();var c=new d(b.pageContextId,b.frameworkId,"self",!1);c._render=function(){var a=this;return a._preRender().then(function(){var b={competencies:a._competencies,framework:a._getFramework(a._frameworkId),frameworks:a._frameworks,search:a._searchText,singleFramework:a._singleFramework};return e.render("tool_lp/competency_picker_competencyform",b)})};c.on("save",function(a,c){b.setParent(c)});c.display()})};return{init:function init(a,b,c,d,e){new g(a,b,c,d,e)}}});
define ("tool_lp/course_competency_settings",["jquery","core/notification","tool_lp/dialogue","core/str","core/ajax","core/templates","core/pending"],function(a,b,c,d,f,g,h){var i=function(b){a(b).on("click",this.configureSettings.bind(this))};i.prototype._dialogue=null;i.prototype.configureSettings=function(f){var e=new h,i=a(f.target).closest("a").data("courseid"),j=a(f.target).closest("a").data("pushratingstouserplans");f.preventDefault();a.when(d.get_string("configurecoursecompetencysettings","tool_lp"),g.render("tool_lp/course_competency_settings",{courseid:i,settings:{pushratingstouserplans:j}})).then(function(a,b){this._dialogue=new c(a,b[0],this.addListeners.bind(this));return this._dialogue}.bind(this)).then(e.resolve).catch(b.exception)};i.prototype.addListeners=function(){var a=this._find("[data-action=\"save\"]");a.on("click",this.saveSettings.bind(this));var b=this._find("[data-action=\"cancel\"]");b.on("click",this.cancelChanges.bind(this))};i.prototype.cancelChanges=function(a){a.preventDefault();this._dialogue.close()};i.prototype._find=function(b){return a("[data-region=\"coursecompetencysettings\"]").find(b)};i.prototype.saveSettings=function(a){var c=new h;a.preventDefault();var d=this._find("input[name=\"pushratingstouserplans\"]:checked").val(),e=this._find("input[name=\"courseid\"]").val();f.call([{methodname:"core_competency_update_course_competency_settings",args:{courseid:e,settings:{pushratingstouserplans:d}}}])[0].then(function(){return this.refreshCourseCompetenciesPage()}.bind(this)).then(c.resolve).catch(b.exception)};i.prototype.refreshCourseCompetenciesPage=function(){var c=this._find("input[name=\"courseid\"]").val(),d=new h;f.call([{methodname:"tool_lp_data_for_course_competencies_page",args:{courseid:c,moduleid:0}}])[0].then(function(a){return g.render("tool_lp/course_competencies_page",a)}).then(function(b,c){g.replaceNode(a("[data-region=\"coursecompetenciespage\"]"),b,c);this._dialogue.close()}.bind(this)).then(d.resolve).catch(b.exception)};return i});
define ("tool_lp/grade_user_competency_inline",["jquery","core/notification","core/ajax","core/log","tool_lp/grade_dialogue","tool_lp/event_base","tool_lp/scalevalues"],function(a,b,c,d,e,f,g){var h=function(b,c,d,e,g,h,i){f.prototype.constructor.apply(this,[]);var j=a(b);if(!j.length){throw new Error("Could not find the trigger")}this._scaleId=c;this._competencyId=d;this._userId=e;this._planId=g;this._courseId=h;this._chooseStr=i;this._setUp();j.click(function(a){a.preventDefault();this._dialogue.display()}.bind(this));if(this._planId){this._methodName="core_competency_grade_competency_in_plan";this._args={competencyid:this._competencyId,planid:this._planId}}else if(this._courseId){this._methodName="core_competency_grade_competency_in_course";this._args={competencyid:this._competencyId,courseid:this._courseId,userid:this._userId}}else{this._methodName="core_competency_grade_competency";this._args={userid:this._userId,competencyid:this._competencyId}}};h.prototype=Object.create(f.prototype);h.prototype._setUp=function(){var a=[],d=this;M.util.js_pending("tool_lp/grade_user_competency_inline:_setUp");var f=g.get_values(d._scaleId);f.then(function(b){a.push({value:"",name:d._chooseStr});for(var c=0,e;c<b.length;c++){e=b[c];a.push({value:e.id,name:e.name})}return a}).then(function(a){return new e(a)}).then(function(a){a.on("rated",function(a,e){var f=d._args;f.grade=e.rating;f.note=e.note;c.call([{methodname:d._methodName,args:f,done:function done(a){d._trigger("competencyupdated",{args:f,evidence:a})},fail:b.exception}])});return a}).then(function(a){d._dialogue=a;M.util.js_complete("tool_lp/grade_user_competency_inline:_setUp")}).fail(b.exception)};h.prototype._scaleId=null;h.prototype._competencyId=null;h.prototype._userId=null;h.prototype._planId=null;h.prototype._courseId=null;h.prototype._chooseStr=null;h.prototype._dialogue=null;return h});
define ("tool_lp/dialogue",["core/yui"],function(a){var b=function(b,c,d,e,f){M.util.js_pending("tool_lp/dialogue:dialogue");this.yuiDialogue=null;var g=this;if("undefined"==typeof f){f=!1}a.use("moodle-core-notification","timers",function(){var h="480px";if(f){h="800px"}g.yuiDialogue=new M.core.dialogue({headerContent:b,bodyContent:c,draggable:!0,visible:!1,center:!0,modal:!0,width:h});g.yuiDialogue.before("visibleChange",function(){M.util.js_pending("tool_lp/dialogue:before:visibleChange")});g.yuiDialogue.after("visibleChange",function(b){if(b.newVal){if("undefined"!=typeof d){a.soon(function(){d(g);g.yuiDialogue.centerDialogue();M.util.js_complete("tool_lp/dialogue:before:visibleChange")})}else{M.util.js_complete("tool_lp/dialogue:before:visibleChange")}}else{if("undefined"!=typeof e){a.soon(function(){e(g);M.util.js_complete("tool_lp/dialogue:before:visibleChange")})}else{M.util.js_complete("tool_lp/dialogue:before:visibleChange")}}});g.yuiDialogue.show();M.util.js_complete("tool_lp/dialogue:dialogue")})};b.prototype.close=function(){this.yuiDialogue.hide();this.yuiDialogue.destroy()};b.prototype.getContent=function(){return this.yuiDialogue.bodyNode.getDOMNode()};return b});
define ("tool_lp/dragdrop-reorder",["core/str","core/yui"],function(a,b){var c=null,d=function(a){var b=a.drag.get("node"),c=a.drop.get("node");this.callback(b.getDOMNode(),c.getDOMNode())};return{dragdrop:function dragdrop(e,f,g,h,i,j,k,l){a.get_strings([{key:"emptydragdropregion",component:"moodle"},{key:"movecontent",component:"moodle"},{key:"tocontent",component:"moodle"}]).done(function(){b.use("moodle-tool_lp-dragdrop-reorder",function(){if(c){c.destroy()}c=M.tool_lp.dragdrop_reorder({group:e,dragHandleText:f,sameNodeText:g,parentNodeText:h,sameNodeClass:i,parentNodeClass:j,dragHandleInsertClass:k,callback:b.bind(d,{callback:l})})})})}}});
define ("tool_lp/user_evidence_actions",["jquery","core/templates","core/ajax","core/notification","core/str","tool_lp/menubar","tool_lp/competencypicker_user_plans"],function(a,b,c,d,e,f,g){var h=function(a){this._type=a;if("evidence"===a){this._region="[data-region=\"user-evidence-page\"]";this._evidenceNode="[data-region=\"user-evidence-page\"]";this._template="tool_lp/user_evidence_page";this._contextMethod="tool_lp_data_for_user_evidence_page"}else if("list"===a){this._region="[data-region=\"user-evidence-list\"]";this._evidenceNode="[data-region=\"user-evidence-node\"]";this._template="tool_lp/user_evidence_list_page";this._contextMethod="tool_lp_data_for_user_evidence_list_page"}else{throw new TypeError("Unexpected type.")}};h.prototype._contextMethod=null;h.prototype._evidenceNode=null;h.prototype._region=null;h.prototype._template=null;h.prototype._type=null;h.prototype._getContextArgs=function(a){var b=this,c={};if("evidence"===b._type){c={id:a.id}}else if("list"===b._type){c={userid:a.userid}}return c};h.prototype._renderView=function(c){var d=this;return b.render(d._template,c).then(function(c,e){b.replaceNode(a(d._region),c,e)})};h.prototype._callAndRefresh=function(b,e){var f=this;b.push({methodname:f._contextMethod,args:f._getContextArgs(e)});return a.when.apply(a.when,c.call(b)).then(function(){return f._renderView(arguments[arguments.length-1])}).fail(d.exception)};h.prototype._doDelete=function(a){var b=this,c=[{methodname:"core_competency_delete_user_evidence",args:{id:a.id}}];b._callAndRefresh(c,a)};h.prototype.deleteEvidence=function(a){var b=this,f;f=c.call([{methodname:"core_competency_read_user_evidence",args:{id:a.id}}]);f[0].done(function(c){e.get_strings([{key:"confirm",component:"moodle"},{key:"deleteuserevidence",component:"tool_lp",param:c.name},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],function(){b._doDelete(a)})}).fail(d.exception)}).fail(d.exception)};h.prototype._deleteEvidenceHandler=function(b){b.preventDefault();var c=this._findEvidenceData(a(b.target));this.deleteEvidence(c)};h.prototype._doCreateUserEvidenceCompetency=function(b,c){var d=this,e=[];a.each(c,function(a,c){e.push({methodname:"core_competency_create_user_evidence_competency",args:{userevidenceid:b.id,competencyid:c}})});d._callAndRefresh(e,b)};h.prototype.createUserEvidenceCompetency=function(a){var b=this,c=new g(a.userid);c.on("save",function(c,d){var e=d.competencyIds;b._doCreateUserEvidenceCompetency(a,e,d.requestReview)});c.display()};h.prototype._createUserEvidenceCompetencyHandler=function(b){b.preventDefault();var c=this._findEvidenceData(a(b.target));this.createUserEvidenceCompetency(c)};h.prototype._doDeleteUserEvidenceCompetency=function(a,b){var c=this,d=[];d.push({methodname:"core_competency_delete_user_evidence_competency",args:{userevidenceid:a.id,competencyid:b}});c._callAndRefresh(d,a)};h.prototype.deleteUserEvidenceCompetency=function(a,b){this._doDeleteUserEvidenceCompetency(a,b)};h.prototype._deleteUserEvidenceCompetencyHandler=function(b){var c=this._findEvidenceData(a(b.currentTarget)),d=a(b.currentTarget).data("id");b.preventDefault();this.deleteUserEvidenceCompetency(c,d)};h.prototype._doReviewUserEvidenceCompetencies=function(a){var b=this,c=[{methodname:"core_competency_request_review_of_user_evidence_linked_competencies",args:{id:a.id}}];b._callAndRefresh(c,a)};h.prototype.reviewUserEvidenceCompetencies=function(a){var b=this,f;f=c.call([{methodname:"core_competency_read_user_evidence",args:{id:a.id}}]);f[0].done(function(c){e.get_strings([{key:"confirm",component:"moodle"},{key:"sendallcompetenciestoreview",component:"tool_lp",param:c.name},{key:"confirm",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],function(){b._doReviewUserEvidenceCompetencies(a)})}).fail(d.exception)}).fail(d.exception)};h.prototype._reviewUserEvidenceCompetenciesHandler=function(b){b.preventDefault();var c=this._findEvidenceData(a(b.target));this.reviewUserEvidenceCompetencies(c)};h.prototype._findEvidenceData=function(b){var c=b.parentsUntil(a(this._region).parent(),this._evidenceNode),d;if(1!=c.length){throw new Error("The evidence node was not located.")}d=c.data();if("undefined"==typeof d||"undefined"==typeof d.id){throw new Error("Evidence data could not be found.")}return d};h.prototype.enhanceMenubar=function(a){var b=this;f.enhance(a,{'[data-action="user-evidence-delete"]':b._deleteEvidenceHandler.bind(b),'[data-action="link-competency"]':b._createUserEvidenceCompetencyHandler.bind(b),'[data-action="send-competencies-review"]':b._reviewUserEvidenceCompetenciesHandler.bind(b)})};h.prototype.registerEvents=function(){var b=a(this._region),c=this;b.find("[data-action=\"user-evidence-delete\"]").click(c._deleteEvidenceHandler.bind(c));b.find("[data-action=\"link-competency\"]").click(c._createUserEvidenceCompetencyHandler.bind(c));b.find("[data-action=\"delete-competency-link\"]").click(c._deleteUserEvidenceCompetencyHandler.bind(c));b.find("[data-action=\"send-competencies-review\"]").click(c._reviewUserEvidenceCompetenciesHandler.bind(c))};return h});
define ("tool_lp/event_base",["jquery"],function(a){var b=function(){this._eventNode=a("<div></div>")};b.prototype._eventNode=null;b.prototype.on=function(a,b){this._eventNode.on(a,b)};b.prototype._trigger=function(a,b){this._eventNode.trigger(a,[b])};return b});
define ("tool_lp/evidence_delete",["jquery","core/notification","core/ajax","core/str","core/log"],function(a,b,c,d,e){var f={};return{register:function register(g,h){if("undefined"!=typeof f[g]){return}f[g]=a("body").delegate(g,"click",function(f){var g=a(f.currentTarget).parents(h);if(!g.length||1<g.length){e.error("None or too many evidence container were found.");return}var i=g.data("id");if(!i){e.error("Evidence ID was not found.");return}f.preventDefault();f.stopPropagation();d.get_strings([{key:"confirm",component:"moodle"},{key:"areyousure",component:"moodle"},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(a){b.confirm(a[0],a[1],a[2],a[3],function(){var a=c.call([{methodname:"core_competency_delete_evidence",args:{id:i}}]);a[0].then(function(){g.remove()}).fail(b.exception)})}).fail(b.exception)})}}});
define ("tool_lp/form-cohort-selector",["jquery","core/ajax","core/templates"],function(a,b,c){return{processResults:function processResults(b,c){var d=[];a.each(c,function(a,b){d.push({value:b.id,label:b._label})});return d},transport:function transport(d,e,f,g){var h,i=parseInt(a(d).data("contextid"),10),j=a(d).data("includes");h=b.call([{methodname:"tool_lp_search_cohorts",args:{query:e,context:{contextid:i},includes:j}}]);h[0].then(function(b){var d=[],e=0;a.each(b.cohorts,function(a,b){d.push(c.render("tool_lp/form-cohort-selector-suggestion",b))});return a.when.apply(a.when,d).then(function(){var c=arguments;a.each(b.cohorts,function(a,b){b._label=c[e];e++});f(b.cohorts)})}).catch(g)}}});
define ("tool_lp/form-user-selector",["jquery","core/ajax","core/templates"],function(a,b,c){return{processResults:function processResults(b,c){var d=[];a.each(c,function(a,b){d.push({value:b.id,label:b._label})});return d},transport:function transport(d,e,f,g){var h,i=a(d).data("capability");if("undefined"==typeof i){i=""}h=b.call([{methodname:"tool_lp_search_users",args:{query:e,capability:i}}]);h[0].then(function(b){var d=[],e=0;a.each(b.users,function(b,e){var f=e,g=[];a.each(["idnumber","email","phone1","phone2","department","institution"],function(a,b){if("undefined"!=typeof e[b]&&""!==e[b]){f.hasidentity=!0;g.push(e[b])}});f.identity=g.join(", ");d.push(c.render("tool_lp/form-user-selector-suggestion",f))});return a.when.apply(a.when,d).then(function(){var c=arguments;a.each(b.users,function(a,b){b._label=c[e];e++});f(b.users)})}).catch(g)}}});
define ("tool_lp/menubar",["jquery"],function(a){var b=!1,c=!1,d=function(){a(".tool-lp-menu .tool-lp-sub-menu").attr("aria-hidden","true");c=!1},e=function(a,b){this.menuRoot=a;this.handlers=b;this.rootMenus=this.menuRoot.children("li");this.subMenus=this.rootMenus.children("ul");this.subMenuItems=this.subMenus.children("li");this.allItems=this.rootMenus.add(this.subMenuItems);this.activeItem=null;this.isChildOpen=!1;this.keys={tab:9,enter:13,esc:27,space:32,left:37,up:38,right:39,down:40};this.addAriaAttributes();this.addEventListeners()};e.prototype.openSubMenu=function(a){this.setOpenDirection();d();a.attr("aria-hidden","false");c=!0};e.prototype.addEventListeners=function(){var f=this;if(!1===b){a(document).click(function(){if(c){d()}});b=!0}this.subMenuItems.mouseenter(function(){a(this).addClass("menu-hover");return!0});this.subMenuItems.mouseout(function(){a(this).removeClass("menu-hover");return!0});this.allItems.click(function(b){return f.handleClick(a(this),b)});this.allItems.keydown(function(b){return f.handleKeyDown(a(this),b)});this.allItems.focus(function(){return f.handleFocus(a(this))});this.allItems.blur(function(){return f.handleBlur(a(this))})};e.prototype.handleClick=function(b,c){c.stopPropagation();var d=b.parent();if(d.is(".tool-lp-menu")){if("true"==b.children("ul").first().attr("aria-hidden")){this.openSubMenu(b.children("ul").first())}else{b.children("ul").first().attr("aria-hidden","true")}}else{this.allItems.removeClass("menu-hover menu-focus");this.activeItem=null;this.menuRoot.find("ul").not(".root-level").attr("aria-hidden","true");var e=b.find("a").first(),f=new a.Event("click");f.target=e;var g=!1;if(this.handlers){a.each(this.handlers,function(c,d){if(g){return}if(0<b.find(c).length){var h=a.proxy(d,e);g=!1===h(f)||f.isDefaultPrevented()}})}if(!g&&"#"!==e.attr("href")){window.location.href=e.attr("href")}}return!1};e.prototype.handleFocus=function(a){if(null===this.activeItem){this.activeItem=a}else if(a[0]!=this.activeItem[0]){return!0}var b=this.activeItem.parentsUntil("ul.tool-lp-menu").filter("li");this.allItems.removeClass("menu-focus");this.activeItem.addClass("menu-focus");b.addClass("menu-focus");if(!0===this.isChildOpen){var c=a.parent();if(c.is(".tool-lp-menu")&&"true"==a.attr("aria-haspopup")){this.openSubMenu(a.children("ul").first())}}return!0};e.prototype.handleBlur=function(a){a.removeClass("menu-focus");return!0};e.prototype.setOpenDirection=function(){var b=this.menuRoot.offset(),c=a(document.body).hasClass("dir-rtl"),d=this.rootMenus.outerHeight(),e=this.rootMenus.outerWidth(),f=this.rootMenus.find("ul.tool-lp-sub-menu");f.css("margin-right","");f.css("margin-left","");f.css("margin-top","");f.attr("aria-hidden",!1);var g=f.outerWidth(),h=f.outerHeight(),i=null,j=null,k=null,l=b.top-a(window).scrollTop();if(l+h>a(window).height()){i=h+d;f.css("margin-top","-"+i+"px")}if(c){if(0>b.left-g){j=g-e;f.css("margin-right","-"+j+"px")}}else{if(b.left+g>a(window).width()){k=g-e;f.css("margin-left","-"+k+"px")}}if(!0){this.menuRoot.addClass("tool-lp-menu-open-left")}else{this.menuRoot.removeClass("tool-lp-menu-open-left")}};e.prototype.handleKeyDown=function(a,b){if(b.altKey||b.ctrlKey){return!0}switch(b.keyCode){case this.keys.tab:{this.menuRoot.find("ul").attr("aria-hidden","true");this.allItems.removeClass("menu-focus");this.activeItem=null;this.isChildOpen=!1;break}case this.keys.esc:{var c=a.parent();if(c.is(".tool-lp-menu")){a.children("ul").first().attr("aria-hidden","true")}else{this.activeItem=c.parent();this.isChildOpen=!1;this.activeItem.focus();c.attr("aria-hidden","true")}b.stopPropagation();return!1}case this.keys.enter:case this.keys.space:{return this.handleClick(a,b)}case this.keys.left:{this.activeItem=this.moveToPrevious(a);this.activeItem.focus();b.stopPropagation();return!1}case this.keys.right:{this.activeItem=this.moveToNext(a);this.activeItem.focus();b.stopPropagation();return!1}case this.keys.up:{this.activeItem=this.moveUp(a);this.activeItem.focus();b.stopPropagation();return!1}case this.keys.down:{this.activeItem=this.moveDown(a);this.activeItem.focus();b.stopPropagation();return!1}}return!0};e.prototype.moveToNext=function(a){var b=a.parent(),c=b.children("li"),d=c.length,e=c.index(a),f=null,g=null;if(b.is(".tool-lp-menu")){if(e<d-1){f=a.next()}else{f=c.first()}if("true"==a.attr("aria-haspopup")){g=a.children("ul").first();if("false"==g.attr("aria-hidden")){g.attr("aria-hidden","true");this.isChildOpen=!0}}a.removeClass("menu-focus");if("true"===f.attr("aria-haspopup")&&!0===this.isChildOpen){g=f.children("ul").first();this.openSubMenu(g)}}else{if("true"==a.attr("aria-haspopup")){g=a.children("ul").first();f=g.children("li").first();this.openSubMenu(g)}else{var h=null,i=null;h=a.parentsUntil("ul.tool-lp-menu").filter("ul").not(".tool-lp-menu");h.attr("aria-hidden","true");h.find("li").removeClass("menu-focus");h.last().parent().removeClass("menu-focus");i=h.last().parent();e=this.rootMenus.index(i);if(e<this.rootMenus.length-1){f=i.next()}else{f=this.rootMenus.first()}f.addClass("menu-focus");if("true"==f.attr("aria-haspopup")){g=f.children("ul").first();f=g.children("li").first();this.openSubMenu(g);this.isChildOpen=!0}}}return f};e.prototype.moveToPrevious=function(a){var b=a.parent(),c=b.children("li"),d=c.index(a),e=null,f=null;if(b.is(".tool-lp-menu")){if(0<d){e=a.prev()}else{e=c.last()}if("true"==a.attr("aria-haspopup")){f=a.children("ul").first();if("false"==f.attr("aria-hidden")){f.attr("aria-hidden","true");this.isChildOpen=!0}}a.removeClass("menu-focus");if("true"===e.attr("aria-haspopup")&&!0===this.isChildOpen){f=e.children("ul").first();this.openSubMenu(f)}}else{var g=b.parent(),h=g.parent();if(!h.is(".tool-lp-menu")){e=b.parent();b.attr("aria-hidden","true");a.removeClass("menu-focus")}else{b.attr("aria-hidden","true");a.removeClass("menu-focus");g.removeClass("menu-focus");d=this.rootMenus.index(g);if(0<d){e=g.prev()}else{e=this.rootMenus.last()}e.addClass("menu-focus");if("true"==e.attr("aria-haspopup")){f=e.children("ul").first();this.openSubMenu(f);this.isChildOpen=!0;e=f.children("li").first()}}}return e};e.prototype.moveDown=function(a,b){var c=a.parent(),d=c.children("li").not(".separator"),e=d.length,f=d.index(a),g=null,h=null;if(c.is(".tool-lp-menu")){if("true"!=a.attr("aria-haspopup")){return a}h=a.children("ul").first();g=h.children("li").first();this.openSubMenu(h);return g}if(b){var i=!1,j=f+1;if(j==e){j=0}while(j!=f){var k=d.eq(j).html().charAt(0);if(k.toLowerCase()==b){i=!0;break}j=j+1;if(j==e){j=0}}if(!0==i){g=d.eq(j);a.removeClass("menu-focus");return g}else{return a}}else{if(f<e-1){g=d.eq(f+1)}else{g=d.first()}}a.removeClass("menu-focus");return g};e.prototype.moveUp=function(a){var b=a.parent(),c=b.children("li").not(".separator"),d=c.index(a),e=null;if(b.is(".tool-lp-menu")){return a}if(0<d){e=c.eq(d-1)}else{e=c.last()}a.removeClass("menu-focus");return e};e.prototype.addAriaAttributes=function(){this.menuRoot.attr("role","menubar");this.rootMenus.attr("role","menuitem");this.rootMenus.attr("tabindex","0");this.rootMenus.attr("aria-haspopup","true");this.subMenus.attr("role","menu");this.subMenus.attr("aria-hidden","true");this.subMenuItems.attr("role","menuitem");this.subMenuItems.attr("tabindex","-1");this.menuRoot.addClass("tool-lp-menu");this.allItems.addClass("tool-lp-menu-item");this.rootMenus.addClass("tool-lp-root-menu");this.subMenus.addClass("tool-lp-sub-menu");this.subMenuItems.addClass("dropdown-item")};return{enhance:function enhance(b,c){a(b).each(function(b,d){var f=a(d);if(!0!==f.data("menubarEnhanced")){new e(f,c);f.data("menubarEnhanced",!0)}})},closeAll:d}});
define ("tool_lp/module_navigation",["jquery"],function(a){var b=function(b,c,d,e){this._baseUrl=c;this._moduleId=e;this._courseId=d;a(b).on("change",this._moduleChanged.bind(this))};b.prototype._moduleChanged=function(b){var c=a(b.target).val(),d="?mod="+c+"&courseid="+this._courseId;document.location=this._baseUrl+d};b.prototype._courseId=null;b.prototype._moduleId=null;b.prototype._baseUrl=null;return b});
define ("tool_lp/planactions",["jquery","core/templates","core/ajax","core/notification","core/str","tool_lp/menubar","tool_lp/dialogue"],function(a,b,c,d,e,f,g){var h=function(a){this._type=a;if("plan"===a){this._region="[data-region=\"plan-page\"]";this._planNode="[data-region=\"plan-page\"]";this._template="tool_lp/plan_page";this._contextMethod="tool_lp_data_for_plan_page"}else if("plans"===a){this._region="[data-region=\"plans\"]";this._planNode="[data-region=\"plan-node\"]";this._template="tool_lp/plans_page";this._contextMethod="tool_lp_data_for_plans_page"}else{throw new TypeError("Unexpected type.")}};h.prototype._contextMethod=null;h.prototype._planNode=null;h.prototype._region=null;h.prototype._template=null;h.prototype._type=null;h.prototype._getContextArgs=function(a){var b=this,c={};if("plan"===b._type){c={planid:a.id}}else if("plans"===b._type){c={userid:a.userid}}return c};h.prototype.refresh=function(b){var c=this._findPlanData(a(b));this._callAndRefresh([],c)};h.prototype._renderView=function(c){var d=this;return b.render(d._template,c).then(function(c,e){a(d._region).replaceWith(c);b.runTemplateJS(e)})};h.prototype._callAndRefresh=function(b,e){var f="tool_lp/planactions:_callAndRefresh-"+Math.floor(Math.random()*Math.floor(1e3));M.util.js_pending(f);var g=this;b.push({methodname:g._contextMethod,args:g._getContextArgs(e)});return a.when.apply(a,c.call(b)).then(function(){return g._renderView(arguments[arguments.length-1])}).fail(d.exception).always(function(){return M.util.js_complete(f)})};h.prototype._doDelete=function(a){var b=this,c=[{methodname:"core_competency_delete_plan",args:{id:a.id}}];b._callAndRefresh(c,a)};h.prototype.deletePlan=function(a){var b=this,f;f=c.call([{methodname:"core_competency_read_plan",args:{id:a.id}}]);f[0].done(function(c){e.get_strings([{key:"confirm",component:"moodle"},{key:"deleteplan",component:"tool_lp",param:c.name},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],function(){b._doDelete(a)})}).fail(d.exception)}).fail(d.exception)};h.prototype._doReopenPlan=function(a){var b=this,c=[{methodname:"core_competency_reopen_plan",args:{planid:a.id}}];b._callAndRefresh(c,a)};h.prototype.reopenPlan=function(a){var b=this,f=c.call([{methodname:"core_competency_read_plan",args:{id:a.id}}]);f[0].done(function(c){e.get_strings([{key:"confirm",component:"moodle"},{key:"reopenplanconfirm",component:"tool_lp",param:c.name},{key:"reopenplan",component:"tool_lp"},{key:"cancel",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],function(){b._doReopenPlan(a)})}).fail(d.exception)}).fail(d.exception)};h.prototype._doCompletePlan=function(a){var b=this,c=[{methodname:"core_competency_complete_plan",args:{planid:a.id}}];b._callAndRefresh(c,a)};h.prototype.completePlan=function(a){var b=this,f=c.call([{methodname:"core_competency_read_plan",args:{id:a.id}}]);f[0].done(function(c){e.get_strings([{key:"confirm",component:"moodle"},{key:"completeplanconfirm",component:"tool_lp",param:c.name},{key:"completeplan",component:"tool_lp"},{key:"cancel",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],function(){b._doCompletePlan(a)})}).fail(d.exception)}).fail(d.exception)};h.prototype._doUnlinkPlan=function(a){var b=this,c=[{methodname:"core_competency_unlink_plan_from_template",args:{planid:a.id}}];b._callAndRefresh(c,a)};h.prototype.unlinkPlan=function(a){var b=this,f=c.call([{methodname:"core_competency_read_plan",args:{id:a.id}}]);f[0].done(function(c){e.get_strings([{key:"confirm",component:"moodle"},{key:"unlinkplantemplateconfirm",component:"tool_lp",param:c.name},{key:"unlinkplantemplate",component:"tool_lp"},{key:"cancel",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],function(){b._doUnlinkPlan(a)})}).fail(d.exception)}).fail(d.exception)};h.prototype._doRequestReview=function(a){var b=[{methodname:"core_competency_plan_request_review",args:{id:a.id}}];this._callAndRefresh(b,a)};h.prototype.requestReview=function(a){this._doRequestReview(a)};h.prototype._doCancelReviewRequest=function(a){var b=[{methodname:"core_competency_plan_cancel_review_request",args:{id:a.id}}];this._callAndRefresh(b,a)};h.prototype.cancelReviewRequest=function(a){this._doCancelReviewRequest(a)};h.prototype._doStartReview=function(a){var b=[{methodname:"core_competency_plan_start_review",args:{id:a.id}}];this._callAndRefresh(b,a)};h.prototype.startReview=function(a){this._doStartReview(a)};h.prototype._doStopReview=function(a){var b=[{methodname:"core_competency_plan_stop_review",args:{id:a.id}}];this._callAndRefresh(b,a)};h.prototype.stopReview=function(a){this._doStopReview(a)};h.prototype._doApprove=function(a){var b=[{methodname:"core_competency_approve_plan",args:{id:a.id}}];this._callAndRefresh(b,a)};h.prototype.approve=function(a){this._doApprove(a)};h.prototype._doUnapprove=function(a){var b=[{methodname:"core_competency_unapprove_plan",args:{id:a.id}}];this._callAndRefresh(b,a)};h.prototype.unapprove=function(a){this._doUnapprove(a)};h.prototype._showLinkedCoursesHandler=function(f){f.preventDefault();var h=a(f.target).data("id"),i=c.call([{methodname:"tool_lp_list_courses_using_competency",args:{id:h}}]);i[0].done(function(a){b.render("tool_lp/linked_courses_summary",{courses:a}).done(function(a){e.get_string("linkedcourses","tool_lp").done(function(b){new g(b,a)}).fail(d.exception)}).fail(d.exception)}).fail(d.exception)};h.prototype._eventHandler=function(b,c){c.preventDefault();var d=this._findPlanData(a(c.target));this[b](d)};h.prototype._findPlanData=function(b){var c=b.parentsUntil(a(this._region).parent(),this._planNode),d;if(1!=c.length){throw new Error("The plan node was not located.")}d=c.data();if("undefined"==typeof d||"undefined"==typeof d.id){throw new Error("Plan data could not be found.")}return d};h.prototype.enhanceMenubar=function(a){f.enhance(a,{'[data-action="plan-delete"]':this._eventHandler.bind(this,"deletePlan"),'[data-action="plan-complete"]':this._eventHandler.bind(this,"completePlan"),'[data-action="plan-reopen"]':this._eventHandler.bind(this,"reopenPlan"),'[data-action="plan-unlink"]':this._eventHandler.bind(this,"unlinkPlan"),'[data-action="plan-request-review"]':this._eventHandler.bind(this,"requestReview"),'[data-action="plan-cancel-review-request"]':this._eventHandler.bind(this,"cancelReviewRequest"),'[data-action="plan-start-review"]':this._eventHandler.bind(this,"startReview"),'[data-action="plan-stop-review"]':this._eventHandler.bind(this,"stopReview"),'[data-action="plan-approve"]':this._eventHandler.bind(this,"approve"),'[data-action="plan-unapprove"]':this._eventHandler.bind(this,"unapprove")})};h.prototype.registerEvents=function(){var b=a(this._region);b.find("[data-action=\"plan-delete\"]").click(this._eventHandler.bind(this,"deletePlan"));b.find("[data-action=\"plan-complete\"]").click(this._eventHandler.bind(this,"completePlan"));b.find("[data-action=\"plan-reopen\"]").click(this._eventHandler.bind(this,"reopenPlan"));b.find("[data-action=\"plan-unlink\"]").click(this._eventHandler.bind(this,"unlinkPlan"));b.find("[data-action=\"plan-request-review\"]").click(this._eventHandler.bind(this,"requestReview"));b.find("[data-action=\"plan-cancel-review-request\"]").click(this._eventHandler.bind(this,"cancelReviewRequest"));b.find("[data-action=\"plan-start-review\"]").click(this._eventHandler.bind(this,"startReview"));b.find("[data-action=\"plan-stop-review\"]").click(this._eventHandler.bind(this,"stopReview"));b.find("[data-action=\"plan-approve\"]").click(this._eventHandler.bind(this,"approve"));b.find("[data-action=\"plan-unapprove\"]").click(this._eventHandler.bind(this,"unapprove"));b.find("[data-action=\"find-courses-link\"]").click(this._showLinkedCoursesHandler.bind(this))};return h});
define ("tool_lp/user_competency_course_navigation",["jquery"],function(a){var b=function(b,c,d,e,f,g){this._baseUrl=d;this._userId=e+"";this._competencyId=f+"";this._courseId=g;a(b).on("change",this._userChanged.bind(this));a(c).on("change",this._competencyChanged.bind(this))};b.prototype._userChanged=function(b){var c=a(b.target).val(),d="?userid="+c+"&courseid="+this._courseId+"&competencyid="+this._competencyId;document.location=this._baseUrl+d};b.prototype._competencyChanged=function(b){var c=a(b.target).val(),d="?userid="+this._userId+"&courseid="+this._courseId+"&competencyid="+c;document.location=this._baseUrl+d};b.prototype._competencyId=null;b.prototype._userId=null;b.prototype._courseId=null;b.prototype._baseUrl=null;b.prototype._ignoreFirstCompetency=null;return b});
define ("tool_moodlenet/instance_form",["tool_moodlenet/validator","tool_moodlenet/selectors","core/loadingicon","core/templates","core/notification","jquery"],function(a,b,c,d,e,f){var g=function(d){d.addEventListener("click",function(f){if(f.target.matches(b.action.submit)){var e=d.querySelector("[data-var=\"mnet-link\"]"),g=d.querySelector(b.region.spinner),h=document.querySelector(b.region.validationArea);g.classList.remove("d-none");var i=c.addIconToContainerWithPromise(g);a.validation(e).then(function(a){i.resolve();g.classList.add("d-none");if(a.result){e.classList.remove("is-invalid");e.classList.add("is-valid");h.innerText=a.message;h.classList.remove("text-error");h.classList.add("text-success");setTimeout(function(){window.location=a.domain},1e3)}else{e.classList.add("is-invalid");h.innerText=a.message;h.classList.add("text-error")}}).catch()}})},h=function(a,b,h,i){a.innerHTML="";var j=c.addIconToContainer(a),k=null,l=new Promise(function(a){k=a});f.when(j,l).then(function(){d.replaceNodeContents(a,b.customcarouseltemplate,"")}).catch(e.exception);g(a);h.one("slid.bs.carousel",function(){k()});h.carousel(2);i.setFooter(d.render("tool_moodlenet/chooser_footer_close_mnet",{}))},i=function(a,b,c){a.carousel(0);b.setFooter(c.customfootertemplate)};return{footerClickListener:function footerClickListener(a,c,d){if(a.target.matches(b.action.showMoodleNet)||a.target.closest(b.action.showMoodleNet)){a.preventDefault();var e=f(d.getBody()[0].querySelector(b.region.carousel)),g=e.find(b.region.moodleNet)[0];h(g,c,e,d)}if(a.target.matches(b.action.closeOption)){var j=f(d.getBody()[0].querySelector(b.region.carousel));i(j,d,c)}}}});
define ("tool_moodlenet/select_page",["core/ajax","core/templates","tool_moodlenet/selectors","core/notification"],function(a,b,c,d){var e,f=function(a){return b.renderPix("courses","tool_moodlenet").then(function(a){return a}).then(function(a){var c=document.createElement("div");c.innerHTML=a.trim();return b.render("core_course/no-courses",{nocoursesimg:c.firstChild.src})}).then(function(c,d){b.replaceNodeContents(a,c,d);a.classList.add("mx-auto");a.classList.add("w-25")})},g=function(a,c){return b.render("tool_moodlenet/view-cards",{courses:c}).then(function(c,d){b.replaceNodeContents(a,c,d);a.classList.remove("mx-auto");a.classList.remove("w-25")})},h=function(b,h,i){var j=h.querySelector(c.region.searchIcon),k=h.querySelector(c.region.clearIcon);if(""!==b){j.classList.add("d-none");k.parentElement.classList.remove("d-none")}else{j.classList.remove("d-none");k.parentElement.classList.add("d-none")}a.call([{methodname:"tool_moodlenet_search_courses",args:{searchvalue:b}}])[0].then(function(a){if(0===a.courses.length){return f(i)}else{a.courses.forEach(function(a){a.viewurl+="&id="+e});return g(i,a.courses)}}).catch(d.exception)},i=function(a){var b=a.querySelector(c.region.searchInput),d=a.querySelector(c.region.courses),e=a.querySelector(c.region.clearIcon);e.addEventListener("click",function(){b.value="";h("",a,d)});b.addEventListener("input",k(function(){h(b.value,a,d)},300))},j=function(a){var b=a.querySelector(c.region.courses);h("",a,b)},k=function(a,b,c){var d;return function(){var e=this,f=arguments,g=c&&!d;clearTimeout(d);d=setTimeout(function later(){d=null;if(!c){a.apply(e,f)}},b);if(g){a.apply(e,f)}}};return{init:function init(a){e=a;var b=document.querySelector(c.region.selectPage);i(b);j(b)}}});
define ("tool_moodlenet/selectors",[],function(){return{action:{browse:"[data-action=\"browse\"]",submit:"[data-action=\"submit\"]",showMoodleNet:"[data-action=\"show-moodlenet\"]",closeOption:"[data-action=\"close-chooser-option-summary\"]"},region:{clearIcon:"[data-region=\"clear-icon\"]",courses:"[data-region=\"mnet-courses\"]",instancePage:"[data-region=\"moodle-net\"]",searchInput:"[data-region=\"search-input\"]",searchIcon:"[data-region=\"search-icon\"]",selectPage:"[data-region=\"moodle-net-select\"]",spinner:"[data-region=\"spinner\"]",validationArea:"[data-region=\"validation-area\"]",carousel:"[data-region=\"carousel\"]",moodleNet:"[data-region=\"pluginCarousel\"]"}}});
define ("tool_moodlenet/validator",["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){return{validation:function(e){var f=e.value;if(""===f||!f.includes("@")){a.when(c.get_string("profilevalidationerror","tool_moodlenet")).then(function(a){return Promise.reject().catch(function(){return{result:!1,message:a[0]}})}).fail(d.exception)}return b.call([{methodname:"tool_moodlenet_verify_webfinger",args:{profileurl:f,course:e.dataset.courseid,section:e.dataset.sectionid}}])[0].then(function(a){return a}).catch()}}});
define ("tool_policy/acceptances_filter",["jquery","core/form-autocomplete","core/str","core/notification"],function(a,b,c,d){var e={UNIFIED_FILTERS:"#unified-filters"},f=function init(){M.util.js_pending("acceptances_filter_datasource");c.get_strings([{key:"filterplaceholder",component:"tool_policy"},{key:"nofiltersapplied",component:"tool_policy"}]).done(function(a){var c=a[0],f=a[1];b.enhance(e.UNIFIED_FILTERS,!0,"tool_policy/acceptances_filter_datasource",c,!1,!0,f,!0).then(function(){M.util.js_complete("acceptances_filter_datasource")}).fail(d.exception)}).fail(d.exception);var f=a(e.UNIFIED_FILTERS).val();a(e.UNIFIED_FILTERS).on("change",function(){var b=a(this).val(),c=[],d=[],e=!1;a.each(b,function(a,b){var f=b.split(":",2);if(2!==f.length){d.push(b);return!0}var g=f[0],h=f[1];if("undefined"!=typeof c[g]){e=!0}c[g]=h;return!0});if(e){var g=[];for(var h in c){g.push(h+":"+c[h])}g=g.concat(d);a(this).val(g)}if(f.join(",")!=b.join(",")){this.form.submit()}})},g=function getForm(){return a(e.UNIFIED_FILTERS).closest("form")};return{init:function init(){f()},getForm:function getForm(){return g()}}});
define ("tool_policy/acceptances_filter_datasource",["jquery","core/ajax","core/notification"],function(a,b,c){return{list:function list(b,c){var d=[],e=a(b),f=a(b).data("originaloptionsjson"),g=e.val();a.each(f,function(b,e){if(""!==c.trim()&&-1===e.label.toLocaleLowerCase().indexOf(c.toLocaleLowerCase())){return!0}if(-1<a.inArray(e.value,g)){return!0}d.push(e);return!0});var h=new a.Deferred;h.resolve(d);return h.promise()},processResults:function processResults(b,c){var d=[];a.each(c,function(a,b){d.push({value:b.value,label:b.label})});return d},transport:function transport(a,b,d){this.list(a,b).then(d).catch(c.exception)}}});
define ("tool_policy/acceptmodal",["jquery","core/str","core/modal_factory","core/modal_events","core/notification","core/fragment","core/ajax","core/yui"],function(a,b,c,d,f,g,h,i){"use strict";var e=function(a){this.contextid=a;this.init()};e.prototype.modal=null;e.prototype.contextid=-1;e.prototype.currentTrigger=null;e.prototype.triggers={SINGLE:"a[data-action=acceptmodal]",BULK:"input[data-action=acceptmodal]"};e.prototype.init=function(){a(this.triggers.SINGLE).on("click",function(b){b.preventDefault();this.currentTrigger=a(b.currentTarget);var c=a(b.currentTarget).attr("href"),d=c.slice(c.indexOf("?")+1);this.showFormModal(d)}.bind(this));a(this.triggers.BULK).on("click",function(c){c.preventDefault();this.currentTrigger=a(c.currentTarget);var d=a(c.currentTarget).closest("form");if(d.find("input[type=checkbox][name=\"userids[]\"]:checked").length){var e=d.serialize();this.showFormModal(e)}else{b.get_strings([{key:"notice"},{key:"selectusersforconsent",component:"tool_policy"},{key:"ok"}]).then(function(a){f.alert(a[0],a[1],a[2])}).fail(f.exception)}}.bind(this))};e.prototype.showFormModal=function(a){for(var d,e=a.split("&"),g=0,h;g<e.length;g++){h=e[g].split("=");if("action"==h[0]){d=h[1]}}b.get_strings([{key:"statusformtitleaccept",component:"tool_policy"},{key:"iagreetothepolicy",component:"tool_policy"},{key:"statusformtitlerevoke",component:"tool_policy"},{key:"irevokethepolicy",component:"tool_policy"},{key:"statusformtitledecline",component:"tool_policy"},{key:"declinethepolicy",component:"tool_policy"}]).then(function(b){var e,f;if("accept"==d){e=b[0];f=b[1]}else if("revoke"==d){e=b[2];f=b[3]}else if("decline"==d){e=b[4];f=b[5]}return c.create({type:c.types.SAVE_CANCEL,title:e,body:""}).done(function(b){this.modal=b;this.setupFormModal(a,f)}.bind(this))}.bind(this)).catch(f.exception)};e.prototype.setupFormModal=function(a,b){var c=this.modal;c.setLarge();c.setSaveButtonText(b);c.getRoot().on(d.hidden,this.destroy.bind(this));c.setBody(this.getBody(a));c.getRoot().on(d.save,this.submitForm.bind(this));c.getRoot().on("submit","form",this.submitFormAjax.bind(this));c.show()};e.prototype.getBody=function(a){if("undefined"==typeof a){a={}}var b={jsonformdata:JSON.stringify(a)};return g.loadFragment("tool_policy","accept_on_behalf",this.contextid,b)};e.prototype.submitFormAjax=function(a){a.preventDefault();var b=this.modal.getRoot().find("form").serialize(),c=h.call([{methodname:"tool_policy_submit_accept_on_behalf",args:{jsonformdata:JSON.stringify(b)}}]);c[0].done(function(a){if(a.validationerrors){this.modal.setBody(this.getBody(b))}else{this.close()}}.bind(this)).fail(f.exception)};e.prototype.submitForm=function(a){a.preventDefault();this.modal.getRoot().find("form").submit()};e.prototype.close=function(){this.destroy();document.location.reload()};e.prototype.destroy=function(){i.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()});this.modal.destroy();this.currentTrigger.focus()};return{getInstance:function getInstance(a){return new e(a)}}});
define ("tool_policy/jquery-eu-cookie-law-popup",["jquery"],function(a){if(!window.console)window.console={};if(!window.console.log)window.console.log=function(){};a.fn.euCookieLawPopup=function(){var b=this;b.params={cookiePolicyUrl:"/?cookie-policy",popupPosition:"top",colorStyle:"default",compactStyle:!1,popupTitle:"This website is using cookies",popupText:"We use cookies to ensure that we give you the best experience on our website. If you continue without changing your settings, we'll assume that you are happy to receive all cookies on this website.",buttonContinueTitle:"Continue",buttonLearnmoreTitle:"Learn&nbsp;more",buttonLearnmoreOpenInNewWindow:!0,agreementExpiresInDays:30,autoAcceptCookiePolicy:!1,htmlMarkup:null};b.vars={INITIALISED:!1,HTML_MARKUP:null,COOKIE_NAME:"EU_COOKIE_LAW_CONSENT"};var c=function(c,d,e){if(c){var f=a(c).attr("class")?a(c).attr("class"):"";if(-1<f.indexOf("eupopup-top")){b.params.popupPosition="top"}else if(-1<f.indexOf("eupopup-fixedtop")){b.params.popupPosition="fixedtop"}else if(-1<f.indexOf("eupopup-bottomright")){b.params.popupPosition="bottomright"}else if(-1<f.indexOf("eupopup-bottomleft")){b.params.popupPosition="bottomleft"}else if(-1<f.indexOf("eupopup-bottom")){b.params.popupPosition="bottom"}else if(-1<f.indexOf("eupopup-block")){b.params.popupPosition="block"}if(-1<f.indexOf("eupopup-color-default")){b.params.colorStyle="default"}else if(-1<f.indexOf("eupopup-color-inverse")){b.params.colorStyle="inverse"}if(-1<f.indexOf("eupopup-style-compact")){b.params.compactStyle=!0}}if(d){b.params.htmlMarkup=d}if(e){if("undefined"!=typeof e.cookiePolicyUrl){b.params.cookiePolicyUrl=e.cookiePolicyUrl}if("undefined"!=typeof e.popupPosition){b.params.popupPosition=e.popupPosition}if("undefined"!=typeof e.colorStyle){b.params.colorStyle=e.colorStyle}if("undefined"!=typeof e.popupTitle){b.params.popupTitle=e.popupTitle}if("undefined"!=typeof e.popupText){b.params.popupText=e.popupText}if("undefined"!=typeof e.buttonContinueTitle){b.params.buttonContinueTitle=e.buttonContinueTitle}if("undefined"!=typeof e.buttonLearnmoreTitle){b.params.buttonLearnmoreTitle=e.buttonLearnmoreTitle}if("undefined"!=typeof e.buttonLearnmoreOpenInNewWindow){b.params.buttonLearnmoreOpenInNewWindow=e.buttonLearnmoreOpenInNewWindow}if("undefined"!=typeof e.agreementExpiresInDays){b.params.agreementExpiresInDays=e.agreementExpiresInDays}if("undefined"!=typeof e.autoAcceptCookiePolicy){b.params.autoAcceptCookiePolicy=e.autoAcceptCookiePolicy}if("undefined"!=typeof e.htmlMarkup){b.params.htmlMarkup=e.htmlMarkup}}},d=function(){if(b.params.htmlMarkup){return b.params.htmlMarkup}var a="<div class=\"eupopup-container eupopup-container-"+b.params.popupPosition+(b.params.compactStyle?" eupopup-style-compact":"")+" eupopup-color-"+b.params.colorStyle+"\"><div class=\"eupopup-head\">"+b.params.popupTitle+"</div><div class=\"eupopup-body\">"+b.params.popupText+"</div><div class=\"eupopup-buttons\"><a href=\"#\" class=\"eupopup-button eupopup-button_1\">"+b.params.buttonContinueTitle+"</a><a href=\""+b.params.cookiePolicyUrl+"\""+(b.params.buttonLearnmoreOpenInNewWindow?" target=_blank ":"")+" class=\"eupopup-button eupopup-button_2\">"+b.params.buttonLearnmoreTitle+"</a><div class=\"clearfix\"></div></div><a href=\"#\" class=\"eupopup-closebutton\">x</a></div>";return a},e=function(c){var e=new Date,d=1e3*(60*(60*(24*b.params.agreementExpiresInDays)));e.setTime(e.getTime()+d);var f="expires="+e.toGMTString();document.cookie=b.vars.COOKIE_NAME+"="+c+"; "+f+";path=/";a(document).trigger("user_cookie_consent_changed",{consent:c})},f=function(){for(var a=!1,d=document.cookie.split(";"),e=0,f;e<d.length;e++){f=d[e].trim();if(-1!==f.indexOf(b.vars.COOKIE_NAME)){a=f.substring(b.vars.COOKIE_NAME.length+1,f.length)}}return a},g=function(){a(".eupopup-container").animate({opacity:0,height:0},200,function(){a(".eupopup-container").hide(0)})};return{init:function init(h){c(a(".eupopup").first(),a(".eupopup-markup").html(),h);if(f()){a(document).trigger("user_cookie_already_accepted",{consent:!0});return}if(b.vars.INITIALISED){return}b.vars.INITIALISED=!0;b.vars.HTML_MARKUP=d();if(0<a(".eupopup-block").length){a(".eupopup-block").append(b.vars.HTML_MARKUP)}else{a("BODY").append(b.vars.HTML_MARKUP)}a(".eupopup-button_1").click(function(){e(!0);g();return!1});a(".eupopup-closebutton").click(function(){e(!0);g();return!1});a(".eupopup-container").show();if(b.params.autoAcceptCookiePolicy){e(!0)}}}}});
define ("tool_policy/managedocsactions",["jquery","core/log","core/config","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){"use strict";var h={LINKS:"[data-action]",MAKE_CURRENT:"[data-action=\"makecurrent\"]",INACTIVATE:"[data-action=\"inactivate\"]",DELETE:"[data-action=\"delete\"]"};function g(a){this.base=a;this.initEvents()}g.prototype.initEvents=function(){var g=this;g.base.on("click",h.LINKS,function(g){g.stopPropagation();var i=a(g.currentTarget),j,k;if(i.is(h.MAKE_CURRENT)){j=d.get_strings([{key:"activating",component:"tool_policy"},{key:"activateconfirm",component:"tool_policy",param:{name:i.closest("[data-policy-name]").attr("data-policy-name"),revision:i.closest("[data-policy-revision]").attr("data-policy-revision")}},{key:"activateconfirmyes",component:"tool_policy"}])}else if(i.is(h.INACTIVATE)){j=d.get_strings([{key:"inactivating",component:"tool_policy"},{key:"inactivatingconfirm",component:"tool_policy",param:{name:i.closest("[data-policy-name]").attr("data-policy-name"),revision:i.closest("[data-policy-revision]").attr("data-policy-revision")}},{key:"inactivatingconfirmyes",component:"tool_policy"}])}else if(i.is(h.DELETE)){j=d.get_strings([{key:"deleting",component:"tool_policy"},{key:"deleteconfirm",component:"tool_policy",param:{name:i.closest("[data-policy-name]").attr("data-policy-name"),revision:i.closest("[data-policy-revision]").attr("data-policy-revision")}},{key:"delete",component:"core"}])}else{b.error("unknown action type detected","tool_policy/managedocsactions");return}g.preventDefault();j.then(function(a){k=a;return e.create({title:k[0],body:k[1],type:e.types.SAVE_CANCEL})}).then(function(a){a.setSaveButtonText(k[2]);a.getRoot().on(f.save,function(){window.location.href=i.attr("href")+"&sesskey="+c.sesskey+"&confirm=1"});a.getRoot().on(f.hidden,function(){a.destroy()});a.show();return!0}).catch(function(a){b.error(a);return!1})})};return{init:function init(b){var c=a(document.getElementById(b));if(c.length){return new g(c)}else{throw new Error("managedocsactions: Invalid base element identifier")}}}});
define ("tool_policy/policyactions",["jquery","core/ajax","core/notification","core/modal_factory","core/modal_events"],function(a,b,c,d,e){var f=function(a){this.registerEvents(a)};f.prototype.registerEvents=function(f){f.on("click",function(f){f.preventDefault();var g=a(this).data("versionid"),h=a(this).data("behalfid"),i=a.Deferred(),j=a.Deferred(),k=d.create({title:i,body:j,large:!0}).then(function(a){a.getRoot().on(e.hidden,function(){a.destroy()});return a}).then(function(a){a.show();return a}).catch(c.exception),l=b.call([{methodname:"tool_policy_get_policy_version",args:{versionid:g,behalfid:h}}]);a.when(l[0]).then(function(a){if(a.result.policy){i.resolve(a.result.policy.name);j.resolve(a.result.policy.content);return a}else{throw new Error(a.warnings[0].message)}}).catch(function(a){k.then(function(a){a.hide();a.destroy();return a}).catch(c.exception);return c.addNotification({message:a,type:"error"})})})};return{init:function init(b){b=a(b);return new f(b)}}});
define ("tool_templatelibrary/display",["jquery","core/ajax","core/log","core/notification","core/templates","core/config","core/str"],function(a,b,c,d,e,f,g){var h=function(a,b){if(!a){return!1}var c="@template "+b,d=0,e=[];e=a.match(/{{!([\s\S]*?)}}/g);if(null!==e){for(d=0;d<e.length;d++){var f=e[d],g=f.indexOf(c);if(-1!==g){var h=g+c.length+1;f=f.substr(h,f.length-2-h);return f}}}return!1},i=function(b,f,i){g.get_string("templateselected","tool_templatelibrary",b).done(function(b){a("[data-region=\"displaytemplateheader\"]").text(b)}).fail(d.exception);var j=h(f,b);if(!1===j){j=h(i,b)}if(j){f=j}a("[data-region=\"displaytemplatesource\"]").text(f);var k=f.match(/Example context \(json\):([\s\S]*)/),l=!1;if(k){var m=k[1].trim();try{l=a.parseJSON(m)}catch(a){c.debug("Could not parse json example context for template.");c.debug(a)}}if(l){e.render(b,l).done(function(b,c){e.replaceNodeContents(a("[data-region=\"displaytemplateexample\"]"),b,c)}).fail(d.exception)}else{g.get_string("templatehasnoexample","tool_templatelibrary").done(function(b){a("[data-region=\"displaytemplateexample\"]").text(b)}).fail(d.exception)}},j=function(c){var e=c.split("/"),g=e.shift(),h=e.join("/"),j=b.call([{methodname:"core_output_load_template",args:{component:g,template:h,themename:f.theme,includecomments:!0}},{methodname:"tool_templatelibrary_load_canonical_template",args:{component:g,template:h}}],!0,!1);a.when.apply(a,j).done(function(a,b){i(c,a,b)}).fail(d.exception)};a("[data-region=\"list-templates\"]").on("click","[data-templatename]",function(b){var c=a(this).data("templatename");b.preventDefault();j(c)});return{}});
define ("tool_templatelibrary/search",["jquery","core/ajax","core/log","core/notification","core/templates","core/config"],function(a,b,c,d,e,f){var g=function(b){e.render("tool_templatelibrary/search_results",{templates:b}).done(function(b,c){e.replaceNode(a("[data-region=\"searchresults\"]"),b,c)}).fail(d.exception)},h=function(c){var e=a("[data-field=\"component\"]").val(),f=a("[data-field=\"search\"]").val();b.call([{methodname:"tool_templatelibrary_list_templates",args:{component:e,search:f,themename:c},done:g,fail:d.exception}],!0,!1)},i=null,j=function(a,b){if(null!==i){window.clearTimeout(i)}i=window.setTimeout(function(){a();i=null},b)},k=function(){j(h.bind(this,f.theme),400)};a("[data-region=\"list-templates\"]").on("change","[data-field=\"component\"]",k);a("[data-region=\"list-templates\"]").on("input","[data-field=\"search\"]",k);h(f.theme);return{}});
define ("tool_usertours/managesteps",["jquery","core/str","core/notification"],function(a,b,c){var d={removeStep:function removeStep(d){d.preventDefault();var e=a(d.currentTarget).attr("href");b.get_strings([{key:"confirmstepremovaltitle",component:"tool_usertours"},{key:"confirmstepremovalquestion",component:"tool_usertours"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).then(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){window.location=e})}).catch()},setup:function setup(){a("body").delegate("[data-action=\"delete\"]","click",d.removeStep)}};return{setup:d.setup}});
define ("tool_usertours/managetours",["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){var e={removeTour:function removeTour(b){b.preventDefault();var e=a(b.currentTarget).attr("href");c.get_strings([{key:"confirmtourremovaltitle",component:"tool_usertours"},{key:"confirmtourremovalquestion",component:"tool_usertours"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).then(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){window.location=e})}).catch()},setup:function setup(){a("body").delegate("[data-action=\"delete\"]","click",e.removeTour)}};return{setup:e.setup}});
define ("tool_usertours/tour",["exports","jquery","core/popper"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){e=function(a){return typeof a}}else{e=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return e(a)}function f(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function g(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function h(a,b,c){if(b)g(a.prototype,b);if(c)g(a,c);return a}var i=function(){function a(b){f(this,a);this.init(b)}h(a,[{key:"init",value:function init(a){this.eventHandlers={};this.reset();this.originalConfiguration=a||{};this.configure.apply(this,arguments);try{this.storage=window.sessionStorage;this.storageKey="tourstate_"+this.tourName}catch(a){this.storage=!1;this.storageKey=""}return this}},{key:"reset",value:function reset(){this.hide();this.eventHandlers=[];this.resetStepListeners();this.originalConfiguration={};this.steps=[];this.currentStepNumber=0;return this}},{key:"configure",value:function configure(a){var b=this;if("object"===e(a)){if("undefined"!=typeof a.tourName){this.tourName=a.tourName}if(a.eventHandlers){var c=function(c){a.eventHandlers[c].forEach(function(a){this.addEventHandler(c,a)},b)};for(var d in a.eventHandlers){c(d)}}this.resetStepDefaults(!0);if("object"===e(a.steps)){this.steps=a.steps}if("undefined"!=typeof a.template){this.templateContent=a.template}}this.checkMinimumRequirements();return this}},{key:"checkMinimumRequirements",value:function checkMinimumRequirements(){if(!this.tourName){throw new Error("Tour Name required")}if(!this.steps||!this.steps.length){throw new Error("Steps must be specified")}}},{key:"resetStepDefaults",value:function resetStepDefaults(a){if("undefined"==typeof a){a=!0}this.stepDefaults={};if(!a||"undefined"==typeof this.originalConfiguration.stepDefaults){this.setStepDefaults({})}else{this.setStepDefaults(this.originalConfiguration.stepDefaults)}return this}},{key:"setStepDefaults",value:function setStepDefaults(a){if(!this.stepDefaults){this.stepDefaults={}}b.default.extend(this.stepDefaults,{element:"",placement:"top",delay:0,moveOnClick:!1,moveAfterTime:0,orphan:!1,direction:1},a);return this}},{key:"getCurrentStepNumber",value:function getCurrentStepNumber(){return parseInt(this.currentStepNumber,10)}},{key:"setCurrentStepNumber",value:function setCurrentStepNumber(a){this.currentStepNumber=a;if(this.storage){try{this.storage.setItem(this.storageKey,a)}catch(a){if(a.code===DOMException.QUOTA_EXCEEDED_ERR){this.storage.removeItem(this.storageKey)}}}}},{key:"getNextStepNumber",value:function getNextStepNumber(a){if("undefined"==typeof a){a=this.getCurrentStepNumber()}var b=a+1;while(b<=this.steps.length){if(this.isStepPotentiallyVisible(this.getStepConfig(b))){return b}b++}return null}},{key:"getPreviousStepNumber",value:function getPreviousStepNumber(a){if("undefined"==typeof a){a=this.getCurrentStepNumber()}var b=a-1;while(0<=b){if(this.isStepPotentiallyVisible(this.getStepConfig(b))){return b}b--}return null}},{key:"isLastStep",value:function isLastStep(a){var b=this.getNextStepNumber(a);return null===b}},{key:"isFirstStep",value:function isFirstStep(a){var b=this.getPreviousStepNumber(a);return null===b}},{key:"isStepPotentiallyVisible",value:function isStepPotentiallyVisible(a){if(!a){return!1}if(this.isStepActuallyVisible(a)){return!0}if("undefined"!=typeof a.orphan&&a.orphan){return!0}if("undefined"!=typeof a.delay&&a.delay){return!0}return!1}},{key:"isStepActuallyVisible",value:function isStepActuallyVisible(a){if(!a){return!1}var b=this.getStepTarget(a);if(b&&b.length&&b.is(":visible")){return!!b.length}return!1}},{key:"next",value:function next(){return this.gotoStep(this.getNextStepNumber())}},{key:"previous",value:function previous(){return this.gotoStep(this.getPreviousStepNumber(),-1)}},{key:"gotoStep",value:function gotoStep(a,b){if(0>a){return this.endTour()}var c=this.getStepConfig(a);if(null===c){return this.endTour()}return this._gotoStep(c,b)}},{key:"_gotoStep",value:function _gotoStep(a,b){if(!a){return this.endTour()}if("undefined"!=typeof a.delay&&a.delay&&!a.delayed){a.delayed=!0;window.setTimeout(this._gotoStep.bind(this),a.delay,a,b);return this}else if(!a.orphan&&!this.isStepActuallyVisible(a)){var c=-1==b?"getPreviousStepNumber":"getNextStepNumber";return this.gotoStep(this[c](a.stepNumber),b)}this.hide();this.fireEventHandlers("beforeRender",a);this.renderStep(a);this.fireEventHandlers("afterRender",a);return this}},{key:"getStepConfig",value:function getStepConfig(a){if(null===a||0>a||a>=this.steps.length){return null}var c=this.normalizeStepConfig(this.steps[a]);c=b.default.extend(c,{stepNumber:a});return c}},{key:"normalizeStepConfig",value:function normalizeStepConfig(a){if("undefined"!=typeof a.reflex&&"undefined"==typeof a.moveAfterClick){a.moveAfterClick=a.reflex}if("undefined"!=typeof a.element&&"undefined"==typeof a.target){a.target=a.element}if("undefined"!=typeof a.content&&"undefined"==typeof a.body){a.body=a.content}a=b.default.extend({},this.stepDefaults,a);a=b.default.extend({},{attachTo:a.target,attachPoint:"after"},a);if(a.attachTo){a.attachTo=(0,b.default)(a.attachTo).first()}return a}},{key:"getStepTarget",value:function getStepTarget(a){if(a.target){return(0,b.default)(a.target)}return null}},{key:"fireEventHandlers",value:function fireEventHandlers(a,b){if("undefined"==typeof this.eventHandlers[a]){return this}this.eventHandlers[a].forEach(function(a){a.call(this,b)},this);return this}},{key:"addEventHandler",value:function addEventHandler(a,b){if("undefined"==typeof this.eventHandlers[a]){this.eventHandlers[a]=[]}this.eventHandlers[a].push(b);return this}},{key:"processStepListeners",value:function processStepListeners(a){this.listeners.push({node:this.currentStepNode,args:["click","[data-role=\"next\"]",b.default.proxy(this.next,this)]},{node:this.currentStepNode,args:["click","[data-role=\"previous\"]",b.default.proxy(this.previous,this)]},{node:this.currentStepNode,args:["click","[data-role=\"end\"]",b.default.proxy(this.endTour,this)]},{node:(0,b.default)("[data-flexitour=\"backdrop\"]"),args:["click",b.default.proxy(this.hide,this)]},{node:(0,b.default)("body"),args:["keydown",b.default.proxy(this.handleKeyDown,this)]});if(a.moveOnClick){var c=this.getStepTarget(a);this.listeners.push({node:c,args:["click",b.default.proxy(function(a){if(0===(0,b.default)(a.target).parents("[data-flexitour=\"container\"]").length){window.setTimeout(b.default.proxy(this.next,this),500)}},this)]})}this.listeners.forEach(function(a){a.node.on.apply(a.node,a.args)});return this}},{key:"resetStepListeners",value:function resetStepListeners(){if(this.listeners){this.listeners.forEach(function(a){a.node.off.apply(a.node,a.args)})}this.listeners=[];return this}},{key:"renderStep",value:function renderStep(a){this.currentStepConfig=a;this.setCurrentStepNumber(a.stepNumber);var c=(0,b.default)(this.getTemplateContent());c.find("[data-placeholder=\"title\"]").html(a.title);c.find("[data-placeholder=\"body\"]").html(a.body);if(this.isFirstStep(a.stepNumber)){c.find("[data-role=\"previous\"]").hide()}else{c.find("[data-role=\"previous\"]").prop("disabled",!1)}if(this.isLastStep(a.stepNumber)){c.find("[data-role=\"next\"]").hide();c.find("[data-role=\"end\"]").removeClass("btn-secondary").addClass("btn-primary")}else{c.find("[data-role=\"next\"]").prop("disabled",!1)}c.find("[data-role=\"previous\"]").attr("role","button");c.find("[data-role=\"next\"]").attr("role","button");c.find("[data-role=\"end\"]").attr("role","button");a.template=c;this.addStepToPage(a);this.processStepListeners(a);return this}},{key:"getTemplateContent",value:function getTemplateContent(){return(0,b.default)(this.templateContent).clone()}},{key:"addStepToPage",value:function addStepToPage(a){var d=(0,b.default)("<span data-flexitour=\"container\"></span>").html(a.template).hide(),e=(0,b.default)("body, html").stop(!0,!0);if(this.isStepActuallyVisible(a)){var f=this.getStepTarget(a);f.data("flexitour","target");var g=this.calculateZIndex(f);if(g){a.zIndex=g+1}if(a.zIndex){d.css("zIndex",a.zIndex+1)}this.positionBackdrop(a);(0,b.default)(document.body).append(d);this.currentStepNode=d;this.currentStepNode.css({top:0,left:0});e.animate({scrollTop:this.calculateScrollTop(a)}).promise().then(function(){this.positionStep(a);this.revealStep(a)}.bind(this)).catch(function(){})}else if(a.orphan){a.isOrphan=!0;a.attachTo=(0,b.default)("body").first();a.attachPoint="append";this.positionBackdrop(a);d.addClass("orphan");(0,b.default)(document.body).append(d);this.currentStepNode=d;this.currentStepNode.offset(this.calculateStepPositionInPage());this.currentStepNode.css("position","fixed");this.currentStepPopper=new c.default((0,b.default)("body"),this.currentStepNode[0],{removeOnDestroy:!0,placement:a.placement+"-start",arrowElement:"[data-role=\"arrow\"]",modifiers:{hide:{enabled:!1},applyStyle:{onLoad:null,enabled:!1}}});this.revealStep(a)}return this}},{key:"revealStep",value:function revealStep(a){this.currentStepNode.fadeIn("",b.default.proxy(function(){this.announceStep(a);this.currentStepNode.focus();window.setTimeout(b.default.proxy(function(){if(this.currentStepNode){this.currentStepNode.focus()}},this),100)},this));return this}},{key:"announceStep",value:function announceStep(a){var b="tour-step-"+this.tourName+"-"+a.stepNumber;this.currentStepNode.attr("id",b);var c=this.currentStepNode.find("[data-placeholder=\"body\"]").first();c.attr("id",b+"-body");c.attr("role","document");var d=this.currentStepNode.find("[data-placeholder=\"title\"]").first();d.attr("id",b+"-title");d.attr("aria-labelledby",b+"-body");this.currentStepNode.attr("role","dialog");this.currentStepNode.attr("tabindex",0);this.currentStepNode.attr("aria-labelledby",b+"-title");this.currentStepNode.attr("aria-describedby",b+"-body");var e=this.getStepTarget(a);if(e){if(!e.attr("tabindex")){e.attr("tabindex",0)}e.data("original-describedby",e.attr("aria-describedby")).attr("aria-describedby",b+"-body")}this.accessibilityShow(a);return this}},{key:"handleKeyDown",value:function handleKeyDown(a){var c="a[href], link[href], [draggable=true], [contenteditable=true], ";c+=":input:enabled, [tabindex], button:enabled";switch(a.keyCode){case 27:this.endTour();break;case 9:(function(){if(!this.currentStepConfig.hasBackdrop){return}var d=(0,b.default)(document.activeElement),e=this.getStepTarget(this.currentStepConfig),f=(0,b.default)(c),g=(0,b.default)("span[data-flexitour=\"container\"]"),h;if(e){f=f.filter(function(a,b){return null!==e&&(e.has(b).length||g.has(b).length||e.is(b)||g.is(b))})}f.each(function(a,b){if(d.is(b)){h=a;return!1}return!0});var i,j,k;if(void 0!=h){var l=1;if(a.shiftKey){l=-1}i=h;do{i+=l;j=(0,b.default)(f[i])}while(j.length&&j.is(":disabled")||j.is(":hidden"));if(j.length){k=j.closest(e).length;k=k||j.closest(this.currentStepNode).length}else{k=!1}}if(k){j.focus()}else{if(a.shiftKey){this.currentStepNode.find(c).last().focus()}else{if(this.currentStepConfig.isOrphan){this.currentStepNode.focus()}else{e.focus()}}}a.preventDefault()}).call(this);break;}}},{key:"startTour",value:function startTour(a){if(this.storage&&"undefined"==typeof a){var b=this.storage.getItem(this.storageKey);if(b){var c=parseInt(b,10);if(c<=this.steps.length){a=c}}}if("undefined"==typeof a){a=this.getCurrentStepNumber()}this.fireEventHandlers("beforeStart",a);this.gotoStep(a);this.fireEventHandlers("afterStart",a);return this}},{key:"restartTour",value:function restartTour(){return this.startTour(0)}},{key:"endTour",value:function endTour(){this.fireEventHandlers("beforeEnd");if(this.currentStepConfig){var a=this.getStepTarget(this.currentStepConfig);if(a){if(!a.attr("tabindex")){a.attr("tabindex","-1")}a.focus()}}this.hide(!0);this.fireEventHandlers("afterEnd");return this}},{key:"hide",value:function hide(a){this.fireEventHandlers("beforeHide");if(this.currentStepNode&&this.currentStepNode.length){this.currentStepNode.hide();if(this.currentStepPopper){this.currentStepPopper.destroy()}}if(this.currentStepConfig){var d=this.getStepTarget(this.currentStepConfig);if(d){if(d.data("original-labelledby")){d.attr("aria-labelledby",d.data("original-labelledby"))}if(d.data("original-describedby")){d.attr("aria-describedby",d.data("original-describedby"))}if(d.data("original-tabindex")){d.attr("tabindex",d.data("tabindex"))}}this.currentStepConfig=null}var c=0;if(a){c=400}(0,b.default)("[data-flexitour=\"step-background\"]").remove();(0,b.default)("[data-flexitour=\"step-backdrop\"]").removeAttr("data-flexitour");(0,b.default)("[data-flexitour=\"backdrop\"]").fadeOut(c,function(){(0,b.default)(this).remove()});if(this.currentStepNode&&this.currentStepNode.length){var e=this.currentStepNode.attr("id");if(e){var f="[aria-describedby=\""+e+"-body\"]";(0,b.default)(f).removeAttr("tabindex");(0,b.default)(f).removeAttr("aria-describedby")}}this.resetStepListeners();this.accessibilityHide();this.fireEventHandlers("afterHide");this.currentStepNode=null;this.currentStepPopper=null;return this}},{key:"show",value:function show(){var a=this.getCurrentStepNumber();return this.gotoStep(a)}},{key:"getStepContainer",value:function getStepContainer(){return(0,b.default)(this.currentStepNode)}},{key:"calculateScrollTop",value:function calculateScrollTop(a){var c=(0,b.default)(window).scrollTop(),d=(0,b.default)(window).height(),e=this.getStepTarget(a);if("top"===a.placement){c=e.offset().top-d/2}else if("bottom"===a.placement){c=e.offset().top+e.height()-d/2}else if(e.height()<=.8*d){c=e.offset().top-(d-e.height())/2}else{c=e.offset().top-.2*d}c=Math.max(0,c);c=Math.min((0,b.default)(document).height()-d,c);return Math.ceil(c)}},{key:"calculateStepPositionInPage",value:function calculateStepPositionInPage(){var a=(0,b.default)(window).height(),c=this.currentStepNode.height(),d=(0,b.default)(window).width(),e=this.currentStepNode.width();return{top:Math.ceil((a-c)/2),left:Math.ceil((d-e)/2)}}},{key:"positionStep",value:function positionStep(a){var d=this.currentStepNode;if(!d||!d.length){return this}var e;switch(a.placement){case"left":e=["left","right","top","bottom"];break;case"right":e=["right","left","top","bottom"];break;case"top":e=["top","bottom","right","left"];break;case"bottom":e=["bottom","top","right","left"];break;default:e="flip";break;}var f=this.getStepTarget(a),g={placement:a.placement+"-start",removeOnDestroy:!0,modifiers:{flip:{behaviour:e},arrow:{element:"[data-role=\"arrow\"]"}},onCreate:function onCreate(a){h(a)},onUpdate:function onUpdate(a){h(a)}},h=function(a){var c=a.placement.split("-")[0],d=-1!==["left","right"].indexOf(c),e=a.instance.popper.querySelector("[data-role=\"arrow\"]"),f=(0,b.default)(a.instance.popper.querySelector("[data-role=\"flexitour-step\"]"));if(d){var g=parseFloat(window.getComputedStyle(e).height),h=parseFloat(window.getComputedStyle(e).top),i=parseFloat(window.getComputedStyle(a.instance.popper).height),j=parseFloat(window.getComputedStyle(a.instance.popper).top),k=parseFloat(f.css("borderTopWidth")),l=2*parseFloat(f.css("borderTopLeftRadius")),m=h+g/2,n=i+j-k-l,o=j+k+l;if(m>=n||m<=o){var y=0;if(m>i/2){y=n-g}else{y=o+g}(0,b.default)(e).css("top",y)}}else{var p=parseFloat(window.getComputedStyle(e).width),q=parseFloat(window.getComputedStyle(e).left),r=parseFloat(window.getComputedStyle(a.instance.popper).width),s=parseFloat(window.getComputedStyle(a.instance.popper).left),t=parseFloat(f.css("borderTopWidth")),u=2*parseFloat(f.css("borderTopLeftRadius")),v=q+p/2,w=r+s-t-u,x=s+t+u;if(v>=w||v<=x){var z=0;if(v>r/2){z=w-p}else{z=x+p}(0,b.default)(e).css("left",z)}}},i=(0,b.default)("[data-flexitour=\"step-background\"]");if(i.length){f=i}this.currentStepPopper=new c.default(f,d[0],g);return this}},{key:"positionBackdrop",value:function positionBackdrop(a){if(a.backdrop){this.currentStepConfig.hasBackdrop=!0;var g=(0,b.default)("<div data-flexitour=\"backdrop\"></div>");if(a.zIndex){if("append"===a.attachPoint){a.attachTo.append(g)}else{g.insertAfter(a.attachTo)}}else{(0,b.default)("body").append(g)}if(this.isStepActuallyVisible(a)){var c=(0,b.default)("<div data-flexitour=\"step-background\"></div>"),d=this.getStepTarget(a),e=10,f=d;if(e){f=(0,b.default)("body")}c.css({width:d.outerWidth()+e+e,height:d.outerHeight()+e+e,left:d.offset().left-e,top:d.offset().top-e,backgroundColor:this.calculateInherittedBackgroundColor(f)});if(d.offset().left<e){c.css({width:d.outerWidth()+d.offset().left+e,left:d.offset().left})}if(d.offset().top<e){c.css({height:d.outerHeight()+d.offset().top+e,top:d.offset().top})}var h=d.css("borderRadius");if(h&&h!==(0,b.default)("body").css("borderRadius")){c.css("borderRadius",h)}var i=this.calculatePosition(d);if("fixed"===i){c.css("top",0)}else if("absolute"===i){c.css("position","fixed")}var j=c.clone();j.css({backgroundColor:g.css("backgroundColor"),opacity:g.css("opacity")});j.attr("data-flexitour","step-background-fader");if(a.zIndex){if("append"===a.attachPoint){a.attachTo.append(c)}else{j.insertAfter(a.attachTo);c.insertAfter(a.attachTo)}}else{(0,b.default)("body").append(j);(0,b.default)("body").append(c)}d.attr("data-flexitour","step-backdrop");if(a.zIndex){g.css("zIndex",a.zIndex);c.css("zIndex",a.zIndex+1);d.css("zIndex",a.zIndex+2)}j.fadeOut("2000",function(){(0,b.default)(this).remove()})}}return this}},{key:"calculateZIndex",value:function calculateZIndex(a){a=(0,b.default)(a);while(a.length&&a[0]!==document){var c=a.css("position");if("absolute"===c||"relative"===c||"fixed"===c){var d=parseInt(a.css("zIndex"),10);if(!isNaN(d)&&0!==d){return d}}a=a.parent()}return 0}},{key:"calculateInherittedBackgroundColor",value:function calculateInherittedBackgroundColor(a){var c=(0,b.default)("<div>").hide();(0,b.default)("body").append(c);var d=c.css("backgroundColor");c.remove();a=(0,b.default)(a);while(a.length&&a[0]!==document){var e=a.css("backgroundColor");if(e!==d){return e}a=a.parent()}return null}},{key:"calculatePosition",value:function calculatePosition(a){a=(0,b.default)(a);while(a.length&&a[0]!==document){var c=a.css("position");if("static"!==c){return c}a=a.parent()}return null}},{key:"accessibilityShow",value:function accessibilityShow(){var a="aria-hidden",c=function(b){var c=b.data("flexitour");if(c){switch(c){case"container":case"target":return;}}var d=b.attr(a);if(!d){b.attr("data-has-hidden",!0);b.attr(a,!0)}};this.currentStepNode.siblings().each(function(a,d){c((0,b.default)(d))});this.currentStepNode.parentsUntil("body").siblings().each(function(a,d){c((0,b.default)(d))})}},{key:"accessibilityHide",value:function accessibilityHide(){var a=function(a){var b=a.attr("data-has-hidden");if("undefined"!=typeof b){a.removeAttr("data-has-hidden");a.removeAttr("aria-hidden")}};(0,b.default)("[data-has-hidden]").each(function(c,d){a((0,b.default)(d))})}}]);return a}();a.default=i;return a.default});
define ("tool_usertours/usertours",["core/ajax","tool_usertours/tour","jquery","core/templates","core/str","core/log","core/notification"],function(a,b,c,d,e,f,g){var h={tourId:null,currentTour:null,context:null,init:function init(a,b,d){h.tourId=a;h.context=d;if("undefined"==typeof b){b=!0}if(b){h.fetchTour(a)}h.addResetLink();c("body").on("click","[data-action=\"tool_usertours/resetpagetour\"]",function(a){a.preventDefault();h.resetTourState(h.tourId)})},fetchTour:function fetchTour(b){M.util.js_pending("admin_usertour_fetchTour"+b);c.when(a.call([{methodname:"tool_usertours_fetch_and_start_tour",args:{tourid:b,context:h.context,pageurl:window.location.href}}])[0],d.render("tool_usertours/tourstep",{})).then(function(a,c){if(!a.hasOwnProperty("tourconfig")){return}return h.startBootstrapTour(b,c[0],a.tourconfig)}).always(function(){M.util.js_complete("admin_usertour_fetchTour"+b)}).fail(g.exception)},addResetLink:function addResetLink(){var a;M.util.js_pending("admin_usertour_addResetLink");if(c(".tool_usertours-resettourcontainer").length){a=c(".tool_usertours-resettourcontainer")}else if(c(".logininfo").length){a=c(".logininfo")}else if(c("footer").length){a=c("footer")}else{a=c("body")}d.render("tool_usertours/resettour",{}).then(function(b,c){d.appendNodeContents(a,b,c)}).always(function(){M.util.js_complete("admin_usertour_addResetLink")}).fail()},startBootstrapTour:function startBootstrapTour(a,c,d){if(h.currentTour){d.onEnd=null;h.currentTour.endTour();delete h.currentTour}d.eventHandlers={afterEnd:[h.markTourComplete],afterRender:[h.markStepShown]};d.tourName=d.name;delete d.name;d.template=c;d.steps=d.steps.map(function(a){if("undefined"!=typeof a.element){a.target=a.element;delete a.element}if("undefined"!=typeof a.reflex){a.moveOnClick=!!a.reflex;delete a.reflex}if("undefined"!=typeof a.content){a.body=a.content;delete a.content}return a});h.currentTour=new b(d);return h.currentTour.startTour()},markStepShown:function markStepShown(){var b=this.getStepConfig(this.getCurrentStepNumber());c.when(a.call([{methodname:"tool_usertours_step_shown",args:{tourid:h.tourId,context:h.context,pageurl:window.location.href,stepid:b.stepid,stepindex:this.getCurrentStepNumber()}}])[0]).fail(f.error)},markTourComplete:function markTourComplete(){var b=this.getStepConfig(this.getCurrentStepNumber());c.when(a.call([{methodname:"tool_usertours_complete_tour",args:{tourid:h.tourId,context:h.context,pageurl:window.location.href,stepid:b.stepid,stepindex:this.getCurrentStepNumber()}}])[0]).fail(f.error)},resetTourState:function resetTourState(b){c.when(a.call([{methodname:"tool_usertours_reset_tour",args:{tourid:b,context:h.context,pageurl:window.location.href}}])[0]).then(function(a){if(a.startTour){h.fetchTour(a.startTour)}}).fail(g.exception)}};return{init:h.init,resetTourState:h.resetTourState}});
define ("tool_xmldb/move",["jquery","core/sortable_list","core/ajax","core/notification"],function(a,b,c,d){return{init:function init(e,f){var g=new b("#"+e+" tbody");g.getElementName=function(b){return a.Deferred().resolve(b.attr("data-name"))};var h;a("#"+e+" tbody tr").on(b.EVENTS.DRAGSTART,function(b,c){h=c.sourceList.children().index(c.element);setTimeout(function(){a(".sortable-list-is-dragged").width(c.element.width())},501)}).on(b.EVENTS.DROP,function(a,b){var e=b.targetList.children().index(b.element),g=b.element.find("[data-action="+f+"]");if(b.positionChanged&&g.length){var i={methodname:"tool_xmldb_invoke_move_action",args:{action:f,dir:g.attr("data-dir"),table:g.attr("data-table"),field:g.attr("data-field"),key:g.attr("data-key"),index:g.attr("data-index"),position:e-h}};c.call([i])[0].fail(d.exception)}})}}});
define ("theme_boost/bootstrap/tools/sanitizer",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.sanitizeHtml=function(a,c,d){if(0===a.length){return a}if(d&&"function"==typeof d){return d(a)}for(var e=new window.DOMParser,f=e.parseFromString(a,"text/html"),g=Object.keys(c),h=[].slice.call(f.body.querySelectorAll("*")),j=function(a){var d=h[a],e=d.nodeName.toLowerCase();if(-1===g.indexOf(d.nodeName.toLowerCase())){d.parentNode.removeChild(d);return"continue"}var f=[].slice.call(d.attributes),i=[].concat(c["*"]||[],c[e]||[]);f.forEach(function(a){if(!b(a,i)){d.removeAttribute(a.nodeName)}})},k=0,l=h.length,m;k<l;k++){m=j(k,l);if("continue"===m)continue}return f.body.innerHTML};a.DefaultWhitelist=void 0;var c=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"];a.DefaultWhitelist={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]};function b(a,b){var d=a.nodeName.toLowerCase();if(-1!==b.indexOf(d)){if(-1!==c.indexOf(d)){return!!(a.nodeValue.match(/^(?:(?:https?|mailto|ftp|tel|file):|[^#&/:?]*(?:[#/?]|$))/gi)||a.nodeValue.match(/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i))}return!0}for(var e=b.filter(function(a){return a instanceof RegExp}),f=0,g=e.length;f<g;f++){if(d.match(e[f])){return!0}}return!1}});
define ("theme_boost/bootstrap/alert",["exports","jquery","./util"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function f(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function g(a,b,c){if(b)f(a.prototype,b);if(c)f(a,c);return a}var h="bs.alert",i=".".concat(h),j=b.default.fn.alert,k="close".concat(i),l="closed".concat(i),m="click".concat(i).concat(".data-api"),n=function(){function a(b){e(this,a);this._element=b}g(a,[{key:"close",value:function close(a){var b=this._element;if(a){b=this._getRootElement(a)}var c=this._triggerCloseEvent(b);if(c.isDefaultPrevented()){return}this._removeElement(b)}},{key:"dispose",value:function dispose(){b.default.removeData(this._element,h);this._element=null}},{key:"_getRootElement",value:function _getRootElement(a){var d=c.default.getSelectorFromElement(a),e=!1;if(d){e=document.querySelector(d)}if(!e){e=(0,b.default)(a).closest(".".concat("alert"))[0]}return e}},{key:"_triggerCloseEvent",value:function _triggerCloseEvent(a){var c=b.default.Event(k);(0,b.default)(a).trigger(c);return c}},{key:"_removeElement",value:function _removeElement(a){var d=this;(0,b.default)(a).removeClass("show");if(!(0,b.default)(a).hasClass("fade")){this._destroyElement(a);return}var e=c.default.getTransitionDurationFromElement(a);(0,b.default)(a).one(c.default.TRANSITION_END,function(b){return d._destroyElement(a,b)}).emulateTransitionEnd(e)}},{key:"_destroyElement",value:function _destroyElement(a){(0,b.default)(a).detach().trigger(l).remove()}}],[{key:"_jQueryInterface",value:function _jQueryInterface(c){return this.each(function(){var d=(0,b.default)(this),e=d.data(h);if(!e){e=new a(this);d.data(h,e)}if("close"===c){e[c](this)}})}},{key:"_handleDismiss",value:function _handleDismiss(a){return function(b){if(b){b.preventDefault()}a.close(this)}}},{key:"VERSION",get:function get(){return"4.5.0"}}]);return a}();(0,b.default)(document).on(m,"[data-dismiss=\"alert\"]",n._handleDismiss(new n));b.default.fn.alert=n._jQueryInterface;b.default.fn.alert.Constructor=n;b.default.fn.alert.noConflict=function(){b.default.fn.alert=j;return n._jQueryInterface};a.default=n;return a.default});
define ("theme_boost/bootstrap/button",["exports","jquery"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);function c(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function d(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function e(a,b,c){if(b)d(a.prototype,b);if(c)d(a,c);return a}var f="bs.button",g=".".concat(f),h=".data-api",i=b.default.fn.button,j="active",k="[data-toggle^=\"button\"]",l="input:not([type=\"hidden\"])",m=".btn",n="click".concat(g).concat(h),o="focus".concat(g).concat(h," ")+"blur".concat(g).concat(h),p="load".concat(g).concat(h),q=function(){function a(b){c(this,a);this._element=b}e(a,[{key:"toggle",value:function toggle(){var a=!0,c=!0,d=(0,b.default)(this._element).closest("[data-toggle=\"buttons\"]")[0];if(d){var e=this._element.querySelector(l);if(e){if("radio"===e.type){if(e.checked&&this._element.classList.contains(j)){a=!1}else{var f=d.querySelector(".active");if(f){(0,b.default)(f).removeClass(j)}}}if(a){if("checkbox"===e.type||"radio"===e.type){e.checked=!this._element.classList.contains(j)}(0,b.default)(e).trigger("change")}e.focus();c=!1}}if(!(this._element.hasAttribute("disabled")||this._element.classList.contains("disabled"))){if(c){this._element.setAttribute("aria-pressed",!this._element.classList.contains(j))}if(a){(0,b.default)(this._element).toggleClass(j)}}}},{key:"dispose",value:function dispose(){b.default.removeData(this._element,f);this._element=null}}],[{key:"_jQueryInterface",value:function _jQueryInterface(c){return this.each(function(){var d=(0,b.default)(this).data(f);if(!d){d=new a(this);(0,b.default)(this).data(f,d)}if("toggle"===c){d[c]()}})}},{key:"VERSION",get:function get(){return"4.5.0"}}]);return a}();(0,b.default)(document).on(n,k,function(a){var c=a.target,d=c;if(!(0,b.default)(c).hasClass("btn")){c=(0,b.default)(c).closest(m)[0]}if(!c||c.hasAttribute("disabled")||c.classList.contains("disabled")){a.preventDefault()}else{var e=c.querySelector(l);if(e&&(e.hasAttribute("disabled")||e.classList.contains("disabled"))){a.preventDefault();return}if("LABEL"===d.tagName&&e&&"checkbox"===e.type){a.preventDefault()}q._jQueryInterface.call((0,b.default)(c),"toggle")}}).on(o,k,function(a){var c=(0,b.default)(a.target).closest(m)[0];(0,b.default)(c).toggleClass("focus",/^focus(in)?$/.test(a.type))});(0,b.default)(window).on(p,function(){for(var a=[].slice.call(document.querySelectorAll("[data-toggle=\"buttons\"] .btn")),b=0,c=a.length;b<c;b++){var d=a[b],e=d.querySelector(l);if(e.checked||e.hasAttribute("checked")){d.classList.add(j)}else{d.classList.remove(j)}}a=[].slice.call(document.querySelectorAll("[data-toggle=\"button\"]"));for(var f=0,g=a.length,h;f<g;f++){h=a[f];if("true"===h.getAttribute("aria-pressed")){h.classList.add(j)}else{h.classList.remove(j)}}});b.default.fn.button=q._jQueryInterface;b.default.fn.button.Constructor=q;b.default.fn.button.noConflict=function(){b.default.fn.button=i;return q._jQueryInterface};a.default=q;return a.default});
define ("theme_boost/bootstrap/carousel",["exports","jquery","./util"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){e=function(a){return typeof a}}else{e=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return e(a)}function f(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function g(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){f(Object(c),!0).forEach(function(b){h(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{f(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function h(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function i(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function j(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function k(a,b,c){if(b)j(a.prototype,b);if(c)j(a,c);return a}var l="bs.carousel",m=".".concat(l),n=".data-api",o=b.default.fn.carousel,p={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},q={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},r="next",s="prev",t="slide".concat(m),u="slid".concat(m),v="keydown".concat(m),w="mouseenter".concat(m),x="mouseleave".concat(m),y="touchstart".concat(m),z="touchmove".concat(m),A="touchend".concat(m),B="pointerdown".concat(m),C="pointerup".concat(m),D="dragstart".concat(m),E="load".concat(m).concat(n),F="click".concat(m).concat(n),G="active",H=".active.carousel-item",I={TOUCH:"touch",PEN:"pen"},J=function(){function a(b,c){i(this,a);this._items=null;this._interval=null;this._activeElement=null;this._isPaused=!1;this._isSliding=!1;this.touchTimeout=null;this.touchStartX=0;this.touchDeltaX=0;this._config=this._getConfig(c);this._element=b;this._indicatorsElement=this._element.querySelector(".carousel-indicators");this._touchSupported="ontouchstart"in document.documentElement||0<navigator.maxTouchPoints;this._pointerEvent=!!(window.PointerEvent||window.MSPointerEvent);this._addEventListeners()}k(a,[{key:"next",value:function next(){if(!this._isSliding){this._slide(r)}}},{key:"nextWhenVisible",value:function nextWhenVisible(){if(!document.hidden&&(0,b.default)(this._element).is(":visible")&&"hidden"!==(0,b.default)(this._element).css("visibility")){this.next()}}},{key:"prev",value:function prev(){if(!this._isSliding){this._slide(s)}}},{key:"pause",value:function pause(a){if(!a){this._isPaused=!0}if(this._element.querySelector(".carousel-item-next, .carousel-item-prev")){c.default.triggerTransitionEnd(this._element);this.cycle(!0)}clearInterval(this._interval);this._interval=null}},{key:"cycle",value:function cycle(a){if(!a){this._isPaused=!1}if(this._interval){clearInterval(this._interval);this._interval=null}if(this._config.interval&&!this._isPaused){this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval)}}},{key:"to",value:function to(a){var c=this;this._activeElement=this._element.querySelector(H);var d=this._getItemIndex(this._activeElement);if(a>this._items.length-1||0>a){return}if(this._isSliding){(0,b.default)(this._element).one(u,function(){return c.to(a)});return}if(d===a){this.pause();this.cycle();return}var e=a>d?r:s;this._slide(e,this._items[a])}},{key:"dispose",value:function dispose(){(0,b.default)(this._element).off(m);b.default.removeData(this._element,l);this._items=null;this._config=null;this._element=null;this._interval=null;this._isPaused=null;this._isSliding=null;this._activeElement=null;this._indicatorsElement=null}},{key:"_getConfig",value:function _getConfig(a){a=g({},p,{},a);c.default.typeCheckConfig("carousel",a,q);return a}},{key:"_handleSwipe",value:function _handleSwipe(){var a=Math.abs(this.touchDeltaX);if(a<=40){return}var b=a/this.touchDeltaX;this.touchDeltaX=0;if(0<b){this.prev()}if(0>b){this.next()}}},{key:"_addEventListeners",value:function _addEventListeners(){var a=this;if(this._config.keyboard){(0,b.default)(this._element).on(v,function(b){return a._keydown(b)})}if("hover"===this._config.pause){(0,b.default)(this._element).on(w,function(b){return a.pause(b)}).on(x,function(b){return a.cycle(b)})}if(this._config.touch){this._addTouchEventListeners()}}},{key:"_addTouchEventListeners",value:function _addTouchEventListeners(){var a=this;if(!this._touchSupported){return}var c=function(b){if(a._pointerEvent&&I[b.originalEvent.pointerType.toUpperCase()]){a.touchStartX=b.originalEvent.clientX}else if(!a._pointerEvent){a.touchStartX=b.originalEvent.touches[0].clientX}},d=function(b){if(b.originalEvent.touches&&1<b.originalEvent.touches.length){a.touchDeltaX=0}else{a.touchDeltaX=b.originalEvent.touches[0].clientX-a.touchStartX}},e=function(b){if(a._pointerEvent&&I[b.originalEvent.pointerType.toUpperCase()]){a.touchDeltaX=b.originalEvent.clientX-a.touchStartX}a._handleSwipe();if("hover"===a._config.pause){a.pause();if(a.touchTimeout){clearTimeout(a.touchTimeout)}a.touchTimeout=setTimeout(function(b){return a.cycle(b)},500+a._config.interval)}};(0,b.default)(this._element.querySelectorAll(".carousel-item img")).on(D,function(a){return a.preventDefault()});if(this._pointerEvent){(0,b.default)(this._element).on(B,function(a){return c(a)});(0,b.default)(this._element).on(C,function(a){return e(a)});this._element.classList.add("pointer-event")}else{(0,b.default)(this._element).on(y,function(a){return c(a)});(0,b.default)(this._element).on(z,function(a){return d(a)});(0,b.default)(this._element).on(A,function(a){return e(a)})}}},{key:"_keydown",value:function _keydown(a){if(/input|textarea/i.test(a.target.tagName)){return}switch(a.which){case 37:a.preventDefault();this.prev();break;case 39:a.preventDefault();this.next();break;default:}}},{key:"_getItemIndex",value:function _getItemIndex(a){this._items=a&&a.parentNode?[].slice.call(a.parentNode.querySelectorAll(".carousel-item")):[];return this._items.indexOf(a)}},{key:"_getItemByDirection",value:function _getItemByDirection(a,b){var c=this._getItemIndex(b),d=this._items.length-1;if((a===s&&0===c||a===r&&c===d)&&!this._config.wrap){return b}var e=a===s?-1:1,f=(c+e)%this._items.length;return-1===f?this._items[this._items.length-1]:this._items[f]}},{key:"_triggerSlideEvent",value:function _triggerSlideEvent(a,c){var d=this._getItemIndex(a),e=this._getItemIndex(this._element.querySelector(H)),f=b.default.Event(t,{relatedTarget:a,direction:c,from:e,to:d});(0,b.default)(this._element).trigger(f);return f}},{key:"_setActiveIndicatorElement",value:function _setActiveIndicatorElement(a){if(this._indicatorsElement){var c=[].slice.call(this._indicatorsElement.querySelectorAll(".active"));(0,b.default)(c).removeClass(G);var d=this._indicatorsElement.children[this._getItemIndex(a)];if(d){(0,b.default)(d).addClass(G)}}}},{key:"_slide",value:function _slide(a,d){var e=this,f=this._element.querySelector(H),g=this._getItemIndex(f),h=d||f&&this._getItemByDirection(a,f),i=this._getItemIndex(h),j=!!this._interval,k,l,m;if(a===r){k="carousel-item-left";l="carousel-item-next";m="left"}else{k="carousel-item-right";l="carousel-item-prev";m="right"}if(h&&(0,b.default)(h).hasClass(G)){this._isSliding=!1;return}var n=this._triggerSlideEvent(h,m);if(n.isDefaultPrevented()){return}if(!f||!h){return}this._isSliding=!0;if(j){this.pause()}this._setActiveIndicatorElement(h);var o=b.default.Event(u,{relatedTarget:h,direction:m,from:g,to:i});if((0,b.default)(this._element).hasClass("slide")){(0,b.default)(h).addClass(l);c.default.reflow(h);(0,b.default)(f).addClass(k);(0,b.default)(h).addClass(k);var p=parseInt(h.getAttribute("data-interval"),10);if(p){this._config.defaultInterval=this._config.defaultInterval||this._config.interval;this._config.interval=p}else{this._config.interval=this._config.defaultInterval||this._config.interval}var q=c.default.getTransitionDurationFromElement(f);(0,b.default)(f).one(c.default.TRANSITION_END,function(){(0,b.default)(h).removeClass("".concat(k," ").concat(l)).addClass(G);(0,b.default)(f).removeClass("".concat(G," ").concat(l," ").concat(k));e._isSliding=!1;setTimeout(function(){return(0,b.default)(e._element).trigger(o)},0)}).emulateTransitionEnd(q)}else{(0,b.default)(f).removeClass(G);(0,b.default)(h).addClass(G);this._isSliding=!1;(0,b.default)(this._element).trigger(o)}if(j){this.cycle()}}}],[{key:"_jQueryInterface",value:function _jQueryInterface(c){return this.each(function(){var d=(0,b.default)(this).data(l),f=g({},p,{},(0,b.default)(this).data());if("object"===e(c)){f=g({},f,{},c)}var h="string"==typeof c?c:f.slide;if(!d){d=new a(this,f);(0,b.default)(this).data(l,d)}if("number"==typeof c){d.to(c)}else if("string"==typeof h){if("undefined"==typeof d[h]){throw new TypeError("No method named \"".concat(h,"\""))}d[h]()}else if(f.interval&&f.ride){d.pause();d.cycle()}})}},{key:"_dataApiClickHandler",value:function _dataApiClickHandler(d){var e=c.default.getSelectorFromElement(this);if(!e){return}var f=(0,b.default)(e)[0];if(!f||!(0,b.default)(f).hasClass("carousel")){return}var h=g({},(0,b.default)(f).data(),{},(0,b.default)(this).data()),i=this.getAttribute("data-slide-to");if(i){h.interval=!1}a._jQueryInterface.call((0,b.default)(f),h);if(i){(0,b.default)(f).data(l).to(i)}d.preventDefault()}},{key:"VERSION",get:function get(){return"4.5.0"}},{key:"Default",get:function get(){return p}}]);return a}();(0,b.default)(document).on(F,"[data-slide], [data-slide-to]",J._dataApiClickHandler);(0,b.default)(window).on(E,function(){for(var a=[].slice.call(document.querySelectorAll("[data-ride=\"carousel\"]")),c=0,d=a.length,e;c<d;c++){e=(0,b.default)(a[c]);J._jQueryInterface.call(e,e.data())}});b.default.fn.carousel=J._jQueryInterface;b.default.fn.carousel.Constructor=J;b.default.fn.carousel.noConflict=function(){b.default.fn.carousel=o;return J._jQueryInterface};a.default=J;return a.default});
define ("theme_boost/bootstrap/collapse",["exports","jquery","./util"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){e=function(a){return typeof a}}else{e=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return e(a)}function f(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function g(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){f(Object(c),!0).forEach(function(b){h(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{f(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function h(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function j(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function k(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function l(a,b,c){if(b)k(a.prototype,b);if(c)k(a,c);return a}var m="bs.collapse",n=".".concat(m),o=b.default.fn.collapse,p={toggle:!0,parent:""},q={toggle:"boolean",parent:"(string|element)"},r="show".concat(n),s="shown".concat(n),t="hide".concat(n),u="hidden".concat(n),v="click".concat(n).concat(".data-api"),w="show",x="collapse",y="collapsing",z="collapsed",A="width",B="[data-toggle=\"collapse\"]",C=function(){function a(b,d){j(this,a);this._isTransitioning=!1;this._element=b;this._config=this._getConfig(d);this._triggerArray=[].slice.call(document.querySelectorAll("[data-toggle=\"collapse\"][href=\"#".concat(b.id,"\"],")+"[data-toggle=\"collapse\"][data-target=\"#".concat(b.id,"\"]")));for(var e=[].slice.call(document.querySelectorAll(B)),f=0,g=e.length;f<g;f++){var h=e[f],k=c.default.getSelectorFromElement(h),l=[].slice.call(document.querySelectorAll(k)).filter(function(a){return a===b});if(null!==k&&0<l.length){this._selector=k;this._triggerArray.push(h)}}this._parent=this._config.parent?this._getParent():null;if(!this._config.parent){this._addAriaAndCollapsedClass(this._element,this._triggerArray)}if(this._config.toggle){this.toggle()}}l(a,[{key:"toggle",value:function toggle(){if((0,b.default)(this._element).hasClass(w)){this.hide()}else{this.show()}}},{key:"show",value:function show(){var d=this;if(this._isTransitioning||(0,b.default)(this._element).hasClass(w)){return}var e,f;if(this._parent){e=[].slice.call(this._parent.querySelectorAll(".show, .collapsing")).filter(function(a){if("string"==typeof d._config.parent){return a.getAttribute("data-parent")===d._config.parent}return a.classList.contains(x)});if(0===e.length){e=null}}if(e){f=(0,b.default)(e).not(this._selector).data(m);if(f&&f._isTransitioning){return}}var g=b.default.Event(r);(0,b.default)(this._element).trigger(g);if(g.isDefaultPrevented()){return}if(e){a._jQueryInterface.call((0,b.default)(e).not(this._selector),"hide");if(!f){(0,b.default)(e).data(m,null)}}var h=this._getDimension();(0,b.default)(this._element).removeClass(x).addClass(y);this._element.style[h]=0;if(this._triggerArray.length){(0,b.default)(this._triggerArray).removeClass(z).attr("aria-expanded",!0)}this.setTransitioning(!0);var i=function(){(0,b.default)(d._element).removeClass(y).addClass("".concat(x," ").concat(w));d._element.style[h]="";d.setTransitioning(!1);(0,b.default)(d._element).trigger(s)},j=h[0].toUpperCase()+h.slice(1),k="scroll".concat(j),l=c.default.getTransitionDurationFromElement(this._element);(0,b.default)(this._element).one(c.default.TRANSITION_END,i).emulateTransitionEnd(l);this._element.style[h]="".concat(this._element[k],"px")}},{key:"hide",value:function hide(){var a=this;if(this._isTransitioning||!(0,b.default)(this._element).hasClass(w)){return}var d=b.default.Event(t);(0,b.default)(this._element).trigger(d);if(d.isDefaultPrevented()){return}var e=this._getDimension();this._element.style[e]="".concat(this._element.getBoundingClientRect()[e],"px");c.default.reflow(this._element);(0,b.default)(this._element).addClass(y).removeClass("".concat(x," ").concat(w));var f=this._triggerArray.length;if(0<f){for(var l=0;l<f;l++){var g=this._triggerArray[l],h=c.default.getSelectorFromElement(g);if(null!==h){var i=(0,b.default)([].slice.call(document.querySelectorAll(h)));if(!i.hasClass(w)){(0,b.default)(g).addClass(z).attr("aria-expanded",!1)}}}}this.setTransitioning(!0);var j=function(){a.setTransitioning(!1);(0,b.default)(a._element).removeClass(y).addClass(x).trigger(u)};this._element.style[e]="";var k=c.default.getTransitionDurationFromElement(this._element);(0,b.default)(this._element).one(c.default.TRANSITION_END,j).emulateTransitionEnd(k)}},{key:"setTransitioning",value:function setTransitioning(a){this._isTransitioning=a}},{key:"dispose",value:function dispose(){b.default.removeData(this._element,m);this._config=null;this._parent=null;this._element=null;this._triggerArray=null;this._isTransitioning=null}},{key:"_getConfig",value:function _getConfig(a){a=g({},p,{},a);a.toggle=!!a.toggle;c.default.typeCheckConfig("collapse",a,q);return a}},{key:"_getDimension",value:function _getDimension(){var a=(0,b.default)(this._element).hasClass(A);return a?A:"height"}},{key:"_getParent",value:function _getParent(){var d=this,e;if(c.default.isElement(this._config.parent)){e=this._config.parent;if("undefined"!=typeof this._config.parent.jquery){e=this._config.parent[0]}}else{e=document.querySelector(this._config.parent)}var f="[data-toggle=\"collapse\"][data-parent=\"".concat(this._config.parent,"\"]"),g=[].slice.call(e.querySelectorAll(f));(0,b.default)(g).each(function(b,c){d._addAriaAndCollapsedClass(a._getTargetFromElement(c),[c])});return e}},{key:"_addAriaAndCollapsedClass",value:function _addAriaAndCollapsedClass(a,c){var d=(0,b.default)(a).hasClass(w);if(c.length){(0,b.default)(c).toggleClass(z,!d).attr("aria-expanded",d)}}}],[{key:"_getTargetFromElement",value:function _getTargetFromElement(a){var b=c.default.getSelectorFromElement(a);return b?document.querySelector(b):null}},{key:"_jQueryInterface",value:function _jQueryInterface(c){return this.each(function(){var d=(0,b.default)(this),f=d.data(m),h=g({},p,{},d.data(),{},"object"===e(c)&&c?c:{});if(!f&&h.toggle&&"string"==typeof c&&/show|hide/.test(c)){h.toggle=!1}if(!f){f=new a(this,h);d.data(m,f)}if("string"==typeof c){if("undefined"==typeof f[c]){throw new TypeError("No method named \"".concat(c,"\""))}f[c]()}})}},{key:"VERSION",get:function get(){return"4.5.0"}},{key:"Default",get:function get(){return p}}]);return a}();(0,b.default)(document).on(v,B,function(a){if("A"===a.currentTarget.tagName){a.preventDefault()}var d=(0,b.default)(this),e=c.default.getSelectorFromElement(this),f=[].slice.call(document.querySelectorAll(e));(0,b.default)(f).each(function(){var a=(0,b.default)(this),c=a.data(m),e=c?"toggle":d.data();C._jQueryInterface.call(a,e)})});b.default.fn.collapse=C._jQueryInterface;b.default.fn.collapse.Constructor=C;b.default.fn.collapse.noConflict=function(){b.default.fn.collapse=o;return C._jQueryInterface};a.default=C;return a.default});
define ("theme_boost/bootstrap/dropdown",["exports","jquery","core/popper","./util"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=e(b);c=e(c);d=e(d);function e(a){return a&&a.__esModule?a:{default:a}}function f(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){f=function(a){return typeof a}}else{f=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return f(a)}function g(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function h(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){g(Object(c),!0).forEach(function(b){i(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{g(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function i(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function j(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function k(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function l(a,b,c){if(b)k(a.prototype,b);if(c)k(a,c);return a}var m="bs.dropdown",n=".".concat(m),o=".data-api",p=b.default.fn.dropdown,q=27,r=32,s=9,t=38,u=40,v=new RegExp("".concat(t,"|").concat(u,"|").concat(q)),w="hide".concat(n),x="hidden".concat(n),y="show".concat(n),z="shown".concat(n),A="click".concat(n),B="click".concat(n).concat(o),C="keydown".concat(n).concat(o),D="keyup".concat(n).concat(o),E="disabled",F="show",G="dropdown-menu-right",H="[data-toggle=\"dropdown\"]",I=".dropdown-menu",J={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},K={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},L=function(){function a(b,c){j(this,a);this._element=b;this._popper=null;this._config=this._getConfig(c);this._menu=this._getMenuElement();this._inNavbar=this._detectNavbar();this._addEventListeners()}l(a,[{key:"toggle",value:function toggle(){if(this._element.disabled||(0,b.default)(this._element).hasClass(E)){return}var c=(0,b.default)(this._menu).hasClass(F);a._clearMenus();if(c){return}this.show(!0)}},{key:"show",value:function show(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:!1;if(this._element.disabled||(0,b.default)(this._element).hasClass(E)||(0,b.default)(this._menu).hasClass(F)){return}var f={relatedTarget:this._element},g=b.default.Event(y,f),h=a._getParentFromElement(this._element);(0,b.default)(h).trigger(g);if(g.isDefaultPrevented()){return}if(!this._inNavbar&&e){if("undefined"==typeof c.default){throw new TypeError("Bootstrap's dropdowns require Popper.js (https://popper.js.org/)")}var i=this._element;if("parent"===this._config.reference){i=h}else if(d.default.isElement(this._config.reference)){i=this._config.reference;if("undefined"!=typeof this._config.reference.jquery){i=this._config.reference[0]}}if("scrollParent"!==this._config.boundary){(0,b.default)(h).addClass("position-static")}this._popper=new c.default(i,this._menu,this._getPopperConfig())}if("ontouchstart"in document.documentElement&&0===(0,b.default)(h).closest(".navbar-nav").length){(0,b.default)(document.body).children().on("mouseover",null,b.default.noop)}this._element.focus();this._element.setAttribute("aria-expanded",!0);(0,b.default)(this._menu).toggleClass(F);(0,b.default)(h).toggleClass(F).trigger(b.default.Event(z,f))}},{key:"hide",value:function hide(){if(this._element.disabled||(0,b.default)(this._element).hasClass(E)||!(0,b.default)(this._menu).hasClass(F)){return}var c={relatedTarget:this._element},d=b.default.Event(w,c),e=a._getParentFromElement(this._element);(0,b.default)(e).trigger(d);if(d.isDefaultPrevented()){return}if(this._popper){this._popper.destroy()}(0,b.default)(this._menu).toggleClass(F);(0,b.default)(e).toggleClass(F).trigger(b.default.Event(x,c))}},{key:"dispose",value:function dispose(){b.default.removeData(this._element,m);(0,b.default)(this._element).off(n);this._element=null;this._menu=null;if(null!==this._popper){this._popper.destroy();this._popper=null}}},{key:"update",value:function update(){this._inNavbar=this._detectNavbar();if(null!==this._popper){this._popper.scheduleUpdate()}}},{key:"_addEventListeners",value:function _addEventListeners(){var a=this;(0,b.default)(this._element).on(A,function(b){b.preventDefault();b.stopPropagation();a.toggle()})}},{key:"_getConfig",value:function _getConfig(a){a=h({},this.constructor.Default,{},(0,b.default)(this._element).data(),{},a);d.default.typeCheckConfig("dropdown",a,this.constructor.DefaultType);return a}},{key:"_getMenuElement",value:function _getMenuElement(){if(!this._menu){var b=a._getParentFromElement(this._element);if(b){this._menu=b.querySelector(I)}}return this._menu}},{key:"_getPlacement",value:function _getPlacement(){var a=(0,b.default)(this._element.parentNode),c="bottom-start";if(a.hasClass("dropup")){c=(0,b.default)(this._menu).hasClass(G)?"top-end":"top-start"}else if(a.hasClass("dropright")){c="right-start"}else if(a.hasClass("dropleft")){c="left-start"}else if((0,b.default)(this._menu).hasClass(G)){c="bottom-end"}return c}},{key:"_detectNavbar",value:function _detectNavbar(){return 0<(0,b.default)(this._element).closest(".navbar").length}},{key:"_getOffset",value:function _getOffset(){var a=this,b={};if("function"==typeof this._config.offset){b.fn=function(b){b.offsets=h({},b.offsets,{},a._config.offset(b.offsets,a._element)||{});return b}}else{b.offset=this._config.offset}return b}},{key:"_getPopperConfig",value:function _getPopperConfig(){var a={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};if("static"===this._config.display){a.modifiers.applyStyle={enabled:!1}}return h({},a,{},this._config.popperConfig)}}],[{key:"_jQueryInterface",value:function _jQueryInterface(c){return this.each(function(){var d=(0,b.default)(this).data(m),e="object"===f(c)?c:null;if(!d){d=new a(this,e);(0,b.default)(this).data(m,d)}if("string"==typeof c){if("undefined"==typeof d[c]){throw new TypeError("No method named \"".concat(c,"\""))}d[c]()}})}},{key:"_clearMenus",value:function _clearMenus(c){if(c&&(c.which===3||"keyup"===c.type&&c.which!==s)){return}for(var d=[].slice.call(document.querySelectorAll(H)),e=0,f=d.length;e<f;e++){var g=a._getParentFromElement(d[e]),h=(0,b.default)(d[e]).data(m),j={relatedTarget:d[e]};if(c&&"click"===c.type){j.clickEvent=c}if(!h){continue}var k=h._menu;if(!(0,b.default)(g).hasClass(F)){continue}if(c&&("click"===c.type&&/input|textarea/i.test(c.target.tagName)||"keyup"===c.type&&c.which===s)&&b.default.contains(g,c.target)){continue}var l=b.default.Event(w,j);(0,b.default)(g).trigger(l);if(l.isDefaultPrevented()){continue}if("ontouchstart"in document.documentElement){(0,b.default)(document.body).children().off("mouseover",null,b.default.noop)}d[e].setAttribute("aria-expanded","false");if(h._popper){h._popper.destroy()}(0,b.default)(k).removeClass(F);(0,b.default)(g).removeClass(F).trigger(b.default.Event(x,j))}}},{key:"_getParentFromElement",value:function _getParentFromElement(a){var b,c=d.default.getSelectorFromElement(a);if(c){b=document.querySelector(c)}return b||a.parentNode}},{key:"_dataApiKeydownHandler",value:function _dataApiKeydownHandler(c){if(/input|textarea/i.test(c.target.tagName)?c.which===r||c.which!==q&&(c.which!==u&&c.which!==t||(0,b.default)(c.target).closest(I).length):!v.test(c.which)){return}if(this.disabled||(0,b.default)(this).hasClass(E)){return}var d=a._getParentFromElement(this),e=(0,b.default)(d).hasClass(F);if(!e&&c.which===q){return}c.preventDefault();c.stopPropagation();if(!e||e&&(c.which===q||c.which===r)){if(c.which===q){(0,b.default)(d.querySelector(H)).trigger("focus")}(0,b.default)(this).trigger("click");return}var f=[].slice.call(d.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter(function(a){return(0,b.default)(a).is(":visible")});if(0===f.length){return}var g=f.indexOf(c.target);if(c.which===t&&0<g){g--}if(c.which===u&&g<f.length-1){g++}if(0>g){g=0}f[g].focus()}},{key:"VERSION",get:function get(){return"4.5.0"}},{key:"Default",get:function get(){return J}},{key:"DefaultType",get:function get(){return K}}]);return a}();(0,b.default)(document).on(C,H,L._dataApiKeydownHandler).on(C,I,L._dataApiKeydownHandler).on("".concat(B," ").concat(D),L._clearMenus).on(B,H,function(a){a.preventDefault();a.stopPropagation();L._jQueryInterface.call((0,b.default)(this),"toggle")}).on(B,".dropdown form",function(a){a.stopPropagation()});b.default.fn.dropdown=L._jQueryInterface;b.default.fn.dropdown.Constructor=L;b.default.fn.dropdown.noConflict=function(){b.default.fn.dropdown=p;return L._jQueryInterface};a.default=L;return a.default});
define ("theme_boost/bootstrap/index",["exports","./alert","./button","./carousel","./collapse","./dropdown","./modal","./popover","./scrollspy","./tab","./toast","./tooltip","./util"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"Alert",{enumerable:!0,get:function get(){return b.default}});Object.defineProperty(a,"Button",{enumerable:!0,get:function get(){return c.default}});Object.defineProperty(a,"Carousel",{enumerable:!0,get:function get(){return d.default}});Object.defineProperty(a,"Collapse",{enumerable:!0,get:function get(){return e.default}});Object.defineProperty(a,"Dropdown",{enumerable:!0,get:function get(){return f.default}});Object.defineProperty(a,"Modal",{enumerable:!0,get:function get(){return g.default}});Object.defineProperty(a,"Popover",{enumerable:!0,get:function get(){return h.default}});Object.defineProperty(a,"Scrollspy",{enumerable:!0,get:function get(){return i.default}});Object.defineProperty(a,"Tab",{enumerable:!0,get:function get(){return j.default}});Object.defineProperty(a,"Toast",{enumerable:!0,get:function get(){return k.default}});Object.defineProperty(a,"Tooltip",{enumerable:!0,get:function get(){return l.default}});Object.defineProperty(a,"Util",{enumerable:!0,get:function get(){return m.default}});b=n(b);c=n(c);d=n(d);e=n(e);f=n(f);g=n(g);h=n(h);i=n(i);j=n(j);k=n(k);l=n(l);m=n(m);function n(a){return a&&a.__esModule?a:{default:a}}});
define ("theme_boost/bootstrap/modal",["exports","jquery","./util"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){e=function(a){return typeof a}}else{e=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return e(a)}function f(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function g(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){f(Object(c),!0).forEach(function(b){h(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{f(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function h(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function i(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function j(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function k(a,b,c){if(b)j(a.prototype,b);if(c)j(a,c);return a}var l="bs.modal",m=".".concat(l),n=b.default.fn.modal,o=27,p={backdrop:!0,keyboard:!0,focus:!0,show:!0},q={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},r="hide".concat(m),s="hidePrevented".concat(m),t="hidden".concat(m),u="show".concat(m),v="shown".concat(m),w="focusin".concat(m),x="resize".concat(m),y="click.dismiss".concat(m),z="keydown.dismiss".concat(m),A="mouseup.dismiss".concat(m),B="mousedown.dismiss".concat(m),C="click".concat(m).concat(".data-api"),D="modal-open",E="fade",F="show",G="modal-static",H=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",I=".sticky-top",J=function(){function a(b,c){i(this,a);this._config=this._getConfig(c);this._element=b;this._dialog=b.querySelector(".modal-dialog");this._backdrop=null;this._isShown=!1;this._isBodyOverflowing=!1;this._ignoreBackdropClick=!1;this._isTransitioning=!1;this._scrollbarWidth=0}k(a,[{key:"toggle",value:function toggle(a){return this._isShown?this.hide():this.show(a)}},{key:"show",value:function show(a){var c=this;if(this._isShown||this._isTransitioning){return}if((0,b.default)(this._element).hasClass(E)){this._isTransitioning=!0}var d=b.default.Event(u,{relatedTarget:a});(0,b.default)(this._element).trigger(d);if(this._isShown||d.isDefaultPrevented()){return}this._isShown=!0;this._checkScrollbar();this._setScrollbar();this._adjustDialog();this._setEscapeEvent();this._setResizeEvent();(0,b.default)(this._element).on(y,"[data-dismiss=\"modal\"]",function(a){return c.hide(a)});(0,b.default)(this._dialog).on(B,function(){(0,b.default)(c._element).one(A,function(a){if((0,b.default)(a.target).is(c._element)){c._ignoreBackdropClick=!0}})});this._showBackdrop(function(){return c._showElement(a)})}},{key:"hide",value:function hide(a){var d=this;if(a){a.preventDefault()}if(!this._isShown||this._isTransitioning){return}var e=b.default.Event(r);(0,b.default)(this._element).trigger(e);if(!this._isShown||e.isDefaultPrevented()){return}this._isShown=!1;var f=(0,b.default)(this._element).hasClass(E);if(f){this._isTransitioning=!0}this._setEscapeEvent();this._setResizeEvent();(0,b.default)(document).off(w);(0,b.default)(this._element).removeClass(F);(0,b.default)(this._element).off(y);(0,b.default)(this._dialog).off(B);if(f){var g=c.default.getTransitionDurationFromElement(this._element);(0,b.default)(this._element).one(c.default.TRANSITION_END,function(a){return d._hideModal(a)}).emulateTransitionEnd(g)}else{this._hideModal()}}},{key:"dispose",value:function dispose(){[window,this._element,this._dialog].forEach(function(a){return(0,b.default)(a).off(m)});(0,b.default)(document).off(w);b.default.removeData(this._element,l);this._config=null;this._element=null;this._dialog=null;this._backdrop=null;this._isShown=null;this._isBodyOverflowing=null;this._ignoreBackdropClick=null;this._isTransitioning=null;this._scrollbarWidth=null}},{key:"handleUpdate",value:function handleUpdate(){this._adjustDialog()}},{key:"_getConfig",value:function _getConfig(a){a=g({},p,{},a);c.default.typeCheckConfig("modal",a,q);return a}},{key:"_triggerBackdropTransition",value:function _triggerBackdropTransition(){var a=this;if("static"===this._config.backdrop){var d=b.default.Event(s);(0,b.default)(this._element).trigger(d);if(d.defaultPrevented){return}this._element.classList.add(G);var e=c.default.getTransitionDurationFromElement(this._element);(0,b.default)(this._element).one(c.default.TRANSITION_END,function(){a._element.classList.remove(G)}).emulateTransitionEnd(e);this._element.focus()}else{this.hide()}}},{key:"_showElement",value:function _showElement(a){var d=this,e=(0,b.default)(this._element).hasClass(E),f=this._dialog?this._dialog.querySelector(".modal-body"):null;if(!this._element.parentNode||this._element.parentNode.nodeType!==Node.ELEMENT_NODE){document.body.appendChild(this._element)}this._element.style.display="block";this._element.removeAttribute("aria-hidden");this._element.setAttribute("aria-modal",!0);if((0,b.default)(this._dialog).hasClass("modal-dialog-scrollable")&&f){f.scrollTop=0}else{this._element.scrollTop=0}if(e){c.default.reflow(this._element)}(0,b.default)(this._element).addClass(F);if(this._config.focus){this._enforceFocus()}var g=b.default.Event(v,{relatedTarget:a}),h=function(){if(d._config.focus){d._element.focus()}d._isTransitioning=!1;(0,b.default)(d._element).trigger(g)};if(e){var i=c.default.getTransitionDurationFromElement(this._dialog);(0,b.default)(this._dialog).one(c.default.TRANSITION_END,h).emulateTransitionEnd(i)}else{h()}}},{key:"_enforceFocus",value:function _enforceFocus(){var a=this;(0,b.default)(document).off(w).on(w,function(c){if(document!==c.target&&a._element!==c.target&&0===(0,b.default)(a._element).has(c.target).length){a._element.focus()}})}},{key:"_setEscapeEvent",value:function _setEscapeEvent(){var a=this;if(this._isShown){(0,b.default)(this._element).on(z,function(b){if(a._config.keyboard&&b.which===o){b.preventDefault();a.hide()}else if(!a._config.keyboard&&b.which===o){a._triggerBackdropTransition()}})}else if(!this._isShown){(0,b.default)(this._element).off(z)}}},{key:"_setResizeEvent",value:function _setResizeEvent(){var a=this;if(this._isShown){(0,b.default)(window).on(x,function(b){return a.handleUpdate(b)})}else{(0,b.default)(window).off(x)}}},{key:"_hideModal",value:function _hideModal(){var a=this;this._element.style.display="none";this._element.setAttribute("aria-hidden",!0);this._element.removeAttribute("aria-modal");this._isTransitioning=!1;this._showBackdrop(function(){(0,b.default)(document.body).removeClass(D);a._resetAdjustments();a._resetScrollbar();(0,b.default)(a._element).trigger(t)})}},{key:"_removeBackdrop",value:function _removeBackdrop(){if(this._backdrop){(0,b.default)(this._backdrop).remove();this._backdrop=null}}},{key:"_showBackdrop",value:function _showBackdrop(a){var d=this,e=(0,b.default)(this._element).hasClass(E)?E:"";if(this._isShown&&this._config.backdrop){this._backdrop=document.createElement("div");this._backdrop.className="modal-backdrop";if(e){this._backdrop.classList.add(e)}(0,b.default)(this._backdrop).appendTo(document.body);(0,b.default)(this._element).on(y,function(a){if(d._ignoreBackdropClick){d._ignoreBackdropClick=!1;return}if(a.target!==a.currentTarget){return}d._triggerBackdropTransition()});if(e){c.default.reflow(this._backdrop)}(0,b.default)(this._backdrop).addClass(F);if(!a){return}if(!e){a();return}var f=c.default.getTransitionDurationFromElement(this._backdrop);(0,b.default)(this._backdrop).one(c.default.TRANSITION_END,a).emulateTransitionEnd(f)}else if(!this._isShown&&this._backdrop){(0,b.default)(this._backdrop).removeClass(F);var g=function(){d._removeBackdrop();if(a){a()}};if((0,b.default)(this._element).hasClass(E)){var h=c.default.getTransitionDurationFromElement(this._backdrop);(0,b.default)(this._backdrop).one(c.default.TRANSITION_END,g).emulateTransitionEnd(h)}else{g()}}else if(a){a()}}},{key:"_adjustDialog",value:function _adjustDialog(){var a=this._element.scrollHeight>document.documentElement.clientHeight;if(!this._isBodyOverflowing&&a){this._element.style.paddingLeft="".concat(this._scrollbarWidth,"px")}if(this._isBodyOverflowing&&!a){this._element.style.paddingRight="".concat(this._scrollbarWidth,"px")}}},{key:"_resetAdjustments",value:function _resetAdjustments(){this._element.style.paddingLeft="";this._element.style.paddingRight=""}},{key:"_checkScrollbar",value:function _checkScrollbar(){var a=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(a.left+a.right)<window.innerWidth;this._scrollbarWidth=this._getScrollbarWidth()}},{key:"_setScrollbar",value:function _setScrollbar(){var a=this;if(this._isBodyOverflowing){var c=[].slice.call(document.querySelectorAll(H)),d=[].slice.call(document.querySelectorAll(I));(0,b.default)(c).each(function(c,d){var e=d.style.paddingRight,f=(0,b.default)(d).css("padding-right");(0,b.default)(d).data("padding-right",e).css("padding-right","".concat(parseFloat(f)+a._scrollbarWidth,"px"))});(0,b.default)(d).each(function(c,d){var e=d.style.marginRight,f=(0,b.default)(d).css("margin-right");(0,b.default)(d).data("margin-right",e).css("margin-right","".concat(parseFloat(f)-a._scrollbarWidth,"px"))});var e=document.body.style.paddingRight,f=(0,b.default)(document.body).css("padding-right");(0,b.default)(document.body).data("padding-right",e).css("padding-right","".concat(parseFloat(f)+this._scrollbarWidth,"px"))}(0,b.default)(document.body).addClass(D)}},{key:"_resetScrollbar",value:function _resetScrollbar(){var a=[].slice.call(document.querySelectorAll(H));(0,b.default)(a).each(function(a,c){var d=(0,b.default)(c).data("padding-right");(0,b.default)(c).removeData("padding-right");c.style.paddingRight=d?d:""});var c=[].slice.call(document.querySelectorAll("".concat(I)));(0,b.default)(c).each(function(a,c){var d=(0,b.default)(c).data("margin-right");if("undefined"!=typeof d){(0,b.default)(c).css("margin-right",d).removeData("margin-right")}});var d=(0,b.default)(document.body).data("padding-right");(0,b.default)(document.body).removeData("padding-right");document.body.style.paddingRight=d?d:""}},{key:"_getScrollbarWidth",value:function _getScrollbarWidth(){var a=document.createElement("div");a.className="modal-scrollbar-measure";document.body.appendChild(a);var b=a.getBoundingClientRect().width-a.clientWidth;document.body.removeChild(a);return b}}],[{key:"_jQueryInterface",value:function _jQueryInterface(c,d){return this.each(function(){var f=(0,b.default)(this).data(l),h=g({},p,{},(0,b.default)(this).data(),{},"object"===e(c)&&c?c:{});if(!f){f=new a(this,h);(0,b.default)(this).data(l,f)}if("string"==typeof c){if("undefined"==typeof f[c]){throw new TypeError("No method named \"".concat(c,"\""))}f[c](d)}else if(h.show){f.show(d)}})}},{key:"VERSION",get:function get(){return"4.5.0"}},{key:"Default",get:function get(){return p}}]);return a}();(0,b.default)(document).on(C,"[data-toggle=\"modal\"]",function(a){var d=this,e,f=c.default.getSelectorFromElement(this);if(f){e=document.querySelector(f)}var h=(0,b.default)(e).data(l)?"toggle":g({},(0,b.default)(e).data(),{},(0,b.default)(this).data());if("A"===this.tagName||"AREA"===this.tagName){a.preventDefault()}var i=(0,b.default)(e).one(u,function(a){if(a.isDefaultPrevented()){return}i.one(t,function(){if((0,b.default)(d).is(":visible")){d.focus()}})});J._jQueryInterface.call((0,b.default)(e),h,this)});b.default.fn.modal=J._jQueryInterface;b.default.fn.modal.Constructor=J;b.default.fn.modal.noConflict=function(){b.default.fn.modal=n;return J._jQueryInterface};a.default=J;return a.default});
define ("theme_boost/bootstrap/popover",["exports","jquery","./tooltip"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){e=function(a){return typeof a}}else{e=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return e(a)}function f(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function g(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function h(a,b,c){if(b)g(a.prototype,b);if(c)g(a,c);return a}function i(a,b){if("function"!=typeof b&&null!==b){throw new TypeError("Super expression must either be null or a function")}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});if(b)j(a,b)}function j(a,b){j=Object.setPrototypeOf||function(a,b){a.__proto__=b;return a};return j(a,b)}function k(a){return function(){var b=p(a),c;if(n()){var d=p(this).constructor;c=Reflect.construct(b,arguments,d)}else{c=b.apply(this,arguments)}return l(this,c)}}function l(a,b){if(b&&("object"===e(b)||"function"==typeof b)){return b}return m(a)}function m(a){if(void 0===a){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return a}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(a){return!1}}function p(a){p=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return p(a)}function q(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function r(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){q(Object(c),!0).forEach(function(b){s(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{q(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function s(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}var t="bs.popover",u=".".concat(t),v=b.default.fn.popover,w="bs-popover",x=new RegExp("(^|\\s)".concat(w,"\\S+"),"g"),y=r({},c.default.Default,{placement:"right",trigger:"click",content:"",template:"<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-header\"></h3><div class=\"popover-body\"></div></div>"}),z=r({},c.default.DefaultType,{content:"(string|element|function)"}),A={HIDE:"hide".concat(u),HIDDEN:"hidden".concat(u),SHOW:"show".concat(u),SHOWN:"shown".concat(u),INSERTED:"inserted".concat(u),CLICK:"click".concat(u),FOCUSIN:"focusin".concat(u),FOCUSOUT:"focusout".concat(u),MOUSEENTER:"mouseenter".concat(u),MOUSELEAVE:"mouseleave".concat(u)},B=function(a){i(c,a);var d=k(c);function c(){f(this,c);return d.apply(this,arguments)}h(c,[{key:"isWithContent",value:function isWithContent(){return this.getTitle()||this._getContent()}},{key:"addAttachmentClass",value:function addAttachmentClass(a){(0,b.default)(this.getTipElement()).addClass("".concat(w,"-").concat(a))}},{key:"getTipElement",value:function getTipElement(){this.tip=this.tip||(0,b.default)(this.config.template)[0];return this.tip}},{key:"setContent",value:function setContent(){var a=(0,b.default)(this.getTipElement());this.setElementContent(a.find(".popover-header"),this.getTitle());var c=this._getContent();if("function"==typeof c){c=c.call(this.element)}this.setElementContent(a.find(".popover-body"),c);a.removeClass("".concat("fade"," ").concat("show"))}},{key:"_getContent",value:function _getContent(){return this.element.getAttribute("data-content")||this.config.content}},{key:"_cleanTipClass",value:function _cleanTipClass(){var a=(0,b.default)(this.getTipElement()),c=a.attr("class").match(x);if(null!==c&&0<c.length){a.removeClass(c.join(""))}}}],[{key:"_jQueryInterface",value:function _jQueryInterface(a){return this.each(function(){var d=(0,b.default)(this).data(t),f="object"===e(a)?a:null;if(!d&&/dispose|hide/.test(a)){return}if(!d){d=new c(this,f);(0,b.default)(this).data(t,d)}if("string"==typeof a){if("undefined"==typeof d[a]){throw new TypeError("No method named \"".concat(a,"\""))}d[a]()}})}},{key:"VERSION",get:function get(){return"4.5.0"}},{key:"Default",get:function get(){return y}},{key:"NAME",get:function get(){return"popover"}},{key:"DATA_KEY",get:function get(){return t}},{key:"Event",get:function get(){return A}},{key:"EVENT_KEY",get:function get(){return u}},{key:"DefaultType",get:function get(){return z}}]);return c}(c.default);b.default.fn.popover=B._jQueryInterface;b.default.fn.popover.Constructor=B;b.default.fn.popover.noConflict=function(){b.default.fn.popover=v;return B._jQueryInterface};a.default=B;return a.default});
define ("theme_boost/bootstrap/scrollspy",["exports","jquery","./util"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){e=function(a){return typeof a}}else{e=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return e(a)}function f(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function g(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){f(Object(c),!0).forEach(function(b){h(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{f(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function h(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function i(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function j(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function k(a,b,c){if(b)j(a.prototype,b);if(c)j(a,c);return a}var l="bs.scrollspy",m=".".concat(l),n=b.default.fn.scrollspy,o={offset:10,method:"auto",target:""},p={offset:"number",method:"string",target:"(string|element)"},q="activate".concat(m),r="scroll".concat(m),s="load".concat(m).concat(".data-api"),t="active",u=".nav, .list-group",v=".nav-link",w=".list-group-item",x="position",y=function(){function a(c,d){var e=this;i(this,a);this._element=c;this._scrollElement="BODY"===c.tagName?window:c;this._config=this._getConfig(d);this._selector="".concat(this._config.target," ").concat(v,",")+"".concat(this._config.target," ").concat(w,",")+"".concat(this._config.target," ").concat(".dropdown-item");this._offsets=[];this._targets=[];this._activeTarget=null;this._scrollHeight=0;(0,b.default)(this._scrollElement).on(r,function(a){return e._process(a)});this.refresh();this._process()}k(a,[{key:"refresh",value:function refresh(){var a=this,d=this._scrollElement===this._scrollElement.window?"offset":x,e="auto"===this._config.method?d:this._config.method,f=e===x?this._getScrollTop():0;this._offsets=[];this._targets=[];this._scrollHeight=this._getScrollHeight();var g=[].slice.call(document.querySelectorAll(this._selector));g.map(function(a){var d,g=c.default.getSelectorFromElement(a);if(g){d=document.querySelector(g)}if(d){var h=d.getBoundingClientRect();if(h.width||h.height){return[(0,b.default)(d)[e]().top+f,g]}}return null}).filter(function(a){return a}).sort(function(c,a){return c[0]-a[0]}).forEach(function(b){a._offsets.push(b[0]);a._targets.push(b[1])})}},{key:"dispose",value:function dispose(){b.default.removeData(this._element,l);(0,b.default)(this._scrollElement).off(m);this._element=null;this._scrollElement=null;this._config=null;this._selector=null;this._offsets=null;this._targets=null;this._activeTarget=null;this._scrollHeight=null}},{key:"_getConfig",value:function _getConfig(a){a=g({},o,{},"object"===e(a)&&a?a:{});if("string"!=typeof a.target&&c.default.isElement(a.target)){var d=(0,b.default)(a.target).attr("id");if(!d){d=c.default.getUID("scrollspy");(0,b.default)(a.target).attr("id",d)}a.target="#".concat(d)}c.default.typeCheckConfig("scrollspy",a,p);return a}},{key:"_getScrollTop",value:function _getScrollTop(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop}},{key:"_getScrollHeight",value:function _getScrollHeight(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}},{key:"_getOffsetHeight",value:function _getOffsetHeight(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height}},{key:"_process",value:function _process(){var a=this._getScrollTop()+this._config.offset,b=this._getScrollHeight(),c=this._config.offset+b-this._getOffsetHeight();if(this._scrollHeight!==b){this.refresh()}if(a>=c){var d=this._targets[this._targets.length-1];if(this._activeTarget!==d){this._activate(d)}return}if(this._activeTarget&&a<this._offsets[0]&&0<this._offsets[0]){this._activeTarget=null;this._clear();return}for(var e=this._offsets.length,f;e--;){f=this._activeTarget!==this._targets[e]&&a>=this._offsets[e]&&("undefined"==typeof this._offsets[e+1]||a<this._offsets[e+1]);if(f){this._activate(this._targets[e])}}}},{key:"_activate",value:function _activate(a){this._activeTarget=a;this._clear();var c=this._selector.split(",").map(function(b){return"".concat(b,"[data-target=\"").concat(a,"\"],").concat(b,"[href=\"").concat(a,"\"]")}),d=(0,b.default)([].slice.call(document.querySelectorAll(c.join(","))));if(d.hasClass("dropdown-item")){d.closest(".dropdown").find(".dropdown-toggle").addClass(t);d.addClass(t)}else{d.addClass(t);d.parents(u).prev("".concat(v,", ").concat(w)).addClass(t);d.parents(u).prev(".nav-item").children(v).addClass(t)}(0,b.default)(this._scrollElement).trigger(q,{relatedTarget:a})}},{key:"_clear",value:function _clear(){[].slice.call(document.querySelectorAll(this._selector)).filter(function(a){return a.classList.contains(t)}).forEach(function(a){return a.classList.remove(t)})}}],[{key:"_jQueryInterface",value:function _jQueryInterface(c){return this.each(function(){var d=(0,b.default)(this).data(l),f="object"===e(c)&&c;if(!d){d=new a(this,f);(0,b.default)(this).data(l,d)}if("string"==typeof c){if("undefined"==typeof d[c]){throw new TypeError("No method named \"".concat(c,"\""))}d[c]()}})}},{key:"VERSION",get:function get(){return"4.5.0"}},{key:"Default",get:function get(){return o}}]);return a}();(0,b.default)(window).on(s,function(){for(var a=[].slice.call(document.querySelectorAll("[data-spy=\"scroll\"]")),c=a.length,d=c,e;d--;){e=(0,b.default)(a[d]);y._jQueryInterface.call(e,e.data())}});b.default.fn.scrollspy=y._jQueryInterface;b.default.fn.scrollspy.Constructor=y;b.default.fn.scrollspy.noConflict=function(){b.default.fn.scrollspy=n;return y._jQueryInterface};a.default=y;return a.default});
define ("theme_boost/bootstrap/tab",["exports","jquery","./util"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function f(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function g(a,b,c){if(b)f(a.prototype,b);if(c)f(a,c);return a}var h="bs.tab",i=".".concat(h),j=b.default.fn.tab,k="hide".concat(i),l="hidden".concat(i),m="show".concat(i),n="shown".concat(i),o="click".concat(i).concat(".data-api"),p="active",q="fade",r="show",s=".active",t="> li > .active",u=function(){function a(b){e(this,a);this._element=b}g(a,[{key:"show",value:function show(){var a=this;if(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&(0,b.default)(this._element).hasClass(p)||(0,b.default)(this._element).hasClass("disabled")){return}var d,e,f=(0,b.default)(this._element).closest(".nav, .list-group")[0],g=c.default.getSelectorFromElement(this._element);if(f){var o="UL"===f.nodeName||"OL"===f.nodeName?t:s;e=b.default.makeArray((0,b.default)(f).find(o));e=e[e.length-1]}var h=b.default.Event(k,{relatedTarget:this._element}),i=b.default.Event(m,{relatedTarget:e});if(e){(0,b.default)(e).trigger(h)}(0,b.default)(this._element).trigger(i);if(i.isDefaultPrevented()||h.isDefaultPrevented()){return}if(g){d=document.querySelector(g)}this._activate(this._element,f);var j=function(){var c=b.default.Event(l,{relatedTarget:a._element}),d=b.default.Event(n,{relatedTarget:e});(0,b.default)(e).trigger(c);(0,b.default)(a._element).trigger(d)};if(d){this._activate(d,d.parentNode,j)}else{j()}}},{key:"dispose",value:function dispose(){b.default.removeData(this._element,h);this._element=null}},{key:"_activate",value:function _activate(a,d,e){var f=this,g=d&&("UL"===d.nodeName||"OL"===d.nodeName)?(0,b.default)(d).find(t):(0,b.default)(d).children(s),h=g[0],i=e&&h&&(0,b.default)(h).hasClass(q),j=function(){return f._transitionComplete(a,h,e)};if(h&&i){var k=c.default.getTransitionDurationFromElement(h);(0,b.default)(h).removeClass(r).one(c.default.TRANSITION_END,j).emulateTransitionEnd(k)}else{j()}}},{key:"_transitionComplete",value:function _transitionComplete(a,d,e){if(d){(0,b.default)(d).removeClass(p);var f=(0,b.default)(d.parentNode).find("> .dropdown-menu .active")[0];if(f){(0,b.default)(f).removeClass(p)}if("tab"===d.getAttribute("role")){d.setAttribute("aria-selected",!1)}}(0,b.default)(a).addClass(p);if("tab"===a.getAttribute("role")){a.setAttribute("aria-selected",!0)}c.default.reflow(a);if(a.classList.contains(q)){a.classList.add(r)}if(a.parentNode&&(0,b.default)(a.parentNode).hasClass("dropdown-menu")){var g=(0,b.default)(a).closest(".dropdown")[0];if(g){var h=[].slice.call(g.querySelectorAll(".dropdown-toggle"));(0,b.default)(h).addClass(p)}a.setAttribute("aria-expanded",!0)}if(e){e()}}}],[{key:"_jQueryInterface",value:function _jQueryInterface(c){return this.each(function(){var d=(0,b.default)(this),e=d.data(h);if(!e){e=new a(this);d.data(h,e)}if("string"==typeof c){if("undefined"==typeof e[c]){throw new TypeError("No method named \"".concat(c,"\""))}e[c]()}})}},{key:"VERSION",get:function get(){return"4.5.0"}}]);return a}();(0,b.default)(document).on(o,"[data-toggle=\"tab\"], [data-toggle=\"pill\"], [data-toggle=\"list\"]",function(a){a.preventDefault();u._jQueryInterface.call((0,b.default)(this),"show")});b.default.fn.tab=u._jQueryInterface;b.default.fn.tab.Constructor=u;b.default.fn.tab.noConflict=function(){b.default.fn.tab=j;return u._jQueryInterface};a.default=u;return a.default});
define ("theme_boost/bootstrap/toast",["exports","jquery","./util"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){e=function(a){return typeof a}}else{e=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return e(a)}function f(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function g(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){f(Object(c),!0).forEach(function(b){h(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{f(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function h(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function i(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function j(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function k(a,b,c){if(b)j(a.prototype,b);if(c)j(a,c);return a}var l="bs.toast",m=".".concat(l),n=b.default.fn.toast,o="click.dismiss".concat(m),p="hide".concat(m),q="hidden".concat(m),r="show".concat(m),s="shown".concat(m),t="hide",u="show",v="showing",w={animation:"boolean",autohide:"boolean",delay:"number"},x={animation:!0,autohide:!0,delay:500},y=function(){function a(b,c){i(this,a);this._element=b;this._config=this._getConfig(c);this._timeout=null;this._setListeners()}k(a,[{key:"show",value:function show(){var a=this,d=b.default.Event(r);(0,b.default)(this._element).trigger(d);if(d.isDefaultPrevented()){return}if(this._config.animation){this._element.classList.add("fade")}var e=function(){a._element.classList.remove(v);a._element.classList.add(u);(0,b.default)(a._element).trigger(s);if(a._config.autohide){a._timeout=setTimeout(function(){a.hide()},a._config.delay)}};this._element.classList.remove(t);c.default.reflow(this._element);this._element.classList.add(v);if(this._config.animation){var f=c.default.getTransitionDurationFromElement(this._element);(0,b.default)(this._element).one(c.default.TRANSITION_END,e).emulateTransitionEnd(f)}else{e()}}},{key:"hide",value:function hide(){if(!this._element.classList.contains(u)){return}var a=b.default.Event(p);(0,b.default)(this._element).trigger(a);if(a.isDefaultPrevented()){return}this._close()}},{key:"dispose",value:function dispose(){clearTimeout(this._timeout);this._timeout=null;if(this._element.classList.contains(u)){this._element.classList.remove(u)}(0,b.default)(this._element).off(o);b.default.removeData(this._element,l);this._element=null;this._config=null}},{key:"_getConfig",value:function _getConfig(a){a=g({},x,{},(0,b.default)(this._element).data(),{},"object"===e(a)&&a?a:{});c.default.typeCheckConfig("toast",a,this.constructor.DefaultType);return a}},{key:"_setListeners",value:function _setListeners(){var a=this;(0,b.default)(this._element).on(o,"[data-dismiss=\"toast\"]",function(){return a.hide()})}},{key:"_close",value:function _close(){var a=this,d=function(){a._element.classList.add(t);(0,b.default)(a._element).trigger(q)};this._element.classList.remove(u);if(this._config.animation){var e=c.default.getTransitionDurationFromElement(this._element);(0,b.default)(this._element).one(c.default.TRANSITION_END,d).emulateTransitionEnd(e)}else{d()}}}],[{key:"_jQueryInterface",value:function _jQueryInterface(c){return this.each(function(){var d=(0,b.default)(this),f=d.data(l),g="object"===e(c)&&c;if(!f){f=new a(this,g);d.data(l,f)}if("string"==typeof c){if("undefined"==typeof f[c]){throw new TypeError("No method named \"".concat(c,"\""))}f[c](this)}})}},{key:"VERSION",get:function get(){return"4.5.0"}},{key:"DefaultType",get:function get(){return w}},{key:"Default",get:function get(){return x}}]);return a}();b.default.fn.toast=y._jQueryInterface;b.default.fn.toast.Constructor=y;b.default.fn.toast.noConflict=function(){b.default.fn.toast=n;return y._jQueryInterface};a.default=y;return a.default});
define ("theme_boost/bootstrap/tooltip",["exports","./tools/sanitizer","jquery","core/popper","./util"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;c=f(c);d=f(d);e=f(e);function f(a){return a&&a.__esModule?a:{default:a}}function g(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function h(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){g(Object(c),!0).forEach(function(b){i(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{g(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function i(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function j(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){j=function(a){return typeof a}}else{j=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return j(a)}function k(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function l(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function m(a,b,c){if(b)l(a.prototype,b);if(c)l(a,c);return a}var n="bs.tooltip",o=".".concat(n),p=c.default.fn.tooltip,q="bs-tooltip",r=new RegExp("(^|\\s)".concat(q,"\\S+"),"g"),s=["sanitize","whiteList","sanitizeFn"],t={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},u={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},v={animation:!0,template:"<div class=\"tooltip\" role=\"tooltip\"><div class=\"arrow\"></div><div class=\"tooltip-inner\"></div></div>",trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",sanitize:!0,sanitizeFn:null,whiteList:b.DefaultWhitelist,popperConfig:null},w="show",x="out",y={HIDE:"hide".concat(o),HIDDEN:"hidden".concat(o),SHOW:"show".concat(o),SHOWN:"shown".concat(o),INSERTED:"inserted".concat(o),CLICK:"click".concat(o),FOCUSIN:"focusin".concat(o),FOCUSOUT:"focusout".concat(o),MOUSEENTER:"mouseenter".concat(o),MOUSELEAVE:"mouseleave".concat(o)},z="fade",A="show",B="hover",C="focus",D=function(){function a(b,c){k(this,a);if("undefined"==typeof d.default){throw new TypeError("Bootstrap's tooltips require Popper.js (https://popper.js.org/)")}this._isEnabled=!0;this._timeout=0;this._hoverState="";this._activeTrigger={};this._popper=null;this.element=b;this.config=this._getConfig(c);this.tip=null;this._setListeners()}m(a,[{key:"enable",value:function enable(){this._isEnabled=!0}},{key:"disable",value:function disable(){this._isEnabled=!1}},{key:"toggleEnabled",value:function toggleEnabled(){this._isEnabled=!this._isEnabled}},{key:"toggle",value:function toggle(a){if(!this._isEnabled){return}if(a){var b=this.constructor.DATA_KEY,d=(0,c.default)(a.currentTarget).data(b);if(!d){d=new this.constructor(a.currentTarget,this._getDelegateConfig());(0,c.default)(a.currentTarget).data(b,d)}d._activeTrigger.click=!d._activeTrigger.click;if(d._isWithActiveTrigger()){d._enter(null,d)}else{d._leave(null,d)}}else{if((0,c.default)(this.getTipElement()).hasClass(A)){this._leave(null,this);return}this._enter(null,this)}}},{key:"dispose",value:function dispose(){clearTimeout(this._timeout);c.default.removeData(this.element,this.constructor.DATA_KEY);(0,c.default)(this.element).off(this.constructor.EVENT_KEY);(0,c.default)(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler);if(this.tip){(0,c.default)(this.tip).remove()}this._isEnabled=null;this._timeout=null;this._hoverState=null;this._activeTrigger=null;if(this._popper){this._popper.destroy()}this._popper=null;this.element=null;this.config=null;this.tip=null}},{key:"show",value:function show(){var a=this;if("none"===(0,c.default)(this.element).css("display")){throw new Error("Please use show on visible elements")}var b=c.default.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){(0,c.default)(this.element).trigger(b);var f=e.default.findShadowRoot(this.element),g=c.default.contains(null!==f?f:this.element.ownerDocument.documentElement,this.element);if(b.isDefaultPrevented()||!g){return}var h=this.getTipElement(),i=e.default.getUID(this.constructor.NAME);h.setAttribute("id",i);this.element.setAttribute("aria-describedby",i);this.setContent();if(this.config.animation){(0,c.default)(h).addClass(z)}var j="function"==typeof this.config.placement?this.config.placement.call(this,h,this.element):this.config.placement,k=this._getAttachment(j);this.addAttachmentClass(k);var l=this._getContainer();(0,c.default)(h).data(this.constructor.DATA_KEY,this);if(!c.default.contains(this.element.ownerDocument.documentElement,this.tip)){(0,c.default)(h).appendTo(l)}(0,c.default)(this.element).trigger(this.constructor.Event.INSERTED);this._popper=new d.default(this.element,h,this._getPopperConfig(k));(0,c.default)(h).addClass(A);if("ontouchstart"in document.documentElement){(0,c.default)(document.body).children().on("mouseover",null,c.default.noop)}var m=function(){if(a.config.animation){a._fixTransition()}var b=a._hoverState;a._hoverState=null;(0,c.default)(a.element).trigger(a.constructor.Event.SHOWN);if(b===x){a._leave(null,a)}};if((0,c.default)(this.tip).hasClass(z)){var n=e.default.getTransitionDurationFromElement(this.tip);(0,c.default)(this.tip).one(e.default.TRANSITION_END,m).emulateTransitionEnd(n)}else{m()}}}},{key:"hide",value:function hide(a){var b=this,d=this.getTipElement(),f=c.default.Event(this.constructor.Event.HIDE),g=function(){if(b._hoverState!==w&&d.parentNode){d.parentNode.removeChild(d)}b._cleanTipClass();b.element.removeAttribute("aria-describedby");(0,c.default)(b.element).trigger(b.constructor.Event.HIDDEN);if(null!==b._popper){b._popper.destroy()}if(a){a()}};(0,c.default)(this.element).trigger(f);if(f.isDefaultPrevented()){return}(0,c.default)(d).removeClass(A);if("ontouchstart"in document.documentElement){(0,c.default)(document.body).children().off("mouseover",null,c.default.noop)}this._activeTrigger["click"]=!1;this._activeTrigger[C]=!1;this._activeTrigger[B]=!1;if((0,c.default)(this.tip).hasClass(z)){var h=e.default.getTransitionDurationFromElement(d);(0,c.default)(d).one(e.default.TRANSITION_END,g).emulateTransitionEnd(h)}else{g()}this._hoverState=""}},{key:"update",value:function update(){if(null!==this._popper){this._popper.scheduleUpdate()}}},{key:"isWithContent",value:function isWithContent(){return!!this.getTitle()}},{key:"addAttachmentClass",value:function addAttachmentClass(a){(0,c.default)(this.getTipElement()).addClass("".concat(q,"-").concat(a))}},{key:"getTipElement",value:function getTipElement(){this.tip=this.tip||(0,c.default)(this.config.template)[0];return this.tip}},{key:"setContent",value:function setContent(){var a=this.getTipElement();this.setElementContent((0,c.default)(a.querySelectorAll(".tooltip-inner")),this.getTitle());(0,c.default)(a).removeClass("".concat(z," ").concat(A))}},{key:"setElementContent",value:function setElementContent(a,d){if("object"===j(d)&&(d.nodeType||d.jquery)){if(this.config.html){if(!(0,c.default)(d).parent().is(a)){a.empty().append(d)}}else{a.text((0,c.default)(d).text())}return}if(this.config.html){if(this.config.sanitize){d=(0,b.sanitizeHtml)(d,this.config.whiteList,this.config.sanitizeFn)}a.html(d)}else{a.text(d)}}},{key:"getTitle",value:function getTitle(){var a=this.element.getAttribute("data-original-title");if(!a){a="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title}return a}},{key:"_getPopperConfig",value:function _getPopperConfig(a){var b=this,c={placement:a,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function onCreate(a){if(a.originalPlacement!==a.placement){b._handlePopperPlacementChange(a)}},onUpdate:function onUpdate(a){return b._handlePopperPlacementChange(a)}};return h({},c,{},this.config.popperConfig)}},{key:"_getOffset",value:function _getOffset(){var a=this,b={};if("function"==typeof this.config.offset){b.fn=function(b){b.offsets=h({},b.offsets,{},a.config.offset(b.offsets,a.element)||{});return b}}else{b.offset=this.config.offset}return b}},{key:"_getContainer",value:function _getContainer(){if(!1===this.config.container){return document.body}if(e.default.isElement(this.config.container)){return(0,c.default)(this.config.container)}return(0,c.default)(document).find(this.config.container)}},{key:"_getAttachment",value:function _getAttachment(a){return u[a.toUpperCase()]}},{key:"_setListeners",value:function _setListeners(){var a=this,b=this.config.trigger.split(" ");b.forEach(function(b){if("click"===b){(0,c.default)(a.element).on(a.constructor.Event.CLICK,a.config.selector,function(b){return a.toggle(b)})}else if(b!=="manual"){var d=b===B?a.constructor.Event.MOUSEENTER:a.constructor.Event.FOCUSIN,e=b===B?a.constructor.Event.MOUSELEAVE:a.constructor.Event.FOCUSOUT;(0,c.default)(a.element).on(d,a.config.selector,function(b){return a._enter(b)}).on(e,a.config.selector,function(b){return a._leave(b)})}});this._hideModalHandler=function(){if(a.element){a.hide()}};(0,c.default)(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler);if(this.config.selector){this.config=h({},this.config,{trigger:"manual",selector:""})}else{this._fixTitle()}}},{key:"_fixTitle",value:function _fixTitle(){var a=j(this.element.getAttribute("data-original-title"));if(this.element.getAttribute("title")||"string"!==a){this.element.setAttribute("data-original-title",this.element.getAttribute("title")||"");this.element.setAttribute("title","")}}},{key:"_enter",value:function _enter(a,b){var d=this.constructor.DATA_KEY;b=b||(0,c.default)(a.currentTarget).data(d);if(!b){b=new this.constructor(a.currentTarget,this._getDelegateConfig());(0,c.default)(a.currentTarget).data(d,b)}if(a){b._activeTrigger["focusin"===a.type?C:B]=!0}if((0,c.default)(b.getTipElement()).hasClass(A)||b._hoverState===w){b._hoverState=w;return}clearTimeout(b._timeout);b._hoverState=w;if(!b.config.delay||!b.config.delay.show){b.show();return}b._timeout=setTimeout(function(){if(b._hoverState===w){b.show()}},b.config.delay.show)}},{key:"_leave",value:function _leave(a,b){var d=this.constructor.DATA_KEY;b=b||(0,c.default)(a.currentTarget).data(d);if(!b){b=new this.constructor(a.currentTarget,this._getDelegateConfig());(0,c.default)(a.currentTarget).data(d,b)}if(a){b._activeTrigger["focusout"===a.type?C:B]=!1}if(b._isWithActiveTrigger()){return}clearTimeout(b._timeout);b._hoverState=x;if(!b.config.delay||!b.config.delay.hide){b.hide();return}b._timeout=setTimeout(function(){if(b._hoverState===x){b.hide()}},b.config.delay.hide)}},{key:"_isWithActiveTrigger",value:function _isWithActiveTrigger(){for(var a in this._activeTrigger){if(this._activeTrigger[a]){return!0}}return!1}},{key:"_getConfig",value:function _getConfig(a){var d=(0,c.default)(this.element).data();Object.keys(d).forEach(function(a){if(-1!==s.indexOf(a)){delete d[a]}});a=h({},this.constructor.Default,{},d,{},"object"===j(a)&&a?a:{});if("number"==typeof a.delay){a.delay={show:a.delay,hide:a.delay}}if("number"==typeof a.title){a.title=a.title.toString()}if("number"==typeof a.content){a.content=a.content.toString()}e.default.typeCheckConfig("tooltip",a,this.constructor.DefaultType);if(a.sanitize){a.template=(0,b.sanitizeHtml)(a.template,a.whiteList,a.sanitizeFn)}return a}},{key:"_getDelegateConfig",value:function _getDelegateConfig(){var a={};if(this.config){for(var b in this.config){if(this.constructor.Default[b]!==this.config[b]){a[b]=this.config[b]}}}return a}},{key:"_cleanTipClass",value:function _cleanTipClass(){var a=(0,c.default)(this.getTipElement()),b=a.attr("class").match(r);if(null!==b&&b.length){a.removeClass(b.join(""))}}},{key:"_handlePopperPlacementChange",value:function _handlePopperPlacementChange(a){this.tip=a.instance.popper;this._cleanTipClass();this.addAttachmentClass(this._getAttachment(a.placement))}},{key:"_fixTransition",value:function _fixTransition(){var a=this.getTipElement(),b=this.config.animation;if(null!==a.getAttribute("x-placement")){return}(0,c.default)(a).removeClass(z);this.config.animation=!1;this.hide();this.show();this.config.animation=b}}],[{key:"_jQueryInterface",value:function _jQueryInterface(b){return this.each(function(){var d=(0,c.default)(this).data(n),e="object"===j(b)&&b;if(!d&&/dispose|hide/.test(b)){return}if(!d){d=new a(this,e);(0,c.default)(this).data(n,d)}if("string"==typeof b){if("undefined"==typeof d[b]){throw new TypeError("No method named \"".concat(b,"\""))}d[b]()}})}},{key:"VERSION",get:function get(){return"4.5.0"}},{key:"Default",get:function get(){return v}},{key:"NAME",get:function get(){return"tooltip"}},{key:"DATA_KEY",get:function get(){return n}},{key:"Event",get:function get(){return y}},{key:"EVENT_KEY",get:function get(){return o}},{key:"DefaultType",get:function get(){return t}}]);return a}();c.default.fn.tooltip=D._jQueryInterface;c.default.fn.tooltip.Constructor=D;c.default.fn.tooltip.noConflict=function(){c.default.fn.tooltip=p;return D._jQueryInterface};a.default=D;return a.default});
define ("theme_boost/bootstrap/util",["exports","jquery"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);function c(a){if(null===a||"undefined"==typeof a){return"".concat(a)}return{}.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase()}function d(){return{bindType:"transitionend",delegateType:"transitionend",handle:function handle(a){if((0,b.default)(a.target).is(this)){return a.handleObj.handler.apply(this,arguments)}}}}function e(a){var c=this,d=!1;(0,b.default)(this).one(g.TRANSITION_END,function(){d=!0});setTimeout(function(){if(!d){g.triggerTransitionEnd(c)}},a);return this}function f(){b.default.fn.emulateTransitionEnd=e;b.default.event.special[g.TRANSITION_END]=d()}var g={TRANSITION_END:"bsTransitionEnd",getUID:function getUID(a){do{a+=~~(Math.random()*1e6)}while(document.getElementById(a));return a},getSelectorFromElement:function getSelectorFromElement(a){var b=a.getAttribute("data-target");if(!b||"#"===b){var c=a.getAttribute("href");b=c&&"#"!==c?c.trim():""}try{return document.querySelector(b)?b:null}catch(a){return null}},getTransitionDurationFromElement:function getTransitionDurationFromElement(a){if(!a){return 0}var c=(0,b.default)(a).css("transition-duration"),d=(0,b.default)(a).css("transition-delay"),e=parseFloat(c),f=parseFloat(d);if(!e&&!f){return 0}c=c.split(",")[0];d=d.split(",")[0];return(parseFloat(c)+parseFloat(d))*1e3},reflow:function reflow(a){return a.offsetHeight},triggerTransitionEnd:function triggerTransitionEnd(a){(0,b.default)(a).trigger("transitionend")},supportsTransitionEnd:function supportsTransitionEnd(){return!0},isElement:function isElement(a){return(a[0]||a).nodeType},typeCheckConfig:function typeCheckConfig(a,b,d){for(var i in d){if(Object.prototype.hasOwnProperty.call(d,i)){var e=d[i],f=b[i],h=f&&g.isElement(f)?"element":c(f);if(!new RegExp(e).test(h)){throw new Error("".concat(a.toUpperCase(),": ")+"Option \"".concat(i,"\" provided type \"").concat(h,"\" ")+"but expected type \"".concat(e,"\"."))}}}},findShadowRoot:function findShadowRoot(a){if(!document.documentElement.attachShadow){return null}if("function"==typeof a.getRootNode){var b=a.getRootNode();return b instanceof ShadowRoot?b:null}if(a instanceof ShadowRoot){return a}if(!a.parentNode){return null}return g.findShadowRoot(a.parentNode)},jQueryDetection:function jQueryDetection(){if("undefined"==typeof b.default){throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.")}var a=b.default.fn.jquery.split(" ")[0].split("."),c=9;if(a[0]<2&&a[1]<c||a[0]===1&&a[1]===c&&a[2]<1||a[0]>=4){throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}}};g.jQueryDetection();f();a.default=g;return a.default});
define ("theme_boost/aria",["exports","core/key_codes","jquery","core/pending"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;c=e(c);d=e(d);function e(a){return a&&a.__esModule?a:{default:a}}var f=function(){var a=!1,e=function(){a=!0},f=function(){var b=a;a=!1;return b};document.addEventListener("keydown",function(a){if(a.target.matches("[data-toggle=\"dropdown\"]")){var c=a.which;if(c==b.arrowUp){e()}if(c==b.space||c==b.enter){a.preventDefault();a.target.click()}}});var g=function(a){setTimeout(function delayedFocus(b){a.focus();b.resolve()},50,new d.default("core/aria:delayed-focus"))};(0,c.default)(".dropdown").on("shown.bs.dropdown",function(a){var b=a.target.querySelector("[role=\"menu\"]"),c=!1,d=!1;if(b){c=b.querySelectorAll("[role=\"menuitem\"]")}if(c&&0<c.length){if(f()){d=c[c.length-1]}else{d=c[0]}}if(d){g(d)}});document.addEventListener("keypress",function(a){if(a.target.matches(".dropdown [role=\"menu\"] [role=\"menuitem\"]")){var b=String.fromCharCode(a.which).toLowerCase(),c=a.target.closest("[role=\"menu\"]");if(!c){return}var f=c.querySelectorAll("[role=\"menuitem\"]");if(!f){return}for(var h=0;h<f.length;h++){var d=f[h],e=d.text.trim().toLowerCase();if(0==e.indexOf(b)){g(d);break}}}});document.addEventListener("keydown",function(a){if(a.target.matches(".dropdown [role=\"menu\"] [role=\"menuitem\"]")){var c=a.which,d=!1,e=a.target.closest("[role=\"menu\"]");if(!e){return}var f=e.querySelectorAll("[role=\"menuitem\"]");if(!f){return}if(c==b.arrowDown){for(var h=0;h<f.length-1;h++){if(f[h]==a.target){d=f[h+1];break}}if(!d){d=f[0]}}else if(c==b.arrowUp){for(var i=1;i<f.length;i++){if(f[i]==a.target){d=f[i-1];break}}if(!d){d=f[f.length-1]}}else if(c==b.home){d=f[0]}else if(c==b.end){d=f[f.length-1]}if(d){a.preventDefault();g(d)}}});(0,c.default)(".dropdown").on("hidden.bs.dropdown",function(a){var b=a.target.querySelector("[data-toggle=\"dropdown\"]");if(b){g(b)}})},g=function(){window.addEventListener("load",function(){var a=document.querySelectorAll("[data-aria-autofocus=\"true\"][role=\"alert\"]");Array.prototype.forEach.call(a,function(a){a.innerHTML+=" ";a.removeAttribute("data-aria-autofocus")})})},h=function(a){for(var d=a.target.closest("[role=\"tablist\"]"),e="vertical"==d.getAttribute("aria-orientation"),f=window.right_to_left(),g=e?b.arrowDown:f?b.arrowLeft:b.arrowRight,h=e?b.arrowUp:f?b.arrowRight:b.arrowLeft,j=Array.prototype.filter.call(d.querySelectorAll("[role=\"tab\"]"),function(a){return"none"!==getComputedStyle(a).display}),k=0;k<j.length;k++){j[k].index=k}switch(a.keyCode){case g:a.preventDefault();if(a.target.index!==void 0&&j[a.target.index+1]){j[a.target.index+1].focus()}else{j[0].focus()}break;case h:a.preventDefault();if(a.target.index!==void 0&&j[a.target.index-1]){j[a.target.index-1].focus()}else{j[j.length-1].focus()}break;case b.home:a.preventDefault();j[0].focus();break;case b.end:a.preventDefault();j[j.length-1].focus();break;case b.enter:case b.space:a.preventDefault();(0,c.default)(a.target).tab("show");j.forEach(function(a){a.tabIndex=-1});a.target.tabIndex=0;}},i=function(){document.addEventListener("keydown",function(a){if([b.arrowUp,b.arrowDown,b.arrowLeft,b.arrowRight,b.home,b.end,b.enter,b.space].includes(a.keyCode)){if(a.target.matches("[role=\"tablist\"] [role=\"tab\"]")){h(a)}}});document.addEventListener("click",function(a){if(a.target.matches("[role=\"tablist\"] [role=\"tab\"]")){var b=a.target.closest("[role=\"tablist\"]").querySelectorAll("[role=\"tab\"]");a.preventDefault();(0,c.default)(a.target).tab("show");b.forEach(function(a){a.tabIndex=-1});a.target.tabIndex=0}})};a.init=function init(){f();g();i()}});
define ("theme_boost/drawer",["jquery","core/custom_interaction_events","core/log","core/pubsub"],function(a,b,c,d){var f={TOGGLE_REGION:"[data-region=\"drawer-toggle\"]",TOGGLE_ACTION:"[data-action=\"toggle-drawer\"]",TOGGLE_TARGET:"aria-controls",TOGGLE_SIDE:"left",BODY:"body",SECTION:".list-group-item[href*=\"#section-\"]",DRAWER:"#nav-drawer"},g=768>a(document).width(),h=function(){if(!a(f.TOGGLE_REGION).length){c.debug("Page is missing a drawer region")}if(!a(f.TOGGLE_ACTION).length){c.debug("Page is missing a drawer toggle link")}a(f.TOGGLE_REGION).each(function(b,c){var d=a(c).find(f.TOGGLE_ACTION),e=d.attr("aria-controls"),h=a(document.getElementById(e)),i="false"==d.attr("aria-expanded"),j=d.attr("data-side"),k=a(f.BODY),l=d.attr("data-preference");if(g){M.util.set_user_preference(l,"false")}h.on("mousewheel DOMMouseScroll",this.preventPageScroll);if(!i){k.addClass("drawer-open-"+j);d.attr("aria-expanded","true")}else{d.attr("aria-expanded","false")}}.bind(this));this.registerEventListeners();if(g){this.closeAll()}};h.prototype.closeAll=function(){a(f.TOGGLE_REGION).each(function(b,c){var d=a(c).find(f.TOGGLE_ACTION),e=d.attr("data-side"),h=a(f.BODY),i=d.attr("aria-controls"),j=a(document.getElementById(i)),k=d.attr("data-preference");d.attr("aria-expanded","false");h.removeClass("drawer-open-"+e);j.attr("aria-hidden","true");j.addClass("closed");if(!g){M.util.set_user_preference(k,"false")}})};h.prototype.toggleDrawer=function(b){var c=a(b.target).closest("[data-action=toggle-drawer]"),e=c.attr("aria-controls"),h=a(document.getElementById(e)),i=a(f.BODY),j=c.attr("data-side"),k=c.attr("data-preference");if(g){M.util.set_user_preference(k,"false")}i.addClass("drawer-ease");var l="true"==c.attr("aria-expanded");if(!l){c.attr("aria-expanded","true");h.attr("aria-hidden","false");h.focus();i.addClass("drawer-open-"+j);h.removeClass("closed");if(!g){M.util.set_user_preference(k,"true")}}else{i.removeClass("drawer-open-"+j);c.attr("aria-expanded","false");h.addClass("closed").delay(500).queue(function(){if(a(this).hasClass("closed")){a(this).attr("aria-hidden","true")}a(this).dequeue()});if(!g){M.util.set_user_preference(k,"false")}}d.publish("nav-drawer-toggle-start",l)};h.prototype.preventPageScroll=function(b){var c=b.wheelDelta||b.originalEvent&&b.originalEvent.wheelDelta||-b.originalEvent.detail,d=0<=this.scrollTop+a(this).outerHeight()-this.scrollHeight,e=0>=this.scrollTop;if(0>c&&d||0<c&&e){b.preventDefault()}};h.prototype.registerEventListeners=function(){a(f.TOGGLE_ACTION).each(function(c,d){b.define(a(d),[b.events.activate]);a(d).on(b.events.activate,function(a,b){this.toggleDrawer(b.originalEvent);b.originalEvent.preventDefault()}.bind(this))}.bind(this));a(f.SECTION).click(function(){if(g){this.closeAll()}}.bind(this));a(f.DRAWER).on("webkitTransitionEnd msTransitionEnd transitionend",function(b){var c=a(b.target).closest(f.DRAWER),e="false"==c.attr("aria-hidden");d.publish("nav-drawer-toggle-end",e)})};return{init:function init(){return new h}}});
define ("theme_boost/form-display-errors",["jquery","core/event"],function(a,b){return{enhance:function enhance(c){var d=document.getElementById(c);if(!d){return}a(d).on(b.Events.FORM_FIELD_VALIDATION,function(b,c){b.preventDefault();var e=a(d).closest(".form-group"),f=e.find(".form-control-feedback"),g=f.attr("id"),h=a(d).attr("aria-describedby");if("undefined"==typeof h){h=""}var i=[];if(h.length){i=h.split(" ")}var j=i.indexOf(g);if("TEXTAREA"==a(d).prop("tagName")&&e.find("[contenteditable]")){d=e.find("[contenteditable]")}if(""!==c){e.addClass("has-danger");e.data("client-validation-error",!0);a(d).addClass("is-invalid");if(-1===j){i.push(g);a(d).attr("aria-describedby",i.join(" "))}a(d).attr("aria-invalid",!0);f.attr("tabindex",0);f.html(c);if(!f.is(":visible")){f.show();f.focus()}}else{if(!0===e.data("client-validation-error")){e.removeClass("has-danger");e.data("client-validation-error",!1);a(d).removeClass("is-invalid");if(-1<j){i.splice(j,1)}if(i.length){h=i.join(" ");a(d).attr("aria-describedby",h)}else{a(d).removeAttr("aria-describedby")}a(d).attr("aria-invalid",!1);f.hide()}}});var e=d.closest("form");if(e&&!("boostFormErrorsEnhanced"in e.dataset)){e.addEventListener("submit",function(){var b=a(".form-control-feedback:visible");if(b.length){b[0].focus()}});e.dataset.boostFormErrorsEnhanced=1}}}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("theme_boost/loader",["exports","jquery","./aria","./bootstrap/index","core/pending","./scroll","./pending"],function(a,b,c,d,e,f,g){"use strict";Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"Bootstrap",{enumerable:!0,get:function get(){return d.default}});b=j(b);c=i(c);d=j(d);e=j(e);f=j(f);g=j(g);function h(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;h=function(){return a};return a}function i(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=h();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function j(a){return a&&a.__esModule?a:{default:a}}var k=function(){(0,b.default)("a[data-toggle=\"tab\"]").on("shown.bs.tab",function(a){var c=(0,b.default)(a.target).attr("href");if(history.replaceState){history.replaceState(null,null,c)}else{location.hash=c}});var a=window.location.hash;if(a){var c=document.querySelector(".nav-link[href=\""+a+"\"]");if(c){c.click()}}},l=function(){(0,b.default)("body").popover({container:"body",selector:"[data-toggle=\"popover\"]",trigger:"focus"});document.addEventListener("keydown",function(a){if("Escape"===a.key&&a.target.closest("[data-toggle=\"popover\"]")){(0,b.default)(a.target).popover("hide")}})},m=function(){(0,b.default)("body").tooltip({container:"body",selector:"[data-toggle=\"tooltip\"]"})},n=new e.default("theme_boost/loader:init");(0,g.default)();c.init();k();l();m();new f.default().init();b.default.fn.dropdown.Constructor.Default.flip=!1;n.resolve()});
define ("theme_boost/pending",["exports","jquery"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);function c(a,b){return h(a)||g(a,b)||e(a,b)||d()}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function e(a,b){if(!a)return;if("string"==typeof a)return f(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return f(a,b)}function f(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function g(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function h(a){if(Array.isArray(a))return a}var i={alert:[{start:"close",end:"closed"}],carousel:[{start:"slide",end:"slid"}],collapse:[{start:"hide",end:"hidden"},{start:"show",end:"shown"}],dropdown:[{start:"hide",end:"hidden"},{start:"show",end:"shown"}],modal:[{start:"hide",end:"hidden"},{start:"show",end:"shown"}],popover:[{start:"hide",end:"hidden"},{start:"show",end:"shown"}],tab:[{start:"hide",end:"hidden"},{start:"show",end:"shown"}],toast:[{start:"hide",end:"hidden"},{start:"show",end:"shown"}],tooltip:[{start:"hide",end:"hidden"},{start:"show",end:"shown"}]};a.default=function(){Object.entries(i).forEach(function(a){var d=c(a,2),e=d[0],f=d[1];f.forEach(function(a){var c="".concat(a.start,".bs.").concat(e),d="".concat(a.end,".bs.").concat(e);(0,b.default)(document.body).on(c,function(a){M.util.js_pending(d);(0,b.default)(a.target).one(d,function(){M.util.js_complete(d)})})})})};return a.default});
define ("theme_boost/popover",["exports","./bootstrap/popover"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"Popover",{enumerable:!0,get:function get(){return b.default}});b=function(a){return a&&a.__esModule?a:{default:a}}(b)});
define ("theme_boost/scroll",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;function b(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function c(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function d(a,b,d){if(b)c(a.prototype,b);if(d)c(a,d);return a}var e=function(){function a(){b(this,a)}d(a,[{key:"init",value:function init(){this.scrollY=0;window.addEventListener("scroll",this.scrollHandler.bind(this));return this}},{key:"getScrollPosition",value:function getScrollPosition(){return window.pageYOffset||document.documentElement.scrollTop}},{key:"scrollHandler",value:function scrollHandler(){var a=document.querySelector("body"),b=this.getScrollPosition();if(b>=window.innerHeight){a.classList.add("scrolled")}else{a.classList.remove("scrolled")}}}]);return a}();a.default=e;return a.default});
define ("theme_boost/toast",["exports","./bootstrap/toast"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"Toast",{enumerable:!0,get:function get(){return b.default}});b=function(a){return a&&a.__esModule?a:{default:a}}(b)});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a){if("function"==typeof define&&define.amd){define ("theme_coursemos/bootstrap-datepicker",["jquery"],a)}else if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))){a(require("jquery"))}else{a(jQuery)}})(function(b){function a(){return new Date(Date.UTC.apply(Date,arguments))}function c(){var b=new Date;return a(b.getFullYear(),b.getMonth(),b.getDate())}function e(a,b){return a.getUTCFullYear()===b.getUTCFullYear()&&a.getUTCMonth()===b.getUTCMonth()&&a.getUTCDate()===b.getUTCDate()}function f(a,c){return function(){if(c!==void 0){b.fn.datepicker.deprecated(c)}return this[a].apply(this,arguments)}}function g(a){return a&&!isNaN(a.getTime())}var j=function(){var c={get:function get(a){return this.slice(a)[0]},contains:function contains(a){for(var b=a&&a.valueOf(),c=0,d=this.length;c<d;c++){if(0<=this[c].valueOf()-b&&this[c].valueOf()-b<86400000)return c}return-1},remove:function remove(a){this.splice(a,1)},replace:function replace(a){if(!a)return;if(!b.isArray(a))a=[a];this.clear();this.push.apply(this,a)},clear:function clear(){this.length=0},copy:function copy(){var b=new j;b.replace(this);return b}};return function(){var d=[];d.push.apply(d,arguments);b.extend(d,c);return d}}(),k=function(a,c){b.data(a,"datepicker",this);this._events=[];this._secondaryEvents=[];this._process_options(c);this.dates=new j;this.viewDate=this.o.defaultViewDate;this.focusDate=null;this.element=b(a);this.isInput=this.element.is("input");this.inputField=this.isInput?this.element:this.element.find("input");this.component=this.element.hasClass("date")?this.element.find(".add-on, .input-group-addon, .input-group-append, .input-group-prepend, .btn"):!1;if(this.component&&0===this.component.length)this.component=!1;this.isInline=!this.component&&this.element.is("div");this.picker=b(r.template);if(this._check_template(this.o.templates.leftArrow)){this.picker.find(".prev").html(this.o.templates.leftArrow)}if(this._check_template(this.o.templates.rightArrow)){this.picker.find(".next").html(this.o.templates.rightArrow)}this._buildEvents();this._attachEvents();if(this.isInline){this.picker.addClass("datepicker-inline").appendTo(this.element)}else{this.picker.addClass("datepicker-dropdown dropdown-menu")}if(this.o.rtl){this.picker.addClass("datepicker-rtl")}if(this.o.calendarWeeks){this.picker.find(".datepicker-days .datepicker-switch, thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(a,b){return+b+1})}this._process_options({startDate:this._o.startDate,endDate:this._o.endDate,daysOfWeekDisabled:this.o.daysOfWeekDisabled,daysOfWeekHighlighted:this.o.daysOfWeekHighlighted,datesDisabled:this.o.datesDisabled});this._allow_update=!1;this.setViewMode(this.o.startView);this._allow_update=!0;this.fillDow();this.fillMonths();this.update();if(this.isInline){this.show()}};k.prototype={constructor:k,_resolveViewName:function _resolveViewName(a){b.each(r.viewModes,function(c,d){if(a===c||-1!==b.inArray(a,d.names)){a=c;return!1}});return a},_resolveDaysOfWeek:function _resolveDaysOfWeek(a){if(!b.isArray(a))a=a.split(/[,\s]*/);return b.map(a,Number)},_check_template:function _check_template(a){try{if(a===void 0||""===a){return!1}if(0>=(a.match(/[<>]/g)||[]).length){return!0}var c=b(a);return 0<c.length}catch(a){return!1}},_process_options:function _process_options(d){this._o=b.extend({},this._o,d);var e=this.o=b.extend({},this._o),f=e.language;if(!q[f]){f=f.split("-")[0];if(!q[f])f=o.language}e.language=f;e.startView=this._resolveViewName(e.startView);e.minViewMode=this._resolveViewName(e.minViewMode);e.maxViewMode=this._resolveViewName(e.maxViewMode);e.startView=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,e.startView));if(!0!==e.multidate){e.multidate=+e.multidate||!1;if(!1!==e.multidate)e.multidate=Math.max(0,e.multidate)}e.multidateSeparator=e.multidateSeparator+"";e.weekStart%=7;e.weekEnd=(e.weekStart+6)%7;var g=r.parseFormat(e.format);if(e.startDate!==-Infinity){if(!!e.startDate){if(e.startDate instanceof Date)e.startDate=this._local_to_utc(this._zero_time(e.startDate));else e.startDate=r.parseDate(e.startDate,g,e.language,e.assumeNearbyYear)}else{e.startDate=-Infinity}}if(e.endDate!==1/0){if(!!e.endDate){if(e.endDate instanceof Date)e.endDate=this._local_to_utc(this._zero_time(e.endDate));else e.endDate=r.parseDate(e.endDate,g,e.language,e.assumeNearbyYear)}else{e.endDate=1/0}}e.daysOfWeekDisabled=this._resolveDaysOfWeek(e.daysOfWeekDisabled||[]);e.daysOfWeekHighlighted=this._resolveDaysOfWeek(e.daysOfWeekHighlighted||[]);e.datesDisabled=e.datesDisabled||[];if(!b.isArray(e.datesDisabled)){e.datesDisabled=e.datesDisabled.split(",")}e.datesDisabled=b.map(e.datesDisabled,function(a){return r.parseDate(a,g,e.language,e.assumeNearbyYear)});var h=(e.orientation+"").toLowerCase().split(/\s+/g),i=e.orientation.toLowerCase();h=b.grep(h,function(a){return /^auto|left|right|top|bottom$/.test(a)});e.orientation={x:"auto",y:"auto"};if(!i||"auto"===i);else if(1===h.length){switch(h[0]){case"top":case"bottom":e.orientation.y=h[0];break;case"left":case"right":e.orientation.x=h[0];break;}}else{i=b.grep(h,function(a){return /^left|right$/.test(a)});e.orientation.x=i[0]||"auto";i=b.grep(h,function(a){return /^top|bottom$/.test(a)});e.orientation.y=i[0]||"auto"}if(e.defaultViewDate instanceof Date||"string"==typeof e.defaultViewDate){e.defaultViewDate=r.parseDate(e.defaultViewDate,g,e.language,e.assumeNearbyYear)}else if(e.defaultViewDate){var j=e.defaultViewDate.year||new Date().getFullYear(),k=e.defaultViewDate.month||0,l=e.defaultViewDate.day||1;e.defaultViewDate=a(j,k,l)}else{e.defaultViewDate=c()}},_applyEvents:function _applyEvents(a){for(var b=0,c,d,e;b<a.length;b++){c=a[b][0];if(2===a[b].length){d=void 0;e=a[b][1]}else if(3===a[b].length){d=a[b][1];e=a[b][2]}c.on(e,d)}},_unapplyEvents:function _unapplyEvents(a){for(var b=0,c,d,e;b<a.length;b++){c=a[b][0];if(2===a[b].length){e=void 0;d=a[b][1]}else if(3===a[b].length){e=a[b][1];d=a[b][2]}c.off(d,e)}},_buildEvents:function _buildEvents(){var a={keyup:b.proxy(function(a){if(-1===b.inArray(a.keyCode,[27,37,39,38,40,32,13,9]))this.update()},this),keydown:b.proxy(this.keydown,this),paste:b.proxy(this.paste,this)};if(!0===this.o.showOnFocus){a.focus=b.proxy(this.show,this)}if(this.isInput){this._events=[[this.element,a]]}else if(this.component&&this.inputField.length){this._events=[[this.inputField,a],[this.component,{click:b.proxy(this.show,this)}]]}else{this._events=[[this.element,{click:b.proxy(this.show,this),keydown:b.proxy(this.keydown,this)}]]}this._events.push([this.element,"*",{blur:b.proxy(function(a){this._focused_from=a.target},this)}],[this.element,{blur:b.proxy(function(a){this._focused_from=a.target},this)}]);if(this.o.immediateUpdates){this._events.push([this.element,{"changeYear changeMonth":b.proxy(function(a){this.update(a.date)},this)}])}this._secondaryEvents=[[this.picker,{click:b.proxy(this.click,this)}],[this.picker,".prev, .next",{click:b.proxy(this.navArrowsClick,this)}],[this.picker,".day:not(.disabled)",{click:b.proxy(this.dayCellClick,this)}],[b(window),{resize:b.proxy(this.place,this)}],[b(document),{"mousedown touchstart":b.proxy(function(a){if(!(this.element.is(a.target)||this.element.find(a.target).length||this.picker.is(a.target)||this.picker.find(a.target).length||this.isInline)){this.hide()}},this)}]]},_attachEvents:function _attachEvents(){this._detachEvents();this._applyEvents(this._events)},_detachEvents:function _detachEvents(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function _attachSecondaryEvents(){this._detachSecondaryEvents();this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function _detachSecondaryEvents(){this._unapplyEvents(this._secondaryEvents)},_trigger:function _trigger(a,c){var d=c||this.dates.get(-1),e=this._utc_to_local(d);this.element.trigger({type:a,date:e,viewMode:this.viewMode,dates:b.map(this.dates,this._utc_to_local),format:b.proxy(function(a,b){if(0===arguments.length){a=this.dates.length-1;b=this.o.format}else if("string"==typeof a){b=a;a=this.dates.length-1}b=b||this.o.format;var c=this.dates.get(a);return r.formatDate(c,b,this.o.language)},this)})},show:function show(){if(this.inputField.is(":disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly)return;if(!this.isInline)this.picker.appendTo(this.o.container);this.place();this.picker.show();this._attachSecondaryEvents();this._trigger("show");if((window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard){b(this.element).blur()}return this},hide:function hide(){if(this.isInline||!this.picker.is(":visible"))return this;this.focusDate=null;this.picker.hide().detach();this._detachSecondaryEvents();this.setViewMode(this.o.startView);if(this.o.forceParse&&this.inputField.val())this.setValue();this._trigger("hide");return this},destroy:function destroy(){this.hide();this._detachEvents();this._detachSecondaryEvents();this.picker.remove();delete this.element.data().datepicker;if(!this.isInput){delete this.element.data().date}return this},paste:function paste(a){var c;if(a.originalEvent.clipboardData&&a.originalEvent.clipboardData.types&&-1!==b.inArray("text/plain",a.originalEvent.clipboardData.types)){c=a.originalEvent.clipboardData.getData("text/plain")}else if(window.clipboardData){c=window.clipboardData.getData("Text")}else{return}this.setDate(c);this.update();a.preventDefault()},_utc_to_local:function _utc_to_local(a){if(!a){return a}var b=new Date(a.getTime()+6e4*a.getTimezoneOffset());if(b.getTimezoneOffset()!==a.getTimezoneOffset()){b=new Date(a.getTime()+6e4*b.getTimezoneOffset())}return b},_local_to_utc:function _local_to_utc(a){return a&&new Date(a.getTime()-6e4*a.getTimezoneOffset())},_zero_time:function _zero_time(a){return a&&new Date(a.getFullYear(),a.getMonth(),a.getDate())},_zero_utc_time:function _zero_utc_time(b){return b&&a(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate())},getDates:function getDates(){return b.map(this.dates,this._utc_to_local)},getUTCDates:function getUTCDates(){return b.map(this.dates,function(a){return new Date(a)})},getDate:function getDate(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function getUTCDate(){var a=this.dates.get(-1);if(a!==void 0){return new Date(a)}else{return null}},clearDates:function clearDates(){this.inputField.val("");this.update();this._trigger("changeDate");if(this.o.autoclose){this.hide()}},setDates:function setDates(){var a=b.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,a);this._trigger("changeDate");this.setValue();return this},setUTCDates:function setUTCDates(){var a=b.isArray(arguments[0])?arguments[0]:arguments;this.setDates.apply(this,b.map(a,this._utc_to_local));return this},setDate:f("setDates"),setUTCDate:f("setUTCDates"),remove:f("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead"),setValue:function setValue(){var a=this.getFormattedDate();this.inputField.val(a);return this},getFormattedDate:function getFormattedDate(a){if(a===void 0)a=this.o.format;var c=this.o.language;return b.map(this.dates,function(b){return r.formatDate(b,a,c)}).join(this.o.multidateSeparator)},getStartDate:function getStartDate(){return this.o.startDate},setStartDate:function setStartDate(a){this._process_options({startDate:a});this.update();this.updateNavArrows();return this},getEndDate:function getEndDate(){return this.o.endDate},setEndDate:function setEndDate(a){this._process_options({endDate:a});this.update();this.updateNavArrows();return this},setDaysOfWeekDisabled:function setDaysOfWeekDisabled(a){this._process_options({daysOfWeekDisabled:a});this.update();return this},setDaysOfWeekHighlighted:function setDaysOfWeekHighlighted(a){this._process_options({daysOfWeekHighlighted:a});this.update();return this},setDatesDisabled:function setDatesDisabled(a){this._process_options({datesDisabled:a});this.update();return this},place:function place(){if(this.isInline)return this;var a=this.picker.outerWidth(),c=this.picker.outerHeight(),d=b(this.o.container),e=d.width(),f="body"===this.o.container?b(document).scrollTop():d.scrollTop(),g=d.offset(),h=[0];this.element.parents().each(function(){var a=b(this).css("z-index");if("auto"!==a&&0!==+a)h.push(+a)});var i=Math.max.apply(Math,h)+this.o.zIndexOffset,j=this.component?this.component.parent().offset():this.element.offset(),k=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),l=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),m=j.left-g.left;if(!this.o.placeOffset){m=j.left}var n=j.top-g.top;if("body"!==this.o.container){n+=f}this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left");if("auto"!==this.o.orientation.x){this.picker.addClass("datepicker-orient-"+this.o.orientation.x);if("right"===this.o.orientation.x)m-=a-l}else{if(0>j.left){this.picker.addClass("datepicker-orient-left");m-=j.left-10}else if(m+a>e){this.picker.addClass("datepicker-orient-right");m+=l-a}else{if(this.o.rtl){this.picker.addClass("datepicker-orient-right")}else{this.picker.addClass("datepicker-orient-left")}}}var o=this.o.orientation.y,p;if("auto"===o){p=-f+n-c;o=0>p?"bottom":"top"}this.picker.addClass("datepicker-orient-"+o);if("top"===o)n-=c+parseInt(this.picker.css("padding-top"));else n+=k;if(this.o.rtl){var q=e-(m+l);this.picker.css({top:n,right:q,zIndex:i})}else{this.picker.css({top:n,left:m,zIndex:i})}return this},_allow_update:!0,update:function update(){if(!this._allow_update)return this;var a=this.dates.copy(),c=[],d=!1;if(arguments.length){b.each(arguments,b.proxy(function(a,b){if(b instanceof Date)b=this._local_to_utc(b);c.push(b)},this));d=!0}else{c=this.isInput?this.element.val():this.element.data("date")||this.inputField.val();if(c&&this.o.multidate)c=c.split(this.o.multidateSeparator);else c=[c];delete this.element.data().date}c=b.map(c,b.proxy(function(a){return r.parseDate(a,this.o.format,this.o.language,this.o.assumeNearbyYear)},this));c=b.grep(c,b.proxy(function(a){return!this.dateWithinRange(a)||!a},this),!0);this.dates.replace(c);if(this.o.updateViewDate){if(this.dates.length)this.viewDate=new Date(this.dates.get(-1));else if(this.viewDate<this.o.startDate)this.viewDate=new Date(this.o.startDate);else if(this.viewDate>this.o.endDate)this.viewDate=new Date(this.o.endDate);else this.viewDate=this.o.defaultViewDate}if(d){this.setValue();this.element.change()}else if(this.dates.length){if(a+""!==this.dates+""&&d){this._trigger("changeDate");this.element.change()}}if(!this.dates.length&&a.length){this._trigger("clearDate");this.element.change()}this.fill();return this},fillDow:function fillDow(){if(this.o.showWeekDays){var a=this.o.weekStart,c="<tr>";if(this.o.calendarWeeks){c+="<th class=\"cw\">&#160;</th>"}while(a<this.o.weekStart+7){c+="<th class=\"dow";if(-1!==b.inArray(a,this.o.daysOfWeekDisabled))c+=" disabled";c+="\">"+q[this.o.language].daysMin[a++%7]+"</th>"}c+="</tr>";this.picker.find(".datepicker-days thead").append(c)}},fillMonths:function fillMonths(){for(var a=this._utc_to_local(this.viewDate),b="",c,d=0;12>d;d++){c=a&&a.getMonth()===d?" focused":"";b+="<span class=\"month"+c+"\">"+q[this.o.language].monthsShort[d]+"</span>"}this.picker.find(".datepicker-months td").html(b)},setRange:function setRange(a){if(!a||!a.length)delete this.range;else this.range=b.map(a,function(a){return a.valueOf()});this.fill()},getClassNames:function getClassNames(a){var d=[],f=this.viewDate.getUTCFullYear(),g=this.viewDate.getUTCMonth(),h=c();if(a.getUTCFullYear()<f||a.getUTCFullYear()===f&&a.getUTCMonth()<g){d.push("old")}else if(a.getUTCFullYear()>f||a.getUTCFullYear()===f&&a.getUTCMonth()>g){d.push("new")}if(this.focusDate&&a.valueOf()===this.focusDate.valueOf())d.push("focused");if(this.o.todayHighlight&&e(a,h)){d.push("today")}if(-1!==this.dates.contains(a))d.push("active");if(!this.dateWithinRange(a)){d.push("disabled")}if(this.dateIsDisabled(a)){d.push("disabled","disabled-date")}if(-1!==b.inArray(a.getUTCDay(),this.o.daysOfWeekHighlighted)){d.push("highlighted")}if(this.range){if(a>this.range[0]&&a<this.range[this.range.length-1]){d.push("range")}if(-1!==b.inArray(a.valueOf(),this.range)){d.push("selected")}if(a.valueOf()===this.range[0]){d.push("range-start")}if(a.valueOf()===this.range[this.range.length-1]){d.push("range-end")}}return d},_fill_yearsView:function _fill_yearsView(a,c,d,e,f,g,h){for(var i="",j=d/10,k=this.picker.find(a),l=Math.floor(e/d)*d,m=l+9*j,n=Math.floor(this.viewDate.getFullYear()/j)*j,o=b.map(this.dates,function(a){return Math.floor(a.getUTCFullYear()/j)*j}),p,q,r,s=l-j;s<=m+j;s+=j){p=[c];q=null;if(s===l-j){p.push("old")}else if(s===m+j){p.push("new")}if(-1!==b.inArray(s,o)){p.push("active")}if(s<f||s>g){p.push("disabled")}if(s===n){p.push("focused")}if(h!==b.noop){r=h(new Date(s,0,1));if(r===void 0){r={}}else if("boolean"==typeof r){r={enabled:r}}else if("string"==typeof r){r={classes:r}}if(!1===r.enabled){p.push("disabled")}if(r.classes){p=p.concat(r.classes.split(/\s+/))}if(r.tooltip){q=r.tooltip}}i+="<span class=\""+p.join(" ")+"\""+(q?" title=\""+q+"\"":"")+">"+s+"</span>"}k.find(".datepicker-switch").text(l+"-"+m);k.find("td").html(i)},fill:function fill(){var e=new Date(this.viewDate),f=e.getUTCFullYear(),g=e.getUTCMonth(),h=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,i=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,j=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,k=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,l=q[this.o.language].today||q.en.today||"",m=q[this.o.language].clear||q.en.clear||"",n=q[this.o.language].titleFormat||q.en.titleFormat,o=c(),p=(!0===this.o.todayBtn||"linked"===this.o.todayBtn)&&o>=this.o.startDate&&o<=this.o.endDate&&!this.weekOfDateIsDisabled(o),s,t;if(isNaN(f)||isNaN(g))return;this.picker.find(".datepicker-days .datepicker-switch").text(r.formatDate(e,n,this.o.language));this.picker.find("tfoot .today").text(l).css("display",p?"table-cell":"none");this.picker.find("tfoot .clear").text(m).css("display",!0===this.o.clearBtn?"table-cell":"none");this.picker.find("thead .datepicker-title").text(this.o.title).css("display","string"==typeof this.o.title&&""!==this.o.title?"table-cell":"none");this.updateNavArrows();this.fillMonths();var u=a(f,g,0),v=u.getUTCDate();u.setUTCDate(v-(u.getUTCDay()-this.o.weekStart+7)%7);var w=new Date(u);if(100>u.getUTCFullYear()){w.setUTCFullYear(u.getUTCFullYear())}w.setUTCDate(w.getUTCDate()+42);w=w.valueOf();var x=[],y,z;while(u.valueOf()<w){y=u.getUTCDay();if(y===this.o.weekStart){x.push("<tr>");if(this.o.calendarWeeks){var A=new Date(+u+864e5*((this.o.weekStart-y-7)%7)),d=new Date(+A+864e5*((11-A.getUTCDay())%7)),B=new Date(+(B=a(d.getUTCFullYear(),0,1))+864e5*((11-B.getUTCDay())%7)),C=(d-B)/864e5/7+1;x.push("<td class=\"cw\">"+C+"</td>")}}z=this.getClassNames(u);z.push("day");var D=u.getUTCDate();if(this.o.beforeShowDay!==b.noop){t=this.o.beforeShowDay(this._utc_to_local(u));if(t===void 0)t={};else if("boolean"==typeof t)t={enabled:t};else if("string"==typeof t)t={classes:t};if(!1===t.enabled)z.push("disabled");if(t.classes)z=z.concat(t.classes.split(/\s+/));if(t.tooltip)s=t.tooltip;if(t.content)D=t.content}if(b.isFunction(b.uniqueSort)){z=b.uniqueSort(z)}else{z=b.unique(z)}x.push("<td class=\""+z.join(" ")+"\""+(s?" title=\""+s+"\"":"")+" data-date=\""+u.getTime().toString()+"\">"+D+"</td>");s=null;if(y===this.o.weekEnd){x.push("</tr>")}u.setUTCDate(u.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").html(x.join(""));var E=q[this.o.language].monthsTitle||q.en.monthsTitle||"Months",F=this.picker.find(".datepicker-months").find(".datepicker-switch").text(2>this.o.maxViewMode?E:f).end().find("tbody span").removeClass("active");b.each(this.dates,function(a,b){if(b.getUTCFullYear()===f)F.eq(b.getUTCMonth()).addClass("active")});if(f<h||f>j){F.addClass("disabled")}if(f===h){F.slice(0,i).addClass("disabled")}if(f===j){F.slice(k+1).addClass("disabled")}if(this.o.beforeShowMonth!==b.noop){var G=this;b.each(F,function(a,c){var d=new Date(f,a,1),e=G.o.beforeShowMonth(d);if(e===void 0)e={};else if("boolean"==typeof e)e={enabled:e};else if("string"==typeof e)e={classes:e};if(!1===e.enabled&&!b(c).hasClass("disabled"))b(c).addClass("disabled");if(e.classes)b(c).addClass(e.classes);if(e.tooltip)b(c).prop("title",e.tooltip)})}this._fill_yearsView(".datepicker-years","year",10,f,h,j,this.o.beforeShowYear);this._fill_yearsView(".datepicker-decades","decade",100,f,h,j,this.o.beforeShowDecade);this._fill_yearsView(".datepicker-centuries","century",1e3,f,h,j,this.o.beforeShowCentury)},updateNavArrows:function updateNavArrows(){if(!this._allow_update)return;var a=new Date(this.viewDate),b=a.getUTCFullYear(),c=a.getUTCMonth(),d=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,e=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,f=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,g=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,h,i,j=1;switch(this.viewMode){case 4:j*=10;case 3:j*=10;case 2:j*=10;case 1:h=Math.floor(b/j)*j<=d;i=Math.floor(b/j)*j+j>f;break;case 0:h=b<=d&&c<=e;i=b>=f&&c>=g;break;}this.picker.find(".prev").toggleClass("disabled",h);this.picker.find(".next").toggleClass("disabled",i)},click:function click(d){d.preventDefault();d.stopPropagation();var e,f,g,h;e=b(d.target);if(e.hasClass("datepicker-switch")&&this.viewMode!==this.o.maxViewMode){this.setViewMode(this.viewMode+1)}if(e.hasClass("today")&&!e.hasClass("day")){this.setViewMode(0);this._setDate(c(),"linked"===this.o.todayBtn?null:"view")}if(e.hasClass("clear")){this.clearDates()}if(!e.hasClass("disabled")){if(e.hasClass("month")||e.hasClass("year")||e.hasClass("decade")||e.hasClass("century")){this.viewDate.setUTCDate(1);f=1;if(1===this.viewMode){h=e.parent().find("span").index(e);g=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(h)}else{h=0;g=+e.text();this.viewDate.setUTCFullYear(g)}this._trigger(r.viewModes[this.viewMode-1].e,this.viewDate);if(this.viewMode===this.o.minViewMode){this._setDate(a(g,h,f))}else{this.setViewMode(this.viewMode-1);this.fill()}}}if(this.picker.is(":visible")&&this._focused_from){this._focused_from.focus()}delete this._focused_from},dayCellClick:function dayCellClick(a){var c=b(a.currentTarget),d=c.data("date"),e=new Date(d);if(this.o.updateViewDate){if(e.getUTCFullYear()!==this.viewDate.getUTCFullYear()){this._trigger("changeYear",this.viewDate)}if(e.getUTCMonth()!==this.viewDate.getUTCMonth()){this._trigger("changeMonth",this.viewDate)}}this._setDate(e)},navArrowsClick:function navArrowsClick(a){var c=b(a.currentTarget),d=c.hasClass("prev")?-1:1;if(0!==this.viewMode){d*=12*r.viewModes[this.viewMode].navStep}this.viewDate=this.moveMonth(this.viewDate,d);this._trigger(r.viewModes[this.viewMode].e,this.viewDate);this.fill()},_toggle_multidate:function _toggle_multidate(a){var b=this.dates.contains(a);if(!a){this.dates.clear()}if(-1!==b){if(!0===this.o.multidate||1<this.o.multidate||this.o.toggleActive){this.dates.remove(b)}}else if(!1===this.o.multidate){this.dates.clear();this.dates.push(a)}else{this.dates.push(a)}if("number"==typeof this.o.multidate)while(this.dates.length>this.o.multidate){this.dates.remove(0)}},_setDate:function _setDate(a,b){if(!b||"date"===b)this._toggle_multidate(a&&new Date(a));if(!b&&this.o.updateViewDate||"view"===b)this.viewDate=a&&new Date(a);this.fill();this.setValue();if(!b||"view"!==b){this._trigger("changeDate")}this.inputField.trigger("change");if(this.o.autoclose&&(!b||"date"===b)){this.hide()}},moveDay:function moveDay(a,b){var c=new Date(a);c.setUTCDate(a.getUTCDate()+b);return c},moveWeek:function moveWeek(a,b){return this.moveDay(a,7*b)},moveMonth:function moveMonth(a,b){if(!g(a))return this.o.defaultViewDate;if(!b)return a;var c=new Date(a.valueOf()),d=c.getUTCDate(),e=c.getUTCMonth(),f=Math.abs(b),h,j;b=0<b?1:-1;if(1===f){j=-1===b?function(){return c.getUTCMonth()===e}:function(){return c.getUTCMonth()!==h};h=e+b;c.setUTCMonth(h);h=(h+12)%12}else{for(var k=0;k<f;k++){c=this.moveMonth(c,b)}h=c.getUTCMonth();c.setUTCDate(d);j=function(){return h!==c.getUTCMonth()}}while(j()){c.setUTCDate(--d);c.setUTCMonth(h)}return c},moveYear:function moveYear(a,b){return this.moveMonth(a,12*b)},moveAvailableDate:function moveAvailableDate(a,b,c){do{a=this[c](a,b);if(!this.dateWithinRange(a))return!1;c="moveDay"}while(this.dateIsDisabled(a));return a},weekOfDateIsDisabled:function weekOfDateIsDisabled(a){return-1!==b.inArray(a.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function dateIsDisabled(a){return this.weekOfDateIsDisabled(a)||0<b.grep(this.o.datesDisabled,function(b){return e(a,b)}).length},dateWithinRange:function dateWithinRange(a){return a>=this.o.startDate&&a<=this.o.endDate},keydown:function keydown(a){if(!this.picker.is(":visible")){if(40===a.keyCode||27===a.keyCode){this.show();a.stopPropagation()}return}var b=!1,c,d,e=this.focusDate||this.viewDate;switch(a.keyCode){case 27:if(this.focusDate){this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.fill()}else this.hide();a.preventDefault();a.stopPropagation();break;case 37:case 38:case 39:case 40:if(!this.o.keyboardNavigation||7===this.o.daysOfWeekDisabled.length)break;c=37===a.keyCode||38===a.keyCode?-1:1;if(0===this.viewMode){if(a.ctrlKey){d=this.moveAvailableDate(e,c,"moveYear");if(d)this._trigger("changeYear",this.viewDate)}else if(a.shiftKey){d=this.moveAvailableDate(e,c,"moveMonth");if(d)this._trigger("changeMonth",this.viewDate)}else if(37===a.keyCode||39===a.keyCode){d=this.moveAvailableDate(e,c,"moveDay")}else if(!this.weekOfDateIsDisabled(e)){d=this.moveAvailableDate(e,c,"moveWeek")}}else if(1===this.viewMode){if(38===a.keyCode||40===a.keyCode){c=4*c}d=this.moveAvailableDate(e,c,"moveMonth")}else if(2===this.viewMode){if(38===a.keyCode||40===a.keyCode){c=4*c}d=this.moveAvailableDate(e,c,"moveYear")}if(d){this.focusDate=this.viewDate=d;this.setValue();this.fill();a.preventDefault()}break;case 13:if(!this.o.forceParse)break;e=this.focusDate||this.dates.get(-1)||this.viewDate;if(this.o.keyboardNavigation){this._toggle_multidate(e);b=!0}this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.setValue();this.fill();if(this.picker.is(":visible")){a.preventDefault();a.stopPropagation();if(this.o.autoclose)this.hide()}break;case 9:this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.fill();this.hide();break;}if(b){if(this.dates.length)this._trigger("changeDate");else this._trigger("clearDate");this.inputField.trigger("change")}},setViewMode:function setViewMode(a){this.viewMode=a;this.picker.children("div").hide().filter(".datepicker-"+r.viewModes[this.viewMode].clsName).show();this.updateNavArrows();this._trigger("changeViewMode",new Date(this.viewDate))}};var l=function(a,c){b.data(a,"datepicker",this);this.element=b(a);this.inputs=b.map(c.inputs,function(a){return a.jquery?a[0]:a});delete c.inputs;this.keepEmptyValues=c.keepEmptyValues;delete c.keepEmptyValues;n.call(b(this.inputs),c).on("changeDate",b.proxy(this.dateUpdated,this));this.pickers=b.map(this.inputs,function(a){return b.data(a,"datepicker")});this.updateDates()};l.prototype={updateDates:function updateDates(){this.dates=b.map(this.pickers,function(a){return a.getUTCDate()});this.updateRanges()},updateRanges:function updateRanges(){var a=b.map(this.dates,function(a){return a.valueOf()});b.each(this.pickers,function(b,c){c.setRange(a)})},clearDates:function clearDates(){b.each(this.pickers,function(a,b){b.clearDates()})},dateUpdated:function dateUpdated(a){if(this.updating)return;this.updating=!0;var c=b.data(a.target,"datepicker");if(c===void 0){return}var d=c.getUTCDate(),e=this.keepEmptyValues,f=b.inArray(a.target,this.inputs),g=f-1,h=f+1,i=this.inputs.length;if(-1===f)return;b.each(this.pickers,function(a,b){if(!b.getUTCDate()&&(b===c||!e))b.setUTCDate(d)});if(d<this.dates[g]){while(0<=g&&d<this.dates[g]){this.pickers[g--].setUTCDate(d)}}else if(d>this.dates[h]){while(h<i&&d>this.dates[h]){this.pickers[h++].setUTCDate(d)}}this.updateDates();delete this.updating},destroy:function destroy(){b.map(this.pickers,function(a){a.destroy()});b(this.inputs).off("changeDate",this.dateUpdated);delete this.element.data().datepicker},remove:f("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead")};function h(a,c){var e=b(a).data(),f={},g,h=new RegExp("^"+c.toLowerCase()+"([A-Z])");c=new RegExp("^"+c.toLowerCase());function d(b,c){return c.toLowerCase()}for(var i in e){if(c.test(i)){g=i.replace(h,d);f[g]=e[i]}}return f}function i(a){var c={};if(!q[a]){a=a.split("-")[0];if(!q[a])return}var e=q[a];b.each(p,function(a,b){if(b in e)c[b]=e[b]});return c}var m=b.fn.datepicker,n=function(a){var c=Array.apply(null,arguments);c.shift();var d;this.each(function(){var e=b(this),f=e.data("datepicker"),g="object"===_typeof(a)&&a;if(!f){var j=h(this,"date"),m=b.extend({},o,j,g),n=i(m.language),p=b.extend({},o,n,j,g);if(e.hasClass("input-daterange")||p.inputs){b.extend(p,{inputs:p.inputs||e.find("input").toArray()});f=new l(this,p)}else{f=new k(this,p)}e.data("datepicker",f)}if("string"==typeof a&&"function"==typeof f[a]){d=f[a].apply(f,c)}});if(d===void 0||d instanceof k||d instanceof l)return this;if(1<this.length)throw new Error("Using only allowed for the collection of a single element ("+a+" function)");else return d};b.fn.datepicker=n;var o=b.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:b.noop,beforeShowMonth:b.noop,beforeShowYear:b.noop,beforeShowDecade:b.noop,beforeShowCentury:b.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keepEmptyValues:!1,keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,updateViewDate:!0,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!1,title:"",templates:{leftArrow:"&#x00AB;",rightArrow:"&#x00BB;"},showWeekDays:!0,placeOffset:!0},p=b.fn.datepicker.locale_opts=["format","rtl","weekStart"];b.fn.datepicker.Constructor=k;var q=b.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},r={viewModes:[{names:["days","month"],clsName:"days",e:"changeMonth"},{names:["months","year"],clsName:"months",e:"changeYear",navStep:1},{names:["years","decade"],clsName:"years",e:"changeDecade",navStep:10},{names:["decades","century"],clsName:"decades",e:"changeCentury",navStep:100},{names:["centuries","millennium"],clsName:"centuries",e:"changeMillennium",navStep:1e3}],validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,parseFormat:function parseFormat(a){if("function"==typeof a.toValue&&"function"==typeof a.toDisplay)return a;var b=a.replace(this.validParts,"\0").split("\0"),c=a.match(this.validParts);if(!b||!b.length||!c||0===c.length){throw new Error("Invalid date format.")}return{separators:b,parts:c}},parseDate:function parseDate(a,d,e,f){if(!a)return void 0;if(a instanceof Date)return a;if("string"==typeof d)d=r.parseFormat(d);if(d.toValue)return d.toValue(a,d,e);var j={d:"moveDay",m:"moveMonth",w:"moveWeek",y:"moveYear"},l={yesterday:"-1d",today:"+0d",tomorrow:"+1d"},n,o,p,t,m;if(a in l){a=l[a]}if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/i.test(a)){n=a.match(/([\-+]\d+)([dmwy])/gi);a=new Date;for(t=0;t<n.length;t++){o=n[t].match(/([\-+]\d+)([dmwy])/i);p=+o[1];m=j[o[2].toLowerCase()];a=k.prototype[m](a,p)}return k.prototype._zero_utc_time(a)}n=a&&a.match(this.nonpunctuation)||[];function g(a,b){if(!0===b)b=10;if(100>a){a+=2e3;if(a>new Date().getFullYear()+b){a-=100}}return a}var u={},v=["yyyy","yy","M","MM","m","mm","d","dd"],w={yyyy:function yyyy(a,b){return a.setUTCFullYear(f?g(b,f):b)},m:function m(a,b){if(isNaN(a))return a;b-=1;while(0>b){b+=12}b%=12;a.setUTCMonth(b);while(a.getUTCMonth()!==b){a.setUTCDate(a.getUTCDate()-1)}return a},d:function d(a,b){return a.setUTCDate(b)}},x,y;w.yy=w.yyyy;w.M=w.MM=w.mm=w.m;w.dd=w.d;a=c();var z=d.parts.slice();if(n.length!==z.length){z=b(z).filter(function(a,c){return-1!==b.inArray(c,v)}).toArray()}function h(){var a=this.slice(0,n[t].length),b=n[t].slice(0,a.length);return a.toLowerCase()===b.toLowerCase()}if(n.length===z.length){var A;for(t=0,A=z.length;t<A;t++){x=parseInt(n[t],10);o=z[t];if(isNaN(x)){switch(o){case"MM":y=b(q[e].months).filter(h);x=b.inArray(y[0],q[e].months)+1;break;case"M":y=b(q[e].monthsShort).filter(h);x=b.inArray(y[0],q[e].monthsShort)+1;break;}}u[o]=x}var B,C;for(t=0;t<v.length;t++){C=v[t];if(C in u&&!isNaN(u[C])){B=new Date(a);w[C](B,u[C]);if(!isNaN(B))a=B}}}return a},formatDate:function formatDate(a,c,d){if(!a)return"";if("string"==typeof c)c=r.parseFormat(c);if(c.toDisplay)return c.toDisplay(a,c,d);var e={d:a.getUTCDate(),D:q[d].daysShort[a.getUTCDay()],DD:q[d].days[a.getUTCDay()],m:a.getUTCMonth()+1,M:q[d].monthsShort[a.getUTCMonth()],MM:q[d].months[a.getUTCMonth()],yy:a.getUTCFullYear().toString().substring(2),yyyy:a.getUTCFullYear()};e.dd=(10>e.d?"0":"")+e.d;e.mm=(10>e.m?"0":"")+e.m;a=[];for(var f=b.extend([],c.separators),g=0,h=c.parts.length;g<=h;g++){if(f.length)a.push(f.shift());a.push(e[c.parts[g]])}return a.join("")},headTemplate:"<thead><tr><th colspan=\"7\" class=\"datepicker-title\"></th></tr><tr><th class=\"prev\">"+o.templates.leftArrow+"</th><th colspan=\"5\" class=\"datepicker-switch\"></th><th class=\"next\">"+o.templates.rightArrow+"</th></tr></thead>",contTemplate:"<tbody><tr><td colspan=\"7\"></td></tr></tbody>",footTemplate:"<tfoot><tr><th colspan=\"7\" class=\"today\"></th></tr><tr><th colspan=\"7\" class=\"clear\"></th></tr></tfoot>"};r.template="<div class=\"datepicker\"><div class=\"datepicker-days\"><table class=\"table-condensed\">"+r.headTemplate+"<tbody></tbody>"+r.footTemplate+"</table></div><div class=\"datepicker-months\"><table class=\"table-condensed\">"+r.headTemplate+r.contTemplate+r.footTemplate+"</table></div><div class=\"datepicker-years\"><table class=\"table-condensed\">"+r.headTemplate+r.contTemplate+r.footTemplate+"</table></div><div class=\"datepicker-decades\"><table class=\"table-condensed\">"+r.headTemplate+r.contTemplate+r.footTemplate+"</table></div><div class=\"datepicker-centuries\"><table class=\"table-condensed\">"+r.headTemplate+r.contTemplate+r.footTemplate+"</table></div></div>";b.fn.datepicker.DPGlobal=r;b.fn.datepicker.noConflict=function(){b.fn.datepicker=m;return this};b.fn.datepicker.version="1.8.0";b.fn.datepicker.deprecated=function(a){var b=window.console;if(b&&b.warn){b.warn("DEPRECATED: "+a)}};b(document).on("focus.datepicker.data-api click.datepicker.data-api","[data-provide=\"datepicker\"]",function(a){var c=b(this);if(c.data("datepicker"))return;a.preventDefault();n.call(c,"show")});b(function(){n.call(b("[data-provide=\"datepicker-inline\"]"))})});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(e,t){if(e===void 0&&window!==void 0)e=window;if("function"==typeof define&&define.amd){define ("theme_coursemos/bootstrap-select",["jquery"],function(e){return t(e)})}else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){module.exports=t(require("jquery"))}else{t(e.jQuery)}})(this,function(e){(function(t){'use strict';var a=document.createElement("_");a.classList.toggle("c3",!1);if(a.classList.contains("c3")){var r=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){if(1 in arguments&&!this.contains(e)==!t){return t}else{return r.call(this,e)}}}function e(e,t){return e.length===t.length&&e.every(function(e,i){return e===t[i]})}if(!String.prototype.startsWith){(function(){var e=function(){try{var e={},t=Object.defineProperty,i=t(e,e,e)&&t}catch(e){}return i}(),t={}.toString,i=function(e){if(null==this){throw new TypeError}var i=this+"";if(e&&"[object RegExp]"==t.call(e)){throw new TypeError}var n=i.length,s=e+"",o=s.length,l=1<arguments.length?arguments[1]:void 0,c=l?+l:0;if(c!=c){c=0}var a=Math.min(Math.max(c,0),n);if(o+a>n){return!1}var r=-1;while(++r<o){if(i.charCodeAt(a+r)!=s.charCodeAt(r)){return!1}}return!0};if(e){e(String.prototype,"startsWith",{value:i,configurable:!0,writable:!0})}else{String.prototype.startsWith=i}})()}if(!Object.keys){Object.keys=function(e,t,i){i=[];for(t in e){i.hasOwnProperty.call(e,t)&&i.push(t)}return i}}function n(e){var t=[],n=e&&e.options,s;if(e.multiple){for(var o=0,l=n.length;o<l;o++){s=n[o];if(s.selected){t.push(s.value||s.text)}}}else{t=e.value}return t}var d={useDefault:!1,_set:t.valHooks.select.set};t.valHooks.select.set=function(e,i){if(i&&!d.useDefault)t(e).data("selected",!0);return d._set.apply(this,arguments)};var p=null,h=function(){try{new Event("change");return!0}catch(t){return!1}}();t.fn.triggerNative=function(e){var t=this[0],i;if(t.dispatchEvent){if(h){i=new Event(e,{bubbles:!0})}else{i=document.createEvent("Event");i.initEvent(e,!0,!1)}t.dispatchEvent(i)}else if(t.fireEvent){i=document.createEventObject();i.eventType=e;t.fireEvent("on"+e,i)}else{this.trigger(e)}};function s(e,t,n,s){for(var o=["content","subtext","tokens"],c=!1,a=0;a<o.length;a++){var r=o[a],d=e[r];if(d){d=d.toString();if("content"===r){d=d.replace(/<[^>]+>/g,"")}if(s)d=l(d);d=d.toUpperCase();if("contains"===n){c=0<=d.indexOf(t)}else{c=d.startsWith(t)}if(c)break}}return c}function o(e){return parseInt(e,10)||0}function l(e){t.each([{re:/[\xC0-\xC6]/g,ch:"A"},{re:/[\xE0-\xE6]/g,ch:"a"},{re:/[\xC8-\xCB]/g,ch:"E"},{re:/[\xE8-\xEB]/g,ch:"e"},{re:/[\xCC-\xCF]/g,ch:"I"},{re:/[\xEC-\xEF]/g,ch:"i"},{re:/[\xD2-\xD6]/g,ch:"O"},{re:/[\xF2-\xF6]/g,ch:"o"},{re:/[\xD9-\xDC]/g,ch:"U"},{re:/[\xF9-\xFC]/g,ch:"u"},{re:/[\xC7-\xE7]/g,ch:"c"},{re:/[\xD1]/g,ch:"N"},{re:/[\xF1]/g,ch:"n"}],function(){e=e?e.replace(this.re,this.ch):""});return e}var u=function(e){var t=function(t){return e[t]},i="(?:"+Object.keys(e).join("|")+")",n=RegExp(i),s=RegExp(i,"g");return function(e){e=null==e?"":""+e;return n.test(e)?e.replace(s,t):e}},m=u({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"}),f=u({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":"\"","&#x27;":"'","&#x60;":"`"}),g={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},v={ESCAPE:27,ENTER:13,SPACE:32,TAB:9,ARROW_UP:38,ARROW_DOWN:40},b={success:!1,major:"3"};try{b.full=(t.fn.dropdown.Constructor.VERSION||"").split(" ")[0].split(".");b.major=b.full[0];b.success=!0}catch(e){console.warn("There was an issue retrieving Bootstrap's version. Ensure Bootstrap is being loaded before bootstrap-select and there is no namespace collision. If loading Bootstrap asynchronously, the version may need to be manually specified via $.fn.selectpicker.Constructor.BootstrapVersion.",e)}var x={DISABLED:"disabled",DIVIDER:"divider",SHOW:"open",DROPUP:"dropup",MENU:"dropdown-menu",MENURIGHT:"dropdown-menu-right",MENULEFT:"dropdown-menu-left",BUTTONCLASS:"btn-default",POPOVERHEADER:"popover-title"},I={MENU:"."+x.MENU};if("4"===b.major){x.DIVIDER="dropdown-divider";x.SHOW="show";x.BUTTONCLASS="btn-light";x.POPOVERHEADER="popover-header"}var w=new RegExp(v.ARROW_UP+"|"+v.ARROW_DOWN),k=new RegExp("^"+v.TAB+"$|"+v.ESCAPE),$=new RegExp(v.ENTER+"|"+v.SPACE),E=function(e,i){var n=this;if(!d.useDefault){t.valHooks.select.set=d._set;d.useDefault=!0}this.$element=t(e);this.$newElement=null;this.$button=null;this.$menu=null;this.options=i;this.selectpicker={main:{map:{newIndex:{},originalIndex:{}}},current:{map:{}},search:{map:{}},view:{},keydown:{keyHistory:"",resetKeyHistory:{start:function start(){return setTimeout(function(){n.selectpicker.keydown.keyHistory=""},800)}}}};if(null===this.options.title){this.options.title=this.$element.attr("title")}var s=this.options.windowPadding;if("number"==typeof s){this.options.windowPadding=[s,s,s,s]}this.val=E.prototype.val;this.render=E.prototype.render;this.refresh=E.prototype.refresh;this.setStyle=E.prototype.setStyle;this.selectAll=E.prototype.selectAll;this.deselectAll=E.prototype.deselectAll;this.destroy=E.prototype.destroy;this.remove=E.prototype.remove;this.show=E.prototype.show;this.hide=E.prototype.hide;this.init()};E.VERSION="1.13.2";E.BootstrapVersion=b.major;E.DEFAULTS={noneSelectedText:"Nothing selected",noneResultsText:"No results matched {0}",countSelectedText:function countSelectedText(e){return 1==e?"{0} item selected":"{0} items selected"},maxOptionsText:function maxOptionsText(e,t){return[1==e?"Limit reached ({n} item max)":"Limit reached ({n} items max)",1==t?"Group limit reached ({n} item max)":"Group limit reached ({n} items max)"]},selectAllText:"Select All",deselectAllText:"Deselect All",doneButton:!1,doneButtonText:"Close",multipleSeparator:", ",styleBase:"btn",style:x.BUTTONCLASS,size:"auto",title:null,selectedTextFormat:"values",width:!1,container:!1,hideDisabled:!1,showSubtext:!1,showIcon:!0,showContent:!0,dropupAuto:!0,header:!1,liveSearch:!1,liveSearchPlaceholder:null,liveSearchNormalize:!1,liveSearchStyle:"contains",actionsBox:!1,iconBase:"glyphicon",tickIcon:"glyphicon-ok",showTick:!1,template:{caret:"<span class=\"caret\"></span>"},maxOptions:!1,mobile:!1,selectOnTab:!1,dropdownAlignRight:!1,windowPadding:0,virtualScroll:600,display:!1};if("4"===b.major){E.DEFAULTS.style="btn-light";E.DEFAULTS.iconBase="";E.DEFAULTS.tickIcon="bs-ok-default"}E.prototype={constructor:E,init:function init(){var t=this,i=this.$element.attr("id");this.$element.addClass("bs-select-hidden");this.multiple=this.$element.prop("multiple");this.autofocus=this.$element.prop("autofocus");this.$newElement=this.createDropdown();this.createLi();this.$element.after(this.$newElement).prependTo(this.$newElement);this.$button=this.$newElement.children("button");this.$menu=this.$newElement.children(I.MENU);this.$menuInner=this.$menu.children(".inner");this.$searchbox=this.$menu.find("input");this.$element.removeClass("bs-select-hidden");if(!0===this.options.dropdownAlignRight)this.$menu.addClass(x.MENURIGHT);if("undefined"!=typeof i){this.$button.attr("data-id",i)}this.checkDisabled();this.clickListener();if(this.options.liveSearch)this.liveSearchListener();this.render();this.setStyle();this.setWidth();if(this.options.container){this.selectPosition()}else{this.$element.on("hide.bs.select",function(){if(t.isVirtual()){var e=t.$menuInner[0],i=e.firstChild.cloneNode(!1);e.replaceChild(i,e.firstChild);e.scrollTop=0}})}this.$menu.data("this",this);this.$newElement.data("this",this);if(this.options.mobile)this.mobile();this.$newElement.on({"hide.bs.dropdown":function hideBsDropdown(i){t.$menuInner.attr("aria-expanded",!1);t.$element.trigger("hide.bs.select",i)},"hidden.bs.dropdown":function hiddenBsDropdown(i){t.$element.trigger("hidden.bs.select",i)},"show.bs.dropdown":function showBsDropdown(i){t.$menuInner.attr("aria-expanded",!0);t.$element.trigger("show.bs.select",i)},"shown.bs.dropdown":function shownBsDropdown(i){t.$element.trigger("shown.bs.select",i)}});if(t.$element[0].hasAttribute("required")){this.$element.on("invalid",function(){t.$button.addClass("bs-invalid");t.$element.on({"shown.bs.select":function shownBsSelect(){t.$element.val(t.$element.val()).off("shown.bs.select")},"rendered.bs.select":function renderedBsSelect(){if(this.validity.valid)t.$button.removeClass("bs-invalid");t.$element.off("rendered.bs.select")}});t.$button.on("blur.bs.select",function(){t.$element.focus().blur();t.$button.off("blur.bs.select")})})}setTimeout(function(){t.$element.trigger("loaded.bs.select")})},createDropdown:function createDropdown(){var e=this.multiple||this.options.showTick?" show-tick":"",i=this.autofocus?" autofocus":"",n=this.options.header?"<div class=\""+x.POPOVERHEADER+"\"><button type=\"button\" class=\"close\" aria-hidden=\"true\">&times;</button>"+this.options.header+"</div>":"",s=this.options.liveSearch?"<div class=\"bs-searchbox\"><input type=\"text\" class=\"form-control\" autocomplete=\"off\""+(null===this.options.liveSearchPlaceholder?"":" placeholder=\""+m(this.options.liveSearchPlaceholder)+"\"")+" role=\"textbox\" aria-label=\"Search\"></div>":"",o=this.multiple&&this.options.actionsBox?"<div class=\"bs-actionsbox\"><div class=\"btn-group btn-group-sm btn-block\"><button type=\"button\" class=\"actions-btn bs-select-all btn "+x.BUTTONCLASS+"\">"+this.options.selectAllText+"</button><button type=\"button\" class=\"actions-btn bs-deselect-all btn "+x.BUTTONCLASS+"\">"+this.options.deselectAllText+"</button></div></div>":"",l=this.multiple&&this.options.doneButton?"<div class=\"bs-donebutton\"><div class=\"btn-group btn-block\"><button type=\"button\" class=\"btn btn-sm "+x.BUTTONCLASS+"\">"+this.options.doneButtonText+"</button></div></div>":"",c="<div class=\"dropdown bootstrap-select"+e+"\"><button type=\"button\" class=\""+this.options.styleBase+" dropdown-toggle\" "+("static"===this.options.display?"data-display=\"static\"":"")+"data-toggle=\"dropdown\""+i+" role=\"button\"><div class=\"filter-option\"><div class=\"filter-option-inner\"><div class=\"filter-option-inner-inner\"></div></div> </div>"+("4"===b.major?"":"<span class=\"bs-caret\">"+this.options.template.caret+"</span>")+"</button><div class=\""+x.MENU+" "+("4"===b.major?"":x.SHOW)+"\" role=\"combobox\">"+n+s+o+"<div class=\"inner "+x.SHOW+"\" role=\"listbox\" aria-expanded=\"false\" tabindex=\"-1\"><ul class=\""+x.MENU+" inner "+("4"===b.major?x.SHOW:"")+"\"></ul></div>"+l+"</div></div>";return t(c)},setPositionData:function setPositionData(){this.selectpicker.view.canHighlight=[];for(var e=0;e<this.selectpicker.current.data.length;e++){var t=this.selectpicker.current.data[e],n=!0;if("divider"===t.type){n=!1;t.height=this.sizeInfo.dividerHeight}else if("optgroup-label"===t.type){n=!1;t.height=this.sizeInfo.dropdownHeaderHeight}else{t.height=this.sizeInfo.liHeight}if(t.disabled)n=!1;this.selectpicker.view.canHighlight.push(n);t.position=(0==e?0:this.selectpicker.current.data[e-1].position)+t.height}},isVirtual:function isVirtual(){return!1!==this.options.virtualScroll&&this.selectpicker.main.elements.length>=this.options.virtualScroll||!0===this.options.virtualScroll},createView:function createView(n,s){s=s||0;var l=this;this.selectpicker.current=n?this.selectpicker.search:this.selectpicker.main;var c=[],a,r;this.setPositionData();o(s,!0);this.$menuInner.off("scroll.createView").on("scroll.createView",function(t,e){if(!l.noScroll)o(this.scrollTop,e);l.noScroll=!1});function o(t,s){var o=l.selectpicker.current.elements.length,d=[],p,h,u,m,f,g,v,b,x=!0,I=l.isVirtual();l.selectpicker.view.scrollTop=t;if(!0===I){if(l.sizeInfo.hasScrollBar&&l.$menu[0].offsetWidth>l.sizeInfo.totalMenuWidth){l.sizeInfo.menuWidth=l.$menu[0].offsetWidth;l.sizeInfo.totalMenuWidth=l.sizeInfo.menuWidth+l.sizeInfo.scrollBarWidth;l.$menu.css("min-width",l.sizeInfo.menuWidth)}}p=Math.ceil(1.5*(l.sizeInfo.menuInnerHeight/l.sizeInfo.liHeight));h=Math.round(o/p)||1;for(var w=0,k;w<h;w++){k=(w+1)*p;if(w==h-1){k=o}d[w]=[w*p+(!w?0:1),k];if(!o)break;if(f===void 0&&t<=l.selectpicker.current.data[k-1].position-l.sizeInfo.menuInnerHeight){f=w}}if(f===void 0)f=0;g=[l.selectpicker.view.position0,l.selectpicker.view.position1];u=Math.max(0,f-1);m=Math.min(h-1,f+1);l.selectpicker.view.position0=Math.max(0,d[u][0])||0;l.selectpicker.view.position1=Math.min(o,d[m][1])||0;v=g[0]!==l.selectpicker.view.position0||g[1]!==l.selectpicker.view.position1;if(l.activeIndex!==void 0){r=l.selectpicker.current.elements[l.selectpicker.current.map.newIndex[l.prevActiveIndex]];c=l.selectpicker.current.elements[l.selectpicker.current.map.newIndex[l.activeIndex]];a=l.selectpicker.current.elements[l.selectpicker.current.map.newIndex[l.selectedIndex]];if(s){if(l.activeIndex!==l.selectedIndex){c.classList.remove("active");if(c.firstChild)c.firstChild.classList.remove("active")}l.activeIndex=void 0}if(l.activeIndex&&l.activeIndex!==l.selectedIndex&&a&&a.length){a.classList.remove("active");if(a.firstChild)a.firstChild.classList.remove("active")}}if(l.prevActiveIndex!==void 0&&l.prevActiveIndex!==l.activeIndex&&l.prevActiveIndex!==l.selectedIndex&&r&&r.length){r.classList.remove("active");if(r.firstChild)r.firstChild.classList.remove("active")}if(s||v){b=l.selectpicker.view.visibleElements?l.selectpicker.view.visibleElements.slice():[];l.selectpicker.view.visibleElements=l.selectpicker.current.elements.slice(l.selectpicker.view.position0,l.selectpicker.view.position1);l.setOptionStatus();if(n||!1===I&&s)x=!e(b,l.selectpicker.view.visibleElements);if((s||!0===I)&&x){var $=l.$menuInner[0],E=document.createDocumentFragment(),S=$.firstChild.cloneNode(!1),C,y,O=!0===I?l.selectpicker.view.visibleElements:l.selectpicker.current.elements;$.replaceChild(S,$.firstChild);for(var w=0,z=O.length;w<z;w++){E.appendChild(O[w])}if(!0===I){C=0===l.selectpicker.view.position0?0:l.selectpicker.current.data[l.selectpicker.view.position0-1].position,y=l.selectpicker.view.position1>o-1?0:l.selectpicker.current.data[o-1].position-l.selectpicker.current.data[l.selectpicker.view.position1-1].position;$.firstChild.style.marginTop=C+"px";$.firstChild.style.marginBottom=y+"px"}$.firstChild.appendChild(E)}}l.prevActiveIndex=l.activeIndex;if(!l.options.liveSearch){l.$menuInner.focus()}else if(n&&s){var T=0,D;if(!l.selectpicker.view.canHighlight[T]){T=1+l.selectpicker.view.canHighlight.slice(1).indexOf(!0)}D=l.selectpicker.view.visibleElements[T];if(l.selectpicker.view.currentActive){l.selectpicker.view.currentActive.classList.remove("active");if(l.selectpicker.view.currentActive.firstChild)l.selectpicker.view.currentActive.firstChild.classList.remove("active")}if(D){D.classList.add("active");if(D.firstChild)D.firstChild.classList.add("active")}l.activeIndex=l.selectpicker.current.map.originalIndex[T]}}t(window).off("resize.createView").on("resize.createView",function(){o(l.$menuInner[0].scrollTop)})},createLi:function createLi(){var e=this,i=[],n,s=0,o=0,l=[],c=0,a=0,r=-1;if(!this.selectpicker.view.titleOption)this.selectpicker.view.titleOption=document.createElement("option");var d={span:document.createElement("span"),subtext:document.createElement("small"),a:document.createElement("a"),li:document.createElement("li"),whitespace:document.createTextNode("\xA0")},p=d.span.cloneNode(!1),h=document.createDocumentFragment();p.className=e.options.iconBase+" "+e.options.tickIcon+" check-mark";d.a.appendChild(p);d.a.setAttribute("role","option");d.subtext.className="text-muted";d.text=d.span.cloneNode(!1);d.text.className="text";var u=function(e,t,i,n){var s=d.li.cloneNode(!1);if(e){if(1===e.nodeType||11===e.nodeType){s.appendChild(e)}else{s.innerHTML=e}}if("undefined"!=typeof i&&""!==i)s.className=i;if("undefined"!=typeof n&&null!==n)s.classList.add("optgroup-"+n);return s},f=function(e,t,i){var n=d.a.cloneNode(!0);if(e){if(11===e.nodeType){n.appendChild(e)}else{n.insertAdjacentHTML("beforeend",e)}}if("undefined"!=typeof t&""!==t)n.className=t;if("4"===b.major)n.classList.add("dropdown-item");if(i)n.setAttribute("style",i);return n},g=function(t){var i=d.text.cloneNode(!1),n,s;if(t.optionContent){i.innerHTML=t.optionContent}else{i.textContent=t.text;if(t.optionIcon){var o=d.whitespace.cloneNode(!1);s=d.span.cloneNode(!1);s.className=e.options.iconBase+" "+t.optionIcon;h.appendChild(s);h.appendChild(o)}if(t.optionSubtext){n=d.subtext.cloneNode(!1);n.innerHTML=t.optionSubtext;i.appendChild(n)}}h.appendChild(i);return h},v=function(t){var i=d.text.cloneNode(!1),n,s;i.innerHTML=t.labelEscaped;if(t.labelIcon){var o=d.whitespace.cloneNode(!1);s=d.span.cloneNode(!1);s.className=e.options.iconBase+" "+t.labelIcon;h.appendChild(s);h.appendChild(o)}if(t.labelSubtext){n=d.subtext.cloneNode(!1);n.textContent=t.labelSubtext;i.appendChild(n)}h.appendChild(i);return h};if(this.options.title&&!this.multiple){r--;var I=this.$element[0],w=!1,k=!this.selectpicker.view.titleOption.parentNode;if(k){this.selectpicker.view.titleOption.className="bs-title-option";this.selectpicker.view.titleOption.value="";var $=t(I.options[I.selectedIndex]);w=$.attr("selected")===void 0&&this.$element.data("selected")===void 0}if(k||0!==this.selectpicker.view.titleOption.index){I.insertBefore(this.selectpicker.view.titleOption,I.firstChild)}if(w)I.selectedIndex=0}var E=this.$element.find("option");E.each(function(d){var p=t(this);r++;if(p.hasClass("bs-title-option"))return;var h=p.data(),b=this.className||"",I=m(this.style.cssText),w=h.content,k=this.textContent,$=h.tokens,S=h.subtext,C=h.icon,y=p.parent(),O=y[0],z="OPTGROUP"===O.tagName,T=z&&O.disabled,D=this.disabled||T,A,H=this.previousElementSibling&&"OPTGROUP"===this.previousElementSibling.tagName,N,L=y.data();if(!0===h.hidden||e.options.hideDisabled&&(D&&!z||T)){A=h.prevHiddenIndex;p.next().data("prevHiddenIndex",A!==void 0?A:d);r--;if(!H){if(A!==void 0){var P=E[A].previousElementSibling;if(P&&"OPTGROUP"===P.tagName&&!P.disabled){H=!0}}}if(H&&"divider"!==l[l.length-1].type){r++;i.push(u(!1,null,x.DIVIDER,c+"div"));l.push({type:"divider",optID:c})}return}if(z&&!0!==h.divider){if(e.options.hideDisabled&&D){if(L.allOptionsDisabled===void 0){var R=y.children();y.data("allOptionsDisabled",R.filter(":disabled").length===R.length)}if(y.data("allOptionsDisabled")){r--;return}}var W=" "+O.className||"";if(!this.previousElementSibling){c+=1;var B=O.label,U=m(B),M=L.subtext,V=L.icon;if(0!==d&&0<i.length){r++;i.push(u(!1,null,x.DIVIDER,c+"div"));l.push({type:"divider",optID:c})}r++;var j=v({labelEscaped:U,labelSubtext:M,labelIcon:V});i.push(u(j,null,"dropdown-header"+W,c));l.push({content:U,subtext:M,type:"optgroup-label",optID:c});a=r-1}if(e.options.hideDisabled&&D||!0===h.hidden){r--;return}N=g({text:k,optionContent:w,optionSubtext:S,optionIcon:C});i.push(u(f(N,"opt "+b+W,I),d,"",c));l.push({content:w||k,subtext:S,tokens:$,type:"option",optID:c,headerIndex:a,lastIndex:a+O.childElementCount,originalIndex:d,data:h});s++}else if(!0===h.divider){i.push(u(!1,d,x.DIVIDER));l.push({type:"divider",originalIndex:d,data:h})}else{if(!H&&e.options.hideDisabled){A=h.prevHiddenIndex;if(A!==void 0){var P=E[A].previousElementSibling;if(P&&"OPTGROUP"===P.tagName&&!P.disabled){H=!0}}}if(H&&"divider"!==l[l.length-1].type){r++;i.push(u(!1,null,x.DIVIDER,c+"div"));l.push({type:"divider",optID:c})}N=g({text:k,optionContent:w,optionSubtext:S,optionIcon:C});i.push(u(f(N,b,I),d));l.push({content:w||k,subtext:S,tokens:$,type:"option",originalIndex:d,data:h});s++}e.selectpicker.main.map.newIndex[d]=r;e.selectpicker.main.map.originalIndex[r]=d;var _=l[l.length-1];_.disabled=D;var F=0;if(_.content)F+=_.content.length;if(_.subtext)F+=_.subtext.length;if(C)F+=1;if(F>o){o=F;n=i[i.length-1]}});this.selectpicker.main.elements=i;this.selectpicker.main.data=l;this.selectpicker.current=this.selectpicker.main;this.selectpicker.view.widestOption=n;this.selectpicker.view.availableOptionsCount=s},findLis:function findLis(){return this.$menuInner.find(".inner > li")},render:function render(){var e=this,t=this.$element.find("option"),n=[],s=[];this.togglePlaceholder();this.tabIndex();for(var o=0,l=this.selectpicker.main.elements.length;o<l;o++){var c=this.selectpicker.main.map.originalIndex[o],a=t[c];if(a&&a.selected){n.push(a);if(100>s.length&&"count"!==e.options.selectedTextFormat||1===n.length){if(e.options.hideDisabled&&(a.disabled||"OPTGROUP"===a.parentNode.tagName&&a.parentNode.disabled))return;var r=this.selectpicker.main.data[o].data,d=r.icon&&e.options.showIcon?"<i class=\""+e.options.iconBase+" "+r.icon+"\"></i> ":"",p,h;if(e.options.showSubtext&&r.subtext&&!e.multiple){p=" <small class=\"text-muted\">"+r.subtext+"</small>"}else{p=""}if(a.title){h=a.title}else if(r.content&&e.options.showContent){h=r.content.toString()}else{h=d+a.innerHTML.trim()+p}s.push(h)}}}var u=!this.multiple?s[0]:s.join(this.options.multipleSeparator);if(50<n.length)u+="...";if(this.multiple&&-1!==this.options.selectedTextFormat.indexOf("count")){var m=this.options.selectedTextFormat.split(">");if(1<m.length&&n.length>m[1]||1===m.length&&2<=n.length){var g=this.selectpicker.view.availableOptionsCount,v="function"==typeof this.options.countSelectedText?this.options.countSelectedText(n.length,g):this.options.countSelectedText;u=v.replace("{0}",n.length.toString()).replace("{1}",g.toString())}}if(this.options.title==void 0){this.options.title=this.$element.attr("title")}if("static"==this.options.selectedTextFormat){u=this.options.title}if(!u){u="undefined"!=typeof this.options.title?this.options.title:this.options.noneSelectedText}this.$button[0].title=f(u.replace(/<[^>]*>?/g,"").trim());this.$button.find(".filter-option-inner-inner")[0].innerHTML=u;this.$element.trigger("rendered.bs.select")},setStyle:function setStyle(e,t){if(this.$element.attr("class")){this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device|bs-select-hidden|validate\[.*\]/gi,""))}var i=e?e:this.options.style;if("add"==t){this.$button.addClass(i)}else if("remove"==t){this.$button.removeClass(i)}else{this.$button.removeClass(this.options.style);this.$button.addClass(i)}},liHeight:function(e){if(!e&&(!1===this.options.size||this.sizeInfo))return;if(!this.sizeInfo)this.sizeInfo={};var i=document.createElement("div"),n=document.createElement("div"),s=document.createElement("div"),l=document.createElement("ul"),c=document.createElement("li"),r=document.createElement("li"),d=document.createElement("li"),p=document.createElement("a"),a=document.createElement("span"),h=this.options.header&&0<this.$menu.find("."+x.POPOVERHEADER).length?this.$menu.find("."+x.POPOVERHEADER)[0].cloneNode(!0):null,u=this.options.liveSearch?document.createElement("div"):null,m=this.options.actionsBox&&this.multiple&&0<this.$menu.find(".bs-actionsbox").length?this.$menu.find(".bs-actionsbox")[0].cloneNode(!0):null,f=this.options.doneButton&&this.multiple&&0<this.$menu.find(".bs-donebutton").length?this.$menu.find(".bs-donebutton")[0].cloneNode(!0):null;this.sizeInfo.selectWidth=this.$newElement[0].offsetWidth;a.className="text";p.className="dropdown-item "+this.$element.find("option")[0].className;i.className=this.$menu[0].parentNode.className+" "+x.SHOW;i.style.width=this.sizeInfo.selectWidth+"px";if("auto"===this.options.width)n.style.minWidth=0;n.className=x.MENU+" "+x.SHOW;s.className="inner "+x.SHOW;l.className=x.MENU+" inner "+("4"===b.major?x.SHOW:"");c.className=x.DIVIDER;r.className="dropdown-header";a.appendChild(document.createTextNode("Inner text"));p.appendChild(a);d.appendChild(p);r.appendChild(a.cloneNode(!0));if(this.selectpicker.view.widestOption){l.appendChild(this.selectpicker.view.widestOption.cloneNode(!0))}l.appendChild(d);l.appendChild(c);l.appendChild(r);if(h)n.appendChild(h);if(u){var g=document.createElement("input");u.className="bs-searchbox";g.className="form-control";u.appendChild(g);n.appendChild(u)}if(m)n.appendChild(m);s.appendChild(l);n.appendChild(s);if(f)n.appendChild(f);i.appendChild(n);document.body.appendChild(i);var v=p.offsetHeight,I=r?r.offsetHeight:0,w=h?h.offsetHeight:0,k=u?u.offsetHeight:0,$=m?m.offsetHeight:0,E=f?f.offsetHeight:0,S=t(c).outerHeight(!0),C=window.getComputedStyle?window.getComputedStyle(n):!1,y=n.offsetWidth,O=C?null:t(n),z={vert:o(C?C.paddingTop:O.css("paddingTop"))+o(C?C.paddingBottom:O.css("paddingBottom"))+o(C?C.borderTopWidth:O.css("borderTopWidth"))+o(C?C.borderBottomWidth:O.css("borderBottomWidth")),horiz:o(C?C.paddingLeft:O.css("paddingLeft"))+o(C?C.paddingRight:O.css("paddingRight"))+o(C?C.borderLeftWidth:O.css("borderLeftWidth"))+o(C?C.borderRightWidth:O.css("borderRightWidth"))},T={vert:z.vert+o(C?C.marginTop:O.css("marginTop"))+o(C?C.marginBottom:O.css("marginBottom"))+2,horiz:z.horiz+o(C?C.marginLeft:O.css("marginLeft"))+o(C?C.marginRight:O.css("marginRight"))+2},D;s.style.overflowY="scroll";D=n.offsetWidth-y;document.body.removeChild(i);this.sizeInfo.liHeight=v;this.sizeInfo.dropdownHeaderHeight=I;this.sizeInfo.headerHeight=w;this.sizeInfo.searchHeight=k;this.sizeInfo.actionsHeight=$;this.sizeInfo.doneButtonHeight=E;this.sizeInfo.dividerHeight=S;this.sizeInfo.menuPadding=z;this.sizeInfo.menuExtras=T;this.sizeInfo.menuWidth=y;this.sizeInfo.totalMenuWidth=this.sizeInfo.menuWidth;this.sizeInfo.scrollBarWidth=D;this.sizeInfo.selectHeight=this.$newElement[0].offsetHeight;this.setPositionData()},getSelectPosition:function getSelectPosition(){var e=this,i=t(window),n=e.$newElement.offset(),s=t(e.options.container),o;if(e.options.container&&!s.is("body")){o=s.offset();o.top+=parseInt(s.css("borderTopWidth"));o.left+=parseInt(s.css("borderLeftWidth"))}else{o={top:0,left:0}}var l=e.options.windowPadding;this.sizeInfo.selectOffsetTop=n.top-o.top-i.scrollTop();this.sizeInfo.selectOffsetBot=i.height()-this.sizeInfo.selectOffsetTop-this.sizeInfo.selectHeight-o.top-l[2];this.sizeInfo.selectOffsetLeft=n.left-o.left-i.scrollLeft();this.sizeInfo.selectOffsetRight=i.width()-this.sizeInfo.selectOffsetLeft-this.sizeInfo.selectWidth-o.left-l[1];this.sizeInfo.selectOffsetTop-=l[0];this.sizeInfo.selectOffsetLeft-=l[3]},setMenuSize:function setMenuSize(){this.getSelectPosition();var e=this.sizeInfo.selectWidth,t=this.sizeInfo.liHeight,n=this.sizeInfo.headerHeight,s=this.sizeInfo.searchHeight,o=this.sizeInfo.actionsHeight,l=this.sizeInfo.doneButtonHeight,c=this.sizeInfo.dividerHeight,a=this.sizeInfo.menuPadding,r,d,p=0,h,u,m,f,g;if(this.options.dropupAuto){g=t*this.selectpicker.current.elements.length+a.vert;this.$newElement.toggleClass(x.DROPUP,this.sizeInfo.selectOffsetTop-this.sizeInfo.selectOffsetBot>this.sizeInfo.menuExtras.vert&&g+this.sizeInfo.menuExtras.vert+50>this.sizeInfo.selectOffsetBot)}if("auto"===this.options.size){u=3<this.selectpicker.current.elements.length?3*this.sizeInfo.liHeight+this.sizeInfo.menuExtras.vert-2:0;d=this.sizeInfo.selectOffsetBot-this.sizeInfo.menuExtras.vert;h=u+n+s+o+l;f=Math.max(u-a.vert,0);if(this.$newElement.hasClass(x.DROPUP)){d=this.sizeInfo.selectOffsetTop-this.sizeInfo.menuExtras.vert}m=d;r=d-n-s-o-l-a.vert}else if(this.options.size&&"auto"!=this.options.size&&this.selectpicker.current.elements.length>this.options.size){for(var v=0;v<this.options.size;v++){if("divider"===this.selectpicker.current.data[v].type)p++}d=t*this.options.size+p*c+a.vert;r=d-a.vert;m=d+n+s+o+l;h=f=""}if("auto"===this.options.dropdownAlignRight){this.$menu.toggleClass(x.MENURIGHT,this.sizeInfo.selectOffsetLeft>this.sizeInfo.selectOffsetRight&&this.sizeInfo.selectOffsetRight<this.$menu[0].offsetWidth-e)}this.$menu.css({"max-height":m+"px",overflow:"hidden","min-height":h+"px"});this.$menuInner.css({"max-height":r+"px","overflow-y":"auto","min-height":f+"px"});this.sizeInfo.menuInnerHeight=r;if(this.selectpicker.current.data.length&&this.selectpicker.current.data[this.selectpicker.current.data.length-1].position>this.sizeInfo.menuInnerHeight){this.sizeInfo.hasScrollBar=!0;this.sizeInfo.totalMenuWidth=this.sizeInfo.menuWidth+this.sizeInfo.scrollBarWidth;this.$menu.css("min-width",this.sizeInfo.totalMenuWidth)}if(this.dropdown&&this.dropdown._popper)this.dropdown._popper.update()},setSize:function setSize(e){this.liHeight(e);if(this.options.header)this.$menu.css("padding-top",0);if(!1===this.options.size)return;var i=this,n=t(window),s,o=0;this.setMenuSize();if("auto"===this.options.size){this.$searchbox.off("input.setMenuSize propertychange.setMenuSize").on("input.setMenuSize propertychange.setMenuSize",function(){return i.setMenuSize()});n.off("resize.setMenuSize scroll.setMenuSize").on("resize.setMenuSize scroll.setMenuSize",function(){return i.setMenuSize()})}else if(this.options.size&&"auto"!=this.options.size&&this.selectpicker.current.elements.length>this.options.size){this.$searchbox.off("input.setMenuSize propertychange.setMenuSize");n.off("resize.setMenuSize scroll.setMenuSize")}if(e){o=this.$menuInner[0].scrollTop}else if(!i.multiple){s=i.selectpicker.main.map.newIndex[i.$element[0].selectedIndex];if("number"==typeof s&&!1!==i.options.size){o=i.sizeInfo.liHeight*s;o=o-i.sizeInfo.menuInnerHeight/2+i.sizeInfo.liHeight/2}}i.createView(!1,o)},setWidth:function setWidth(){var e=this;if("auto"===this.options.width){requestAnimationFrame(function(){e.$menu.css("min-width","0");e.liHeight();e.setMenuSize();var t=e.$newElement.clone().appendTo("body"),i=t.css("width","auto").children("button").outerWidth();t.remove();e.sizeInfo.selectWidth=Math.max(e.sizeInfo.totalMenuWidth,i);e.$newElement.css("width",e.sizeInfo.selectWidth+"px")})}else if("fit"===this.options.width){this.$menu.css("min-width","");this.$newElement.css("width","").addClass("fit-width")}else if(this.options.width){this.$menu.css("min-width","");this.$newElement.css("width",this.options.width)}else{this.$menu.css("min-width","");this.$newElement.css("width","")}if(this.$newElement.hasClass("fit-width")&&"fit"!==this.options.width){this.$newElement.removeClass("fit-width")}},selectPosition:function selectPosition(){this.$bsContainer=t("<div class=\"bs-container\" />");var e=this,i=t(this.options.container),n,s,o,l=function(l){var c={},a=e.options.display||t.fn.dropdown.Constructor.Default.display;e.$bsContainer.addClass(l.attr("class").replace(/form-control|fit-width/gi,"")).toggleClass(x.DROPUP,l.hasClass(x.DROPUP));n=l.offset();if(!i.is("body")){s=i.offset();s.top+=parseInt(i.css("borderTopWidth"))-i.scrollTop();s.left+=parseInt(i.css("borderLeftWidth"))-i.scrollLeft()}else{s={top:0,left:0}}o=l.hasClass(x.DROPUP)?0:l[0].offsetHeight;if(4>b.major||"static"===a){c.top=n.top-s.top+o;c.left=n.left-s.left}c.width=l[0].offsetWidth;e.$bsContainer.css(c)};this.$button.on("click.bs.dropdown.data-api",function(){if(e.isDisabled()){return}l(e.$newElement);e.$bsContainer.appendTo(e.options.container).toggleClass(x.SHOW,!e.$button.hasClass(x.SHOW)).append(e.$menu)});t(window).on("resize scroll",function(){l(e.$newElement)});this.$element.on("hide.bs.select",function(){e.$menu.data("height",e.$menu.height());e.$bsContainer.detach()})},setOptionStatus:function setOptionStatus(){var e=this,t=this.$element.find("option");e.noScroll=!1;if(e.selectpicker.view.visibleElements&&e.selectpicker.view.visibleElements.length){for(var n=0;n<e.selectpicker.view.visibleElements.length;n++){var s=e.selectpicker.current.map.originalIndex[n+e.selectpicker.view.position0],o=t[s];if(o){var l=this.selectpicker.main.map.newIndex[s],c=this.selectpicker.main.elements[l];e.setDisabled(s,o.disabled||"OPTGROUP"===o.parentNode.tagName&&o.parentNode.disabled,l,c);e.setSelected(s,o.selected,l,c)}}}},setSelected:function setSelected(e,t,i,n){var s=this.activeIndex!==void 0,o=this.activeIndex===e,l,c,r,d=o||t&&!this.multiple&&!s;if(!i)i=this.selectpicker.main.map.newIndex[e];if(!n)n=this.selectpicker.main.elements[i];r=n.firstChild;if(t){this.selectedIndex=e}n.classList.toggle("selected",t);n.classList.toggle("active",d);if(d){this.selectpicker.view.currentActive=n;this.activeIndex=e}if(r){r.classList.toggle("selected",t);r.classList.toggle("active",d);r.setAttribute("aria-selected",t)}if(!d){if(!s&&t&&this.prevActiveIndex!==void 0){l=this.selectpicker.main.map.newIndex[this.prevActiveIndex];c=this.selectpicker.main.elements[l];c.classList.toggle("selected",t);c.classList.remove("active");if(c.firstChild){c.firstChild.classList.toggle("selected",t);c.firstChild.classList.remove("active")}}}},setDisabled:function setDisabled(e,t,i,n){var s;if(!i)i=this.selectpicker.main.map.newIndex[e];if(!n)n=this.selectpicker.main.elements[i];s=n.firstChild;n.classList.toggle(x.DISABLED,t);if(s){if("4"===b.major)s.classList.toggle(x.DISABLED,t);s.setAttribute("aria-disabled",t);if(t){s.setAttribute("tabindex",-1)}else{s.setAttribute("tabindex",0)}}},isDisabled:function isDisabled(){return this.$element[0].disabled},checkDisabled:function checkDisabled(){var e=this;if(this.isDisabled()){this.$newElement.addClass(x.DISABLED);this.$button.addClass(x.DISABLED).attr("tabindex",-1).attr("aria-disabled",!0)}else{if(this.$button.hasClass(x.DISABLED)){this.$newElement.removeClass(x.DISABLED);this.$button.removeClass(x.DISABLED).attr("aria-disabled",!1)}if(-1==this.$button.attr("tabindex")&&!this.$element.data("tabindex")){this.$button.removeAttr("tabindex")}}this.$button.click(function(){return!e.isDisabled()})},togglePlaceholder:function togglePlaceholder(){var e=this.$element[0],t=e.selectedIndex,i=-1===t;if(!i&&!e.options[t].value)i=!0;this.$button.toggleClass("bs-placeholder",i)},tabIndex:function tabIndex(){if(this.$element.data("tabindex")!==this.$element.attr("tabindex")&&-98!==this.$element.attr("tabindex")&&"-98"!==this.$element.attr("tabindex")){this.$element.data("tabindex",this.$element.attr("tabindex"));this.$button.attr("tabindex",this.$element.data("tabindex"))}this.$element.attr("tabindex",-98)},clickListener:function clickListener(){var s=this,o=t(document);o.data("spaceSelect",!1);this.$button.on("keyup",function(t){if(/(32)/.test(t.keyCode.toString(10))&&o.data("spaceSelect")){t.preventDefault();o.data("spaceSelect",!1)}});this.$newElement.on("show.bs.dropdown",function(){if(3<b.major&&!s.dropdown){s.dropdown=s.$button.data("bs.dropdown");s.dropdown._menu=s.$menu[0]}});this.$button.on("click.bs.dropdown.data-api",function(){if(!s.$newElement.hasClass(x.SHOW)){s.setSize()}});function e(){if(s.options.liveSearch){s.$searchbox.focus()}else{s.$menuInner.focus()}}function i(){if(s.dropdown&&s.dropdown._popper&&s.dropdown._popper.state.isCreated){e()}else{requestAnimationFrame(i)}}this.$element.on("shown.bs.select",function(){if(s.$menuInner[0].scrollTop!==s.selectpicker.view.scrollTop){s.$menuInner[0].scrollTop=s.selectpicker.view.scrollTop}if(3<b.major){requestAnimationFrame(i)}else{e()}});this.$menuInner.on("click","li a",function(o,e){var l=t(this),c=s.isVirtual()?s.selectpicker.view.position0:0,a=s.selectpicker.current.map.originalIndex[l.parent().index()+c],r=n(s.$element[0]),d=s.$element.prop("selectedIndex"),h=!0;if(s.multiple&&1!==s.options.maxOptions){o.stopPropagation()}o.preventDefault();if(!s.isDisabled()&&!l.parent().hasClass(x.DISABLED)){var u=s.$element.find("option"),m=u.eq(a),f=m.prop("selected"),g=m.parent("optgroup"),v=g.find("option"),b=s.options.maxOptions,I=g.data("maxOptions")||!1;if(a===s.activeIndex)e=!0;if(!e){s.prevActiveIndex=s.activeIndex;s.activeIndex=void 0}if(!s.multiple){u.prop("selected",!1);m.prop("selected",!0);s.setSelected(a,!0)}else{m.prop("selected",!f);s.setSelected(a,!f);l.blur();if(!1!==b||!1!==I){var w=b<u.filter(":selected").length,k=I<g.find("option:selected").length;if(b&&w||I&&k){if(b&&1==b){u.prop("selected",!1);m.prop("selected",!0);for(var $=0;$<u.length;$++){s.setSelected($,!1)}s.setSelected(a,!0)}else if(I&&1==I){g.find("option:selected").prop("selected",!1);m.prop("selected",!0);for(var $=0,E;$<v.length;$++){E=v[$];s.setSelected(u.index(E),!1)}s.setSelected(a,!0)}else{var S="string"==typeof s.options.maxOptionsText?[s.options.maxOptionsText,s.options.maxOptionsText]:s.options.maxOptionsText,C="function"==typeof S?S(b,I):S,y=C[0].replace("{n}",b),O=C[1].replace("{n}",I),z=t("<div class=\"notify\"></div>");if(C[2]){y=y.replace("{var}",C[2][1<b?0:1]);O=O.replace("{var}",C[2][1<I?0:1])}m.prop("selected",!1);s.$menu.append(z);if(b&&w){z.append(t("<div>"+y+"</div>"));h=!1;s.$element.trigger("maxReached.bs.select")}if(I&&k){z.append(t("<div>"+O+"</div>"));h=!1;s.$element.trigger("maxReachedGrp.bs.select")}setTimeout(function(){s.setSelected(a,!1)},10);z.delay(750).fadeOut(300,function(){t(this).remove()})}}}}if(!s.multiple||s.multiple&&1===s.options.maxOptions){s.$button.focus()}else if(s.options.liveSearch){s.$searchbox.focus()}if(h){if(r!=n(s.$element[0])&&s.multiple||d!=s.$element.prop("selectedIndex")&&!s.multiple){p=[a,m.prop("selected"),r];s.$element.triggerNative("change")}}}});this.$menu.on("click","li."+x.DISABLED+" a, ."+x.POPOVERHEADER+", ."+x.POPOVERHEADER+" :not(.close)",function(i){if(i.currentTarget==this){i.preventDefault();i.stopPropagation();if(s.options.liveSearch&&!t(i.target).hasClass("close")){s.$searchbox.focus()}else{s.$button.focus()}}});this.$menuInner.on("click",".divider, .dropdown-header",function(t){t.preventDefault();t.stopPropagation();if(s.options.liveSearch){s.$searchbox.focus()}else{s.$button.focus()}});this.$menu.on("click","."+x.POPOVERHEADER+" .close",function(){s.$button.click()});this.$searchbox.on("click",function(t){t.stopPropagation()});this.$menu.on("click",".actions-btn",function(i){if(s.options.liveSearch){s.$searchbox.focus()}else{s.$button.focus()}i.preventDefault();i.stopPropagation();if(t(this).hasClass("bs-select-all")){s.selectAll()}else{s.deselectAll()}});this.$element.on({change:function change(){s.render();s.$element.trigger("changed.bs.select",p);p=null},focus:function focus(){s.$button.focus()}})},liveSearchListener:function liveSearchListener(){var e=this,t=document.createElement("li");this.$button.on("click.bs.dropdown.data-api",function(){if(!!e.$searchbox.val()){e.$searchbox.val("")}});this.$searchbox.on("click.bs.dropdown.data-api focus.bs.dropdown.data-api touchend.bs.dropdown.data-api",function(t){t.stopPropagation()});this.$searchbox.on("input propertychange",function(){var n=e.$searchbox.val();e.selectpicker.search.map.newIndex={};e.selectpicker.search.map.originalIndex={};e.selectpicker.search.elements=[];e.selectpicker.search.data=[];if(n){var o,l=[],c=n.toUpperCase(),a={},r=[],d=e._searchStyle(),p=e.options.liveSearchNormalize;e._$lisSelected=e.$menuInner.find(".selected");for(var o=0,h;o<e.selectpicker.main.data.length;o++){h=e.selectpicker.main.data[o];if(!a[o]){a[o]=s(h,c,d,p)}if(a[o]&&h.headerIndex!==void 0&&-1===r.indexOf(h.headerIndex)){if(0<h.headerIndex){a[h.headerIndex-1]=!0;r.push(h.headerIndex-1)}a[h.headerIndex]=!0;r.push(h.headerIndex);a[h.lastIndex+1]=!0}if(a[o]&&"optgroup-label"!==h.type)r.push(o)}for(var o=0,u=r.length;o<u;o++){var f=r[o],g=r[o-1],h=e.selectpicker.main.data[f],v=e.selectpicker.main.data[g];if("divider"!==h.type||"divider"===h.type&&v&&"divider"!==v.type&&u-1!==o){e.selectpicker.search.data.push(h);l.push(e.selectpicker.main.elements[f]);if(h.hasOwnProperty("originalIndex")){e.selectpicker.search.map.newIndex[h.originalIndex]=l.length-1;e.selectpicker.search.map.originalIndex[l.length-1]=h.originalIndex}}}e.activeIndex=void 0;e.noScroll=!0;e.$menuInner.scrollTop(0);e.selectpicker.search.elements=l;e.createView(!0);if(!l.length){t.className="no-results";t.innerHTML=e.options.noneResultsText.replace("{0}","\""+m(n)+"\"");e.$menuInner[0].firstChild.appendChild(t)}}else{e.$menuInner.scrollTop(0);e.createView(!1)}})},_searchStyle:function _searchStyle(){return this.options.liveSearchStyle||"contains"},val:function val(e){if("undefined"!=typeof e){this.$element.val(e).triggerNative("change");return this.$element}else{return this.$element.val()}},changeAll:function changeAll(e){if(!this.multiple)return;if("undefined"==typeof e)e=!0;var t=this.$element.find("option"),s=0,o=0,l=n(this.$element[0]);this.$element.addClass("bs-select-hidden");for(var c=0;c<this.selectpicker.current.elements.length;c++){var a=this.selectpicker.current.data[c],r=this.selectpicker.current.map.originalIndex[c],d=t[r];if(d&&!d.disabled&&"divider"!==a.type){if(d.selected)s++;d.selected=e;if(d.selected)o++}}this.$element.removeClass("bs-select-hidden");if(s==o)return;this.setOptionStatus();this.togglePlaceholder();p=[null,null,l];this.$element.triggerNative("change")},selectAll:function selectAll(){return this.changeAll(!0)},deselectAll:function deselectAll(){return this.changeAll(!1)},toggle:function toggle(t){t=t||window.event;if(t)t.stopPropagation();this.$button.trigger("click.bs.dropdown.data-api")},keydown:function keydown(n){var e=t(this),o=e.hasClass("dropdown-toggle"),l=o?e.closest(".dropdown"):e.closest(I.MENU),c=l.data("this"),a=c.findLis(),r,d,p,h,u,m=!1,f=n.which===v.TAB&&!o&&!c.options.selectOnTab,b=w.test(n.which)||f,$=c.$menuInner[0].scrollTop,E=c.isVirtual(),S=!0===E?c.selectpicker.view.position0:0;d=c.$newElement.hasClass(x.SHOW);if(!d&&(b||48<=n.which&&57>=n.which||96<=n.which&&105>=n.which||65<=n.which&&90>=n.which)){c.$button.trigger("click.bs.dropdown.data-api")}if(n.which===v.ESCAPE&&d){n.preventDefault();c.$button.trigger("click.bs.dropdown.data-api").focus()}if(b){if(!a.length)return;r=!0===E?a.index(a.filter(".active")):c.selectpicker.current.map.newIndex[c.activeIndex];if(r===void 0)r=-1;if(-1!==r){p=c.selectpicker.current.elements[r+S];p.classList.remove("active");if(p.firstChild)p.firstChild.classList.remove("active")}if(n.which===v.ARROW_UP){if(-1!==r)r--;if(0>r+S)r+=a.length;if(!c.selectpicker.view.canHighlight[r+S]){r=c.selectpicker.view.canHighlight.slice(0,r+S).lastIndexOf(!0)-S;if(-1===r)r=a.length-1}}else if(n.which===v.ARROW_DOWN||f){r++;if(r+S>=c.selectpicker.view.canHighlight.length)r=0;if(!c.selectpicker.view.canHighlight[r+S]){r=r+1+c.selectpicker.view.canHighlight.slice(r+S+1).indexOf(!0)}}n.preventDefault();var C=S+r;if(n.which===v.ARROW_UP){if(0===S&&r===a.length-1){c.$menuInner[0].scrollTop=c.$menuInner[0].scrollHeight;C=c.selectpicker.current.elements.length-1}else{h=c.selectpicker.current.data[C];u=h.position-h.height;m=u<$}}else if(n.which===v.ARROW_DOWN||f){if(0===r){c.$menuInner[0].scrollTop=0;C=0}else{h=c.selectpicker.current.data[C];u=h.position-c.sizeInfo.menuInnerHeight;m=u>$}}p=c.selectpicker.current.elements[C];if(p){p.classList.add("active");if(p.firstChild)p.firstChild.classList.add("active")}c.activeIndex=c.selectpicker.current.map.originalIndex[C];c.selectpicker.view.currentActive=p;if(m)c.$menuInner[0].scrollTop=u;if(c.options.liveSearch){c.$searchbox.focus()}else{e.focus()}}else if(!e.is("input")&&!k.test(n.which)||n.which===v.SPACE&&c.selectpicker.keydown.keyHistory){var y,O=[],z;n.preventDefault();c.selectpicker.keydown.keyHistory+=g[n.which];if(c.selectpicker.keydown.resetKeyHistory.cancel)clearTimeout(c.selectpicker.keydown.resetKeyHistory.cancel);c.selectpicker.keydown.resetKeyHistory.cancel=c.selectpicker.keydown.resetKeyHistory.start();z=c.selectpicker.keydown.keyHistory;if(/^(.)\1+$/.test(z)){z=z.charAt(0)}for(var T=0;T<c.selectpicker.current.data.length;T++){var D=c.selectpicker.current.data[T],A;A=s(D,z,"startsWith",!0);if(A&&c.selectpicker.view.canHighlight[T]){D.index=T;O.push(D.originalIndex)}}if(O.length){var H=0;a.removeClass("active").find("a").removeClass("active");if(1===z.length){H=O.indexOf(c.activeIndex);if(-1===H||H===O.length-1){H=0}else{H++}}y=c.selectpicker.current.map.newIndex[O[H]];h=c.selectpicker.current.data[y];if(0<$-h.position){u=h.position-h.height;m=!0}else{u=h.position-c.sizeInfo.menuInnerHeight;m=h.position>$+c.sizeInfo.menuInnerHeight}p=c.selectpicker.current.elements[y];p.classList.add("active");if(p.firstChild)p.firstChild.classList.add("active");c.activeIndex=O[H];p.firstChild.focus();if(m)c.$menuInner[0].scrollTop=u;e.focus()}}if(d&&(n.which===v.SPACE&&!c.selectpicker.keydown.keyHistory||n.which===v.ENTER||n.which===v.TAB&&c.options.selectOnTab)){if(n.which!==v.SPACE)n.preventDefault();if(!c.options.liveSearch||n.which!==v.SPACE){c.$menuInner.find(".active a").trigger("click",!0);e.focus();if(!c.options.liveSearch){n.preventDefault();t(document).data("spaceSelect",!0)}}}},mobile:function mobile(){this.$element.addClass("mobile-device")},refresh:function refresh(){var e=t.extend({},this.options,this.$element.data());this.options=e;this.selectpicker.main.map.newIndex={};this.selectpicker.main.map.originalIndex={};this.createLi();this.checkDisabled();this.render();this.setStyle();this.setWidth();this.setSize(!0);this.$element.trigger("refreshed.bs.select")},hide:function hide(){this.$newElement.hide()},show:function show(){this.$newElement.show()},remove:function remove(){this.$newElement.remove();this.$element.remove()},destroy:function destroy(){this.$newElement.before(this.$element).remove();if(this.$bsContainer){this.$bsContainer.remove()}else{this.$menu.remove()}this.$element.off(".bs.select").removeData("selectpicker").removeClass("bs-select-hidden selectpicker")}};function c(e){var i=arguments,n=e;[].shift.apply(i);if(!b.success){try{b.full=(t.fn.dropdown.Constructor.VERSION||"").split(" ")[0].split(".")}catch(e){b.full=E.BootstrapVersion.split(" ")[0].split(".")}b.major=b.full[0];b.success=!0;if("4"===b.major){x.DIVIDER="dropdown-divider";x.SHOW="show";x.BUTTONCLASS="btn-light";E.DEFAULTS.style=x.BUTTONCLASS="btn-light";x.POPOVERHEADER="popover-header"}}var s,o=this.each(function(){var e=t(this);if(e.is("select")){var o=e.data("selectpicker"),l="object"==_typeof(n)&&n;if(!o){var c=t.extend({},E.DEFAULTS,t.fn.selectpicker.defaults||{},e.data(),l);c.template=t.extend({},E.DEFAULTS.template,t.fn.selectpicker.defaults?t.fn.selectpicker.defaults.template:{},e.data().template,l.template);e.data("selectpicker",o=new E(this,c))}else if(l){for(var a in l){if(l.hasOwnProperty(a)){o.options[a]=l[a]}}}if("string"==typeof n){if(o[n]instanceof Function){s=o[n].apply(o,i)}else{s=o.options[n]}}}});if("undefined"!=typeof s){return s}else{return o}}var S=t.fn.selectpicker;t.fn.selectpicker=c;t.fn.selectpicker.Constructor=E;t.fn.selectpicker.noConflict=function(){t.fn.selectpicker=S;return this};t(document).off("keydown.bs.dropdown.data-api").on("keydown.bs.select",".bootstrap-select [data-toggle=\"dropdown\"], .bootstrap-select [role=\"listbox\"], .bs-searchbox input",E.prototype.keydown).on("focusin.modal",".bootstrap-select [data-toggle=\"dropdown\"], .bootstrap-select [role=\"listbox\"], .bs-searchbox input",function(t){t.stopPropagation()});t(window).on("load.bs.select.data-api",function(){t(".selectpicker").each(function(){var e=t(this);c.call(e,e.data())})})})(e)});
define ("theme_coursemos/bootstrap-tabs",["jquery"],function(a){(function(a){a.fn.bootstrapResponsiveTabs=function(b){var c=a.extend({minTabWidth:"inherit",maxTabWidth:"inherit",viewTabCount:0,currentTab:0,showNav:!1,prevText:"<i class=\"fa fa-angle-left\"></i>",nextText:"<i class=\"fa fa-angle-right\"></i>"},b),d=function(){var a={};return function(b,c,d){if(!d){d="default timer"}if(a[d]){clearTimeout(a[d])}a[d]=setTimeout(b,c)}}(),f=function(a){var b=a.find(".js-tab");b.sort(function(c,a){return+c.getAttribute("tab-index")-+a.getAttribute("tab-index")});a.detach(".js-tab").append(b)};this.each(function(){var b=a(this);ResponsiveTabs=function(){return function(){var g=this;g.activeTabId=1;g.tabsHorizontalContainer=b;g.tabsHorizontalContainer.addClass("responsive-tabs").wrap("<div class='responsive-tabs-container clearfix'></div>");g.tabCount=g.tabsHorizontalContainer.find(" > li").length;g.dropDownContainer=null;g.dropDownMenu=null;g.navPrevButton=a("<button type=\"button\" class=\"btn btn-nav btn-nav-prev\">"+c.prevText+"</button>");g.navNextButton=a("<button type=\"button\" class=\"btn btn-nav btn-nav-next\">"+c.nextText+"</button>");if(0<c.currentTab){g.activeTabId=c.currentTab}else{if(g.tabsHorizontalContainer.find("li.active")){var h=g.tabsHorizontalContainer.find(".nav-link.active");if(0<h.length){g.activeTabId=h.closest(".nav-item").data("sectionnum")}}}var i=function(){var b=576>window.innerWidth?!0:!1,d=g.tabsHorizontalContainer.width(),e=g.tabsHorizontalContainer.children("li");e.width("100%");if(b){g.tabsHorizontalContainer.addClass("responsive-tabs-mobile");e.each(function(){a(this).css("min-width","inherit").css("max-width","inherit")})}else{g.tabsHorizontalContainer.removeClass("responsive-tabs-mobile");var f="inherit",h="inherit";if(a.isNumeric(c.minTabWidth)){f=c.minTabWidth+"px"}if(a.isNumeric(c.maxTabWidth)){h=c.maxTabWidth+"px"}e.each(function(){a(this).css("min-width",f).css("max-width",h)})}console.log("menuWidth : "+d);var j=e.first().width();console.log("defaultTabWidth : "+j);var k=e.length;console.log("numTabs : "+k);var l=Math.ceil(d/j);console.log("numVisibleHorizontalTabs : "+l);if(b){l=1}else{if(0<c.viewTabCount){l=c.viewTabCount}}for(var m=k-l,n=0;n<e.length;n++){var o=e.eq(n),p=o.attr("tab-id"),q=g.dropDownMenu.find(".js-tab[tab-id="+p+"]"),r=n<l;o.toggleClass("hidden",!r);q.toggleClass("hidden",r)}var s=100/l,t=s+"%";console.log("tabpercent : "+t);e.width(t);var u=0<m;g.dropDownMenu.toggleClass("hidden",!u);g.dropDownMenu.siblings(".dropdown-toggle").find(".count").text("Tabs ("+m+")");g.tabsHorizontalContainer.parent().toggleClass("responsive-tabs-nav-hide",!u);var v=g.tabsHorizontalContainer.find(".js-tab[tab-id="+g.activeTabId+"]"),w=v.index(),x=v.attr("tab-index"),y=g.tabsHorizontalContainer.find(".js-tab:visible").last(),z=y.index(),A=g.dropDownMenu.find(".js-tab.hidden").last(),B=g.dropDownMenu.find(".js-tab[tab-index="+w+"]");if(w>=l){v.insertBefore(y);v.removeClass("hidden");y.addClass("hidden");A.removeClass("hidden");B.addClass("hidden")}if(w<x&&w<z){v.insertAfter(y)}a(g.navPrevButton).toggleClass("disabled",1>=g.activeTabId);a(g.navNextButton).toggleClass("disabled",g.activeTabId>=g.tabCount)},j=function(){var b=g.tabsHorizontalContainer.children("li");if(0===b.length){return}b.each(function(b){var c=a(this).index();a(this).addClass("js-tab").attr("tab-id",b+1).attr("tab-index",c)});g.tabsHorizontalContainer.after("<div class='nav navbar-nav navbar-right tabs-dropdown js-tabs-dropdown'>                                         <div class='dropdown'>                                         <a href='#' role='button' class='dropdown-toggle nav-link' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'><span class='count'>Tabs </span></a>                                         <ul class='dropdown-menu dropdown-menu-right'>                                         </ul>                                         </div>                                 </div>");g.dropDownContainer=g.tabsHorizontalContainer.siblings(".tabs-dropdown");g.dropDownMenu=g.dropDownContainer.find(".dropdown-menu");b.clone().appendTo(g.dropDownMenu);if(c.showNav){g.tabsHorizontalContainer.parent().addClass("responsive-tabs-nav");g.navPrevButton.click(function(){if(1<g.activeTabId&&!a(this).hasClass("disabled")){g.activeTabId=g.activeTabId-1;g.tabsHorizontalContainer.find(".js-tab[tab-id=\""+g.activeTabId+"\"] > .nav-link").trigger("click");i()}});g.navNextButton.click(function(){if(g.activeTabId<g.tabCount){g.activeTabId=parseInt(g.activeTabId)+1;g.tabsHorizontalContainer.find(".js-tab[tab-id=\""+g.activeTabId+"\"] > .nav-link").trigger("click");i()}});g.tabsHorizontalContainer.before(g.navPrevButton);g.tabsHorizontalContainer.after(g.navNextButton)}i()}();change_tab=function(){console.log("change_tab");g.tabsHorizontalContainer.parents(".responsive-tabs-container").on("click",".js-tab",function(b){var c=a(b.target);g.activeTabId=a(this).attr("tab-id");var d=0<c.parents(".dropdown-menu").length;if(d){g.tabsHorizontalContainer.find(".js-tab .nav-link").removeClass("active");g.tabsHorizontalContainer.find(".js-tab[tab-id="+g.activeTabId+"] .nav-link").addClass("active")}g.dropDownMenu.find(".js-tab .nav-link").removeClass("active");f(g.tabsHorizontalContainer);f(g.dropDownMenu);i()})}();a(window).resize(function(){d(function(){i()},100,"Resize Tabs")})}()}()})}})(a)});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports,require("jquery"),require("popper.js")):"function"==typeof define&&define.amd?define ("theme_coursemos/bootstrap",["exports","jquery","core/popper"],t):(e=e||self,t(e.bootstrap={},e.jQuery,e.Popper))})(this,function(e,t,n){'use strict';t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t["default"]:t;n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n["default"]:n;function o(e,t){for(var n=0,o;n<t.length;n++){o=t[n];o.enumerable=o.enumerable||!1;o.configurable=!0;if("value"in o)o.writable=!0;Object.defineProperty(e,o.key,o)}}function i(e,t,n){if(t)o(e.prototype,t);if(n)o(e,n);return e}function a(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0})}else{e[t]=n}return e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);if(t)o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable});n.push.apply(n,o)}return n}function l(e){for(var t=1,n;t<arguments.length;t++){n=null!=arguments[t]?arguments[t]:{};if(t%2){r(Object(n),!0).forEach(function(t){a(e,t,n[t])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(n))}else{r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}}return e}function s(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}function d(e){if(null===e||"undefined"==typeof e){return""+e}return{}.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase()}function c(){return{bindType:"transitionend",delegateType:"transitionend",handle:function(e){if(t(e.target).is(this)){return e.handleObj.handler.apply(this,arguments)}}}}function g(e){var n=this,o=!1;t(this).one(u.TRANSITION_END,function(){o=!0});setTimeout(function(){if(!o){u.triggerTransitionEnd(n)}},e);return this}function _(){t.fn.emulateTransitionEnd=g;t.event.special[u.TRANSITION_END]=c()}var u={TRANSITION_END:"bsTransitionEnd",getUID:function(e){do{e+=~~(Math.random()*1e6)}while(document.getElementById(e));return e},getSelectorFromElement:function(e){var t=e.getAttribute("data-target");if(!t||"#"===t){var n=e.getAttribute("href");t=n&&"#"!==n?n.trim():""}try{return document.querySelector(t)?t:null}catch(e){return null}},getTransitionDurationFromElement:function(e){if(!e){return 0}var n=t(e).css("transition-duration"),o=t(e).css("transition-delay"),i=parseFloat(n),a=parseFloat(o);if(!i&&!a){return 0}n=n.split(",")[0];o=o.split(",")[0];return(parseFloat(n)+parseFloat(o))*1e3},reflow:function(e){return e.offsetHeight},triggerTransitionEnd:function(e){t(e).trigger("transitionend")},supportsTransitionEnd:function(){return!0},isElement:function(e){return(e[0]||e).nodeType},typeCheckConfig:function(e,t,n){for(var o in n){if(Object.prototype.hasOwnProperty.call(n,o)){var i=n[o],a=t[o],r=a&&u.isElement(a)?"element":d(a);if(!new RegExp(i).test(r)){throw new Error(e.toUpperCase()+": "+("Option \""+o+"\" provided type \""+r+"\" ")+("but expected type \""+i+"\"."))}}}},findShadowRoot:function(e){if(!document.documentElement.attachShadow){return null}if("function"==typeof e.getRootNode){var t=e.getRootNode();return t instanceof ShadowRoot?t:null}if(e instanceof ShadowRoot){return e}if(!e.parentNode){return null}return u.findShadowRoot(e.parentNode)},jQueryDetection:function(){if("undefined"==typeof t){throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.")}var e=t.fn.jquery.split(" ")[0].split("."),n=9;if(e[0]<2&&e[1]<n||e[0]===1&&e[1]===n&&e[2]<1||e[0]>=4){throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}}};u.jQueryDetection();_();var p="bs.alert",h="."+p,y=t.fn.alert,v=function(){function e(e){this._element=e}var n=e.prototype;n.close=function(e){var t=this._element;if(e){t=this._getRootElement(e)}var n=this._triggerCloseEvent(t);if(n.isDefaultPrevented()){return}this._removeElement(t)};n.dispose=function(){t.removeData(this._element,p);this._element=null};n._getRootElement=function(e){var n=u.getSelectorFromElement(e),o=!1;if(n){o=document.querySelector(n)}if(!o){o=t(e).closest("."+"alert")[0]}return o};n._triggerCloseEvent=function(e){var n=t.Event("close"+h);t(e).trigger(n);return n};n._removeElement=function(e){var n=this;t(e).removeClass("show");if(!t(e).hasClass("fade")){this._destroyElement(e);return}var o=u.getTransitionDurationFromElement(e);t(e).one(u.TRANSITION_END,function(t){return n._destroyElement(e,t)}).emulateTransitionEnd(o)};n._destroyElement=function(e){t(e).detach().trigger("closed"+h).remove()};e._jQueryInterface=function(n){return this.each(function(){var o=t(this),i=o.data(p);if(!i){i=new e(this);o.data(p,i)}if("close"===n){i[n](this)}})};e._handleDismiss=function(e){return function(t){if(t){t.preventDefault()}e.close(this)}};i(e,null,[{key:"VERSION",get:function(){return"4.5.0"}}]);return e}();t(document).on("click"+h+".data-api","[data-dismiss=\"alert\"]",v._handleDismiss(new v));t.fn.alert=v._jQueryInterface;t.fn.alert.Constructor=v;t.fn.alert.noConflict=function(){t.fn.alert=y;return v._jQueryInterface};var E="bs.button",b="."+E,C=".data-api",T=t.fn.button,S="active",w="[data-toggle^=\"button\"]",D="input:not([type=\"hidden\"])",k=".btn",N=function(){function e(e){this._element=e}var n=e.prototype;n.toggle=function(){var e=!0,n=!0,o=t(this._element).closest("[data-toggle=\"buttons\"]")[0];if(o){var i=this._element.querySelector(D);if(i){if("radio"===i.type){if(i.checked&&this._element.classList.contains(S)){e=!1}else{var a=o.querySelector(".active");if(a){t(a).removeClass(S)}}}if(e){if("checkbox"===i.type||"radio"===i.type){i.checked=!this._element.classList.contains(S)}t(i).trigger("change")}i.focus();n=!1}}if(!(this._element.hasAttribute("disabled")||this._element.classList.contains("disabled"))){if(n){this._element.setAttribute("aria-pressed",!this._element.classList.contains(S))}if(e){t(this._element).toggleClass(S)}}};n.dispose=function(){t.removeData(this._element,E);this._element=null};e._jQueryInterface=function(n){return this.each(function(){var o=t(this).data(E);if(!o){o=new e(this);t(this).data(E,o)}if("toggle"===n){o[n]()}})};i(e,null,[{key:"VERSION",get:function(){return"4.5.0"}}]);return e}();t(document).on("click"+b+C,w,function(e){var n=e.target,o=n;if(!t(n).hasClass("btn")){n=t(n).closest(k)[0]}if(!n||n.hasAttribute("disabled")||n.classList.contains("disabled")){e.preventDefault()}else{var i=n.querySelector(D);if(i&&(i.hasAttribute("disabled")||i.classList.contains("disabled"))){e.preventDefault();return}if("LABEL"===o.tagName&&i&&"checkbox"===i.type){e.preventDefault()}N._jQueryInterface.call(t(n),"toggle")}}).on("focus"+b+C+" "+("blur"+b+C),w,function(e){var n=t(e.target).closest(k)[0];t(n).toggleClass("focus",/^focus(in)?$/.test(e.type))});t(window).on("load"+b+C,function(){for(var e=[].slice.call(document.querySelectorAll("[data-toggle=\"buttons\"] .btn")),t=0,n=e.length;t<n;t++){var o=e[t],a=o.querySelector(D);if(a.checked||a.hasAttribute("checked")){o.classList.add(S)}else{o.classList.remove(S)}}e=[].slice.call(document.querySelectorAll("[data-toggle=\"button\"]"));for(var r=0,l=e.length,s;r<l;r++){s=e[r];if("true"===s.getAttribute("aria-pressed")){s.classList.add(S)}else{s.classList.remove(S)}}});t.fn.button=N._jQueryInterface;t.fn.button.Constructor=N;t.fn.button.noConflict=function(){t.fn.button=T;return N._jQueryInterface};var A="bs.carousel",I="."+A,O=".data-api",j=t.fn.carousel,P={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},L={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},R="next",x="prev",q="slid"+I,F="active",Q=".active.carousel-item",H={TOUCH:"touch",PEN:"pen"},B=function(){function e(e,t){this._items=null;this._interval=null;this._activeElement=null;this._isPaused=!1;this._isSliding=!1;this.touchTimeout=null;this.touchStartX=0;this.touchDeltaX=0;this._config=this._getConfig(t);this._element=e;this._indicatorsElement=this._element.querySelector(".carousel-indicators");this._touchSupported="ontouchstart"in document.documentElement||0<navigator.maxTouchPoints;this._pointerEvent=!!(window.PointerEvent||window.MSPointerEvent);this._addEventListeners()}var n=e.prototype;n.next=function(){if(!this._isSliding){this._slide(R)}};n.nextWhenVisible=function(){if(!document.hidden&&t(this._element).is(":visible")&&"hidden"!==t(this._element).css("visibility")){this.next()}};n.prev=function(){if(!this._isSliding){this._slide(x)}};n.pause=function(e){if(!e){this._isPaused=!0}if(this._element.querySelector(".carousel-item-next, .carousel-item-prev")){u.triggerTransitionEnd(this._element);this.cycle(!0)}clearInterval(this._interval);this._interval=null};n.cycle=function(e){if(!e){this._isPaused=!1}if(this._interval){clearInterval(this._interval);this._interval=null}if(this._config.interval&&!this._isPaused){this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval)}};n.to=function(e){var n=this;this._activeElement=this._element.querySelector(Q);var o=this._getItemIndex(this._activeElement);if(e>this._items.length-1||0>e){return}if(this._isSliding){t(this._element).one(q,function(){return n.to(e)});return}if(o===e){this.pause();this.cycle();return}var i=e>o?R:x;this._slide(i,this._items[e])};n.dispose=function(){t(this._element).off(I);t.removeData(this._element,A);this._items=null;this._config=null;this._element=null;this._interval=null;this._isPaused=null;this._isSliding=null;this._activeElement=null;this._indicatorsElement=null};n._getConfig=function(e){e=l(l({},P),e);u.typeCheckConfig("carousel",e,L);return e};n._handleSwipe=function(){var e=Math.abs(this.touchDeltaX);if(e<=40){return}var t=e/this.touchDeltaX;this.touchDeltaX=0;if(0<t){this.prev()}if(0>t){this.next()}};n._addEventListeners=function(){var e=this;if(this._config.keyboard){t(this._element).on("keydown"+I,function(t){return e._keydown(t)})}if("hover"===this._config.pause){t(this._element).on("mouseenter"+I,function(t){return e.pause(t)}).on("mouseleave"+I,function(t){return e.cycle(t)})}if(this._config.touch){this._addTouchEventListeners()}};n._addTouchEventListeners=function(){var e=this;if(!this._touchSupported){return}var n=function(t){if(e._pointerEvent&&H[t.originalEvent.pointerType.toUpperCase()]){e.touchStartX=t.originalEvent.clientX}else if(!e._pointerEvent){e.touchStartX=t.originalEvent.touches[0].clientX}},o=function(t){if(t.originalEvent.touches&&1<t.originalEvent.touches.length){e.touchDeltaX=0}else{e.touchDeltaX=t.originalEvent.touches[0].clientX-e.touchStartX}},i=function(t){if(e._pointerEvent&&H[t.originalEvent.pointerType.toUpperCase()]){e.touchDeltaX=t.originalEvent.clientX-e.touchStartX}e._handleSwipe();if("hover"===e._config.pause){e.pause();if(e.touchTimeout){clearTimeout(e.touchTimeout)}e.touchTimeout=setTimeout(function(t){return e.cycle(t)},500+e._config.interval)}};t(this._element.querySelectorAll(".carousel-item img")).on("dragstart"+I,function(t){return t.preventDefault()});if(this._pointerEvent){t(this._element).on("pointerdown"+I,function(e){return n(e)});t(this._element).on("pointerup"+I,function(e){return i(e)});this._element.classList.add("pointer-event")}else{t(this._element).on("touchstart"+I,function(e){return n(e)});t(this._element).on("touchmove"+I,function(e){return o(e)});t(this._element).on("touchend"+I,function(e){return i(e)})}};n._keydown=function(e){if(/input|textarea/i.test(e.target.tagName)){return}switch(e.which){case 37:e.preventDefault();this.prev();break;case 39:e.preventDefault();this.next();break;}};n._getItemIndex=function(e){this._items=e&&e.parentNode?[].slice.call(e.parentNode.querySelectorAll(".carousel-item")):[];return this._items.indexOf(e)};n._getItemByDirection=function(e,t){var n=this._getItemIndex(t),o=this._items.length-1;if((e===x&&0===n||e===R&&n===o)&&!this._config.wrap){return t}var i=e===x?-1:1,a=(n+i)%this._items.length;return-1===a?this._items[this._items.length-1]:this._items[a]};n._triggerSlideEvent=function(e,n){var o=this._getItemIndex(e),i=this._getItemIndex(this._element.querySelector(Q)),a=t.Event("slide"+I,{relatedTarget:e,direction:n,from:i,to:o});t(this._element).trigger(a);return a};n._setActiveIndicatorElement=function(e){if(this._indicatorsElement){var n=[].slice.call(this._indicatorsElement.querySelectorAll(".active"));t(n).removeClass(F);var o=this._indicatorsElement.children[this._getItemIndex(e)];if(o){t(o).addClass(F)}}};n._slide=function(e,n){var o=this,i=this._element.querySelector(Q),a=this._getItemIndex(i),r=n||i&&this._getItemByDirection(e,i),l=this._getItemIndex(r),s=!!this._interval,d,c,g;if(e===R){d="carousel-item-left";c="carousel-item-next";g="left"}else{d="carousel-item-right";c="carousel-item-prev";g="right"}if(r&&t(r).hasClass(F)){this._isSliding=!1;return}var _=this._triggerSlideEvent(r,g);if(_.isDefaultPrevented()){return}if(!i||!r){return}this._isSliding=!0;if(s){this.pause()}this._setActiveIndicatorElement(r);var f=t.Event(q,{relatedTarget:r,direction:g,from:a,to:l});if(t(this._element).hasClass("slide")){t(r).addClass(c);u.reflow(r);t(i).addClass(d);t(r).addClass(d);var m=parseInt(r.getAttribute("data-interval"),10);if(m){this._config.defaultInterval=this._config.defaultInterval||this._config.interval;this._config.interval=m}else{this._config.interval=this._config.defaultInterval||this._config.interval}var p=u.getTransitionDurationFromElement(i);t(i).one(u.TRANSITION_END,function(){t(r).removeClass(d+" "+c).addClass(F);t(i).removeClass(F+" "+c+" "+d);o._isSliding=!1;setTimeout(function(){return t(o._element).trigger(f)},0)}).emulateTransitionEnd(p)}else{t(i).removeClass(F);t(r).addClass(F);this._isSliding=!1;t(this._element).trigger(f)}if(s){this.cycle()}};e._jQueryInterface=function(n){return this.each(function(){var o=t(this).data(A),i=l(l({},P),t(this).data());if("object"===_typeof(n)){i=l(l({},i),n)}var a="string"==typeof n?n:i.slide;if(!o){o=new e(this,i);t(this).data(A,o)}if("number"==typeof n){o.to(n)}else if("string"==typeof a){if("undefined"==typeof o[a]){throw new TypeError("No method named \""+a+"\"")}o[a]()}else if(i.interval&&i.ride){o.pause();o.cycle()}})};e._dataApiClickHandler=function(n){var o=u.getSelectorFromElement(this);if(!o){return}var i=t(o)[0];if(!i||!t(i).hasClass("carousel")){return}var a=l(l({},t(i).data()),t(this).data()),r=this.getAttribute("data-slide-to");if(r){a.interval=!1}e._jQueryInterface.call(t(i),a);if(r){t(i).data(A).to(r)}n.preventDefault()};i(e,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return P}}]);return e}();t(document).on("click"+I+O,"[data-slide], [data-slide-to]",B._dataApiClickHandler);t(window).on("load"+I+O,function(){for(var e=[].slice.call(document.querySelectorAll("[data-ride=\"carousel\"]")),n=0,o=e.length,a;n<o;n++){a=t(e[n]);B._jQueryInterface.call(a,a.data())}});t.fn.carousel=B._jQueryInterface;t.fn.carousel.Constructor=B;t.fn.carousel.noConflict=function(){t.fn.carousel=j;return B._jQueryInterface};var U="bs.collapse",M="."+U,W=t.fn.collapse,V={toggle:!0,parent:""},K={toggle:"boolean",parent:"(string|element)"},X="show",z="collapse",Y="collapsing",G="collapsed",J="width",Z="[data-toggle=\"collapse\"]",ee=function(){function e(e,t){this._isTransitioning=!1;this._element=e;this._config=this._getConfig(t);this._triggerArray=[].slice.call(document.querySelectorAll("[data-toggle=\"collapse\"][href=\"#"+e.id+"\"],"+("[data-toggle=\"collapse\"][data-target=\"#"+e.id+"\"]")));for(var n=[].slice.call(document.querySelectorAll(Z)),o=0,a=n.length;o<a;o++){var r=n[o],l=u.getSelectorFromElement(r),s=[].slice.call(document.querySelectorAll(l)).filter(function(t){return t===e});if(null!==l&&0<s.length){this._selector=l;this._triggerArray.push(r)}}this._parent=this._config.parent?this._getParent():null;if(!this._config.parent){this._addAriaAndCollapsedClass(this._element,this._triggerArray)}if(this._config.toggle){this.toggle()}}var n=e.prototype;n.toggle=function(){if(t(this._element).hasClass(X)){this.hide()}else{this.show()}};n.show=function(){var n=this;if(this._isTransitioning||t(this._element).hasClass(X)){return}var o,i;if(this._parent){o=[].slice.call(this._parent.querySelectorAll(".show, .collapsing")).filter(function(e){if("string"==typeof n._config.parent){return e.getAttribute("data-parent")===n._config.parent}return e.classList.contains(z)});if(0===o.length){o=null}}if(o){i=t(o).not(this._selector).data(U);if(i&&i._isTransitioning){return}}var a=t.Event("show"+M);t(this._element).trigger(a);if(a.isDefaultPrevented()){return}if(o){e._jQueryInterface.call(t(o).not(this._selector),"hide");if(!i){t(o).data(U,null)}}var r=this._getDimension();t(this._element).removeClass(z).addClass(Y);this._element.style[r]=0;if(this._triggerArray.length){t(this._triggerArray).removeClass(G).attr("aria-expanded",!0)}this.setTransitioning(!0);var l=function(){t(n._element).removeClass(Y).addClass(z+" "+X);n._element.style[r]="";n.setTransitioning(!1);t(n._element).trigger("shown"+M)},s=r[0].toUpperCase()+r.slice(1),d=u.getTransitionDurationFromElement(this._element);t(this._element).one(u.TRANSITION_END,l).emulateTransitionEnd(d);this._element.style[r]=this._element["scroll"+s]+"px"};n.hide=function(){var e=this;if(this._isTransitioning||!t(this._element).hasClass(X)){return}var n=t.Event("hide"+M);t(this._element).trigger(n);if(n.isDefaultPrevented()){return}var o=this._getDimension();this._element.style[o]=this._element.getBoundingClientRect()[o]+"px";u.reflow(this._element);t(this._element).addClass(Y).removeClass(z+" "+X);var a=this._triggerArray.length;if(0<a){for(var r=0;r<a;r++){var l=this._triggerArray[r],s=u.getSelectorFromElement(l);if(null!==s){var d=t([].slice.call(document.querySelectorAll(s)));if(!d.hasClass(X)){t(l).addClass(G).attr("aria-expanded",!1)}}}}this.setTransitioning(!0);var c=function(){e.setTransitioning(!1);t(e._element).removeClass(Y).addClass(z).trigger("hidden"+M)};this._element.style[o]="";var g=u.getTransitionDurationFromElement(this._element);t(this._element).one(u.TRANSITION_END,c).emulateTransitionEnd(g)};n.setTransitioning=function(e){this._isTransitioning=e};n.dispose=function(){t.removeData(this._element,U);this._config=null;this._parent=null;this._element=null;this._triggerArray=null;this._isTransitioning=null};n._getConfig=function(e){e=l(l({},V),e);e.toggle=!!e.toggle;u.typeCheckConfig("collapse",e,K);return e};n._getDimension=function(){var e=t(this._element).hasClass(J);return e?J:"height"};n._getParent=function(){var n=this,o;if(u.isElement(this._config.parent)){o=this._config.parent;if("undefined"!=typeof this._config.parent.jquery){o=this._config.parent[0]}}else{o=document.querySelector(this._config.parent)}var i="[data-toggle=\"collapse\"][data-parent=\""+this._config.parent+"\"]",a=[].slice.call(o.querySelectorAll(i));t(a).each(function(t,o){n._addAriaAndCollapsedClass(e._getTargetFromElement(o),[o])});return o};n._addAriaAndCollapsedClass=function(e,n){var o=t(e).hasClass(X);if(n.length){t(n).toggleClass(G,!o).attr("aria-expanded",o)}};e._getTargetFromElement=function(e){var t=u.getSelectorFromElement(e);return t?document.querySelector(t):null};e._jQueryInterface=function(n){return this.each(function(){var o=t(this),i=o.data(U),a=l(l(l({},V),o.data()),"object"===_typeof(n)&&n?n:{});if(!i&&a.toggle&&"string"==typeof n&&/show|hide/.test(n)){a.toggle=!1}if(!i){i=new e(this,a);o.data(U,i)}if("string"==typeof n){if("undefined"==typeof i[n]){throw new TypeError("No method named \""+n+"\"")}i[n]()}})};i(e,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return V}}]);return e}();t(document).on("click"+M+".data-api",Z,function(e){if("A"===e.currentTarget.tagName){e.preventDefault()}var n=t(this),o=u.getSelectorFromElement(this),i=[].slice.call(document.querySelectorAll(o));t(i).each(function(){var e=t(this),o=e.data(U),i=o?"toggle":n.data();ee._jQueryInterface.call(e,i)})});t.fn.collapse=ee._jQueryInterface;t.fn.collapse.Constructor=ee;t.fn.collapse.noConflict=function(){t.fn.collapse=W;return ee._jQueryInterface};var te="bs.dropdown",ne="."+te,oe=".data-api",ie=t.fn.dropdown,ae=27,re=32,le=9,se=38,de=40,ce=new RegExp(se+"|"+de+"|"+ae),ge="hide"+ne,_e="hidden"+ne,fe="click"+ne+oe,me="keydown"+ne+oe,ue="disabled",pe="show",he="dropdown-menu-right",ye="[data-toggle=\"dropdown\"]",ve=".dropdown-menu",Ee={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},be={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},Ce=function(){function e(e,t){this._element=e;this._popper=null;this._config=this._getConfig(t);this._menu=this._getMenuElement();this._inNavbar=this._detectNavbar();this._addEventListeners()}var o=e.prototype;o.toggle=function(){if(this._element.disabled||t(this._element).hasClass(ue)){return}var n=t(this._menu).hasClass(pe);e._clearMenus();if(n){return}this.show(!0)};o.show=function(o){if(void 0===o){o=!1}if(this._element.disabled||t(this._element).hasClass(ue)||t(this._menu).hasClass(pe)){return}var i={relatedTarget:this._element},a=t.Event("show"+ne,i),r=e._getParentFromElement(this._element);t(r).trigger(a);if(a.isDefaultPrevented()){return}if(!this._inNavbar&&o){if("undefined"==typeof n){throw new TypeError("Bootstrap's dropdowns require Popper.js (https://popper.js.org/)")}var l=this._element;if("parent"===this._config.reference){l=r}else if(u.isElement(this._config.reference)){l=this._config.reference;if("undefined"!=typeof this._config.reference.jquery){l=this._config.reference[0]}}if("scrollParent"!==this._config.boundary){t(r).addClass("position-static")}this._popper=new n(l,this._menu,this._getPopperConfig())}if("ontouchstart"in document.documentElement&&0===t(r).closest(".navbar-nav").length){t(document.body).children().on("mouseover",null,t.noop)}this._element.focus();this._element.setAttribute("aria-expanded",!0);t(this._menu).toggleClass(pe);t(r).toggleClass(pe).trigger(t.Event("shown"+ne,i))};o.hide=function(){if(this._element.disabled||t(this._element).hasClass(ue)||!t(this._menu).hasClass(pe)){return}var n={relatedTarget:this._element},o=t.Event(ge,n),i=e._getParentFromElement(this._element);t(i).trigger(o);if(o.isDefaultPrevented()){return}if(this._popper){this._popper.destroy()}t(this._menu).toggleClass(pe);t(i).toggleClass(pe).trigger(t.Event(_e,n))};o.dispose=function(){t.removeData(this._element,te);t(this._element).off(ne);this._element=null;this._menu=null;if(null!==this._popper){this._popper.destroy();this._popper=null}};o.update=function(){this._inNavbar=this._detectNavbar();if(null!==this._popper){this._popper.scheduleUpdate()}};o._addEventListeners=function(){var e=this;t(this._element).on("click"+ne,function(t){t.preventDefault();t.stopPropagation();e.toggle()})};o._getConfig=function(e){e=l(l(l({},this.constructor.Default),t(this._element).data()),e);u.typeCheckConfig("dropdown",e,this.constructor.DefaultType);return e};o._getMenuElement=function(){if(!this._menu){var t=e._getParentFromElement(this._element);if(t){this._menu=t.querySelector(ve)}}return this._menu};o._getPlacement=function(){var e=t(this._element.parentNode),n="bottom-start";if(e.hasClass("dropup")){n=t(this._menu).hasClass(he)?"top-end":"top-start"}else if(e.hasClass("dropright")){n="right-start"}else if(e.hasClass("dropleft")){n="left-start"}else if(t(this._menu).hasClass(he)){n="bottom-end"}return n};o._detectNavbar=function(){return 0<t(this._element).closest(".navbar").length};o._getOffset=function(){var e=this,t={};if("function"==typeof this._config.offset){t.fn=function(t){t.offsets=l(l({},t.offsets),e._config.offset(t.offsets,e._element)||{});return t}}else{t.offset=this._config.offset}return t};o._getPopperConfig=function(){var e={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};if("static"===this._config.display){e.modifiers.applyStyle={enabled:!1}}return l(l({},e),this._config.popperConfig)};e._jQueryInterface=function(n){return this.each(function(){var o=t(this).data(te),i="object"===_typeof(n)?n:null;if(!o){o=new e(this,i);t(this).data(te,o)}if("string"==typeof n){if("undefined"==typeof o[n]){throw new TypeError("No method named \""+n+"\"")}o[n]()}})};e._clearMenus=function(n){if(n&&(n.which===3||"keyup"===n.type&&n.which!==le)){return}for(var o=[].slice.call(document.querySelectorAll(ye)),a=0,r=o.length;a<r;a++){var l=e._getParentFromElement(o[a]),s=t(o[a]).data(te),d={relatedTarget:o[a]};if(n&&"click"===n.type){d.clickEvent=n}if(!s){continue}var c=s._menu;if(!t(l).hasClass(pe)){continue}if(n&&("click"===n.type&&/input|textarea/i.test(n.target.tagName)||"keyup"===n.type&&n.which===le)&&t.contains(l,n.target)){continue}var g=t.Event(ge,d);t(l).trigger(g);if(g.isDefaultPrevented()){continue}if("ontouchstart"in document.documentElement){t(document.body).children().off("mouseover",null,t.noop)}o[a].setAttribute("aria-expanded","false");if(s._popper){s._popper.destroy()}t(c).removeClass(pe);t(l).removeClass(pe).trigger(t.Event(_e,d))}};e._getParentFromElement=function(e){var t,n=u.getSelectorFromElement(e);if(n){t=document.querySelector(n)}return t||e.parentNode};e._dataApiKeydownHandler=function(n){if(/input|textarea/i.test(n.target.tagName)?n.which===re||n.which!==ae&&(n.which!==de&&n.which!==se||t(n.target).closest(ve).length):!ce.test(n.which)){return}if(this.disabled||t(this).hasClass(ue)){return}var o=e._getParentFromElement(this),i=t(o).hasClass(pe);if(!i&&n.which===ae){return}n.preventDefault();n.stopPropagation();if(!i||i&&(n.which===ae||n.which===re)){if(n.which===ae){t(o.querySelector(ye)).trigger("focus")}t(this).trigger("click");return}var a=[].slice.call(o.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter(function(e){return t(e).is(":visible")});if(0===a.length){return}var r=a.indexOf(n.target);if(n.which===se&&0<r){r--}if(n.which===de&&r<a.length-1){r++}if(0>r){r=0}a[r].focus()};i(e,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return Ee}},{key:"DefaultType",get:function(){return be}}]);return e}();t(document).on(me,ye,Ce._dataApiKeydownHandler).on(me,ve,Ce._dataApiKeydownHandler).on(fe+" "+("keyup"+ne+oe),Ce._clearMenus).on(fe,ye,function(e){e.preventDefault();e.stopPropagation();Ce._jQueryInterface.call(t(this),"toggle")}).on(fe,".dropdown form",function(t){t.stopPropagation()});t.fn.dropdown=Ce._jQueryInterface;t.fn.dropdown.Constructor=Ce;t.fn.dropdown.noConflict=function(){t.fn.dropdown=ie;return Ce._jQueryInterface};var Te="bs.modal",Se="."+Te,we=t.fn.modal,De=27,ke={backdrop:!0,keyboard:!0,focus:!0,show:!0},Ne={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},Ae="hidden"+Se,Ie="show"+Se,Oe="focusin"+Se,je="resize"+Se,Pe="click.dismiss"+Se,Le="keydown.dismiss"+Se,Re="mousedown.dismiss"+Se,xe="modal-open",qe="fade",Fe="show",Qe="modal-static",He=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Be=".sticky-top",Ue=function(){function e(e,t){this._config=this._getConfig(t);this._element=e;this._dialog=e.querySelector(".modal-dialog");this._backdrop=null;this._isShown=!1;this._isBodyOverflowing=!1;this._ignoreBackdropClick=!1;this._isTransitioning=!1;this._scrollbarWidth=0}var n=e.prototype;n.toggle=function(e){return this._isShown?this.hide():this.show(e)};n.show=function(e){var n=this;if(this._isShown||this._isTransitioning){return}if(t(this._element).hasClass(qe)){this._isTransitioning=!0}var o=t.Event(Ie,{relatedTarget:e});t(this._element).trigger(o);if(this._isShown||o.isDefaultPrevented()){return}this._isShown=!0;this._checkScrollbar();this._setScrollbar();this._adjustDialog();this._setEscapeEvent();this._setResizeEvent();t(this._element).on(Pe,"[data-dismiss=\"modal\"]",function(e){return n.hide(e)});t(this._dialog).on(Re,function(){t(n._element).one("mouseup.dismiss"+Se,function(e){if(t(e.target).is(n._element)){n._ignoreBackdropClick=!0}})});this._showBackdrop(function(){return n._showElement(e)})};n.hide=function(e){var n=this;if(e){e.preventDefault()}if(!this._isShown||this._isTransitioning){return}var o=t.Event("hide"+Se);t(this._element).trigger(o);if(!this._isShown||o.isDefaultPrevented()){return}this._isShown=!1;var i=t(this._element).hasClass(qe);if(i){this._isTransitioning=!0}this._setEscapeEvent();this._setResizeEvent();t(document).off(Oe);t(this._element).removeClass(Fe);t(this._element).off(Pe);t(this._dialog).off(Re);if(i){var a=u.getTransitionDurationFromElement(this._element);t(this._element).one(u.TRANSITION_END,function(e){return n._hideModal(e)}).emulateTransitionEnd(a)}else{this._hideModal()}};n.dispose=function(){[window,this._element,this._dialog].forEach(function(e){return t(e).off(Se)});t(document).off(Oe);t.removeData(this._element,Te);this._config=null;this._element=null;this._dialog=null;this._backdrop=null;this._isShown=null;this._isBodyOverflowing=null;this._ignoreBackdropClick=null;this._isTransitioning=null;this._scrollbarWidth=null};n.handleUpdate=function(){this._adjustDialog()};n._getConfig=function(e){e=l(l({},ke),e);u.typeCheckConfig("modal",e,Ne);return e};n._triggerBackdropTransition=function(){var e=this;if("static"===this._config.backdrop){var n=t.Event("hidePrevented"+Se);t(this._element).trigger(n);if(n.defaultPrevented){return}this._element.classList.add(Qe);var o=u.getTransitionDurationFromElement(this._element);t(this._element).one(u.TRANSITION_END,function(){e._element.classList.remove(Qe)}).emulateTransitionEnd(o);this._element.focus()}else{this.hide()}};n._showElement=function(e){var n=this,o=t(this._element).hasClass(qe),i=this._dialog?this._dialog.querySelector(".modal-body"):null;if(!this._element.parentNode||this._element.parentNode.nodeType!==Node.ELEMENT_NODE){document.body.appendChild(this._element)}this._element.style.display="block";this._element.removeAttribute("aria-hidden");this._element.setAttribute("aria-modal",!0);if(t(this._dialog).hasClass("modal-dialog-scrollable")&&i){i.scrollTop=0}else{this._element.scrollTop=0}if(o){u.reflow(this._element)}t(this._element).addClass(Fe);if(this._config.focus){this._enforceFocus()}var a=t.Event("shown"+Se,{relatedTarget:e}),r=function(){if(n._config.focus){n._element.focus()}n._isTransitioning=!1;t(n._element).trigger(a)};if(o){var l=u.getTransitionDurationFromElement(this._dialog);t(this._dialog).one(u.TRANSITION_END,r).emulateTransitionEnd(l)}else{r()}};n._enforceFocus=function(){var e=this;t(document).off(Oe).on(Oe,function(n){if(document!==n.target&&e._element!==n.target&&0===t(e._element).has(n.target).length){e._element.focus()}})};n._setEscapeEvent=function(){var e=this;if(this._isShown){t(this._element).on(Le,function(t){if(e._config.keyboard&&t.which===De){t.preventDefault();e.hide()}else if(!e._config.keyboard&&t.which===De){e._triggerBackdropTransition()}})}else if(!this._isShown){t(this._element).off(Le)}};n._setResizeEvent=function(){var e=this;if(this._isShown){t(window).on(je,function(t){return e.handleUpdate(t)})}else{t(window).off(je)}};n._hideModal=function(){var e=this;this._element.style.display="none";this._element.setAttribute("aria-hidden",!0);this._element.removeAttribute("aria-modal");this._isTransitioning=!1;this._showBackdrop(function(){t(document.body).removeClass(xe);e._resetAdjustments();e._resetScrollbar();t(e._element).trigger(Ae)})};n._removeBackdrop=function(){if(this._backdrop){t(this._backdrop).remove();this._backdrop=null}};n._showBackdrop=function(e){var n=this,o=t(this._element).hasClass(qe)?qe:"";if(this._isShown&&this._config.backdrop){this._backdrop=document.createElement("div");this._backdrop.className="modal-backdrop";if(o){this._backdrop.classList.add(o)}t(this._backdrop).appendTo(document.body);t(this._element).on(Pe,function(e){if(n._ignoreBackdropClick){n._ignoreBackdropClick=!1;return}if(e.target!==e.currentTarget){return}n._triggerBackdropTransition()});if(o){u.reflow(this._backdrop)}t(this._backdrop).addClass(Fe);if(!e){return}if(!o){e();return}var i=u.getTransitionDurationFromElement(this._backdrop);t(this._backdrop).one(u.TRANSITION_END,e).emulateTransitionEnd(i)}else if(!this._isShown&&this._backdrop){t(this._backdrop).removeClass(Fe);var a=function(){n._removeBackdrop();if(e){e()}};if(t(this._element).hasClass(qe)){var r=u.getTransitionDurationFromElement(this._backdrop);t(this._backdrop).one(u.TRANSITION_END,a).emulateTransitionEnd(r)}else{a()}}else if(e){e()}};n._adjustDialog=function(){var e=this._element.scrollHeight>document.documentElement.clientHeight;if(!this._isBodyOverflowing&&e){this._element.style.paddingLeft=this._scrollbarWidth+"px"}if(this._isBodyOverflowing&&!e){this._element.style.paddingRight=this._scrollbarWidth+"px"}};n._resetAdjustments=function(){this._element.style.paddingLeft="";this._element.style.paddingRight=""};n._checkScrollbar=function(){var e=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(e.left+e.right)<window.innerWidth;this._scrollbarWidth=this._getScrollbarWidth()};n._setScrollbar=function(){var e=this;if(this._isBodyOverflowing){var n=[].slice.call(document.querySelectorAll(He)),o=[].slice.call(document.querySelectorAll(Be));t(n).each(function(n,o){var i=o.style.paddingRight,a=t(o).css("padding-right");t(o).data("padding-right",i).css("padding-right",parseFloat(a)+e._scrollbarWidth+"px")});t(o).each(function(n,o){var i=o.style.marginRight,a=t(o).css("margin-right");t(o).data("margin-right",i).css("margin-right",parseFloat(a)-e._scrollbarWidth+"px")});var i=document.body.style.paddingRight,a=t(document.body).css("padding-right");t(document.body).data("padding-right",i).css("padding-right",parseFloat(a)+this._scrollbarWidth+"px")}t(document.body).addClass(xe)};n._resetScrollbar=function(){var e=[].slice.call(document.querySelectorAll(He));t(e).each(function(e,n){var o=t(n).data("padding-right");t(n).removeData("padding-right");n.style.paddingRight=o?o:""});var n=[].slice.call(document.querySelectorAll(""+Be));t(n).each(function(e,n){var o=t(n).data("margin-right");if("undefined"!=typeof o){t(n).css("margin-right",o).removeData("margin-right")}});var o=t(document.body).data("padding-right");t(document.body).removeData("padding-right");document.body.style.paddingRight=o?o:""};n._getScrollbarWidth=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure";document.body.appendChild(e);var t=e.getBoundingClientRect().width-e.clientWidth;document.body.removeChild(e);return t};e._jQueryInterface=function(n,o){return this.each(function(){var i=t(this).data(Te),a=l(l(l({},ke),t(this).data()),"object"===_typeof(n)&&n?n:{});if(!i){i=new e(this,a);t(this).data(Te,i)}if("string"==typeof n){if("undefined"==typeof i[n]){throw new TypeError("No method named \""+n+"\"")}i[n](o)}else if(a.show){i.show(o)}})};i(e,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return ke}}]);return e}();t(document).on("click"+Se+".data-api","[data-toggle=\"modal\"]",function(e){var n=this,o,i=u.getSelectorFromElement(this);if(i){o=document.querySelector(i)}var a=t(o).data(Te)?"toggle":l(l({},t(o).data()),t(this).data());if("A"===this.tagName||"AREA"===this.tagName){e.preventDefault()}var r=t(o).one(Ie,function(e){if(e.isDefaultPrevented()){return}r.one(Ae,function(){if(t(n).is(":visible")){n.focus()}})});Ue._jQueryInterface.call(t(o),a,this)});t.fn.modal=Ue._jQueryInterface;t.fn.modal.Constructor=Ue;t.fn.modal.noConflict=function(){t.fn.modal=we;return Ue._jQueryInterface};var Me=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"];function f(e,t){var n=e.nodeName.toLowerCase();if(-1!==t.indexOf(n)){if(-1!==Me.indexOf(n)){return!!(e.nodeValue.match(/^(?:(?:https?|mailto|ftp|tel|file):|[^#&/:?]*(?:[#/?]|$))/gi)||e.nodeValue.match(/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i))}return!0}for(var o=t.filter(function(e){return e instanceof RegExp}),a=0,r=o.length;a<r;a++){if(n.match(o[a])){return!0}}return!1}function m(e,t,n){if(0===e.length){return e}if(n&&"function"==typeof n){return n(e)}for(var o=new window.DOMParser,a=o.parseFromString(e,"text/html"),r=Object.keys(t),l=[].slice.call(a.body.querySelectorAll("*")),s=function(e){var n=l[e],o=n.nodeName.toLowerCase();if(-1===r.indexOf(n.nodeName.toLowerCase())){n.parentNode.removeChild(n);return"continue"}var i=[].slice.call(n.attributes),a=[].concat(t["*"]||[],t[o]||[]);i.forEach(function(e){if(!f(e,a)){n.removeAttribute(e.nodeName)}})},d=0,c=l.length,g;d<c;d++){g=s(d);if("continue"===g)continue}return a.body.innerHTML}var We="bs.tooltip",Ve="."+We,Ke=t.fn.tooltip,Xe="bs-tooltip",ze=new RegExp("(^|\\s)"+Xe+"\\S+","g"),Ye=["sanitize","whiteList","sanitizeFn"],Ge={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},Je={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},Ze={animation:!0,template:"<div class=\"tooltip\" role=\"tooltip\"><div class=\"arrow\"></div><div class=\"tooltip-inner\"></div></div>",trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",sanitize:!0,sanitizeFn:null,whiteList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},$e="show",et="out",tt={HIDE:"hide"+Ve,HIDDEN:"hidden"+Ve,SHOW:"show"+Ve,SHOWN:"shown"+Ve,INSERTED:"inserted"+Ve,CLICK:"click"+Ve,FOCUSIN:"focusin"+Ve,FOCUSOUT:"focusout"+Ve,MOUSEENTER:"mouseenter"+Ve,MOUSELEAVE:"mouseleave"+Ve},nt="fade",ot="show",it="hover",at="focus",rt=function(){function e(e,t){if("undefined"==typeof n){throw new TypeError("Bootstrap's tooltips require Popper.js (https://popper.js.org/)")}this._isEnabled=!0;this._timeout=0;this._hoverState="";this._activeTrigger={};this._popper=null;this.element=e;this.config=this._getConfig(t);this.tip=null;this._setListeners()}var o=e.prototype;o.enable=function(){this._isEnabled=!0};o.disable=function(){this._isEnabled=!1};o.toggleEnabled=function(){this._isEnabled=!this._isEnabled};o.toggle=function(e){if(!this._isEnabled){return}if(e){var n=this.constructor.DATA_KEY,o=t(e.currentTarget).data(n);if(!o){o=new this.constructor(e.currentTarget,this._getDelegateConfig());t(e.currentTarget).data(n,o)}o._activeTrigger.click=!o._activeTrigger.click;if(o._isWithActiveTrigger()){o._enter(null,o)}else{o._leave(null,o)}}else{if(t(this.getTipElement()).hasClass(ot)){this._leave(null,this);return}this._enter(null,this)}};o.dispose=function(){clearTimeout(this._timeout);t.removeData(this.element,this.constructor.DATA_KEY);t(this.element).off(this.constructor.EVENT_KEY);t(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler);if(this.tip){t(this.tip).remove()}this._isEnabled=null;this._timeout=null;this._hoverState=null;this._activeTrigger=null;if(this._popper){this._popper.destroy()}this._popper=null;this.element=null;this.config=null;this.tip=null};o.show=function(){var e=this;if("none"===t(this.element).css("display")){throw new Error("Please use show on visible elements")}var o=t.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){t(this.element).trigger(o);var i=u.findShadowRoot(this.element),a=t.contains(null!==i?i:this.element.ownerDocument.documentElement,this.element);if(o.isDefaultPrevented()||!a){return}var r=this.getTipElement(),l=u.getUID(this.constructor.NAME);r.setAttribute("id",l);this.element.setAttribute("aria-describedby",l);this.setContent();if(this.config.animation){t(r).addClass(nt)}var s="function"==typeof this.config.placement?this.config.placement.call(this,r,this.element):this.config.placement,d=this._getAttachment(s);this.addAttachmentClass(d);var c=this._getContainer();t(r).data(this.constructor.DATA_KEY,this);if(!t.contains(this.element.ownerDocument.documentElement,this.tip)){t(r).appendTo(c)}t(this.element).trigger(this.constructor.Event.INSERTED);this._popper=new n(this.element,r,this._getPopperConfig(d));t(r).addClass(ot);if("ontouchstart"in document.documentElement){t(document.body).children().on("mouseover",null,t.noop)}var g=function(){if(e.config.animation){e._fixTransition()}var n=e._hoverState;e._hoverState=null;t(e.element).trigger(e.constructor.Event.SHOWN);if(n===et){e._leave(null,e)}};if(t(this.tip).hasClass(nt)){var _=u.getTransitionDurationFromElement(this.tip);t(this.tip).one(u.TRANSITION_END,g).emulateTransitionEnd(_)}else{g()}}};o.hide=function(e){var n=this,o=this.getTipElement(),i=t.Event(this.constructor.Event.HIDE),a=function(){if(n._hoverState!==$e&&o.parentNode){o.parentNode.removeChild(o)}n._cleanTipClass();n.element.removeAttribute("aria-describedby");t(n.element).trigger(n.constructor.Event.HIDDEN);if(null!==n._popper){n._popper.destroy()}if(e){e()}};t(this.element).trigger(i);if(i.isDefaultPrevented()){return}t(o).removeClass(ot);if("ontouchstart"in document.documentElement){t(document.body).children().off("mouseover",null,t.noop)}this._activeTrigger["click"]=!1;this._activeTrigger[at]=!1;this._activeTrigger[it]=!1;if(t(this.tip).hasClass(nt)){var r=u.getTransitionDurationFromElement(o);t(o).one(u.TRANSITION_END,a).emulateTransitionEnd(r)}else{a()}this._hoverState=""};o.update=function(){if(null!==this._popper){this._popper.scheduleUpdate()}};o.isWithContent=function(){return!!this.getTitle()};o.addAttachmentClass=function(e){t(this.getTipElement()).addClass(Xe+"-"+e)};o.getTipElement=function(){this.tip=this.tip||t(this.config.template)[0];return this.tip};o.setContent=function(){var e=this.getTipElement();this.setElementContent(t(e.querySelectorAll(".tooltip-inner")),this.getTitle());t(e).removeClass(nt+" "+ot)};o.setElementContent=function(e,n){if("object"===_typeof(n)&&(n.nodeType||n.jquery)){if(this.config.html){if(!t(n).parent().is(e)){e.empty().append(n)}}else{e.text(t(n).text())}return}if(this.config.html){if(this.config.sanitize){n=m(n,this.config.whiteList,this.config.sanitizeFn)}e.html(n)}else{e.text(n)}};o.getTitle=function(){var e=this.element.getAttribute("data-original-title");if(!e){e="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title}return e};o._getPopperConfig=function(e){var t=this,n={placement:e,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(e){if(e.originalPlacement!==e.placement){t._handlePopperPlacementChange(e)}},onUpdate:function(e){return t._handlePopperPlacementChange(e)}};return l(l({},n),this.config.popperConfig)};o._getOffset=function(){var e=this,t={};if("function"==typeof this.config.offset){t.fn=function(t){t.offsets=l(l({},t.offsets),e.config.offset(t.offsets,e.element)||{});return t}}else{t.offset=this.config.offset}return t};o._getContainer=function(){if(!1===this.config.container){return document.body}if(u.isElement(this.config.container)){return t(this.config.container)}return t(document).find(this.config.container)};o._getAttachment=function(e){return Je[e.toUpperCase()]};o._setListeners=function(){var e=this,n=this.config.trigger.split(" ");n.forEach(function(n){if("click"===n){t(e.element).on(e.constructor.Event.CLICK,e.config.selector,function(t){return e.toggle(t)})}else if(n!=="manual"){var o=n===it?e.constructor.Event.MOUSEENTER:e.constructor.Event.FOCUSIN,i=n===it?e.constructor.Event.MOUSELEAVE:e.constructor.Event.FOCUSOUT;t(e.element).on(o,e.config.selector,function(t){return e._enter(t)}).on(i,e.config.selector,function(t){return e._leave(t)})}});this._hideModalHandler=function(){if(e.element){e.hide()}};t(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler);if(this.config.selector){this.config=l(l({},this.config),{},{trigger:"manual",selector:""})}else{this._fixTitle()}};o._fixTitle=function(){var e=_typeof(this.element.getAttribute("data-original-title"));if(this.element.getAttribute("title")||"string"!==e){this.element.setAttribute("data-original-title",this.element.getAttribute("title")||"");this.element.setAttribute("title","")}};o._enter=function(e,n){var o=this.constructor.DATA_KEY;n=n||t(e.currentTarget).data(o);if(!n){n=new this.constructor(e.currentTarget,this._getDelegateConfig());t(e.currentTarget).data(o,n)}if(e){n._activeTrigger["focusin"===e.type?at:it]=!0}if(t(n.getTipElement()).hasClass(ot)||n._hoverState===$e){n._hoverState=$e;return}clearTimeout(n._timeout);n._hoverState=$e;if(!n.config.delay||!n.config.delay.show){n.show();return}n._timeout=setTimeout(function(){if(n._hoverState===$e){n.show()}},n.config.delay.show)};o._leave=function(e,n){var o=this.constructor.DATA_KEY;n=n||t(e.currentTarget).data(o);if(!n){n=new this.constructor(e.currentTarget,this._getDelegateConfig());t(e.currentTarget).data(o,n)}if(e){n._activeTrigger["focusout"===e.type?at:it]=!1}if(n._isWithActiveTrigger()){return}clearTimeout(n._timeout);n._hoverState=et;if(!n.config.delay||!n.config.delay.hide){n.hide();return}n._timeout=setTimeout(function(){if(n._hoverState===et){n.hide()}},n.config.delay.hide)};o._isWithActiveTrigger=function(){for(var e in this._activeTrigger){if(this._activeTrigger[e]){return!0}}return!1};o._getConfig=function(e){var n=t(this.element).data();Object.keys(n).forEach(function(e){if(-1!==Ye.indexOf(e)){delete n[e]}});e=l(l(l({},this.constructor.Default),n),"object"===_typeof(e)&&e?e:{});if("number"==typeof e.delay){e.delay={show:e.delay,hide:e.delay}}if("number"==typeof e.title){e.title=e.title.toString()}if("number"==typeof e.content){e.content=e.content.toString()}u.typeCheckConfig("tooltip",e,this.constructor.DefaultType);if(e.sanitize){e.template=m(e.template,e.whiteList,e.sanitizeFn)}return e};o._getDelegateConfig=function(){var e={};if(this.config){for(var t in this.config){if(this.constructor.Default[t]!==this.config[t]){e[t]=this.config[t]}}}return e};o._cleanTipClass=function(){var e=t(this.getTipElement()),n=e.attr("class").match(ze);if(null!==n&&n.length){e.removeClass(n.join(""))}};o._handlePopperPlacementChange=function(e){this.tip=e.instance.popper;this._cleanTipClass();this.addAttachmentClass(this._getAttachment(e.placement))};o._fixTransition=function(){var e=this.getTipElement(),n=this.config.animation;if(null!==e.getAttribute("x-placement")){return}t(e).removeClass(nt);this.config.animation=!1;this.hide();this.show();this.config.animation=n};e._jQueryInterface=function(n){return this.each(function(){var o=t(this).data(We),i="object"===_typeof(n)&&n;if(!o&&/dispose|hide/.test(n)){return}if(!o){o=new e(this,i);t(this).data(We,o)}if("string"==typeof n){if("undefined"==typeof o[n]){throw new TypeError("No method named \""+n+"\"")}o[n]()}})};i(e,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return Ze}},{key:"NAME",get:function(){return"tooltip"}},{key:"DATA_KEY",get:function(){return We}},{key:"Event",get:function(){return tt}},{key:"EVENT_KEY",get:function(){return Ve}},{key:"DefaultType",get:function(){return Ge}}]);return e}();t.fn.tooltip=rt._jQueryInterface;t.fn.tooltip.Constructor=rt;t.fn.tooltip.noConflict=function(){t.fn.tooltip=Ke;return rt._jQueryInterface};var lt="bs.popover",st="."+lt,dt=t.fn.popover,ct="bs-popover",gt=new RegExp("(^|\\s)"+ct+"\\S+","g"),_t=l(l({},rt.Default),{},{placement:"right",trigger:"click",content:"",template:"<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-header\"></h3><div class=\"popover-body\"></div></div>"}),ft=l(l({},rt.DefaultType),{},{content:"(string|element|function)"}),mt={HIDE:"hide"+st,HIDDEN:"hidden"+st,SHOW:"show"+st,SHOWN:"shown"+st,INSERTED:"inserted"+st,CLICK:"click"+st,FOCUSIN:"focusin"+st,FOCUSOUT:"focusout"+st,MOUSEENTER:"mouseenter"+st,MOUSELEAVE:"mouseleave"+st},ut=function(e){s(n,e);function n(){return e.apply(this,arguments)||this}var o=n.prototype;o.isWithContent=function(){return this.getTitle()||this._getContent()};o.addAttachmentClass=function(e){t(this.getTipElement()).addClass(ct+"-"+e)};o.getTipElement=function(){this.tip=this.tip||t(this.config.template)[0];return this.tip};o.setContent=function(){var e=t(this.getTipElement());this.setElementContent(e.find(".popover-header"),this.getTitle());var n=this._getContent();if("function"==typeof n){n=n.call(this.element)}this.setElementContent(e.find(".popover-body"),n);e.removeClass("fade"+" "+"show")};o._getContent=function(){return this.element.getAttribute("data-content")||this.config.content};o._cleanTipClass=function(){var e=t(this.getTipElement()),n=e.attr("class").match(gt);if(null!==n&&0<n.length){e.removeClass(n.join(""))}};n._jQueryInterface=function(e){return this.each(function(){var o=t(this).data(lt),i="object"===_typeof(e)?e:null;if(!o&&/dispose|hide/.test(e)){return}if(!o){o=new n(this,i);t(this).data(lt,o)}if("string"==typeof e){if("undefined"==typeof o[e]){throw new TypeError("No method named \""+e+"\"")}o[e]()}})};i(n,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return _t}},{key:"NAME",get:function(){return"popover"}},{key:"DATA_KEY",get:function(){return lt}},{key:"Event",get:function(){return mt}},{key:"EVENT_KEY",get:function(){return st}},{key:"DefaultType",get:function(){return ft}}]);return n}(rt);t.fn.popover=ut._jQueryInterface;t.fn.popover.Constructor=ut;t.fn.popover.noConflict=function(){t.fn.popover=dt;return ut._jQueryInterface};var pt="bs.scrollspy",ht="."+pt,yt=t.fn.scrollspy,vt={offset:10,method:"auto",target:""},Et={offset:"number",method:"string",target:"(string|element)"},bt="active",Ct=".nav, .list-group",Tt=".nav-link",St=".list-group-item",wt="position",Dt=function(){function e(e,n){var o=this;this._element=e;this._scrollElement="BODY"===e.tagName?window:e;this._config=this._getConfig(n);this._selector=this._config.target+" "+Tt+","+(this._config.target+" "+St+",")+(this._config.target+" "+".dropdown-item");this._offsets=[];this._targets=[];this._activeTarget=null;this._scrollHeight=0;t(this._scrollElement).on("scroll"+ht,function(e){return o._process(e)});this.refresh();this._process()}var n=e.prototype;n.refresh=function(){var e=this,n=this._scrollElement===this._scrollElement.window?"offset":wt,o="auto"===this._config.method?n:this._config.method,i=o===wt?this._getScrollTop():0;this._offsets=[];this._targets=[];this._scrollHeight=this._getScrollHeight();var a=[].slice.call(document.querySelectorAll(this._selector));a.map(function(e){var n,a=u.getSelectorFromElement(e);if(a){n=document.querySelector(a)}if(n){var r=n.getBoundingClientRect();if(r.width||r.height){return[t(n)[o]().top+i,a]}}return null}).filter(function(e){return e}).sort(function(e,t){return e[0]-t[0]}).forEach(function(t){e._offsets.push(t[0]);e._targets.push(t[1])})};n.dispose=function(){t.removeData(this._element,pt);t(this._scrollElement).off(ht);this._element=null;this._scrollElement=null;this._config=null;this._selector=null;this._offsets=null;this._targets=null;this._activeTarget=null;this._scrollHeight=null};n._getConfig=function(e){e=l(l({},vt),"object"===_typeof(e)&&e?e:{});if("string"!=typeof e.target&&u.isElement(e.target)){var n=t(e.target).attr("id");if(!n){n=u.getUID("scrollspy");t(e.target).attr("id",n)}e.target="#"+n}u.typeCheckConfig("scrollspy",e,Et);return e};n._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop};n._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)};n._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height};n._process=function(){var e=this._getScrollTop()+this._config.offset,t=this._getScrollHeight(),n=this._config.offset+t-this._getOffsetHeight();if(this._scrollHeight!==t){this.refresh()}if(e>=n){var o=this._targets[this._targets.length-1];if(this._activeTarget!==o){this._activate(o)}return}if(this._activeTarget&&e<this._offsets[0]&&0<this._offsets[0]){this._activeTarget=null;this._clear();return}for(var a=this._offsets.length,r;a--;){r=this._activeTarget!==this._targets[a]&&e>=this._offsets[a]&&("undefined"==typeof this._offsets[a+1]||e<this._offsets[a+1]);if(r){this._activate(this._targets[a])}}};n._activate=function(e){this._activeTarget=e;this._clear();var n=this._selector.split(",").map(function(t){return t+"[data-target=\""+e+"\"],"+t+"[href=\""+e+"\"]"}),o=t([].slice.call(document.querySelectorAll(n.join(","))));if(o.hasClass("dropdown-item")){o.closest(".dropdown").find(".dropdown-toggle").addClass(bt);o.addClass(bt)}else{o.addClass(bt);o.parents(Ct).prev(Tt+", "+St).addClass(bt);o.parents(Ct).prev(".nav-item").children(Tt).addClass(bt)}t(this._scrollElement).trigger("activate"+ht,{relatedTarget:e})};n._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter(function(e){return e.classList.contains(bt)}).forEach(function(e){return e.classList.remove(bt)})};e._jQueryInterface=function(n){return this.each(function(){var o=t(this).data(pt),i="object"===_typeof(n)&&n;if(!o){o=new e(this,i);t(this).data(pt,o)}if("string"==typeof n){if("undefined"==typeof o[n]){throw new TypeError("No method named \""+n+"\"")}o[n]()}})};i(e,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return vt}}]);return e}();t(window).on("load"+ht+".data-api",function(){for(var e=[].slice.call(document.querySelectorAll("[data-spy=\"scroll\"]")),n=e.length,o=n,a;o--;){a=t(e[o]);Dt._jQueryInterface.call(a,a.data())}});t.fn.scrollspy=Dt._jQueryInterface;t.fn.scrollspy.Constructor=Dt;t.fn.scrollspy.noConflict=function(){t.fn.scrollspy=yt;return Dt._jQueryInterface};var kt="bs.tab",Nt="."+kt,At=t.fn.tab,It="active",Ot="fade",jt="show",Pt=".active",Lt="> li > .active",Rt=function(){function e(e){this._element=e}var n=e.prototype;n.show=function(){var e=this;if(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&t(this._element).hasClass(It)||t(this._element).hasClass("disabled")){return}var n,o,i=t(this._element).closest(".nav, .list-group")[0],a=u.getSelectorFromElement(this._element);if(i){var r="UL"===i.nodeName||"OL"===i.nodeName?Lt:Pt;o=t.makeArray(t(i).find(r));o=o[o.length-1]}var l=t.Event("hide"+Nt,{relatedTarget:this._element}),s=t.Event("show"+Nt,{relatedTarget:o});if(o){t(o).trigger(l)}t(this._element).trigger(s);if(s.isDefaultPrevented()||l.isDefaultPrevented()){return}if(a){n=document.querySelector(a)}this._activate(this._element,i);var d=function(){var n=t.Event("hidden"+Nt,{relatedTarget:e._element}),i=t.Event("shown"+Nt,{relatedTarget:o});t(o).trigger(n);t(e._element).trigger(i)};if(n){this._activate(n,n.parentNode,d)}else{d()}};n.dispose=function(){t.removeData(this._element,kt);this._element=null};n._activate=function(e,n,o){var i=this,a=n&&("UL"===n.nodeName||"OL"===n.nodeName)?t(n).find(Lt):t(n).children(Pt),r=a[0],l=o&&r&&t(r).hasClass(Ot),s=function(){return i._transitionComplete(e,r,o)};if(r&&l){var d=u.getTransitionDurationFromElement(r);t(r).removeClass(jt).one(u.TRANSITION_END,s).emulateTransitionEnd(d)}else{s()}};n._transitionComplete=function(e,n,o){if(n){t(n).removeClass(It);var i=t(n.parentNode).find("> .dropdown-menu .active")[0];if(i){t(i).removeClass(It)}if("tab"===n.getAttribute("role")){n.setAttribute("aria-selected",!1)}}t(e).addClass(It);if("tab"===e.getAttribute("role")){e.setAttribute("aria-selected",!0)}u.reflow(e);if(e.classList.contains(Ot)){e.classList.add(jt)}if(e.parentNode&&t(e.parentNode).hasClass("dropdown-menu")){var a=t(e).closest(".dropdown")[0];if(a){var r=[].slice.call(a.querySelectorAll(".dropdown-toggle"));t(r).addClass(It)}e.setAttribute("aria-expanded",!0)}if(o){o()}};e._jQueryInterface=function(n){return this.each(function(){var o=t(this),i=o.data(kt);if(!i){i=new e(this);o.data(kt,i)}if("string"==typeof n){if("undefined"==typeof i[n]){throw new TypeError("No method named \""+n+"\"")}i[n]()}})};i(e,null,[{key:"VERSION",get:function(){return"4.5.0"}}]);return e}();t(document).on("click"+Nt+".data-api","[data-toggle=\"tab\"], [data-toggle=\"pill\"], [data-toggle=\"list\"]",function(e){e.preventDefault();Rt._jQueryInterface.call(t(this),"show")});t.fn.tab=Rt._jQueryInterface;t.fn.tab.Constructor=Rt;t.fn.tab.noConflict=function(){t.fn.tab=At;return Rt._jQueryInterface};var xt="bs.toast",qt="."+xt,Ft=t.fn.toast,Qt="click.dismiss"+qt,Ht="hide",Bt="show",Ut="showing",Mt={animation:"boolean",autohide:"boolean",delay:"number"},Wt={animation:!0,autohide:!0,delay:500},Vt=function(){function e(e,t){this._element=e;this._config=this._getConfig(t);this._timeout=null;this._setListeners()}var n=e.prototype;n.show=function(){var e=this,n=t.Event("show"+qt);t(this._element).trigger(n);if(n.isDefaultPrevented()){return}if(this._config.animation){this._element.classList.add("fade")}var o=function(){e._element.classList.remove(Ut);e._element.classList.add(Bt);t(e._element).trigger("shown"+qt);if(e._config.autohide){e._timeout=setTimeout(function(){e.hide()},e._config.delay)}};this._element.classList.remove(Ht);u.reflow(this._element);this._element.classList.add(Ut);if(this._config.animation){var i=u.getTransitionDurationFromElement(this._element);t(this._element).one(u.TRANSITION_END,o).emulateTransitionEnd(i)}else{o()}};n.hide=function(){if(!this._element.classList.contains(Bt)){return}var e=t.Event("hide"+qt);t(this._element).trigger(e);if(e.isDefaultPrevented()){return}this._close()};n.dispose=function(){clearTimeout(this._timeout);this._timeout=null;if(this._element.classList.contains(Bt)){this._element.classList.remove(Bt)}t(this._element).off(Qt);t.removeData(this._element,xt);this._element=null;this._config=null};n._getConfig=function(e){e=l(l(l({},Wt),t(this._element).data()),"object"===_typeof(e)&&e?e:{});u.typeCheckConfig("toast",e,this.constructor.DefaultType);return e};n._setListeners=function(){var e=this;t(this._element).on(Qt,"[data-dismiss=\"toast\"]",function(){return e.hide()})};n._close=function(){var e=this,n=function(){e._element.classList.add(Ht);t(e._element).trigger("hidden"+qt)};this._element.classList.remove(Bt);if(this._config.animation){var o=u.getTransitionDurationFromElement(this._element);t(this._element).one(u.TRANSITION_END,n).emulateTransitionEnd(o)}else{n()}};e._jQueryInterface=function(n){return this.each(function(){var o=t(this),i=o.data(xt),a="object"===_typeof(n)&&n;if(!i){i=new e(this,a);o.data(xt,i)}if("string"==typeof n){if("undefined"==typeof i[n]){throw new TypeError("No method named \""+n+"\"")}i[n](this)}})};i(e,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"DefaultType",get:function(){return Mt}},{key:"Default",get:function(){return Wt}}]);return e}();t.fn.toast=Vt._jQueryInterface;t.fn.toast.Constructor=Vt;t.fn.toast.noConflict=function(){t.fn.toast=Ft;return Vt._jQueryInterface};e.Alert=v;e.Button=N;e.Carousel=B;e.Collapse=ee;e.Dropdown=Ce;e.Modal=Ue;e.Popover=ut;e.Scrollspy=Dt;e.Tab=Rt;e.Toast=Vt;e.Tooltip=rt;e.Util=u;Object.defineProperty(e,"__esModule",{value:!0})});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t(function(){try{return require("moment")}catch(t){}}()):"function"==typeof define&&define.amd?define ("theme_coursemos/chart",["require"],function(e){return t(function(){try{return e("moment")}catch(t){}}())}):(e=e||self,e.Chart=t(e.moment))})(this,function(e){'use strict';e=e&&e.hasOwnProperty("default")?e["default"]:e;var Wt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Vt=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){var a={};for(var i in Wt){if(Wt.hasOwnProperty(i)){a[Wt[i]]=i}}var o=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var n in o){if(o.hasOwnProperty(n)){if(!("channels"in o[n])){throw new Error("missing channels property: "+n)}if(!("labels"in o[n])){throw new Error("missing channel labels property: "+n)}if(o[n].labels.length!==o[n].channels){throw new Error("channel and label counts mismatch: "+n)}var r=o[n].channels,l=o[n].labels;delete o[n].channels;delete o[n].labels;Object.defineProperty(o[n],"channels",{value:r});Object.defineProperty(o[n],"labels",{value:l})}}o.rgb.hsl=function(e){var t=e[0]/255,a=e[1]/255,i=e[2]/255,o=Math.min(t,a,i),n=Math.max(t,a,i),r=n-o,d,g,c;if(n===o){d=0}else if(t===n){d=(a-i)/r}else if(a===n){d=2+(i-t)/r}else if(i===n){d=4+(t-a)/r}d=Math.min(60*d,360);if(0>d){d+=360}c=(o+n)/2;if(n===o){g=0}else if(.5>=c){g=r/(n+o)}else{g=r/(2-n-o)}return[d,100*g,100*c]};o.rgb.hsv=function(e){var t,a,i,o,n,l=e[0]/255,r=e[1]/255,d=e[2]/255,g=Math.max(l,r,d),p=g-Math.min(l,r,d),u=function(e){return(g-e)/6/p+1/2};if(0===p){o=n=0}else{n=p/g;t=u(l);a=u(r);i=u(d);if(l===g){o=i-a}else if(r===g){o=1/3+t-i}else if(d===g){o=2/3+a-t}if(0>o){o+=1}else if(1<o){o-=1}}return[360*o,100*n,100*g]};o.rgb.hwb=function(e){var t=e[0],a=e[1],i=e[2],n=o.rgb.hsl(e)[0],r=1/255*Math.min(t,Math.min(a,i));i=1-1/255*Math.max(t,Math.max(a,i));return[n,100*r,100*i]};o.rgb.cmyk=function(e){var t=e[0]/255,a=e[1]/255,i=e[2]/255,o,n,r,l;l=Math.min(1-t,1-a,1-i);o=(1-t-l)/(1-l)||0;n=(1-a-l)/(1-l)||0;r=(1-i-l)/(1-l)||0;return[100*o,100*n,100*r,100*l]};function t(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2)}o.rgb.keyword=function(e){var i=a[e];if(i){return i}var o=1/0,n;for(var r in Wt){if(Wt.hasOwnProperty(r)){var l=Wt[r],s=t(e,l);if(s<o){o=s;n=r}}}return n};o.keyword.rgb=function(e){return Wt[e]};o.rgb.xyz=function(e){var t=e[0]/255,a=e[1]/255,i=e[2]/255;t=.04045<t?Math.pow((t+.055)/1.055,2.4):t/12.92;a=.04045<a?Math.pow((a+.055)/1.055,2.4):a/12.92;i=.04045<i?Math.pow((i+.055)/1.055,2.4):i/12.92;var o=.4124*t+.3576*a+.1805*i,n=.2126*t+.7152*a+.0722*i,l=.0193*t+.1192*a+.9505*i;return[100*o,100*n,100*l]};o.rgb.lab=function(e){var t=o.rgb.xyz(e),i=t[0],n=t[1],r=t[2],s,d,g;i/=95.047;n/=100;r/=108.883;i=.008856<i?Math.pow(i,1/3):7.787*i+16/116;n=.008856<n?Math.pow(n,1/3):7.787*n+16/116;r=.008856<r?Math.pow(r,1/3):7.787*r+16/116;s=116*n-16;d=500*(i-n);g=200*(n-r);return[s,d,g]};o.hsl.rgb=function(e){var t=e[0]/360,a=e[1]/100,o=e[2]/100,n,r,l,s,d;if(0===a){d=255*o;return[d,d,d]}if(.5>o){r=o*(1+a)}else{r=o+a-o*a}n=2*o-r;s=[0,0,0];for(var g=0;3>g;g++){l=t+1/3*-(g-1);if(0>l){l++}if(1<l){l--}if(1>6*l){d=n+6*(r-n)*l}else if(1>2*l){d=r}else if(2>3*l){d=n+6*((r-n)*(2/3-l))}else{d=n}s[g]=255*d}return s};o.hsl.hsv=function(e){var t=e[0],a=e[1]/100,i=e[2]/100,o=a,n=Math.max(i,.01),r,d;i*=2;a*=1>=i?i:2-i;o*=1>=n?n:2-n;d=(i+a)/2;r=0===i?2*o/(n+o):2*a/(i+a);return[t,100*r,100*d]};o.hsv.rgb=function(e){var a=e[0]/60,i=e[1]/100,o=e[2]/100,n=Math.floor(a)%6,r=a-Math.floor(a),l=255*o*(1-i),s=255*o*(1-i*r),d=255*o*(1-i*(1-r));o*=255;switch(n){case 0:return[o,d,l];case 1:return[s,o,l];case 2:return[l,o,d];case 3:return[l,s,o];case 4:return[d,l,o];case 5:return[o,l,s];}};o.hsv.hsl=function(e){var t=e[0],a=e[1]/100,i=e[2]/100,o=Math.max(i,.01),n,r,s;s=(2-a)*i;n=(2-a)*o;r=a*o;r/=1>=n?n:2-n;r=r||0;s/=2;return[t,100*r,100*s]};o.hwb.rgb=function(e){var t=e[0]/360,a=e[1]/100,o=e[2]/100,l=a+o,s,d,c,h;if(1<l){a/=l;o/=l}s=Math.floor(6*t);d=1-o;c=6*t-s;if(0!=(1&s)){c=1-c}h=a+c*(d-a);var p,u,m;switch(s){default:case 6:case 0:p=d;u=h;m=a;break;case 1:p=h;u=d;m=a;break;case 2:p=a;u=d;m=h;break;case 3:p=a;u=h;m=d;break;case 4:p=h;u=a;m=d;break;case 5:p=d;u=a;m=h;break;}return[255*p,255*u,255*m]};o.cmyk.rgb=function(e){var t=e[0]/100,a=e[1]/100,i=e[2]/100,o=e[3]/100,n,l,s;n=1-Math.min(1,t*(1-o)+o);l=1-Math.min(1,a*(1-o)+o);s=1-Math.min(1,i*(1-o)+o);return[255*n,255*l,255*s]};o.xyz.rgb=function(e){var t=e[0]/100,a=e[1]/100,i=e[2]/100,o,n,l;o=3.2406*t+-1.5372*a+-.4986*i;n=-.9689*t+1.8758*a+.0415*i;l=.0557*t+-.204*a+1.057*i;o=.0031308<o?1.055*Math.pow(o,1/2.4)-.055:12.92*o;n=.0031308<n?1.055*Math.pow(n,1/2.4)-.055:12.92*n;l=.0031308<l?1.055*Math.pow(l,1/2.4)-.055:12.92*l;o=Math.min(Math.max(0,o),1);n=Math.min(Math.max(0,n),1);l=Math.min(Math.max(0,l),1);return[255*o,255*n,255*l]};o.xyz.lab=function(e){var t=e[0],i=e[1],o=e[2],n,r,s;t/=95.047;i/=100;o/=108.883;t=.008856<t?Math.pow(t,1/3):7.787*t+16/116;i=.008856<i?Math.pow(i,1/3):7.787*i+16/116;o=.008856<o?Math.pow(o,1/3):7.787*o+16/116;n=116*i-16;r=500*(t-i);s=200*(i-o);return[n,r,s]};o.lab.xyz=function(e){var t=e[0],i=e[1],a=e[2],o,n,r;n=(t+16)/116;o=i/500+n;r=n-a/200;var l=Math.pow(n,3),s=Math.pow(o,3),d=Math.pow(r,3);n=.008856<l?l:(n-16/116)/7.787;o=.008856<s?s:(o-16/116)/7.787;r=.008856<d?d:(r-16/116)/7.787;o*=95.047;n*=100;r*=108.883;return[o,n,r]};o.lab.lch=function(e){var t=e[0],i=e[1],a=e[2],o,n,r;o=Math.atan2(a,i);n=360*o/2/Math.PI;if(0>n){n+=360}r=Math.sqrt(i*i+a*a);return[t,r,n]};o.lch.lab=function(e){var t=e[0],i=e[1],o=e[2],n,r,l;l=2*(o/360)*Math.PI;n=i*Math.cos(l);r=i*Math.sin(l);return[t,n,r]};o.rgb.ansi16=function(e){var t=e[0],a=e[1],i=e[2],n=1 in arguments?arguments[1]:o.rgb.hsv(e)[2];n=Math.round(n/50);if(0===n){return 30}var r=30+(Math.round(i/255)<<2|Math.round(a/255)<<1|Math.round(t/255));if(2===n){r+=60}return r};o.hsv.ansi16=function(e){return o.rgb.ansi16(o.hsv.rgb(e),e[2])};o.rgb.ansi256=function(e){var t=e[0],a=e[1],i=e[2];if(t===a&&a===i){if(8>t){return 16}if(248<t){return 231}return Math.round(24*((t-8)/247))+232}var o=16+36*Math.round(5*(t/255))+6*Math.round(5*(a/255))+Math.round(5*(i/255));return o};o.ansi16.rgb=function(e){var t=e%10;if(0==t||7===t){if(50<e){t+=3.5}t=255*(t/10.5);return[t,t,t]}var a=.5*(~~(50<e)+1),i=255*((1&t)*a),o=255*((1&t>>1)*a),n=255*((1&t>>2)*a);return[i,o,n]};o.ansi256.rgb=function(e){if(232<=e){var t=10*(e-232)+8;return[t,t,t]}e-=16;var a,i=255*(Math.floor(e/36)/5),o=255*(Math.floor((a=e%36)/6)/5),n=255*(a%6/5);return[i,o,n]};o.rgb.hex=function(e){var t=((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2])),a=t.toString(16).toUpperCase();return"000000".substring(a.length)+a};o.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t){return[0,0,0]}var a=t[0];if(3===t[0].length){a=a.split("").map(function(e){return e+e}).join("")}var i=parseInt(a,16);return[255&i>>16,255&i>>8,255&i]};o.rgb.hcg=function(e){var t=e[0]/255,a=e[1]/255,i=e[2]/255,o=Math.max(Math.max(t,a),i),n=Math.min(Math.min(t,a),i),r=o-n,l,s;if(1>r){l=n/(1-r)}else{l=0}if(0>=r){s=0}else if(o===t){s=(a-i)/r%6}else if(o===a){s=2+(i-t)/r}else{s=4+(t-a)/r+4}s/=6;s%=1;return[360*s,100*r,100*l]};o.hsl.hcg=function(e){var t=e[1]/100,a=e[2]/100,i=1,o=0;if(.5>a){i=2*t*a}else{i=2*t*(1-a)}if(1>i){o=(a-.5*i)/(1-i)}return[e[0],100*i,100*o]};o.hsv.hcg=function(e){var t=e[1]/100,a=e[2]/100,i=t*a,o=0;if(1>i){o=(a-i)/(1-i)}return[e[0],100*i,100*o]};o.hcg.rgb=function(e){var t=e[0]/360,a=e[1]/100,i=e[2]/100;if(0===a){return[255*i,255*i,255*i]}var o=[0,0,0],n=6*(t%1),r=n%1,l=1-r,s=0;switch(Math.floor(n)){case 0:o[0]=1;o[1]=r;o[2]=0;break;case 1:o[0]=l;o[1]=1;o[2]=0;break;case 2:o[0]=0;o[1]=1;o[2]=r;break;case 3:o[0]=0;o[1]=l;o[2]=1;break;case 4:o[0]=r;o[1]=0;o[2]=1;break;default:o[0]=1;o[1]=0;o[2]=l;}s=(1-a)*i;return[255*(a*o[0]+s),255*(a*o[1]+s),255*(a*o[2]+s)]};o.hcg.hsv=function(e){var t=e[1]/100,a=e[2]/100,i=t+a*(1-t),o=0;if(0<i){o=t/i}return[e[0],100*o,100*i]};o.hcg.hsl=function(e){var t=e[1]/100,a=e[2]/100,i=a*(1-t)+.5*t,o=0;if(0<i&&.5>i){o=t/(2*i)}else if(.5<=i&&1>i){o=t/(2*(1-i))}return[e[0],100*o,100*i]};o.hcg.hwb=function(e){var t=e[1]/100,a=e[2]/100,i=t+a*(1-t);return[e[0],100*(i-t),100*(1-i)]};o.hwb.hcg=function(e){var t=e[1]/100,a=e[2]/100,i=1-a,o=i-t,n=0;if(1>o){n=(i-o)/(1-o)}return[e[0],100*o,100*n]};o.apple.rgb=function(e){return[255*(e[0]/65535),255*(e[1]/65535),255*(e[2]/65535)]};o.rgb.apple=function(e){return[65535*(e[0]/255),65535*(e[1]/255),65535*(e[2]/255)]};o.gray.rgb=function(e){return[255*(e[0]/100),255*(e[0]/100),255*(e[0]/100)]};o.gray.hsl=o.gray.hsv=function(e){return[0,0,e[0]]};o.gray.hwb=function(e){return[0,100,e[0]]};o.gray.cmyk=function(e){return[0,0,0,e[0]]};o.gray.lab=function(e){return[e[0],0,0]};o.gray.hex=function(e){var t=255&Math.round(255*(e[0]/100)),a=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(a.length)+a};o.rgb.gray=function(e){var t=(e[0]+e[1]+e[2])/3;return[100*(t/255)]}}),Mt=Vt.rgb,Ht=Vt.hsl,Nt=Vt.hsv,jt=Vt.hwb,Yt=Vt.cmyk,qt=Vt.xyz,Ut=Vt.lab,Kt=Vt.lch,Xt=Vt.hex,Gt=Vt.keyword,Zt=Vt.ansi16,Jt=Vt.ansi256,$t=Vt.hcg,Qt=Vt.apple,ea=Vt.gray;function t(){for(var e={},t=Object.keys(Vt),a=t.length,o=0;o<a;o++){e[t[o]]={distance:-1,parent:null}}return e}function a(e){var a=t(),o=[e];a[e].distance=0;while(o.length){for(var n=o.pop(),r=Object.keys(Vt[n]),l=r.length,s=0;s<l;s++){var d=r[s],g=a[d];if(-1===g.distance){g.distance=a[n].distance+1;g.parent=n;o.unshift(d)}}}return a}function i(e,t){return function(a){return t(e(a))}}function o(e,t){var a=[t[e].parent,e],o=Vt[t[e].parent][e],n=t[e].parent;while(t[n].parent){a.unshift(t[n].parent);o=i(Vt[t[n].parent][n],o);n=t[n].parent}o.conversion=a;return o}var ta=function(e){for(var t=a(e),n={},r=Object.keys(t),l=r.length,s=0;s<l;s++){var d=r[s],g=t[d];if(null===g.parent){continue}n[d]=o(d,t)}return n},aa={},ia=Object.keys(Vt);function n(e){var t=function(t){if(t===void 0||null===t){return t}if(1<arguments.length){t=Array.prototype.slice.call(arguments)}return e(t)};if("conversion"in e){t.conversion=e.conversion}return t}function r(e){var t=function(t){if(t===void 0||null===t){return t}if(1<arguments.length){t=Array.prototype.slice.call(arguments)}var a=e(t);if("object"===_typeof(a)){for(var o=a.length,n=0;n<o;n++){a[n]=Math.round(a[n])}}return a};if("conversion"in e){t.conversion=e.conversion}return t}ia.forEach(function(e){aa[e]={};Object.defineProperty(aa[e],"channels",{value:Vt[e].channels});Object.defineProperty(aa[e],"labels",{value:Vt[e].labels});var t=ta(e),a=Object.keys(t);a.forEach(function(a){var i=t[a];aa[e][a]=r(i);aa[e][a].raw=n(i)})});var oa={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},na={getRgba:l,getHsla:s,getRgb:function(e){var t=l(e);return t&&t.slice(0,3)},getHsl:function(e){var t=s(e);return t&&t.slice(0,3)},getHwb:d,getAlpha:function(e){var t=l(e);if(t){return t[3]}else if(t=s(e)){return t[3]}else if(t=d(e)){return t[3]}},hexString:function(e,t){var t=t!==void 0&&3===e.length?t:e[3];return"#"+u(e[0])+u(e[1])+u(e[2])+(0<=t&&1>t?u(Math.round(255*t)):"")},rgbString:function(e,t){if(1>t||e[3]&&1>e[3]){return g(e,t)}return"rgb("+e[0]+", "+e[1]+", "+e[2]+")"},rgbaString:g,percentString:function(e,t){if(1>t||e[3]&&1>e[3]){return c(e,t)}var a=Math.round(100*(e[0]/255)),i=Math.round(100*(e[1]/255)),o=Math.round(100*(e[2]/255));return"rgb("+a+"%, "+i+"%, "+o+"%)"},percentaString:c,hslString:function(e,t){if(1>t||e[3]&&1>e[3]){return h(e,t)}return"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)"},hslaString:h,hwbString:function(e,t){if(t===void 0){t=e[3]!==void 0?e[3]:1}return"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+(t!==void 0&&1!==t?", "+t:"")+")"},keyword:function(e){return ra[e.slice(0,3)]}};function l(e){if(!e){return}var t=[0,0,0],o=1,n=e.match(/^#([a-fA-F0-9]{3,4})$/i),r="";if(n){n=n[1];r=n[3];for(var l=0;l<t.length;l++){t[l]=parseInt(n[l]+n[l],16)}if(r){o=Math.round(100*(parseInt(r+r,16)/255))/100}}else if(n=e.match(/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i)){r=n[2];n=n[1];for(var l=0;l<t.length;l++){t[l]=parseInt(n.slice(2*l,2*l+2),16)}if(r){o=Math.round(100*(parseInt(r,16)/255))/100}}else if(n=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(var l=0;l<t.length;l++){t[l]=parseInt(n[l+1])}o=parseFloat(n[4])}else if(n=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(var l=0;l<t.length;l++){t[l]=Math.round(2.55*parseFloat(n[l+1]))}o=parseFloat(n[4])}else if(n=e.match(/(\w+)/)){if("transparent"==n[1]){return[0,0,0,0]}t=oa[n[1]];if(!t){return}}for(var l=0;l<t.length;l++){t[l]=p(t[l],0,255)}if(!o&&0!=o){o=1}else{o=p(o,0,1)}t[3]=o;return t}function s(e){if(!e){return}var t=e.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(t){var i=parseFloat(t[4]),o=p(parseInt(t[1]),0,360),n=p(parseFloat(t[2]),0,100),r=p(parseFloat(t[3]),0,100),l=p(isNaN(i)?1:i,0,1);return[o,n,r,l]}}function d(e){if(!e){return}var t=e.match(/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(t){var i=parseFloat(t[4]),o=p(parseInt(t[1]),0,360),n=p(parseFloat(t[2]),0,100),r=p(parseFloat(t[3]),0,100),l=p(isNaN(i)?1:i,0,1);return[o,n,r,l]}}function g(e,t){if(t===void 0){t=e[3]!==void 0?e[3]:1}return"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+t+")"}function c(e,t){var a=Math.round(100*(e[0]/255)),i=Math.round(100*(e[1]/255)),o=Math.round(100*(e[2]/255));return"rgba("+a+"%, "+i+"%, "+o+"%, "+(t||e[3]||1)+")"}function h(e,t){if(t===void 0){t=e[3]!==void 0?e[3]:1}return"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+t+")"}function p(e,t,a){return Math.min(Math.max(t,e),a)}function u(e){var t=e.toString(16).toUpperCase();return 2>t.length?"0"+t:t}var ra={};for(var la in oa){ra[oa[la]]=la}var sa=function(e){if(e instanceof sa){return e}if(!(this instanceof sa)){return new sa(e)}this.valid=!1;this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1};var t;if("string"==typeof e){t=na.getRgba(e);if(t){this.setValues("rgb",t)}else if(t=na.getHsla(e)){this.setValues("hsl",t)}else if(t=na.getHwb(e)){this.setValues("hwb",t)}}else if("object"===_typeof(e)){t=e;if(t.r!==void 0||t.red!==void 0){this.setValues("rgb",t)}else if(t.l!==void 0||t.lightness!==void 0){this.setValues("hsl",t)}else if(t.v!==void 0||t.value!==void 0){this.setValues("hsv",t)}else if(t.w!==void 0||t.whiteness!==void 0){this.setValues("hwb",t)}else if(t.c!==void 0||t.cyan!==void 0){this.setValues("cmyk",t)}}};sa.prototype={isValid:function isValid(){return this.valid},rgb:function rgb(){return this.setSpace("rgb",arguments)},hsl:function hsl(){return this.setSpace("hsl",arguments)},hsv:function hsv(){return this.setSpace("hsv",arguments)},hwb:function hwb(){return this.setSpace("hwb",arguments)},cmyk:function cmyk(){return this.setSpace("cmyk",arguments)},rgbArray:function rgbArray(){return this.values.rgb},hslArray:function hslArray(){return this.values.hsl},hsvArray:function hsvArray(){return this.values.hsv},hwbArray:function hwbArray(){var e=this.values;if(1!==e.alpha){return e.hwb.concat([e.alpha])}return e.hwb},cmykArray:function cmykArray(){return this.values.cmyk},rgbaArray:function rgbaArray(){var e=this.values;return e.rgb.concat([e.alpha])},hslaArray:function hslaArray(){var e=this.values;return e.hsl.concat([e.alpha])},alpha:function alpha(e){if(e===void 0){return this.values.alpha}this.setValues("alpha",e);return this},red:function red(e){return this.setChannel("rgb",0,e)},green:function green(e){return this.setChannel("rgb",1,e)},blue:function blue(e){return this.setChannel("rgb",2,e)},hue:function hue(e){if(e){e%=360;e=0>e?360+e:e}return this.setChannel("hsl",0,e)},saturation:function saturation(e){return this.setChannel("hsl",1,e)},lightness:function lightness(e){return this.setChannel("hsl",2,e)},saturationv:function saturationv(e){return this.setChannel("hsv",1,e)},whiteness:function whiteness(e){return this.setChannel("hwb",1,e)},blackness:function blackness(e){return this.setChannel("hwb",2,e)},value:function value(e){return this.setChannel("hsv",2,e)},cyan:function cyan(e){return this.setChannel("cmyk",0,e)},magenta:function magenta(e){return this.setChannel("cmyk",1,e)},yellow:function yellow(e){return this.setChannel("cmyk",2,e)},black:function black(e){return this.setChannel("cmyk",3,e)},hexString:function hexString(){return na.hexString(this.values.rgb)},rgbString:function rgbString(){return na.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return na.rgbaString(this.values.rgb,this.values.alpha)},percentString:function percentString(){return na.percentString(this.values.rgb,this.values.alpha)},hslString:function hslString(){return na.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return na.hslaString(this.values.hsl,this.values.alpha)},hwbString:function hwbString(){return na.hwbString(this.values.hwb,this.values.alpha)},keyword:function keyword(){return na.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function rgbNumber(){var e=this.values.rgb;return e[0]<<16|e[1]<<8|e[2]},luminosity:function luminosity(){for(var e=this.values.rgb,t=[],a=0,o;a<e.length;a++){o=e[a]/255;t[a]=.03928>=o?o/12.92:Math.pow((o+.055)/1.055,2.4)}return .2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function contrast(e){var t=this.luminosity(),a=e.luminosity();if(t>a){return(t+.05)/(a+.05)}return(a+.05)/(t+.05)},level:function level(e){var t=this.contrast(e);if(7.1<=t){return"AAA"}return 4.5<=t?"AA":""},dark:function dark(){var e=this.values.rgb,t=(299*e[0]+587*e[1]+114*e[2])/1e3;return 128>t},light:function light(){return!this.dark()},negate:function negate(){for(var e=[],t=0;3>t;t++){e[t]=255-this.values.rgb[t]}this.setValues("rgb",e);return this},lighten:function lighten(e){var t=this.values.hsl;t[2]+=t[2]*e;this.setValues("hsl",t);return this},darken:function darken(e){var t=this.values.hsl;t[2]-=t[2]*e;this.setValues("hsl",t);return this},saturate:function saturate(e){var t=this.values.hsl;t[1]+=t[1]*e;this.setValues("hsl",t);return this},desaturate:function desaturate(e){var t=this.values.hsl;t[1]-=t[1]*e;this.setValues("hsl",t);return this},whiten:function whiten(e){var t=this.values.hwb;t[1]+=t[1]*e;this.setValues("hwb",t);return this},blacken:function blacken(e){var t=this.values.hwb;t[2]+=t[2]*e;this.setValues("hwb",t);return this},greyscale:function greyscale(){var e=this.values.rgb,t=.3*e[0]+.59*e[1]+.11*e[2];this.setValues("rgb",[t,t,t]);return this},clearer:function clearer(e){var t=this.values.alpha;this.setValues("alpha",t-t*e);return this},opaquer:function opaquer(e){var t=this.values.alpha;this.setValues("alpha",t+t*e);return this},rotate:function rotate(e){var t=this.values.hsl,a=(t[0]+e)%360;t[0]=0>a?360+a:a;this.setValues("hsl",t);return this},mix:function mix(e,t){var i=this,o=e,n=t===void 0?.5:t,r=2*n-1,l=i.alpha()-o.alpha(),a=((-1==r*l?r:(r+l)/(1+r*l))+1)/2,s=1-a;return this.rgb(a*i.red()+s*o.red(),a*i.green()+s*o.green(),a*i.blue()+s*o.blue()).alpha(i.alpha()*n+o.alpha()*(1-n))},toJSON:function toJSON(){return this.rgb()},clone:function clone(){var e=new sa,t=this.values,a=e.values,i,o;for(var n in t){if(t.hasOwnProperty(n)){i=t[n];o={}.toString.call(i);if("[object Array]"===o){a[n]=i.slice(0)}else if("[object Number]"===o){a[n]=i}else{console.error("unexpected color value:",i)}}}return e}};sa.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]};sa.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]};sa.prototype.getValues=function(e){for(var t=this.values,a={},o=0;o<e.length;o++){a[e.charAt(o)]=t[e][o]}if(1!==t.alpha){a.a=t.alpha}return a};sa.prototype.setValues=function(e,t){var a=this.values,o=this.spaces,n=this.maxes,r=1,l;this.valid=!0;if("alpha"===e){r=t}else if(t.length){a[e]=t.slice(0,e.length);r=t[e.length]}else if(t[e.charAt(0)]!==void 0){for(l=0;l<e.length;l++){a[e][l]=t[e.charAt(l)]}r=t.a}else if(t[o[e][0]]!==void 0){var s=o[e];for(l=0;l<e.length;l++){a[e][l]=t[s[l]]}r=t.alpha}a.alpha=Math.max(0,Math.min(1,r===void 0?a.alpha:r));if("alpha"===e){return!1}var d;for(l=0;l<e.length;l++){d=Math.max(0,Math.min(n[e][l],a[e][l]));a[e][l]=Math.round(d)}for(var g in o){if(g!==e){a[g]=aa[e][g](a[e])}}return!0};sa.prototype.setSpace=function(e,t){var a=t[0];if(a===void 0){return this.getValues(e)}if("number"==typeof a){a=Array.prototype.slice.call(t)}this.setValues(e,a);return this};sa.prototype.setChannel=function(e,t,a){var i=this.values[e];if(a===void 0){return i[t]}else if(a===i[t]){return this}i[t]=a;this.setValues(e,i);return this};if("undefined"!=typeof window){window.Color=sa}var da=sa;function m(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}var ga={noop:function(){},uid:function(){var e=0;return function(){return e++}}(),isNullOrUndef:function(e){return null===e||"undefined"==typeof e},isArray:function(e){if(Array.isArray&&Array.isArray(e)){return!0}var t=Object.prototype.toString.call(e);if("[object"===t.substr(0,7)&&"Array]"===t.substr(-6)){return!0}return!1},isObject:function isObject(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)},isFinite:function(e){function t(){return e.apply(this,arguments)}t.toString=function(){return e.toString()};return t}(function(e){return("number"==typeof e||e instanceof Number)&&isFinite(e)}),valueOrDefault:function(e,t){return"undefined"==typeof e?t:e},valueAtIndexOrDefault:function(e,t,a){return ga.valueOrDefault(ga.isArray(e)?e[t]:e,a)},callback:function callback(e,t,a){if(e&&"function"==typeof e.call){return e.apply(a,t)}},each:function each(e,t,a,o){var n,r,l;if(ga.isArray(e)){r=e.length;if(o){for(n=r-1;0<=n;n--){t.call(a,e[n],n)}}else{for(n=0;n<r;n++){t.call(a,e[n],n)}}}else if(ga.isObject(e)){l=Object.keys(e);r=l.length;for(n=0;n<r;n++){t.call(a,e[l[n]],l[n])}}},arrayEquals:function arrayEquals(e,t){var a,o,n,r;if(!e||!t||e.length!==t.length){return!1}for(a=0,o=e.length;a<o;++a){n=e[a];r=t[a];if(n instanceof Array&&r instanceof Array){if(!ga.arrayEquals(n,r)){return!1}}else if(n!==r){return!1}}return!0},clone:function clone(e){if(ga.isArray(e)){return e.map(ga.clone)}if(ga.isObject(e)){var t=Object.create(e),a=Object.keys(e),i=a.length,o=0;for(;o<i;++o){t[a[o]]=ga.clone(e[a[o]])}return t}return e},_merger:function _merger(e,t,a,i){if(!m(e)){return}var o=t[e],n=a[e];if(ga.isObject(o)&&ga.isObject(n)){ga.merge(o,n,i)}else{t[e]=ga.clone(n)}},_mergerIf:function _mergerIf(e,t,a){if(!m(e)){return}var i=t[e],o=a[e];if(ga.isObject(i)&&ga.isObject(o)){ga.mergeIf(i,o)}else if(!t.hasOwnProperty(e)){t[e]=ga.clone(o)}},merge:function(e,t,a){var o=ga.isArray(t)?t:[t],n=o.length,r,l,s,d,g;if(!ga.isObject(e)){return e}a=a||{};r=a.merger||ga._merger;for(l=0;l<n;++l){t=o[l];if(!ga.isObject(t)){continue}s=Object.keys(t);for(g=0,d=s.length;g<d;++g){r(s[g],e,t,a)}}return e},mergeIf:function mergeIf(e,t){return ga.merge(e,t,{merger:ga._mergerIf})},extend:Object.assign||function(e){return ga.merge(e,[].slice.call(arguments,1),{merger:function merger(e,t,a){t[e]=a[e]}})},inherits:function inherits(e){var t=this,a=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return t.apply(this,arguments)},i=function(){this.constructor=a};i.prototype=t.prototype;a.prototype=new i;a.extend=ga.inherits;if(e){ga.extend(a.prototype,e)}a.__super__=t.prototype;return a},_deprecated:function _deprecated(e,t,a,i){if(t!==void 0){console.warn(e+": \""+a+"\" is deprecated. Please use \""+i+"\" instead")}}},ca=ga;ga.callCallback=ga.callback;ga.indexOf=function(e,t,a){return Array.prototype.indexOf.call(e,t,a)};ga.getValueOrDefault=ga.valueOrDefault;ga.getValueAtIndexOrDefault=ga.valueAtIndexOrDefault;var ha={linear:function linear(e){return e},easeInQuad:function easeInQuad(e){return e*e},easeOutQuad:function easeOutQuad(e){return-e*(e-2)},easeInOutQuad:function easeInOutQuad(e){if(1>(e/=.5)){return .5*e*e}return-.5*(--e*(e-2)-1)},easeInCubic:function easeInCubic(e){return e*e*e},easeOutCubic:function easeOutCubic(e){return(e=e-1)*e*e+1},easeInOutCubic:function easeInOutCubic(e){if(1>(e/=.5)){return .5*e*e*e}return .5*((e-=2)*e*e+2)},easeInQuart:function easeInQuart(e){return e*e*e*e},easeOutQuart:function easeOutQuart(e){return-((e=e-1)*e*e*e-1)},easeInOutQuart:function easeInOutQuart(e){if(1>(e/=.5)){return .5*e*e*e*e}return-.5*((e-=2)*e*e*e-2)},easeInQuint:function easeInQuint(e){return e*e*e*e*e},easeOutQuint:function easeOutQuint(e){return(e=e-1)*e*e*e*e+1},easeInOutQuint:function easeInOutQuint(e){if(1>(e/=.5)){return .5*e*e*e*e*e}return .5*((e-=2)*e*e*e*e+2)},easeInSine:function easeInSine(e){return-Math.cos(e*(Math.PI/2))+1},easeOutSine:function easeOutSine(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function easeInOutSine(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function easeInExpo(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function easeOutExpo(e){return 1===e?1:-Math.pow(2,-10*e)+1},easeInOutExpo:function easeInOutExpo(e){if(0===e){return 0}if(1===e){return 1}if(1>(e/=.5)){return .5*Math.pow(2,10*(e-1))}return .5*(-Math.pow(2,-10*--e)+2)},easeInCirc:function easeInCirc(e){if(1<=e){return e}return-(Math.sqrt(1-e*e)-1)},easeOutCirc:function easeOutCirc(e){return Math.sqrt(1-(e=e-1)*e)},easeInOutCirc:function easeInOutCirc(e){if(1>(e/=.5)){return-.5*(Math.sqrt(1-e*e)-1)}return .5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function easeInElastic(e){var i=1.70158,o=0,n=1;if(0===e){return 0}if(1===e){return 1}if(!o){o=.3}if(1>n){n=1;i=o/4}else{i=o/(2*Math.PI)*Math.asin(1/n)}return-(n*Math.pow(2,10*(e-=1))*Math.sin((e-i)*(2*Math.PI)/o))},easeOutElastic:function easeOutElastic(e){var t=1.70158,i=0,o=1;if(0===e){return 0}if(1===e){return 1}if(!i){i=.3}if(1>o){o=1;t=i/4}else{t=i/(2*Math.PI)*Math.asin(1/o)}return o*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/i)+1},easeInOutElastic:function easeInOutElastic(e){var i=1.70158,o=0,n=1;if(0===e){return 0}if(2==(e/=.5)){return 1}if(!o){o=.45}if(1>n){n=1;i=o/4}else{i=o/(2*Math.PI)*Math.asin(1/n)}if(1>e){return-.5*(n*Math.pow(2,10*(e-=1))*Math.sin((e-i)*(2*Math.PI)/o))}return .5*(n*Math.pow(2,-10*(e-=1))*Math.sin((e-i)*(2*Math.PI)/o))+1},easeInBack:function easeInBack(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function easeOutBack(e){var a=1.70158;return(e=e-1)*e*((a+1)*e+a)+1},easeInOutBack:function easeInOutBack(e){var a=1.70158;if(1>(e/=.5)){return .5*(e*e*(((a*=1.525)+1)*e-a))}return .5*((e-=2)*e*(((a*=1.525)+1)*e+a)+2)},easeInBounce:function easeInBounce(e){return 1-ha.easeOutBounce(1-e)},easeOutBounce:function easeOutBounce(e){if(e<1/2.75){return 7.5625*e*e}if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}return 7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:function easeInOutBounce(e){if(.5>e){return .5*ha.easeInBounce(2*e)}return .5*ha.easeOutBounce(2*e-1)+.5}};ca.easingEffects=ha;var pa=Math.PI,me=pa/2,ua=pa/4,ma=2*pa/3,ba={clear:function clear(e){e.ctx.clearRect(0,0,e.width,e.height)},roundedRect:function roundedRect(e,t,a,i,o,n){if(n){var l=Math.min(n,o/2,i/2),r=t+l,s=a+l,d=t+i-l,g=a+o-l;e.moveTo(t,s);if(r<d&&s<g){e.arc(r,s,l,-pa,-me);e.arc(d,s,l,-me,0);e.arc(d,g,l,0,me);e.arc(r,g,l,me,pa)}else if(r<d){e.moveTo(r,a);e.arc(d,s,l,-me,me);e.arc(r,s,l,me,pa+me)}else if(s<g){e.arc(r,s,l,-pa,0);e.arc(r,g,l,0,pa)}else{e.arc(r,s,l,-pa,pa)}e.closePath();e.moveTo(t,a)}else{e.rect(t,a,i,o)}},drawPoint:function drawPoint(e,t,a,i,o,n){var r,l,s,d,g,c=(n||0)*(pa/180);if(t&&"object"===_typeof(t)){r=t.toString();if("[object HTMLImageElement]"===r||"[object HTMLCanvasElement]"===r){e.save();e.translate(i,o);e.rotate(c);e.drawImage(t,-t.width/2,-t.height/2,t.width,t.height);e.restore();return}}if(isNaN(a)||0>=a){return}e.beginPath();switch(t){default:e.arc(i,o,a,0,2*pa);e.closePath();break;case"triangle":e.moveTo(i+Math.sin(c)*a,o-Math.cos(c)*a);c+=ma;e.lineTo(i+Math.sin(c)*a,o-Math.cos(c)*a);c+=ma;e.lineTo(i+Math.sin(c)*a,o-Math.cos(c)*a);e.closePath();break;case"rectRounded":g=.516*a;d=a-g;l=Math.cos(c+ua)*d;s=Math.sin(c+ua)*d;e.arc(i-l,o-s,g,c-pa,c-me);e.arc(i+s,o-l,g,c-me,c);e.arc(i+l,o+s,g,c,c+me);e.arc(i-s,o+l,g,c+me,c+pa);e.closePath();break;case"rect":if(!n){d=Math.SQRT1_2*a;e.rect(i-d,o-d,2*d,2*d);break}c+=ua;case"rectRot":l=Math.cos(c)*a;s=Math.sin(c)*a;e.moveTo(i-l,o-s);e.lineTo(i+s,o-l);e.lineTo(i+l,o+s);e.lineTo(i-s,o+l);e.closePath();break;case"crossRot":c+=ua;case"cross":l=Math.cos(c)*a;s=Math.sin(c)*a;e.moveTo(i-l,o-s);e.lineTo(i+l,o+s);e.moveTo(i+s,o-l);e.lineTo(i-s,o+l);break;case"star":l=Math.cos(c)*a;s=Math.sin(c)*a;e.moveTo(i-l,o-s);e.lineTo(i+l,o+s);e.moveTo(i+s,o-l);e.lineTo(i-s,o+l);c+=ua;l=Math.cos(c)*a;s=Math.sin(c)*a;e.moveTo(i-l,o-s);e.lineTo(i+l,o+s);e.moveTo(i+s,o-l);e.lineTo(i-s,o+l);break;case"line":l=Math.cos(c)*a;s=Math.sin(c)*a;e.moveTo(i-l,o-s);e.lineTo(i+l,o+s);break;case"dash":e.moveTo(i,o);e.lineTo(i+Math.cos(c)*a,o+Math.sin(c)*a);break;}e.fill();e.stroke()},_isPointInArea:function _isPointInArea(e,t){var a=1e-6;return e.x>t.left-a&&e.x<t.right+a&&e.y>t.top-a&&e.y<t.bottom+a},clipArea:function clipArea(e,t){e.save();e.beginPath();e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top);e.clip()},unclipArea:function unclipArea(e){e.restore()},lineTo:function lineTo(e,t,a,i){var o=a.steppedLine;if(o){if("middle"===o){var n=(t.x+a.x)/2;e.lineTo(n,i?a.y:t.y);e.lineTo(n,i?t.y:a.y)}else if("after"===o&&!i||"after"!==o&&i){e.lineTo(t.x,a.y)}else{e.lineTo(a.x,t.y)}e.lineTo(a.x,a.y);return}if(!a.tension){e.lineTo(a.x,a.y);return}e.bezierCurveTo(i?t.controlPointPreviousX:t.controlPointNextX,i?t.controlPointPreviousY:t.controlPointNextY,i?a.controlPointNextX:a.controlPointPreviousX,i?a.controlPointNextY:a.controlPointPreviousY,a.x,a.y)}};ca.clear=ba.clear;ca.drawRoundedRectangle=function(e){e.beginPath();ba.roundedRect.apply(ba,arguments)};var xa={_set:function _set(e,t){return ca.merge(this[e]||(this[e]={}),t)}};xa._set("global",{defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",defaultLineHeight:1.2,showLines:!0});var fa=xa,ya=ca.valueOrDefault;function b(e){if(!e||ca.isNullOrUndef(e.size)||ca.isNullOrUndef(e.family)){return null}return(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}var _a={_factorize:function _factorize(e){var t=[],a=Math.sqrt(e),o;for(o=1;o<a;o++){if(0==e%o){t.push(o);t.push(e/o)}}if(a===(0|a)){t.push(a)}t.sort(function(e,t){return e-t}).pop();return t},log10:Math.log10||function(e){var t=Math.log(e)*Math.LOG10E,a=Math.round(t),i=e===Math.pow(10,a);return i?a:t}};ca.log10=_a.log10;var va=function(e,t){return{x:function x(a){return e+e+t-a},setWidth:function setWidth(e){t=e},textAlign:function textAlign(e){if("center"===e){return e}return"right"===e?"left":"right"},xPlus:function xPlus(e,t){return e-t},leftForLtr:function leftForLtr(e,t){return e-t}}},ka=function(){return{x:function x(e){return e},setWidth:function setWidth(){},textAlign:function textAlign(e){return e},xPlus:function xPlus(e,t){return e+t},leftForLtr:function leftForLtr(e){return e}}},wa=ca;wa.easing={effects:ha};wa.canvas=ba;wa.options={toLineHeight:function toLineHeight(e,t){var a=(""+e).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!a||"normal"===a[1]){return 1.2*t}e=+a[2];switch(a[3]){case"px":return e;case"%":e/=100;break;}return t*e},toPadding:function toPadding(e){var a,i,o,n;if(ca.isObject(e)){a=+e.top||0;i=+e.right||0;o=+e.bottom||0;n=+e.left||0}else{a=i=o=n=+e||0}return{top:a,right:i,bottom:o,left:n,height:a+o,width:n+i}},_parseFont:function _parseFont(e){var t=fa.global,a=ya(e.fontSize,t.defaultFontSize),i={family:ya(e.fontFamily,t.defaultFontFamily),lineHeight:ca.options.toLineHeight(ya(e.lineHeight,t.defaultLineHeight),a),size:a,style:ya(e.fontStyle,t.defaultFontStyle),weight:null,string:""};i.string=b(i);return i},resolve:function(e,t,a,o){var n=!0,r,l,s;for(r=0,l=e.length;r<l;++r){s=e[r];if(s===void 0){continue}if(t!==void 0&&"function"==typeof s){s=s(t);n=!1}if(a!==void 0&&ca.isArray(s)){s=s[a];n=!1}if(s!==void 0){if(o&&!n){o.cacheable=!1}return s}}}};wa.math=_a;wa.rtl={getRtlAdapter:function getAdapter(e,t,a){return e?va(t,a):ka()},overrideTextDirection:function overrideTextDirection(e,t){var a,i;if("ltr"===t||"rtl"===t){a=e.canvas.style;i=[a.getPropertyValue("direction"),a.getPropertyPriority("direction")];a.setProperty("direction",t,"important");e.prevTextDirection=i}},restoreTextDirection:function restoreTextDirection(e){var t=e.prevTextDirection;if(t!==void 0){delete e.prevTextDirection;e.canvas.style.setProperty("direction",t[0],t[1])}}};function x(e,t,a,o){var n=Object.keys(a),r,l,s,d,g,c,h,p,u;for(r=0,l=n.length;r<l;++r){s=n[r];c=a[s];if(!t.hasOwnProperty(s)){t[s]=c}d=t[s];if(d===c||"_"===s[0]){continue}if(!e.hasOwnProperty(s)){e[s]=d}g=e[s];h=_typeof(c);if(h===_typeof(g)){if("string"===h){p=da(g);if(p.valid){u=da(c);if(u.valid){t[s]=u.mix(p,o).rgbString();continue}}}else if(wa.isFinite(g)&&wa.isFinite(c)){t[s]=g+(c-g)*o;continue}}t[s]=c}}var Sa=function(e){wa.extend(this,e);this.initialize.apply(this,arguments)};wa.extend(Sa.prototype,{_type:void 0,initialize:function initialize(){this.hidden=!1},pivot:function pivot(){var e=this;if(!e._view){e._view=wa.extend({},e._model)}e._start={};return e},transition:function transition(e){var t=this,a=t._model,i=t._start,o=t._view;if(!a||1===e){t._view=wa.extend({},a);t._start=null;return t}if(!o){o=t._view={}}if(!i){i=t._start={}}x(i,o,a,e);return t},tooltipPosition:function tooltipPosition(){return{x:this._model.x,y:this._model.y}},hasValue:function hasValue(){return wa.isNumber(this._model.x)&&wa.isNumber(this._model.y)}});Sa.extend=wa.inherits;var Ca=Sa,Pa=Ca.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),Aa=Pa;Object.defineProperty(Pa.prototype,"animationObject",{get:function get(){return this}});Object.defineProperty(Pa.prototype,"chartInstance",{get:function get(){return this.chart},set:function set(e){this.chart=e}});fa._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:wa.noop,onComplete:wa.noop}});var Da={animations:[],request:null,addAnimation:function addAnimation(e,t,a,o){var n=this.animations,r,l;t.chart=e;t.startTime=Date.now();t.duration=a;if(!o){e.animating=!0}for(r=0,l=n.length;r<l;++r){if(n[r].chart===e){n[r]=t;return}}n.push(t);if(1===n.length){this.requestAnimationFrame()}},cancelAnimation:function cancelAnimation(e){var t=wa.findIndex(this.animations,function(t){return t.chart===e});if(-1!==t){this.animations.splice(t,1);e.animating=!1}},requestAnimationFrame:function requestAnimationFrame(){var e=this;if(null===e.request){e.request=wa.requestAnimFrame.call(window,function(){e.request=null;e.startDigest()})}},startDigest:function startDigest(){var e=this;e.advance();if(0<e.animations.length){e.requestAnimationFrame()}},advance:function advance(){var e=this.animations,t,a,o,n,r=0;while(r<e.length){t=e[r];a=t.chart;o=t.numSteps;n=Math.floor((Date.now()-t.startTime)/t.duration*o)+1;t.currentStep=Math.min(n,o);wa.callback(t.render,[a,t],a);wa.callback(t.onAnimationProgress,[t],a);if(t.currentStep>=o){wa.callback(t.onAnimationComplete,[t],a);a.animating=!1;e.splice(r,1)}else{++r}}}},Ta=wa.options.resolve,Ia=["push","pop","shift","splice","unshift"];function f(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}});Ia.forEach(function(t){var a="onData"+t.charAt(0).toUpperCase()+t.slice(1),i=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:function value(){var t=Array.prototype.slice.call(arguments),o=i.apply(this,t);wa.each(e._chartjs.listeners,function(e){if("function"==typeof e[a]){e[a].apply(e,t)}});return o}})})}function y(e,t){var a=e._chartjs;if(!a){return}var i=a.listeners,o=i.indexOf(t);if(-1!==o){i.splice(o,1)}if(0<i.length){return}Ia.forEach(function(t){delete e[t]});delete e._chartjs}var Fa=function(e,t){this.initialize(e,t)};wa.extend(Fa.prototype,{datasetElementType:null,dataElementType:null,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth"],_dataElementOptions:["backgroundColor","borderColor","borderWidth","pointStyle"],initialize:function initialize(e,t){var a=this;a.chart=e;a.index=t;a.linkScales();a.addElements();a._type=a.getMeta().type},updateIndex:function updateIndex(e){this.index=e},linkScales:function linkScales(){var e=this,t=e.getMeta(),a=e.chart,i=a.scales,o=e.getDataset(),n=a.options.scales;if(null===t.xAxisID||!(t.xAxisID in i)||o.xAxisID){t.xAxisID=o.xAxisID||n.xAxes[0].id}if(null===t.yAxisID||!(t.yAxisID in i)||o.yAxisID){t.yAxisID=o.yAxisID||n.yAxes[0].id}},getDataset:function getDataset(){return this.chart.data.datasets[this.index]},getMeta:function getMeta(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function getScaleForId(e){return this.chart.scales[e]},_getValueScaleId:function _getValueScaleId(){return this.getMeta().yAxisID},_getIndexScaleId:function _getIndexScaleId(){return this.getMeta().xAxisID},_getValueScale:function _getValueScale(){return this.getScaleForId(this._getValueScaleId())},_getIndexScale:function _getIndexScale(){return this.getScaleForId(this._getIndexScaleId())},reset:function reset(){this._update(!0)},destroy:function destroy(){if(this._data){y(this._data,this)}},createMetaDataset:function createMetaDataset(){var e=this,t=e.datasetElementType;return t&&new t({_chart:e.chart,_datasetIndex:e.index})},createMetaData:function createMetaData(e){var t=this,a=t.dataElementType;return a&&new a({_chart:t.chart,_datasetIndex:t.index,_index:e})},addElements:function addElements(){var e=this,t=e.getMeta(),a=e.getDataset().data||[],o=t.data,n,r;for(n=0,r=a.length;n<r;++n){o[n]=o[n]||e.createMetaData(n)}t.dataset=t.dataset||e.createMetaDataset()},addElementAndReset:function addElementAndReset(e){var t=this.createMetaData(e);this.getMeta().data.splice(e,0,t);this.updateElement(t,e,!0)},buildOrUpdateElements:function buildOrUpdateElements(){var e=this,t=e.getDataset(),a=t.data||(t.data=[]);if(e._data!==a){if(e._data){y(e._data,e)}if(a&&Object.isExtensible(a)){f(a,e)}e._data=a}e.resyncElements()},_configure:function _configure(){var e=this;e._config=wa.merge(Object.create(null),[e.chart.options.datasets[e._type],e.getDataset()],{merger:function merger(e,t,a){if("_meta"!==e&&"data"!==e){wa._merger(e,t,a)}}})},_update:function _update(e){var t=this;t._configure();t._cachedDataOpts=null;t.update(e)},update:wa.noop,transition:function transition(e){var t=this.getMeta(),a=t.data||[],o=a.length,n=0;for(;n<o;++n){a[n].transition(e)}if(t.dataset){t.dataset.transition(e)}},draw:function draw(){var e=this.getMeta(),t=e.data||[],a=t.length,o=0;if(e.dataset){e.dataset.draw()}for(;o<a;++o){t[o].draw()}},getStyle:function getStyle(e){var t=this,a=t.getMeta(),i=a.dataset,o;t._configure();if(i&&e===void 0){o=t._resolveDatasetElementOptions(i||{})}else{e=e||0;o=t._resolveDataElementOptions(a.data[e]||{},e)}if(!1===o.fill||null===o.fill){o.backgroundColor=o.borderColor}return o},_resolveDatasetElementOptions:function _resolveDatasetElementOptions(e,t){var a=this,o=a.chart,n=a._config,r=e.custom||{},l=o.options.elements[a.datasetElementType.prototype._type]||{},s=a._datasetElementOptions,d={},g,c,h,p,u={chart:o,dataset:a.getDataset(),datasetIndex:a.index,hover:t};for(g=0,c=s.length;g<c;++g){h=s[g];p=t?"hover"+h.charAt(0).toUpperCase()+h.slice(1):h;d[h]=Ta([r[p],n[p],l[p]],u)}return d},_resolveDataElementOptions:function _resolveDataElementOptions(e,t){var a=this,o=e&&e.custom,n=a._cachedDataOpts;if(n&&!o){return n}var r=a.chart,l=a._config,s=r.options.elements[a.dataElementType.prototype._type]||{},d=a._dataElementOptions,g={},c={chart:r,dataIndex:t,dataset:a.getDataset(),datasetIndex:a.index},h={cacheable:!o},p,u,m,b;o=o||{};if(wa.isArray(d)){for(u=0,m=d.length;u<m;++u){b=d[u];g[b]=Ta([o[b],l[b],s[b]],c,t,h)}}else{p=Object.keys(d);for(u=0,m=p.length;u<m;++u){b=p[u];g[b]=Ta([o[b],l[d[b]],l[b],s[b]],c,t,h)}}if(h.cacheable){a._cachedDataOpts=Object.freeze(g)}return g},removeHoverStyle:function removeHoverStyle(e){wa.merge(e._model,e.$previousStyle||{});delete e.$previousStyle},setHoverStyle:function setHoverStyle(e){var t=this.chart.data.datasets[e._datasetIndex],a=e._index,i=e.custom||{},o=e._model,n=wa.getHoverColor;e.$previousStyle={backgroundColor:o.backgroundColor,borderColor:o.borderColor,borderWidth:o.borderWidth};o.backgroundColor=Ta([i.hoverBackgroundColor,t.hoverBackgroundColor,n(o.backgroundColor)],void 0,a);o.borderColor=Ta([i.hoverBorderColor,t.hoverBorderColor,n(o.borderColor)],void 0,a);o.borderWidth=Ta([i.hoverBorderWidth,t.hoverBorderWidth,o.borderWidth],void 0,a)},_removeDatasetHoverStyle:function _removeDatasetHoverStyle(){var e=this.getMeta().dataset;if(e){this.removeHoverStyle(e)}},_setDatasetHoverStyle:function _setDatasetHoverStyle(){var e=this.getMeta().dataset,t={},a,o,n,r,l,s;if(!e){return}s=e._model;l=this._resolveDatasetElementOptions(e,!0);r=Object.keys(l);for(a=0,o=r.length;a<o;++a){n=r[a];t[n]=s[n];s[n]=l[n]}e.$previousStyle=t},resyncElements:function resyncElements(){var e=this,t=e.getMeta(),a=e.getDataset().data,i=t.data.length,o=a.length;if(o<i){t.data.splice(o,i-o)}else if(o>i){e.insertElements(i,o-i)}},insertElements:function insertElements(e,t){for(var a=0;a<t;++a){this.addElementAndReset(e+a)}},onDataPush:function onDataPush(){var e=arguments.length;this.insertElements(this.getDataset().data.length-e,e)},onDataPop:function onDataPop(){this.getMeta().data.pop()},onDataShift:function onDataShift(){this.getMeta().data.shift()},onDataSplice:function onDataSplice(e,t){this.getMeta().data.splice(e,t);this.insertElements(e,arguments.length-2)},onDataUnshift:function onDataUnshift(){this.insertElements(0,arguments.length)}});Fa.extend=wa.inherits;var La=Fa,Oa=2*Math.PI;fa._set("global",{elements:{arc:{backgroundColor:fa.global.defaultColor,borderColor:"#fff",borderWidth:2,borderAlign:"center"}}});function _(e,t){var a=t.startAngle,i=t.endAngle,o=t.pixelMargin,n=o/t.outerRadius,r=t.x,l=t.y;e.beginPath();e.arc(r,l,t.outerRadius,a-n,i+n);if(t.innerRadius>o){n=o/t.innerRadius;e.arc(r,l,t.innerRadius-o,i+n,a-n,!0)}else{e.arc(r,l,o,i+Math.PI/2,a-Math.PI/2)}e.closePath();e.clip()}function v(e,t,a,o){var n=a.endAngle,r;if(o){a.endAngle=a.startAngle+Oa;_(e,a);a.endAngle=n;if(a.endAngle===a.startAngle&&a.fullCircles){a.endAngle+=Oa;a.fullCircles--}}e.beginPath();e.arc(a.x,a.y,a.innerRadius,a.startAngle+Oa,a.startAngle,!0);for(r=0;r<a.fullCircles;++r){e.stroke()}e.beginPath();e.arc(a.x,a.y,t.outerRadius,a.startAngle,a.startAngle+Oa);for(r=0;r<a.fullCircles;++r){e.stroke()}}function w(e,t,a){var i="inner"===t.borderAlign;if(i){e.lineWidth=2*t.borderWidth;e.lineJoin="round"}else{e.lineWidth=t.borderWidth;e.lineJoin="bevel"}if(a.fullCircles){v(e,t,a,i)}if(i){_(e,a)}e.beginPath();e.arc(a.x,a.y,t.outerRadius,a.startAngle,a.endAngle);e.arc(a.x,a.y,a.innerRadius,a.endAngle,a.startAngle,!0);e.closePath();e.stroke()}var Ra=Ca.extend({_type:"arc",inLabelRange:function inLabelRange(e){var t=this._view;if(t){return Math.pow(e-t.x,2)<Math.pow(t.radius+t.hoverRadius,2)}return!1},inRange:function inRange(e,t){var a=this._view;if(a){var i=wa.getAngleFromPoint(a,{x:e,y:t}),o=i.angle,n=i.distance,r=a.startAngle,l=a.endAngle;while(l<r){l+=Oa}while(o>l){o-=Oa}while(o<r){o+=Oa}var s=o>=r&&o<=l,d=n>=a.innerRadius&&n<=a.outerRadius;return s&&d}return!1},getCenterPoint:function getCenterPoint(){var e=this._view,t=(e.startAngle+e.endAngle)/2,a=(e.innerRadius+e.outerRadius)/2;return{x:e.x+Math.cos(t)*a,y:e.y+Math.sin(t)*a}},getArea:function getArea(){var e=this._view;return Math.PI*((e.endAngle-e.startAngle)/(2*Math.PI))*(Math.pow(e.outerRadius,2)-Math.pow(e.innerRadius,2))},tooltipPosition:function tooltipPosition(){var e=this._view,t=e.startAngle+(e.endAngle-e.startAngle)/2,a=(e.outerRadius-e.innerRadius)/2+e.innerRadius;return{x:e.x+Math.cos(t)*a,y:e.y+Math.sin(t)*a}},draw:function draw(){var e=this._chart.ctx,t=this._view,a="inner"===t.borderAlign?.33:0,o={x:t.x,y:t.y,innerRadius:t.innerRadius,outerRadius:Math.max(t.outerRadius-a,0),pixelMargin:a,startAngle:t.startAngle,endAngle:t.endAngle,fullCircles:Math.floor(t.circumference/Oa)},n;e.save();e.fillStyle=t.backgroundColor;e.strokeStyle=t.borderColor;if(o.fullCircles){o.endAngle=o.startAngle+Oa;e.beginPath();e.arc(o.x,o.y,o.outerRadius,o.startAngle,o.endAngle);e.arc(o.x,o.y,o.innerRadius,o.endAngle,o.startAngle,!0);e.closePath();for(n=0;n<o.fullCircles;++n){e.fill()}o.endAngle=o.startAngle+t.circumference%Oa}e.beginPath();e.arc(o.x,o.y,o.outerRadius,o.startAngle,o.endAngle);e.arc(o.x,o.y,o.innerRadius,o.endAngle,o.startAngle,!0);e.closePath();e.fill();if(t.borderWidth){w(e,t,o)}e.restore()}}),za=wa.valueOrDefault,Ea=fa.global.defaultColor;fa._set("global",{elements:{line:{tension:.4,backgroundColor:Ea,borderWidth:3,borderColor:Ea,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}});var Ba=Ca.extend({_type:"line",draw:function draw(){var e=this,t=e._view,a=e._chart.ctx,i=t.spanGaps,o=e._children.slice(),n=fa.global,r=n.elements.line,l=-1,s=e._loop,d,g,c;if(!o.length){return}if(e._loop){for(d=0;d<o.length;++d){g=wa.previousItem(o,d);if(!o[d]._view.skip&&g._view.skip){o=o.slice(d).concat(o.slice(0,d));s=i;break}}if(s){o.push(o[0])}}a.save();a.lineCap=t.borderCapStyle||r.borderCapStyle;if(a.setLineDash){a.setLineDash(t.borderDash||r.borderDash)}a.lineDashOffset=za(t.borderDashOffset,r.borderDashOffset);a.lineJoin=t.borderJoinStyle||r.borderJoinStyle;a.lineWidth=za(t.borderWidth,r.borderWidth);a.strokeStyle=t.borderColor||n.defaultColor;a.beginPath();c=o[0]._view;if(!c.skip){a.moveTo(c.x,c.y);l=0}for(d=1;d<o.length;++d){c=o[d]._view;g=-1===l?wa.previousItem(o,d):o[l];if(!c.skip){if(l!==d-1&&!i||-1===l){a.moveTo(c.x,c.y)}else{wa.canvas.lineTo(a,g._view,c)}l=d}}if(s){a.closePath()}a.stroke();a.restore()}}),Wa=wa.valueOrDefault,Va=fa.global.defaultColor;fa._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:Va,borderColor:Va,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});function S(e){var t=this._view;return t?Math.abs(e-t.x)<t.radius+t.hitRadius:!1}var Ma=Ca.extend({_type:"point",inRange:function inRange(e,t){var a=this._view;return a?Math.pow(e-a.x,2)+Math.pow(t-a.y,2)<Math.pow(a.hitRadius+a.radius,2):!1},inLabelRange:S,inXRange:S,inYRange:function(e){var t=this._view;return t?Math.abs(e-t.y)<t.radius+t.hitRadius:!1},getCenterPoint:function getCenterPoint(){var e=this._view;return{x:e.x,y:e.y}},getArea:function getArea(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function tooltipPosition(){var e=this._view;return{x:e.x,y:e.y,padding:e.radius+e.borderWidth}},draw:function draw(e){var t=this._view,a=this._chart.ctx,i=t.pointStyle,o=t.rotation,n=t.radius,r=t.x,l=t.y,s=fa.global,d=s.defaultColor;if(t.skip){return}if(e===void 0||wa.canvas._isPointInArea(t,e)){a.strokeStyle=t.borderColor||d;a.lineWidth=Wa(t.borderWidth,s.elements.point.borderWidth);a.fillStyle=t.backgroundColor||d;wa.canvas.drawPoint(a,i,n,r,l,o)}}}),Ha=fa.global.defaultColor;fa._set("global",{elements:{rectangle:{backgroundColor:Ha,borderColor:Ha,borderSkipped:"bottom",borderWidth:0}}});function C(e){return e&&e.width!==void 0}function P(e){var t,a,i,o,n;if(C(e)){n=e.width/2;t=e.x-n;a=e.x+n;i=Math.min(e.y,e.base);o=Math.max(e.y,e.base)}else{n=e.height/2;t=Math.min(e.x,e.base);a=Math.max(e.x,e.base);i=e.y-n;o=e.y+n}return{left:t,top:i,right:a,bottom:o}}function A(e,t,a){return e===t?a:e===a?t:e}function D(e){var t=e.borderSkipped,a={};if(!t){return a}if(e.horizontal){if(e.base>e.x){t=A(t,"left","right")}}else if(e.base<e.y){t=A(t,"bottom","top")}a[t]=!0;return a}function T(e,a,i){var o=e.borderWidth,n=D(e),s,d,g,c;if(wa.isObject(o)){s=+o.top||0;d=+o.right||0;g=+o.bottom||0;c=+o.left||0}else{s=d=g=c=+o||0}return{t:n.top||0>s?0:s>i?i:s,r:n.right||0>d?0:d>a?a:d,b:n.bottom||0>g?0:g>i?i:g,l:n.left||0>c?0:c>a?a:c}}function I(e){var t=P(e),a=t.right-t.left,i=t.bottom-t.top,o=T(e,a/2,i/2);return{outer:{x:t.left,y:t.top,w:a,h:i},inner:{x:t.left+o.l,y:t.top+o.t,w:a-o.l-o.r,h:i-o.t-o.b}}}function F(e,t,a){var i=null===t,o=null===a,n=!e||i&&o?!1:P(e);return n&&(i||t>=n.left&&t<=n.right)&&(o||a>=n.top&&a<=n.bottom)}var Na=Ca.extend({_type:"rectangle",draw:function draw(){var e=this._chart.ctx,t=this._view,a=I(t),i=a.outer,o=a.inner;e.fillStyle=t.backgroundColor;e.fillRect(i.x,i.y,i.w,i.h);if(i.w===o.w&&i.h===o.h){return}e.save();e.beginPath();e.rect(i.x,i.y,i.w,i.h);e.clip();e.fillStyle=t.borderColor;e.rect(o.x,o.y,o.w,o.h);e.fill("evenodd");e.restore()},height:function height(){var e=this._view;return e.base-e.y},inRange:function inRange(e,t){return F(this._view,e,t)},inLabelRange:function inLabelRange(e,t){var a=this._view;return C(a)?F(a,e,null):F(a,null,t)},inXRange:function inXRange(e){return F(this._view,e,null)},inYRange:function inYRange(e){return F(this._view,null,e)},getCenterPoint:function getCenterPoint(){var e=this._view,t,a;if(C(e)){t=e.x;a=(e.y+e.base)/2}else{t=(e.x+e.base)/2;a=e.y}return{x:t,y:a}},getArea:function getArea(){var e=this._view;return C(e)?e.width*Math.abs(e.y-e.base):e.height*Math.abs(e.x-e.base)},tooltipPosition:function tooltipPosition(){var e=this._view;return{x:e.x,y:e.y}}}),ja={};ja.Arc=Ra;ja.Line=Ba;ja.Point=Ma;ja.Rectangle=Na;var Ya=wa._deprecated,qa=wa.valueOrDefault;fa._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}});fa._set("global",{datasets:{bar:{categoryPercentage:.8,barPercentage:.9}}});function L(e,t){var a=e._length,o,n,r,l;for(r=1,l=t.length;r<l;++r){a=Math.min(a,Math.abs(t[r]-t[r-1]))}for(r=0,l=e.getTicks().length;r<l;++r){n=e.getPixelForTick(r);a=0<r?Math.min(a,Math.abs(n-o)):a;o=n}return a}function O(e,t,a){var i=a.barThickness,o=t.stackCount,n=t.pixels[e],r=wa.isNullOrUndef(i)?L(t.scale,t.pixels):-1,l,s;if(wa.isNullOrUndef(i)){l=r*a.categoryPercentage;s=a.barPercentage}else{l=i*o;s=1}return{chunk:l/o,ratio:s,start:n-l/2}}function R(e,t,a){var i=t.pixels,o=i[e],n=0<e?i[e-1]:null,r=e<i.length-1?i[e+1]:null,l=a.categoryPercentage,s,d;if(null===n){n=o-(null===r?t.end-t.start:r-o)}if(null===r){r=o+o-n}s=o-(o-Math.min(n,r))/2*l;d=Math.abs(r-n)/2*l;return{chunk:d/t.stackCount,ratio:a.barPercentage,start:s}}var Ua=La.extend({dataElementType:ja.Rectangle,_dataElementOptions:["backgroundColor","borderColor","borderSkipped","borderWidth","barPercentage","barThickness","categoryPercentage","maxBarThickness","minBarLength"],initialize:function initialize(){var e=this,t,a;La.prototype.initialize.apply(e,arguments);t=e.getMeta();t.stack=e.getDataset().stack;t.bar=!0;a=e._getIndexScale().options;Ya("bar chart",a.barPercentage,"scales.[x/y]Axes.barPercentage","dataset.barPercentage");Ya("bar chart",a.barThickness,"scales.[x/y]Axes.barThickness","dataset.barThickness");Ya("bar chart",a.categoryPercentage,"scales.[x/y]Axes.categoryPercentage","dataset.categoryPercentage");Ya("bar chart",e._getValueScale().options.minBarLength,"scales.[x/y]Axes.minBarLength","dataset.minBarLength");Ya("bar chart",a.maxBarThickness,"scales.[x/y]Axes.maxBarThickness","dataset.maxBarThickness")},update:function update(e){var t=this,a=t.getMeta().data,o,n;t._ruler=t.getRuler();for(o=0,n=a.length;o<n;++o){t.updateElement(a[o],o,e)}},updateElement:function updateElement(e,t,a){var i=this,o=i.getMeta(),n=i.getDataset(),r=i._resolveDataElementOptions(e,t);e._xScale=i.getScaleForId(o.xAxisID);e._yScale=i.getScaleForId(o.yAxisID);e._datasetIndex=i.index;e._index=t;e._model={backgroundColor:r.backgroundColor,borderColor:r.borderColor,borderSkipped:r.borderSkipped,borderWidth:r.borderWidth,datasetLabel:n.label,label:i.chart.data.labels[t]};if(wa.isArray(n.data[t])){e._model.borderSkipped=null}i._updateElementGeometry(e,t,a,r);e.pivot()},_updateElementGeometry:function _updateElementGeometry(e,t,a,i){var o=this,n=e._model,r=o._getValueScale(),l=r.getBasePixel(),s=r.isHorizontal(),d=o._ruler||o.getRuler(),g=o.calculateBarValuePixels(o.index,t,i),c=o.calculateBarIndexPixels(o.index,t,d,i);n.horizontal=s;n.base=a?l:g.base;n.x=s?a?l:g.head:c.center;n.y=s?c.center:a?l:g.head;n.height=s?c.size:void 0;n.width=s?void 0:c.size},_getStacks:function _getStacks(e){var t=this,a=t._getIndexScale(),o=a._getMatchingVisibleMetas(t._type),n=a.options.stacked,r=o.length,l=[],s,d;for(s=0;s<r;++s){d=o[s];if(!1===n||-1===l.indexOf(d.stack)||n===void 0&&d.stack===void 0){l.push(d.stack)}if(d.index===e){break}}return l},getStackCount:function getStackCount(){return this._getStacks().length},getStackIndex:function getStackIndex(e,t){var a=this._getStacks(e),i=t!==void 0?a.indexOf(t):-1;return-1===i?a.length-1:i},getRuler:function getRuler(){var e=this,t=e._getIndexScale(),a=[],o,n;for(o=0,n=e.getMeta().data.length;o<n;++o){a.push(t.getPixelForValue(null,o,e.index))}return{pixels:a,start:t._startPixel,end:t._endPixel,stackCount:e.getStackCount(),scale:t}},calculateBarValuePixels:function calculateBarValuePixels(e,t,a){var o=this,n=o.chart,r=o._getValueScale(),l=r.isHorizontal(),s=n.data.datasets,d=r._getMatchingVisibleMetas(o._type),g=r._parseValue(s[e].data[t]),c=a.minBarLength,h=r.options.stacked,p=o.getMeta().stack,u=g.start===void 0?0:0<=g.max&&0<=g.min?g.min:g.max,m=g.start===void 0?g.end:0<=g.max&&0<=g.min?g.max-g.min:g.min-g.max,b=d.length,x,f,y,_,v,k,w;if(h||h===void 0&&p!==void 0){for(x=0;x<b;++x){f=d[x];if(f.index===e){break}if(f.stack===p){w=r._parseValue(s[f.index].data[t]);y=w.start===void 0?w.end:0<=w.min&&0<=w.max?w.max:w.min;if(0>g.min&&0>y||0<=g.max&&0<y){u+=y}}}}_=r.getPixelForValue(u);v=r.getPixelForValue(u+m);k=v-_;if(c!==void 0&&Math.abs(k)<c){k=c;if(0<=m&&!l||0>m&&l){v=_-c}else{v=_+c}}return{size:k,base:_,head:v,center:v+k/2}},calculateBarIndexPixels:function calculateBarIndexPixels(e,t,a,i){var o=this,n="flex"===i.barThickness?R(t,a,i):O(t,a,i),r=o.getStackIndex(e,o.getMeta().stack),l=n.start+n.chunk*r+n.chunk/2,s=Math.min(qa(i.maxBarThickness,1/0),n.chunk*n.ratio);return{base:l-s/2,head:l+s/2,center:l,size:s}},draw:function draw(){var e=this,t=e.chart,a=e._getValueScale(),o=e.getMeta().data,n=e.getDataset(),r=o.length,l=0;wa.canvas.clipArea(t.ctx,t.chartArea);for(;l<r;++l){var s=a._parseValue(n.data[l]);if(!isNaN(s.min)&&!isNaN(s.max)){o[l].draw()}}wa.canvas.unclipArea(t.ctx)},_resolveDataElementOptions:function _resolveDataElementOptions(){var e=this,t=wa.extend({},La.prototype._resolveDataElementOptions.apply(e,arguments)),a=e._getIndexScale().options,i=e._getValueScale().options;t.barPercentage=qa(a.barPercentage,t.barPercentage);t.barThickness=qa(a.barThickness,t.barThickness);t.categoryPercentage=qa(a.categoryPercentage,t.categoryPercentage);t.maxBarThickness=qa(a.maxBarThickness,t.maxBarThickness);t.minBarLength=qa(i.minBarLength,t.minBarLength);return t}}),Ka=wa.valueOrDefault,Xa=wa.options.resolve;fa._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function title(){return""},label:function label(e,t){var a=t.datasets[e.datasetIndex].label||"",i=t.datasets[e.datasetIndex].data[e.index];return a+": ("+e.xLabel+", "+e.yLabel+", "+i.r+")"}}}});var Ga=La.extend({dataElementType:ja.Point,_dataElementOptions:["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"],update:function update(e){var t=this,a=t.getMeta(),i=a.data;wa.each(i,function(a,i){t.updateElement(a,i,e)})},updateElement:function updateElement(e,t,a){var i=this,o=i.getMeta(),n=e.custom||{},r=i.getScaleForId(o.xAxisID),l=i.getScaleForId(o.yAxisID),s=i._resolveDataElementOptions(e,t),d=i.getDataset().data[t],g=i.index,c=a?r.getPixelForDecimal(.5):r.getPixelForValue("object"===_typeof(d)?d:NaN,t,g),h=a?l.getBasePixel():l.getPixelForValue(d,t,g);e._xScale=r;e._yScale=l;e._options=s;e._datasetIndex=g;e._index=t;e._model={backgroundColor:s.backgroundColor,borderColor:s.borderColor,borderWidth:s.borderWidth,hitRadius:s.hitRadius,pointStyle:s.pointStyle,rotation:s.rotation,radius:a?0:s.radius,skip:n.skip||isNaN(c)||isNaN(h),x:c,y:h};e.pivot()},setHoverStyle:function setHoverStyle(e){var t=e._model,a=e._options,i=wa.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius};t.backgroundColor=Ka(a.hoverBackgroundColor,i(a.backgroundColor));t.borderColor=Ka(a.hoverBorderColor,i(a.borderColor));t.borderWidth=Ka(a.hoverBorderWidth,a.borderWidth);t.radius=a.radius+a.hoverRadius},_resolveDataElementOptions:function _resolveDataElementOptions(e,t){var a=this,i=a.chart,o=a.getDataset(),n=e.custom||{},r=o.data[t]||{},l=La.prototype._resolveDataElementOptions.apply(a,arguments),s={chart:i,dataIndex:t,dataset:o,datasetIndex:a.index};if(a._cachedDataOpts===l){l=wa.extend({},l)}l.radius=Xa([n.radius,r.r,a._config.radius,i.options.elements.point.radius],s,t);return l}}),Za=wa.valueOrDefault,Ja=Math.PI,$a=2*Ja,Qa=Ja/2;fa._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function legendCallback(e){var t=document.createElement("ul"),a=e.data,o=a.datasets,n=a.labels,r,l,s,d;t.setAttribute("class",e.id+"-legend");if(o.length){for(r=0,l=o[0].data.length;r<l;++r){s=t.appendChild(document.createElement("li"));d=s.appendChild(document.createElement("span"));d.style.backgroundColor=o[0].backgroundColor[r];if(n[r]){s.appendChild(document.createTextNode(n[r]))}}}return t.outerHTML},legend:{labels:{generateLabels:function generateLabels(e){var t=e.data;if(t.labels.length&&t.datasets.length){return t.labels.map(function(a,o){var i=e.getDatasetMeta(0),n=i.controller.getStyle(o);return{text:a,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,lineWidth:n.borderWidth,hidden:isNaN(t.datasets[0].data[o])||i.data[o].hidden,index:o}})}return[]}},onClick:function onClick(t,e){var a=e.index,o=this.chart,n,r,l;for(n=0,r=(o.data.datasets||[]).length;n<r;++n){l=o.getDatasetMeta(n);if(l.data[a]){l.data[a].hidden=!l.data[a].hidden}}o.update()}},cutoutPercentage:50,rotation:-Qa,circumference:$a,tooltips:{callbacks:{title:function title(){return""},label:function label(e,t){var a=t.labels[e.index],i=": "+t.datasets[e.datasetIndex].data[e.index];if(wa.isArray(a)){a=a.slice();a[0]+=i}else{a+=i}return a}}}});var ei=La.extend({dataElementType:ja.Arc,linkScales:wa.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],getRingIndex:function getRingIndex(e){for(var t=0,a=0;a<e;++a){if(this.chart.isDatasetVisible(a)){++t}}return t},update:function update(e){var t=this,a=t.chart,o=a.chartArea,n=a.options,r=1,l=1,s=0,d=0,g=t.getMeta(),c=g.data,h=n.cutoutPercentage/100||0,p=n.circumference,u=t._getRingWeight(t.index),m,b,x,f;if(p<$a){var y=n.rotation%$a;y+=y>=Ja?-$a:y<-Ja?$a:0;var _=y+p,v=Math.cos(y),k=Math.sin(y),w=Math.cos(_),S=Math.sin(_),C=0>=y&&0<=_||_>=$a,P=y<=Qa&&_>=Qa||_>=$a+Qa,A=y===-Ja||_>=Ja,D=y<=-Qa&&_>=-Qa||_>=Ja+Qa,T=A?-1:Math.min(v,v*h,w,w*h),I=D?-1:Math.min(k,k*h,S,S*h),F=C?1:Math.max(v,v*h,w,w*h),L=P?1:Math.max(k,k*h,S,S*h);r=(F-T)/2;l=(L-I)/2;s=-(F+T)/2;d=-(L+I)/2}for(x=0,f=c.length;x<f;++x){c[x]._options=t._resolveDataElementOptions(c[x],x)}a.borderWidth=t.getMaxBorderWidth();m=(o.right-o.left-a.borderWidth)/r;b=(o.bottom-o.top-a.borderWidth)/l;a.outerRadius=Math.max(Math.min(m,b)/2,0);a.innerRadius=Math.max(a.outerRadius*h,0);a.radiusLength=(a.outerRadius-a.innerRadius)/(t._getVisibleDatasetWeightTotal()||1);a.offsetX=s*a.outerRadius;a.offsetY=d*a.outerRadius;g.total=t.calculateTotal();t.outerRadius=a.outerRadius-a.radiusLength*t._getRingWeightOffset(t.index);t.innerRadius=Math.max(t.outerRadius-a.radiusLength*u,0);for(x=0,f=c.length;x<f;++x){t.updateElement(c[x],x,e)}},updateElement:function updateElement(e,t,a){var i=this,o=i.chart,n=o.chartArea,r=o.options,l=r.animation,s=(n.left+n.right)/2,d=(n.top+n.bottom)/2,g=r.rotation,c=r.rotation,h=i.getDataset(),p=a&&l.animateRotate?0:e.hidden?0:i.calculateCircumference(h.data[t])*(r.circumference/$a),u=a&&l.animateScale?0:i.innerRadius,m=a&&l.animateScale?0:i.outerRadius,b=e._options||{};wa.extend(e,{_datasetIndex:i.index,_index:t,_model:{backgroundColor:b.backgroundColor,borderColor:b.borderColor,borderWidth:b.borderWidth,borderAlign:b.borderAlign,x:s+o.offsetX,y:d+o.offsetY,startAngle:g,endAngle:c,circumference:p,outerRadius:m,innerRadius:u,label:wa.valueAtIndexOrDefault(h.label,t,o.data.labels[t])}});var x=e._model;if(!a||!l.animateRotate){if(0===t){x.startAngle=r.rotation}else{x.startAngle=i.getMeta().data[t-1]._model.endAngle}x.endAngle=x.startAngle+x.circumference}e.pivot()},calculateTotal:function calculateTotal(){var e=this.getDataset(),t=this.getMeta(),a=0,i;wa.each(t.data,function(t,o){i=e.data[o];if(!isNaN(i)&&!t.hidden){a+=Math.abs(i)}});return a},calculateCircumference:function calculateCircumference(e){var t=this.getMeta().total;if(0<t&&!isNaN(e)){return $a*(Math.abs(e)/t)}return 0},getMaxBorderWidth:function getMaxBorderWidth(e){var t=this,a=0,o=t.chart,n,r,l,s,d,g,c,h;if(!e){for(n=0,r=o.data.datasets.length;n<r;++n){if(o.isDatasetVisible(n)){l=o.getDatasetMeta(n);e=l.data;if(n!==t.index){d=l.controller}break}}}if(!e){return 0}for(n=0,r=e.length;n<r;++n){s=e[n];if(d){d._configure();g=d._resolveDataElementOptions(s,n)}else{g=s._options}if("inner"!==g.borderAlign){c=g.borderWidth;h=g.hoverBorderWidth;a=c>a?c:a;a=h>a?h:a}}return a},setHoverStyle:function setHoverStyle(e){var t=e._model,a=e._options,i=wa.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth};t.backgroundColor=Za(a.hoverBackgroundColor,i(a.backgroundColor));t.borderColor=Za(a.hoverBorderColor,i(a.borderColor));t.borderWidth=Za(a.hoverBorderWidth,a.borderWidth)},_getRingWeightOffset:function _getRingWeightOffset(e){for(var t=0,a=0;a<e;++a){if(this.chart.isDatasetVisible(a)){t+=this._getRingWeight(a)}}return t},_getRingWeight:function _getRingWeight(e){return Math.max(Za(this.chart.data.datasets[e].weight,1),0)},_getVisibleDatasetWeightTotal:function _getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)}});fa._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{type:"category",position:"left",offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{mode:"index",axis:"y"}});fa._set("global",{datasets:{horizontalBar:{categoryPercentage:.8,barPercentage:.9}}});var ti=Ua.extend({_getValueScaleId:function _getValueScaleId(){return this.getMeta().xAxisID},_getIndexScaleId:function _getIndexScaleId(){return this.getMeta().yAxisID}}),ai=wa.valueOrDefault,ii=wa.options.resolve,oi=wa.canvas._isPointInArea;fa._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});function z(e,t){var a=e&&e.options.ticks||{},i=a.reverse,o=a.min===void 0?t:0,n=a.max===void 0?t:0;return{start:i?n:o,end:i?o:n}}function E(e,t,a){var i=a/2,o=z(e,i),n=z(t,i);return{top:n.end,right:o.end,bottom:n.start,left:o.start}}function B(e){var a,i,o,n;if(wa.isObject(e)){a=e.top;i=e.right;o=e.bottom;n=e.left}else{a=i=o=n=e}return{top:a,right:i,bottom:o,left:n}}var ni=La.extend({datasetElementType:ja.Line,dataElementType:ja.Point,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth","cubicInterpolationMode","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},update:function update(e){var t=this,a=t.getMeta(),o=a.dataset,n=a.data||[],r=t.chart.options,l=t._config,s=t._showLine=ai(l.showLine,r.showLines),d,g;t._xScale=t.getScaleForId(a.xAxisID);t._yScale=t.getScaleForId(a.yAxisID);if(s){if(l.tension!==void 0&&l.lineTension===void 0){l.lineTension=l.tension}o._scale=t._yScale;o._datasetIndex=t.index;o._children=n;o._model=t._resolveDatasetElementOptions(o);o.pivot()}for(d=0,g=n.length;d<g;++d){t.updateElement(n[d],d,e)}if(s&&0!==o._model.tension){t.updateBezierControlPoints()}for(d=0,g=n.length;d<g;++d){n[d].pivot()}},updateElement:function updateElement(e,t,a){var i=this,o=i.getMeta(),n=e.custom||{},r=i.getDataset(),l=i.index,s=r.data[t],d=i._xScale,g=i._yScale,c=o.dataset._model,h,p,u=i._resolveDataElementOptions(e,t);h=d.getPixelForValue("object"===_typeof(s)?s:NaN,t,l);p=a?g.getBasePixel():i.calculatePointY(s,t,l);e._xScale=d;e._yScale=g;e._options=u;e._datasetIndex=l;e._index=t;e._model={x:h,y:p,skip:n.skip||isNaN(h)||isNaN(p),radius:u.radius,pointStyle:u.pointStyle,rotation:u.rotation,backgroundColor:u.backgroundColor,borderColor:u.borderColor,borderWidth:u.borderWidth,tension:ai(n.tension,c?c.tension:0),steppedLine:c?c.steppedLine:!1,hitRadius:u.hitRadius}},_resolveDatasetElementOptions:function _resolveDatasetElementOptions(e){var t=this,a=t._config,i=e.custom||{},o=t.chart.options,n=o.elements.line,r=La.prototype._resolveDatasetElementOptions.apply(t,arguments);r.spanGaps=ai(a.spanGaps,o.spanGaps);r.tension=ai(a.lineTension,n.tension);r.steppedLine=ii([i.steppedLine,a.steppedLine,n.stepped]);r.clip=B(ai(a.clip,E(t._xScale,t._yScale,r.borderWidth)));return r},calculatePointY:function calculatePointY(e,t,a){var o=this,n=o.chart,r=o._yScale,l=0,s=0,d,g,c,h,p,u,m;if(r.options.stacked){p=+r.getRightValue(e);u=n._getSortedVisibleDatasetMetas();m=u.length;for(d=0;d<m;++d){c=u[d];if(c.index===a){break}g=n.data.datasets[c.index];if("line"===c.type&&c.yAxisID===r.id){h=+r.getRightValue(g.data[t]);if(0>h){s+=h||0}else{l+=h||0}}}if(0>p){return r.getPixelForValue(s+p)}return r.getPixelForValue(l+p)}return r.getPixelForValue(e)},updateBezierControlPoints:function updateBezierControlPoints(){var t=this,a=t.chart,o=t.getMeta(),n=o.dataset._model,r=a.chartArea,l=o.data||[],s,d,g,c;if(n.spanGaps){l=l.filter(function(e){return!e._model.skip})}function e(e,t,a){return Math.max(Math.min(e,a),t)}if("monotone"===n.cubicInterpolationMode){wa.splineCurveMonotone(l)}else{for(s=0,d=l.length;s<d;++s){g=l[s]._model;c=wa.splineCurve(wa.previousItem(l,s)._model,g,wa.nextItem(l,s)._model,n.tension);g.controlPointPreviousX=c.previous.x;g.controlPointPreviousY=c.previous.y;g.controlPointNextX=c.next.x;g.controlPointNextY=c.next.y}}if(a.options.elements.line.capBezierPoints){for(s=0,d=l.length;s<d;++s){g=l[s]._model;if(oi(g,r)){if(0<s&&oi(l[s-1]._model,r)){g.controlPointPreviousX=e(g.controlPointPreviousX,r.left,r.right);g.controlPointPreviousY=e(g.controlPointPreviousY,r.top,r.bottom)}if(s<l.length-1&&oi(l[s+1]._model,r)){g.controlPointNextX=e(g.controlPointNextX,r.left,r.right);g.controlPointNextY=e(g.controlPointNextY,r.top,r.bottom)}}}}},draw:function draw(){var e=this,t=e.chart,a=e.getMeta(),o=a.data||[],n=t.chartArea,r=t.canvas,l=0,s=o.length,d;if(e._showLine){d=a.dataset._model.clip;wa.canvas.clipArea(t.ctx,{left:!1===d.left?0:n.left-d.left,right:!1===d.right?r.width:n.right+d.right,top:!1===d.top?0:n.top-d.top,bottom:!1===d.bottom?r.height:n.bottom+d.bottom});a.dataset.draw();wa.canvas.unclipArea(t.ctx)}for(;l<s;++l){o[l].draw(n)}},setHoverStyle:function setHoverStyle(e){var t=e._model,a=e._options,i=wa.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius};t.backgroundColor=ai(a.hoverBackgroundColor,i(a.backgroundColor));t.borderColor=ai(a.hoverBorderColor,i(a.borderColor));t.borderWidth=ai(a.hoverBorderWidth,a.borderWidth);t.radius=ai(a.hoverRadius,a.radius)}}),ri=wa.options.resolve;fa._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function legendCallback(e){var t=document.createElement("ul"),a=e.data,o=a.datasets,n=a.labels,r,l,s,d;t.setAttribute("class",e.id+"-legend");if(o.length){for(r=0,l=o[0].data.length;r<l;++r){s=t.appendChild(document.createElement("li"));d=s.appendChild(document.createElement("span"));d.style.backgroundColor=o[0].backgroundColor[r];if(n[r]){s.appendChild(document.createTextNode(n[r]))}}}return t.outerHTML},legend:{labels:{generateLabels:function generateLabels(e){var t=e.data;if(t.labels.length&&t.datasets.length){return t.labels.map(function(a,o){var i=e.getDatasetMeta(0),n=i.controller.getStyle(o);return{text:a,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,lineWidth:n.borderWidth,hidden:isNaN(t.datasets[0].data[o])||i.data[o].hidden,index:o}})}return[]}},onClick:function onClick(t,e){var a=e.index,o=this.chart,n,r,l;for(n=0,r=(o.data.datasets||[]).length;n<r;++n){l=o.getDatasetMeta(n);l.data[a].hidden=!l.data[a].hidden}o.update()}},tooltips:{callbacks:{title:function title(){return""},label:function label(e,t){return t.labels[e.index]+": "+e.yLabel}}}});var li=La.extend({dataElementType:ja.Arc,linkScales:wa.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],_getIndexScaleId:function _getIndexScaleId(){return this.chart.scale.id},_getValueScaleId:function _getValueScaleId(){return this.chart.scale.id},update:function update(e){var t=this,a=t.getDataset(),o=t.getMeta(),n=t.chart.options.startAngle||0,r=t._starts=[],l=t._angles=[],s=o.data,d,g,c;t._updateRadius();o.count=t.countVisibleElements();for(d=0,g=a.data.length;d<g;d++){r[d]=n;c=t._computeAngle(d);l[d]=c;n+=c}for(d=0,g=s.length;d<g;++d){s[d]._options=t._resolveDataElementOptions(s[d],d);t.updateElement(s[d],d,e)}},_updateRadius:function _updateRadius(){var e=this,t=e.chart,a=t.chartArea,i=t.options,o=Math.min(a.right-a.left,a.bottom-a.top);t.outerRadius=Math.max(o/2,0);t.innerRadius=Math.max(i.cutoutPercentage?t.outerRadius/100*i.cutoutPercentage:1,0);t.radiusLength=(t.outerRadius-t.innerRadius)/t.getVisibleDatasetCount();e.outerRadius=t.outerRadius-t.radiusLength*e.index;e.innerRadius=e.outerRadius-t.radiusLength},updateElement:function updateElement(e,t,a){var i=this,o=i.chart,n=i.getDataset(),r=o.options,l=r.animation,s=o.scale,d=o.data.labels,g=s.xCenter,c=s.yCenter,h=r.startAngle,p=e.hidden?0:s.getDistanceFromCenterForValue(n.data[t]),u=i._starts[t],m=u+(e.hidden?0:i._angles[t]),b=l.animateScale?0:s.getDistanceFromCenterForValue(n.data[t]),x=e._options||{};wa.extend(e,{_datasetIndex:i.index,_index:t,_scale:s,_model:{backgroundColor:x.backgroundColor,borderColor:x.borderColor,borderWidth:x.borderWidth,borderAlign:x.borderAlign,x:g,y:c,innerRadius:0,outerRadius:a?b:p,startAngle:a&&l.animateRotate?h:u,endAngle:a&&l.animateRotate?h:m,label:wa.valueAtIndexOrDefault(d,t,d[t])}});e.pivot()},countVisibleElements:function countVisibleElements(){var e=this.getDataset(),t=this.getMeta(),a=0;wa.each(t.data,function(t,i){if(!isNaN(e.data[i])&&!t.hidden){a++}});return a},setHoverStyle:function setHoverStyle(e){var t=e._model,a=e._options,i=wa.getHoverColor,o=wa.valueOrDefault;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth};t.backgroundColor=o(a.hoverBackgroundColor,i(a.backgroundColor));t.borderColor=o(a.hoverBorderColor,i(a.borderColor));t.borderWidth=o(a.hoverBorderWidth,a.borderWidth)},_computeAngle:function _computeAngle(e){var t=this,a=this.getMeta().count,i=t.getDataset(),o=t.getMeta();if(isNaN(i.data[e])||o.data[e].hidden){return 0}var n={chart:t.chart,dataIndex:e,dataset:i,datasetIndex:t.index};return ri([t.chart.options.elements.arc.angle,2*Math.PI/a],n,e)}});fa._set("pie",wa.clone(fa.doughnut));fa._set("pie",{cutoutPercentage:0});var si=wa.valueOrDefault;fa._set("radar",{spanGaps:!1,scale:{type:"radialLinear"},elements:{line:{fill:"start",tension:0}}});var di=La.extend({datasetElementType:ja.Line,dataElementType:ja.Point,linkScales:wa.noop,_datasetElementOptions:["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},_getIndexScaleId:function _getIndexScaleId(){return this.chart.scale.id},_getValueScaleId:function _getValueScaleId(){return this.chart.scale.id},update:function update(e){var t=this,a=t.getMeta(),o=a.dataset,n=a.data||[],r=t.chart.scale,l=t._config,s,d;if(l.tension!==void 0&&l.lineTension===void 0){l.lineTension=l.tension}o._scale=r;o._datasetIndex=t.index;o._children=n;o._loop=!0;o._model=t._resolveDatasetElementOptions(o);o.pivot();for(s=0,d=n.length;s<d;++s){t.updateElement(n[s],s,e)}t.updateBezierControlPoints();for(s=0,d=n.length;s<d;++s){n[s].pivot()}},updateElement:function updateElement(e,t,a){var i=this,o=e.custom||{},n=i.getDataset(),r=i.chart.scale,l=r.getPointPositionForValue(t,n.data[t]),s=i._resolveDataElementOptions(e,t),d=i.getMeta().dataset._model,g=a?r.xCenter:l.x,c=a?r.yCenter:l.y;e._scale=r;e._options=s;e._datasetIndex=i.index;e._index=t;e._model={x:g,y:c,skip:o.skip||isNaN(g)||isNaN(c),radius:s.radius,pointStyle:s.pointStyle,rotation:s.rotation,backgroundColor:s.backgroundColor,borderColor:s.borderColor,borderWidth:s.borderWidth,tension:si(o.tension,d?d.tension:0),hitRadius:s.hitRadius}},_resolveDatasetElementOptions:function _resolveDatasetElementOptions(){var e=this,t=e._config,a=e.chart.options,i=La.prototype._resolveDatasetElementOptions.apply(e,arguments);i.spanGaps=si(t.spanGaps,a.spanGaps);i.tension=si(t.lineTension,a.elements.line.tension);return i},updateBezierControlPoints:function updateBezierControlPoints(){var t=this,a=t.getMeta(),o=t.chart.chartArea,n=a.data||[],r,l,s,d;if(a.dataset._model.spanGaps){n=n.filter(function(e){return!e._model.skip})}function e(e,t,a){return Math.max(Math.min(e,a),t)}for(r=0,l=n.length;r<l;++r){s=n[r]._model;d=wa.splineCurve(wa.previousItem(n,r,!0)._model,s,wa.nextItem(n,r,!0)._model,s.tension);s.controlPointPreviousX=e(d.previous.x,o.left,o.right);s.controlPointPreviousY=e(d.previous.y,o.top,o.bottom);s.controlPointNextX=e(d.next.x,o.left,o.right);s.controlPointNextY=e(d.next.y,o.top,o.bottom)}},setHoverStyle:function setHoverStyle(e){var t=e._model,a=e._options,i=wa.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius};t.backgroundColor=si(a.hoverBackgroundColor,i(a.backgroundColor));t.borderColor=si(a.hoverBorderColor,i(a.borderColor));t.borderWidth=si(a.hoverBorderWidth,a.borderWidth);t.radius=si(a.hoverRadius,a.radius)}});fa._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},tooltips:{callbacks:{title:function title(){return""},label:function label(e){return"("+e.xLabel+", "+e.yLabel+")"}}}});fa._set("global",{datasets:{scatter:{showLine:!1}}});var gi={bar:Ua,bubble:Ga,doughnut:ei,horizontalBar:ti,line:ni,polarArea:li,pie:ei,radar:di,scatter:ni};function W(t,e){if(t.native){return{x:t.x,y:t.y}}return wa.getRelativePosition(t,e)}function V(e,t){var a=e._getSortedVisibleDatasetMetas(),o,n,r,l,s,d;for(n=0,l=a.length;n<l;++n){o=a[n].data;for(r=0,s=o.length;r<s;++r){d=o[r];if(!d._view.skip){t(d)}}}}function M(e,t){var a=[];V(e,function(e){if(e.inRange(t.x,t.y)){a.push(e)}});return a}function H(e,t,a,i){var o=Number.POSITIVE_INFINITY,n=[];V(e,function(e){if(a&&!e.inRange(t.x,t.y)){return}var r=e.getCenterPoint(),l=i(t,r);if(l<o){n=[e];o=l}else if(l===o){n.push(e)}});return n}function N(e){var t=-1!==e.indexOf("x"),a=-1!==e.indexOf("y");return function(e,i){var o=t?Math.abs(e.x-i.x):0,n=a?Math.abs(e.y-i.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(n,2))}}function j(t,a,e){var i=W(a,t);e.axis=e.axis||"x";var o=N(e.axis),n=e.intersect?M(t,i):H(t,i,!1,o),r=[];if(!n.length){return[]}t._getSortedVisibleDatasetMetas().forEach(function(e){var t=e.data[n[0]._index];if(t&&!t._view.skip){r.push(t)}});return r}var ci={modes:{single:function single(t,a){var e=W(a,t),i=[];V(t,function(t){if(t.inRange(e.x,e.y)){i.push(t);return i}});return i.slice(0,1)},label:j,index:j,dataset:function dataset(t,a,e){var i=W(a,t);e.axis=e.axis||"xy";var o=N(e.axis),n=e.intersect?M(t,i):H(t,i,!1,o);if(0<n.length){n=t.getDatasetMeta(n[0]._datasetIndex).data}return n},"x-axis":function xAxis(t,a){return j(t,a,{intersect:!1})},point:function point(t,a){var e=W(a,t);return M(t,e)},nearest:function nearest(t,a,e){var i=W(a,t);e.axis=e.axis||"xy";var o=N(e.axis);return H(t,i,e.intersect,o)},x:function x(t,a,e){var i=W(a,t),o=[],n=!1;V(t,function(e){if(e.inXRange(i.x)){o.push(e)}if(e.inRange(i.x,i.y)){n=!0}});if(e.intersect&&!n){o=[]}return o},y:function y(t,a,e){var i=W(a,t),o=[],n=!1;V(t,function(e){if(e.inYRange(i.y)){o.push(e)}if(e.inRange(i.x,i.y)){n=!0}});if(e.intersect&&!n){o=[]}return o}}},hi=wa.extend;function Y(e,t){return wa.where(e,function(e){return e.pos===t})}function q(e,t){return e.sort(function(e,a){var i=t?a:e,o=t?e:a;return i.weight===o.weight?i.index-o.index:i.weight-o.weight})}function U(e){var t=[],a,o,n;for(a=0,o=(e||[]).length;a<o;++a){n=e[a];t.push({index:a,box:n,pos:n.position,horizontal:n.isHorizontal(),weight:n.weight})}return t}function K(e,t){var a,o,n;for(a=0,o=e.length;a<o;++a){n=e[a];n.width=n.horizontal?n.box.fullWidth&&t.availableWidth:t.vBoxMaxWidth;n.height=n.horizontal&&t.hBoxMaxHeight}}function X(e){var t=U(e),a=q(Y(t,"left"),!0),i=q(Y(t,"right")),o=q(Y(t,"top"),!0),n=q(Y(t,"bottom"));return{leftAndTop:a.concat(o),rightAndBottom:i.concat(n),chartArea:Y(t,"chartArea"),vertical:a.concat(i),horizontal:o.concat(n)}}function G(e,t,i,a){return Math.max(e[i],t[i])+Math.max(e[a],t[a])}function Z(e,t,a){var i=a.box,o=e.maxPadding,n,r;if(a.size){e[a.pos]-=a.size}a.size=a.horizontal?i.height:i.width;e[a.pos]+=a.size;if(i.getPadding){var l=i.getPadding();o.top=Math.max(o.top,l.top);o.left=Math.max(o.left,l.left);o.bottom=Math.max(o.bottom,l.bottom);o.right=Math.max(o.right,l.right)}n=t.outerWidth-G(o,e,"left","right");r=t.outerHeight-G(o,e,"top","bottom");if(n!==e.w||r!==e.h){e.w=n;e.h=r;var s=a.horizontal?[n,e.w]:[r,e.h];return s[0]!==s[1]&&(!isNaN(s[0])||!isNaN(s[1]))}}function J(e){var a=e.maxPadding;function t(t){var i=Math.max(a[t]-e[t],0);e[t]+=i;return i}e.y+=t("top");e.x+=t("left");t("right");t("bottom")}function $(e,t){var i=t.maxPadding;function a(e){var a={left:0,top:0,right:0,bottom:0};e.forEach(function(e){a[e]=Math.max(t[e],i[e])});return a}return e?a(["left","right"]):a(["top","bottom"])}function Q(e,t,a){var o=[],n,r,l,s,d,g;for(n=0,r=e.length;n<r;++n){l=e[n];s=l.box;s.update(l.width||t.w,l.height||t.h,$(l.horizontal,t));if(Z(t,a,l)){g=!0;if(o.length){d=!0}}if(!s.fullWidth){o.push(l)}}return d?Q(o,t,a)||g:g}function ee(e,t,a){var o=a.padding,n=t.x,r=t.y,l,s,d,g;for(l=0,s=e.length;l<s;++l){d=e[l];g=d.box;if(d.horizontal){g.left=g.fullWidth?o.left:t.left;g.right=g.fullWidth?a.outerWidth-o.right:t.left+t.w;g.top=r;g.bottom=r+g.height;g.width=g.right-g.left;r=g.bottom}else{g.left=n;g.right=n+g.width;g.top=t.top;g.bottom=t.top+t.h;g.height=g.bottom-g.top;n=g.right}}t.x=n;t.y=r}fa._set("global",{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var pi={defaults:{},addBox:function addBox(e,t){if(!e.boxes){e.boxes=[]}t.fullWidth=t.fullWidth||!1;t.position=t.position||"top";t.weight=t.weight||0;t._layers=t._layers||function(){return[{z:0,draw:function draw(){t.draw.apply(t,arguments)}}]};e.boxes.push(t)},removeBox:function removeBox(e,t){var a=e.boxes?e.boxes.indexOf(t):-1;if(-1!==a){e.boxes.splice(a,1)}},configure:function configure(e,t,a){var o=["fullWidth","position","weight"],n=o.length,r=0,l;for(;r<n;++r){l=o[r];if(a.hasOwnProperty(l)){t[l]=a[l]}}},update:function update(e,t,a){if(!e){return}var i=e.options.layout||{},o=wa.options.toPadding(i.padding),n=t-o.width,r=a-o.height,l=X(e.boxes),s=l.vertical,d=l.horizontal,g=Object.freeze({outerWidth:t,outerHeight:a,padding:o,availableWidth:n,vBoxMaxWidth:n/2/s.length,hBoxMaxHeight:r/2}),c=hi({maxPadding:hi({},o),w:n,h:r,x:o.left,y:o.top},o);K(s.concat(d),g);Q(s,c,g);if(Q(d,c,g)){Q(s,c,g)}J(c);ee(l.leftAndTop,c,g);c.x+=c.w;c.y+=c.h;ee(l.rightAndBottom,c,g);e.chartArea={left:c.left,top:c.top,right:c.left+c.w,bottom:c.top+c.h};wa.each(l.chartArea,function(t){var a=t.box;hi(a,e.chartArea);a.update(c.w,c.h)})}},ui=Object.freeze({__proto__:null,default:"/*\r\n * DOM element rendering detection\r\n * https://davidwalsh.name/detect-node-insertion\r\n */\r\n@keyframes chartjs-render-animation {\r\n\tfrom { opacity: 0.99; }\r\n\tto { opacity: 1; }\r\n}\r\n\r\n.chartjs-render-monitor {\r\n\tanimation: chartjs-render-animation 0.001s;\r\n}\r\n\r\n/*\r\n * DOM element resizing detection\r\n * https://github.com/marcj/css-element-queries\r\n */\r\n.chartjs-size-monitor,\r\n.chartjs-size-monitor-expand,\r\n.chartjs-size-monitor-shrink {\r\n\tposition: absolute;\r\n\tdirection: ltr;\r\n\tleft: 0;\r\n\ttop: 0;\r\n\tright: 0;\r\n\tbottom: 0;\r\n\toverflow: hidden;\r\n\tpointer-events: none;\r\n\tvisibility: hidden;\r\n\tz-index: -1;\r\n}\r\n\r\n.chartjs-size-monitor-expand > div {\r\n\tposition: absolute;\r\n\twidth: 1000000px;\r\n\theight: 1000000px;\r\n\tleft: 0;\r\n\ttop: 0;\r\n}\r\n\r\n.chartjs-size-monitor-shrink > div {\r\n\tposition: absolute;\r\n\twidth: 200%;\r\n\theight: 200%;\r\n\tleft: 0;\r\n\ttop: 0;\r\n}\r\n"}),mi=function(e){return e&&e["default"]||e}(ui),bi="$chartjs",xi="chartjs-",fi=xi+"size-monitor",yi=xi+"render-monitor",_i=["animationstart","webkitAnimationStart"],vi={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function te(e,t){var a=wa.getStyle(e,t),i=a&&a.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function ae(e,t){var a=e.style,i=e.getAttribute("height"),o=e.getAttribute("width");e[bi]={initial:{height:i,width:o,style:{display:a.display,height:a.height,width:a.width}}};a.display=a.display||"block";if(null===o||""===o){var n=te(e,"width");if(n!==void 0){e.width=n}}if(null===i||""===i){if(""===e.style.height){e.height=e.width/(t.options.aspectRatio||2)}else{var r=te(e,"height");if(n!==void 0){e.height=r}}}return e}var ki=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function get(){e=!0}});window.addEventListener("e",null,t)}catch(t){}return e}(),wi=ki?{passive:!0}:!1;function ie(e,t,a){e.addEventListener(t,a,wi)}function oe(e,t,a){e.removeEventListener(t,a,wi)}function ne(e,t,a,i,o){return{type:e,chart:t,native:o||null,x:a!==void 0?a:null,y:i!==void 0?i:null}}function re(e,t){var a=vi[e.type]||e.type,i=wa.getRelativePosition(e,t);return ne(a,t,i.x,i.y,e)}function le(e,t){var a=!1,i=[];return function(){i=Array.prototype.slice.call(arguments);t=t||this;if(!a){a=!0;wa.requestAnimFrame.call(window,function(){a=!1;e.apply(t,i)})}}}function se(e){var t=document.createElement("div");t.className=e||"";return t}function de(e){var t=se(fi),a=se(fi+"-expand"),i=se(fi+"-shrink");a.appendChild(se());i.appendChild(se());t.appendChild(a);t.appendChild(i);t._reset=function(){a.scrollLeft=1000000;a.scrollTop=1000000;i.scrollLeft=1000000;i.scrollTop=1000000};var o=function(){t._reset();e()};ie(a,"scroll",o.bind(a,"expand"));ie(i,"scroll",o.bind(i,"shrink"));return t}function ge(e,t){var a=e[bi]||(e[bi]={}),i=a.renderProxy=function(a){if(a.animationName===xi+"render-animation"){t()}};wa.each(_i,function(t){ie(e,t,i)});a.reflow=!!e.offsetParent;e.classList.add(yi)}function ce(e){var t=e[bi]||{},a=t.renderProxy;if(a){wa.each(_i,function(t){oe(e,t,a)});delete t.renderProxy}e.classList.remove(yi)}function he(e,t,a){var i=e[bi]||(e[bi]={}),o=i.resizer=de(le(function(){if(i.resizer){var o=a.options.maintainAspectRatio&&e.parentNode,n=o?o.clientWidth:0;t(ne("resize",a));if(o&&o.clientWidth<n&&a.canvas){t(ne("resize",a))}}}));ge(e,function(){if(i.resizer){var t=e.parentNode;if(t&&t!==o.parentNode){t.insertBefore(o,t.firstChild)}o._reset()}})}function pe(e){var t=e[bi]||{},a=t.resizer;delete t.resizer;ce(e);if(a&&a.parentNode){a.parentNode.removeChild(a)}}function ue(e,t){var a=e[bi]||(e[bi]={});if(!a.containsStyles){a.containsStyles=!0;t="/* Chart.js */\n"+t;var i=document.createElement("style");i.setAttribute("type","text/css");i.appendChild(document.createTextNode(t));e.appendChild(i)}}var Si={disableCSSInjection:!1,_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,_ensureLoaded:function _ensureLoaded(e){if(!this.disableCSSInjection){var t=e.getRootNode?e.getRootNode():document,a=t.host?t:document.head;ue(a,mi)}},acquireContext:function acquireContext(e,t){if("string"==typeof e){e=document.getElementById(e)}else if(e.length){e=e[0]}if(e&&e.canvas){e=e.canvas}var a=e&&e.getContext&&e.getContext("2d");if(a&&a.canvas===e){this._ensureLoaded(e);ae(e,t);return a}return null},releaseContext:function releaseContext(e){var t=e.canvas;if(!t[bi]){return}var a=t[bi].initial;["height","width"].forEach(function(e){var i=a[e];if(wa.isNullOrUndef(i)){t.removeAttribute(e)}else{t.setAttribute(e,i)}});wa.each(a.style||{},function(e,a){t.style[a]=e});t.width=t.width;delete t[bi]},addEventListener:function addEventListener(e,t,a){var i=e.canvas;if("resize"===t){he(i,a,e);return}var o=a[bi]||(a[bi]={}),n=o.proxies||(o.proxies={}),r=n[e.id+"_"+t]=function(t){a(re(t,e))};ie(i,t,r)},removeEventListener:function removeEventListener(e,t,a){var i=e.canvas;if("resize"===t){pe(i);return}var o=a[bi]||{},n=o.proxies||{},r=n[e.id+"_"+t];if(!r){return}oe(i,t,r)}};wa.addEvent=ie;wa.removeEvent=oe;var Ci=Si._enabled?Si:{acquireContext:function acquireContext(e){if(e&&e.canvas){e=e.canvas}return e&&e.getContext("2d")||null}},Pi=wa.extend({initialize:function initialize(){},acquireContext:function acquireContext(){},releaseContext:function releaseContext(){},addEventListener:function addEventListener(){},removeEventListener:function removeEventListener(){}},Ci);fa._set("global",{plugins:{}});var Ai={_plugins:[],_cacheId:0,register:function register(e){var t=this._plugins;[].concat(e).forEach(function(e){if(-1===t.indexOf(e)){t.push(e)}});this._cacheId++},unregister:function unregister(e){var t=this._plugins;[].concat(e).forEach(function(e){var a=t.indexOf(e);if(-1!==a){t.splice(a,1)}});this._cacheId++},clear:function clear(){this._plugins=[];this._cacheId++},count:function count(){return this._plugins.length},getAll:function getAll(){return this._plugins},notify:function notify(e,t,a){var o=this.descriptors(e),n=o.length,r,l,s,d,g;for(r=0;r<n;++r){l=o[r];s=l.plugin;g=s[t];if("function"==typeof g){d=[e].concat(a||[]);d.push(l.options);if(!1===g.apply(s,d)){return!1}}}return!0},descriptors:function(e){var t=e.$plugins||(e.$plugins={});if(t.id===this._cacheId){return t.descriptors}var a=[],i=[],o=e&&e.config||{},n=o.options&&o.options.plugins||{};this._plugins.concat(o.plugins||[]).forEach(function(e){var t=a.indexOf(e);if(-1!==t){return}var o=e.id,r=n[o];if(!1===r){return}if(!0===r){r=wa.clone(fa.global.plugins[o])}a.push(e);i.push({plugin:e,options:r||{}})});t.descriptors=i;t.id=this._cacheId;return i},_invalidate:function _invalidate(e){delete e.$plugins}},Di={constructors:{},defaults:{},registerScaleType:function registerScaleType(e,t,a){this.constructors[e]=t;this.defaults[e]=wa.clone(a)},getScaleConstructor:function getScaleConstructor(e){return this.constructors.hasOwnProperty(e)?this.constructors[e]:void 0},getScaleDefaults:function getScaleDefaults(e){return this.defaults.hasOwnProperty(e)?wa.merge(Object.create(null),[fa.scale,this.defaults[e]]):{}},updateScaleDefaults:function updateScaleDefaults(e,t){var a=this;if(a.defaults.hasOwnProperty(e)){a.defaults[e]=wa.extend(a.defaults[e],t)}},addScalesToLayout:function addScalesToLayout(e){wa.each(e.scales,function(t){t.fullWidth=t.options.fullWidth;t.position=t.options.position;t.weight=t.options.weight;pi.addBox(e,t)})}},Ti=wa.valueOrDefault,Ii=wa.rtl.getRtlAdapter;fa._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:wa.noop,title:function(e,t){var a="",i=t.labels,o=i?i.length:0;if(0<e.length){var n=e[0];if(n.label){a=n.label}else if(n.xLabel){a=n.xLabel}else if(0<o&&n.index<o){a=i[n.index]}}return a},afterTitle:wa.noop,beforeBody:wa.noop,beforeLabel:wa.noop,label:function(e,t){var a=t.datasets[e.datasetIndex].label||"";if(a){a+=": "}if(!wa.isNullOrUndef(e.value)){a+=e.value}else{a+=e.yLabel}return a},labelColor:function labelColor(e,t){var a=t.getDatasetMeta(e.datasetIndex),i=a.data[e.index],o=i._view;return{borderColor:o.borderColor,backgroundColor:o.backgroundColor}},labelTextColor:function labelTextColor(){return this._options.bodyFontColor},afterLabel:wa.noop,afterBody:wa.noop,beforeFooter:wa.noop,footer:wa.noop,afterFooter:wa.noop}}});var Fi={average:function average(e){if(!e.length){return!1}var t,a,o=0,n=0,r=0;for(t=0,a=e.length;t<a;++t){var l=e[t];if(l&&l.hasValue()){var s=l.tooltipPosition();o+=s.x;n+=s.y;++r}}return{x:o/r,y:n/r}},nearest:function nearest(e,t){var a=t.x,o=t.y,n=Number.POSITIVE_INFINITY,r,l,s;for(r=0,l=e.length;r<l;++r){var g=e[r];if(g&&g.hasValue()){var c=g.getCenterPoint(),h=wa.distanceBetweenPoints(t,c);if(h<n){n=h;s=g}}}if(s){var d=s.tooltipPosition();a=d.x;o=d.y}return{x:a,y:o}}};function be(e,t){if(t){if(wa.isArray(t)){Array.prototype.push.apply(e,t)}else{e.push(t)}}return e}function xe(e){if(("string"==typeof e||e instanceof String)&&-1<e.indexOf("\n")){return e.split("\n")}return e}function fe(e){var t=e._xScale,a=e._yScale||e._scale,i=e._index,o=e._datasetIndex,n=e._chart.getDatasetMeta(o).controller,r=n._getIndexScale(),l=n._getValueScale();return{xLabel:t?t.getLabelForIndex(i,o):"",yLabel:a?a.getLabelForIndex(i,o):"",label:r?""+r.getLabelForIndex(i,o):"",value:l?""+l.getLabelForIndex(i,o):"",index:i,datasetIndex:o,x:e._model.x,y:e._model.y}}function ye(e){var t=fa.global;return{xPadding:e.xPadding,yPadding:e.yPadding,xAlign:e.xAlign,yAlign:e.yAlign,rtl:e.rtl,textDirection:e.textDirection,bodyFontColor:e.bodyFontColor,_bodyFontFamily:Ti(e.bodyFontFamily,t.defaultFontFamily),_bodyFontStyle:Ti(e.bodyFontStyle,t.defaultFontStyle),_bodyAlign:e.bodyAlign,bodyFontSize:Ti(e.bodyFontSize,t.defaultFontSize),bodySpacing:e.bodySpacing,titleFontColor:e.titleFontColor,_titleFontFamily:Ti(e.titleFontFamily,t.defaultFontFamily),_titleFontStyle:Ti(e.titleFontStyle,t.defaultFontStyle),titleFontSize:Ti(e.titleFontSize,t.defaultFontSize),_titleAlign:e.titleAlign,titleSpacing:e.titleSpacing,titleMarginBottom:e.titleMarginBottom,footerFontColor:e.footerFontColor,_footerFontFamily:Ti(e.footerFontFamily,t.defaultFontFamily),_footerFontStyle:Ti(e.footerFontStyle,t.defaultFontStyle),footerFontSize:Ti(e.footerFontSize,t.defaultFontSize),_footerAlign:e.footerAlign,footerSpacing:e.footerSpacing,footerMarginTop:e.footerMarginTop,caretSize:e.caretSize,cornerRadius:e.cornerRadius,backgroundColor:e.backgroundColor,opacity:0,legendColorBackground:e.multiKeyBackground,displayColors:e.displayColors,borderColor:e.borderColor,borderWidth:e.borderWidth}}function _e(e,t){var a=e._chart.ctx,i=2*t.yPadding,o=0,n=t.body,r=n.reduce(function(e,t){return e+t.before.length+t.lines.length+t.after.length},0);r+=t.beforeBody.length+t.afterBody.length;var l=t.title.length,s=t.footer.length,d=t.titleFontSize,g=t.bodyFontSize,c=t.footerFontSize;i+=l*d;i+=l?(l-1)*t.titleSpacing:0;i+=l?t.titleMarginBottom:0;i+=r*g;i+=r?(r-1)*t.bodySpacing:0;i+=s?t.footerMarginTop:0;i+=s*c;i+=s?(s-1)*t.footerSpacing:0;var h=0,p=function(e){o=Math.max(o,a.measureText(e).width+h)};a.font=wa.fontString(d,t._titleFontStyle,t._titleFontFamily);wa.each(t.title,p);a.font=wa.fontString(g,t._bodyFontStyle,t._bodyFontFamily);wa.each(t.beforeBody.concat(t.afterBody),p);h=t.displayColors?g+2:0;wa.each(n,function(e){wa.each(e.before,p);wa.each(e.lines,p);wa.each(e.after,p)});h=0;a.font=wa.fontString(c,t._footerFontStyle,t._footerFontFamily);wa.each(t.footer,p);o+=2*t.xPadding;return{width:o,height:i}}function ve(e,t){var a=e._model,i=e._chart,o=e._chart.chartArea,n="center",r="center";if(a.y<t.height){r="top"}else if(a.y>i.height-t.height){r="bottom"}var l,s,d,g,c,h=(o.left+o.right)/2,p=(o.top+o.bottom)/2;if("center"===r){l=function(e){return e<=h};s=function(e){return e>h}}else{l=function(e){return e<=t.width/2};s=function(e){return e>=i.width-t.width/2}}d=function(e){return e+t.width+a.caretSize+a.caretPadding>i.width};g=function(e){return 0>e-t.width-a.caretSize-a.caretPadding};c=function(e){return e<=p?"top":"bottom"};if(l(a.x)){n="left";if(d(a.x)){n="center";r=c(a.y)}}else if(s(a.x)){n="right";if(g(a.x)){n="center";r=c(a.y)}}var u=e._options;return{xAlign:u.xAlign?u.xAlign:n,yAlign:u.yAlign?u.yAlign:r}}function ke(e,t,a,i){var o=e.x,n=e.y,r=e.caretSize,l=e.caretPadding,s=e.cornerRadius,d=a.xAlign,g=a.yAlign,c=r+l,h=s+l;if("right"===d){o-=t.width}else if("center"===d){o-=t.width/2;if(o+t.width>i.width){o=i.width-t.width}if(0>o){o=0}}if("top"===g){n+=c}else if("bottom"===g){n-=t.height+c}else{n-=t.height/2}if("center"===g){if("left"===d){o+=c}else if("right"===d){o-=c}}else if("left"===d){o-=h}else if("right"===d){o+=h}return{x:o,y:n}}function we(e,t){return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-e.xPadding:e.x+e.xPadding}function Se(e){return be([],xe(e))}var Li=Ca.extend({initialize:function initialize(){this._model=ye(this._options);this._lastActive=[]},getTitle:function getTitle(){var e=this,t=e._options,a=t.callbacks,i=a.beforeTitle.apply(e,arguments),o=a.title.apply(e,arguments),n=a.afterTitle.apply(e,arguments),r=[];r=be(r,xe(i));r=be(r,xe(o));r=be(r,xe(n));return r},getBeforeBody:function getBeforeBody(){return Se(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function getBody(e,t){var a=this,i=a._options.callbacks,o=[];wa.each(e,function(e){var n={before:[],lines:[],after:[]};be(n.before,xe(i.beforeLabel.call(a,e,t)));be(n.lines,i.label.call(a,e,t));be(n.after,xe(i.afterLabel.call(a,e,t)));o.push(n)});return o},getAfterBody:function getAfterBody(){return Se(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function getFooter(){var e=this,t=e._options.callbacks,a=t.beforeFooter.apply(e,arguments),i=t.footer.apply(e,arguments),o=t.afterFooter.apply(e,arguments),n=[];n=be(n,xe(a));n=be(n,xe(i));n=be(n,xe(o));return n},update:function update(e){var t=this,o=t._options,n=t._model,r=t._model=ye(o),l=t._active,s=t._data,d={xAlign:n.xAlign,yAlign:n.yAlign},g={x:n.x,y:n.y},c={width:n.width,height:n.height},h={x:n.caretX,y:n.caretY},p,a;if(l.length){r.opacity=1;var u=[],m=[];h=Fi[o.position].call(t,l,t._eventPosition);var b=[];for(p=0,a=l.length;p<a;++p){b.push(fe(l[p]))}if(o.filter){b=b.filter(function(e){return o.filter(e,s)})}if(o.itemSort){b=b.sort(function(e,t){return o.itemSort(e,t,s)})}wa.each(b,function(e){u.push(o.callbacks.labelColor.call(t,e,t._chart));m.push(o.callbacks.labelTextColor.call(t,e,t._chart))});r.title=t.getTitle(b,s);r.beforeBody=t.getBeforeBody(b,s);r.body=t.getBody(b,s);r.afterBody=t.getAfterBody(b,s);r.footer=t.getFooter(b,s);r.x=h.x;r.y=h.y;r.caretPadding=o.caretPadding;r.labelColors=u;r.labelTextColors=m;r.dataPoints=b;c=_e(this,r);d=ve(this,c);g=ke(r,c,d,t._chart)}else{r.opacity=0}r.xAlign=d.xAlign;r.yAlign=d.yAlign;r.x=g.x;r.y=g.y;r.width=c.width;r.height=c.height;r.caretX=h.x;r.caretY=h.y;t._model=r;if(e&&o.custom){o.custom.call(t,r)}return t},drawCaret:function drawCaret(e,t){var a=this._chart.ctx,i=this._view,o=this.getCaretPosition(e,t,i);a.lineTo(o.x1,o.y1);a.lineTo(o.x2,o.y2);a.lineTo(o.x3,o.y3)},getCaretPosition:function getCaretPosition(e,t,a){var i,o,n,r,l,s,d=a.caretSize,g=a.cornerRadius,c=a.xAlign,h=a.yAlign,p=e.x,u=e.y,m=t.width,b=t.height;if("center"===h){l=u+b/2;if("left"===c){i=p;o=i-d;n=i;r=l+d;s=l-d}else{i=p+m;o=i+d;n=i;r=l-d;s=l+d}}else{if("left"===c){o=p+g+d;i=o-d;n=o+d}else if("right"===c){o=p+m-g-d;i=o-d;n=o+d}else{o=a.caretX;i=o-d;n=o+d}if("top"===h){r=u;l=r-d;s=r}else{r=u+b;l=r+d;s=r;var x=n;n=i;i=x}}return{x1:i,x2:o,x3:n,y1:r,y2:l,y3:s}},drawTitle:function drawTitle(e,t,a){var o=t.title,n=o.length,r,l,s;if(n){var d=Ii(t.rtl,t.x,t.width);e.x=we(t,t._titleAlign);a.textAlign=d.textAlign(t._titleAlign);a.textBaseline="middle";r=t.titleFontSize;l=t.titleSpacing;a.fillStyle=t.titleFontColor;a.font=wa.fontString(r,t._titleFontStyle,t._titleFontFamily);for(s=0;s<n;++s){a.fillText(o[s],d.x(e.x),e.y+r/2);e.y+=r+l;if(s+1===n){e.y+=t.titleMarginBottom-l}}}},drawBody:function drawBody(e,t,a){var o=t.bodyFontSize,n=t.bodySpacing,r=t._bodyAlign,l=t.body,s=t.displayColors,d=0,g=s?we(t,"left"):0,c=Ii(t.rtl,t.x,t.width),h=function(t){a.fillText(t,c.x(e.x+d),e.y+o/2);e.y+=o+n},p,u,m,b,x,f,y,_,v=c.textAlign(r);a.textAlign=r;a.textBaseline="middle";a.font=wa.fontString(o,t._bodyFontStyle,t._bodyFontFamily);e.x=we(t,v);a.fillStyle=t.bodyFontColor;wa.each(t.beforeBody,h);d=s&&"right"!==v?"center"===r?o/2+1:o+2:0;for(x=0,y=l.length;x<y;++x){p=l[x];u=t.labelTextColors[x];m=t.labelColors[x];a.fillStyle=u;wa.each(p.before,h);b=p.lines;for(f=0,_=b.length;f<_;++f){if(s){var k=c.x(g);a.fillStyle=t.legendColorBackground;a.fillRect(c.leftForLtr(k,o),e.y,o,o);a.lineWidth=1;a.strokeStyle=m.borderColor;a.strokeRect(c.leftForLtr(k,o),e.y,o,o);a.fillStyle=m.backgroundColor;a.fillRect(c.leftForLtr(c.xPlus(k,1),o-2),e.y+1,o-2,o-2);a.fillStyle=u}h(b[f])}wa.each(p.after,h)}d=0;wa.each(t.afterBody,h);e.y-=n},drawFooter:function drawFooter(e,t,a){var o=t.footer,n=o.length,r,l;if(n){var s=Ii(t.rtl,t.x,t.width);e.x=we(t,t._footerAlign);e.y+=t.footerMarginTop;a.textAlign=s.textAlign(t._footerAlign);a.textBaseline="middle";r=t.footerFontSize;a.fillStyle=t.footerFontColor;a.font=wa.fontString(r,t._footerFontStyle,t._footerFontFamily);for(l=0;l<n;++l){a.fillText(o[l],s.x(e.x),e.y+r/2);e.y+=r+t.footerSpacing}}},drawBackground:function drawBackground(e,t,a,i){a.fillStyle=t.backgroundColor;a.strokeStyle=t.borderColor;a.lineWidth=t.borderWidth;var o=t.xAlign,n=t.yAlign,r=e.x,l=e.y,s=i.width,d=i.height,g=t.cornerRadius;a.beginPath();a.moveTo(r+g,l);if("top"===n){this.drawCaret(e,i)}a.lineTo(r+s-g,l);a.quadraticCurveTo(r+s,l,r+s,l+g);if("center"===n&&"right"===o){this.drawCaret(e,i)}a.lineTo(r+s,l+d-g);a.quadraticCurveTo(r+s,l+d,r+s-g,l+d);if("bottom"===n){this.drawCaret(e,i)}a.lineTo(r+g,l+d);a.quadraticCurveTo(r,l+d,r,l+d-g);if("center"===n&&"left"===o){this.drawCaret(e,i)}a.lineTo(r,l+g);a.quadraticCurveTo(r,l,r+g,l);a.closePath();a.fill();if(0<t.borderWidth){a.stroke()}},draw:function draw(){var e=this._chart.ctx,t=this._view;if(0===t.opacity){return}var a={width:t.width,height:t.height},i={x:t.x,y:t.y},o=Math.abs(1e-3>t.opacity)?0:t.opacity,n=t.title.length||t.beforeBody.length||t.body.length||t.afterBody.length||t.footer.length;if(this._options.enabled&&n){e.save();e.globalAlpha=o;this.drawBackground(i,t,e,a);i.y+=t.yPadding;wa.rtl.overrideTextDirection(e,t.textDirection);this.drawTitle(i,t,e);this.drawBody(i,t,e);this.drawFooter(i,t,e);wa.rtl.restoreTextDirection(e,t.textDirection);e.restore()}},handleEvent:function handleEvent(t){var e=this,a=e._options,i=!1;e._lastActive=e._lastActive||[];if("mouseout"===t.type){e._active=[]}else{e._active=e._chart.getElementsAtEventForMode(t,a.mode,a);if(a.reverse){e._active.reverse()}}i=!wa.arrayEquals(e._active,e._lastActive);if(i){e._lastActive=e._active;if(a.enabled||a.custom){e._eventPosition={x:t.x,y:t.y};e.update(!0);e.pivot()}}return i}}),Oi=Li;Oi.positioners=Fi;var Ri=wa.valueOrDefault;fa._set("global",{elements:{},events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,maintainAspectRatio:!0,responsive:!0,responsiveAnimationDuration:0});function Ce(){return wa.merge(Object.create(null),[].slice.call(arguments),{merger:function merger(e,t,a,o){if("xAxes"===e||"yAxes"===e){var n=a[e].length,r,l,s;if(!t[e]){t[e]=[]}for(r=0;r<n;++r){s=a[e][r];l=Ri(s.type,"xAxes"===e?"category":"linear");if(r>=t[e].length){t[e].push({})}if(!t[e][r].type||s.type&&s.type!==t[e][r].type){wa.merge(t[e][r],[Di.getScaleDefaults(l),s])}else{wa.merge(t[e][r],s)}}}else{wa._merger(e,t,a,o)}}})}function Pe(){return wa.merge(Object.create(null),[].slice.call(arguments),{merger:function merger(e,t,a,i){var o=t[e]||Object.create(null),n=a[e];if("scales"===e){t[e]=Ce(o,n)}else if("scale"===e){t[e]=wa.merge(o,[Di.getScaleDefaults(n.type),n])}else{wa._merger(e,t,a,i)}}})}function Ae(e){e=e||Object.create(null);var t=e.data=e.data||{};t.datasets=t.datasets||[];t.labels=t.labels||[];e.options=Pe(fa.global,fa[e.type],e.options||{});return e}function De(e){var t=e.options;wa.each(e.scales,function(t){pi.removeBox(e,t)});t=Pe(fa.global,fa[e.config.type],t);e.options=e.config.options=t;e.ensureScalesHaveIDs();e.buildOrUpdateScales();e.tooltip._options=t.tooltips;e.tooltip.initialize()}function Te(e,t,a){var i,o=function(e){return e.id===i};do{i=t+a++}while(0<=wa.findIndex(e,o));return i}function Ie(e){return"top"===e||"bottom"===e}function Fe(e,t){return function(i,a){return i[e]===a[e]?i[t]-a[t]:i[e]-a[e]}}var zi=function(e,t){this.construct(e,t);return this};wa.extend(zi.prototype,{construct:function construct(e,t){var a=this;t=Ae(t);var i=Pi.acquireContext(e,t),o=i&&i.canvas,n=o&&o.height,r=o&&o.width;a.id=wa.uid();a.ctx=i;a.canvas=o;a.config=t;a.width=r;a.height=n;a.aspectRatio=n?r/n:null;a.options=t.options;a._bufferedRender=!1;a._layers=[];a.chart=a;a.controller=a;zi.instances[a.id]=a;Object.defineProperty(a,"data",{get:function get(){return a.config.data},set:function set(e){a.config.data=e}});if(!i||!o){console.error("Failed to create chart: can't acquire context from the given item");return}a.initialize();a.update()},initialize:function initialize(){var e=this;Ai.notify(e,"beforeInit");wa.retinaScale(e,e.options.devicePixelRatio);e.bindEvents();if(e.options.responsive){e.resize(!0)}e.initToolTip();Ai.notify(e,"afterInit");return e},clear:function clear(){wa.canvas.clear(this);return this},stop:function stop(){Da.cancelAnimation(this);return this},resize:function resize(e){var t=this,a=t.options,i=t.canvas,o=a.maintainAspectRatio&&t.aspectRatio||null,n=Math.max(0,Math.floor(wa.getMaximumWidth(i))),r=Math.max(0,Math.floor(o?n/o:wa.getMaximumHeight(i)));if(t.width===n&&t.height===r){return}i.width=t.width=n;i.height=t.height=r;i.style.width=n+"px";i.style.height=r+"px";wa.retinaScale(t,a.devicePixelRatio);if(!e){var l={width:n,height:r};Ai.notify(t,"resize",[l]);if(a.onResize){a.onResize(t,l)}t.stop();t.update({duration:a.responsiveAnimationDuration})}},ensureScalesHaveIDs:function ensureScalesHaveIDs(){var e=this.options,t=e.scales||{},a=e.scale;wa.each(t.xAxes,function(e,a){if(!e.id){e.id=Te(t.xAxes,"x-axis-",a)}});wa.each(t.yAxes,function(e,a){if(!e.id){e.id=Te(t.yAxes,"y-axis-",a)}});if(a){a.id=a.id||"scale"}},buildOrUpdateScales:function buildOrUpdateScales(){var e=this,t=e.options,a=e.scales||{},i=[],o=Object.keys(a).reduce(function(e,t){e[t]=!1;return e},{});if(t.scales){i=i.concat((t.scales.xAxes||[]).map(function(e){return{options:e,dtype:"category",dposition:"bottom"}}),(t.scales.yAxes||[]).map(function(e){return{options:e,dtype:"linear",dposition:"left"}}))}if(t.scale){i.push({options:t.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"})}wa.each(i,function(t){var i=t.options,n=i.id,r=Ri(i.type,t.dtype);if(Ie(i.position)!==Ie(t.dposition)){i.position=t.dposition}o[n]=!0;var l=null;if(n in a&&a[n].type===r){l=a[n];l.options=i;l.ctx=e.ctx;l.chart=e}else{var s=Di.getScaleConstructor(r);if(!s){return}l=new s({id:n,type:r,options:i,ctx:e.ctx,chart:e});a[l.id]=l}l.mergeTicksOptions();if(t.isDefault){e.scale=l}});wa.each(o,function(e,t){if(!e){delete a[t]}});e.scales=a;Di.addScalesToLayout(this)},buildOrUpdateControllers:function buildOrUpdateControllers(){var e=this,t=[],a=e.data.datasets,o,n;for(o=0,n=a.length;o<n;o++){var r=a[o],l=e.getDatasetMeta(o),s=r.type||e.config.type;if(l.type&&l.type!==s){e.destroyDatasetMeta(o);l=e.getDatasetMeta(o)}l.type=s;l.order=r.order||0;l.index=o;if(l.controller){l.controller.updateIndex(o);l.controller.linkScales()}else{var d=gi[l.type];if(d===void 0){throw new Error("\""+l.type+"\" is not a chart type.")}l.controller=new d(e,o);t.push(l.controller)}}return t},resetElements:function resetElements(){var e=this;wa.each(e.data.datasets,function(t,a){e.getDatasetMeta(a).controller.reset()},e)},reset:function reset(){this.resetElements();this.tooltip.initialize()},update:function update(e){var t=this,a,o;if(!e||"object"!==_typeof(e)){e={duration:e,lazy:arguments[1]}}De(t);Ai._invalidate(t);if(!1===Ai.notify(t,"beforeUpdate")){return}t.tooltip._data=t.data;var n=t.buildOrUpdateControllers();for(a=0,o=t.data.datasets.length;a<o;a++){t.getDatasetMeta(a).controller.buildOrUpdateElements()}t.updateLayout();if(t.options.animation&&t.options.animation.duration){wa.each(n,function(e){e.reset()})}t.updateDatasets();t.tooltip.initialize();t.lastActive=[];Ai.notify(t,"afterUpdate");t._layers.sort(Fe("z","_idx"));if(t._bufferedRender){t._bufferedRequest={duration:e.duration,easing:e.easing,lazy:e.lazy}}else{t.render(e)}},updateLayout:function updateLayout(){var e=this;if(!1===Ai.notify(e,"beforeLayout")){return}pi.update(this,this.width,this.height);e._layers=[];wa.each(e.boxes,function(t){if(t._configure){t._configure()}e._layers.push.apply(e._layers,t._layers())},e);e._layers.forEach(function(e,t){e._idx=t});Ai.notify(e,"afterScaleUpdate");Ai.notify(e,"afterLayout")},updateDatasets:function updateDatasets(){var e=this;if(!1===Ai.notify(e,"beforeDatasetsUpdate")){return}for(var t=0,a=e.data.datasets.length;t<a;++t){e.updateDataset(t)}Ai.notify(e,"afterDatasetsUpdate")},updateDataset:function updateDataset(e){var t=this,a=t.getDatasetMeta(e),i={meta:a,index:e};if(!1===Ai.notify(t,"beforeDatasetUpdate",[i])){return}a.controller._update();Ai.notify(t,"afterDatasetUpdate",[i])},render:function render(e){var t=this;if(!e||"object"!==_typeof(e)){e={duration:e,lazy:arguments[1]}}var a=t.options.animation,i=Ri(e.duration,a&&a.duration),o=e.lazy;if(!1===Ai.notify(t,"beforeRender")){return}var n=function(e){Ai.notify(t,"afterRender");wa.callback(a&&a.onComplete,[e],t)};if(a&&i){var r=new Aa({numSteps:i/16.66,easing:e.easing||a.easing,render:function render(e,t){var a=wa.easing.effects[t.easing],i=t.currentStep,o=i/t.numSteps;e.draw(a(o),o,i)},onAnimationProgress:a.onProgress,onAnimationComplete:n});Da.addAnimation(t,r,i,o)}else{t.draw();n(new Aa({numSteps:0,chart:t}))}return t},draw:function draw(e){var t=this,a,o;t.clear();if(wa.isNullOrUndef(e)){e=1}t.transition(e);if(0>=t.width||0>=t.height){return}if(!1===Ai.notify(t,"beforeDraw",[e])){return}o=t._layers;for(a=0;a<o.length&&0>=o[a].z;++a){o[a].draw(t.chartArea)}t.drawDatasets(e);for(;a<o.length;++a){o[a].draw(t.chartArea)}t._drawTooltip(e);Ai.notify(t,"afterDraw",[e])},transition:function transition(e){for(var t=this,a=0,o=(t.data.datasets||[]).length;a<o;++a){if(t.isDatasetVisible(a)){t.getDatasetMeta(a).controller.transition(e)}}t.tooltip.transition(e)},_getSortedDatasetMetas:function _getSortedDatasetMetas(e){var t=this,a=t.data.datasets||[],o=[],n,r;for(n=0,r=a.length;n<r;++n){if(!e||t.isDatasetVisible(n)){o.push(t.getDatasetMeta(n))}}o.sort(Fe("order","index"));return o},_getSortedVisibleDatasetMetas:function _getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)},drawDatasets:function drawDatasets(e){var t=this,a,o;if(!1===Ai.notify(t,"beforeDatasetsDraw",[e])){return}a=t._getSortedVisibleDatasetMetas();for(o=a.length-1;0<=o;--o){t.drawDataset(a[o],e)}Ai.notify(t,"afterDatasetsDraw",[e])},drawDataset:function drawDataset(e,t){var a=this,i={meta:e,index:e.index,easingValue:t};if(!1===Ai.notify(a,"beforeDatasetDraw",[i])){return}e.controller.draw(t);Ai.notify(a,"afterDatasetDraw",[i])},_drawTooltip:function _drawTooltip(e){var t=this,a=t.tooltip,i={tooltip:a,easingValue:e};if(!1===Ai.notify(t,"beforeTooltipDraw",[i])){return}a.draw();Ai.notify(t,"afterTooltipDraw",[i])},getElementAtEvent:function getElementAtEvent(t){return ci.modes.single(this,t)},getElementsAtEvent:function getElementsAtEvent(t){return ci.modes.label(this,t,{intersect:!0})},getElementsAtXAxis:function getElementsAtXAxis(t){return ci.modes["x-axis"](this,t,{intersect:!0})},getElementsAtEventForMode:function getElementsAtEventForMode(t,e,a){var i=ci.modes[e];if("function"==typeof i){return i(this,t,a)}return[]},getDatasetAtEvent:function getDatasetAtEvent(t){return ci.modes.dataset(this,t,{intersect:!0})},getDatasetMeta:function getDatasetMeta(e){var t=this,a=t.data.datasets[e];if(!a._meta){a._meta={}}var i=a._meta[t.id];if(!i){i=a._meta[t.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:a.order||0,index:e}}return i},getVisibleDatasetCount:function getVisibleDatasetCount(){for(var e=0,t=0,a=this.data.datasets.length;t<a;++t){if(this.isDatasetVisible(t)){e++}}return e},isDatasetVisible:function isDatasetVisible(e){var t=this.getDatasetMeta(e);return"boolean"==typeof t.hidden?!t.hidden:!this.data.datasets[e].hidden},generateLegend:function generateLegend(){return this.options.legendCallback(this)},destroyDatasetMeta:function destroyDatasetMeta(e){var t=this.id,a=this.data.datasets[e],i=a._meta&&a._meta[t];if(i){i.controller.destroy();delete a._meta[t]}},destroy:function destroy(){var e=this,t=e.canvas,a,o;e.stop();for(a=0,o=e.data.datasets.length;a<o;++a){e.destroyDatasetMeta(a)}if(t){e.unbindEvents();wa.canvas.clear(e);Pi.releaseContext(e.ctx);e.canvas=null;e.ctx=null}Ai.notify(e,"destroy");delete zi.instances[e.id]},toBase64Image:function toBase64Image(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function initToolTip(){var e=this;e.tooltip=new Oi({_chart:e,_chartInstance:e,_data:e.data,_options:e.options.tooltips},e)},bindEvents:function bindEvents(){var e=this,t=e._listeners={},a=function(){e.eventHandler.apply(e,arguments)};wa.each(e.options.events,function(i){Pi.addEventListener(e,i,a);t[i]=a});if(e.options.responsive){a=function(){e.resize()};Pi.addEventListener(e,"resize",a);t.resize=a}},unbindEvents:function unbindEvents(){var e=this,t=e._listeners;if(!t){return}delete e._listeners;wa.each(t,function(t,a){Pi.removeEventListener(e,a,t)})},updateHoverStyle:function updateHoverStyle(e,t,a){var o=a?"set":"remove",n,r,l;for(r=0,l=e.length;r<l;++r){n=e[r];if(n){this.getDatasetMeta(n._datasetIndex).controller[o+"HoverStyle"](n)}}if("dataset"===t){this.getDatasetMeta(e[0]._datasetIndex).controller["_"+o+"DatasetHoverStyle"]()}},eventHandler:function eventHandler(t){var e=this,a=e.tooltip;if(!1===Ai.notify(e,"beforeEvent",[t])){return}e._bufferedRender=!0;e._bufferedRequest=null;var i=e.handleEvent(t);if(a){i=a._start?a.handleEvent(t):i|a.handleEvent(t)}Ai.notify(e,"afterEvent",[t]);var o=e._bufferedRequest;if(o){e.render(o)}else if(i&&!e.animating){e.stop();e.render({duration:e.options.hover.animationDuration,lazy:!0})}e._bufferedRender=!1;e._bufferedRequest=null;return e},handleEvent:function handleEvent(t){var e=this,a=e.options||{},i=a.hover,o=!1;e.lastActive=e.lastActive||[];if("mouseout"===t.type){e.active=[]}else{e.active=e.getElementsAtEventForMode(t,i.mode,i)}wa.callback(a.onHover||a.hover.onHover,[t.native,e.active],e);if("mouseup"===t.type||"click"===t.type){if(a.onClick){a.onClick.call(e,t.native,e.active)}}if(e.lastActive.length){e.updateHoverStyle(e.lastActive,i.mode,!1)}if(e.active.length&&i.mode){e.updateHoverStyle(e.active,i.mode,!0)}o=!wa.arrayEquals(e.active,e.lastActive);e.lastActive=e.active;return o}});zi.instances={};var Ei=zi;zi.Controller=zi;zi.types={};wa.configMerge=Pe;wa.scaleMerge=Ce;function Le(){throw new Error("This method is not implemented: either no adapter can be found or an incomplete integration was provided.")}function Oe(e){this.options=e||{}}wa.extend(Oe.prototype,{formats:Le,parse:Le,format:Le,add:Le,diff:Le,startOf:Le,endOf:Le,_create:function _create(e){return e}});Oe.override=function(e){wa.extend(Oe.prototype,e)};var Bi={_date:Oe},Wi={formatters:{values:function values(e){return wa.isArray(e)?e:""+e},linear:function linear(e,t,a){var i=3<a.length?a[2]-a[1]:a[1]-a[0];if(1<Math.abs(i)){if(e!==Math.floor(e)){i=e-Math.floor(e)}}var o=wa.log10(Math.abs(i)),n="";if(0!==e){var r=Math.max(Math.abs(a[0]),Math.abs(a[a.length-1]));if(1e-4>r){var l=wa.log10(Math.abs(e)),s=Math.floor(l)-Math.floor(o);s=Math.max(Math.min(s,20),0);n=e.toExponential(s)}else{var d=-1*Math.floor(o);d=Math.max(Math.min(d,20),0);n=e.toFixed(d)}}else{n="0"}return n},logarithmic:function logarithmic(e,t,a){var i=e/Math.pow(10,Math.floor(wa.log10(e)));if(0===e){return"0"}else if(1===i||2===i||5===i||0===t||t===a.length-1){return e.toExponential()}return""}}},Vi=wa.isArray,Mi=wa.isNullOrUndef,Hi=wa.valueOrDefault,Ni=wa.valueAtIndexOrDefault;fa._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:Wi.formatters.values,minor:{},major:{}}});function Re(e,t){var a=[],o=e.length/t,n=0,r=e.length;for(;n<r;n+=o){a.push(e[Math.floor(n)])}return a}function ze(e,t,a){var i=e.getTicks().length,o=Math.min(t,i-1),n=e.getPixelForTick(o),r=e._startPixel,l=e._endPixel,s=1e-6,d;if(a){if(1===i){d=Math.max(n-r,l-n)}else if(0===t){d=(e.getPixelForTick(1)-n)/2}else{d=(n-e.getPixelForTick(o-1))/2}n+=o<t?d:-d;if(n<r-s||n>l+s){return}}return n}function Ee(e,t){wa.each(e,function(e){var a=e.gc,o=a.length/2,n;if(o>t){for(n=0;n<o;++n){delete e.data[a[n]]}a.splice(0,o)}})}function Be(e,t,a,o){var r=a.length,l=[],s=[],d=[],g=0,c=0,h,p,u,m,b,x,f,y,_,v,k,w,S;for(h=0;h<r;++h){m=a[h].label;b=a[h].major?t.major:t.minor;e.font=x=b.string;f=o[x]=o[x]||{data:{},gc:[]};y=b.lineHeight;_=v=0;if(!Mi(m)&&!Vi(m)){_=wa.measureText(e,f.data,f.gc,_,m);v=y}else if(Vi(m)){for(p=0,u=m.length;p<u;++p){k=m[p];if(!Mi(k)&&!Vi(k)){_=wa.measureText(e,f.data,f.gc,_,k);v+=y}}}l.push(_);s.push(v);d.push(y/2);g=Math.max(_,g);c=Math.max(v,c)}Ee(o,r);w=l.indexOf(g);S=s.indexOf(c);function n(e){return{width:l[e]||0,height:s[e]||0,offset:d[e]||0}}return{first:n(0),last:n(r-1),widest:n(w),highest:n(S)}}function We(e){return e.drawTicks?e.tickMarkLength:0}function Ve(e){var t,a;if(!e.display){return 0}t=wa.options._parseFont(e);a=wa.options.toPadding(e.padding);return t.lineHeight+a.height}function Me(e,t){return wa.extend(wa.options._parseFont({fontFamily:Hi(t.fontFamily,e.fontFamily),fontSize:Hi(t.fontSize,e.fontSize),fontStyle:Hi(t.fontStyle,e.fontStyle),lineHeight:Hi(t.lineHeight,e.lineHeight)}),{color:wa.options.resolve([t.fontColor,e.fontColor,fa.global.defaultFontColor])})}function He(e){var t=Me(e,e.minor),a=e.major.enabled?Me(e,e.major):t;return{minor:t,major:a}}function Ne(e){var t=[],a,i,o;for(i=0,o=e.length;i<o;++i){a=e[i];if("undefined"!=typeof a._index){t.push(a)}}return t}function je(e){var t=e.length,a,o;if(2>t){return!1}for(o=e[0],a=1;a<t;++a){if(e[a]-e[a-1]!==o){return!1}}return o}function Ye(e,t,a,o){var n=je(e),r=(t.length-1)/o,l,s,d,g;if(!n){return Math.max(r,1)}l=wa.math._factorize(n);for(d=0,g=l.length-1;d<g;d++){s=l[d];if(s>r){return s}}return Math.max(r,1)}function qe(e){var t=[],a,o;for(a=0,o=e.length;a<o;a++){if(e[a].major){t.push(a)}}return t}function Ue(e,t,a){var o=0,n=t[0],r,l;a=Math.ceil(a);for(r=0;r<e.length;r++){l=e[r];if(r===n){l._index=r;o++;n=t[o*a]}else{delete l.label}}}function Ke(e,t,a,o){var n=Hi(a,0),r=Math.min(Hi(o,e.length),e.length),l=0,s,d,g,c;t=Math.ceil(t);if(o){s=o-a;t=s/Math.floor(s/t)}c=n;while(0>c){l++;c=Math.round(n+l*t)}for(d=Math.max(n,0);d<r;d++){g=e[d];if(d===c){g._index=d;l++;c=Math.round(n+l*t)}else{delete g.label}}}var ji=Ca.extend({zeroLineIndex:0,getPadding:function getPadding(){var e=this;return{left:e.paddingLeft||0,top:e.paddingTop||0,right:e.paddingRight||0,bottom:e.paddingBottom||0}},getTicks:function getTicks(){return this._ticks},_getLabels:function _getLabels(){var e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]},mergeTicksOptions:function mergeTicksOptions(){},beforeUpdate:function beforeUpdate(){wa.callback(this.options.beforeUpdate,[this])},update:function update(e,t,a){var o=this,n=o.options.ticks,r=n.sampleSize,l,s,d,g,c;o.beforeUpdate();o.maxWidth=e;o.maxHeight=t;o.margins=wa.extend({left:0,right:0,top:0,bottom:0},a);o._ticks=null;o.ticks=null;o._labelSizes=null;o._maxLabelLines=0;o.longestLabelWidth=0;o.longestTextCache=o.longestTextCache||{};o._gridLineItems=null;o._labelItems=null;o.beforeSetDimensions();o.setDimensions();o.afterSetDimensions();o.beforeDataLimits();o.determineDataLimits();o.afterDataLimits();o.beforeBuildTicks();g=o.buildTicks()||[];g=o.afterBuildTicks(g)||g;if((!g||!g.length)&&o.ticks){g=[];for(l=0,s=o.ticks.length;l<s;++l){g.push({value:o.ticks[l],major:!1})}}o._ticks=g;c=r<g.length;d=o._convertTicksToLabels(c?Re(g,r):g);o._configure();o.beforeCalculateTickRotation();o.calculateTickRotation();o.afterCalculateTickRotation();o.beforeFit();o.fit();o.afterFit();o._ticksToDraw=n.display&&(n.autoSkip||"auto"===n.source)?o._autoSkip(g):g;if(c){d=o._convertTicksToLabels(o._ticksToDraw)}o.ticks=d;o.afterUpdate();return o.minSize},_configure:function _configure(){var e=this,t=e.options.ticks.reverse,a,i;if(e.isHorizontal()){a=e.left;i=e.right}else{a=e.top;i=e.bottom;t=!t}e._startPixel=a;e._endPixel=i;e._reversePixels=t;e._length=i-a},afterUpdate:function afterUpdate(){wa.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function beforeSetDimensions(){wa.callback(this.options.beforeSetDimensions,[this])},setDimensions:function setDimensions(){var e=this;if(e.isHorizontal()){e.width=e.maxWidth;e.left=0;e.right=e.width}else{e.height=e.maxHeight;e.top=0;e.bottom=e.height}e.paddingLeft=0;e.paddingTop=0;e.paddingRight=0;e.paddingBottom=0},afterSetDimensions:function afterSetDimensions(){wa.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function beforeDataLimits(){wa.callback(this.options.beforeDataLimits,[this])},determineDataLimits:wa.noop,afterDataLimits:function afterDataLimits(){wa.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function beforeBuildTicks(){wa.callback(this.options.beforeBuildTicks,[this])},buildTicks:wa.noop,afterBuildTicks:function afterBuildTicks(e){var t=this;if(Vi(e)&&e.length){return wa.callback(t.options.afterBuildTicks,[t,e])}t.ticks=wa.callback(t.options.afterBuildTicks,[t,t.ticks])||t.ticks;return e},beforeTickToLabelConversion:function beforeTickToLabelConversion(){wa.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function convertTicksToLabels(){var e=this,t=e.options.ticks;e.ticks=e.ticks.map(t.userCallback||t.callback,this)},afterTickToLabelConversion:function afterTickToLabelConversion(){wa.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function beforeCalculateTickRotation(){wa.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function calculateTickRotation(){var e=this,t=e.options,a=t.ticks,i=e.getTicks().length,o=a.minRotation||0,n=a.maxRotation,r=o,l,s,d,g,c,h,p;if(!e._isVisible()||!a.display||o>=n||1>=i||!e.isHorizontal()){e.labelRotation=o;return}l=e._getLabelSizes();s=l.widest.width;d=l.highest.height-l.highest.offset;g=Math.min(e.maxWidth,e.chart.width-s);c=t.offset?e.maxWidth/i:g/(i-1);if(s+6>c){c=g/(i-(t.offset?.5:1));h=e.maxHeight-We(t.gridLines)-a.padding-Ve(t.scaleLabel);p=Math.sqrt(s*s+d*d);r=wa.toDegrees(Math.min(Math.asin(Math.min((l.highest.height+6)/c,1)),Math.asin(Math.min(h/p,1))-Math.asin(d/p)));r=Math.max(o,Math.min(n,r))}e.labelRotation=r},afterCalculateTickRotation:function afterCalculateTickRotation(){wa.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function beforeFit(){wa.callback(this.options.beforeFit,[this])},fit:function fit(){var e=this,t=e.minSize={width:0,height:0},a=e.chart,i=e.options,o=i.ticks,n=i.scaleLabel,r=i.gridLines,l=e._isVisible(),s="bottom"===i.position,d=e.isHorizontal();if(d){t.width=e.maxWidth}else if(l){t.width=We(r)+Ve(n)}if(!d){t.height=e.maxHeight}else if(l){t.height=We(r)+Ve(n)}if(o.display&&l){var g=He(o),c=e._getLabelSizes(),h=c.first,p=c.last,u=c.widest,m=c.highest,b=.4*g.minor.lineHeight,x=o.padding;if(d){var f=0!==e.labelRotation,y=wa.toRadians(e.labelRotation),_=Math.cos(y),v=Math.sin(y),k=v*u.width+_*(m.height-(f?m.offset:0))+(f?0:b);t.height=Math.min(e.maxHeight,t.height+k+x);var w=e.getPixelForTick(0)-e.left,S=e.right-e.getPixelForTick(e.getTicks().length-1),C,P;if(f){C=s?_*h.width+v*h.offset:v*(h.height-h.offset);P=s?v*(p.height-p.offset):_*p.width+v*p.offset}else{C=h.width/2;P=p.width/2}e.paddingLeft=Math.max((C-w)*e.width/(e.width-w),0)+3;e.paddingRight=Math.max((P-S)*e.width/(e.width-S),0)+3}else{var A=o.mirror?0:u.width+x+b;t.width=Math.min(e.maxWidth,t.width+A);e.paddingTop=h.height/2;e.paddingBottom=p.height/2}}e.handleMargins();if(d){e.width=e._length=a.width-e.margins.left-e.margins.right;e.height=t.height}else{e.width=t.width;e.height=e._length=a.height-e.margins.top-e.margins.bottom}},handleMargins:function handleMargins(){var e=this;if(e.margins){e.margins.left=Math.max(e.paddingLeft,e.margins.left);e.margins.top=Math.max(e.paddingTop,e.margins.top);e.margins.right=Math.max(e.paddingRight,e.margins.right);e.margins.bottom=Math.max(e.paddingBottom,e.margins.bottom)}},afterFit:function afterFit(){wa.callback(this.options.afterFit,[this])},isHorizontal:function isHorizontal(){var e=this.options.position;return"top"===e||"bottom"===e},isFullWidth:function isFullWidth(){return this.options.fullWidth},getRightValue:function getRightValue(e){if(Mi(e)){return NaN}if(("number"==typeof e||e instanceof Number)&&!isFinite(e)){return NaN}if(e){if(this.isHorizontal()){if(e.x!==void 0){return this.getRightValue(e.x)}}else if(e.y!==void 0){return this.getRightValue(e.y)}}return e},_convertTicksToLabels:function _convertTicksToLabels(e){var t=this,a,o,n;t.ticks=e.map(function(e){return e.value});t.beforeTickToLabelConversion();a=t.convertTicksToLabels(e)||t.ticks;t.afterTickToLabelConversion();for(o=0,n=e.length;o<n;++o){e[o].label=a[o]}return a},_getLabelSizes:function _getLabelSizes(){var e=this,t=e._labelSizes;if(!t){e._labelSizes=t=Be(e.ctx,He(e.options.ticks),e.getTicks(),e.longestTextCache);e.longestLabelWidth=t.widest.width}return t},_parseValue:function _parseValue(e){var t,a,i,o;if(Vi(e)){t=+this.getRightValue(e[0]);a=+this.getRightValue(e[1]);i=Math.min(t,a);o=Math.max(t,a)}else{e=+this.getRightValue(e);t=void 0;a=e;i=e;o=e}return{min:i,max:o,start:t,end:a}},_getScaleLabel:function _getScaleLabel(e){var t=this._parseValue(e);if(t.start!==void 0){return"["+t.start+", "+t.end+"]"}return+this.getRightValue(e)},getLabelForIndex:wa.noop,getPixelForValue:wa.noop,getValueForPixel:wa.noop,getPixelForTick:function getPixelForTick(e){var t=this,a=t.options.offset,i=t._ticks.length,o=1/Math.max(i-(a?0:1),1);return 0>e||e>i-1?null:t.getPixelForDecimal(e*o+(a?o/2:0))},getPixelForDecimal:function getPixelForDecimal(e){var t=this;if(t._reversePixels){e=1-e}return t._startPixel+e*t._length},getDecimalForPixel:function getDecimalForPixel(e){var t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t},getBasePixel:function getBasePixel(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function getBaseValue(){var e=this,t=e.min,a=e.max;return e.beginAtZero?0:0>t&&0>a?a:0<t&&0<a?t:0},_autoSkip:function _autoSkip(e){var t=this,a=t.options.ticks,o=t._length,n=a.maxTicksLimit||o/t._tickSize()+1,r=a.major.enabled?qe(e):[],l=r.length,s=r[0],d=r[l-1],g,c,h,p;if(l>n){Ue(e,r,l/n);return Ne(e)}h=Ye(r,e,o,n);if(0<l){for(g=0,c=l-1;g<c;g++){Ke(e,h,r[g],r[g+1])}p=1<l?(d-s)/(l-1):null;Ke(e,h,wa.isNullOrUndef(p)?0:s-p,s);Ke(e,h,d,wa.isNullOrUndef(p)?e.length:d+p);return Ne(e)}Ke(e,h);return Ne(e)},_tickSize:function _tickSize(){var e=this,t=e.options.ticks,a=wa.toRadians(e.labelRotation),i=Math.abs(Math.cos(a)),o=Math.abs(Math.sin(a)),n=e._getLabelSizes(),r=t.autoSkipPadding||0,l=n?n.widest.width+r:0,s=n?n.highest.height+r:0;return e.isHorizontal()?s*i>l*o?l/i:s/o:s*o<l*i?s/i:l/o},_isVisible:function _isVisible(){var e=this,t=e.chart,a=e.options.display,o,n,r;if("auto"!==a){return!!a}for(o=0,n=t.data.datasets.length;o<n;++o){if(t.isDatasetVisible(o)){r=t.getDatasetMeta(o);if(r.xAxisID===e.id||r.yAxisID===e.id){return!0}}}return!1},_computeGridLineItems:function _computeGridLineItems(e){var t=this,a=t.chart,o=t.options,n=o.gridLines,r=o.position,l=n.offsetGridLines,s=t.isHorizontal(),d=t._ticksToDraw,g=d.length+(l?1:0),c=We(n),h=[],p=n.drawBorder?Ni(n.lineWidth,0,0):0,u=p/2,m=wa._alignPixel,b=function(e){return m(a,e,p)},x,f,y,_,v,k,w,S,C,P,A,D,T,I,F,L,O;if("top"===r){x=b(t.bottom);w=t.bottom-c;C=x-u;A=b(e.top)+u;T=e.bottom}else if("bottom"===r){x=b(t.top);A=e.top;T=b(e.bottom)-u;w=x+u;C=t.top+c}else if("left"===r){x=b(t.right);k=t.right-c;S=x-u;P=b(e.left)+u;D=e.right}else{x=b(t.left);P=e.left;D=b(e.right)-u;k=x+u;S=t.left+c}for(f=0;f<g;++f){y=d[f]||{};if(Mi(y.label)&&f<d.length){continue}if(f===t.zeroLineIndex&&o.offset===l){I=n.zeroLineWidth;F=n.zeroLineColor;L=n.zeroLineBorderDash||[];O=n.zeroLineBorderDashOffset||0}else{I=Ni(n.lineWidth,f,1);F=Ni(n.color,f,"rgba(0,0,0,0.1)");L=n.borderDash||[];O=n.borderDashOffset||0}_=ze(t,y._index||f,l);if(_===void 0){continue}v=m(a,_,I);if(s){k=S=P=D=v}else{w=C=A=T=v}h.push({tx1:k,ty1:w,tx2:S,ty2:C,x1:P,y1:A,x2:D,y2:T,width:I,color:F,borderDash:L,borderDashOffset:O})}h.ticksLength=g;h.borderValue=x;return h},_computeLabelItems:function _computeLabelItems(){var e=this,t=e.options,a=t.ticks,o=t.position,n=a.mirror,r=e.isHorizontal(),l=e._ticksToDraw,s=He(a),d=a.padding,g=We(t.gridLines),c=-wa.toRadians(e.labelRotation),h=[],p,u,m,b,f,_,v,k,w,S,C,P;if("top"===o){_=e.bottom-g-d;v=!c?"center":"left"}else if("bottom"===o){_=e.top+g+d;v=!c?"center":"right"}else if("left"===o){f=e.right-(n?0:g)-d;v=n?"left":"right"}else{f=e.left+(n?0:g)+d;v=n?"right":"left"}for(p=0,u=l.length;p<u;++p){m=l[p];b=m.label;if(Mi(b)){continue}k=e.getPixelForTick(m._index||p)+a.labelOffset;w=m.major?s.major:s.minor;S=w.lineHeight;C=Vi(b)?b.length:1;if(r){f=k;P="top"===o?((!c?.5:1)-C)*S:(!c?.5:0)*S}else{_=k;P=(1-C)*S/2}h.push({x:f,y:_,rotation:c,label:b,font:w,textOffset:P,textAlign:v})}return h},_drawGrid:function _drawGrid(e){var t=this,a=t.options.gridLines;if(!a.display){return}var o=t.ctx,n=t.chart,r=wa._alignPixel,l=a.drawBorder?Ni(a.lineWidth,0,0):0,s=t._gridLineItems||(t._gridLineItems=t._computeGridLineItems(e)),d,g,c,h,p;for(c=0,h=s.length;c<h;++c){p=s[c];d=p.width;g=p.color;if(d&&g){o.save();o.lineWidth=d;o.strokeStyle=g;if(o.setLineDash){o.setLineDash(p.borderDash);o.lineDashOffset=p.borderDashOffset}o.beginPath();if(a.drawTicks){o.moveTo(p.tx1,p.ty1);o.lineTo(p.tx2,p.ty2)}if(a.drawOnChartArea){o.moveTo(p.x1,p.y1);o.lineTo(p.x2,p.y2)}o.stroke();o.restore()}}if(l){var u=l,m=Ni(a.lineWidth,s.ticksLength-1,1),b=s.borderValue,x,f,y,_;if(t.isHorizontal()){x=r(n,t.left,u)-u/2;f=r(n,t.right,m)+m/2;y=_=b}else{y=r(n,t.top,u)-u/2;_=r(n,t.bottom,m)+m/2;x=f=b}o.lineWidth=l;o.strokeStyle=Ni(a.color,0);o.beginPath();o.moveTo(x,y);o.lineTo(f,_);o.stroke()}},_drawLabels:function _drawLabels(){var e=this,t=e.options.ticks;if(!t.display){return}var a=e.ctx,o=e._labelItems||(e._labelItems=e._computeLabelItems()),n,r,l,s,d,g,c,h;for(n=0,l=o.length;n<l;++n){d=o[n];g=d.font;a.save();a.translate(d.x,d.y);a.rotate(d.rotation);a.font=g.string;a.fillStyle=g.color;a.textBaseline="middle";a.textAlign=d.textAlign;c=d.label;h=d.textOffset;if(Vi(c)){for(r=0,s=c.length;r<s;++r){a.fillText(""+c[r],0,h);h+=g.lineHeight}}else{a.fillText(c,0,h)}a.restore()}},_drawTitle:function _drawTitle(){var e=this,t=e.ctx,a=e.options,i=a.scaleLabel;if(!i.display){return}var o=Hi(i.fontColor,fa.global.defaultFontColor),n=wa.options._parseFont(i),r=wa.options.toPadding(i.padding),l=n.lineHeight/2,s=a.position,d=0,g,c;if(e.isHorizontal()){g=e.left+e.width/2;c="bottom"===s?e.bottom-l-r.bottom:e.top+l+r.top}else{var h="left"===s;g=h?e.left+l+r.top:e.right-l-r.top;c=e.top+e.height/2;d=h?-.5*Math.PI:.5*Math.PI}t.save();t.translate(g,c);t.rotate(d);t.textAlign="center";t.textBaseline="middle";t.fillStyle=o;t.font=n.string;t.fillText(i.labelString,0,0);t.restore()},draw:function draw(e){var t=this;if(!t._isVisible()){return}t._drawGrid(e);t._drawTitle();t._drawLabels()},_layers:function _layers(){var e=this,t=e.options,a=t.ticks&&t.ticks.z||0,i=t.gridLines&&t.gridLines.z||0;if(!e._isVisible()||a===i||e.draw!==e._draw){return[{z:a,draw:function draw(){e.draw.apply(e,arguments)}}]}return[{z:i,draw:function draw(){e._drawGrid.apply(e,arguments);e._drawTitle.apply(e,arguments)}},{z:a,draw:function draw(){e._drawLabels.apply(e,arguments)}}]},_getMatchingVisibleMetas:function _getMatchingVisibleMetas(e){var t=this,a=t.isHorizontal();return t.chart._getSortedVisibleDatasetMetas().filter(function(i){return(!e||i.type===e)&&(a?i.xAxisID===t.id:i.yAxisID===t.id)})}});ji.prototype._draw=ji.prototype.draw;var Yi=ji,qi=wa.isNullOrUndef,Ui=Yi.extend({determineDataLimits:function determineDataLimits(){var e=this,t=e._getLabels(),a=e.options.ticks,i=a.min,o=a.max,n=0,r=t.length-1,l;if(i!==void 0){l=t.indexOf(i);if(0<=l){n=l}}if(o!==void 0){l=t.indexOf(o);if(0<=l){r=l}}e.minIndex=n;e.maxIndex=r;e.min=t[n];e.max=t[r]},buildTicks:function buildTicks(){var e=this,t=e._getLabels(),a=e.minIndex,i=e.maxIndex;e.ticks=0===a&&i===t.length-1?t:t.slice(a,i+1)},getLabelForIndex:function getLabelForIndex(e,t){var a=this,i=a.chart;if(i.getDatasetMeta(t).controller._getValueScaleId()===a.id){return a.getRightValue(i.data.datasets[t].data[e])}return a._getLabels()[e]},_configure:function _configure(){var e=this,t=e.options.offset,a=e.ticks;Yi.prototype._configure.call(e);if(!e.isHorizontal()){e._reversePixels=!e._reversePixels}if(!a){return}e._startValue=e.minIndex-(t?.5:0);e._valueRange=Math.max(a.length-(t?0:1),1)},getPixelForValue:function getPixelForValue(e,t,a){var i=this,o,n,r;if(!qi(t)&&!qi(a)){e=i.chart.data.datasets[a].data[t]}if(!qi(e)){o=i.isHorizontal()?e.x:e.y}if(o!==void 0||e!==void 0&&isNaN(t)){n=i._getLabels();e=wa.valueOrDefault(o,e);r=n.indexOf(e);t=-1!==r?r:t;if(isNaN(t)){t=e}}return i.getPixelForDecimal((t-i._startValue)/i._valueRange)},getPixelForTick:function getPixelForTick(e){var t=this.ticks;return 0>e||e>t.length-1?null:this.getPixelForValue(t[e],e+this.minIndex)},getValueForPixel:function getValueForPixel(e){var t=this,a=Math.round(t._startValue+t.getDecimalForPixel(e)*t._valueRange);return Math.min(Math.max(a,0),t.ticks.length-1)},getBasePixel:function getBasePixel(){return this.bottom}});Ui._defaults={position:"bottom"};var Ki=wa.noop,Xi=wa.isNullOrUndef;function Xe(e,t){var a=[],i=e.stepSize,o=i||1,n=e.maxTicks-1,r=e.min,l=e.max,s=e.precision,d=t.min,g=t.max,c=wa.niceNum((g-d)/n/o)*o,h,p,u,m;if(c<1e-14&&Xi(r)&&Xi(l)){return[d,g]}m=Math.ceil(g/c)-Math.floor(d/c);if(m>n){c=wa.niceNum(m*c/n/o)*o}if(i||Xi(s)){h=Math.pow(10,wa._decimalPlaces(c))}else{h=Math.pow(10,s);c=Math.ceil(c*h)/h}p=Math.floor(d/c)*c;u=Math.ceil(g/c)*c;if(i){if(!Xi(r)&&wa.almostWhole(r/c,c/1e3)){p=r}if(!Xi(l)&&wa.almostWhole(l/c,c/1e3)){u=l}}m=(u-p)/c;if(wa.almostEquals(m,Math.round(m),c/1e3)){m=Math.round(m)}else{m=Math.ceil(m)}p=Math.round(p*h)/h;u=Math.round(u*h)/h;a.push(Xi(r)?p:r);for(var b=1;b<m;++b){a.push(Math.round((p+b*c)*h)/h)}a.push(Xi(l)?u:l);return a}var Gi=Yi.extend({getRightValue:function getRightValue(e){if("string"==typeof e){return+e}return Yi.prototype.getRightValue.call(this,e)},handleTickRangeOptions:function handleTickRangeOptions(){var e=this,t=e.options,a=t.ticks;if(a.beginAtZero){var i=wa.sign(e.min),o=wa.sign(e.max);if(0>i&&0>o){e.max=0}else if(0<i&&0<o){e.min=0}}var n=a.min!==void 0||a.suggestedMin!==void 0,r=a.max!==void 0||a.suggestedMax!==void 0;if(a.min!==void 0){e.min=a.min}else if(a.suggestedMin!==void 0){if(null===e.min){e.min=a.suggestedMin}else{e.min=Math.min(e.min,a.suggestedMin)}}if(a.max!==void 0){e.max=a.max}else if(a.suggestedMax!==void 0){if(null===e.max){e.max=a.suggestedMax}else{e.max=Math.max(e.max,a.suggestedMax)}}if(n!==r){if(e.min>=e.max){if(n){e.max=e.min+1}else{e.min=e.max-1}}}if(e.min===e.max){e.max++;if(!a.beginAtZero){e.min--}}},getTickLimit:function getTickLimit(){var e=this,t=e.options.ticks,a=t.stepSize,i=t.maxTicksLimit,o;if(a){o=Math.ceil(e.max/a)-Math.floor(e.min/a)+1}else{o=e._computeTickLimit();i=i||11}if(i){o=Math.min(i,o)}return o},_computeTickLimit:function _computeTickLimit(){return Number.POSITIVE_INFINITY},handleDirectionalChanges:Ki,buildTicks:function buildTicks(){var e=this,t=e.options,a=t.ticks,i=e.getTickLimit();i=Math.max(2,i);var o={maxTicks:i,min:a.min,max:a.max,precision:a.precision,stepSize:wa.valueOrDefault(a.fixedStepSize,a.stepSize)},n=e.ticks=Xe(o,e);e.handleDirectionalChanges();e.max=wa.max(n);e.min=wa.min(n);if(a.reverse){n.reverse();e.start=e.max;e.end=e.min}else{e.start=e.min;e.end=e.max}},convertTicksToLabels:function convertTicksToLabels(){var e=this;e.ticksAsNumbers=e.ticks.slice();e.zeroLineIndex=e.ticks.indexOf(0);Yi.prototype.convertTicksToLabels.call(e)},_configure:function _configure(){var e=this,t=e.getTicks(),a=e.min,i=e.max,o;Yi.prototype._configure.call(e);if(e.options.offset&&t.length){o=(i-a)/Math.max(t.length-1,1)/2;a-=o;i+=o}e._startValue=a;e._endValue=i;e._valueRange=i-a}}),Zi={position:"left",ticks:{callback:Wi.formatters.linear}};function Ge(e,t,a){var i=[a.type,t===void 0&&a.stack===void 0?a.index:"",a.stack].join(".");if(e[i]===void 0){e[i]={pos:[],neg:[]}}return e[i]}function Ze(e,t,a,o){var n=e.options,r=n.stacked,l=Ge(t,r,a),s=l.pos,d=l.neg,g=o.length,c,h;for(c=0;c<g;++c){h=e._parseValue(o[c]);if(isNaN(h.min)||isNaN(h.max)||a.data[c].hidden){continue}s[c]=s[c]||0;d[c]=d[c]||0;if(n.relativePoints){s[c]=100}else if(0>h.min||0>h.max){d[c]+=h.min}else{s[c]+=h.max}}}function Je(e,t,a){var o=a.length,n,r;for(n=0;n<o;++n){r=e._parseValue(a[n]);if(isNaN(r.min)||isNaN(r.max)||t.data[n].hidden){continue}e.min=Math.min(e.min,r.min);e.max=Math.max(e.max,r.max)}}var Ji=Gi.extend({determineDataLimits:function determineDataLimits(){var e=this,t=e.options,a=e.chart,o=a.data.datasets,n=e._getMatchingVisibleMetas(),r=t.stacked,l={},s=n.length,d,g,c,h;e.min=Number.POSITIVE_INFINITY;e.max=Number.NEGATIVE_INFINITY;if(r===void 0){for(d=0;!r&&d<s;++d){g=n[d];r=g.stack!==void 0}}for(d=0;d<s;++d){g=n[d];c=o[g.index].data;if(r){Ze(e,l,g,c)}else{Je(e,g,c)}}wa.each(l,function(t){h=t.pos.concat(t.neg);e.min=Math.min(e.min,wa.min(h));e.max=Math.max(e.max,wa.max(h))});e.min=wa.isFinite(e.min)&&!isNaN(e.min)?e.min:0;e.max=wa.isFinite(e.max)&&!isNaN(e.max)?e.max:1;e.handleTickRangeOptions()},_computeTickLimit:function _computeTickLimit(){var e=this,t;if(e.isHorizontal()){return Math.ceil(e.width/40)}t=wa.options._parseFont(e.options.ticks);return Math.ceil(e.height/t.lineHeight)},handleDirectionalChanges:function handleDirectionalChanges(){if(!this.isHorizontal()){this.ticks.reverse()}},getLabelForIndex:function getLabelForIndex(e,t){return this._getScaleLabel(this.chart.data.datasets[t].data[e])},getPixelForValue:function getPixelForValue(e){var t=this;return t.getPixelForDecimal((+t.getRightValue(e)-t._startValue)/t._valueRange)},getValueForPixel:function getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange},getPixelForTick:function getPixelForTick(e){var t=this.ticksAsNumbers;if(0>e||e>t.length-1){return null}return this.getPixelForValue(t[e])}});Ji._defaults=Zi;var $i=wa.valueOrDefault,Qi=wa.math.log10;function $e(e,t){var a=[],i=$i(e.min,Math.pow(10,Math.floor(Qi(t.min)))),o=Math.floor(Qi(t.max)),n=Math.ceil(t.max/Math.pow(10,o)),r,l;if(0===i){r=Math.floor(Qi(t.minNotZero));l=Math.floor(t.minNotZero/Math.pow(10,r));a.push(i);i=l*Math.pow(10,r)}else{r=Math.floor(Qi(i));l=Math.floor(i/Math.pow(10,r))}var s=0>r?Math.pow(10,Math.abs(r)):1;do{a.push(i);++l;if(10===l){l=1;++r;s=0<=r?1:s}i=Math.round(l*Math.pow(10,r)*s)/s}while(r<o||r===o&&l<n);var d=$i(e.max,i);a.push(d);return a}var eo={position:"left",ticks:{callback:Wi.formatters.logarithmic}};function Qe(e,t){return wa.isFinite(e)&&0<=e?e:t}var to=Yi.extend({determineDataLimits:function determineDataLimits(){var t=this,a=t.options,o=t.chart,n=o.data.datasets,r=t.isHorizontal();function e(e){return r?e.xAxisID===t.id:e.yAxisID===t.id}var l,s,d,g,c,h;t.min=Number.POSITIVE_INFINITY;t.max=Number.NEGATIVE_INFINITY;t.minNotZero=Number.POSITIVE_INFINITY;var p=a.stacked;if(p===void 0){for(l=0;l<n.length;l++){s=o.getDatasetMeta(l);if(o.isDatasetVisible(l)&&e(s)&&s.stack!==void 0){p=!0;break}}}if(a.stacked||p){var u={};for(l=0;l<n.length;l++){s=o.getDatasetMeta(l);var m=[s.type,a.stacked===void 0&&s.stack===void 0?l:"",s.stack].join(".");if(o.isDatasetVisible(l)&&e(s)){if(u[m]===void 0){u[m]=[]}g=n[l].data;for(c=0,h=g.length;c<h;c++){var b=u[m];d=t._parseValue(g[c]);if(isNaN(d.min)||isNaN(d.max)||s.data[c].hidden||0>d.min||0>d.max){continue}b[c]=b[c]||0;b[c]+=d.max}}}wa.each(u,function(e){if(0<e.length){var a=wa.min(e),i=wa.max(e);t.min=Math.min(t.min,a);t.max=Math.max(t.max,i)}})}else{for(l=0;l<n.length;l++){s=o.getDatasetMeta(l);if(o.isDatasetVisible(l)&&e(s)){g=n[l].data;for(c=0,h=g.length;c<h;c++){d=t._parseValue(g[c]);if(isNaN(d.min)||isNaN(d.max)||s.data[c].hidden||0>d.min||0>d.max){continue}t.min=Math.min(d.min,t.min);t.max=Math.max(d.max,t.max);if(0!==d.min){t.minNotZero=Math.min(d.min,t.minNotZero)}}}}}t.min=wa.isFinite(t.min)?t.min:null;t.max=wa.isFinite(t.max)?t.max:null;t.minNotZero=wa.isFinite(t.minNotZero)?t.minNotZero:null;this.handleTickRangeOptions()},handleTickRangeOptions:function handleTickRangeOptions(){var e=this,t=e.options.ticks,a=1,i=10;e.min=Qe(t.min,e.min);e.max=Qe(t.max,e.max);if(e.min===e.max){if(0!==e.min&&null!==e.min){e.min=Math.pow(10,Math.floor(Qi(e.min))-1);e.max=Math.pow(10,Math.floor(Qi(e.max))+1)}else{e.min=a;e.max=i}}if(null===e.min){e.min=Math.pow(10,Math.floor(Qi(e.max))-1)}if(null===e.max){e.max=0!==e.min?Math.pow(10,Math.floor(Qi(e.min))+1):i}if(null===e.minNotZero){if(0<e.min){e.minNotZero=e.min}else if(1>e.max){e.minNotZero=Math.pow(10,Math.floor(Qi(e.max)))}else{e.minNotZero=a}}},buildTicks:function buildTicks(){var e=this,t=e.options.ticks,a=!e.isHorizontal(),i={min:Qe(t.min),max:Qe(t.max)},o=e.ticks=$e(i,e);e.max=wa.max(o);e.min=wa.min(o);if(t.reverse){a=!a;e.start=e.max;e.end=e.min}else{e.start=e.min;e.end=e.max}if(a){o.reverse()}},convertTicksToLabels:function convertTicksToLabels(){this.tickValues=this.ticks.slice();Yi.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function getLabelForIndex(e,t){return this._getScaleLabel(this.chart.data.datasets[t].data[e])},getPixelForTick:function getPixelForTick(e){var t=this.tickValues;if(0>e||e>t.length-1){return null}return this.getPixelForValue(t[e])},_getFirstTickValue:function _getFirstTickValue(e){var t=Math.floor(Qi(e)),a=Math.floor(e/Math.pow(10,t));return a*Math.pow(10,t)},_configure:function _configure(){var e=this,t=e.min,a=0;Yi.prototype._configure.call(e);if(0===t){t=e._getFirstTickValue(e.minNotZero);a=$i(e.options.ticks.fontSize,fa.global.defaultFontSize)/e._length}e._startValue=Qi(t);e._valueOffset=a;e._valueRange=(Qi(e.max)-Qi(t))/(1-a)},getPixelForValue:function getPixelForValue(e){var t=this,a=0;e=+t.getRightValue(e);if(e>t.min&&0<e){a=(Qi(e)-t._startValue)/t._valueRange+t._valueOffset}return t.getPixelForDecimal(a)},getValueForPixel:function getValueForPixel(e){var t=this,a=t.getDecimalForPixel(e);return 0===a&&0===t.min?0:Math.pow(10,t._startValue+(a-t._valueOffset)*t._valueRange)}});to._defaults=eo;var ao=wa.valueOrDefault,io=wa.valueAtIndexOrDefault,oo=wa.options.resolve,no={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:Wi.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function callback(e){return e}}};function et(e){var t=e.ticks;if(t.display&&e.display){return ao(t.fontSize,fa.global.defaultFontSize)+2*t.backdropPaddingY}return 0}function tt(e,t,a){if(wa.isArray(a)){return{w:wa.longestText(e,e.font,a),h:a.length*t}}return{w:e.measureText(a).width,h:t}}function at(e,t,a,i,o){if(e===i||e===o){return{start:t-a/2,end:t+a/2}}else if(e<i||e>o){return{start:t-a,end:t}}return{start:t,end:t+a}}function it(e){var t=wa.options._parseFont(e.options.pointLabels),a={l:0,r:e.width,t:0,b:e.height-e.paddingTop},o={},n,r,l;e.ctx.font=t.string;e._pointLabelSizes=[];var s=e.chart.data.labels.length;for(n=0;n<s;n++){l=e.getPointPosition(n,e.drawingArea+5);r=tt(e.ctx,t.lineHeight,e.pointLabels[n]);e._pointLabelSizes[n]=r;var d=e.getIndexAngle(n),g=wa.toDegrees(d)%360,c=at(g,l.x,r.w,0,180),h=at(g,l.y,r.h,90,270);if(c.start<a.l){a.l=c.start;o.l=d}if(c.end>a.r){a.r=c.end;o.r=d}if(h.start<a.t){a.t=h.start;o.t=d}if(h.end>a.b){a.b=h.end;o.b=d}}e.setReductions(e.drawingArea,a,o)}function ot(e){if(0===e||180===e){return"center"}else if(180>e){return"left"}return"right"}function nt(e,t,a,o){var n=a.y+o/2,r,l;if(wa.isArray(t)){for(r=0,l=t.length;r<l;++r){e.fillText(t[r],a.x,n);n+=o}}else{e.fillText(t,a.x,n)}}function rt(e,t,a){if(90===e||270===e){a.y-=t.h/2}else if(270<e||90>e){a.y-=t.h}}function lt(e){var t=e.ctx,a=e.options,o=a.pointLabels,n=et(a),r=e.getDistanceFromCenterForValue(a.ticks.reverse?e.min:e.max),l=wa.options._parseFont(o);t.save();t.font=l.string;t.textBaseline="middle";for(var s=e.chart.data.labels.length-1;0<=s;s--){var d=0==s?n/2:0,g=e.getPointPosition(s,r+d+5),c=io(o.fontColor,s,fa.global.defaultFontColor);t.fillStyle=c;var h=e.getIndexAngle(s),p=wa.toDegrees(h);t.textAlign=ot(p);rt(p,e._pointLabelSizes[s],g);nt(t,e.pointLabels[s],g,l.lineHeight)}t.restore()}function st(e,t,a,o){var n=e.ctx,r=t.circular,l=e.chart.data.labels.length,s=io(t.color,o-1),d=io(t.lineWidth,o-1),g;if(!r&&!l||!s||!d){return}n.save();n.strokeStyle=s;n.lineWidth=d;if(n.setLineDash){n.setLineDash(t.borderDash||[]);n.lineDashOffset=t.borderDashOffset||0}n.beginPath();if(r){n.arc(e.xCenter,e.yCenter,a,0,2*Math.PI)}else{g=e.getPointPosition(0,a);n.moveTo(g.x,g.y);for(var c=1;c<l;c++){g=e.getPointPosition(c,a);n.lineTo(g.x,g.y)}}n.closePath();n.stroke();n.restore()}function dt(e){return wa.isNumber(e)?e:0}var ro=Gi.extend({setDimensions:function setDimensions(){var e=this;e.width=e.maxWidth;e.height=e.maxHeight;e.paddingTop=et(e.options)/2;e.xCenter=Math.floor(e.width/2);e.yCenter=Math.floor((e.height-e.paddingTop)/2);e.drawingArea=Math.min(e.height-e.paddingTop,e.width)/2},determineDataLimits:function determineDataLimits(){var e=this,t=e.chart,a=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;wa.each(t.data.datasets,function(o,n){if(t.isDatasetVisible(n)){var r=t.getDatasetMeta(n);wa.each(o.data,function(t,o){var n=+e.getRightValue(t);if(isNaN(n)||r.data[o].hidden){return}a=Math.min(n,a);i=Math.max(n,i)})}});e.min=a===Number.POSITIVE_INFINITY?0:a;e.max=i===Number.NEGATIVE_INFINITY?0:i;e.handleTickRangeOptions()},_computeTickLimit:function _computeTickLimit(){return Math.ceil(this.drawingArea/et(this.options))},convertTicksToLabels:function convertTicksToLabels(){var e=this;Gi.prototype.convertTicksToLabels.call(e);e.pointLabels=e.chart.data.labels.map(function(){var t=wa.callback(e.options.pointLabels.callback,arguments,e);return t||0===t?t:""})},getLabelForIndex:function getLabelForIndex(e,t){return+this.getRightValue(this.chart.data.datasets[t].data[e])},fit:function fit(){var e=this,t=e.options;if(t.display&&t.pointLabels.display){it(e)}else{e.setCenterPoint(0,0,0,0)}},setReductions:function setReductions(e,t,a){var i=this,o=t.l/Math.sin(a.l),n=Math.max(t.r-i.width,0)/Math.sin(a.r),r=-t.t/Math.cos(a.t),l=-Math.max(t.b-(i.height-i.paddingTop),0)/Math.cos(a.b);o=dt(o);n=dt(n);r=dt(r);l=dt(l);i.drawingArea=Math.min(Math.floor(e-(o+n)/2),Math.floor(e-(r+l)/2));i.setCenterPoint(o,n,r,l)},setCenterPoint:function setCenterPoint(e,t,a,i){var o=this,n=o.width-t-o.drawingArea,r=e+o.drawingArea,l=a+o.drawingArea,s=o.height-o.paddingTop-i-o.drawingArea;o.xCenter=Math.floor((r+n)/2+o.left);o.yCenter=Math.floor((l+s)/2+o.top+o.paddingTop)},getIndexAngle:function getIndexAngle(e){var t=this.chart,a=360/t.data.labels.length,i=t.options||{},o=i.startAngle||0,n=(e*a+o)%360;return 2*((0>n?n+360:n)*Math.PI)/360},getDistanceFromCenterForValue:function getDistanceFromCenterForValue(e){var t=this;if(wa.isNullOrUndef(e)){return NaN}var a=t.drawingArea/(t.max-t.min);if(t.options.ticks.reverse){return(t.max-e)*a}return(e-t.min)*a},getPointPosition:function getPointPosition(e,t){var a=this,i=a.getIndexAngle(e)-Math.PI/2;return{x:Math.cos(i)*t+a.xCenter,y:Math.sin(i)*t+a.yCenter}},getPointPositionForValue:function getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))},getBasePosition:function getBasePosition(e){var t=this,a=t.min,i=t.max;return t.getPointPositionForValue(e||0,t.beginAtZero?0:0>a&&0>i?i:0<a&&0<i?a:0)},_drawGrid:function _drawGrid(){var e=this,t=e.ctx,a=e.options,o=a.gridLines,n=a.angleLines,r=ao(n.lineWidth,o.lineWidth),l=ao(n.color,o.color),s,d,g;if(a.pointLabels.display){lt(e)}if(o.display){wa.each(e.ticks,function(t,a){if(0!==a){d=e.getDistanceFromCenterForValue(e.ticksAsNumbers[a]);st(e,o,d,a)}})}if(n.display&&r&&l){t.save();t.lineWidth=r;t.strokeStyle=l;if(t.setLineDash){t.setLineDash(oo([n.borderDash,o.borderDash,[]]));t.lineDashOffset=oo([n.borderDashOffset,o.borderDashOffset,0])}for(s=e.chart.data.labels.length-1;0<=s;s--){d=e.getDistanceFromCenterForValue(a.ticks.reverse?e.min:e.max);g=e.getPointPosition(s,d);t.beginPath();t.moveTo(e.xCenter,e.yCenter);t.lineTo(g.x,g.y);t.stroke()}t.restore()}},_drawLabels:function _drawLabels(){var e=this,t=e.ctx,a=e.options,i=a.ticks;if(!i.display){return}var o=e.getIndexAngle(0),n=wa.options._parseFont(i),r=ao(i.fontColor,fa.global.defaultFontColor),l,s;t.save();t.font=n.string;t.translate(e.xCenter,e.yCenter);t.rotate(o);t.textAlign="center";t.textBaseline="middle";wa.each(e.ticks,function(a,o){if(0===o&&!i.reverse){return}l=e.getDistanceFromCenterForValue(e.ticksAsNumbers[o]);if(i.showLabelBackdrop){s=t.measureText(a).width;t.fillStyle=i.backdropColor;t.fillRect(-s/2-i.backdropPaddingX,-l-n.size/2-i.backdropPaddingY,s+2*i.backdropPaddingX,n.size+2*i.backdropPaddingY)}t.fillStyle=r;t.fillText(a,0,-l)});t.restore()},_drawTitle:wa.noop});ro._defaults=no;var lo=wa._deprecated,so=wa.options.resolve,go=wa.valueOrDefault,co=Number.MIN_SAFE_INTEGER||-9007199254740991,ho=Number.MAX_SAFE_INTEGER||9007199254740991,po={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},uo=Object.keys(po);function gt(e,t){return e-t}function ct(e){var t={},a=[],o,n,r;for(o=0,n=e.length;o<n;++o){r=e[o];if(!t[r]){t[r]=!0;a.push(r)}}return a}function ht(e){return wa.valueOrDefault(e.time.min,e.ticks.min)}function pt(e){return wa.valueOrDefault(e.time.max,e.ticks.max)}function ut(e,t,a,o){if("linear"===o||!e.length){return[{time:t,pos:0},{time:a,pos:1}]}var n=[],r=[t],l,s,d,g,c;for(l=0,s=e.length;l<s;++l){g=e[l];if(g>t&&g<a){r.push(g)}}r.push(a);for(l=0,s=r.length;l<s;++l){c=r[l+1];d=r[l-1];g=r[l];if(d===void 0||c===void 0||Math.round((c+d)/2)!==g){n.push({time:g,pos:l/(s-1)})}}return n}function mt(e,t,a){var i=0,o=e.length-1,n,r,l;while(0<=i&&i<=o){n=i+o>>1;r=e[n-1]||null;l=e[n];if(!r){return{lo:null,hi:l}}else if(l[t]<a){i=n+1}else if(r[t]>a){o=n-1}else{return{lo:r,hi:l}}}return{lo:l,hi:null}}function bt(e,t,a,i){var o=mt(e,t,a),n=!o.lo?e[0]:!o.hi?e[e.length-2]:o.lo,r=!o.lo?e[1]:!o.hi?e[e.length-1]:o.hi,l=r[t]-n[t],s=l?(a-n[t])/l:0,d=(r[i]-n[i])*s;return n[i]+d}function xt(e,t){var a=e._adapter,i=e.options.time,o=i.parser,n=o||i.format,r=t;if("function"==typeof o){r=o(r)}if(!wa.isFinite(r)){r="string"==typeof n?a.parse(r,n):a.parse(r)}if(null!==r){return+r}if(!o&&"function"==typeof n){r=n(t);if(!wa.isFinite(r)){r=a.parse(r)}}return r}function ft(e,t){if(wa.isNullOrUndef(t)){return null}var a=e.options.time,i=xt(e,e.getRightValue(t));if(null===i){return i}if(a.round){i=+e._adapter.startOf(i,a.round)}return i}function yt(e,t,a,o){var n=uo.length,r,l,s;for(r=uo.indexOf(e);r<n-1;++r){l=po[uo[r]];s=l.steps?l.steps:ho;if(l.common&&Math.ceil((a-t)/(s*l.size))<=o){return uo[r]}}return uo[n-1]}function _t(e,t,a,o,n){var r,l;for(r=uo.length-1;r>=uo.indexOf(a);r--){l=uo[r];if(po[l].common&&e._adapter.diff(n,o,l)>=t-1){return l}}return uo[a?uo.indexOf(a):0]}function vt(e){for(var t=uo.indexOf(e)+1,a=uo.length;t<a;++t){if(po[uo[t]].common){return uo[t]}}}function kt(e,t,a,i){var o=e._adapter,n=e.options,r=n.time,l=r.unit||yt(r.minUnit,t,a,i),s=so([r.stepSize,r.unitStepSize,1]),d="week"===l?r.isoWeekday:!1,g=t,c=[],h;if(d){g=+o.startOf(g,"isoWeek",d)}g=+o.startOf(g,d?"day":l);if(o.diff(a,t,l)>1e5*s){throw t+" and "+a+" are too far apart with stepSize of "+s+" "+l}for(h=g;h<a;h=+o.add(h,s,l)){c.push(h)}if(h===a||"ticks"===n.bounds){c.push(h)}return c}function wt(e,t,a,i,o){var n=0,r=0,l,s;if(o.offset&&t.length){l=bt(e,"time",t[0],"pos");if(1===t.length){n=1-l}else{n=(bt(e,"time",t[1],"pos")-l)/2}s=bt(e,"time",t[t.length-1],"pos");if(1===t.length){r=s}else{r=(s-bt(e,"time",t[t.length-2],"pos"))/2}}return{start:n,end:r,factor:1/(n+1+r)}}function St(e,t,a,i){var o=e._adapter,n=+o.startOf(t[0].value,i),r=t[t.length-1].value,l,s;for(l=n;l<=r;l=+o.add(l,1,i)){s=a[l];if(0<=s){t[s].major=!0}}return t}function Ct(e,t,a){var o=[],n={},r=t.length,l,s;for(l=0;l<r;++l){s=t[l];n[s]=l;o.push({value:s,major:!1})}return 0===r||!a?o:St(e,o,n,a)}var mo=Yi.extend({initialize:function initialize(){this.mergeTicksOptions();Yi.prototype.initialize.call(this)},update:function update(){var e=this,t=e.options,a=t.time||(t.time={}),i=e._adapter=new Bi._date(t.adapters.date);lo("time scale",a.format,"time.format","time.parser");lo("time scale",a.min,"time.min","ticks.min");lo("time scale",a.max,"time.max","ticks.max");wa.mergeIf(a.displayFormats,i.formats());return Yi.prototype.update.apply(e,arguments)},getRightValue:function getRightValue(e){if(e&&e.t!==void 0){e=e.t}return Yi.prototype.getRightValue.call(this,e)},determineDataLimits:function determineDataLimits(){var e=this,t=e.chart,a=e._adapter,o=e.options,n=o.time.unit||"day",r=ho,l=co,s=[],d=[],g=[],c,h,p,u,m,b,x,f=e._getLabels();for(c=0,p=f.length;c<p;++c){g.push(ft(e,f[c]))}for(c=0,p=(t.data.datasets||[]).length;c<p;++c){if(t.isDatasetVisible(c)){m=t.data.datasets[c].data;if(wa.isObject(m[0])){d[c]=[];for(h=0,u=m.length;h<u;++h){b=ft(e,m[h]);s.push(b);d[c][h]=b}}else{d[c]=g.slice(0);if(!x){s=s.concat(g);x=!0}}}else{d[c]=[]}}if(g.length){r=Math.min(r,g[0]);l=Math.max(l,g[g.length-1])}if(s.length){s=1<p?ct(s).sort(gt):s.sort(gt);r=Math.min(r,s[0]);l=Math.max(l,s[s.length-1])}r=ft(e,ht(o))||r;l=ft(e,pt(o))||l;r=r===ho?+a.startOf(Date.now(),n):r;l=l===co?+a.endOf(Date.now(),n)+1:l;e.min=Math.min(r,l);e.max=Math.max(r+1,l);e._table=[];e._timestamps={data:s,datasets:d,labels:g}},buildTicks:function buildTicks(){var e=this,t=e.min,a=e.max,o=e.options,n=o.ticks,r=o.time,l=e._timestamps,s=[],d=e.getLabelCapacity(t),g=n.source,c=o.distribution,h,p,u;if("data"===g||"auto"===g&&"series"===c){l=l.data}else if("labels"===g){l=l.labels}else{l=kt(e,t,a,d)}if("ticks"===o.bounds&&l.length){t=l[0];a=l[l.length-1]}t=ft(e,ht(o))||t;a=ft(e,pt(o))||a;for(h=0,p=l.length;h<p;++h){u=l[h];if(u>=t&&u<=a){s.push(u)}}e.min=t;e.max=a;e._unit=r.unit||(n.autoSkip?yt(r.minUnit,e.min,e.max,d):_t(e,s.length,r.minUnit,e.min,e.max));e._majorUnit=!n.major.enabled||"year"===e._unit?void 0:vt(e._unit);e._table=ut(e._timestamps.data,t,a,c);e._offsets=wt(e._table,s,t,a,o);if(n.reverse){s.reverse()}return Ct(e,s,e._majorUnit)},getLabelForIndex:function getLabelForIndex(e,t){var a=this,i=a._adapter,o=a.chart.data,n=a.options.time,r=o.labels&&e<o.labels.length?o.labels[e]:"",l=o.datasets[t].data[e];if(wa.isObject(l)){r=a.getRightValue(l)}if(n.tooltipFormat){return i.format(xt(a,r),n.tooltipFormat)}if("string"==typeof r){return r}return i.format(xt(a,r),n.displayFormats.datetime)},tickFormatFunction:function tickFormatFunction(e,t,a,i){var o=this,n=o._adapter,r=o.options,l=r.time.displayFormats,s=l[o._unit],d=o._majorUnit,g=l[d],c=a[t],h=r.ticks,p=d&&g&&c&&c.major,u=n.format(e,i?i:p?g:s),m=p?h.major:h.minor,b=so([m.callback,m.userCallback,h.callback,h.userCallback]);return b?b(u,t,a):u},convertTicksToLabels:function convertTicksToLabels(e){var t=[],a,o;for(a=0,o=e.length;a<o;++a){t.push(this.tickFormatFunction(e[a].value,a,e))}return t},getPixelForOffset:function getPixelForOffset(e){var t=this,a=t._offsets,i=bt(t._table,"time",e,"pos");return t.getPixelForDecimal((a.start+i)*a.factor)},getPixelForValue:function getPixelForValue(e,t,a){var i=this,o=null;if(t!==void 0&&a!==void 0){o=i._timestamps.datasets[a][t]}if(null===o){o=ft(i,e)}if(null!==o){return i.getPixelForOffset(o)}},getPixelForTick:function getPixelForTick(e){var t=this.getTicks();return 0<=e&&e<t.length?this.getPixelForOffset(t[e].value):null},getValueForPixel:function getValueForPixel(e){var t=this,a=t._offsets,i=t.getDecimalForPixel(e)/a.factor-a.end,o=bt(t._table,"pos",i,"time");return t._adapter._create(o)},_getLabelSize:function _getLabelSize(e){var t=this,a=t.options.ticks,i=t.ctx.measureText(e).width,o=wa.toRadians(t.isHorizontal()?a.maxRotation:a.minRotation),n=Math.cos(o),r=Math.sin(o),l=go(a.fontSize,fa.global.defaultFontSize);return{w:i*n+l*r,h:i*r+l*n}},getLabelWidth:function getLabelWidth(e){return this._getLabelSize(e).w},getLabelCapacity:function getLabelCapacity(e){var t=this,a=t.options.time,i=a.displayFormats,o=i[a.unit]||i.millisecond,n=t.tickFormatFunction(e,0,Ct(t,[e],t._majorUnit),o),r=t._getLabelSize(n),l=Math.floor(t.isHorizontal()?t.width/r.w:t.height/r.h);if(t.options.offset){l--}return 0<l?l:1}});mo._defaults={position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}};var bo={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};Bi._date.override("function"==typeof e?{_id:"moment",formats:function formats(){return bo},parse:function(t,a){if("string"==typeof t&&"string"==typeof a){t=e(t,a)}else if(!(t instanceof e)){t=e(t)}return t.isValid()?t.valueOf():null},format:function format(t,a){return e(t).format(a)},add:function add(t,a,i){return e(t).add(a,i).valueOf()},diff:function diff(t,a,i){return e(t).diff(e(a),i)},startOf:function startOf(t,a,i){t=e(t);if("isoWeek"===a){return t.isoWeekday(i).valueOf()}return t.startOf(a).valueOf()},endOf:function endOf(t,a){return e(t).endOf(a).valueOf()},_create:function _create(t){return e(t)}}:{});fa._set("global",{plugins:{filler:{propagate:!0}}});var xo={dataset:function dataset(e){var t=e.fill,a=e.chart,i=a.getDatasetMeta(t),o=i&&a.isDatasetVisible(t),n=o&&i.dataset._children||[],r=n.length||0;return!r?null:function(e,t){return t<r&&n[t]._view||null}},boundary:function(e){var t=e.boundary,a=t?t.x:null,i=t?t.y:null;if(wa.isArray(t)){return function(e,a){return t[a]}}return function(e){return{x:null===a?e.x:a,y:null===i?e.y:i}}}};function Pt(e,t,a){var i=e._model||{},o=i.fill,n;if(o===void 0){o=!!i.backgroundColor}if(!1===o||null===o){return!1}if(!0===o){return"origin"}n=parseFloat(o,10);if(isFinite(n)&&Math.floor(n)===n){if("-"===o[0]||"+"===o[0]){n=t+n}if(n===t||0>n||n>=a){return!1}return n}switch(o){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return o;default:return!1;}}function At(e){var t=e.el._model||{},a=e.el._scale||{},i=e.fill,o=null,n;if(isFinite(i)){return null}if("start"===i){o=t.scaleBottom===void 0?a.bottom:t.scaleBottom}else if("end"===i){o=t.scaleTop===void 0?a.top:t.scaleTop}else if(t.scaleZero!==void 0){o=t.scaleZero}else if(a.getBasePixel){o=a.getBasePixel()}if(o!==void 0&&null!==o){if(o.x!==void 0&&o.y!==void 0){return o}if(wa.isFinite(o)){n=a.isHorizontal();return{x:n?o:null,y:n?null:o}}}return null}function Dt(e){var t=e.el._scale,a=t.options,o=t.chart.data.labels.length,n=e.fill,r=[],l,s,d,g,c;if(!o){return null}l=a.ticks.reverse?t.max:t.min;s=a.ticks.reverse?t.min:t.max;d=t.getPointPositionForValue(0,l);for(g=0;g<o;++g){c="start"===n||"end"===n?t.getPointPositionForValue(g,"start"===n?l:s):t.getBasePosition(g);if(a.gridLines.circular){c.cx=d.x;c.cy=d.y;c.angle=t.getIndexAngle(g)-Math.PI/2}r.push(c)}return r}function Tt(e){var t=e.el._scale||{};if(t.getPointPositionForValue){return Dt(e)}return At(e)}function It(e,t,a){var i=e[t],o=i.fill,n=[t],r;if(!a){return o}while(!1!==o&&-1===n.indexOf(o)){if(!isFinite(o)){return o}r=e[o];if(!r){return!1}if(r.visible){return o}n.push(o);o=r.fill}return!1}function Ft(e){var t=e.fill,a="dataset";if(!1===t){return null}if(!isFinite(t)){a="boundary"}return xo[a](e)}function Lt(e){return e&&!e.skip}function Ot(e,t,a,o,n){var l,s,d,g;if(!o||!n){return}e.moveTo(t[0].x,t[0].y);for(l=1;l<o;++l){wa.canvas.lineTo(e,t[l-1],t[l])}if(a[0].angle!==void 0){s=a[0].cx;d=a[0].cy;g=Math.sqrt(Math.pow(a[0].x-s,2)+Math.pow(a[0].y-d,2));for(l=n-1;0<l;--l){e.arc(s,d,g,a[l].angle,a[l-1].angle,!0)}return}e.lineTo(a[n-1].x,a[n-1].y);for(l=n-1;0<l;--l){wa.canvas.lineTo(e,a[l],a[l-1],!0)}}function Rt(e,t,a,o,n,r){var l=t.length,s=o.spanGaps,d=[],g=[],c=0,h=0,p,u,m,b,x,f,y,_;e.beginPath();for(p=0,u=l;p<u;++p){m=p%l;b=t[m]._view;x=a(b,m,o);f=Lt(b);y=Lt(x);if(r&&_===void 0&&f){_=p+1;u=l+_}if(f&&y){c=d.push(b);h=g.push(x)}else if(c&&h){if(!s){Ot(e,d,g,c,h);c=h=0;d=[];g=[]}else{if(f){d.push(b)}if(y){g.push(x)}}}}Ot(e,d,g,c,h);e.closePath();e.fillStyle=n;e.fill()}var fo=wa.rtl.getRtlAdapter,yo=wa.noop,_o=wa.valueOrDefault;fa._set("global",{legend:{display:!0,position:"top",align:"center",fullWidth:!0,reverse:!1,weight:1e3,onClick:function onClick(t,e){var a=e.datasetIndex,i=this.chart,o=i.getDatasetMeta(a);o.hidden=null===o.hidden?!i.data.datasets[a].hidden:null;i.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function generateLabels(e){var t=e.data.datasets,a=e.options.legend||{},i=a.labels&&a.labels.usePointStyle;return e._getSortedDatasetMetas().map(function(a){var o=a.controller.getStyle(i?0:void 0);return{text:t[a.index].label,fillStyle:o.backgroundColor,hidden:!e.isDatasetVisible(a.index),lineCap:o.borderCapStyle,lineDash:o.borderDash,lineDashOffset:o.borderDashOffset,lineJoin:o.borderJoinStyle,lineWidth:o.borderWidth,strokeStyle:o.borderColor,pointStyle:o.pointStyle,rotation:o.rotation,datasetIndex:a.index}},this)}}},legendCallback:function legendCallback(e){var t=document.createElement("ul"),a=e.data.datasets,o,n,r,l;t.setAttribute("class",e.id+"-legend");for(o=0,n=a.length;o<n;o++){r=t.appendChild(document.createElement("li"));l=r.appendChild(document.createElement("span"));l.style.backgroundColor=a[o].backgroundColor;if(a[o].label){r.appendChild(document.createTextNode(a[o].label))}}return t.outerHTML}});function zt(e,t){return e.usePointStyle&&e.boxWidth>t?t:e.boxWidth}var vo=Ca.extend({initialize:function initialize(e){var t=this;wa.extend(t,e);t.legendHitBoxes=[];t._hoveredItem=null;t.doughnutMode=!1},beforeUpdate:yo,update:function update(e,t,a){var i=this;i.beforeUpdate();i.maxWidth=e;i.maxHeight=t;i.margins=a;i.beforeSetDimensions();i.setDimensions();i.afterSetDimensions();i.beforeBuildLabels();i.buildLabels();i.afterBuildLabels();i.beforeFit();i.fit();i.afterFit();i.afterUpdate();return i.minSize},afterUpdate:yo,beforeSetDimensions:yo,setDimensions:function setDimensions(){var e=this;if(e.isHorizontal()){e.width=e.maxWidth;e.left=0;e.right=e.width}else{e.height=e.maxHeight;e.top=0;e.bottom=e.height}e.paddingLeft=0;e.paddingTop=0;e.paddingRight=0;e.paddingBottom=0;e.minSize={width:0,height:0}},afterSetDimensions:yo,beforeBuildLabels:yo,buildLabels:function buildLabels(){var e=this,t=e.options.labels||{},a=wa.callback(t.generateLabels,[e.chart],e)||[];if(t.filter){a=a.filter(function(a){return t.filter(a,e.chart.data)})}if(e.options.reverse){a.reverse()}e.legendItems=a},afterBuildLabels:yo,beforeFit:yo,fit:function fit(){var e=this,t=e.options,a=t.labels,i=t.display,o=e.ctx,n=wa.options._parseFont(a),r=n.size,l=e.legendHitBoxes=[],s=e.minSize,d=e.isHorizontal();if(d){s.width=e.maxWidth;s.height=i?10:0}else{s.width=i?10:0;s.height=e.maxHeight}if(!i){e.width=s.width=e.height=s.height=0;return}o.font=n.string;if(d){var g=e.lineWidths=[0],c=0;o.textAlign="left";o.textBaseline="middle";wa.each(e.legendItems,function(e,t){var i=zt(a,r),n=i+r/2+o.measureText(e.text).width;if(0===t||g[g.length-1]+n+2*a.padding>s.width){c+=r+a.padding;g[g.length-(0<t?0:1)]=0}l[t]={left:0,top:0,width:n,height:r};g[g.length-1]+=n+a.padding});s.height+=c}else{var h=a.padding,p=e.columnWidths=[],u=e.columnHeights=[],m=a.padding,b=0,x=0;wa.each(e.legendItems,function(e,t){var i=zt(a,r),n=i+r/2+o.measureText(e.text).width;if(0<t&&x+r+2*h>s.height){m+=b+a.padding;p.push(b);u.push(x);b=0;x=0}b=Math.max(b,n);x+=r+h;l[t]={left:0,top:0,width:n,height:r}});m+=b;p.push(b);u.push(x);s.width+=m}e.width=s.width;e.height=s.height},afterFit:yo,isHorizontal:function isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position},draw:function draw(){var e=this,t=e.options,a=t.labels,i=fa.global,o=i.defaultColor,n=i.elements.line,r=e.height,l=e.columnHeights,s=e.width,d=e.lineWidths;if(!t.display){return}var g=fo(t.rtl,e.left,e.minSize.width),c=e.ctx,h=_o(a.fontColor,i.defaultFontColor),p=wa.options._parseFont(a),u=p.size,m;c.textAlign=g.textAlign("left");c.textBaseline="middle";c.lineWidth=.5;c.strokeStyle=h;c.fillStyle=h;c.font=p.string;var b=zt(a,u),f=e.legendHitBoxes,_=function(e,t,i){if(isNaN(b)||0>=b){return}c.save();var r=_o(i.lineWidth,n.borderWidth);c.fillStyle=_o(i.fillStyle,o);c.lineCap=_o(i.lineCap,n.borderCapStyle);c.lineDashOffset=_o(i.lineDashOffset,n.borderDashOffset);c.lineJoin=_o(i.lineJoin,n.borderJoinStyle);c.lineWidth=r;c.strokeStyle=_o(i.strokeStyle,o);if(c.setLineDash){c.setLineDash(_o(i.lineDash,n.borderDash))}if(a&&a.usePointStyle){var l=b*Math.SQRT2/2,s=g.xPlus(e,b/2);wa.canvas.drawPoint(c,i.pointStyle,l,s,t+u/2,i.rotation)}else{c.fillRect(g.leftForLtr(e,b),t,b,u);if(0!==r){c.strokeRect(g.leftForLtr(e,b),t,b,u)}}c.restore()},v=function(e,t,a,i){var o=u/2,n=g.xPlus(e,b+o),r=t+o;c.fillText(a.text,n,r);if(a.hidden){c.beginPath();c.lineWidth=2;c.moveTo(n,r);c.lineTo(g.xPlus(n,i),r);c.stroke()}},k=function(e,i){switch(t.align){case"start":return a.padding;case"end":return e-i;default:return(e-i+a.padding)/2;}},w=e.isHorizontal();if(w){m={x:e.left+k(s,d[0]),y:e.top+a.padding,line:0}}else{m={x:e.left+a.padding,y:e.top+k(r,l[0]),line:0}}wa.rtl.overrideTextDirection(e.ctx,t.textDirection);var S=u+a.padding;wa.each(e.legendItems,function(t,o){var i=c.measureText(t.text).width,n=b+u/2+i,h=m.x,p=m.y;g.setWidth(e.minSize.width);if(w){if(0<o&&h+n+a.padding>e.left+e.minSize.width){p=m.y+=S;m.line++;h=m.x=e.left+k(s,d[m.line])}}else if(0<o&&p+S>e.top+e.minSize.height){h=m.x=h+e.columnWidths[m.line]+a.padding;m.line++;p=m.y=e.top+k(r,l[m.line])}var C=g.x(h);_(C,p,t);f[o].left=g.leftForLtr(C,f[o].width);f[o].top=p;v(C,p,t,i);if(w){m.x+=n+a.padding}else{m.y+=S}});wa.rtl.restoreTextDirection(e.ctx,t.textDirection)},_getLegendItemAt:function _getLegendItemAt(e,t){var a=this,o,n,r;if(e>=a.left&&e<=a.right&&t>=a.top&&t<=a.bottom){r=a.legendHitBoxes;for(o=0;o<r.length;++o){n=r[o];if(e>=n.left&&e<=n.left+n.width&&t>=n.top&&t<=n.top+n.height){return a.legendItems[o]}}}return null},handleEvent:function handleEvent(t){var e=this,a=e.options,i="mouseup"===t.type?"click":t.type,o;if("mousemove"===i){if(!a.onHover&&!a.onLeave){return}}else if("click"===i){if(!a.onClick){return}}else{return}o=e._getLegendItemAt(t.x,t.y);if("click"===i){if(o&&a.onClick){a.onClick.call(e,t.native,o)}}else{if(a.onLeave&&o!==e._hoveredItem){if(e._hoveredItem){a.onLeave.call(e,t.native,e._hoveredItem)}e._hoveredItem=o}if(a.onHover&&o){a.onHover.call(e,t.native,o)}}}});function Et(e,t){var a=new vo({ctx:e.ctx,options:t,chart:e});pi.configure(e,a,t);pi.addBox(e,a);e.legend=a}var ko=wa.noop;fa._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,padding:10,position:"top",text:"",weight:2e3}});var wo=Ca.extend({initialize:function initialize(e){var t=this;wa.extend(t,e);t.legendHitBoxes=[]},beforeUpdate:ko,update:function update(e,t,a){var i=this;i.beforeUpdate();i.maxWidth=e;i.maxHeight=t;i.margins=a;i.beforeSetDimensions();i.setDimensions();i.afterSetDimensions();i.beforeBuildLabels();i.buildLabels();i.afterBuildLabels();i.beforeFit();i.fit();i.afterFit();i.afterUpdate();return i.minSize},afterUpdate:ko,beforeSetDimensions:ko,setDimensions:function setDimensions(){var e=this;if(e.isHorizontal()){e.width=e.maxWidth;e.left=0;e.right=e.width}else{e.height=e.maxHeight;e.top=0;e.bottom=e.height}e.paddingLeft=0;e.paddingTop=0;e.paddingRight=0;e.paddingBottom=0;e.minSize={width:0,height:0}},afterSetDimensions:ko,beforeBuildLabels:ko,buildLabels:ko,afterBuildLabels:ko,beforeFit:ko,fit:function fit(){var e=this,t=e.options,a=e.minSize={},i=e.isHorizontal(),o,n;if(!t.display){e.width=a.width=e.height=a.height=0;return}o=wa.isArray(t.text)?t.text.length:1;n=o*wa.options._parseFont(t).lineHeight+2*t.padding;e.width=a.width=i?e.maxWidth:n;e.height=a.height=i?n:e.maxHeight},afterFit:ko,isHorizontal:function isHorizontal(){var e=this.options.position;return"top"===e||"bottom"===e},draw:function draw(){var e=this,t=e.ctx,a=e.options;if(!a.display){return}var o=wa.options._parseFont(a),n=o.lineHeight,r=n/2+a.padding,l=0,s=e.top,d=e.left,g=e.bottom,c=e.right,h,p,u;t.fillStyle=wa.valueOrDefault(a.fontColor,fa.global.defaultFontColor);t.font=o.string;if(e.isHorizontal()){p=d+(c-d)/2;u=s+r;h=c-d}else{p="left"===a.position?d+r:c-r;u=s+(g-s)/2;h=g-s;l=Math.PI*("left"===a.position?-.5:.5)}t.save();t.translate(p,u);t.rotate(l);t.textAlign="center";t.textBaseline="middle";var m=a.text;if(wa.isArray(m)){for(var b=0,x=0;x<m.length;++x){t.fillText(m[x],0,b,h);b+=n}}else{t.fillText(m,0,0,h)}t.restore()}});function Bt(e,t){var a=new wo({ctx:e.ctx,options:t,chart:e});pi.configure(e,a,t);pi.addBox(e,a);e.titleBlock=a}var So={};So.filler={id:"filler",afterDatasetsUpdate:function afterDatasetsUpdate(e,t){var a=(e.data.datasets||[]).length,o=t.propagate,n=[],r,l,s,d;for(l=0;l<a;++l){r=e.getDatasetMeta(l);s=r.dataset;d=null;if(s&&s._model&&s instanceof ja.Line){d={visible:e.isDatasetVisible(l),fill:Pt(s,l,a),chart:e,el:s}}r.$filler=d;n.push(d)}for(l=0;l<a;++l){d=n[l];if(!d){continue}d.fill=It(n,l,o);d.boundary=Tt(d);d.mapper=Ft(d)}},beforeDatasetsDraw:function beforeDatasetsDraw(e){var t=e._getSortedVisibleDatasetMetas(),a=e.ctx,o,n,r,l,s,d,g;for(n=t.length-1;0<=n;--n){o=t[n].$filler;if(!o||!o.visible){continue}r=o.el;l=r._view;s=r._children||[];d=o.mapper;g=l.backgroundColor||fa.global.defaultColor;if(d&&g&&s.length){wa.canvas.clipArea(a,e.chartArea);Rt(a,s,d,l,g,r._loop);wa.canvas.unclipArea(a)}}}};So.legend={id:"legend",_element:vo,beforeInit:function beforeInit(e){var t=e.options.legend;if(t){Et(e,t)}},beforeUpdate:function beforeUpdate(e){var t=e.options.legend,a=e.legend;if(t){wa.mergeIf(t,fa.global.legend);if(a){pi.configure(e,a,t);a.options=t}else{Et(e,t)}}else if(a){pi.removeBox(e,a);delete e.legend}},afterEvent:function afterEvent(t,a){var e=t.legend;if(e){e.handleEvent(a)}}};So.title={id:"title",_element:wo,beforeInit:function beforeInit(e){var t=e.options.title;if(t){Bt(e,t)}},beforeUpdate:function beforeUpdate(e){var t=e.options.title,a=e.titleBlock;if(t){wa.mergeIf(t,fa.global.title);if(a){pi.configure(e,a,t);a.options=t}else{Bt(e,t)}}else if(a){pi.removeBox(e,a);delete e.titleBlock}}};Ei.helpers=wa;(function core_helpers(){wa.where=function(e,t){if(wa.isArray(e)&&Array.prototype.filter){return e.filter(t)}var a=[];wa.each(e,function(e){if(t(e)){a.push(e)}});return a};wa.findIndex=Array.prototype.findIndex?function(e,t,a){return e.findIndex(t,a)}:function(e,t,a){a=a===void 0?e:a;for(var o=0,n=e.length;o<n;++o){if(t.call(a,e[o],o,e)){return o}}return-1};wa.findNextWhere=function(e,t,a){if(wa.isNullOrUndef(a)){a=-1}for(var o=a+1,n;o<e.length;o++){n=e[o];if(t(n)){return n}}};wa.findPreviousWhere=function(e,t,a){if(wa.isNullOrUndef(a)){a=e.length}for(var o=a-1,n;0<=o;o--){n=e[o];if(t(n)){return n}}};wa.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};wa.almostEquals=function(e,t,a){return Math.abs(e-t)<a};wa.almostWhole=function(e,t){var a=Math.round(e);return a-t<=e&&a+t>=e};wa.max=function(e){return e.reduce(function(e,t){if(!isNaN(t)){return Math.max(e,t)}return e},Number.NEGATIVE_INFINITY)};wa.min=function(e){return e.reduce(function(e,t){if(!isNaN(t)){return Math.min(e,t)}return e},Number.POSITIVE_INFINITY)};wa.sign=Math.sign?function(e){return Math.sign(e)}:function(e){e=+e;if(0===e||isNaN(e)){return e}return 0<e?1:-1};wa.toRadians=function(e){return e*(Math.PI/180)};wa.toDegrees=function(e){return e*(180/Math.PI)};wa._decimalPlaces=function(t){if(!wa.isFinite(t)){return}var a=1,i=0;while(Math.round(t*a)/a!==t){a*=10;i++}return i};wa.getAngleFromPoint=function(e,t){var a=t.x-e.x,i=t.y-e.y,o=Math.sqrt(a*a+i*i),n=Math.atan2(i,a);if(n<-.5*Math.PI){n+=2*Math.PI}return{angle:n,distance:o}};wa.distanceBetweenPoints=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))};wa.aliasPixel=function(e){return 0==e%2?0:.5};wa._alignPixel=function(e,t,a){var i=e.currentDevicePixelRatio,o=a/2;return Math.round((t-o)*i)/i+o};wa.splineCurve=function(e,a,i,o){var t=e.skip?a:e,n=a,r=i.skip?a:i,l=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2)),s=Math.sqrt(Math.pow(r.x-n.x,2)+Math.pow(r.y-n.y,2)),d=l/(l+s),g=s/(l+s);d=isNaN(d)?0:d;g=isNaN(g)?0:g;var c=o*d,h=o*g;return{previous:{x:n.x-c*(r.x-t.x),y:n.y-c*(r.y-t.y)},next:{x:n.x+h*(r.x-t.x),y:n.y+h*(r.y-t.y)}}};wa.EPSILON=Number.EPSILON||1e-14;wa.splineCurveMonotone=function(e){var t=(e||[]).map(function(e){return{model:e._model,deltaK:0,mK:0}}),a=t.length,o,n,r,l;for(o=0;o<a;++o){r=t[o];if(r.model.skip){continue}n=0<o?t[o-1]:null;l=o<a-1?t[o+1]:null;if(l&&!l.model.skip){var s=l.model.x-r.model.x;r.deltaK=0!=s?(l.model.y-r.model.y)/s:0}if(!n||n.model.skip){r.mK=r.deltaK}else if(!l||l.model.skip){r.mK=n.deltaK}else if(this.sign(n.deltaK)!==this.sign(r.deltaK)){r.mK=0}else{r.mK=(n.deltaK+r.deltaK)/2}}var d,g,c,h;for(o=0;o<a-1;++o){r=t[o];l=t[o+1];if(r.model.skip||l.model.skip){continue}if(wa.almostEquals(r.deltaK,0,this.EPSILON)){r.mK=l.mK=0;continue}d=r.mK/r.deltaK;g=l.mK/r.deltaK;h=Math.pow(d,2)+Math.pow(g,2);if(9>=h){continue}c=3/Math.sqrt(h);r.mK=d*c*r.deltaK;l.mK=g*c*r.deltaK}var p;for(o=0;o<a;++o){r=t[o];if(r.model.skip){continue}n=0<o?t[o-1]:null;l=o<a-1?t[o+1]:null;if(n&&!n.model.skip){p=(r.model.x-n.model.x)/3;r.model.controlPointPreviousX=r.model.x-p;r.model.controlPointPreviousY=r.model.y-p*r.mK}if(l&&!l.model.skip){p=(l.model.x-r.model.x)/3;r.model.controlPointNextX=r.model.x+p;r.model.controlPointNextY=r.model.y+p*r.mK}}};wa.nextItem=function(e,t,a){if(a){return t>=e.length-1?e[0]:e[t+1]}return t>=e.length-1?e[e.length-1]:e[t+1]};wa.previousItem=function(e,t,a){if(a){return 0>=t?e[e.length-1]:e[t-1]}return 0>=t?e[0]:e[t-1]};wa.niceNum=function(e,t){var a=Math.floor(wa.log10(e)),i=e/Math.pow(10,a),o;if(t){if(1.5>i){o=1}else if(3>i){o=2}else if(7>i){o=5}else{o=10}}else if(1>=i){o=1}else if(2>=i){o=2}else if(5>=i){o=5}else{o=10}return o*Math.pow(10,a)};wa.requestAnimFrame=function(){if("undefined"==typeof window){return function(e){e()}}return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)}}();wa.getRelativePosition=function(t,a){var i,o,n=t.originalEvent||t,e=t.target||t.srcElement,r=e.getBoundingClientRect(),l=n.touches;if(l&&0<l.length){i=l[0].clientX;o=l[0].clientY}else{i=n.clientX;o=n.clientY}var s=parseFloat(wa.getStyle(e,"padding-left")),d=parseFloat(wa.getStyle(e,"padding-top")),g=parseFloat(wa.getStyle(e,"padding-right")),c=parseFloat(wa.getStyle(e,"padding-bottom")),h=r.right-r.left-s-g,p=r.bottom-r.top-d-c;i=Math.round((i-r.left-s)/h*e.width/a.currentDevicePixelRatio);o=Math.round((o-r.top-d)/p*e.height/a.currentDevicePixelRatio);return{x:i,y:o}};function e(e,t,a){var i;if("string"==typeof e){i=parseInt(e,10);if(-1!==e.indexOf("%")){i=i/100*t.parentNode[a]}}else{i=e}return i}function t(e){return e!==void 0&&null!==e&&"none"!==e}function a(a,i,o){var n=document.defaultView,r=wa._getParentNode(a),l=n.getComputedStyle(a)[i],s=n.getComputedStyle(r)[i],d=t(l),g=t(s),c=Number.POSITIVE_INFINITY;if(d||g){return Math.min(d?e(l,a,o):c,g?e(s,r,o):c)}return"none"}wa.getConstraintWidth=function(e){return a(e,"max-width","clientWidth")};wa.getConstraintHeight=function(e){return a(e,"max-height","clientHeight")};wa._calculatePadding=function(e,t,a){t=wa.getStyle(e,t);return-1<t.indexOf("%")?a*parseInt(t,10)/100:parseInt(t,10)};wa._getParentNode=function(e){var t=e.parentNode;if(t&&"[object ShadowRoot]"===t.toString()){t=t.host}return t};wa.getMaximumWidth=function(e){var t=wa._getParentNode(e);if(!t){return e.clientWidth}var a=t.clientWidth,i=wa._calculatePadding(t,"padding-left",a),o=wa._calculatePadding(t,"padding-right",a),n=a-i-o,r=wa.getConstraintWidth(e);return isNaN(r)?n:Math.min(n,r)};wa.getMaximumHeight=function(e){var t=wa._getParentNode(e);if(!t){return e.clientHeight}var a=t.clientHeight,i=wa._calculatePadding(t,"padding-top",a),o=wa._calculatePadding(t,"padding-bottom",a),n=a-i-o,r=wa.getConstraintHeight(e);return isNaN(r)?n:Math.min(n,r)};wa.getStyle=function(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,null).getPropertyValue(t)};wa.retinaScale=function(e,t){var a=e.currentDevicePixelRatio=t||"undefined"!=typeof window&&window.devicePixelRatio||1;if(1===a){return}var i=e.canvas,o=e.height,n=e.width;i.height=o*a;i.width=n*a;e.ctx.scale(a,a);if(!i.style.height&&!i.style.width){i.style.height=o+"px";i.style.width=n+"px"}};wa.fontString=function(e,t,a){return t+" "+e+"px "+a};wa.longestText=function(e,t,a,o){o=o||{};var n=o.data=o.data||{},r=o.garbageCollect=o.garbageCollect||[];if(o.font!==t){n=o.data={};r=o.garbageCollect=[];o.font=t}e.font=t;var l=0,s=a.length,d,g,c,h,p;for(d=0;d<s;d++){h=a[d];if(h!==void 0&&null!==h&&!0!==wa.isArray(h)){l=wa.measureText(e,n,r,l,h)}else if(wa.isArray(h)){for(g=0,c=h.length;g<c;g++){p=h[g];if(p!==void 0&&null!==p&&!wa.isArray(p)){l=wa.measureText(e,n,r,l,p)}}}}var u=r.length/2;if(u>a.length){for(d=0;d<u;d++){delete n[r[d]]}r.splice(0,u)}return l};wa.measureText=function(e,t,a,i,o){var n=t[o];if(!n){n=t[o]=e.measureText(o).width;a.push(o)}if(n>i){i=n}return i};wa.numberOfLabelLines=function(e){var t=1;wa.each(e,function(e){if(wa.isArray(e)){if(e.length>t){t=e.length}}});return t};wa.color=!da?function(e){console.error("Color.js not found!");return e}:function(e){if(e instanceof CanvasGradient){e=fa.global.defaultColor}return da(e)};wa.getHoverColor=function(e){return e instanceof CanvasPattern||e instanceof CanvasGradient?e:wa.color(e).saturate(.5).darken(.1).rgbString()}})();Ei._adapters=Bi;Ei.Animation=Aa;Ei.animationService=Da;Ei.controllers=gi;Ei.DatasetController=La;Ei.defaults=fa;Ei.Element=Ca;Ei.elements=ja;Ei.Interaction=ci;Ei.layouts=pi;Ei.platform=Pi;Ei.plugins=Ai;Ei.Scale=Yi;Ei.scaleService=Di;Ei.Ticks=Wi;Ei.Tooltip=Oi;Ei.helpers.each({category:Ui,linear:Ji,logarithmic:to,radialLinear:ro,time:mo},function(e,t){Ei.scaleService.registerScaleType(t,e,e._defaults)});for(var Co in So){if(So.hasOwnProperty(Co)){Ei.plugins.register(So[Co])}}Ei.platform.initialize();if("undefined"!=typeof window){window.Chart=Ei}Ei.Chart=Ei;Ei.Legend=So.legend._element;Ei.Title=So.title._element;Ei.pluginService=Ei.plugins;Ei.PluginBase=Ei.Element.extend({});Ei.canvasHelpers=Ei.helpers.canvas;Ei.layoutService=Ei.layouts;Ei.LinearScaleBase=Gi;Ei.helpers.each(["Bar","Bubble","Doughnut","Line","PolarArea","Radar","Scatter"],function(e){Ei[e]=function(t,a){return new Ei(t,Ei.helpers.merge(a||{},{type:e.charAt(0).toLowerCase()+e.slice(1)}))}});return Ei});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a,b){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=b(require("chart.js")):"function"==typeof define&&define.amd?define ("theme_coursemos/chartjs-datalables",["theme_coursemos/chart"],b):(a=a||self,a.ChartDataLabels=b(a.Chart))})(this,function(a){'use strict';a=a&&a.hasOwnProperty("default")?a["default"]:a;var z=a.helpers,A=function(){if("undefined"!=typeof window){if(window.devicePixelRatio){return window.devicePixelRatio}var a=window.screen;if(a){return(a.deviceXDPI||1)/(a.logicalXDPI||1)}}return 1}(),B={toTextLines:function toTextLines(a){var b=[],c;a=[].concat(a);while(a.length){c=a.pop();if("string"==typeof c){b.unshift.apply(b,c.split("\n"))}else if(Array.isArray(c)){a.push.apply(a,c)}else if(!z.isNullOrUndef(a)){b.unshift(""+c)}}return b},toFontString:function toFontString(a){if(!a||z.isNullOrUndef(a.size)||z.isNullOrUndef(a.family)){return null}return(a.style?a.style+" ":"")+(a.weight?a.weight+" ":"")+a.size+"px "+a.family},textSize:function textSize(a,b,c){var d=[].concat(b),e=d.length,f=a.font,g=0,h;a.font=c.string;for(h=0;h<e;++h){g=Math.max(a.measureText(d[h]).width,g)}a.font=f;return{height:e*c.lineHeight,width:g}},parseFont:function parseFont(b){var c=a.defaults.global,d=z.valueOrDefault(b.size,c.defaultFontSize),e={family:z.valueOrDefault(b.family,c.defaultFontFamily),lineHeight:z.options.toLineHeight(b.lineHeight,d),size:d,style:z.valueOrDefault(b.style,c.defaultFontStyle),weight:z.valueOrDefault(b.weight,null),string:""};e.string=B.toFontString(e);return e},bound:function bound(a,b,c){return Math.max(a,Math.min(b,c))},arrayDiff:function arrayDiff(a,b){var c=a.slice(),d=[],e,f,g,h;for(e=0,g=b.length;e<g;++e){h=b[e];f=c.indexOf(h);if(-1===f){d.push([h,1])}else{c.splice(f,1)}}for(e=0,g=c.length;e<g;++e){d.push([c[e],-1])}return d},rasterize:function(a){return Math.round(a*A)/A}};function b(a,b){var c=b.x,d=b.y;if(null===c){return{x:0,y:-1}}if(null===d){return{x:1,y:0}}var e=a.x-c,f=a.y-d,g=Math.sqrt(e*e+f*f);return{x:g?e/g:0,y:g?f/g:-1}}function c(a,b,c,d,e){switch(e){case"center":c=d=0;break;case"bottom":c=0;d=1;break;case"right":c=1;d=0;break;case"left":c=-1;d=0;break;case"top":c=0;d=-1;break;case"start":c=-c;d=-d;break;case"end":break;default:e*=Math.PI/180;c=Math.cos(e);d=Math.sin(e);break;}return{x:a,y:b,vx:c,vy:d}}var C=1,D=2,E=4,F=8;function d(a,b,c){var d=0;if(a<c.left){d|=C}else if(a>c.right){d|=D}if(b<c.top){d|=F}else if(b>c.bottom){d|=E}return d}function e(a,b){var c=a.x0,e=a.y0,f=a.x1,g=a.y1,h=d(c,e,b),i=d(f,g,b),j,k,l;while(!0){if(!(h|i)||h&i){break}j=h||i;if(j&F){k=c+(f-c)*(b.top-e)/(g-e);l=b.top}else if(j&E){k=c+(f-c)*(b.bottom-e)/(g-e);l=b.bottom}else if(j&D){l=e+(g-e)*(b.right-c)/(f-c);k=b.right}else if(j&C){l=e+(g-e)*(b.left-c)/(f-c);k=b.left}if(j===h){c=k;e=l;h=d(c,e,b)}else{f=k;g=l;i=d(f,g,b)}}return{x0:c,x1:f,y0:e,y1:g}}function f(a,b){var d=b.anchor,f=a,g,h;if(b.clamp){f=e(f,b.area)}if("start"===d){g=f.x0;h=f.y0}else if("end"===d){g=f.x1;h=f.y1}else{g=(f.x0+f.x1)/2;h=(f.y0+f.y1)/2}return c(g,h,a.vx,a.vy,b.align)}var G={arc:function arc(a,b){var c=(a.startAngle+a.endAngle)/2,d=Math.cos(c),e=Math.sin(c),g=a.innerRadius,h=a.outerRadius;return f({x0:a.x+d*g,y0:a.y+e*g,x1:a.x+d*h,y1:a.y+e*h,vx:d,vy:e},b)},point:function point(a,c){var d=b(a,c.origin),e=d.x*a.radius,g=d.y*a.radius;return f({x0:a.x-e,y0:a.y-g,x1:a.x+e,y1:a.y+g,vx:d.x,vy:d.y},c)},rect:function rect(a,c){var d=b(a,c.origin),e=a.x,g=a.y,h=0,i=0;if(a.horizontal){e=Math.min(a.x,a.base);h=Math.abs(a.base-a.x)}else{g=Math.min(a.y,a.base);i=Math.abs(a.base-a.y)}return f({x0:e,y0:g+i,x1:e+h,y1:g,vx:d.x,vy:d.y},c)},fallback:function fallback(a,c){var d=b(a,c.origin);return f({x0:a.x,y0:a.y,x1:a.x,y1:a.y,vx:d.x,vy:d.y},c)}},H=a.helpers,I=B.rasterize;function g(a){var b=a.borderWidth||0,c=a.padding,d=a.size.height,e=a.size.width,f=-e/2,g=-d/2;return{frame:{x:f-c.left-b,y:g-c.top-b,w:e+c.width+2*b,h:d+c.height+2*b},text:{x:f,y:g,w:e,h:d}}}function h(a){var b=a._model.horizontal,c=a._scale||b&&a._xScale||a._yScale;if(!c){return null}if(c.xCenter!==void 0&&c.yCenter!==void 0){return{x:c.xCenter,y:c.yCenter}}var d=c.getBasePixel();return b?{x:d,y:null}:{x:null,y:d}}function i(b){if(b instanceof a.elements.Arc){return G.arc}if(b instanceof a.elements.Point){return G.point}if(b instanceof a.elements.Rectangle){return G.rect}return G.fallback}function j(a,b,c){var d=c.backgroundColor,e=c.borderColor,f=c.borderWidth;if(!d&&(!e||!f)){return}a.beginPath();H.canvas.roundedRect(a,I(b.x)+f/2,I(b.y)+f/2,I(b.w)-f,I(b.h)-f,c.borderRadius);a.closePath();if(d){a.fillStyle=d;a.fill()}if(e&&f){a.strokeStyle=e;a.lineWidth=f;a.lineJoin="miter";a.stroke()}}function k(a,b,c){var d=c.lineHeight,e=a.w,f=a.x,g=a.y+d/2;if("center"===b){f+=e/2}else if("end"===b||"right"===b){f+=e}return{h:d,w:e,x:f,y:g}}function l(a,b,c){var d=a.shadowBlur,e=c.stroked,f=I(c.x),g=I(c.y),h=I(c.w);if(e){a.strokeText(b,f,g,h)}if(c.filled){if(d&&e){a.shadowBlur=0}a.fillText(b,f,g,h);if(d&&e){a.shadowBlur=d}}}function m(a,b,c,d){var e=d.textAlign,f=d.color,g=!!f,h=d.font,j=b.length,m=d.textStrokeColor,n=d.textStrokeWidth,o=m&&n,p;if(!j||!g&&!o){return}c=k(c,e,h);a.font=h.string;a.textAlign=e;a.textBaseline="middle";a.shadowBlur=d.textShadowBlur;a.shadowColor=d.textShadowColor;if(g){a.fillStyle=f}if(o){a.lineJoin="round";a.lineWidth=n;a.strokeStyle=m}for(p=0,j=b.length;p<j;++p){l(a,b[p],{stroked:o,filled:g,w:c.w,x:c.x,y:c.y+c.h*p})}}var J=function(a,b,c,d){var e=this;e._config=a;e._index=d;e._model=null;e._rects=null;e._ctx=b;e._el=c};H.extend(J.prototype,{_modelize:function _modelize(b,c,d,e){var f=this,g=f._index,j=H.options.resolve,k=B.parseFont(j([d.font,{}],e,g)),l=j([d.color,a.defaults.global.defaultFontColor],e,g);return{align:j([d.align,"center"],e,g),anchor:j([d.anchor,"center"],e,g),area:e.chart.chartArea,backgroundColor:j([d.backgroundColor,null],e,g),borderColor:j([d.borderColor,null],e,g),borderRadius:j([d.borderRadius,0],e,g),borderWidth:j([d.borderWidth,0],e,g),clamp:j([d.clamp,!1],e,g),clip:j([d.clip,!1],e,g),color:l,display:b,font:k,lines:c,offset:j([d.offset,0],e,g),opacity:j([d.opacity,1],e,g),origin:h(f._el),padding:H.options.toPadding(j([d.padding,0],e,g)),positioner:i(f._el),rotation:j([d.rotation,0],e,g)*(Math.PI/180),size:B.textSize(f._ctx,c,k),textAlign:j([d.textAlign,"start"],e,g),textShadowBlur:j([d.textShadowBlur,0],e,g),textShadowColor:j([d.textShadowColor,l],e,g),textStrokeColor:j([d.textStrokeColor,l],e,g),textStrokeWidth:j([d.textStrokeWidth,0],e,g)}},update:function update(a){var b=this,c=null,d=null,e=b._index,f=b._config,h,i,j,k=H.options.resolve([f.display,!0],a,e);if(k){h=a.dataset.data[e];i=H.valueOrDefault(H.callback(f.formatter,[h,a]),h);j=H.isNullOrUndef(i)?[]:B.toTextLines(i);if(j.length){c=b._modelize(k,j,f,a);d=g(c)}}b._model=c;b._rects=d},geometry:function geometry(){return this._rects?this._rects.frame:{}},rotation:function rotation(){return this._model?this._model.rotation:0},visible:function visible(){return this._model&&this._model.opacity},model:function model(){return this._model},draw:function draw(a,b){var c=this,d=a.ctx,e=c._model,f=c._rects,g;if(!this.visible()){return}d.save();if(e.clip){g=e.area;d.beginPath();d.rect(g.left,g.top,g.right-g.left,g.bottom-g.top);d.clip()}d.globalAlpha=B.bound(0,e.opacity,1);d.translate(I(b.x),I(b.y));d.rotate(e.rotation);j(d,f.frame,e);m(d,e.lines,f.text,e);d.restore()}});var K=a.helpers,L=Number.MIN_SAFE_INTEGER||-9007199254740991,M=Number.MAX_SAFE_INTEGER||9007199254740991;function n(a,b,c){var d=Math.cos(c),e=Math.sin(c),f=b.x,g=b.y;return{x:f+d*(a.x-f)-e*(a.y-g),y:g+e*(a.x-f)+d*(a.y-g)}}function o(a,b){var c=M,d=L,e=b.origin,f,g,h,j,k;for(f=0;f<a.length;++f){g=a[f];h=g.x-e.x;j=g.y-e.y;k=b.vx*h+b.vy*j;c=Math.min(c,k);d=Math.max(d,k)}return{min:c,max:d}}function p(a,b){var c=b.x-a.x,d=b.y-a.y,e=Math.sqrt(c*c+d*d);return{vx:(b.x-a.x)/e,vy:(b.y-a.y)/e,origin:a,ln:e}}var N=function(){this._rotation=0;this._rect={x:0,y:0,w:0,h:0}};K.extend(N.prototype,{center:function center(){var a=this._rect;return{x:a.x+a.w/2,y:a.y+a.h/2}},update:function update(a,b,c){this._rotation=c;this._rect={x:b.x+a.x,y:b.y+a.y,w:b.w,h:b.h}},contains:function contains(a){var b=this,c=1,d=b._rect;a=n(a,b.center(),-b._rotation);return!(a.x<d.x-c||a.y<d.y-c||a.x>d.x+d.w+2*c||a.y>d.y+d.h+2*c)},intersects:function intersects(a){var b=this._points(),c=a._points(),d=[p(b[0],b[1]),p(b[0],b[3])],e,f,g;if(this._rotation!==a._rotation){d.push(p(c[0],c[1]),p(c[0],c[3]))}for(e=0;e<d.length;++e){f=o(b,d[e]);g=o(c,d[e]);if(f.max<g.min||g.max<f.min){return!1}}return!0},_points:function _points(){var a=this,b=a._rect,c=a._rotation,d=a.center();return[n({x:b.x,y:b.y},d,c),n({x:b.x+b.w,y:b.y},d,c),n({x:b.x+b.w,y:b.y+b.h},d,c),n({x:b.x,y:b.y+b.h},d,c)]}});function q(a,b,c){var d=b.positioner(a,b),e=d.vx,f=d.vy;if(!e&&!f){return{x:d.x,y:d.y}}var g=c.w,i=c.h,h=b.rotation,j=Math.abs(g/2*Math.cos(h))+Math.abs(i/2*Math.sin(h)),k=Math.abs(g/2*Math.sin(h))+Math.abs(i/2*Math.cos(h)),l=1/Math.max(Math.abs(e),Math.abs(f));j*=e*l;k*=f*l;j+=b.offset*e;k+=b.offset*f;return{x:d.x+j,y:d.y+k}}function r(a,b){var c,d,e,f;for(c=a.length-1;0<=c;--c){e=a[c].$layout;for(d=c-1;0<=d&&e._visible;--d){f=a[d].$layout;if(f._visible&&e._box.intersects(f._box)){b(e,f)}}}return a}function s(a){var b,c,d,e,f,g;for(b=0,c=a.length;b<c;++b){d=a[b];e=d.$layout;if(e._visible){f=d.geometry();g=q(d._el._model,d.model(),f);e._box.update(g,f,d.rotation())}}return r(a,function(a,b){var c=a._hidable,d=b._hidable;if(c&&d||d){b._visible=!1}else if(c){a._visible=!1}})}var O={prepare:function prepare(a){var b=[],c,d,e,f,g;for(c=0,e=a.length;c<e;++c){for(d=0,f=a[c].length;d<f;++d){g=a[c][d];b.push(g);g.$layout={_box:new N,_hidable:!1,_visible:!0,_set:c,_idx:d}}}b.sort(function(c,a){var b=c.$layout,d=a.$layout;return b._idx===d._idx?d._set-b._set:d._idx-b._idx});this.update(b);return b},update:function update(a){var b=!1,c,d,e,f,g;for(c=0,d=a.length;c<d;++c){e=a[c];f=e.model();g=e.$layout;g._hidable=f&&"auto"===f.display;g._visible=e.visible();b|=g._hidable}if(b){s(a)}},lookup:function lookup(a,b){var c,d;for(c=a.length-1;0<=c;--c){d=a[c].$layout;if(d&&d._visible&&d._box.contains(b)){return a[c]}}return null},draw:function draw(a,b){var c,d,e,f,g,h;for(c=0,d=b.length;c<d;++c){e=b[c];f=e.$layout;if(f._visible){g=e.geometry();h=q(e._el._view,e.model(),g);f._box.update(h,g,e.rotation());e.draw(a,h)}}}},P=a.helpers,Q=a.helpers,R="$datalabels",S="$default";function t(a,b){var c=a.datalabels,d={},e=[],f,g;if(!1===c){return null}if(!0===c){c={}}b=Q.merge({},[b,c]);f=b.labels||{};g=Object.keys(f);delete b.labels;if(g.length){g.forEach(function(a){if(f[a]){e.push(Q.merge({},[b,f[a],{_key:a}]))}})}else{e.push(b)}d=e.reduce(function(a,b){Q.each(b.listeners||{},function(c,d){a[d]=a[d]||{};a[d][b._key||S]=c});delete b.listeners;return a},{});return{labels:e,listeners:d}}function u(a,b,c){if(!b){return}var d=c.$context,e=c.$groups,f;if(!b[e._set]){return}f=b[e._set][e._key];if(!f){return}if(!0===Q.callback(f,[d])){a[R]._dirty=!0;c.update(d)}}function v(a,b,c,d){var e,f;if(!c&&!d){return}if(!c){e=!0}else if(!d){f=!0}else if(c!==d){f=e=!0}if(f){u(a,b.leave,c)}if(e){u(a,b.enter,d)}}function w(a,b){var c=a[R],d=c._listeners,e,f;if(!d.enter&&!d.leave){return}if("mousemove"===b.type){f=O.lookup(c._labels,b)}else if("mouseout"!==b.type){return}e=c._hovered;c._hovered=f;v(a,d,e,f)}function x(a,b){var c=a[R],d=c._listeners.click,e=d&&O.lookup(c._labels,b);if(e){u(a,d,e)}}function y(b){if(b.animating){return}for(var c=a.animationService.animations,d=0,e=c.length;d<e;++d){if(c[d].chart===b){return}}b.render({duration:1,lazy:!0})}a.defaults.global.plugins.datalabels={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function formatter(a){if(P.isNullOrUndef(a)){return null}var b=a,c,d,e;if(P.isObject(a)){if(!P.isNullOrUndef(a.label)){b=a.label}else if(!P.isNullOrUndef(a.r)){b=a.r}else{b="";c=Object.keys(a);for(e=0,d=c.length;e<d;++e){b+=(0!==e?", ":"")+c[e]+": "+a[c[e]]}}}return""+b},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0};var T={id:"datalabels",beforeInit:function beforeInit(a){a[R]={_actives:[]}},beforeUpdate:function beforeUpdate(a){var b=a[R];b._listened=!1;b._listeners={};b._datasets=[];b._labels=[]},afterDatasetUpdate:function afterDatasetUpdate(a,b,c){var d=b.index,e=a[R],f=e._datasets[d]=[],g=a.isDatasetVisible(d),h=a.data.datasets[d],k=t(h,c),l=b.meta.data||[],m=a.ctx,n,o,p,q,r,s,u,v;m.save();for(n=0,p=l.length;n<p;++n){u=l[n];u[R]=[];if(g&&u&&!u.hidden&&!u._model.skip){for(o=0,q=k.labels.length;o<q;++o){r=k.labels[o];s=r._key;v=new J(r,m,u,n);v.$groups={_set:d,_key:s||S};v.$context={active:!1,chart:a,dataIndex:n,dataset:h,datasetIndex:d};v.update(v.$context);u[R].push(v);f.push(v)}}}m.restore();Q.merge(e._listeners,k.listeners,{merger:function merger(a,c,d){c[a]=c[a]||{};c[a][b.index]=d[a];e._listened=!0}})},afterUpdate:function afterUpdate(a,b){a[R]._labels=O.prepare(a[R]._datasets,b)},afterDatasetsDraw:function afterDatasetsDraw(a){O.draw(a,a[R]._labels)},beforeEvent:function beforeEvent(a,b){if(a[R]._listened){switch(b.type){case"mousemove":case"mouseout":w(a,b);break;case"click":x(a,b);break;default:}}},afterEvent:function afterEvent(a){var b=a[R],c=b._actives,d=b._actives=a.lastActive||[],e=B.arrayDiff(c,d),f,g,h,k,l,m,n;for(f=0,g=e.length;f<g;++f){l=e[f];if(l[1]){n=l[0][R]||[];for(h=0,k=n.length;h<k;++h){m=n[h];m.$context.active=1===l[1];m.update(m.$context)}}}if(b._dirty||e.length){O.update(b._labels);y(a)}delete b._dirty}};a.plugins.register(T);return T});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("theme_coursemos/coursemos",["jquery","theme_coursemos/univ","core/event","core/modal_factory","core/modal_events","theme_coursemos/headroom","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery.mousewheel","theme_coursemos/jquery.mCustomScrollbar","theme_coursemos/bootstrap-datepicker","theme_coursemos/bootstrap-select"],function(a,b,c,d,e,f){var g={cssName:{backdrop:"coursemos-backdrop",menuBackdrop:"coursemos-menu-backdrop",headroomPin:"coursemos-headroom-pin",headroomUnpin:"coursemos-headroom-unpin",menuHide:"coursemos-menu-hide",menuPin:"coursemos-menu-pin",menuUnpin:"coursemos-menu-unpin",mobileMenuShow:"coursemos-mobile-menu-show",bodyBlur:"coursemos-body-blur",courseMain:"coursemos-coursepage-main",courseHeaderShow:"coursemos-coursepage-courseheader-show"},action:"/theme/coursemos/action.php"};g.init=function(){g.pluginInit();a("#page-header.headroom").headroom({tolerance:10,offset:100,onPin:g.headroomScrollPin,onUnpin:g.headroomScrollUnPin});if(0<a("#page-header.headroom").length){a("body").addClass(g.cssName.headroomPin)}a("#page-lnb .site-menus .site-menu-link").click(function(){var b=a(this).closest(".menu-item"),c=!0;if(!a("#page-lnb .site-menus").hasClass("hover")){a("#page-lnb .site-menus").addClass("hover");if(b.hasClass("active")){c=!1}}if(c){b.toggleClass("active")}});var c=a("#coursemos-common-buttons .page-heading-button button[type=\"submit\"]");if(0<c.length){c.each(function(){var b=a(this),c=b.find(".btn-txt");if(0==c.length){b.html("<span class=\"btn-txt\">"+b.text()+"</span>")}b.attr("title",b.text());b.tooltip({placement:"left",trigger:"hover"});if("/course/view.php"==location.pathname&&0>location.search.indexOf("notifyeditingon")){b.click(function(){var c=a(document).scrollTop(),d=1;a("li.section.main").each(function(){if(c>=a(this).position().top){if(a(this).is("[data-sectionid]")){d=a(this).data("sectionid")}}});var e=b.closest("form"),f=e.attr("action");f+="#section-"+d;e.attr("action",f)})}})}a("#coursemos-common-buttons .btn-option").click(function(){if(a("#coursemos-common-buttons").hasClass("open")){a("body").removeClass("coursemos-body-blur");a(".coursemos-common-buttons-backdrop").remove();a("#coursemos-common-buttons").removeClass("open");g.scrollLockCancel(a("#coursemos-common-buttons"))}else{var b="#coursemos-common-buttons .top-sidebar .btn-round,";b+=" #coursemos-common-buttons .top-sidebar button[type=\"submit\"]";a(b).each(function(){var b=a(this).find(".btn-txt");if(0==b.length){a(this).html("<span class=\"btn-txt\">"+a(this).text()+"</span>")}});a("body").addClass("coursemos-body-blur");a("#coursemos-common-buttons").addClass("open");if(0==a(".coursemos-common-buttons-backdrop").length){a("body").append(a("<div />").addClass(g.cssName.backdrop).addClass("coursemos-common-buttons-backdrop"));g.scrollLock(a(".coursemos-common-buttons-backdrop"));g.scrollLock(a("#coursemos-common-buttons"));a(".coursemos-common-buttons-backdrop").click(function(){a("body").removeClass(g.cssName.bodyBlur);a("#coursemos-common-buttons").removeClass("open");a(this).remove();g.scrollLockCancel(a("#coursemos-common-buttons"))})}}});a(".block-coursemos .block-hider-hide, .block-coursemos .block-hider-show").click(function(){var b=a(this).closest(".block-coursemos"),c=b.attr("data-name");if(c){var d="show";if(a(this).hasClass("block-hider-hide")){b.addClass("hidden");d="hide"}else{b.removeClass("hidden")}a.ajax({url:g.action,data:coursemostype+"=blockShowHide&blockname="+c+"&status="+d,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}}})}});if(a("body").hasClass("coursemos-coursepage")){a("#page-lnb .site-menus .site-menu-close").click(function(){g.siteMenuClose()});a(".block-coursemos-menu .topmenu > li > a").click(function(){a(this).parent().toggleClass("expand");return!1});a("#coursemos-common-buttons .button-item-mods.course-section-select .mod-icon").click(function(b){b.stopPropagation();g.courseSectionModal(a(this))});if(0<a(".block-coursemos-activity").length){a(".block-coursemos-activity .activities.course-section-select .btn-add-mod").click(function(b){b.stopPropagation();g.courseSectionModal(a(this))});a(".block-coursemos-activity .btn-more").click(function(){a(".block-coursemos-activity .more-activity").removeClass("hidden");a(this).parent().addClass("hidden");a(".block-coursemos-activity li.extra-modules").toggleClass("hidden")})}a("#coursemos-common-buttons .btn-share").click(function(){var b=a(this).data("courseid");if(1<b){a.ajax({url:g.action,data:coursemostype+"=courseModuleShareForm&courseid="+b,success:function success(a){if(a.code==mesg.success){g.setShare(a)}else{alert(a.msg)}}})}return!1});a("#coursemos-common-buttons .btn-share-module").click(function(){var b=a(this).data("courseid"),c=a(this).data("cmid");if(1<b){a.ajax({url:g.action,data:coursemostype+"=courseShareForm&courseid="+b+"&cmid="+c,success:function success(a){if(a.code==mesg.success){g.setShare(a)}else{alert(a.msg)}}})}return!1});if(0<a(".block-region .block__fake").length){a(".block-region .block__fake").each(function(){a("#page-lnb .course-menus .menus").prepend(a("<li>").append(a(this)))})}if(a("body").hasClass(g.cssName.courseMain)){var d=a("."+g.cssName.courseMain+" .btn-notification");d.tooltip({html:!0,placement:"left",trigger:"hover"});d.click(function(){var b=a(this),c=a(this).data("courseid"),e=0;if(a(this).hasClass("btn-notification-off")){e=1}a.ajax({url:g.action,data:coursemostype+"=notification&courseid="+c+"&visible="+e,type:"post",success:function success(a){if(a.code==mesg.success){var c=null;if(1==e){c="enable_notification";d.removeClass("btn-notification-off")}else{c="disable_notification";d.addClass("btn-notification-off")}var f=M.util.get_string(c,"local_ubnotification");b.attr("title",f).attr("data-original-title",f).tooltip("update").tooltip("show")}else{alert(a.msg);return!1}return!1}})})}}if(a("body").hasClass("coursemos-coursepage-main")){var l=a("#navbar-course-sections");if(0<l.length){var e=a("#page-header").outerHeight(),f=Math.floor(l.outerHeight());if(a("body").hasClass(g.cssName.headroomPin)){f+=e}a("body").scrollspy({target:"#navbar-course-sections",offset:f});a("#navbar-course-sections .nav-link").click(function(b){var c=parseInt(l.css("marginBottom")),d=a(b.target).attr("href"),f=a("body").data("bs.scrollspy");if(0<a(d).length&&f){var h=a(d).position().top,i=a("body").hasClass(g.cssName.headroomPin),j=!1;if(0<a("#page-course-header").length){h-=a("#page-course-header").outerHeight()}h-=f._config.offset;h+=1;a("html, body").animate({scrollTop:h},500,function(){var b=a("body").hasClass(g.cssName.headroomPin);if(i!=b&&!j){if(b){h-=e}else{h+=e}h-=c;a("html, body").animate({scrollTop:h},100);j=!0}});b.preventDefault();b.stopPropagation();b.stopImmediatePropagation()}});g.scrollSpyStickyTop();a(window).scroll(function(){g.scrollSpyStickyTop()})}}var h=a("#page-content .course-moduleactionmenu");if(0<h.length){var i=a("#maincontent + h2");if(0<i.length){h.removeClass("d-none");i.append(h)}}a("#page-header .navbar-toggler").click(function(){var b=a("body").hasClass("coursemos-page-xs")||a("body").hasClass("coursemos-page-sm"),c=g.cssName.menuHide;if(b){c=g.cssName.mobileMenuShow}var d=a("body").hasClass(c);g.backdrop(!1,!1);if(!d){a("body").addClass(c);if(b){g.menuBackdropShow()}}});a("#page-header .nav-item-userinfo .btn-userinfo").click(function(){if(!a("#page-userinfo").is(":visible")){g.menuBackdropHide();g.userInfoBackdropShow();if(0<a(this).find(".badge").length){a("#page-userinfo a[href=\"#tab-noti\"]").tab("show")}else{var b=a(this).data("courseid");g.userInfoMy(b)}a("#page-userinfo").show()}else{g.userInfoBackdropHide()}});a("#page-userinfo .nav-link-close").click(function(){g.userInfoBackdropHide()});a("#page-userinfo a[data-toggle=\"pill\"]").on("show.bs.tab",function(b){var c=a(b.target).data("type");if("my"==c){var d=a(b.target).data("courseid");g.userInfoMy(d)}else{g.userInfoNotifications()}});a("table").each(function(){if(!a(this).hasClass("message_user_pictures")&&!a(this).hasClass("ygtvtable")){if(!a(this).hasClass("table")){a(this).addClass("table table-bordered table-coursemos")}}});if(0<a("body.path-mod-wiki").length){var j=a("body.path-mod-wiki table.generalbox.table");if(!j.hasClass("table-coursemos")){j.addClass("table-coursemos")}var k=a(".mod-add-nav .wikisearch input[type=\"text\"]");if(0<k.length){if(!k.hasClass("form-control")){k.addClass("form-control")}}a("#page-mod-wiki-comments .midpad a").addClass("btn btn-default")}a("#coursemos-common-buttons .pagetop-btn").click(function(){a("body,html").animate({scrollTop:0},500);return!1});a("#page-footer .family-sites .btn-family-sites").popover({html:!0,container:"#page-footer",placement:"top",trigger:"click",content:function content(){return a("<div>").append(a("#page-footer .family-sites .family-site-list")).html()}});a("form.mform").not(".gradingbatchoperationsform, .noshowsubmit, [action*=\"/grade/export/\"]").submit(function(){showSubmitProgress();return!0});a(window).scroll(function(){g.scroll()});g.resize();a(window).resize(function(){g.resize()});b.init()};g.setShare=function(b){a("#coursemos-common-buttons .modal-share-modules").on("shown.bs.modal",function(b){a("#coursemos-common-buttons").css("z-index",a(b.target).css("z-index"));a("#coursemos-common-buttons .modal-share-modules .modal-body").scrollTop(0)});a("#coursemos-common-buttons .modal-share-modules").on("hide.bs.modal",function(){a("#coursemos-common-buttons").css("z-index","")});a("#coursemos-common-buttons .modal-share-modules .modal-html").html(b.html);a("#coursemos-common-buttons .modal-share-modules").modal("show");a("#coursemos-common-buttons .form-share").validate({submitHandler:function submitHandler(b){var c=a("<button type=\"button\"></button>");d.create({type:d.types.SAVE_CANCEL,title:M.util.get_string("share_modules","local_ubion"),body:M.util.get_string("share_desc","local_ubion")+M.util.get_string("share_confirm","local_ubion")},c).done(function(c){c.setSaveButtonText(M.util.get_string("share","local_ubion"));c.getRoot().on(e.save,function(d){d.preventDefault();showSubmitProgress();a.ajax({url:g.action,data:a(b).serialize(),success:function success(b){if(b.code==mesg.success){hideSubmitProgress();c.hide();if(null!==b.errorHtml){a("#coursemos-common-buttons .modal-share-modules .modal-html").html(b.errorHtml)}else{alert(b.msg);a("#coursemos-common-buttons .modal-share-modules").modal("hide")}}else{alert(b.msg)}}})})});c.trigger("click");return!1}})};g.scroll=function(){var b=a(document).scrollTop();if(100<b){a("#coursemos-common-buttons .pagetop-btn").fadeIn()}else{a("#coursemos-common-buttons .pagetop-btn").fadeOut()}};g.siteMenuClose=function(){a("#page-lnb .site-menus").removeClass("hover");var b=a(".coursemos-coursepage #page-lnb .site-menus .menu-item .active").closest(".site-menus");a(".coursemos-coursepage #page-lnb .site-menus .menu-item").removeClass("active");if(0<b.length){b.addClass("active")}};g.pluginInit=function(){a.ajaxSetup({type:"POST",error:function error(){hideProgress()},beforeSend:function beforeSend(b,c){if(!1!=c.contentType&&"application/json"!=c.contentType){var d={},e=c.data;if(e!==void 0&&0<e.length){e.replace(/([^&=]+)=?([^&]*)/g,function(b,c,e){var f=decodeURIComponent(c),g=decodeURIComponent(e);if(d[f]!==void 0){if(!a.isArray(d[f])){d[f]=[d[f]]}d[f].push(g)}else{d[f]=g}})}if(!d.hasOwnProperty("sesskey")){d.sesskey=M.cfg.sesskey}if(d.hasOwnProperty(coursemostype)&&!d.hasOwnProperty(coursemostype_noprogress)){}c.data=a.param(d)}},complete:function complete(){hideProgress()}});a.fn.center=function(b){if(b){b=this.parent()}else{b=window}this.css({position:"absolute",top:(a(b).height()-this.outerHeight())/2+a(b).scrollTop()+"px",left:(a(b).width()-this.outerWidth())/2+a(b).scrollLeft()+"px"});return this};a.fn.pagetop=function(){a(this).css({position:"fixed",top:"5px",left:a(window).scrollLeft()+(a(window).width()-a(this).width())/2+"px"});return this};if("ko"==M.cfg.lang){if(a.fn.datepicker.dates!==void 0){a.fn.datepicker.dates.ko={days:["\uC77C\uC694\uC77C","\uC6D4\uC694\uC77C","\uD654\uC694\uC77C","\uC218\uC694\uC77C","\uBAA9\uC694\uC77C","\uAE08\uC694\uC77C","\uD1A0\uC694\uC77C"],daysShort:["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"],daysMin:["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"],months:["1\uC6D4","2\uC6D4","3\uC6D4","4\uC6D4","5\uC6D4","6\uC6D4","7\uC6D4","8\uC6D4","9\uC6D4","10\uC6D4","11\uC6D4","12\uC6D4"],monthsShort:["1\uC6D4","2\uC6D4","3\uC6D4","4\uC6D4","5\uC6D4","6\uC6D4","7\uC6D4","8\uC6D4","9\uC6D4","10\uC6D4","11\uC6D4","12\uC6D4"],today:"\uC624\uB298",clear:"\uC0AD\uC81C",format:"yyyy-mm-dd",titleFormat:"yyyy\uB144mm\uC6D4",weekStart:0}}a.extend(a.validator.messages,{required:"\uD544\uC218 \uD56D\uBAA9\uC785\uB2C8\uB2E4.",remote:"\uD56D\uBAA9\uC744 \uC218\uC815\uD558\uC138\uC694.",email:"\uC720\uD6A8\uD558\uC9C0 \uC54A\uC740 E-Mail\uC8FC\uC18C\uC785\uB2C8\uB2E4.",url:"\uC720\uD6A8\uD558\uC9C0 \uC54A\uC740 URL\uC785\uB2C8\uB2E4.",date:"\uC62C\uBC14\uB978 \uB0A0\uC9DC\uB97C \uC785\uB825\uD558\uC138\uC694.",dateISO:"\uC62C\uBC14\uB978 \uB0A0\uC9DC(ISO)\uB97C \uC785\uB825\uD558\uC138\uC694.",number:"\uC720\uD6A8\uD55C \uC22B\uC790\uAC00 \uC544\uB2D9\uB2C8\uB2E4.",digits:"\uC22B\uC790\uB9CC \uC785\uB825 \uAC00\uB2A5\uD569\uB2C8\uB2E4.",creditcard:"\uC2E0\uC6A9\uCE74\uB4DC \uBC88\uD638\uAC00 \uBC14\uB974\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.",equalTo:"\uAC19\uC740 \uAC12\uC744 \uB2E4\uC2DC \uC785\uB825\uD558\uC138\uC694.",extension:"\uC62C\uBC14\uB978 \uD655\uC7A5\uC790\uAC00 \uC544\uB2D9\uB2C8\uB2E4.",maxlength:a.validator.format("{0}\uC790(\uAC1C) \uAE4C\uC9C0 \uC785\uB825(\uC120\uD0DD)\uD558\uC2E4\uC218 \uC788\uC2B5\uB2C8\uB2E4."),minlength:a.validator.format("{0}\uC790(\uAC1C) \uC774\uC0C1 \uC785\uB825(\uC120\uD0DD)\uD558\uC138\uC694."),rangelength:a.validator.format("\uBB38\uC790 \uAE38\uC774\uAC00 {0} \uC5D0\uC11C {1} \uC0AC\uC774\uC758 \uAC12\uC744 \uC785\uB825\uD558\uC138\uC694."),range:a.validator.format("{0} \uC5D0\uC11C {1} \uC0AC\uC774\uC758 \uAC12\uC744 \uC785\uB825\uD558\uC138\uC694."),max:a.validator.format("{0} \uC774\uD558\uC758 \uAC12\uC744 \uC785\uB825\uD558\uC138\uC694."),min:a.validator.format("{0} \uC774\uC0C1\uC758 \uAC12\uC744 \uC785\uB825\uD558\uC138\uC694."),decimalpointmax:"\uC815\uC218\uD615 \uB610\uB294 \uC18C\uC218\uC810 {0} \uC790\uB9AC\uAE4C\uC9C0 \uC785\uB825 \uAC00\uB2A5\uD569\uB2C8\uB2E4."})}else{a.extend(a.validator.messages,{decimalpointmax:"\uC815\uC218\uD615 \uB610\uB294 \uC18C\uC218\uC810 {0} \uC790\uB9AC\uAE4C\uC9C0 \uC785\uB825 \uAC00\uB2A5\uD569\uB2C8\uB2E4."})}a("[data-toggle=\"tooltip\"]").tooltip();a("[data-toggle=collapse]").collapse();a("body").popover({container:"body",selector:"[data-toggle=\"popover\"]",trigger:"focus"});document.addEventListener("keydown",function(b){if("Escape"===b.key&&b.target.closest("[data-toggle=\"popover\"]")){a(b.target).popover("hide")}});a.fn.headroom=function(b){return this.each(function(){var c=a(this),d=c.data("headroom"),e="object"===_typeof(b)&&b;e=a.extend(!0,{},f.options,e);if(!d){d=new f(this,e);d.init();c.data("headroom",d)}if("string"==typeof b){d[b]();if("destroy"===b){c.removeData("headroom")}}})};a(".div-scrollbar").mCustomScrollbar();a.extend(a.fn.datepicker.defaults,{format:"yyyy-mm-dd",language:M.cfg.lang,autoclose:!0,placeOffset:!1});a(".form-datepicker, [data-provide='datepicker']").datepicker();a("select[data-live-search=\"true\"]").selectpicker({style:"btn-default"});a.fn.serializeFiles=function(){var b=a(this),c=new FormData,d=b.serializeArray();a.each(b.find("input[type=\"file\"]"),function(b,d){a.each(a(d)[0].files,function(a,b){c.append(d.name,b)})});a.each(d,function(a,b){c.append(b.name,b.value)});return c};a(document).on("show.bs.modal",".modal",function(){var b=1050+1*a(".modal:visible").length;if(1060<=b){b=1059}a(this).css("z-index",b);setTimeout(function(){a(".modal-backdrop").not(".modal-stack").css("z-index",b-1).addClass("modal-stack")},0)})};g.resize=function(){var b=a(window).width();a("body").removeClass(function(a,b){return(b.match(/(^|\s)coursemos-page-\S+/g)||[]).join(" ")});var c="xs";if(576<=b&&768>b){c="sm"}else if(768<=b&&992>b){c="md"}else if(992<=b&&1200>b){c="lg"}else if(1200<b){c="xl"}a("body").addClass("coursemos-page-"+c)};g.backdrop=function(b,c){if(b){if(0<a("."+g.cssName.backdrop).length){a("."+g.cssName.backdrop).remove()}if(!a("body").hasClass(g.cssName.bodyBlur)){a("body").addClass(g.cssName.bodyBlur)}a("body").append(a("<div />").addClass(g.cssName.backdrop));a("."+g.cssName.backdrop).click(function(){a(this).remove()}).bind("click",c)}else{a("body").removeClass(g.cssName.bodyBlur);a("."+g.cssName.backdrop).trigger("click");a("."+g.cssName.backdrop).remove()}};g.menuBackdropShow=function(){g.backdrop(!0,g.menuBackdropHide);a("."+g.cssName.backdrop).addClass(g.cssName.menuBackdrop)};g.menuBackdropHide=function(){g.backdrop(!1,new function(){a("body").removeClass(g.cssName.bodyBlur).removeClass(g.cssName.mobileMenuShow);a("#page-lnb .site-menus").removeClass("hover");g.siteMenuClose()})};g.userInfoBackdropShow=function(){g.backdrop(!0,g.userInfoBackdropHide)};g.userInfoBackdropHide=function(){g.backdrop(!1,new function(){a("#page-userinfo").hide()})};g.courseSectionModal=function(b){var c=a(b).data("modname"),d=a(b).attr("title");if(""==d){d=a(b).data("original-title")}a("#modal-coursemos-sections").on("shown.bs.modal",function(){a("#modal-coursemos-sections .modal-body").scrollTop(0)});a("#modal-coursemos-sections .modal-title").text(d);a("#modal-coursemos-sections").modal("show");a("#modal-coursemos-sections .btn-modedit").off("click");a("#modal-coursemos-sections .btn-modedit").click(function(){location.href=a(this).attr("href")+"&add="+c;return!1})};g.scrollLock=function(b){a(b).on("mousewheel DOMMouseScroll wheel touchmove",function(a){a.preventDefault()})};g.scrollLockCancel=function(b){a(b).off("mousewheel DOMMouseScroll wheel touchmove")};g.userInfoMy=function(b){a.ajax({url:g.action,data:coursemostype+"=userInfoMy&courseid="+b,type:"post",success:function success(b){if(b.code==mesg.success){a("#tab-my .tab-content-container").html(b.html);a("#tab-my .div-scrollbar").mCustomScrollbar({axis:"y"});a(".dropdown-lang .a-lang").click(function(){var b=a(this).data("lang");a.ajax({url:g.action,data:coursemostype+"=langChange&lang="+b,type:"post",success:function success(a){if(a.code==mesg.success){location_search("lang",b)}else{alert(a.msg);return!1}return!1}})});a(".user-accounts select[name='accounts']").change(function(){var b=a(this).val(),c=a(this).children("option:selected").data("username"),f=a("<button type=\"button\"></button>");d.create({type:d.types.SAVE_CANCEL,title:M.util.get_string("user_change_login_title","local_ubion"),body:M.util.get_string("user_change_login","local_ubion",c)},f).done(function(a){a.setSaveButtonText(M.util.get_string("user_change_login_title","local_ubion"));a.getRoot().on(e.save,function(a){a.preventDefault();location.href=M.cfg.wwwroot+"/local/ubion/user/changeuser.php?id="+b+"&username="+c})});f.trigger("click")});a("#theme_darkmode").click(function(){var b=a(this).is(":checked"),c="light";if(b){c="dark"}darkmode(c,a(this).data("defaulttheme"),!0)})}else{alert(b.msg)}return!1}})};g.userInfoNotifications=function(){a.ajax({url:g.action,data:coursemostype+"=userInfoNotifications",type:"post",success:function success(b){if(b.code==mesg.success){a("#tab-noti .tab-content-container").html(b.html);a("#tab-noti .div-scrollbar").mCustomScrollbar({axis:"y"});a("#tab-noti .form-control-type").change(function(){var b=a(this).val();a("#tab-noti .media").each(function(){if(""==b){a(this).show()}else{if(a(this).data("type")==b){a(this).show()}else{a(this).hide()}}})});if("1"==b.isNotificationAllRead){a("#page-header .nav-item-userinfo .btn-userinfo .badge").remove()}a("#tab-noti .tab-content-container .btn-noti-all-read").click(function(){a.ajax({url:g.action,data:coursemostype+"=readNotificationAll",success:function success(b){if(b.code==mesg.success){a("#page-header .nav-item-userinfo .btn-userinfo .badge").remove();a("#tab-noti .media").remove();a("#tab-noti .row-all-read").remove();a("#tab-noti .userinfo-title .noreadcount").text(0)}else{alert(b.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});a("#tab-noti .tab-content-container .btn-noti-delete").click(function(b){b.preventDefault();b.stopPropagation();b.stopImmediatePropagation();var c=a(this).closest(".media"),d=c.data("type"),e=a(this).data("id");a(this).html("<div class=\"spinner-border\" role=\"status\"><span class=\"sr-only\">Loading...</span></div>");a.ajax({url:g.action,data:coursemostype+"=readNotification&type="+d+"&id="+e,success:function success(b){if(b.code==mesg.success){c.remove();var d=a("#page-header .nav-item-userinfo .btn-userinfo .badge");if(0<d.length){var e=parseInt(d.text())-1;if(0<e){d.text(e)}else{d.remove();a("#tab-noti .row-all-read").remove()}a("#tab-noti .userinfo-title .noreadcount").text(e)}}else{alert(b.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}});return!1})}else{alert(b.msg)}return!1}})};g.courseHeaderShowHide=function(b){if(a("body").hasClass(g.cssName.courseMain)){if(0<b){a("body").removeClass(g.cssName.courseHeaderShow)}else{a("body").addClass(g.cssName.courseHeaderShow)}}};g.headroomScrollPin=function(){a("body").addClass(g.cssName.headroomPin).removeClass(g.cssName.headroomUnpin);if(a("body").hasClass("coursemos-coursepage-main")){g.courseSectionScrollspyOffset(!0)}};g.headroomScrollUnPin=function(){a("body").addClass(g.cssName.headroomUnpin).removeClass(g.cssName.headroomPin);if(a("body").hasClass("coursemos-coursepage-main")){g.courseSectionScrollspyOffset(!1)}};g.courseSectionScrollspyOffset=function(b){var c=a("#navbar-course-sections");if(0<c.length){var d=Math.floor(c.outerHeight()),e=a("body").data("bs.scrollspy");if(e){if(b){d+=a("#page-header").outerHeight()}if(e._config.offset!=d){e._config.offset=d;a("body").data("bs.scrollspy",e);a("body").scrollspy("refresh")}}}};g.scrollSpyStickyTop=function(){if(100<a(window).scrollTop()){if(!a("#navbar-course-sections").hasClass("sticky-top")){a("#navbar-course-sections").addClass("sticky-top")}}else{a("#navbar-course-sections").removeClass("sticky-top")}};return g});
define ("theme_coursemos/form-display-errors",["jquery","core/event"],function(a,b){return{enhance:function enhance(c){var d=document.getElementById(c);a(d).on(b.Events.FORM_FIELD_VALIDATION,function(b,c){b.preventDefault();var e=a(d).closest(".form-group"),f=e.find(".form-control-feedback");if("TEXTAREA"==a(d).prop("tagName")&&e.find("[contenteditable]")){d=e.find("[contenteditable]")}if(""!==c){e.addClass("has-danger");e.data("client-validation-error",!0);a(d).addClass("is-invalid");a(d).attr("aria-describedby",f.attr("id"));a(d).attr("aria-invalid",!0);f.attr("tabindex",0);f.html(c);if(!f.is(":visible")){f.show();f.focus()}}else{if(!0===e.data("client-validation-error")){e.removeClass("has-danger");e.data("client-validation-error",!1);a(d).removeClass("is-invalid");a(d).removeAttr("aria-describedby");a(d).attr("aria-invalid",!1);f.hide()}}})}}});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a,b){'use strict';if("function"==typeof define&&define.amd){define ("theme_coursemos/headroom",[],b)}else if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))){module.exports=b()}else{a.Headroom=b()}})(this,function(){'use strict';var f={bind:!!function(){}.bind,classList:"classList"in document.documentElement,rAF:!!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame)};window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;function a(a){this.callback=a;this.ticking=!1}a.prototype={constructor:a,update:function update(){this.callback&&this.callback();this.ticking=!1},requestTick:function requestTick(){if(!this.ticking){requestAnimationFrame(this.rafCallback||(this.rafCallback=this.update.bind(this)));this.ticking=!0}},handleEvent:function handleEvent(){this.requestTick()}};function b(a){return a&&"undefined"!=typeof window&&(a===window||a.nodeType)}function c(a){if(0>=arguments.length){throw new Error("Missing arguments in extend function")}var d=a||{},e,f;for(f=1;f<arguments.length;f++){var g=arguments[f]||{};for(e in g){if("object"===_typeof(d[e])&&!b(d[e])){d[e]=c(d[e],g[e])}else{d[e]=d[e]||g[e]}}}return d}function d(a){return a===Object(a)?a:{down:a,up:a}}function e(a,b){b=c(b,e.options);this.lastKnownScrollY=0;this.elem=a;this.tolerance=d(b.tolerance);this.classes=b.classes;this.offset=b.offset;this.scroller=b.scroller;this.initialised=!1;this.onPin=b.onPin;this.onUnpin=b.onUnpin;this.onTop=b.onTop;this.onNotTop=b.onNotTop;this.onBottom=b.onBottom;this.onNotBottom=b.onNotBottom}e.prototype={constructor:e,init:function init(){if(!e.cutsTheMustard){return}this.debouncer=new a(this.update.bind(this));this.elem.classList.add(this.classes.initial);setTimeout(this.attachEvent.bind(this),100);return this},destroy:function destroy(){var a=this.classes;this.initialised=!1;for(var b in a){if(a.hasOwnProperty(b)){this.elem.classList.remove(a[b])}}this.scroller.removeEventListener("scroll",this.debouncer,!1)},attachEvent:function attachEvent(){if(!this.initialised){this.lastKnownScrollY=this.getScrollY();this.initialised=!0;this.scroller.addEventListener("scroll",this.debouncer,!1);this.debouncer.handleEvent()}},unpin:function unpin(){var a=this.elem.classList,b=this.classes;if(a.contains(b.pinned)||!a.contains(b.unpinned)){a.add(b.unpinned);a.remove(b.pinned);this.onUnpin&&this.onUnpin.call(this)}},pin:function pin(){var a=this.elem.classList,b=this.classes;if(a.contains(b.unpinned)){a.remove(b.unpinned);a.add(b.pinned);this.onPin&&this.onPin.call(this)}},top:function top(){var a=this.elem.classList,b=this.classes;if(!a.contains(b.top)){a.add(b.top);a.remove(b.notTop);this.onTop&&this.onTop.call(this)}},notTop:function notTop(){var a=this.elem.classList,b=this.classes;if(!a.contains(b.notTop)){a.add(b.notTop);a.remove(b.top);this.onNotTop&&this.onNotTop.call(this)}},bottom:function bottom(){var a=this.elem.classList,b=this.classes;if(!a.contains(b.bottom)){a.add(b.bottom);a.remove(b.notBottom);this.onBottom&&this.onBottom.call(this)}},notBottom:function notBottom(){var a=this.elem.classList,b=this.classes;if(!a.contains(b.notBottom)){a.add(b.notBottom);a.remove(b.bottom);this.onNotBottom&&this.onNotBottom.call(this)}},getScrollY:function getScrollY(){return this.scroller.pageYOffset!==void 0?this.scroller.pageYOffset:this.scroller.scrollTop!==void 0?this.scroller.scrollTop:(document.documentElement||document.body.parentNode||document.body).scrollTop},getViewportHeight:function getViewportHeight(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},getElementPhysicalHeight:function getElementPhysicalHeight(a){return Math.max(a.offsetHeight,a.clientHeight)},getScrollerPhysicalHeight:function getScrollerPhysicalHeight(){return this.scroller===window||this.scroller===document.body?this.getViewportHeight():this.getElementPhysicalHeight(this.scroller)},getDocumentHeight:function getDocumentHeight(){var a=document.body,b=document.documentElement;return Math.max(a.scrollHeight,b.scrollHeight,a.offsetHeight,b.offsetHeight,a.clientHeight,b.clientHeight)},getElementHeight:function getElementHeight(a){return Math.max(a.scrollHeight,a.offsetHeight,a.clientHeight)},getScrollerHeight:function getScrollerHeight(){return this.scroller===window||this.scroller===document.body?this.getDocumentHeight():this.getElementHeight(this.scroller)},isOutOfBounds:function isOutOfBounds(a){var b=a+this.getScrollerPhysicalHeight()>this.getScrollerHeight();return 0>a||b},toleranceExceeded:function toleranceExceeded(a,b){return Math.abs(a-this.lastKnownScrollY)>=this.tolerance[b]},shouldUnpin:function shouldUnpin(a,b){var c=a>this.lastKnownScrollY,d=a>=this.offset;return c&&d&&b},shouldPin:function shouldPin(a,b){var c=a<this.lastKnownScrollY,d=a<=this.offset;return c&&b||d},update:function update(){var a=this.getScrollY(),b=a>this.lastKnownScrollY?"down":"up",c=this.toleranceExceeded(a,b);if(this.isOutOfBounds(a)){return}if(a<=this.offset){this.top()}else{this.notTop()}if(a+this.getViewportHeight()>=this.getScrollerHeight()){this.bottom()}else{this.notBottom()}if(this.shouldUnpin(a,c)){this.unpin()}else if(this.shouldPin(a,c)){this.pin()}this.lastKnownScrollY=a}};e.options={tolerance:{up:0,down:0},offset:0,scroller:window,classes:{pinned:"headroom--pinned",unpinned:"headroom--unpinned",top:"headroom--top",notTop:"headroom--not-top",bottom:"headroom--bottom",notBottom:"headroom--not-bottom",initial:"headroom"}};e.cutsTheMustard="undefined"!=typeof f&&f.rAF&&f.bind&&f.classList;return e});
define ("theme_coursemos/index",["jquery","theme_coursemos/slick","theme_coursemos/bootstrap"],function(a){var b={};b.init=function(c){a(".col-dash .form-control-autosubmit").change(function(){b.submit(a(this))});a(".col-dash .form-control-period").change(function(){if(0<a(".col-dash .my-course-lists-hakgi").length){var c=a(this).val(),d="no_mycourses_period_"+c;a(".col-dash .my-course-lists .lists .course.course-empty").not(".course-empty-default").remove();if(""==c){a(".col-dash .my-course-lists .lists .course").show();d="no_mycourses"}else{a(".col-dash .my-course-lists .lists .course").each(function(){a(this).hide();if(0<a(this).find(".badge-period-"+c).length){a(this).show()}})}a(".col-dash .fieldset-course").each(function(){if(0==a(this).find(".lists .course:visible").length){var b="<div class=\"course course-empty\">"+M.util.get_string(d,"local_ubion")+"</div>";a(this).find(".lists").append(b)}})}else{b.layout1TypePeriodChange()}});a(".col-dash .filter .form-control-coursetype").change(function(){if(a(this).closest(".course-lists").hasClass("course-layout-hakgi")){var b=a(this).val(),d=a(".col-dash .filter .form-control-semester");if(0<=a.inArray(b,c)){d.show()}else{d.hide()}}});a(".col-dash .layout-option .btn-layout").tooltip();a(".col-dash .layout-option .btn-layout").click(function(){var b=a(this),c=b.data("type");if(c){a.ajax({url:"/theme/coursemos/action.php",data:coursemostype+"=layout&layout="+c,type:"post",success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg);return!1}}})}});a(".col-dash .my-course-lists .course-favorite").click(function(){a(".col-dash .mycourse-favorite").removeClass("hidden");var c=a(this).closest(".course"),d=c.data("id");if(0<d){a.ajax({url:"/local/ubion/user/action.php",data:coursemostype+"=favorite&courseid="+d,type:"post",success:function success(d){if(d.code==mesg.success){if(0<a(".col-dash .mycourse-favorite .course[data-id='"+c.data("id")+"']").length){alert(M.util.get_string("favorite_courses_registered","local_ubion"))}else{var e=c.clone().appendTo(".col-dash .mycourse-favorite .lists");c.find(".course-favorite").addClass("disabled");e.find(".course-favorite").click(function(){b.favoriteCancel(a(this));return!1})}}else{alert(d.msg);return!1}}})}return!1});a(".col-dash .mycourse-favorite .course-favorite").click(function(){b.favoriteCancel(a(this));return!1});a(".col-dash .my-course-lists [data-toggle='tooltip']").tooltip({container:".my-course-lists",placement:"bottom"});var d=a(".col-dash .ocw-course-latest"),e;if(0<d.length){e=b.ocwSlickOption("latest",1);d.find(".ocw-course-lists").slick(e)}var f=a(".col-dash .ocw-course-popular");if(0<f.length){e=b.ocwSlickOption("popular",1);f.find(".ocw-course-lists").slick(e)}var g=a(".col-dash .ocw-course-category");if(0<g.length){e=b.ocwSlickOption("category",6);g.find(".ocw-course-lists").slick(e)}};b.slideBreakPoints=function(a,b){var c=a;if(a>b){c=b}return c};b.courseDetail=function(c){var d={xs:3,md:6,lg:9};a(".col-dash .my-course-lists .course-sections .course-section").each(function(){var e=a(this).closest(".course"),f=e.data("id"),g=e.data("section-count"),h=".course-section-"+f+" .slick-container",i=b.slideBreakPoints(g,d.xs),j=b.slideBreakPoints(g,d.md),k=b.slideBreakPoints(g,d.lg),l=b.slideBreakPoints(g,c),m=3,n=a(h).slick({infinite:!1,speed:300,dots:!1,slidesToShow:l,slidesToScroll:m,prevArrow:".course-section-"+f+" .slick-button-prev",nextArrow:".course-section-"+f+" .slick-button-next",responsive:[{breakpoint:576,settings:{slidesToShow:i}},{breakpoint:992,settings:{slidesToShow:j}},{breakpoint:1200,settings:{slidesToShow:k}}]});n.on("breakpoint",function(){a(h+" [data-toggle=\"tooltip\"]").tooltip("dispose");a(h+" [data-toggle=\"tooltip\"]").tooltip()});n.on("setPosition",function(){a(h+" .slick-slide").removeClass("br-s br-e");a(h+" .slick-active:first").addClass("br-s");a(h+" .slick-active:last").addClass("br-e")});var o=e.data("current-section");if(0<o){o=o-m;if(0<o){}}a(h+" [data-toggle=\"tooltip\"]").tooltip()});a(".col-dash .my-course-lists .btn-more-detail").click(function(){var b=a(this).closest(".course"),c="course-detail-show",d=a(this);if(0<b.length){var e=b.data("id"),f=b.find(".course-detail");if(0<f.length){if(!b.hasClass(c)){d.addClass("loading");a.ajax({url:"/theme/coursemos/action.php",data:coursemostype+"=courseDetail&courseid="+e,success:function success(a){d.removeClass("loading");if(a.code==mesg.success){f.html(a.html);b.addClass(c)}else{alert(a.msg)}}})}else{b.removeClass(c)}}}else{alert("nocourseid")}});a(document).on("click",".col-dash .my-course-lists .section-info",function(){var b=a(this).closest(".course").data("id"),c=a(this).data("section");if(b!=void 0&&c!=void 0){a.ajax({url:"/theme/coursemos/action.php",data:coursemostype+"=courseDetailSection&courseid="+b+"&section="+c,success:function success(b){if(b.code==mesg.success){var c=a(".col-dash .my-course-lists-progress .modal-section-info");c.find(".modal-title").text(b.title);c.find(".modal-body").html(b.html);c.modal("show")}else{alert(b.msg)}}})}});a(document).on("click",".col-dash .my-course-lists #nav-notice .article-link-popup .article-link",function(){var b=a(this).data("cmid"),c=a(this).data("id");if(b!=void 0&&c!=void 0){a.ajax({url:"/theme/coursemos/action.php",data:coursemostype+"=noticeArticle&cmid="+b+"&id="+c,success:function success(b){if(b.code==mesg.success){var c=a(".col-dash .my-course-lists-progress .modal-notice");c.find(".modal-title").html(b.title);c.find(".modal-body").html(b.html);c.modal("show")}else{alert(b.msg)}}})}return!1})};b.favoriteCancel=function(b){var c=a(b).closest(".course"),d=c.data("id");a.ajax({url:"/local/ubion/user/action.php",data:coursemostype+"=favoriteCancel&courseid="+d,type:"post",success:function success(b){if(b.code==mesg.success){c.remove();if(0<a(".col-dash .my-course-lists .course[data-id='"+c.data("id")+"']").length){a(".col-dash .my-course-lists .course[data-id='"+c.data("id")+"'] .course-favorite").removeClass("disabled")}if(0==a(".col-dash .mycourse-favorite .course").length){a(".col-dash .mycourse-favorite").addClass("hidden")}}else{alert(b.msg);return!1}}})};b.submit=function(c){var d=a(".col-dash .filter .form-control-coursetype").val(),e=a(".col-dash .filter .form-control-year").val(),f="";if(0<a(".col-dash .form-control-semester").length){f=a(".col-dash .form-control-semester").val()}if(a(".col-dash .course-lists").hasClass("course-layout-2")){a.ajax({url:"/theme/coursemos/action.php",data:coursemostype+"=myCoursesHakgi&year="+e+"&semester="+f+"&coursetype="+d,type:"post",success:function success(c){if(c.code==mesg.success){a(".col-dash .my-course-lists").html(c.html);a(".col-dash .my-course-lists .form-control-submit").change(function(){b.submit(a(this))});if(""!=a(".col-dash .form-control-period").val()){a(".col-dash .form-control-period").trigger("change")}}else{alert(c.msg);return!1}}})}else if(a(".col-dash .course-lists").hasClass("course-layout-1")){if(a(c).hasClass("form-control-coursetype")){b.layout1TypePeriodChange()}}};b.layout1TypePeriodChange=function(){var b=a(".col-dash .form-control-coursetype").val(),c=a(".col-dash .form-control-period").val(),d="no_mycourses";a(".col-dash .my-course-lists .lists .course.course-empty").remove();if(""==b){a(".col-dash .my-course-lists .lists .course").show()}else{a(".col-dash .my-course-lists .lists .course").hide();a(".col-dash .my-course-lists .lists .course.course-type-"+b).show()}if(""!=c){d="no_mycourses_period_"+c;a(".col-dash .my-course-lists .lists .course:visible").each(function(){a(this).hide();if(0<a(this).find(".badge-period-"+c).length){a(this).show()}})}if(0==a(".col-dash .my-course-lists .lists .course:visible").length){a(".col-dash .my-course-lists .lists").append("<div class=\"course course-empty\">"+M.util.get_string(d,"local_ubion")+"</div>")}};b.ocwSlickOption=function(a,b){var c={infinite:!1,speed:300,dots:!1,slidesToShow:b,slidesToScroll:b,prevArrow:".ocw-course-"+a+" .btn-action-prev",nextArrow:".ocw-course-"+a+" .btn-action-next"};switch(a){case"category":c.responsive=[{breakpoint:576,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:1200,settings:{slidesToShow:4,slidesToScroll:4}}];break;default:break;}return c};return b});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("theme_coursemos/jquery-sortable",["jquery"],function(){!function(a,b,c){var j={drag:!0,drop:!0,exclude:"",nested:!0,vertical:!0},k={afterMove:function afterMove(){},containerPath:"",containerSelector:"ol, ul",distance:0,delay:0,handle:"",itemPath:"",itemSelector:"li",bodyClass:"dragging",draggedClass:"dragged",isValidTarget:function isValidTarget(){return!0},onCancel:function onCancel(){},onDrag:function onDrag(a,b){a.css(b)},onDragStart:function onDragStart(b,c){b.css({height:b.outerHeight(),width:b.outerWidth()});b.addClass(c.group.options.draggedClass);a("body").addClass(c.group.options.bodyClass)},onDrop:function onDrop(b,c){b.removeClass(c.group.options.draggedClass).removeAttr("style");a("body").removeClass(c.group.options.bodyClass)},onMousedown:function onMousedown(a,b,c){if(!c.target.nodeName.match(/^(input|select|textarea)$/i)){c.preventDefault();return!0}},placeholderClass:"placeholder",placeholder:"<li class=\"placeholder\"></li>",pullPlaceholder:!0,serialize:function serialize(b,c,d){var e=a.extend({},b.data());if(d)return[c];else if(c[0]){e.children=c}delete e.subContainers;delete e.sortable;return e},tolerance:0},l={},m=0,n={left:0,top:0,bottom:0,right:0},o={start:"touchstart.sortable mousedown.sortable",drop:"touchend.sortable touchcancel.sortable mouseup.sortable",drag:"touchmove.sortable mousemove.sortable",scroll:"scroll.sortable"};function e(c,a){var b=Math.max(0,c[0]-a[0],a[0]-c[1]),d=Math.max(0,c[2]-a[1],a[1]-c[3]);return b+d}function d(b,c,d,e){var f=b.length,g=e?"offset":"position";d=d||0;while(f--){var h=b[f].el?b[f].el:a(b[f]),j=h[g]();j.left+=parseInt(h.css("margin-left"),10);j.top+=parseInt(h.css("margin-top"),10);c[f]=[j.left-d,j.left+h.outerWidth()+d,j.top-d,j.top+h.outerHeight()+d]}}function f(a,b){var c=b.offset();return{left:a.left-c.left,top:a.top-c.top}}function g(a,b,c){b=[b.left,b.top];c=c&&[c.left,c.top];var d,f=a.length,g=[];while(f--){d=a[f];g[f]=[f,e(d,b),c&&e(d,c)]}g=g.sort(function(c,a){return a[1]-c[1]||a[2]-c[2]||a[0]-c[0]});return g}function h(b){this.options=a.extend({},k,b);this.containers=[];if(!this.options.rootGroup){this.scrollProxy=a.proxy(this.scroll,this);this.dragProxy=a.proxy(this.drag,this);this.dropProxy=a.proxy(this.drop,this);this.placeholder=a(this.options.placeholder);if(!b.isValidTarget)this.options.isValidTarget=void 0}}h.get=function(a){if(!l[a.group]){if(a.group===void 0)a.group=m++;l[a.group]=new h(a)}return l[a.group]};h.prototype={dragInit:function dragInit(b,c){this.$document=a(c.el[0].ownerDocument);var d=a(b.target).closest(this.options.itemSelector);if(d.length){this.item=d;this.itemContainer=c;if(this.item.is(this.options.exclude)||!this.options.onMousedown(this.item,k.onMousedown,b)){return}this.setPointer(b);this.toggleListeners("on");this.setupDelayTimer();this.dragInitDone=!0}},drag:function drag(a){if(!this.dragging){if(!this.distanceMet(a)||!this.delayMet)return;this.options.onDragStart(this.item,this.itemContainer,k.onDragStart,a);this.item.before(this.placeholder);this.dragging=!0}this.setPointer(a);this.options.onDrag(this.item,f(this.pointer,this.item.offsetParent()),k.onDrag,a);var b=this.getPointer(a),c=this.sameResultBox,d=this.options.tolerance;if(!c||c.top-d>b.top||c.bottom+d<b.top||c.left-d>b.left||c.right+d<b.left)if(!this.searchValidTarget()){this.placeholder.detach();this.lastAppendedItem=void 0}},drop:function drop(a){this.toggleListeners("off");this.dragInitDone=!1;if(this.dragging){if(this.placeholder.closest("html")[0]){this.placeholder.before(this.item).detach()}else{this.options.onCancel(this.item,this.itemContainer,k.onCancel,a)}this.options.onDrop(this.item,this.getContainer(this.item),k.onDrop,a);this.clearDimensions();this.clearOffsetParent();this.lastAppendedItem=this.sameResultBox=void 0;this.dragging=!1}},searchValidTarget:function searchValidTarget(a,b){if(!a){a=this.relativePointer||this.pointer;b=this.lastRelativePointer||this.lastPointer}var c=g(this.getContainerDimensions(),a,b),d=c.length;while(d--){var e=c[d][0],h=c[d][1];if(!h||this.options.pullPlaceholder){var j=this.containers[e];if(!j.disabled){if(!this.$getOffsetParent()){var k=j.getItemOffsetParent();a=f(a,k);b=f(b,k)}if(j.searchValidTarget(a,b))return!0}}}if(this.sameResultBox)this.sameResultBox=void 0},movePlaceholder:function movePlaceholder(a,b,c,d){var e=this.lastAppendedItem;if(!d&&e&&e[0]===b[0])return;b[c](this.placeholder);this.lastAppendedItem=b;this.sameResultBox=d;this.options.afterMove(this.placeholder,a,b)},getContainerDimensions:function getContainerDimensions(){if(!this.containerDimensions)d(this.containers,this.containerDimensions=[],this.options.tolerance,!this.$getOffsetParent());return this.containerDimensions},getContainer:function getContainer(a){return a.closest(this.options.containerSelector).data(c)},$getOffsetParent:function $getOffsetParent(){if(this.offsetParent===void 0){var a=this.containers.length-1,b=this.containers[a].getItemOffsetParent();if(!this.options.rootGroup){while(a--){if(b[0]!=this.containers[a].getItemOffsetParent()[0]){b=!1;break}}}this.offsetParent=b}return this.offsetParent},setPointer:function setPointer(a){var b=this.getPointer(a);if(this.$getOffsetParent()){var c=f(b,this.$getOffsetParent());this.lastRelativePointer=this.relativePointer;this.relativePointer=c}this.lastPointer=this.pointer;this.pointer=b},distanceMet:function distanceMet(a){var b=this.getPointer(a);return Math.max(Math.abs(this.pointer.left-b.left),Math.abs(this.pointer.top-b.top))>=this.options.distance},getPointer:function getPointer(a){var b=a.originalEvent||a.originalEvent.touches&&a.originalEvent.touches[0];return{left:a.pageX||b.pageX,top:a.pageY||b.pageY}},setupDelayTimer:function setupDelayTimer(){var a=this;this.delayMet=!this.options.delay;if(!this.delayMet){clearTimeout(this._mouseDelayTimer);this._mouseDelayTimer=setTimeout(function(){a.delayMet=!0},this.options.delay)}},scroll:function scroll(){this.clearDimensions();this.clearOffsetParent()},toggleListeners:function toggleListeners(b){var c=this;a.each(["drag","drop","scroll"],function(a,d){c.$document[b](o[d],c[d+"Proxy"])})},clearOffsetParent:function clearOffsetParent(){this.offsetParent=void 0},clearDimensions:function clearDimensions(){this.traverse(function(a){a._clearDimensions()})},traverse:function traverse(a){a(this);var b=this.containers.length;while(b--){this.containers[b].traverse(a)}},_clearDimensions:function _clearDimensions(){this.containerDimensions=void 0},_destroy:function _destroy(){l[this.options.group]=void 0}};function i(b,c){this.el=b;this.options=a.extend({},j,c);this.group=h.get(this.options);this.rootGroup=this.options.rootGroup||this.group;this.handle=this.rootGroup.options.handle||this.rootGroup.options.itemSelector;var d=this.rootGroup.options.itemPath;this.target=d?this.el.find(d):this.el;this.target.on(o.start,this.handle,a.proxy(this.dragInit,this));if(this.options.drop)this.group.containers.push(this)}i.prototype={dragInit:function dragInit(a){var b=this.rootGroup;if(!this.disabled&&!b.dragInitDone&&this.options.drag&&this.isValidDrag(a)){b.dragInit(a,this)}},isValidDrag:function isValidDrag(a){return 1==a.which||"touchstart"==a.type&&1==a.originalEvent.touches.length},searchValidTarget:function searchValidTarget(a,b){var c=g(this.getItemDimensions(),a,b),d=c.length,e=this.rootGroup,f=!e.options.isValidTarget||e.options.isValidTarget(e.item,this);if(!d&&f){e.movePlaceholder(this,this.target,"append");return!0}else while(d--){var h=c[d][0],j=c[d][1];if(!j&&this.hasChildGroup(h)){var k=this.getContainerGroup(h).searchValidTarget(a,b);if(k)return!0}else if(f){this.movePlaceholder(h,a);return!0}}},movePlaceholder:function movePlaceholder(b,c){var d=a(this.items[b]),e=this.itemDimensions[b],f="after",g=d.outerWidth(),h=d.outerHeight(),i=d.offset(),j={left:i.left,right:i.left+g,top:i.top,bottom:i.top+h};if(this.options.vertical){var k=(e[2]+e[3])/2,l=c.top<=k;if(l){f="before";j.bottom-=h/2}else j.top+=h/2}else{var m=(e[0]+e[1])/2,o=c.left<=m;if(o){f="before";j.right-=g/2}else j.left+=g/2}if(this.hasChildGroup(b))j=n;this.rootGroup.movePlaceholder(this,d,f,j)},getItemDimensions:function getItemDimensions(){if(!this.itemDimensions){this.items=this.$getChildren(this.el,"item").filter(":not(."+this.group.options.placeholderClass+", ."+this.group.options.draggedClass+")").get();d(this.items,this.itemDimensions=[],this.options.tolerance)}return this.itemDimensions},getItemOffsetParent:function getItemOffsetParent(){var a,b=this.el;if("relative"===b.css("position")||"absolute"===b.css("position")||"fixed"===b.css("position"))a=b;else a=b.offsetParent();return a},hasChildGroup:function hasChildGroup(a){return this.options.nested&&this.getContainerGroup(a)},getContainerGroup:function getContainerGroup(b){var d=a.data(this.items[b],"subContainers");if(d===void 0){var e=this.$getChildren(this.items[b],"container");d=!1;if(e[0]){var f=a.extend({},this.options,{rootGroup:this.rootGroup,group:m++});d=e[c](f).data(c).group}a.data(this.items[b],"subContainers",d)}return d},$getChildren:function $getChildren(b,c){var d=this.rootGroup.options,e=d[c+"Path"],f=d[c+"Selector"];b=a(b);if(e)b=b.find(e);return b.children(f)},_serialize:function _serialize(b,c){var d=this,e=c?"item":"container",f=this.$getChildren(b,e).not(this.options.exclude).map(function(){return d._serialize(a(this),!c)}).get();return this.rootGroup.options.serialize(b,f,c)},traverse:function traverse(b){a.each(this.items||[],function(){var c=a.data(this,"subContainers");if(c)c.traverse(b)});b(this)},_clearDimensions:function _clearDimensions(){this.itemDimensions=void 0},_destroy:function _destroy(){var b=this;this.target.off(o.start,this.handle);this.el.removeData(c);if(this.options.drop)this.group.containers=a.grep(this.group.containers,function(a){return a!=b});a.each(this.items||[],function(){a.removeData(this,"subContainers")})}};var p={enable:function enable(){this.traverse(function(a){a.disabled=!1})},disable:function disable(){this.traverse(function(a){a.disabled=!0})},serialize:function serialize(){return this._serialize(this.el,!0)},refresh:function refresh(){this.traverse(function(a){a._clearDimensions()})},destroy:function destroy(){this.traverse(function(a){a._destroy()})}};a.extend(i.prototype,p);a.fn[c]=function(b){var d=Array.prototype.slice.call(arguments,1);return this.map(function(){var e=a(this),f=e.data(c);if(f&&p[b])return p[b].apply(f,d)||this;else if(!f&&(b===void 0||"object"===_typeof(b)))e.data(c,new i(e,b));return this})}}(jQuery,window,"sortable")});
define ("theme_coursemos/jquery.base64",["jquery"],function(){"use strict";jQuery.base64=function(){function a(a,b){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b));if(-1===c){throw"Cannot decode base64"}return c}function b(a,b){var c=a.charCodeAt(b);if(255<c){throw"INVALID_CHARACTER_ERR: DOM Exception 5"}return c}return{decode:function(b){var c=0,d,e,f=b.length,g=[];b=b+"";if(0===f){return b}if(0!=f%4){throw"Cannot decode base64"}if(b.charAt(f-1)==="="){c=1;if(b.charAt(f-2)==="="){c=2}f-=4}for(d=0;d<f;d+=4){e=a(b,d)<<18|a(b,d+1)<<12|a(b,d+2)<<6|a(b,d+3);g.push(String.fromCharCode(e>>16,255&e>>8,255&e))}switch(c){case 1:e=a(b,d)<<18|a(b,d+1)<<12|a(b,d+2)<<6;g.push(String.fromCharCode(e>>16,255&e>>8));break;case 2:e=a(b,d)<<18|a(b,d+1)<<12;g.push(String.fromCharCode(e>>16));break;}return g.join("")},encode:function(a){if(1!==arguments.length){throw"SyntaxError: exactly one argument required"}a=a+"";var c,d,e=[],f=a.length-a.length%3;if(0===a.length){return a}for(c=0;c<f;c+=3){d=b(a,c)<<16|b(a,c+1)<<8|b(a,c+2);e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>18));e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&d>>12));e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&d>>6));e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&d))}switch(a.length-f){case 1:d=b(a,c)<<16;e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>18)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&d>>12)+"="+"=");break;case 2:d=b(a,c)<<16|b(a,c+1)<<8;e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>18)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&d>>12)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&d>>6)+"=");break;}return e.join("")},VERSION:"1.0"}}(jQuery)});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a){var b=!1;if("function"==typeof define&&define.amd){define ("theme_coursemos/jquery.cookie",a);b=!0}if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))){module.exports=a();b=!0}if(!b){var c=window.Cookies,d=window.Cookies=a();d.noConflict=function(){window.Cookies=c;return d}}})(function(){function a(){var a=0,b={};for(;a<arguments.length;a++){var c=arguments[a];for(var d in c){b[d]=c[d]}}return b}function b(c){function d(b,e,f){var g;if("undefined"==typeof document){return}if(1<arguments.length){f=a({path:"/"},d.defaults,f);if("number"==typeof f.expires){var h=new Date;h.setMilliseconds(h.getMilliseconds()+864e5*f.expires);f.expires=h}f.expires=f.expires?f.expires.toUTCString():"";try{g=JSON.stringify(e);if(/^[\{\[]/.test(g)){e=g}}catch(a){}if(!c.write){e=encodeURIComponent(e+"").replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)}else{e=c.write(e,b)}b=encodeURIComponent(b+"");b=b.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent);b=b.replace(/[\(\)]/g,escape);var j="";for(var k in f){if(!f[k]){continue}j+="; "+k;if(!0===f[k]){continue}j+="="+f[k]}return document.cookie=b+"="+e+j}if(!b){g={}}var l=document.cookie?document.cookie.split("; "):[],m=/(%[0-9A-Z]{2})+/g,n=0;for(;n<l.length;n++){var o=l[n].split("="),p=o.slice(1).join("=");if(!this.json&&"\""===p.charAt(0)){p=p.slice(1,-1)}try{var q=o[0].replace(m,decodeURIComponent);p=c.read?c.read(p,q):c(p,q)||p.replace(m,decodeURIComponent);if(this.json){try{p=JSON.parse(p)}catch(a){}}if(b===q){g=p;break}if(!b){g[q]=p}}catch(a){}}return g}d.set=d;d.get=function(a){return d.call(d,a)};d.getJSON=function(){return d.apply({json:!0},[].slice.call(arguments))};d.defaults={};d.remove=function(b,c){d(b,"",a(c,{expires:-1}))};d.withConverter=b;return d}return b(function(){})});
(function(a){'use strict';if("function"==typeof define&&define.amd){define ("theme_coursemos/jquery.ellipsis",["jquery"],a)}else{a(jQuery)}})(function(a){'use strict';var c={lines:"auto",ellipClass:"ellip",responsive:!1};function b(b,d){var h=this,j=0,k=[],l,m,n,o,p,q,r,t;t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};h.$cont=a(b);h.opts=a.extend({},c,d);function e(){if("number"==typeof h.opts.lines&&2>h.opts.lines){h.$el.addClass(h.opts.ellipLineClass);return}q=h.$cont.height();if("auto"===h.opts.lines&&h.$el.prop("scrollHeight")<=q){return}if(!l){return}r=a.trim(g(h.text)).split(/\s+/);h.$el.html("<span style=\"white-space: nowrap;\">"+r.join("</span> <span style=\"white-space: nowrap;\">")+"</span>");h.$el.find("span").each(l);if(null!=m){f(m)}}function f(a){r[a]="<span class=\""+h.opts.ellipLineClass+"\">"+r[a];r.push("</span>");h.$el.html(r.join(" "))}function g(a){return(a+"").replace(/[&<>"'\/]/g,function(a){return t[a]})}if("auto"===h.opts.lines){var u=function(b,c){var d=a(c),e=d.position().top;p=p||d.height();if(e===o){k[j].push(d)}else{o=e;j+=1;k[j]=[d]}if(e+p>q){m=b-k[j-1].length;return!1}};l=u}if("number"==typeof h.opts.lines&&1<h.opts.lines){var v=function(b,c){var d=a(c),e=d.position().top;if(e!==o){o=e;j+=1}if(j===h.opts.lines){m=b;return!1}};l=v}if(h.opts.responsive){var w=function(){k=[];j=0;o=null;m=null;h.$el.html(g(h.text));clearTimeout(n);n=setTimeout(e,100)};a(window).on("resize.ellipsis",w)}(function(){h.text=h.$cont.text();h.opts.ellipLineClass=h.opts.ellipClass+"-line";h.$el=a("<span class=\""+h.opts.ellipClass+"\" />");h.$el.text(h.text);h.$cont.empty().append(h.$el);e()})()}a.fn.ellipsis=function(c){return this.each(function(){try{a(this).data("ellipsis",new b(this,c))}catch(a){if(window.console){console.error("ellipsis: "+a)}}})}});
define ("theme_coursemos/jquery.filedownload",["jquery"],function(){(function(a,b){var c={"<":"lt;",">":"gt;","&":"amp;","\r":"#13;","\n":"#10;",'"':"quot;","'":"#39;"};a.extend({fileDownload:function fileDownload(d,e){var j=a.extend({preparingMessageHtml:null,failMessageHtml:null,androidPostUnsupportedMessageHtml:"Unfortunately your Android browser doesn't support this type of file download. Please try again with a different browser.",dialogOptions:{modal:!0},prepareCallback:function prepareCallback(){},successCallback:function successCallback(){},abortCallback:function abortCallback(){},failCallback:function failCallback(){},httpMethod:"GET",data:null,checkInterval:100,cookieName:"fileDownload",cookieValue:"true",cookiePath:"/",cookieDomain:null,popupWindowTitle:"Initiating file download...",encodeHTMLEntities:!0},e),k=new a.Deferred,l=(navigator.userAgent||navigator.vendor||b.opera).toLowerCase(),m,n,o;if(/ip(ad|hone|od)/.test(l)){m=!0}else if(-1!==l.indexOf("android")){n=!0}else{o=/avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|playbook|silk|iemobile|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(l)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(l.substr(0,4))}var p=j.httpMethod.toUpperCase();if(n&&"GET"!==p&&j.androidPostUnsupportedMessageHtml){if(a().dialog){a("<div>").html(j.androidPostUnsupportedMessageHtml).dialog(j.dialogOptions)}else{alert(j.androidPostUnsupportedMessageHtml)}return k.reject()}var q=null,r={onPrepare:function onPrepare(b){if(j.preparingMessageHtml){q=a("<div>").html(j.preparingMessageHtml).dialog(j.dialogOptions)}else if(j.prepareCallback){j.prepareCallback(b)}},onSuccess:function onSuccess(a){if(q){q.dialog("close")}j.successCallback(a);k.resolve(a)},onAbort:function onAbort(a){if(q){q.dialog("close")}j.abortCallback(a);k.reject(a)},onFail:function onFail(b,c,d){if(q){q.dialog("close")}if(j.failMessageHtml){a("<div>").html(j.failMessageHtml).dialog(j.dialogOptions)}j.failCallback(b,c,d);k.reject(b,c)}};r.onPrepare(d);if(null!==j.data&&"string"!=typeof j.data){j.data=a.param(j.data)}var s,t,u,v;if("GET"===p){if(null!==j.data){var w=d.indexOf("?");if(-1!==w){if("&"!==d.substring(d.length-1)){d=d+"&"}}else{d=d+"?"}d=d+j.data}if(m||n){t=b.open(d);t.document.title=j.popupWindowTitle;b.focus()}else if(o){b.location(d)}else{s=a("<iframe>").hide().prop("src",d).appendTo("body")}}else{var x="";if(null!==j.data){a.each(j.data.replace(/\+/g," ").split("&"),function(){var a=this.split("="),b=a[0];a.shift();var c=a.join("=");a=[b,c];var d=j.encodeHTMLEntities?i(decodeURIComponent(a[0])):decodeURIComponent(a[0]);if(d){var e=j.encodeHTMLEntities?i(decodeURIComponent(a[1])):decodeURIComponent(a[1]);x+="<input type=\"hidden\" name=\""+d+"\" value=\""+e+"\" />"}})}if(o){v=a("<form>").appendTo("body");v.hide().prop("method",j.httpMethod).prop("action",d).html(x)}else{if(m){t=b.open("about:blank");t.document.title=j.popupWindowTitle;u=t.document;b.focus()}else{s=a("<iframe style='display: none' src='about:blank'></iframe>").appendTo("body");u=g(s)}u.write("<html><head></head><body><form method='"+j.httpMethod+"' action='"+d+"'>"+x+"</form>"+j.popupWindowTitle+"</body></html>");v=a(u).find("form")}v.submit()}setTimeout(f,j.checkInterval);function f(){var b=j.cookieValue;if("string"==typeof b){b=b.toLowerCase()}var c=j.cookieName.toLowerCase()+"="+b;if(-1<document.cookie.toLowerCase().indexOf(c)){r.onSuccess(d);var e=j.cookieName+"=; path="+j.cookiePath+"; expires="+new Date(0).toUTCString()+";";if(j.cookieDomain)e+=" domain="+j.cookieDomain+";";document.cookie=e;h(!1);return}if(t||s){try{var i=t?t.document:g(s);if(i&&null!==i.body&&i.body.innerHTML.length){var k=!0;if(v&&v.length){var l=a(i.body).contents().first();try{if(l.length&&l[0]===v[0]){k=!1}}catch(a){if(a&&-2146828218==a.number){k=!0}else{throw a}}}if(k){setTimeout(function(){r.onFail(i.body.innerHTML,d);h(!0)},100);return}}}catch(a){r.onFail("",d,a);h(!0);return}}setTimeout(f,j.checkInterval)}function g(a){var b=a[0].contentWindow||a[0].contentDocument;if(b.document){b=b.document}return b}function h(a){setTimeout(function(){if(t){if(n){t.close()}if(m){if(t.focus){t.focus();if(a){t.close()}}}}},0)}function i(a){return a.replace(/[<>&\r\n"']/gm,function(a){return"&"+c[a]})}var y=k.promise();y.abort=function(){h();s.attr("src","").html("");r.onAbort(d)};return y}})})(jQuery,this||window)});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(e){if("function"==typeof define&&define.amd){define ("theme_coursemos/jquery.mCustomScrollbar",["jquery"],e)}else if("undefined"!=typeof module&&module.exports){module.exports=e}else{e(jQuery,window,document)}})(function(a){(function(e){var t="function"==typeof define&&define.amd,o="undefined"!=typeof module&&module.exports,l="https:"==document.location.protocol?"https:":"http:";if(!t){if(o){require("theme_coursemos/jquery-mousewheel")(a)}else{a.event.special.mousewheel||a("head").append(decodeURI("%3Cscript src="+l+"//"+"cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js"+"%3E%3C/script%3E"))}}e()})(function(){var e={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,documentTouchScroll:!0,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:"auto",autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},t=0,o={},n=window.attachEvent&&!window.addEventListener?1:0,i=!1,r,s=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],c={init:function init(l){var l=a.extend(!0,{},e,l),n=m.call(this);if(l.live){var i=l.liveSelector||this.selector||".mCustomScrollbar",r=a(i);if("off"===l.live){p(i);return}o[i]=setTimeout(function(){r.mCustomScrollbar(l);if("once"===l.live&&r.length){p(i)}},500)}else{p(i)}l.setWidth=l.set_width?l.set_width:l.setWidth;l.setHeight=l.set_height?l.set_height:l.setHeight;l.axis=l.horizontalScroll?"x":f(l.axis);l.scrollInertia=0<l.scrollInertia&&17>l.scrollInertia?17:l.scrollInertia;if("object"!==_typeof(l.mouseWheel)&&!0==l.mouseWheel){l.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}}l.mouseWheel.scrollAmount=!l.mouseWheelPixels?l.mouseWheel.scrollAmount:l.mouseWheelPixels;l.mouseWheel.normalizeDelta=!l.advanced.normalizeMouseWheelDelta?l.mouseWheel.normalizeDelta:l.advanced.normalizeMouseWheelDelta;l.scrollButtons.scrollType=h(l.scrollButtons.scrollType);u(l);return a(n).each(function(){var e=a(this);if(!e.data("mCS")){e.data("mCS",{idx:++t,opt:l,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:e.css("direction"),cbOffsets:null,trigger:null,poll:{size:{o:0,n:0},img:{o:0,n:0},change:{o:0,n:0}}});var n=e.data("mCS"),i=n.opt,o=e.data("mcs-axis"),r=e.data("mcs-scrollbar-position"),d=e.data("mcs-theme");if(o){i.axis=o}if(r){i.scrollbarPosition=r}if(d){i.theme=d;u(i)}g.call(this);if(n&&i.callbacks.onCreate&&"function"==typeof i.callbacks.onCreate){i.callbacks.onCreate.call(this)}a("#mCSB_"+n.idx+"_container img:not(."+s[2]+")").addClass(s[2]);c.update.call(null,e)}})},update:function update(e,t){var o=e||m.call(this);return a(o).each(function(){var e=a(this);if(e.data("mCS")){var l=e.data("mCS"),n=l.opt,o=a("#mCSB_"+l.idx+"_container"),i=a("#mCSB_"+l.idx),r=[a("#mCSB_"+l.idx+"_dragger_vertical"),a("#mCSB_"+l.idx+"_dragger_horizontal")];if(!o.length){return}if(l.tweenRunning){V(e)}if(t&&l&&n.callbacks.onBeforeUpdate&&"function"==typeof n.callbacks.onBeforeUpdate){n.callbacks.onBeforeUpdate.call(this)}if(e.hasClass(s[3])){e.removeClass(s[3])}if(e.hasClass(s[4])){e.removeClass(s[4])}i.css("max-height","none");if(i.height()!==e.height()){i.css("max-height",e.height())}S.call(this);if("y"!==n.axis&&!n.advanced.autoExpandHorizontalScroll){o.css("width",x(o))}l.overflowed=w.call(this);k.call(this);if(n.autoDraggerLength){C.call(this)}b.call(this);B.call(this);var d=[Math.abs(o[0].offsetTop),Math.abs(o[0].offsetLeft)];if("x"!==n.axis){if(!l.overflowed[0]){y.call(this);if("y"===n.axis){T.call(this)}else if("yx"===n.axis&&l.overflowed[1]){K(e,d[1].toString(),{dir:"x",dur:0,overwrite:"none"})}}else if(r[0].height()>r[0].parent().height()){y.call(this)}else{K(e,d[0].toString(),{dir:"y",dur:0,overwrite:"none"});l.contentReset.y=null}}if("y"!==n.axis){if(!l.overflowed[1]){y.call(this);if("x"===n.axis){T.call(this)}else if("yx"===n.axis&&l.overflowed[0]){K(e,d[0].toString(),{dir:"y",dur:0,overwrite:"none"})}}else if(r[1].width()>r[1].parent().width()){y.call(this)}else{K(e,d[1].toString(),{dir:"x",dur:0,overwrite:"none"});l.contentReset.x=null}}if(t&&l){if(2===t&&n.callbacks.onImageLoad&&"function"==typeof n.callbacks.onImageLoad){n.callbacks.onImageLoad.call(this)}else if(3===t&&n.callbacks.onSelectorChange&&"function"==typeof n.callbacks.onSelectorChange){n.callbacks.onSelectorChange.call(this)}else if(n.callbacks.onUpdate&&"function"==typeof n.callbacks.onUpdate){n.callbacks.onUpdate.call(this)}}X.call(this)}})},scrollTo:function scrollTo(e,t){if("undefined"==typeof e||null==e){return}var o=m.call(this);return a(o).each(function(){var l=a(this);if(l.data("mCS")){var n=l.data("mCS"),i=n.opt,o={trigger:"external",scrollInertia:i.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},r=a.extend(!0,{},o,t),s=Y.call(this,e),d=0<r.scrollInertia&&17>r.scrollInertia?17:r.scrollInertia;s[0]=j.call(this,s[0],"y");s[1]=j.call(this,s[1],"x");if(r.moveDragger){s[0]*=n.scrollRatio.y;s[1]*=n.scrollRatio.x}r.dur=ae()?0:d;setTimeout(function(){if(null!==s[0]&&"undefined"!=typeof s[0]&&"x"!==i.axis&&n.overflowed[0]){r.dir="y";r.overwrite="all";K(l,s[0].toString(),r)}if(null!==s[1]&&"undefined"!=typeof s[1]&&"y"!==i.axis&&n.overflowed[1]){r.dir="x";r.overwrite="none";K(l,s[1].toString(),r)}},r.timeout)}})},stop:function stop(){var e=m.call(this);return a(e).each(function(){var e=a(this);if(e.data("mCS")){V(e)}})},disable:function disable(e){var t=m.call(this);return a(t).each(function(){var t=a(this);if(t.data("mCS")){t.data("mCS");X.call(this,"remove");T.call(this);if(e){y.call(this)}k.call(this,!0);t.addClass(s[3])}})},destroy:function destroy(){var e=m.call(this);return a(e).each(function(){var t=a(this);if(t.data("mCS")){var l=t.data("mCS"),n=l.opt,o=a("#mCSB_"+l.idx),i=a("#mCSB_"+l.idx+"_container"),r=a(".mCSB_"+l.idx+"_scrollbar");if(n.live){p(n.liveSelector||a(e).selector)}X.call(this,"remove");T.call(this);y.call(this);t.removeData("mCS");Z(this,"mcs");r.remove();i.find("img."+s[2]).removeClass(s[2]);o.replaceWith(i.contents());t.removeClass("mCustomScrollbar _mCS_"+l.idx+" "+s[6]+" "+s[7]+" "+s[5]+" "+s[3]).addClass(s[4])}})}},m=function(){return"object"!==_typeof(a(this))||1>a(this).length?".mCustomScrollbar":this},u=function(e){e.autoDraggerLength=-1<a.inArray(e.theme,["rounded","rounded-dark","rounded-dots","rounded-dots-dark"])?!1:e.autoDraggerLength;e.autoExpandScrollbar=-1<a.inArray(e.theme,["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"])?!1:e.autoExpandScrollbar;e.scrollButtons.enable=-1<a.inArray(e.theme,["minimal","minimal-dark"])?!1:e.scrollButtons.enable;e.autoHideScrollbar=-1<a.inArray(e.theme,["minimal","minimal-dark"])?!0:e.autoHideScrollbar;e.scrollbarPosition=-1<a.inArray(e.theme,["minimal","minimal-dark"])?"outside":e.scrollbarPosition},p=function(e){if(o[e]){clearTimeout(o[e]);Z(o,e)}},f=function(e){return"yx"===e||"xy"===e||"auto"===e?"yx":"x"===e||"horizontal"===e?"x":"y"},h=function(e){return"stepped"===e||"pixels"===e||"step"===e||"click"===e?"stepped":"stepless"},g=function(){var e=a(this),t=e.data("mCS"),l=t.opt,o=l.autoExpandScrollbar?" "+s[1]+"_expand":"",n=["<div id='mCSB_"+t.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+t.idx+"_scrollbar mCS-"+l.theme+" mCSB_scrollTools_vertical"+o+"'><div class='"+s[12]+"'><div id='mCSB_"+t.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar'></div></div><div class='mCSB_draggerRail'></div></div></div>","<div id='mCSB_"+t.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+t.idx+"_scrollbar mCS-"+l.theme+" mCSB_scrollTools_horizontal"+o+"'><div class='"+s[12]+"'><div id='mCSB_"+t.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar'></div></div><div class='mCSB_draggerRail'></div></div></div>"],i="yx"===l.axis?"mCSB_vertical_horizontal":"x"===l.axis?"mCSB_horizontal":"mCSB_vertical",r="yx"===l.axis?n[0]+n[1]:"x"===l.axis?n[1]:n[0],d="yx"===l.axis?"<div id='mCSB_"+t.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",c=l.autoHideScrollbar?" "+s[6]:"",m="x"!==l.axis&&"rtl"===t.langDir?" "+s[7]:"";if(l.setWidth){e.css("width",l.setWidth)}if(l.setHeight){e.css("height",l.setHeight)}l.setLeft="y"!==l.axis&&"rtl"===t.langDir?"989999px":l.setLeft;e.addClass("mCustomScrollbar _mCS_"+t.idx+c+m).wrapInner("<div id='mCSB_"+t.idx+"' class='mCustomScrollBox mCS-"+l.theme+" "+i+"'><div id='mCSB_"+t.idx+"_container' class='mCSB_container' style='position:relative; top:"+l.setTop+"; left:"+l.setLeft+";' dir='"+t.langDir+"' /></div>");var u=a("#mCSB_"+t.idx),p=a("#mCSB_"+t.idx+"_container");if("y"!==l.axis&&!l.advanced.autoExpandHorizontalScroll){p.css("width",x(p))}if("outside"===l.scrollbarPosition){if("static"===e.css("position")){e.css("position","relative")}e.css("overflow","visible");u.addClass("mCSB_outside").after(r)}else{u.addClass("mCSB_inside").append(r);p.wrap(d)}_.call(this);var f=[a("#mCSB_"+t.idx+"_dragger_vertical"),a("#mCSB_"+t.idx+"_dragger_horizontal")];f[0].css("min-height",f[0].height());f[1].css("min-width",f[1].width())},x=function(e){var t=[e[0].scrollWidth,Math.max.apply(Math,e.children().map(function(){return a(this).outerWidth(!0)}).get())],o=e.parent().width();return t[0]>o?t[0]:t[1]>o?t[1]:"100%"},S=function(){var e=a(this),t=e.data("mCS"),l=t.opt,o=a("#mCSB_"+t.idx+"_container");if(l.advanced.autoExpandHorizontalScroll&&"y"!==l.axis){o.css({width:"auto","min-width":0,"overflow-x":"scroll"});var n=Math.ceil(o[0].scrollWidth);if(3===l.advanced.autoExpandHorizontalScroll||2!==l.advanced.autoExpandHorizontalScroll&&n>o.parent().width()){o.css({width:n,"min-width":"100%","overflow-x":"inherit"})}else{o.css({"overflow-x":"inherit",position:"absolute"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(o[0].getBoundingClientRect().right+.4)-Math.floor(o[0].getBoundingClientRect().left),"min-width":"100%",position:"relative"}).unwrap()}}},_=function(){var e=a(this),t=e.data("mCS"),l=t.opt,o=a(".mCSB_"+t.idx+"_scrollbar:first"),n=!te(l.scrollButtons.tabindex)?"":"tabindex='"+l.scrollButtons.tabindex+"'",i=["<a href='#' class='"+s[13]+"' "+n+" />","<a href='#' class='"+s[14]+"' "+n+" />","<a href='#' class='"+s[15]+"' "+n+" />","<a href='#' class='"+s[16]+"' "+n+" />"],r=["x"===l.axis?i[2]:i[0],"x"===l.axis?i[3]:i[1],i[2],i[3]];if(l.scrollButtons.enable){o.prepend(r[0]).append(r[1]).next(".mCSB_scrollTools").prepend(r[2]).append(r[3])}},C=function(){var e=a(this),t=e.data("mCS"),o=a("#mCSB_"+t.idx),i=a("#mCSB_"+t.idx+"_container"),r=[a("#mCSB_"+t.idx+"_dragger_vertical"),a("#mCSB_"+t.idx+"_dragger_horizontal")],s=[o.height()/i.outerHeight(!1),o.width()/i.outerWidth(!1)],d=[parseInt(r[0].css("min-height")),Math.round(s[0]*r[0].parent().height()),parseInt(r[1].css("min-width")),Math.round(s[1]*r[1].parent().width())],l=n&&d[1]<d[0]?d[0]:d[1],c=n&&d[3]<d[2]?d[2]:d[3];r[0].css({height:l,"max-height":r[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":d[0]+"px"});r[1].css({width:c,"max-width":r[1].parent().width()-10})},b=function(){var e=a(this),t=e.data("mCS"),o=a("#mCSB_"+t.idx),l=a("#mCSB_"+t.idx+"_container"),n=[a("#mCSB_"+t.idx+"_dragger_vertical"),a("#mCSB_"+t.idx+"_dragger_horizontal")],i=[l.outerHeight(!1)-o.height(),l.outerWidth(!1)-o.width()],r=[i[0]/(n[0].parent().height()-n[0].height()),i[1]/(n[1].parent().width()-n[1].width())];t.scrollRatio={y:r[0],x:r[1]}},v=function(e,t,o){var a=o?s[0]+"_expanded":"",l=e.closest(".mCSB_scrollTools");if("active"===t){e.toggleClass(s[0]+" "+a);l.toggleClass(s[1]);e[0]._draggable=e[0]._draggable?0:1}else{if(!e[0]._draggable){if("hide"===t){e.removeClass(s[0]);l.removeClass(s[1])}else{e.addClass(s[0]);l.addClass(s[1])}}}},w=function(){var e=a(this),t=e.data("mCS"),o=a("#mCSB_"+t.idx),l=a("#mCSB_"+t.idx+"_container"),n=null==t.overflowed?l.height():l.outerHeight(!1),i=null==t.overflowed?l.width():l.outerWidth(!1),r=l[0].scrollHeight,s=l[0].scrollWidth;if(r>n){n=r}if(s>i){i=s}return[n>Math.round(o.height()),i>o.width()]},y=function(){var e=a(this),t=e.data("mCS"),l=t.opt,o=a("#mCSB_"+t.idx),n=a("#mCSB_"+t.idx+"_container"),i=[a("#mCSB_"+t.idx+"_dragger_vertical"),a("#mCSB_"+t.idx+"_dragger_horizontal")];V(e);if("x"!==l.axis&&!t.overflowed[0]||"y"===l.axis&&t.overflowed[0]){i[0].add(n).css("top",0);K(e,"_resetY")}if("y"!==l.axis&&!t.overflowed[1]||"x"===l.axis&&t.overflowed[1]){var r=dx=0;if("rtl"===t.langDir){r=o.width()-n.outerWidth(!1);dx=Math.abs(r/t.scrollRatio.x)}n.css("left",r);i[1].css("left",dx);K(e,"_resetX")}},B=function(){var e=a(this),t=e.data("mCS"),l=t.opt;if(!t.bindEvents){D.call(this);if(l.contentTouchScroll){E.call(this)}W.call(this);if(l.mouseWheel.enable){function t(){o=setTimeout(function(){if(!a.event.special.mousewheel){t()}else{clearTimeout(o);I.call(e[0])}},100)}var o;t()}P.call(this);M.call(this);if(l.advanced.autoScrollOnFocus){H.call(this)}if(l.scrollButtons.enable){U.call(this)}if(l.keyboard.enable){q.call(this)}t.bindEvents=!0}},T=function(){var e=a(this),t=e.data("mCS"),l=t.opt,o="mCS_"+t.idx,n=".mCSB_"+t.idx+"_scrollbar",i=a("#mCSB_"+t.idx+",#mCSB_"+t.idx+"_container,#mCSB_"+t.idx+"_container_wrapper,"+n+" ."+s[12]+",#mCSB_"+t.idx+"_dragger_vertical,#mCSB_"+t.idx+"_dragger_horizontal,"+n+">a"),r=a("#mCSB_"+t.idx+"_container");if(l.advanced.releaseDraggableSelectors){i.add(a(l.advanced.releaseDraggableSelectors))}if(l.advanced.extraDraggableSelectors){i.add(a(l.advanced.extraDraggableSelectors))}if(t.bindEvents){a(document).add(a(!L()||top.document)).unbind("."+o);i.each(function(){a(this).unbind("."+o)});clearTimeout(e[0]._focusTimeout);Z(e[0],"_focusTimeout");clearTimeout(t.sequential.step);Z(t.sequential,"step");clearTimeout(r[0].onCompleteTimeout);Z(r[0],"onCompleteTimeout");t.bindEvents=!1}},k=function(e){var t=a(this),l=t.data("mCS"),n=l.opt,o=a("#mCSB_"+l.idx+"_container_wrapper"),i=o.length?o:a("#mCSB_"+l.idx+"_container"),r=[a("#mCSB_"+l.idx+"_scrollbar_vertical"),a("#mCSB_"+l.idx+"_scrollbar_horizontal")],d=[r[0].find(".mCSB_dragger"),r[1].find(".mCSB_dragger")];if("x"!==n.axis){if(l.overflowed[0]&&!e){r[0].add(d[0]).add(r[0].children("a")).css("display","block");i.removeClass(s[8]+" "+s[10])}else{if(n.alwaysShowScrollbar){if(2!==n.alwaysShowScrollbar){d[0].css("display","none")}i.removeClass(s[10])}else{r[0].css("display","none");i.addClass(s[10])}i.addClass(s[8])}}if("y"!==n.axis){if(l.overflowed[1]&&!e){r[1].add(d[1]).add(r[1].children("a")).css("display","block");i.removeClass(s[9]+" "+s[11])}else{if(n.alwaysShowScrollbar){if(2!==n.alwaysShowScrollbar){d[1].css("display","none")}i.removeClass(s[11])}else{r[1].css("display","none");i.addClass(s[11])}i.addClass(s[9])}}if(!l.overflowed[0]&&!l.overflowed[1]){t.addClass(s[5])}else{t.removeClass(s[5])}},O=function(l){var e=l.type,t=l.target.ownerDocument!==document&&null!==frameElement?[a(frameElement).offset().top,a(frameElement).offset().left]:null,o=L()&&l.target.ownerDocument!==top.document&&null!==frameElement?[a(l.view.frameElement).offset().top,a(l.view.frameElement).offset().left]:[0,0];switch(e){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return t?[l.originalEvent.pageY-t[0]+o[0],l.originalEvent.pageX-t[1]+o[1],!1]:[l.originalEvent.pageY,l.originalEvent.pageX,!1];break;case"touchstart":case"touchmove":case"touchend":var n=l.originalEvent.touches[0]||l.originalEvent.changedTouches[0],i=l.originalEvent.touches.length||l.originalEvent.changedTouches.length;return l.target.ownerDocument!==document?[n.screenY,n.screenX,1<i]:[n.pageY,n.pageX,1<i];break;default:return t?[l.pageY-t[0]+o[0],l.pageX-t[1]+o[1],!1]:[l.pageY,l.pageX,!1];}},D=function(){var l=a(this),r=l.data("mCS"),s=r.opt,e="mCS_"+r.idx,o=["mCSB_"+r.idx+"_dragger_vertical","mCSB_"+r.idx+"_dragger_horizontal"],d=a("#mCSB_"+r.idx+"_container"),c=a("#"+o[0]+",#"+o[1]),m,u,p,f=s.advanced.releaseDraggableSelectors?c.add(a(s.advanced.releaseDraggableSelectors)):c,h=s.advanced.extraDraggableSelectors?a(!L()||top.document).add(a(s.advanced.extraDraggableSelectors)):a(!L()||top.document);c.bind("contextmenu."+e,function(t){t.preventDefault()}).bind("mousedown."+e+" touchstart."+e+" pointerdown."+e+" MSPointerDown."+e,function(t){t.stopImmediatePropagation();t.preventDefault();if(!$(t)){return}i=!0;if(n){document.onselectstart=function(){return!1}}A.call(d,!1);V(l);m=a(this);var e=m.offset(),o=O(t)[0]-e.top,r=O(t)[1]-e.left,c=m.height()+e.top,f=m.width()+e.left;if(o<c&&0<o&&r<f&&0<r){u=o;p=r}v(m,"active",s.autoExpandScrollbar)}).bind("touchmove."+e,function(o){o.stopImmediatePropagation();o.preventDefault();var e=m.offset(),a=O(o)[0]-e.top,l=O(o)[1]-e.left;t(u,p,a,l)});a(document).add(h).bind("mousemove."+e+" pointermove."+e+" MSPointerMove."+e,function(o){if(m){var e=m.offset(),a=O(o)[0]-e.top,l=O(o)[1]-e.left;if(u===a&&p===l){return}t(u,p,a,l)}}).add(f).bind("mouseup."+e+" touchend."+e+" pointerup."+e+" MSPointerUp."+e,function(){if(m){v(m,"active",s.autoExpandScrollbar);m=null}i=!1;if(n){document.onselectstart=null}A.call(d,!0)});function t(e,t,a,n){d[0].idleTimer=233>s.scrollInertia?250:0;if(m.attr("id")===o[1]){var i="x",c=(m[0].offsetLeft-t+n)*r.scrollRatio.x}else{var i="y",c=(m[0].offsetTop-e+a)*r.scrollRatio.y}K(l,c.toString(),{dir:i,drag:!0})}},E=function(){var m=a(this),u=m.data("mCS"),d=u.opt,o="mCS_"+u.idx,p=a("#mCSB_"+u.idx),f=a("#mCSB_"+u.idx+"_container"),h=[a("#mCSB_"+u.idx+"_dragger_vertical"),a("#mCSB_"+u.idx+"_dragger_horizontal")],g,S,_,C,b,v=[],w=[],B,T,k,D,E,W,I,R="yx"===d.axis?"none":"all",A=[],z,P,H=f.find("iframe"),M=["touchstart."+o+" pointerdown."+o+" MSPointerDown."+o,"touchmove."+o+" pointermove."+o+" MSPointerMove."+o,"touchend."+o+" pointerup."+o+" MSPointerUp."+o],U=document.body.style.touchAction!==void 0&&""!==document.body.style.touchAction;f.bind(M[0],function(o){t(o)}).bind(M[1],function(t){l(t)});p.bind(M[0],function(t){n(t)}).bind(M[2],function(t){s(t)});if(H.length){H.each(function(){a(this).bind("load",function(){if(L(this)){a(this.contentDocument||this.contentWindow.document).bind(M[0],function(o){t(o);n(o)}).bind(M[1],function(t){l(t)}).bind(M[2],function(t){s(t)})}})})}function t(t){if(!ee(t)||i||O(t)[2]){r=0;return}r=1;z=0;P=0;g=1;m.removeClass("mCS_touch_action");var e=f.offset();S=O(t)[0]-e.top;_=O(t)[1]-e.left;A=[O(t)[0],O(t)[1]]}function l(t){if(!ee(t)||i||O(t)[2]){return}if(!d.documentTouchScroll){t.preventDefault()}t.stopImmediatePropagation();if(P&&!z){return}if(g){T=J();var o=p.offset(),a=O(t)[0]-o.top,l=O(t)[1]-o.left;v.push(a);w.push(l);A[2]=Math.abs(O(t)[0]-A[0]);A[3]=Math.abs(O(t)[1]-A[1]);if(u.overflowed[0]){var n=h[0].parent().height()-h[0].height(),r=0<S-a&&a-S>-(n*u.scrollRatio.y)&&(2*A[3]<A[2]||"yx"===d.axis)}if(u.overflowed[1]){var s=h[1].parent().width()-h[1].width(),c=0<_-l&&l-_>-(s*u.scrollRatio.x)&&(2*A[2]<A[3]||"yx"===d.axis)}if(r||c){if(!U){t.preventDefault()}z=1}else{P=1;m.addClass("mCS_touch_action")}if(U){t.preventDefault()}W="yx"===d.axis?[S-a,_-l]:"x"===d.axis?[null,_-l]:[S-a,null];f[0].idleTimer=250;if(u.overflowed[0]){e(W[0],0,"mcsLinearOut","y","all",!0)}if(u.overflowed[1]){e(W[1],0,"mcsLinearOut","x",R,!0)}}}function n(t){if(!ee(t)||i||O(t)[2]){r=0;return}r=1;t.stopImmediatePropagation();V(m);B=J();var e=p.offset();C=O(t)[0]-e.top;b=O(t)[1]-e.left;v=[];w=[]}function s(t){if(!ee(t)||i||O(t)[2]){return}g=0;t.stopImmediatePropagation();z=0;P=0;k=J();var o=p.offset(),l=O(t)[0]-o.top,n=O(t)[1]-o.left;if(30<k-T){return}E=1e3/(k-B);var r=2.5>E,s=r?[v[v.length-2],w[w.length-2]]:[0,0];D=r?[l-s[0],n-s[1]]:[l-C,n-b];var m=[Math.abs(D[0]),Math.abs(D[1])];E=r?[Math.abs(D[0]/4),Math.abs(D[1]/4)]:[E,E];var h=[Math.abs(f[0].offsetTop)-D[0]*c(m[0]/E[0],E[0]),Math.abs(f[0].offsetLeft)-D[1]*c(m[1]/E[1],E[1])];W="yx"===d.axis?[h[0],h[1]]:"x"===d.axis?[null,h[1]]:[h[0],null];I=[4*m[0]+d.scrollInertia,4*m[1]+d.scrollInertia];var a=parseInt(d.contentTouchScroll)||0;W[0]=m[0]>a?W[0]:0;W[1]=m[1]>a?W[1]:0;if(u.overflowed[0]){e(W[0],I[0],"mcsEaseOut","y",R,!1)}if(u.overflowed[1]){e(W[1],I[1],"mcsEaseOut","x",R,!1)}}function c(e,t){var o=[1.5*t,2*t,t/1.5,t/2];if(90<e){return 4<t?o[0]:o[3]}else if(60<e){return 3<t?o[3]:o[2]}else if(30<e){return 8<t?o[1]:6<t?o[0]:4<t?t:o[2]}else{return 8<t?t:o[3]}}function e(e,t,o,a,l,n){if(!e){return}K(m,e.toString(),{dur:t,scrollEasing:o,dir:a,overwrite:l,drag:n})}},W=function(){var n=a(this),s=n.data("mCS"),e=s.opt,o=s.sequential,d="mCS_"+s.idx,c=a("#mCSB_"+s.idx+"_container"),m=c.parent(),u;c.bind("mousedown."+d,function(){if(r){return}if(!u){u=1;i=!0}}).add(document).bind("mousemove."+d,function(a){if(!r&&u&&t()){var n=c.offset(),i=O(a)[0]-n.top+c[0].offsetTop,d=O(a)[1]-n.left+c[0].offsetLeft;if(0<i&&i<m.height()&&0<d&&d<m.width()){if(o.step){l("off",null,"stepped")}}else{if("x"!==e.axis&&s.overflowed[0]){if(0>i){l("on",38)}else if(i>m.height()){l("on",40)}}if("y"!==e.axis&&s.overflowed[1]){if(0>d){l("on",37)}else if(d>m.width()){l("on",39)}}}}}).bind("mouseup."+d+" dragend."+d,function(){if(r){return}if(u){u=0;l("off",null)}i=!1});function t(){return window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type?document.selection.createRange().text:0}function l(e,t,a){o.type=a&&u?"stepped":"stepless";o.scrollAmount=10;F(n,e,t,"mcsLinearOut",a?60:null)}},I=function(){if(!a(this).data("mCS")){return}var l=a(this),i=l.data("mCS"),r=i.opt,e="mCS_"+i.idx,o=a("#mCSB_"+i.idx),s=[a("#mCSB_"+i.idx+"_dragger_vertical"),a("#mCSB_"+i.idx+"_dragger_horizontal")],d=a("#mCSB_"+i.idx+"_container").find("iframe");if(d.length){d.each(function(){a(this).bind("load",function(){if(L(this)){a(this.contentDocument||this.contentWindow.document).bind("mousewheel."+e,function(o,e){t(o,e)})}})})}o.bind("mousewheel."+e,function(o,e){t(o,e)});function t(t,e){V(l);if(z(l,t.target)){return}var d="auto"!==r.mouseWheel.deltaFactor?parseInt(r.mouseWheel.deltaFactor):n&&100>t.deltaFactor?100:t.deltaFactor||100,c=r.scrollInertia;if("x"===r.axis||"x"===r.mouseWheel.axis){var m="x",u=[Math.round(d*i.scrollRatio.x),parseInt(r.mouseWheel.scrollAmount)],p="auto"!==r.mouseWheel.scrollAmount?u[1]:u[0]>=o.width()?.9*o.width():u[0],f=Math.abs(a("#mCSB_"+i.idx+"_container")[0].offsetLeft),h=s[1][0].offsetLeft,g=s[1].parent().width()-s[1].width(),x="y"===r.mouseWheel.axis?t.deltaY||e:t.deltaX}else{var m="y",u=[Math.round(d*i.scrollRatio.y),parseInt(r.mouseWheel.scrollAmount)],p="auto"!==r.mouseWheel.scrollAmount?u[1]:u[0]>=o.height()?.9*o.height():u[0],f=Math.abs(a("#mCSB_"+i.idx+"_container")[0].offsetTop),h=s[0][0].offsetTop,g=s[0].parent().height()-s[0].height(),x=t.deltaY||e}if("y"===m&&!i.overflowed[0]||"x"===m&&!i.overflowed[1]){return}if(r.mouseWheel.invert||t.webkitDirectionInvertedFromDevice){x=-x}if(r.mouseWheel.normalizeDelta){x=0>x?-1:1}if(0<x&&0!==h||0>x&&h!==g||r.mouseWheel.preventDefault){t.stopImmediatePropagation();t.preventDefault()}if(5>t.deltaFactor&&!r.mouseWheel.normalizeDelta){p=t.deltaFactor;c=17}K(l,(f-x*p).toString(),{dir:m,dur:c})}},R={},L=function(e){var t=!1,o=!1,l=null;if(e===void 0){o="#empty"}else if(a(e).attr("id")!==void 0){o=a(e).attr("id")}if(!1!==o&&R[o]!==void 0){return R[o]}if(!e){try{var n=top.document;l=n.body.innerHTML}catch(e){}t=null!==l}else{try{var n=e.contentDocument||e.contentWindow.document;l=n.body.innerHTML}catch(e){}t=null!==l}if(!1!==o){R[o]=t}return t},A=function(e){var t=this.find("iframe");if(!t.length){return}var o=!e?"none":"auto";t.css("pointer-events",o)},z=function(e,t){var o=t.nodeName.toLowerCase(),l=e.data("mCS").opt.mouseWheel.disableOver;return-1<a.inArray(o,l)&&!(-1<a.inArray(o,["select","textarea"])&&!a(t).is(":focus"))},P=function(){var t=a(this),o=t.data("mCS"),e="mCS_"+o.idx,l=a("#mCSB_"+o.idx+"_container"),n=l.parent(),r=a(".mCSB_"+o.idx+"_scrollbar ."+s[12]),d;r.bind("mousedown."+e+" touchstart."+e+" pointerdown."+e+" MSPointerDown."+e,function(t){i=!0;if(!a(t.target).hasClass("mCSB_dragger")){d=1}}).bind("touchend."+e+" pointerup."+e+" MSPointerUp."+e,function(){i=!1}).bind("click."+e,function(i){if(!d){return}d=0;if(a(i.target).hasClass(s[12])||a(i.target).hasClass("mCSB_draggerRail")){V(t);var e=a(this),r=e.find(".mCSB_dragger");if(0<e.parent(".mCSB_scrollTools_horizontal").length){if(!o.overflowed[1]){return}var c="x",m=i.pageX>r.offset().left?-1:1,u=Math.abs(l[0].offsetLeft)-m*(.9*n.width())}else{if(!o.overflowed[0]){return}var c="y",m=i.pageY>r.offset().top?-1:1,u=Math.abs(l[0].offsetTop)-m*(.9*n.height())}K(t,u.toString(),{dir:c,scrollEasing:"mcsEaseInOut"})}})},H=function(){var e=a(this),t=e.data("mCS"),l=t.opt,o="mCS_"+t.idx,n=a("#mCSB_"+t.idx+"_container"),i=n.parent();n.bind("focusin."+o,function(){var t=a(document.activeElement),o=n.find(".mCustomScrollBox").length;if(!t.is(l.advanced.autoScrollOnFocus)){return}V(e);clearTimeout(e[0]._focusTimeout);e[0]._focusTimer=o?17*o:0;e[0]._focusTimeout=setTimeout(function(){var o=[oe(t)[0],oe(t)[1]],a=[n[0].offsetTop,n[0].offsetLeft],r=[0<=a[0]+o[0]&&a[0]+o[0]<i.height()-t.outerHeight(!1),0<=a[1]+o[1]&&a[0]+o[1]<i.width()-t.outerWidth(!1)],s="yx"===l.axis&&!r[0]&&!r[1]?"none":"all";if("x"!==l.axis&&!r[0]){K(e,o[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:s,dur:0})}if("y"!==l.axis&&!r[1]){K(e,o[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:s,dur:0})}},e[0]._focusTimer)})},M=function(){var e=a(this),t=e.data("mCS"),o="mCS_"+t.idx,l=a("#mCSB_"+t.idx+"_container").parent();l.bind("scroll."+o,function(){if(0!==l.scrollTop()||0!==l.scrollLeft()){a(".mCSB_"+t.idx+"_scrollbar").css("visibility","hidden")}})},U=function(){var e=a(this),t=e.data("mCS"),l=t.opt,o=t.sequential,n="mCS_"+t.idx,r=".mCSB_"+t.idx+"_scrollbar",s=a(r+">a");s.bind("contextmenu."+n,function(t){t.preventDefault()}).bind("mousedown."+n+" touchstart."+n+" pointerdown."+n+" MSPointerDown."+n+" mouseup."+n+" touchend."+n+" pointerup."+n+" MSPointerUp."+n+" mouseout."+n+" pointerout."+n+" MSPointerOut."+n+" click."+n,function(n){n.preventDefault();if(!$(n)){return}var s=a(this).attr("class");o.type=l.scrollButtons.scrollType;switch(n.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===o.type){return}i=!0;t.tweenRunning=!1;r("on",s);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===o.type){return}i=!1;if(o.dir){r("off",s)}break;case"click":if("stepped"!==o.type||t.tweenRunning){return}r("on",s);break;}function r(t,a){o.scrollAmount=l.scrollButtons.scrollAmount;F(e,t,a)}})},q=function(){var l=a(this),n=l.data("mCS"),i=n.opt,o=n.sequential,r="mCS_"+n.idx,s=a("#mCSB_"+n.idx),d=a("#mCSB_"+n.idx+"_container"),c=d.parent(),m=d.find("iframe"),u=["blur."+r+" keydown."+r+" keyup."+r];if(m.length){m.each(function(){a(this).bind("load",function(){if(L(this)){a(this.contentDocument||this.contentWindow.document).bind(u[0],function(o){t(o)})}})})}s.attr("tabindex","0").bind(u[0],function(o){t(o)});function t(t){switch(t.type){case"blur":if(n.tweenRunning&&o.dir){e("off",null)}break;case"keydown":case"keyup":var r=t.keyCode?t.keyCode:t.which,s="on";if("x"!==i.axis&&(38===r||40===r)||"y"!==i.axis&&(37===r||39===r)){if((38===r||40===r)&&!n.overflowed[0]||(37===r||39===r)&&!n.overflowed[1]){return}if("keyup"===t.type){s="off"}if(!a(document.activeElement).is("input,textarea,select,datalist,keygen,[contenteditable='true']")){t.preventDefault();t.stopImmediatePropagation();e(s,r)}}else if(33===r||34===r){if(n.overflowed[0]||n.overflowed[1]){t.preventDefault();t.stopImmediatePropagation()}if("keyup"===t.type){V(l);var m=34===r?-1:1;if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0]){var u="x",p=Math.abs(d[0].offsetLeft)-m*(.9*c.width())}else{var u="y",p=Math.abs(d[0].offsetTop)-m*(.9*c.height())}K(l,p.toString(),{dir:u,scrollEasing:"mcsEaseInOut"})}}else if(35===r||36===r){if(!a(document.activeElement).is("input,textarea,select,datalist,keygen,[contenteditable='true']")){if(n.overflowed[0]||n.overflowed[1]){t.preventDefault();t.stopImmediatePropagation()}if("keyup"===t.type){if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0]){var u="x",p=35===r?Math.abs(c.width()-d.outerWidth(!1)):0}else{var u="y",p=35===r?Math.abs(c.height()-d.outerHeight(!1)):0}K(l,p.toString(),{dir:u,scrollEasing:"mcsEaseInOut"})}}}break;}function e(e,t){o.type=i.keyboard.scrollType;o.scrollAmount=i.keyboard.scrollAmount;if("stepped"===o.type&&n.tweenRunning){return}F(l,e,t)}}},F=function(l,t,n,i,e){var u=l.data("mCS"),d=u.opt,o=u.sequential,p=a("#mCSB_"+u.idx+"_container"),f="stepped"===o.type?!0:!1,h=26>d.scrollInertia?26:d.scrollInertia,g=1>d.scrollInertia?17:d.scrollInertia;switch(t){case"on":o.dir=[n===s[16]||n===s[15]||39===n||37===n?"x":"y",n===s[13]||n===s[15]||38===n||37===n?-1:1];V(l);if(te(n)&&"stepped"===o.type){return}r(f);break;case"off":c();if(f||u.tweenRunning&&o.dir){r(!0)}break;}function r(a){if(d.snapAmount){o.scrollAmount=!(d.snapAmount instanceof Array)?d.snapAmount:"x"===o.dir[0]?d.snapAmount[1]:d.snapAmount[0]}var n="stepped"!==o.type,s=e?e:!a?1e3/60:n?h/1.5:g,t=!a?2.5:n?7.5:40,c=[Math.abs(p[0].offsetTop),Math.abs(p[0].offsetLeft)],m=[10<u.scrollRatio.y?10:u.scrollRatio.y,10<u.scrollRatio.x?10:u.scrollRatio.x],f="x"===o.dir[0]?c[1]+o.dir[1]*(m[1]*t):c[0]+o.dir[1]*(m[0]*t),x="x"===o.dir[0]?c[1]+o.dir[1]*parseInt(o.scrollAmount):c[0]+o.dir[1]*parseInt(o.scrollAmount),S="auto"!==o.scrollAmount?x:f,_=i?i:!a?"mcsLinear":n?"mcsLinearOut":"mcsEaseInOut",C=!a?!1:!0;if(a&&17>s){S="x"===o.dir[0]?c[1]:c[0]}K(l,S.toString(),{dir:o.dir[0],scrollEasing:_,dur:s,onComplete:C});if(a){o.dir=!1;return}clearTimeout(o.step);o.step=setTimeout(function(){r()},s)}function c(){clearTimeout(o.step);Z(o,"step");V(l)}},Y=function(e){var t=a(this).data("mCS").opt,o=[];if("function"==typeof e){e=e()}if(!(e instanceof Array)){o[0]=e.y?e.y:e.x||"x"===t.axis?null:e;o[1]=e.x?e.x:e.y||"y"===t.axis?null:e}else{o=1<e.length?[e[0],e[1]]:"x"===t.axis?[null,e[0]]:[e[0],null]}if("function"==typeof o[0]){o[0]=o[0]()}if("function"==typeof o[1]){o[1]=o[1]()}return o},j=function(e,l){if(null==e||"undefined"==typeof e){return}var n=a(this),i=n.data("mCS"),r=i.opt,o=a("#mCSB_"+i.idx+"_container"),s=o.parent(),d=_typeof(e);if(!l){l="x"===r.axis?"x":"y"}var t="x"===l?o.outerWidth(!1)-s.width():o.outerHeight(!1)-s.height(),m="x"===l?o[0].offsetLeft:o[0].offsetTop,u="x"===l?"left":"top";switch(d){case"function":return e();break;case"object":var f=e.jquery?e:a(e);if(!f.length){return}return"x"===l?oe(f)[1]:oe(f)[0];break;case"string":case"number":if(te(e)){return Math.abs(e)}else if(-1!==e.indexOf("%")){return Math.abs(t*parseInt(e)/100)}else if(-1!==e.indexOf("-=")){return Math.abs(m-parseInt(e.split("-=")[1]))}else if(-1!==e.indexOf("+=")){var h=m+parseInt(e.split("+=")[1]);return 0<=h?0:Math.abs(h)}else if(-1!==e.indexOf("px")&&te(e.split("px")[0])){return Math.abs(e.split("px")[0])}else{if("top"===e||"left"===e){return 0}else if("bottom"===e){return Math.abs(s.height()-o.outerHeight(!1))}else if("right"===e){return Math.abs(s.width()-o.outerWidth(!1))}else if("first"===e||"last"===e){var f=o.find(":"+e);return"x"===l?oe(f)[1]:oe(f)[0]}else{if(a(e).length){return"x"===l?oe(a(e))[1]:oe(a(e))[0]}else{o.css(u,e);c.update.call(null,n[0]);return}}}break;}},X=function(e){var r=a(this),m=r.data("mCS"),d=m.opt,o=a("#mCSB_"+m.idx+"_container");if(e){clearTimeout(o[0].autoUpdate);Z(o[0],"autoUpdate");return}t();function t(){clearTimeout(o[0].autoUpdate);if(0===r.parents("html").length){r=null;return}o[0].autoUpdate=setTimeout(function(){if(d.advanced.updateOnSelectorChange){m.poll.change.n=n();if(m.poll.change.n!==m.poll.change.o){m.poll.change.o=m.poll.change.n;i(3);return}}if(d.advanced.updateOnContentResize){m.poll.size.n=r[0].scrollHeight+r[0].scrollWidth+o[0].offsetHeight+r[0].offsetHeight+r[0].offsetWidth;if(m.poll.size.n!==m.poll.size.o){m.poll.size.o=m.poll.size.n;i(1);return}}if(d.advanced.updateOnImageLoad){if(!("auto"===d.advanced.updateOnImageLoad&&"y"===d.axis)){m.poll.img.n=o.find("img").length;if(m.poll.img.n!==m.poll.img.o){m.poll.img.o=m.poll.img.n;o.find("img").each(function(){l(this)});return}}}if(d.advanced.updateOnSelectorChange||d.advanced.updateOnContentResize||d.advanced.updateOnImageLoad){t()}},d.advanced.autoUpdateTimeout)}function l(e){if(a(e).hasClass(s[2])){i();return}var t=new Image;t.onload=function(e,t){return function(){return t.apply(e,arguments)}}(t,function(){this.onload=null;a(e).addClass(s[2]);i(2)});t.src=e.src}function n(){if(!0===d.advanced.updateOnSelectorChange){d.advanced.updateOnSelectorChange="*"}var e=0,t=o.find(d.advanced.updateOnSelectorChange);if(d.advanced.updateOnSelectorChange&&0<t.length){t.each(function(){e+=this.offsetHeight+this.offsetWidth})}return e}function i(e){clearTimeout(o[0].autoUpdate);c.update.call(null,r[0],e)}},N=function(e,t,o){return Math.round(e/t)*t-o},V=function(e){var t=e.data("mCS"),o=a("#mCSB_"+t.idx+"_container,#mCSB_"+t.idx+"_container_wrapper,#mCSB_"+t.idx+"_dragger_vertical,#mCSB_"+t.idx+"_dragger_horizontal");o.each(function(){Q.call(this)})},K=function(e,t,l){var s=e.data("mCS"),d=s.opt,o={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:d.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},l=a.extend(o,l),c=[l.dur,l.drag?0:l.dur],m=a("#mCSB_"+s.idx),u=a("#mCSB_"+s.idx+"_container"),p=u.parent(),f=d.callbacks.onTotalScrollOffset?Y.call(e,d.callbacks.onTotalScrollOffset):[0,0],h=d.callbacks.onTotalScrollBackOffset?Y.call(e,d.callbacks.onTotalScrollBackOffset):[0,0];s.trigger=l.trigger;if(0!==p.scrollTop()||0!==p.scrollLeft()){a(".mCSB_"+s.idx+"_scrollbar").css("visibility","visible");p.scrollTop(0).scrollLeft(0)}if("_resetY"===t&&!s.contentReset.y){if(n("onOverflowYNone")){d.callbacks.onOverflowYNone.call(e[0])}s.contentReset.y=1}if("_resetX"===t&&!s.contentReset.x){if(n("onOverflowXNone")){d.callbacks.onOverflowXNone.call(e[0])}s.contentReset.x=1}if("_resetY"===t||"_resetX"===t){return}if((s.contentReset.y||!e[0].mcs)&&s.overflowed[0]){if(n("onOverflowY")){d.callbacks.onOverflowY.call(e[0])}s.contentReset.x=null}if((s.contentReset.x||!e[0].mcs)&&s.overflowed[1]){if(n("onOverflowX")){d.callbacks.onOverflowX.call(e[0])}s.contentReset.x=null}if(d.snapAmount){var g=!(d.snapAmount instanceof Array)?d.snapAmount:"x"===l.dir?d.snapAmount[1]:d.snapAmount[0];t=N(t,g,d.snapOffset)}switch(l.dir){case"x":var x=a("#mCSB_"+s.idx+"_dragger_horizontal"),S="left",_=u[0].offsetLeft,C=[m.width()-u.outerWidth(!1),x.parent().width()-x.width()],b=[t,0===t?0:t/s.scrollRatio.x],w=f[1],y=h[1],B=0<w?w/s.scrollRatio.x:0,T=0<y?y/s.scrollRatio.x:0;break;case"y":var x=a("#mCSB_"+s.idx+"_dragger_vertical"),S="top",_=u[0].offsetTop,C=[m.height()-u.outerHeight(!1),x.parent().height()-x.height()],b=[t,0===t?0:t/s.scrollRatio.y],w=f[0],y=h[0],B=0<w?w/s.scrollRatio.y:0,T=0<y?y/s.scrollRatio.y:0;break;}if(0>b[1]||0===b[0]&&0===b[1]){b=[0,0]}else if(b[1]>=C[1]){b=[C[0],C[1]]}else{b[0]=-b[0]}if(!e[0].mcs){r();if(n("onInit")){d.callbacks.onInit.call(e[0])}}clearTimeout(u[0].onCompleteTimeout);G(x[0],S,Math.round(b[1]),c[1],l.scrollEasing);if(!s.tweenRunning&&(0===_&&0<=b[0]||_===C[0]&&b[0]<=C[0])){return}G(u[0],S,Math.round(b[0]),c[0],l.scrollEasing,l.overwrite,{onStart:function onStart(){if(l.callbacks&&l.onStart&&!s.tweenRunning){if(n("onScrollStart")){r();d.callbacks.onScrollStart.call(e[0])}s.tweenRunning=!0;v(x);s.cbOffsets=i()}},onUpdate:function onUpdate(){if(l.callbacks&&l.onUpdate){if(n("whileScrolling")){r();d.callbacks.whileScrolling.call(e[0])}}},onComplete:function onComplete(){if(l.callbacks&&l.onComplete){if("yx"===d.axis){clearTimeout(u[0].onCompleteTimeout)}var o=u[0].idleTimer||0;u[0].onCompleteTimeout=setTimeout(function(){if(n("onScroll")){r();d.callbacks.onScroll.call(e[0])}if(n("onTotalScroll")&&b[1]>=C[1]-B&&s.cbOffsets[0]){r();d.callbacks.onTotalScroll.call(e[0])}if(n("onTotalScrollBack")&&b[1]<=T&&s.cbOffsets[1]){r();d.callbacks.onTotalScrollBack.call(e[0])}s.tweenRunning=!1;u[0].idleTimer=0;v(x,"hide")},o)}}});function n(e){return s&&d.callbacks[e]&&"function"==typeof d.callbacks[e]}function i(){return[d.callbacks.alwaysTriggerOffsets||_>=C[0]+w,d.callbacks.alwaysTriggerOffsets||_<=-y]}function r(){var t=[u[0].offsetTop,u[0].offsetLeft],o=[x[0].offsetTop,x[0].offsetLeft],a=[u.outerHeight(!1),u.outerWidth(!1)],n=[m.height(),m.width()];e[0].mcs={content:u,top:t[0],left:t[1],draggerTop:o[0],draggerLeft:o[1],topPct:Math.round(100*Math.abs(t[0])/(Math.abs(a[0])-n[0])),leftPct:Math.round(100*Math.abs(t[1])/(Math.abs(a[1])-n[1])),direction:l.dir}}},G=function(e,t,o,a,l,n,i){if(!e._mTween){e._mTween={top:{},left:{}}}var i=i||{},u=i.onStart||function(){},p=i.onUpdate||function(){},f=i.onComplete||function(){},h=J(),g,x=0,S=e.offsetTop,_=e.style,C,b=e._mTween[t];if("left"===t){S=e.offsetLeft}var v=o-S;b.stop=0;if("none"!==n){c()}d();function r(){if(b.stop){return}if(!x){u.call()}x=J()-h;s();if(x>=b.time){b.time=x>b.time?x+g-(x-b.time):x+g-1;if(b.time<x+1){b.time=x+1}}if(b.time<a){b.id=C(r)}else{f.call()}}function s(){if(0<a){b.currVal=m(b.time,S,v,a,l);_[t]=Math.round(b.currVal)+"px"}else{_[t]=o+"px"}p.call()}function d(){g=1e3/60;b.time=x+g;C=!window.requestAnimationFrame?function(e){s();return setTimeout(e,.01)}:window.requestAnimationFrame;b.id=C(r)}function c(){if(null==b.id){return}if(!window.requestAnimationFrame){clearTimeout(b.id)}else{window.cancelAnimationFrame(b.id)}b.id=null}function m(e,o,a,l,n){switch(n){case"linear":case"mcsLinear":return a*e/l+o;break;case"mcsLinearOut":e/=l;e--;return a*Math.sqrt(1-e*e)+o;break;case"easeInOutSmooth":e/=l/2;if(1>e)return a/2*e*e+o;e--;return-a/2*(e*(e-2)-1)+o;break;case"easeInOutStrong":e/=l/2;if(1>e)return a/2*Math.pow(2,10*(e-1))+o;e--;return a/2*(-Math.pow(2,-10*e)+2)+o;break;case"easeInOut":case"mcsEaseInOut":e/=l/2;if(1>e)return a/2*e*e*e+o;e-=2;return a/2*(e*e*e+2)+o;break;case"easeOutSmooth":e/=l;e--;return-a*(e*e*e*e-1)+o;break;case"easeOutStrong":return a*(-Math.pow(2,-10*e/l)+1)+o;break;case"easeOut":case"mcsEaseOut":default:var i=(e/=l)*e,r=i*e;return o+a*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e);}}},J=function(){if(window.performance&&window.performance.now){return window.performance.now()}else{if(window.performance&&window.performance.webkitNow){return window.performance.webkitNow()}else{if(Date.now){return Date.now()}else{return new Date().getTime()}}}},Q=function(){var e=this;if(!e._mTween){e._mTween={top:{},left:{}}}for(var t=["top","left"],o=0,a;o<t.length;o++){a=t[o];if(e._mTween[a].id){if(!window.requestAnimationFrame){clearTimeout(e._mTween[a].id)}else{window.cancelAnimationFrame(e._mTween[a].id)}e._mTween[a].id=null;e._mTween[a].stop=1}}},Z=function(t,o){try{delete t[o]}catch(a){t[o]=null}},$=function(t){return!(t.which&&1!==t.which)},ee=function(o){var e=o.originalEvent.pointerType;return!(e&&"touch"!==e&&2!==e)},te=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},oe=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]},ae=function(){var t=e();if(!t)return!1;return document[t];function e(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++){if(e[t]+"Hidden"in document)return e[t]+"Hidden"}return null}};a.fn.mCustomScrollbar=function(e){if(c[e]){return c[e].apply(this,Array.prototype.slice.call(arguments,1))}else if("object"===_typeof(e)||!e){return c.init.apply(this,arguments)}else{a.error("Method "+e+" does not exist")}};a.mCustomScrollbar=function(e){if(c[e]){return c[e].apply(this,Array.prototype.slice.call(arguments,1))}else if("object"===_typeof(e)||!e){return c.init.apply(this,arguments)}else{a.error("Method "+e+" does not exist")}};a.mCustomScrollbar.defaults=e;window.mCustomScrollbar=!0;a(window).bind("load",function(){a(".mCustomScrollbar").mCustomScrollbar();a.extend(a.expr[":"],{mcsInView:a.expr[":"].mcsInView||function(e){var t=a(e),o=t.parents(".mCSB_container"),l,n;if(!o.length){return}l=o.parent();n=[o[0].offsetTop,o[0].offsetLeft];return 0<=n[0]+oe(t)[0]&&n[0]+oe(t)[0]<l.height()-t.outerHeight(!1)&&0<=n[1]+oe(t)[1]&&n[1]+oe(t)[1]<l.width()-t.outerWidth(!1)},mcsInSight:a.expr[":"].mcsInSight||function(e,t,o){var l=a(e),n,i=l.parents(".mCSB_container"),r,s,d,c="exact"===o[3]?[[1,0],[1,0]]:[[.9,.1],[.6,.4]];if(!i.length){return}n=[l.outerHeight(!1),l.outerWidth(!1)];s=[i[0].offsetTop+oe(l)[0],i[0].offsetLeft+oe(l)[1]];r=[i.parent()[0].offsetHeight,i.parent()[0].offsetWidth];d=[n[0]<r[0]?c[0]:c[1],n[1]<r[1]?c[0]:c[1]];return 0>s[0]-r[0]*d[0][0]&&0<=s[0]+n[0]-r[0]*d[0][1]&&0>s[1]-r[1]*d[1][0]&&0<=s[1]+n[1]-r[1]*d[1][1]},mcsOverflow:a.expr[":"].mcsOverflow||function(e){var t=a(e).data("mCS");if(!t){return}return t.overflowed[0]||t.overflowed[1]}})})})});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a){if("function"==typeof define&&define.amd){define ("theme_coursemos/jquery.mousewheel",["jquery"],a)}else if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))){module.exports=a}else{a(jQuery)}})(function(a){var e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],f="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],g=Array.prototype.slice,h,j;if(a.event.fixHooks){for(var k=e.length;k;){a.event.fixHooks[e[--k]]=a.event.mouseHooks}}var l=a.event.special.mousewheel={version:"3.1.12",setup:function setup(){if(this.addEventListener){for(var c=f.length;c;){this.addEventListener(f[--c],b,!1)}}else{this.onmousewheel=b}a.data(this,"mousewheel-line-height",l.getLineHeight(this));a.data(this,"mousewheel-page-height",l.getPageHeight(this))},teardown:function teardown(){if(this.removeEventListener){for(var c=f.length;c;){this.removeEventListener(f[--c],b,!1)}}else{this.onmousewheel=null}a.removeData(this,"mousewheel-line-height");a.removeData(this,"mousewheel-page-height")},getLineHeight:function getLineHeight(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();if(!d.length){d=a("body")}return parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function getPageHeight(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function mousewheel(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function unmousewheel(a){return this.unbind("mousewheel",a)}});function b(b){var e=b||window.event,f=g.call(arguments,1),i=0,k=0,m=0,n=0,o=0,p=0;b=a.event.fix(e);b.type="mousewheel";if("detail"in e){m=-1*e.detail}if("wheelDelta"in e){m=e.wheelDelta}if("wheelDeltaY"in e){m=e.wheelDeltaY}if("wheelDeltaX"in e){k=-1*e.wheelDeltaX}if("axis"in e&&e.axis===e.HORIZONTAL_AXIS){k=-1*m;m=0}i=0===m?k:m;if("deltaY"in e){m=-1*e.deltaY;i=m}if("deltaX"in e){k=e.deltaX;if(0===m){i=-1*k}}if(0===m&&0===k){return}if(1===e.deltaMode){var q=a.data(this,"mousewheel-line-height");i*=q;m*=q;k*=q}else if(2===e.deltaMode){var r=a.data(this,"mousewheel-page-height");i*=r;m*=r;k*=r}n=Math.max(Math.abs(m),Math.abs(k));if(!j||n<j){j=n;if(d(e,n)){j/=40}}if(d(e,n)){i/=40;k/=40;m/=40}i=Math[1<=i?"floor":"ceil"](i/j);k=Math[1<=k?"floor":"ceil"](k/j);m=Math[1<=m?"floor":"ceil"](m/j);if(l.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left;p=b.clientY-s.top}b.deltaX=k;b.deltaY=m;b.deltaFactor=j;b.offsetX=o;b.offsetY=p;b.deltaMode=0;f.unshift(b,i,k,m);if(h){clearTimeout(h)}h=setTimeout(c,200);return(a.event.dispatch||a.event.handle).apply(this,f)}function c(){j=null}function d(a,b){return l.settings.adjustOldDeltas&&"mousewheel"===a.type&&0==b%120}});
define ("theme_coursemos/jquery.tableHeadFixer",["jquery"],function(){(function(a){a.fn.tableHeadFixer=function(b){var m=a.extend({},{head:!0,foot:!1,left:0,right:0,"z-index":0,nofixedclass:"nofixed",fixedclass:"fixedcolumn",tableclass:"table-fixed"},b);return this.each(function(){m.table=this;thistable=a(m.table);m.parent=thistable.parent();d();if(!0==m.head)e();if(!0==m.foot)f();if(0<m.left)g();if(0<m.right)h();c();if(!thistable.hasClass(m.tableclass)){thistable.addClass(m.tableclass)}a(m.parent).trigger("scroll");a(window).resize(function(){a(m.parent).trigger("scroll")})});function c(){var b=a(m.table);if(m.head){if(0<m.left){var c=b.find("thead tr");c.each(function(b,c){j(c,function(b){a(b).css("z-index",m["z-index"])})})}if(0<m.right){var c=b.find("thead tr");c.each(function(b,c){l(c,function(b){a(b).css("z-index",m["z-index"])})})}}if(m.foot){if(0<m.left){var c=b.find("tfoot tr");c.each(function(b,c){j(c,function(b){a(b).css("z-index",m["z-index"])})})}if(0<m.right){var c=b.find("tfoot tr");c.each(function(b,c){l(c,function(b){a(b).css("z-index",m["z-index"])})})}}}function d(){var b=a(m.parent),c=a(m.table);b.append(c);b.css({overflowX:"auto"});b.scroll(function(){var c=b[0].scrollWidth,d=b[0].clientWidth,e=b[0].scrollHeight,f=b[0].clientHeight,g=b.scrollTop(),h=b.scrollLeft();if(m.head)this.find("thead tr > *").css("top",g);if(m.foot)this.find("tfoot tr > *").css("bottom",e-f-g);if(768>a(window).width()){h=0}if(0<m.left)m.leftColumns.css("left",h);if(0<m.right)m.rightColumns.css("right",c-d-h)}.bind(c))}function e(){var b=a(m.table).find("thead"),c=b.find("tr"),d=b.find("tr > *");i(d);d.css({position:"relative"})}function f(){var b=a(m.table).find("tfoot"),c=b.find("tr"),d=b.find("tr > *");i(d);d.css({position:"relative"})}function g(){var b=a(m.table);m.leftColumns=a();var c=b.find("tr");c.each(function(b,c){j(c,function(b){m.leftColumns=m.leftColumns.add(b);a(c).find("> *:nth-child("+m.left+")").addClass("leftlastfixedcolumn")})});var d=m.leftColumns;d.each(function(b,c){var c=a(c);i(c);c.css({position:"relative"})})}function h(){var b=a(m.table),c=m.right;m.rightColumns=a();var d=b.find("tr");d.each(function(a,b){l(b,function(a){m.rightColumns=m.rightColumns.add(a)})});var e=m.rightColumns;e.each(function(b,c){var c=a(c);i(c);c.css({position:"relative"})})}function i(b){b.each(function(b,c){var c=a(c);if(!c.hasClass(m.fixedclass)){c.addClass(m.fixedclass)}})}function j(b,c){for(var d=m.left,e=1,f=1;f<=d;f=f+e){var g=1<e?f-1:f,h=a(b).find("> *:nth-child("+g+")"),j=h.prop("colspan");if(!h.hasClass(m.nofixedclass)){c(h)}e=j}}function l(b,c){for(var d=m.right,e=1,f=1;f<=d;f=f+e){var g=1<e?f-1:f,h=a(b).find("> *:nth-last-child("+g+")"),j=h.prop("colspan");c(h);e=j}}}})(jQuery)});
function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a){if("function"==typeof define&&define.amd){define ("theme_coursemos/jquery.validate",["jquery"],a)}else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){module.exports=a(require("jquery"))}else{a(jQuery)}})(function(b){b.extend(b.fn,{validate:function validate(a){if(!this.length){if(a&&a.debug&&window.console){console.warn("Nothing selected, can't validate, returning nothing.")}return}var c=b.data(this[0],"validator");if(c){return c}this.attr("novalidate","novalidate");c=new b.validator(a,this[0]);b.data(this[0],"validator",c);if(c.settings.onsubmit){this.on("click.validate",":submit",function(a){c.submitButton=a.currentTarget;if(b(this).hasClass("cancel")){c.cancelSubmit=!0}if(b(this).attr("formnovalidate")!==void 0){c.cancelSubmit=!0}});this.on("submit.validate",function(a){if(c.settings.debug){a.preventDefault()}function d(){var d,e;if(c.submitButton&&(c.settings.submitHandler||c.formSubmitted)){d=b("<input type='hidden'/>").attr("name",c.submitButton.name).val(b(c.submitButton).val()).appendTo(c.currentForm)}if(c.settings.submitHandler&&!c.settings.debug){e=c.settings.submitHandler.call(c,c.currentForm,a);if(d){d.remove()}if(e!==void 0){return e}return!1}return!0}if(c.cancelSubmit){c.cancelSubmit=!1;return d()}if(c.form()){if(c.pendingRequest){c.formSubmitted=!0;return!1}return d()}else{c.focusInvalid();return!1}})}return c},valid:function(){var a,c,d;if(b(this[0]).is("form")){a=this.validate().form()}else{d=[];a=!0;c=b(this[0].form).validate();this.each(function(){a=c.element(this)&&a;if(!a){d=d.concat(c.errorList)}});c.errorList=d}return a},rules:function rules(a,c){var d=this[0],e="undefined"!=typeof this.attr("contenteditable")&&"false"!==this.attr("contenteditable"),f,g,h,i,j,k;if(null==d){return}if(!d.form&&e){d.form=this.closest("form")[0];d.name=this.attr("name")}if(null==d.form){return}if(a){f=b.data(d.form,"validator").settings;g=f.rules;h=b.validator.staticRules(d);switch(a){case"add":b.extend(h,b.validator.normalizeRule(c));delete h.messages;g[d.name]=h;if(c.messages){f.messages[d.name]=b.extend(f.messages[d.name],c.messages)}break;case"remove":if(!c){delete g[d.name];return h}k={};b.each(c.split(/\s/),function(a,b){k[b]=h[b];delete h[b]});return k;}}i=b.validator.normalizeRules(b.extend({},b.validator.classRules(d),b.validator.attributeRules(d),b.validator.dataRules(d),b.validator.staticRules(d)),d);if(i.required){j=i.required;delete i.required;i=b.extend({required:j},i)}if(i.remote){j=i.remote;delete i.remote;i=b.extend(i,{remote:j})}return i}});b.extend(b.expr.pseudos||b.expr[":"],{blank:function blank(c){return!b.trim(""+b(c).val())},filled:function filled(c){var a=b(c).val();return null!==a&&!!b.trim(""+a)},unchecked:function unchecked(c){return!b(c).prop("checked")}});b.validator=function(a,c){this.settings=b.extend(!0,{},b.validator.defaults,a);this.currentForm=c;this.init()};b.validator.format=function(a,c){if(1===arguments.length){return function(){var c=b.makeArray(arguments);c.unshift(a);return b.validator.format.apply(this,c)}}if(c===void 0){return a}if(2<arguments.length&&c.constructor!==Array){c=b.makeArray(arguments).slice(1)}if(c.constructor!==Array){c=[c]}b.each(c,function(b,c){a=a.replace(new RegExp("\\{"+b+"\\}","g"),function(){return c})});return a};b.extend(b.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:b([]),errorLabelContainer:b([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function onfocusin(a){this.lastActive=a;if(this.settings.focusCleanup){if(this.settings.unhighlight){this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass)}this.hideThese(this.errorsFor(a))}},onfocusout:function onfocusout(a){if(!this.checkable(a)&&(a.name in this.submitted||!this.optional(a))){this.element(a)}},onkeyup:function onkeyup(a,c){if(9===c.which&&""===this.elementValue(a)||-1!==b.inArray(c.keyCode,[16,17,18,20,35,36,37,38,39,40,45,144,225])){}else if(a.name in this.submitted||a.name in this.invalid){this.element(a)}},onclick:function onclick(a){if(a.name in this.submitted){this.element(a)}else if(a.parentNode.name in this.submitted){this.element(a.parentNode)}},highlight:function highlight(a,c,d){if("radio"===a.type){this.findByName(a.name).addClass(c).removeClass(d)}else{b(a).addClass(c).removeClass(d)}},unhighlight:function unhighlight(a,c,d){if("radio"===a.type){this.findByName(a.name).removeClass(c).addClass(d)}else{b(a).removeClass(c).addClass(d)}}},setDefaults:function setDefaults(a){b.extend(b.validator.defaults,a)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",maxlength:b.validator.format("Please enter no more than {0} characters."),minlength:b.validator.format("Please enter at least {0} characters."),rangelength:b.validator.format("Please enter a value between {0} and {1} characters long."),range:b.validator.format("Please enter a value between {0} and {1}."),max:b.validator.format("Please enter a value less than or equal to {0}."),min:b.validator.format("Please enter a value greater than or equal to {0}."),step:b.validator.format("Please enter a multiple of {0}.")},autoCreateRanges:!1,prototype:{init:function init(){this.labelContainer=b(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||b(this.currentForm);this.containers=b(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var c=this.currentForm,d=this.groups={},e;b.each(this.settings.groups,function(a,c){if("string"==typeof c){c=c.split(/\s/)}b.each(c,function(b,c){d[c]=a})});e=this.settings.rules;b.each(e,function(a,c){e[a]=b.validator.normalizeRule(c)});function a(a){var d="undefined"!=typeof b(this).attr("contenteditable")&&"false"!==b(this).attr("contenteditable");if(!this.form&&d){this.form=b(this).closest("form")[0];this.name=b(this).attr("name")}if(c!==this.form){return}var e=b.data(this.form,"validator"),f="on"+a.type.replace(/^validate/,""),g=e.settings;if(g[f]&&!b(this).is(g.ignore)){g[f].call(e,this,a)}}b(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable], [type='button']",a).on("click.validate","select, option, [type='radio'], [type='checkbox']",a);if(this.settings.invalidHandler){b(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler)}},form:function form(){this.checkForm();b.extend(this.submitted,this.errorMap);this.invalid=b.extend({},this.errorMap);if(!this.valid()){b(this.currentForm).triggerHandler("invalid-form",[this])}this.showErrors();return this.valid()},checkForm:function checkForm(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++){this.check(b[a])}return this.valid()},element:function element(a){var c=this.clean(a),d=this.validationTargetFor(c),e=this,f=!0,g,h;if(d===void 0){delete this.invalid[c.name]}else{this.prepareElement(d);this.currentElements=b(d);h=this.groups[d.name];if(h){b.each(this.groups,function(a,b){if(b===h&&a!==d.name){c=e.validationTargetFor(e.clean(e.findByName(a)));if(c&&c.name in e.invalid){e.currentElements.push(c);f=e.check(c)&&f}}})}g=!1!==this.check(d);f=f&&g;if(g){this.invalid[d.name]=!1}else{this.invalid[d.name]=!0}if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers)}this.showErrors();b(a).attr("aria-invalid",!g)}return f},showErrors:function showErrors(a){if(a){var c=this;b.extend(this.errorMap,a);this.errorList=b.map(this.errorMap,function(a,b){return{message:a,element:c.findByName(b)[0]}});this.successList=b.grep(this.successList,function(b){return!(b.name in a)})}if(this.settings.showErrors){this.settings.showErrors.call(this,this.errorMap,this.errorList)}else{this.defaultShowErrors()}},resetForm:function resetForm(){if(b.fn.resetForm){b(this.currentForm).resetForm()}this.invalid={};this.submitted={};this.prepareForm();this.hideErrors();var a=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(a)},resetElements:function resetElements(a){var b;if(this.settings.unhighlight){for(b=0;a[b];b++){this.settings.unhighlight.call(this,a[b],this.settings.errorClass,"");this.findByName(a[b].name).removeClass(this.settings.validClass)}}else{a.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)}},numberOfInvalids:function numberOfInvalids(){return this.objectLength(this.invalid)},objectLength:function objectLength(a){var b=0,c;for(c in a){if(a[c]!==void 0&&null!==a[c]&&!1!==a[c]){b++}}return b},hideErrors:function hideErrors(){this.hideThese(this.toHide)},hideThese:function hideThese(a){a.not(this.containers).text("");this.addWrapper(a).hide()},valid:function valid(){return 0===this.size()},size:function size(){return this.errorList.length},focusInvalid:function focusInvalid(){if(this.settings.focusInvalid){try{b(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").trigger("focus").trigger("focusin")}catch(a){}}},findLastActive:function findLastActive(){var a=this.lastActive;return a&&1===b.grep(this.errorList,function(b){return b.element.name===a.name}).length&&a},elements:function elements(){var a=this,c={};return b(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var d=this.name||b(this).attr("name"),e="undefined"!=typeof b(this).attr("contenteditable")&&"false"!==b(this).attr("contenteditable");if(!d&&a.settings.debug&&window.console){console.error("%o has no name assigned",this)}if(e){this.form=b(this).closest("form")[0];this.name=d}if(this.form!==a.currentForm){return!1}if(d in c||!a.objectLength(b(this).rules())){return!1}c[d]=!0;return!0})},clean:function clean(a){return b(a)[0]},errors:function errors(){var a=this.settings.errorClass.split(" ").join(".");return b(this.settings.errorElement+"."+a,this.errorContext)},resetInternals:function resetInternals(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=b([]);this.toHide=b([])},reset:function reset(){this.resetInternals();this.currentElements=b([])},prepareForm:function prepareForm(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function prepareElement(a){this.reset();this.toHide=this.errorsFor(a)},elementValue:function elementValue(a){var c=b(a),d=a.type,e="undefined"!=typeof c.attr("contenteditable")&&"false"!==c.attr("contenteditable"),f,g;if("radio"===d||"checkbox"===d){return this.findByName(a.name).filter(":checked").val()}else if("number"===d&&"undefined"!=typeof a.validity){return a.validity.badInput?"NaN":c.val()}if(e){f=c.text()}else{f=c.val()}if("file"===d){if("C:\\fakepath\\"===f.substr(0,12)){return f.substr(12)}g=f.lastIndexOf("/");if(0<=g){return f.substr(g+1)}g=f.lastIndexOf("\\");if(0<=g){return f.substr(g+1)}return f}if("string"==typeof f){return f.replace(/\r/g,"")}return f},check:function check(a){a=this.validationTargetFor(this.clean(a));var c=b(a).rules(),d=b.map(c,function(a,b){return b}).length,e=!1,f=this.elementValue(a),g,h,i,j;if("function"==typeof c.normalizer){j=c.normalizer}else if("function"==typeof this.settings.normalizer){j=this.settings.normalizer}if(j){f=j.call(a,f);delete c.normalizer}for(h in c){i={method:h,parameters:c[h]};try{g=b.validator.methods[h].call(this,f,a,i.parameters);if("dependency-mismatch"===g&&1===d){e=!0;continue}e=!1;if("pending"===g){this.toHide=this.toHide.not(this.errorsFor(a));return}if(!g){this.formatAndAdd(a,i);return!1}}catch(b){if(this.settings.debug&&window.console){console.log("Exception occurred when checking element "+a.id+", check the '"+i.method+"' method.",b)}if(b instanceof TypeError){b.message+=".  Exception occurred when checking element "+a.id+", check the '"+i.method+"' method."}throw b}}if(e){return}if(this.objectLength(c)){this.successList.push(a)}return!0},customDataMessage:function customDataMessage(a,c){return b(a).data("msg"+c.charAt(0).toUpperCase()+c.substring(1).toLowerCase())||b(a).data("msg")},customMessage:function customMessage(a,b){var c=this.settings.messages[a];return c&&(c.constructor===String?c:c[b])},findDefined:function findDefined(){for(var a=0;a<arguments.length;a++){if(arguments[a]!==void 0){return arguments[a]}}},defaultMessage:function defaultMessage(a,c){if("string"==typeof c){c={method:c}}var d=this.findDefined(this.customMessage(a.name,c.method),this.customDataMessage(a,c.method),!this.settings.ignoreTitle&&a.title||void 0,b.validator.messages[c.method],"<strong>Warning: No message defined for "+a.name+"</strong>"),e=/\$?\{(\d+)\}/g;if("function"==typeof d){d=d.call(this,c.parameters,a)}else if(e.test(d)){d=b.validator.format(d.replace(e,"{$1}"),c.parameters)}return d},formatAndAdd:function formatAndAdd(a,b){var c=this.defaultMessage(a,b);this.errorList.push({message:c,element:a,method:b.method});this.errorMap[a.name]=c;this.submitted[a.name]=c},addWrapper:function addWrapper(a){if(this.settings.wrapper){a=a.add(a.parent(this.settings.wrapper))}return a},defaultShowErrors:function defaultShowErrors(){var a,b,c;for(a=0;this.errorList[a];a++){c=this.errorList[a];if(this.settings.highlight){this.settings.highlight.call(this,c.element,this.settings.errorClass,this.settings.validClass)}this.showLabel(c.element,c.message)}if(this.errorList.length){this.toShow=this.toShow.add(this.containers)}if(this.settings.success){for(a=0;this.successList[a];a++){this.showLabel(this.successList[a])}}if(this.settings.unhighlight){for(a=0,b=this.validElements();b[a];a++){this.settings.unhighlight.call(this,b[a],this.settings.errorClass,this.settings.validClass)}}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function validElements(){return this.currentElements.not(this.invalidElements())},invalidElements:function invalidElements(){return b(this.errorList).map(function(){return this.element})},showLabel:function showLabel(a,c){var d,e,f,g,h=this.errorsFor(a),i=this.idOrName(a),j=b(a).attr("aria-describedby");if(h.length){h.removeClass(this.settings.validClass).addClass(this.settings.errorClass);h.html(c)}else{h=b("<"+this.settings.errorElement+">").attr("id",i+"-error").addClass(this.settings.errorClass).html(c||"");d=h;if(this.settings.wrapper){d=h.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()}if(this.labelContainer.length){this.labelContainer.append(d)}else if(this.settings.errorPlacement){this.settings.errorPlacement.call(this,d,b(a))}else{d.insertAfter(a)}if(h.is("label")){h.attr("for",i)}else if(0===h.parents("label[for='"+this.escapeCssMeta(i)+"']").length){f=h.attr("id");if(!j){j=f}else if(!j.match(new RegExp("\\b"+this.escapeCssMeta(f)+"\\b"))){j+=" "+f}b(a).attr("aria-describedby",j);e=this.groups[a.name];if(e){g=this;b.each(g.groups,function(a,c){if(c===e){b("[name='"+g.escapeCssMeta(a)+"']",g.currentForm).attr("aria-describedby",h.attr("id"))}})}}}if(!c&&this.settings.success){h.text("");if("string"==typeof this.settings.success){h.addClass(this.settings.success)}else{this.settings.success(h,a)}}this.toShow=this.toShow.add(h)},errorsFor:function errorsFor(a){var c=this.escapeCssMeta(this.idOrName(a)),d=b(a).attr("aria-describedby"),e="label[for='"+c+"'], label[for='"+c+"'] *";if(d){e=e+", #"+this.escapeCssMeta(d).replace(/\s+/g,", #")}return this.errors().filter(e)},escapeCssMeta:function escapeCssMeta(a){return a.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g,"\\$1")},idOrName:function idOrName(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function validationTargetFor(a){if(this.checkable(a)){a=this.findByName(a.name)}return b(a).not(this.settings.ignore)[0]},checkable:function checkable(a){return /radio|checkbox/i.test(a.type)},findByName:function findByName(a){return b(this.currentForm).find("[name='"+this.escapeCssMeta(a)+"']")},getLength:function getLength(a,c){switch(c.nodeName.toLowerCase()){case"select":return b("option:selected",c).length;case"input":if(this.checkable(c)){return this.findByName(c.name).filter(":checked").length}}return a.length},depend:function depend(a,b){return this.dependTypes[_typeof(a)]?this.dependTypes[_typeof(a)](a,b):!0},dependTypes:{boolean:function boolean(a){return a},string:function string(a,c){return!!b(a,c.form).length},function:function _function(a,b){return a(b)}},optional:function optional(a){var c=this.elementValue(a);return!b.validator.methods.required.call(this,c,a)&&"dependency-mismatch"},startRequest:function startRequest(a){if(!this.pending[a.name]){this.pendingRequest++;b(a).addClass(this.settings.pendingClass);this.pending[a.name]=!0}},stopRequest:function stopRequest(a,c){this.pendingRequest--;if(0>this.pendingRequest){this.pendingRequest=0}delete this.pending[a.name];b(a).removeClass(this.settings.pendingClass);if(c&&0===this.pendingRequest&&this.formSubmitted&&this.form()){b(this.currentForm).submit();if(this.submitButton){b("input:hidden[name='"+this.submitButton.name+"']",this.currentForm).remove()}this.formSubmitted=!1}else if(!c&&0===this.pendingRequest&&this.formSubmitted){b(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=!1}},previousValue:function previousValue(a,c){c="string"==typeof c&&c||"remote";return b.data(a,"previousValue")||b.data(a,"previousValue",{old:null,valid:!0,message:this.defaultMessage(a,{method:c})})},destroy:function destroy(){this.resetForm();b(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur").find(".validate-lessThan-blur").off(".validate-lessThan").removeClass("validate-lessThan-blur").find(".validate-lessThanEqual-blur").off(".validate-lessThanEqual").removeClass("validate-lessThanEqual-blur").find(".validate-greaterThanEqual-blur").off(".validate-greaterThanEqual").removeClass("validate-greaterThanEqual-blur").find(".validate-greaterThan-blur").off(".validate-greaterThan").removeClass("validate-greaterThan-blur")}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function addClassRules(a,c){if(a.constructor===String){this.classRuleSettings[a]=c}else{b.extend(this.classRuleSettings,a)}},classRules:function classRules(a){var c={},d=b(a).attr("class");if(d){b.each(d.split(" "),function(){if(this in b.validator.classRuleSettings){b.extend(c,b.validator.classRuleSettings[this])}})}return c},normalizeAttributeRule:function normalizeAttributeRule(a,b,c,d){if(/min|max|step/.test(c)&&(null===b||/number|range|text/.test(b))){d=+d;if(isNaN(d)){d=void 0}}if(d||0===d){a[c]=d}else if(b===c&&"range"!==b){a[c]=!0}},attributeRules:function attributeRules(a){var c={},d=b(a),e=a.getAttribute("type"),f,g;for(f in b.validator.methods){if("required"===f){g=a.getAttribute(f);if(""===g){g=!0}g=!!g}else{g=d.attr(f)}this.normalizeAttributeRule(c,e,f,g)}if(c.maxlength&&/-1|2147483647|524288/.test(c.maxlength)){delete c.maxlength}return c},dataRules:function dataRules(a){var c={},d=b(a),e=a.getAttribute("type"),f,g;for(f in b.validator.methods){g=d.data("rule"+f.charAt(0).toUpperCase()+f.substring(1).toLowerCase());if(""===g){g=!0}this.normalizeAttributeRule(c,e,f,g)}return c},staticRules:function staticRules(a){var c={},d=b.data(a.form,"validator");if(d.settings.rules){c=b.validator.normalizeRule(d.settings.rules[a.name])||{}}return c},normalizeRules:function normalizeRules(a,c){b.each(a,function(d,e){if(!1===e){delete a[d];return}if(e.param||e.depends){var f=!0;switch(_typeof(e.depends)){case"string":f=!!b(e.depends,c.form).length;break;case"function":f=e.depends.call(c,c);break;}if(f){a[d]=e.param!==void 0?e.param:!0}else{b.data(c.form,"validator").resetElements(b(c));delete a[d]}}});b.each(a,function(d,e){a[d]=b.isFunction(e)&&"normalizer"!==d?e(c):e});b.each(["minlength","maxlength"],function(){if(a[this]){a[this]=+a[this]}});b.each(["rangelength","range"],function(){var c;if(a[this]){if(b.isArray(a[this])){a[this]=[+a[this][0],+a[this][1]]}else if("string"==typeof a[this]){c=a[this].replace(/[\[\]]/g,"").split(/[\s,]+/);a[this]=[+c[0],+c[1]]}}});if(b.validator.autoCreateRanges){if(null!=a.min&&null!=a.max){a.range=[a.min,a.max];delete a.min;delete a.max}if(null!=a.minlength&&null!=a.maxlength){a.rangelength=[a.minlength,a.maxlength];delete a.minlength;delete a.maxlength}}return a},normalizeRule:function normalizeRule(a){if("string"==typeof a){var c={};b.each(a.split(/\s/),function(){c[this]=!0});a=c}return a},addMethod:function addMethod(a,c,d){b.validator.methods[a]=c;b.validator.messages[a]=d!==void 0?d:b.validator.messages[a];if(3>c.length){b.validator.addClassRules(a,b.validator.normalizeRule(a))}},methods:{required:function required(a,c,d){if(!this.depend(d,c)){return"dependency-mismatch"}if("select"===c.nodeName.toLowerCase()){var e=b(c).val();return e&&0<e.length}if(this.checkable(c)){return 0<this.getLength(a,c)}return a!==void 0&&null!==a&&0<a.length},email:function email(a,b){return this.optional(b)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(a)},url:function url(a,b){return this.optional(b)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(a)},date:function(){var a=!1;return function(b,c){if(!a){a=!0;if(this.settings.debug&&window.console){console.warn("The `date` method is deprecated and will be removed in version '2.0.0'.\nPlease don't use it, since it relies on the Date constructor, which\nbehaves very differently across browsers and locales. Use `dateISO`\ninstead or one of the locale specific methods in `localizations/`\nand `additional-methods.js`.")}}return this.optional(c)||!/Invalid|NaN/.test(new Date(b).toString())}}(),dateISO:function dateISO(a,b){return this.optional(b)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(a)},number:function number(a,b){return this.optional(b)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function digits(a,b){return this.optional(b)||/^\d+$/.test(a)},minlength:function minlength(a,c,d){var e=b.isArray(a)?a.length:this.getLength(a,c);return this.optional(c)||e>=d},maxlength:function maxlength(a,c,d){var e=b.isArray(a)?a.length:this.getLength(a,c);return this.optional(c)||e<=d},rangelength:function rangelength(a,c,d){var e=b.isArray(a)?a.length:this.getLength(a,c);return this.optional(c)||e>=d[0]&&e<=d[1]},min:function min(a,b,c){return this.optional(b)||a>=c},max:function max(a,b,c){return this.optional(b)||a<=c},range:function range(a,b,c){return this.optional(b)||a>=c[0]&&a<=c[1]},step:function step(a,c,d){var e=b(c).attr("type"),f=new RegExp("\\b"+e+"\\b"),g=e&&!f.test(["text","number","range"].join()),h=function(a){var b=(""+a).match(/(?:\.(\d+))?$/);if(!b){return 0}return b[1]?b[1].length:0},i=function(a){return Math.round(a*Math.pow(10,k))},j=!0,k;if(g){throw new Error("Step attribute on input type "+e+" is not supported.")}k=h(d);if(h(a)>k||0!=i(a)%i(d)){j=!1}return this.optional(c)||j},equalTo:function equalTo(a,c,d){var e=b(d);if(this.settings.onfocusout&&e.not(".validate-equalTo-blur").length){e.addClass("validate-equalTo-blur").on("blur.validate-equalTo",function(){b(c).valid()})}return a===e.val()},remote:function remote(a,c,d,e){if(this.optional(c)){return"dependency-mismatch"}e="string"==typeof e&&e||"remote";var f=this.previousValue(c,e),g,h,i;if(!this.settings.messages[c.name]){this.settings.messages[c.name]={}}f.originalMessage=f.originalMessage||this.settings.messages[c.name][e];this.settings.messages[c.name][e]=f.message;d="string"==typeof d&&{url:d}||d;i=b.param(b.extend({data:a},d.data));if(f.old===i){return f.valid}f.old=i;g=this;this.startRequest(c);h={};h[c.name]=a;b.ajax(b.extend(!0,{mode:"abort",port:"validate"+c.name,dataType:"json",data:h,context:g.currentForm,success:function success(b){var d=!0===b||"true"===b,h,i,j;g.settings.messages[c.name][e]=f.originalMessage;if(d){j=g.formSubmitted;g.resetInternals();g.toHide=g.errorsFor(c);g.formSubmitted=j;g.successList.push(c);g.invalid[c.name]=!1;g.showErrors()}else{h={};i=b||g.defaultMessage(c,{method:e,parameters:a});h[c.name]=f.message=i;g.invalid[c.name]=!0;g.showErrors(h)}f.valid=d;g.stopRequest(c,d)}},d));return"pending"}}});var c={},d;if(b.ajaxPrefilter){b.ajaxPrefilter(function(a,b,d){var e=a.port;if("abort"===a.mode){if(c[e]){c[e].abort()}c[e]=d}})}else{d=b.ajax;b.ajax=function(a){var e=("mode"in a?a:b.ajaxSettings).mode,f=("port"in a?a:b.ajaxSettings).port;if("abort"===e){if(c[f]){c[f].abort()}c[f]=d.apply(this,arguments);return c[f]}return d.apply(this,arguments)}}b.validator.addMethod("alphaLower",function(a,b){return this.optional(b)||/^[a-z]+$/i.test(a)}," alpha lower only please");b.validator.addMethod("alphaUpper",function(a,b){return this.optional(b)||/^[A-Z]+$/i.test(a)}," alpha upper only please");b.validator.addMethod("alpha",function(a,b){return this.optional(b)||/^[a-zA-Z]+$/i.test(a)}," alpha only please");function a(a){return a.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[.(),;:!?%#$'\"_+=\/\-“”’]*/g,"")}b.validator.addMethod("maxWords",function(b,c,d){return this.optional(c)||a(b).match(/\b\w+\b/g).length<=d},b.validator.format("Please enter {0} words or less."));b.validator.addMethod("minWords",function(b,c,d){return this.optional(c)||a(b).match(/\b\w+\b/g).length>=d},b.validator.format("Please enter at least {0} words."));b.validator.addMethod("rangeWords",function(b,c,d){var e=a(b),f=/\b\w+\b/g;return this.optional(c)||e.match(f).length>=d[0]&&e.match(f).length<=d[1]},b.validator.format("Please enter between {0} and {1} words."));jQuery.validator.addMethod("decimalpointmax",function(a,b,c){if(isNaN(a)){return!1}if(-1==a.indexOf(".")){a+="."}var d=a.substring(a.indexOf(".")+1,a.length);if(d.length>c){return!1}return!0},jQuery.validator.messages.decimalpointmax);b.validator.setDefaults({onkeyup:!1,onclick:!1,onfocusout:!1,showErrors:function showErrors(a,c){if(this.numberOfInvalids()){var d=b(c[0].element).attr("placeholder")||b(c[0].element).attr("alt")||b(c[0].element).attr("name");alert("["+d+"] "+c[0].message)}}});return b});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define ("theme_coursemos/jsencrypt",["exports"],t):t(e.JSEncrypt={})})(this,function(e){'use strict';function n(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function o(e,t){return e&t}function i(e,t){return e|t}function s(e,t){return e^t}function d(e,t){return e&~t}function p(e){if(0==e){return-1}var t=0;if(0==(65535&e)){e>>=16;t+=16}if(0==(255&e)){e>>=8;t+=8}if(0==(15&e)){e>>=4;t+=4}if(0==(3&e)){e>>=2;t+=2}if(0==(1&e)){++t}return t}function g(e){var t=0;while(0!=e){e&=e-1;++t}return t}var I="=";function l(e){var t,n,o="";for(t=0;t+3<=e.length;t+=3){n=parseInt(e.substring(t,t+3),16);o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&n)}if(t+1==e.length){n=parseInt(e.substring(t,t+1),16);o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n<<2)}else if(t+2==e.length){n=parseInt(e.substring(t,t+2),16);o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>2)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((3&n)<<4)}while(0<(3&o.length)){o+=I}return o}function u(e){var t="",o,r=0,s=0;for(o=0;o<e.length;++o){if(e.charAt(o)==I){break}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e.charAt(o));if(0>a){continue}if(0==r){t+=n(a>>2);s=3&a;r=1}else if(1==r){t+=n(s<<2|a>>4);s=15&a;r=2}else if(2==r){t+=n(s);t+=n(a>>2);s=3&a;r=3}else{t+=n(s<<2|a>>4);t+=n(15&a);r=0}}if(1==r){t+=n(s<<2)}return t}var P=function extendStatics(e,t){P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t){if(t.hasOwnProperty(n))e[n]=t[n]}};return P(e,t)};function c(e,t){P(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var w,j={decode:function decode(e){var t;if(w===void 0){var n="0123456789ABCDEF",o=" \f\n\r\t\xA0\u2028\u2029";w={};for(t=0;16>t;++t){w[n.charAt(t)]=t}n=n.toLowerCase();for(t=10;16>t;++t){w[n.charAt(t)]=t}for(t=0;t<o.length;++t){w[o.charAt(t)]=-1}}var r=[],s=0,a=0;for(t=0;t<e.length;++t){var d=e.charAt(t);if("="==d){break}d=w[d];if(-1==d){continue}if(d===void 0){throw new Error("Illegal character at offset "+t)}s|=d;if(2<=++a){r[r.length]=s;s=0;a=0}else{s<<=4}}if(a){throw new Error("Hex encoding incomplete: 4 bits missing")}return r}},q,L={decode:function decode(e){var t;if(q===void 0){var n="= \f\n\r\t\xA0\u2028\u2029";q=Object.create(null);for(t=0;64>t;++t){q["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t)]=t}for(t=0;t<n.length;++t){q[n.charAt(t)]=-1}}var o=[],r=0,s=0;for(t=0;t<e.length;++t){var a=e.charAt(t);if("="==a){break}a=q[a];if(-1==a){continue}if(a===void 0){throw new Error("Illegal character at offset "+t)}r|=a;if(4<=++s){o[o.length]=r>>16;o[o.length]=255&r>>8;o[o.length]=255&r;r=0;s=0}else{r<<=6}}switch(s){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:o[o.length]=r>>10;break;case 3:o[o.length]=r>>16;o[o.length]=255&r>>8;break;}return o},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function unarmor(e){var t=L.re.exec(e);if(t){if(t[1]){e=t[1]}else if(t[2]){e=t[2]}else{throw new Error("RegExp out of sync")}}return L.decode(e)}},H=1e13,C=function(){function e(e){this.buf=[+e||0]}e.prototype.mulAdd=function(e,n){var o=this.buf,r=o.length,s,a;for(s=0;s<r;++s){a=o[s]*e+n;if(a<H){n=0}else{n=0|a/H;a-=n*H}o[s]=a}if(0<n){o[s]=n}};e.prototype.sub=function(e){var n=this.buf,o=n.length,r,s;for(r=0;r<o;++r){s=n[r]-e;if(0>s){s+=H;e=1}else{e=0}n[r]=s}while(0===n[n.length-1]){n.pop()}};e.prototype.toString=function(e){if(10!=(e||10)){throw new Error("only base 10 is supported")}for(var t=this.buf,n=t[t.length-1].toString(),o=t.length-2;0<=o;--o){n+=(H+t[o]).toString().substring(1)}return n};e.prototype.valueOf=function(){for(var e=this.buf,t=0,n=e.length-1;0<=n;--n){t=t*H+e[n]}return t};e.prototype.simplify=function(){var e=this.buf;return 1==e.length?e[0]:this};return e}(),M="\u2026";function m(e,t){if(e.length>t){e=e.substring(0,t)+M}return e}var k=function(){function e(t,n){this.hexDigits="0123456789ABCDEF";if(t instanceof e){this.enc=t.enc;this.pos=t.pos}else{this.enc=t;this.pos=n}}e.prototype.get=function(e){if(e===void 0){e=this.pos++}if(e>=this.enc.length){throw new Error("Requesting byte offset "+e+" on a stream of length "+this.enc.length)}return"string"==typeof this.enc?this.enc.charCodeAt(e):this.enc[e]};e.prototype.hexByte=function(e){return this.hexDigits.charAt(15&e>>4)+this.hexDigits.charAt(15&e)};e.prototype.hexDump=function(e,t,n){for(var o="",r=e;r<t;++r){o+=this.hexByte(this.get(r));if(!0!==n){switch(15&r){case 7:o+="  ";break;case 15:o+="\n";break;default:o+=" ";}}}return o};e.prototype.isASCII=function(e,t){for(var n=e,o;n<t;++n){o=this.get(n);if(32>o||176<o){return!1}}return!0};e.prototype.parseStringISO=function(e,t){for(var n="",o=e;o<t;++o){n+=String.fromCharCode(this.get(o))}return n};e.prototype.parseStringUTF=function(e,t){for(var n="",o=e,r;o<t;){r=this.get(o++);if(128>r){n+=String.fromCharCode(r)}else if(191<r&&224>r){n+=String.fromCharCode((31&r)<<6|63&this.get(o++))}else{n+=String.fromCharCode((15&r)<<12|(63&this.get(o++))<<6|63&this.get(o++))}}return n};e.prototype.parseStringBMP=function(e,t){for(var n="",o,r,s=e;s<t;){o=this.get(s++);r=this.get(s++);n+=String.fromCharCode(o<<8|r)}return n};e.prototype.parseTime=function(e,t,n){var o=this.parseStringISO(e,t),r=(n?/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/:/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/).exec(o);if(!r){return"Unrecognized time: "+o}if(n){r[1]=+r[1];r[1]+=70>+r[1]?2e3:1900}o=r[1]+"-"+r[2]+"-"+r[3]+" "+r[4];if(r[5]){o+=":"+r[5];if(r[6]){o+=":"+r[6];if(r[7]){o+="."+r[7]}}}if(r[8]){o+=" UTC";if("Z"!=r[8]){o+=r[8];if(r[9]){o+=":"+r[9]}}}return o};e.prototype.parseInteger=function(e,t){var o=this.get(e),r=127<o,a=r?255:0,d,p="";while(o==a&&++e<t){o=this.get(e)}d=t-e;if(0===d){return r?-1:0}if(4<d){p=o;d<<=3;while(0==(128&(+p^a))){p=+p<<1;--d}p="("+d+" bit)\n"}if(r){o=o-256}for(var g=new C(o),n=e+1;n<t;++n){g.mulAdd(256,this.get(n))}return p+g.toString()};e.prototype.parseBitString=function(e,t,n){for(var o=this.get(e),r="("+((t-e-1<<3)-o)+" bit)\n",a="",d=e+1;d<t;++d){for(var p=this.get(d),g=d==t-1?o:0,l=7;l>=g;--l){a+=1&p>>l?"1":"0"}if(a.length>n){return r+m(a,n)}}return r+a};e.prototype.parseOctetString=function(e,t,n){if(this.isASCII(e,t)){return m(this.parseStringISO(e,t),n)}var o=t-e,r="("+o+" byte)\n";n/=2;if(o>n){t=e+n}for(var a=e;a<t;++a){r+=this.hexByte(this.get(a))}if(o>n){r+=M}return r};e.prototype.parseOID=function(e,t,o){for(var r="",a=new C,d=0,p=e,g;p<t;++p){g=this.get(p);a.mulAdd(128,127&g);d+=7;if(!(128&g)){if(""===r){a=a.simplify();if(a instanceof C){a.sub(80);r="2."+a.toString()}else{var l=80>a?40>a?0:1:2;r=l+"."+(a-40*l)}}else{r+="."+a.toString()}if(r.length>o){return m(r,o)}a=new C;d=0}}if(0<d){r+=".incomplete"}return r};return e}(),F=function(){function e(e,t,n,o,r){if(!(o instanceof K)){throw new Error("Invalid tag value.")}this.stream=e;this.header=t;this.length=n;this.tag=o;this.sub=r}e.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString();}};e.prototype.content=function(e){if(this.tag===void 0){return null}if(e===void 0){e=1/0}var t=this.posContent(),n=Math.abs(this.length);if(!this.tag.isUniversal()){if(null!==this.sub){return"("+this.sub.length+" elem)"}return this.stream.parseOctetString(t,t+n,e)}switch(this.tag.tagNumber){case 1:return 0===this.stream.get(t)?"false":"true";case 2:return this.stream.parseInteger(t,t+n);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(t,t+n,e);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(t,t+n,e);case 6:return this.stream.parseOID(t,t+n,e);case 16:case 17:if(null!==this.sub){return"("+this.sub.length+" elem)"}else{return"(no elem)"}case 12:return m(this.stream.parseStringUTF(t,t+n),e);case 18:case 19:case 20:case 21:case 22:case 26:return m(this.stream.parseStringISO(t,t+n),e);case 30:return m(this.stream.parseStringBMP(t,t+n),e);case 23:case 24:return this.stream.parseTime(t,t+n,23==this.tag.tagNumber);}return null};e.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"};e.prototype.toPrettyString=function(e){if(e===void 0){e=""}var t=e+this.typeName()+" @"+this.stream.pos;if(0<=this.length){t+="+"}t+=this.length;if(this.tag.tagConstructed){t+=" (constructed)"}else if(this.tag.isUniversal()&&(3==this.tag.tagNumber||4==this.tag.tagNumber)&&null!==this.sub){t+=" (encapsulates)"}t+="\n";if(null!==this.sub){e+="  ";for(var n=0,o=this.sub.length;n<o;++n){t+=this.sub[n].toPrettyString(e)}}return t};e.prototype.posStart=function(){return this.stream.pos};e.prototype.posContent=function(){return this.stream.pos+this.header};e.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)};e.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)};e.decodeLength=function(e){var t=e.get(),n=127&t;if(n==t){return n}if(6<n){throw new Error("Length over 48 bits not supported at position "+(e.pos-1))}if(0===n){return null}t=0;for(var o=0;o<n;++o){t=256*t+e.get()}return t};e.prototype.getHexStringValue=function(){var e=this.toHexString(),t=2*this.header,n=2*this.length;return e.substr(t,n)};e.decode=function(t){var n;if(!(t instanceof k)){n=new k(t,0)}else{n=t}var o=new k(n),r=new K(n),a=e.decodeLength(n),d=n.pos,p=d-o.pos,g=null,l=function(){var t=[];if(null!==a){var o=d+a;while(n.pos<o){t[t.length]=e.decode(n)}if(n.pos!=o){throw new Error("Content size is not correct for container starting at offset "+d)}}else{try{for(;;){var r=e.decode(n);if(r.tag.isEOC()){break}t[t.length]=r}a=d-n.pos}catch(t){throw new Error("Exception while decoding undefined length content: "+t)}}return t};if(r.tagConstructed){g=l()}else if(r.isUniversal()&&(3==r.tagNumber||4==r.tagNumber)){try{if(3==r.tagNumber){if(0!=n.get()){throw new Error("BIT STRINGs with unused bits cannot encapsulate.")}}g=l();for(var u=0;u<g.length;++u){if(g[u].tag.isEOC()){throw new Error("EOC is not supposed to be actual content.")}}}catch(t){g=null}}if(null===g){if(null===a){throw new Error("We can't skip over an invalid tag with undefined length at offset "+d)}n.pos=d+Math.abs(a)}return new e(o,p,a,r,g)};return e}(),K=function(){function e(e){var t=e.get();this.tagClass=t>>6;this.tagConstructed=0!=(32&t);this.tagNumber=31&t;if(31==this.tagNumber){var o=new C;do{t=e.get();o.mulAdd(128,127&t)}while(128&t);this.tagNumber=o.simplify()}}e.prototype.isUniversal=function(){return 0===this.tagClass};e.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber};return e}(),U,_=15715070==(16777215&0xdeadbeefcafe),G=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Z=67108864/G[G.length-1],Y=function(){function l(e,t,n){if(null!=e){if("number"==typeof e){this.fromNumber(e,t,n)}else if(null==t&&"string"!=typeof e){this.fromString(e,256)}else{this.fromString(e,t)}}}l.prototype.toString=function(e){if(0>this.s){return"-"+this.negate().toString(e)}var t;if(16==e){t=4}else if(8==e){t=3}else if(2==e){t=1}else if(32==e){t=5}else if(4==e){t=2}else{return this.toRadix(e)}var o=(1<<t)-1,s,a=!1,g="",l=this.t,u=this.DB-l*this.DB%t;if(0<l--){if(u<this.DB&&0<(s=this[l]>>u)){a=!0;g=n(s)}while(0<=l){if(u<t){s=(this[l]&(1<<u)-1)<<t-u;s|=this[--l]>>(u+=this.DB-t)}else{s=this[l]>>(u-=t)&o;if(0>=u){u+=this.DB;--l}}if(0<s){a=!0}if(a){g+=n(s)}}}return a?g:"0"};l.prototype.negate=function(){var e=h();l.ZERO.subTo(this,e);return e};l.prototype.abs=function(){return 0>this.s?this.negate():this};l.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t){return t}var n=this.t;t=n-e.t;if(0!=t){return 0>this.s?-t:t}while(0<=--n){if(0!=(t=this[n]-e[n])){return t}}return 0};l.prototype.bitLength=function(){if(0>=this.t){return 0}return this.DB*(this.t-1)+D(this[this.t-1]^this.s&this.DM)};l.prototype.mod=function(e){var t=h();this.abs().divRemTo(e,null,t);if(0>this.s&&0<t.compareTo(l.ZERO)){e.subTo(t,t)}return t};l.prototype.modPowInt=function(t,e){var n;if(256>t||e.isEven()){n=new X(e)}else{n=new Q(e)}return this.exp(t,n)};l.prototype.clone=function(){var e=h();this.copyTo(e);return e};l.prototype.intValue=function(){if(0>this.s){if(1==this.t){return this[0]-this.DV}else if(0==this.t){return-1}}else if(1==this.t){return this[0]}else if(0==this.t){return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};l.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24};l.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};l.prototype.signum=function(){if(0>this.s){return-1}else if(0>=this.t||1==this.t&&0>=this[0]){return 0}else{return 1}};l.prototype.toByteArray=function(){var e=this.t,t=[];t[0]=this.s;var n=this.DB-e*this.DB%8,o,r=0;if(0<e--){if(n<this.DB&&(o=this[e]>>n)!=(this.s&this.DM)>>n){t[r++]=o|this.s<<this.DB-n}while(0<=e){if(8>n){o=(this[e]&(1<<n)-1)<<8-n;o|=this[--e]>>(n+=this.DB-8)}else{o=255&this[e]>>(n-=8);if(0>=n){n+=this.DB;--e}}if(0!=(128&o)){o|=-256}if(0==r&&(128&this.s)!=(128&o)){++r}if(0<r||o!=this.s){t[r++]=o}}}return t};l.prototype.equals=function(e){return 0==this.compareTo(e)};l.prototype.min=function(e){return 0>this.compareTo(e)?this:e};l.prototype.max=function(e){return 0<this.compareTo(e)?this:e};l.prototype.and=function(e){var t=h();this.bitwiseTo(e,o,t);return t};l.prototype.or=function(e){var t=h();this.bitwiseTo(e,i,t);return t};l.prototype.xor=function(e){var t=h();this.bitwiseTo(e,s,t);return t};l.prototype.andNot=function(e){var t=h();this.bitwiseTo(e,d,t);return t};l.prototype.not=function(){for(var e=h(),t=0;t<this.t;++t){e[t]=this.DM&~this[t]}e.t=this.t;e.s=~this.s;return e};l.prototype.shiftLeft=function(e){var t=h();if(0>e){this.rShiftTo(-e,t)}else{this.lShiftTo(e,t)}return t};l.prototype.shiftRight=function(e){var t=h();if(0>e){this.lShiftTo(-e,t)}else{this.rShiftTo(e,t)}return t};l.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e){if(0!=this[e]){return e*this.DB+p(this[e])}}if(0>this.s){return this.t*this.DB}return-1};l.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,n=0;n<this.t;++n){e+=g(this[n]^t)}return e};l.prototype.testBit=function(e){var t=Math.floor(e/this.DB);if(t>=this.t){return 0!=this.s}return 0!=(this[t]&1<<e%this.DB)};l.prototype.setBit=function(e){return this.changeBit(e,i)};l.prototype.clearBit=function(e){return this.changeBit(e,d)};l.prototype.flipBit=function(e){return this.changeBit(e,s)};l.prototype.add=function(e){var t=h();this.addTo(e,t);return t};l.prototype.subtract=function(e){var t=h();this.subTo(e,t);return t};l.prototype.multiply=function(e){var t=h();this.multiplyTo(e,t);return t};l.prototype.divide=function(e){var t=h();this.divRemTo(e,t,null);return t};l.prototype.remainder=function(e){var t=h();this.divRemTo(e,null,t);return t};l.prototype.divideAndRemainder=function(e){var t=h(),n=h();this.divRemTo(e,t,n);return[t,n]};l.prototype.modPow=function(o,e){var s=o.bitLength(),a,d=E(1),p;if(0>=s){return d}else if(18>s){a=1}else if(48>s){a=3}else if(144>s){a=4}else if(768>s){a=5}else{a=6}if(8>s){p=new X(e)}else if(e.isEven()){p=new W(e)}else{p=new Q(e)}var l=[],g=3,u=a-1,c=(1<<a)-1;l[1]=p.convert(this);if(1<a){var m=h();p.sqrTo(l[1],m);while(g<=c){l[g]=h();p.mulTo(m,l[g-2],l[g]);g+=2}}var y=o.t-1,f,b=!0,T=h(),S;s=D(o[y])-1;while(0<=y){if(s>=u){f=o[y]>>s-u&c}else{f=(o[y]&(1<<s+1)-1)<<u-s;if(0<y){f|=o[y-1]>>this.DB+s-u}}g=a;while(0==(1&f)){f>>=1;--g}if(0>(s-=g)){s+=this.DB;--y}if(b){l[f].copyTo(d);b=!1}else{while(1<g){p.sqrTo(d,T);p.sqrTo(T,d);g-=2}if(0<g){p.sqrTo(d,T)}else{S=d;d=T;T=S}p.mulTo(T,l[f],d)}while(0<=y&&0==(o[y]&1<<s)){p.sqrTo(d,T);S=d;d=T;T=S;if(0>--s){s=this.DB-1;--y}}}return p.revert(d)};l.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum()){return l.ZERO}var n=e.clone(),o=this.clone(),r=E(1),i=E(0),s=E(0),a=E(1);while(0!=n.signum()){while(n.isEven()){n.rShiftTo(1,n);if(t){if(!r.isEven()||!i.isEven()){r.addTo(this,r);i.subTo(e,i)}r.rShiftTo(1,r)}else if(!i.isEven()){i.subTo(e,i)}i.rShiftTo(1,i)}while(o.isEven()){o.rShiftTo(1,o);if(t){if(!s.isEven()||!a.isEven()){s.addTo(this,s);a.subTo(e,a)}s.rShiftTo(1,s)}else if(!a.isEven()){a.subTo(e,a)}a.rShiftTo(1,a)}if(0<=n.compareTo(o)){n.subTo(o,n);if(t){r.subTo(s,r)}i.subTo(a,i)}else{o.subTo(n,o);if(t){s.subTo(r,s)}a.subTo(i,a)}}if(0!=o.compareTo(l.ONE)){return l.ZERO}if(0<=a.compareTo(e)){return a.subtract(e)}if(0>a.signum()){a.addTo(e,a)}else{return a}if(0>a.signum()){return a.add(e)}else{return a}};l.prototype.pow=function(t){return this.exp(t,new J)};l.prototype.gcd=function(e){var n=0>this.s?this.negate():this.clone(),o=0>e.s?e.negate():e.clone();if(0>n.compareTo(o)){var r=n;n=o;o=r}var t=n.getLowestSetBit(),s=o.getLowestSetBit();if(0>s){return n}if(t<s){s=t}if(0<s){n.rShiftTo(s,n);o.rShiftTo(s,o)}while(0<n.signum()){if(0<(t=n.getLowestSetBit())){n.rShiftTo(t,n)}if(0<(t=o.getLowestSetBit())){o.rShiftTo(t,o)}if(0<=n.compareTo(o)){n.subTo(o,n);n.rShiftTo(1,n)}else{o.subTo(n,o);o.rShiftTo(1,o)}}if(0<s){o.lShiftTo(s,o)}return o};l.prototype.isProbablePrime=function(e){var t,n=this.abs();if(1==n.t&&n[0]<=G[G.length-1]){for(t=0;t<G.length;++t){if(n[0]==G[t]){return!0}}return!1}if(n.isEven()){return!1}t=1;while(t<G.length){var o=G[t],r=t+1;while(r<G.length&&o<Z){o*=G[r++]}o=n.modInt(o);while(t<r){if(0==o%G[t++]){return!1}}}return n.millerRabin(e)};l.prototype.copyTo=function(e){for(var t=this.t-1;0<=t;--t){e[t]=this[t]}e.t=this.t;e.s=this.s};l.prototype.fromInt=function(e){this.t=1;this.s=0>e?-1:0;if(0<e){this[0]=e}else if(-1>e){this[0]=e+this.DV}else{this.t=0}};l.prototype.fromString=function(e,t){var n;if(16==t){n=4}else if(8==t){n=3}else if(256==t){n=8}else if(2==t){n=1}else if(32==t){n=5}else if(4==t){n=2}else{this.fromRadix(e,t);return}this.t=0;this.s=0;var o=e.length,r=!1,s=0;while(0<=--o){var a=8==n?255&+e[o]:S(e,o);if(0>a){if("-"==e.charAt(o)){r=!0}continue}r=!1;if(0==s){this[this.t++]=a}else if(s+n>this.DB){this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s;this[this.t++]=a>>this.DB-s}else{this[this.t-1]|=a<<s}s+=n;if(s>=this.DB){s-=this.DB}}if(8==n&&0!=(128&+e[0])){this.s=-1;if(0<s){this[this.t-1]|=(1<<this.DB-s)-1<<s}}this.clamp();if(r){l.ZERO.subTo(this,this)}};l.prototype.clamp=function(){var e=this.s&this.DM;while(0<this.t&&this[this.t-1]==e){--this.t}};l.prototype.dlShiftTo=function(e,t){var n;for(n=this.t-1;0<=n;--n){t[n+e]=this[n]}for(n=e-1;0<=n;--n){t[n]=0}t.t=this.t+e;t.s=this.s};l.prototype.drShiftTo=function(e,t){for(var n=e;n<this.t;++n){t[n-e]=this[n]}t.t=Math.max(this.t-e,0);t.s=this.s};l.prototype.lShiftTo=function(e,t){for(var n=e%this.DB,o=this.DB-n,r=Math.floor(e/this.DB),s=this.s<<n&this.DM,a=this.t-1;0<=a;--a){t[a+r+1]=this[a]>>o|s;s=(this[a]&(1<<o)-1)<<n}for(var a=r-1;0<=a;--a){t[a]=0}t[r]=s;t.t=this.t+r+1;t.s=this.s;t.clamp()};l.prototype.rShiftTo=function(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}var o=e%this.DB,r=this.DB-o,s=(1<<o)-1;t[0]=this[n]>>o;for(var a=n+1;a<this.t;++a){t[a-n-1]|=(this[a]&s)<<r;t[a-n]=this[a]>>o}if(0<o){t[this.t-n-1]|=(this.s&s)<<r}t.t=this.t-n;t.clamp()};l.prototype.subTo=function(e,t){var n=0,o=0,r=Math.min(e.t,this.t);while(n<r){o+=this[n]-e[n];t[n++]=o&this.DM;o>>=this.DB}if(e.t<this.t){o-=e.s;while(n<this.t){o+=this[n];t[n++]=o&this.DM;o>>=this.DB}o+=this.s}else{o+=this.s;while(n<e.t){o-=e[n];t[n++]=o&this.DM;o>>=this.DB}o-=e.s}t.s=0>o?-1:0;if(-1>o){t[n++]=this.DV+o}else if(0<o){t[n++]=o}t.t=n;t.clamp()};l.prototype.multiplyTo=function(e,t){var n=this.abs(),o=e.abs(),r=n.t;t.t=r+o.t;while(0<=--r){t[r]=0}for(r=0;r<o.t;++r){t[r+n.t]=n.am(0,o[r],t,r,0,n.t)}t.s=0;t.clamp();if(this.s!=e.s){l.ZERO.subTo(t,t)}};l.prototype.squareTo=function(e){var t=this.abs(),n=e.t=2*t.t;while(0<=--n){e[n]=0}for(n=0;n<t.t-1;++n){var o=t.am(n,t[n],e,2*n,0,1);if((e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,o,t.t-n-1))>=t.DV){e[n+t.t]-=t.DV;e[n+t.t+1]=1}}if(0<e.t){e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)}e.s=0;e.clamp()};l.prototype.divRemTo=function(n,o,s){var a=n.abs();if(0>=a.t){return}var d=this.abs();if(d.t<a.t){if(null!=o){o.fromInt(0)}if(null!=s){this.copyTo(s)}return}if(null==s){s=h()}var p=h(),g=this.s,u=n.s,c=this.DB-D(a[a.t-1]);if(0<c){a.lShiftTo(c,p);d.lShiftTo(c,s)}else{a.copyTo(p);d.copyTo(s)}var m=p.t,y=p[m-1];if(0==y){return}var f=y*(1<<this.F1)+(1<m?p[m-2]>>this.F2:0),b=this.FV/f,T=(1<<this.F1)/f,S=1<<this.F2,e=s.t,E=e-m,x=null==o?h():o;p.dlShiftTo(E,x);if(0<=s.compareTo(x)){s[s.t++]=1;s.subTo(x,s)}l.ONE.dlShiftTo(m,x);x.subTo(p,p);while(p.t<m){p[p.t++]=0}while(0<=--E){var t=s[--e]==y?this.DM:Math.floor(s[e]*b+(s[e-1]+S)*T);if((s[e]+=p.am(0,t,s,E,0,m))<t){p.dlShiftTo(E,x);s.subTo(x,s);while(s[e]<--t){s.subTo(x,s)}}}if(null!=o){s.drShiftTo(m,o);if(g!=u){l.ZERO.subTo(o,o)}}s.t=m;s.clamp();if(0<c){s.rShiftTo(c,s)}if(0>g){l.ZERO.subTo(s,s)}};l.prototype.invDigit=function(){if(1>this.t){return 0}var e=this[0];if(0==(1&e)){return 0}var t=3&e;t=15&t*(2-(15&e)*t);t=255&t*(2-(255&e)*t);t=65535&t*(2-(65535&(65535&e)*t));t=t*(2-e*t%this.DV)%this.DV;return 0<t?this.DV-t:-t};l.prototype.isEven=function(){return 0==(0<this.t?1&this[0]:this.s)};l.prototype.exp=function(n,e){if(4294967295<n||1>n){return l.ONE}var o=h(),s=h(),a=e.convert(this),d=D(n)-1;a.copyTo(o);while(0<=--d){e.sqrTo(o,s);if(0<(n&1<<d)){e.mulTo(s,a,o)}else{var p=o;o=s;s=p}}return e.revert(o)};l.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))};l.prototype.toRadix=function(e){if(null==e){e=10}if(0==this.signum()||2>e||36<e){return"0"}var t=this.chunkSize(e),n=Math.pow(e,t),o=E(n),i=h(),s=h(),a="";this.divRemTo(o,i,s);while(0<i.signum()){a=(n+s.intValue()).toString(e).substr(1)+a;i.divRemTo(o,i,s)}return s.intValue().toString(e)+a};l.prototype.fromRadix=function(e,t){this.fromInt(0);if(null==t){t=10}for(var n=this.chunkSize(t),o=Math.pow(t,n),r=!1,s=0,a=0,d=0,p;d<e.length;++d){p=S(e,d);if(0>p){if("-"==e.charAt(d)&&0==this.signum()){r=!0}continue}a=t*a+p;if(++s>=n){this.dMultiply(o);this.dAddOffset(a,0);s=0;a=0}}if(0<s){this.dMultiply(Math.pow(t,s));this.dAddOffset(a,0)}if(r){l.ZERO.subTo(this,this)}};l.prototype.fromNumber=function(e,n,o){if("number"==typeof n){if(2>e){this.fromInt(1)}else{this.fromNumber(e,o);if(!this.testBit(e-1)){this.bitwiseTo(l.ONE.shiftLeft(e-1),i,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(n)){this.dAddOffset(2,0);if(this.bitLength()>e){this.subTo(l.ONE.shiftLeft(e-1),this)}}}}else{var r=[],s=7&e;r.length=(e>>3)+1;n.nextBytes(r);if(0<s){r[0]&=(1<<s)-1}else{r[0]=0}this.fromString(r,256)}};l.prototype.bitwiseTo=function(e,t,n){var o,r,s=Math.min(e.t,this.t);for(o=0;o<s;++o){n[o]=t(this[o],e[o])}if(e.t<this.t){r=e.s&this.DM;for(o=s;o<this.t;++o){n[o]=t(this[o],r)}n.t=this.t}else{r=this.s&this.DM;for(o=s;o<e.t;++o){n[o]=t(r,e[o])}n.t=e.t}n.s=t(this.s,e.s);n.clamp()};l.prototype.changeBit=function(e,t){var n=l.ONE.shiftLeft(e);this.bitwiseTo(n,t,n);return n};l.prototype.addTo=function(e,t){var n=0,o=0,r=Math.min(e.t,this.t);while(n<r){o+=this[n]+e[n];t[n++]=o&this.DM;o>>=this.DB}if(e.t<this.t){o+=e.s;while(n<this.t){o+=this[n];t[n++]=o&this.DM;o>>=this.DB}o+=this.s}else{o+=this.s;while(n<e.t){o+=e[n];t[n++]=o&this.DM;o>>=this.DB}o+=e.s}t.s=0>o?-1:0;if(0<o){t[n++]=o}else if(-1>o){t[n++]=this.DV+o}t.t=n;t.clamp()};l.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t);++this.t;this.clamp()};l.prototype.dAddOffset=function(e,t){if(0==e){return}while(this.t<=t){this[this.t++]=0}this[t]+=e;while(this[t]>=this.DV){this[t]-=this.DV;if(++t>=this.t){this[this.t++]=0}++this[t]}};l.prototype.multiplyLowerTo=function(e,t,n){var o=Math.min(this.t+e.t,t);n.s=0;n.t=o;while(0<o){n[--o]=0}for(var r=n.t-this.t;o<r;++o){n[o+this.t]=this.am(0,e[o],n,o,0,this.t)}for(var r=Math.min(e.t,t);o<r;++o){this.am(0,e[o],n,o,0,t-o)}n.clamp()};l.prototype.multiplyUpperTo=function(e,t,o){--t;var r=o.t=this.t+e.t-t;o.s=0;while(0<=--r){o[r]=0}for(r=Math.max(t-this.t,0);r<e.t;++r){o[this.t+r-t]=this.am(t-r,e[r],o,0,0,this.t+r-t)}o.clamp();o.drShiftTo(1,o)};l.prototype.modInt=function(e){if(0>=e){return 0}var t=this.DV%e,n=0>this.s?e-1:0;if(0<this.t){if(0==t){n=this[0]%e}else{for(var o=this.t-1;0<=o;--o){n=(t*n+this[o])%e}}}return n};l.prototype.millerRabin=function(e){var n=this.subtract(l.ONE),o=n.getLowestSetBit();if(0>=o){return!1}var s=n.shiftRight(o);e=e+1>>1;if(e>G.length){e=G.length}for(var r=h(),a=0;a<e;++a){r.fromInt(G[Math.floor(Math.random()*G.length)]);var d=r.modPow(s,this);if(0!=d.compareTo(l.ONE)&&0!=d.compareTo(n)){var p=1;while(p++<o&&0!=d.compareTo(n)){d=d.modPowInt(2,this);if(0==d.compareTo(l.ONE)){return!1}}if(0!=d.compareTo(n)){return!1}}}return!0};l.prototype.square=function(){var e=h();this.squareTo(e);return e};l.prototype.gcda=function(e,n){var o=0>this.s?this.negate():this.clone(),r=0>e.s?e.negate():e.clone();if(0>o.compareTo(r)){var s=o;o=r;r=s}var t=o.getLowestSetBit(),a=r.getLowestSetBit();if(0>a){n(o);return}if(t<a){a=t}if(0<a){o.rShiftTo(a,o);r.rShiftTo(a,r)}var d=function(){if(0<(t=o.getLowestSetBit())){o.rShiftTo(t,o)}if(0<(t=r.getLowestSetBit())){r.rShiftTo(t,r)}if(0<=o.compareTo(r)){o.subTo(r,o);o.rShiftTo(1,o)}else{r.subTo(o,r);r.rShiftTo(1,r)}if(!(0<o.signum())){if(0<a){r.lShiftTo(a,r)}setTimeout(function(){n(r)},0)}else{setTimeout(d,0)}};setTimeout(d,10)};l.prototype.fromNumberAsync=function(e,n,o,r){if("number"==typeof n){if(2>e){this.fromInt(1)}else{this.fromNumber(e,o);if(!this.testBit(e-1)){this.bitwiseTo(l.ONE.shiftLeft(e-1),i,this)}if(this.isEven()){this.dAddOffset(1,0)}var s=this,a=function(){s.dAddOffset(2,0);if(s.bitLength()>e){s.subTo(l.ONE.shiftLeft(e-1),s)}if(s.isProbablePrime(n)){setTimeout(function(){r()},0)}else{setTimeout(a,0)}};setTimeout(a,0)}}else{var d=[],p=7&e;d.length=(e>>3)+1;n.nextBytes(d);if(0<p){d[0]&=(1<<p)-1}else{d[0]=0}this.fromString(d,256)}};return l}(),J=function(){function e(){}e.prototype.convert=function(e){return e};e.prototype.revert=function(e){return e};e.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n)};e.prototype.sqrTo=function(e,t){e.squareTo(t)};return e}(),X=function(){function e(e){this.m=e}e.prototype.convert=function(e){if(0>e.s||0<=e.compareTo(this.m)){return e.mod(this.m)}else{return e}};e.prototype.revert=function(e){return e};e.prototype.reduce=function(e){e.divRemTo(this.m,null,e)};e.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n);this.reduce(n)};e.prototype.sqrTo=function(e,t){e.squareTo(t);this.reduce(t)};return e}(),Q=function(){function e(e){this.m=e;this.mp=e.invDigit();this.mpl=32767&this.mp;this.mph=this.mp>>15;this.um=(1<<e.DB-15)-1;this.mt2=2*e.t}e.prototype.convert=function(e){var t=h();e.abs().dlShiftTo(this.m.t,t);t.divRemTo(this.m,null,t);if(0>e.s&&0<t.compareTo(Y.ZERO)){this.m.subTo(t,t)}return t};e.prototype.revert=function(e){var t=h();e.copyTo(t);this.reduce(t);return t};e.prototype.reduce=function(e){while(e.t<=this.mt2){e[e.t++]=0}for(var t=0;t<this.m.t;++t){var n=32767&e[t],o=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;n=t+this.m.t;e[n]+=this.m.am(0,o,e,t,0,this.m.t);while(e[n]>=e.DV){e[n]-=e.DV;e[++n]++}}e.clamp();e.drShiftTo(this.m.t,e);if(0<=e.compareTo(this.m)){e.subTo(this.m,e)}};e.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n);this.reduce(n)};e.prototype.sqrTo=function(e,t){e.squareTo(t);this.reduce(t)};return e}(),W=function(){function e(e){this.m=e;this.r2=h();this.q3=h();Y.ONE.dlShiftTo(2*e.t,this.r2);this.mu=this.r2.divide(e)}e.prototype.convert=function(e){if(0>e.s||e.t>2*this.m.t){return e.mod(this.m)}else if(0>e.compareTo(this.m)){return e}else{var t=h();e.copyTo(t);this.reduce(t);return t}};e.prototype.revert=function(e){return e};e.prototype.reduce=function(e){e.drShiftTo(this.m.t-1,this.r2);if(e.t>this.m.t+1){e.t=this.m.t+1;e.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(0>e.compareTo(this.r2)){e.dAddOffset(1,this.m.t+1)}e.subTo(this.r2,e);while(0<=e.compareTo(this.m)){e.subTo(this.m,e)}};e.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n);this.reduce(n)};e.prototype.sqrTo=function(e,t){e.squareTo(t);this.reduce(t)};return e}();function h(){return new Y(null)}function y(e,t){return new Y(e,t)}function f(e,t,o,r,s,a){while(0<=--a){var d=t*this[e++]+o[r]+s;s=Math.floor(d/67108864);o[r++]=67108863&d}return s}function b(e,t,o,r,s,a){var d=32767&t,p=t>>15;while(0<=--a){var g=32767&this[e],u=this[e++]>>15,h=p*g+u*d;g=d*g+((32767&h)<<15)+o[r]+(1073741823&s);s=(g>>>30)+(h>>>15)+p*u+(s>>>30);o[r++]=1073741823&g}return s}function T(e,t,o,r,s,a){var d=16383&t,p=t>>14;while(0<=--a){var g=16383&this[e],u=this[e++]>>14,h=p*g+u*d;g=d*g+((16383&h)<<14)+o[r]+s;s=(g>>28)+(h>>14)+p*u;o[r++]=268435455&g}return s}if(_&&"Microsoft Internet Explorer"==navigator.appName){Y.prototype.am=b;U=30}else if(_&&"Netscape"!=navigator.appName){Y.prototype.am=f;U=26}else{Y.prototype.am=T;U=28}Y.prototype.DB=U;Y.prototype.DM=(1<<U)-1;Y.prototype.DV=1<<U;Y.prototype.FV=Math.pow(2,52);Y.prototype.F1=52-U;Y.prototype.F2=2*U-52;var $=[],ee,r;ee=48;for(r=0;9>=r;++r){$[ee++]=r}ee=97;for(r=10;36>r;++r){$[ee++]=r}ee=65;for(r=10;36>r;++r){$[ee++]=r}function S(e,t){var n=$[e.charCodeAt(t)];return null==n?-1:n}function E(e){var t=h();t.fromInt(e);return t}function D(e){var n=1,o;if(0!=(o=e>>>16)){e=o;n+=16}if(0!=(o=e>>8)){e=o;n+=8}if(0!=(o=e>>4)){e=o;n+=4}if(0!=(o=e>>2)){e=o;n+=2}if(0!=(o=e>>1)){e=o;n+=1}return n}Y.ZERO=E(0);Y.ONE=E(1);var a=function(){function e(){this.i=0;this.j=0;this.S=[]}e.prototype.init=function(e){var n,o,r;for(n=0;256>n;++n){this.S[n]=n}o=0;for(n=0;256>n;++n){o=255&o+this.S[n]+e[n%e.length];r=this.S[n];this.S[n]=this.S[o];this.S[o]=r}this.i=0;this.j=0};e.prototype.next=function(){var e;this.i=255&this.i+1;this.j=255&this.j+this.S[this.i];e=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=e;return this.S[255&e+this.S[this.i]]};return e}();function x(){return new a}var v,te=null,ne;if(null==te){te=[];ne=0;var oe;if(window.crypto&&window.crypto.getRandomValues){var re=new Uint32Array(256);window.crypto.getRandomValues(re);for(oe=0;oe<re.length;++oe){te[ne++]=255&re[oe]}}var z=function(e){this.count=this.count||0;if(256<=this.count||ne>=256){if(window.removeEventListener){window.removeEventListener("mousemove",z,!1)}else if(window.detachEvent){window.detachEvent("onmousemove",z)}return}try{var t=e.x+e.y;te[ne++]=255&t;this.count+=1}catch(t){}};if(window.addEventListener){window.addEventListener("mousemove",z,!1)}else if(window.attachEvent){window.attachEvent("onmousemove",z)}}function R(){if(null==v){v=x();while(ne<256){var e=Math.floor(65536*Math.random());te[ne++]=255&e}v.init(te);for(ne=0;ne<te.length;++ne){te[ne]=0}ne=0}return v.next()}var ie=function(){function e(){}e.prototype.nextBytes=function(e){for(var t=0;t<e.length;++t){e[t]=R()}};return e}();function B(e,t){if(t<e.length+22){console.error("Message too long for RSA");return null}for(var n=t-e.length-6,o="",r=0;r<n;r+=2){o+="ff"}var i="0001"+o+"00"+e;return y(i,16)}function V(e,t){if(t<e.length+11){console.error("Message too long for RSA");return null}var o=[],r=e.length-1;while(0<=r&&0<t){var s=e.charCodeAt(r--);if(128>s){o[--t]=s}else if(127<s&&2048>s){o[--t]=128|63&s;o[--t]=192|s>>6}else{o[--t]=128|63&s;o[--t]=128|63&s>>6;o[--t]=224|s>>12}}o[--t]=0;var a=new ie,d=[];while(2<t){d[0]=0;while(0==d[0]){a.nextBytes(d)}o[--t]=d[0]}o[--t]=2;o[--t]=0;return new Y(o)}var se=function(){function e(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null}e.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)};e.prototype.doPrivate=function(e){if(null==this.p||null==this.q){return e.modPow(this.d,this.n)}var t=e.mod(this.p).modPow(this.dmp1,this.p),n=e.mod(this.q).modPow(this.dmq1,this.q);while(0>t.compareTo(n)){t=t.add(this.p)}return t.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)};e.prototype.setPublic=function(e,t){if(null!=e&&null!=t&&0<e.length&&0<t.length){this.n=y(e,16);this.e=parseInt(t,16)}else{console.error("Invalid RSA public key")}};e.prototype.encrypt=function(e){var t=V(e,this.n.bitLength()+7>>3);if(null==t){return null}var n=this.doPublic(t);if(null==n){return null}var o=n.toString(16);if(0==(1&o.length)){return o}else{return"0"+o}};e.prototype.setPrivate=function(e,t,n){if(null!=e&&null!=t&&0<e.length&&0<t.length){this.n=y(e,16);this.e=parseInt(t,16);this.d=y(n,16)}else{console.error("Invalid RSA private key")}};e.prototype.setPrivateEx=function(e,t,n,o,r,i,s,a){if(null!=e&&null!=t&&0<e.length&&0<t.length){this.n=y(e,16);this.e=parseInt(t,16);this.d=y(n,16);this.p=y(o,16);this.q=y(r,16);this.dmp1=y(i,16);this.dmq1=y(s,16);this.coeff=y(a,16)}else{console.error("Invalid RSA private key")}};e.prototype.generate=function(e,n){var o=new ie,r=e>>1;this.e=parseInt(n,16);var i=new Y(n,16);for(;;){for(;;){this.p=new Y(e-r,1,o);if(0==this.p.subtract(Y.ONE).gcd(i).compareTo(Y.ONE)&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new Y(r,1,o);if(0==this.q.subtract(Y.ONE).gcd(i).compareTo(Y.ONE)&&this.q.isProbablePrime(10)){break}}if(0>=this.p.compareTo(this.q)){var s=this.p;this.p=this.q;this.q=s}var t=this.p.subtract(Y.ONE),a=this.q.subtract(Y.ONE),d=t.multiply(a);if(0==d.gcd(i).compareTo(Y.ONE)){this.n=this.p.multiply(this.q);this.d=i.modInverse(d);this.dmp1=this.d.mod(t);this.dmq1=this.d.mod(a);this.coeff=this.q.modInverse(this.p);break}}};e.prototype.decrypt=function(e){var t=y(e,16),n=this.doPrivate(t);if(null==n){return null}return O(n,this.n.bitLength()+7>>3)};e.prototype.generateAsync=function(e,t,n){var o=new ie,r=e>>1;this.e=parseInt(t,16);var i=new Y(t,16),s=this,a=function(){var t=function(){if(0>=s.p.compareTo(s.q)){var e=s.p;s.p=s.q;s.q=e}var t=s.p.subtract(Y.ONE),o=s.q.subtract(Y.ONE),r=t.multiply(o);if(0==r.gcd(i).compareTo(Y.ONE)){s.n=s.p.multiply(s.q);s.d=i.modInverse(r);s.dmp1=s.d.mod(t);s.dmq1=s.d.mod(o);s.coeff=s.q.modInverse(s.p);setTimeout(function(){n()},0)}else{setTimeout(a,0)}},d=function(){s.q=h();s.q.fromNumberAsync(r,1,o,function(){s.q.subtract(Y.ONE).gcda(i,function(e){if(0==e.compareTo(Y.ONE)&&s.q.isProbablePrime(10)){setTimeout(t,0)}else{setTimeout(d,0)}})})},p=function(){s.p=h();s.p.fromNumberAsync(e-r,1,o,function(){s.p.subtract(Y.ONE).gcda(i,function(e){if(0==e.compareTo(Y.ONE)&&s.p.isProbablePrime(10)){setTimeout(d,0)}else{setTimeout(p,0)}})})};setTimeout(p,0)};setTimeout(a,0)};e.prototype.sign=function(e,t,n){var o=A(n),r=o+t(e).toString(),i=B(r,this.n.bitLength()/4);if(null==i){return null}var s=this.doPrivate(i);if(null==s){return null}var a=s.toString(16);if(0==(1&a.length)){return a}else{return"0"+a}};e.prototype.verify=function(e,t,n){var o=y(t,16),r=this.doPublic(o);if(null==r){return null}var i=r.toString(16).replace(/^1f+00/,""),s=N(i);return s==n(e).toString()};return e}();function O(e,t){var n=e.toByteArray(),o=0;while(o<n.length&&0==n[o]){++o}if(n.length-o!=t-1||2!=n[o]){return null}++o;while(0!=n[o]){if(++o>=n.length){return null}}var r="";while(++o<n.length){var s=255&n[o];if(128>s){r+=String.fromCharCode(s)}else if(191<s&&224>s){r+=String.fromCharCode((31&s)<<6|63&n[o+1]);++o}else{r+=String.fromCharCode((15&s)<<12|(63&n[o+1])<<6|63&n[o+2]);o+=2}}return r}var ae={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"};function A(e){return ae[e]||""}function N(e){for(var t in ae){if(ae.hasOwnProperty(t)){var n=ae[t],o=n.length;if(e.substr(0,o)==n){return e.substr(o)}}}return e}var de={lang:{extend:function extend(e,t,n){if(!t||!e){throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.")}var o=function(){};o.prototype=t.prototype;e.prototype=new o;e.prototype.constructor=e;e.superclass=t.prototype;if(t.prototype.constructor==Object.prototype.constructor){t.prototype.constructor=t}if(n){for(var a in n){e.prototype[a]=n[a]}var r=function(){},d=["toString","valueOf"];try{if(/MSIE/.test(navigator.userAgent)){r=function(e,t){for(a=0;a<d.length;a=a+1){var n=d[a],o=t[n];if("function"==typeof o&&o!=Object.prototype[n]){e[n]=o}}}}}catch(e){}r(e.prototype,n)}}}},pe={};if("undefined"==typeof pe.asn1||!pe.asn1)pe.asn1={};pe.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);if(1==t.length%2)t="0"+t;return t};this.bigIntToMinTwosComplementsHex=function(e){var t=e.toString(16);if("-"!=t.substr(0,1)){if(1==t.length%2){t="0"+t}else{if(!t.match(/^[0-7]/)){t="00"+t}}}else{var n=t.substr(1),o=n.length;if(1==o%2){o+=1}else{if(!t.match(/^[0-7]/)){o+=2}}for(var r="",s=0;s<o;s++){r+="f"}var a=new Y(r,16),d=a.xor(e).add(Y.ONE);t=d.toString(16).replace(/^-/,"")}return t};this.getPEMStringFromHex=function(e,t){return hextopem(e,t)};this.newObject=function(e){var t=pe.asn1,n=t.DERBoolean,o=t.DERInteger,r=t.DERBitString,s=t.DEROctetString,d=t.DERNull,p=t.DERObjectIdentifier,g=t.DEREnumerated,l=t.DERUTF8String,u=t.DERNumericString,c=t.DERPrintableString,m=t.DERTeletexString,h=t.DERIA5String,y=t.DERUTCTime,f=t.DERGeneralizedTime,b=t.DERSequence,T=t.DERSet,S=t.DERTaggedObject,E=t.ASN1Util.newObject,D=Object.keys(e);if(1!=D.length)throw"key of param shall be only one.";var x=D[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+x+":"))throw"undefined key: "+x;if("bool"==x)return new n(e[x]);if("int"==x)return new o(e[x]);if("bitstr"==x)return new r(e[x]);if("octstr"==x)return new s(e[x]);if("null"==x)return new d(e[x]);if("oid"==x)return new p(e[x]);if("enum"==x)return new g(e[x]);if("utf8str"==x)return new l(e[x]);if("numstr"==x)return new u(e[x]);if("prnstr"==x)return new c(e[x]);if("telstr"==x)return new m(e[x]);if("ia5str"==x)return new h(e[x]);if("utctime"==x)return new y(e[x]);if("gentime"==x)return new f(e[x]);if("seq"==x){for(var R=e[x],B=[],V=0,O;V<R.length;V++){O=E(R[V]);B.push(O)}return new b({array:B})}if("set"==x){for(var R=e[x],B=[],V=0,O;V<R.length;V++){O=E(R[V]);B.push(O)}return new T({array:B})}if("tag"==x){var A=e[x];if("[object Array]"===Object.prototype.toString.call(A)&&3==A.length){var N=E(A[2]);return new S({tag:A[0],explicit:A[1],obj:N})}else{var v={};if(A.explicit!==void 0)v.explicit=A.explicit;if(A.tag!==void 0)v.tag=A.tag;if(A.obj===void 0)throw"obj shall be specified for 'tag'.";v.obj=E(A.obj);return new S(v)}}};this.jsonToASN1HEX=function(e){var t=this.newObject(e);return t.getEncodedHex()}};pe.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",n=parseInt(e.substr(0,2),16),o=Math.floor(n/40),t=o+"."+n%40,r="",a=2;a<e.length;a+=2){var d=parseInt(e.substr(a,2),16),p=("00000000"+d.toString(2)).slice(-8);r=r+p.substr(1,7);if("0"==p.substr(0,1)){var g=new Y(r,2);t=t+"."+g.toString(10);r=""}}return t};pe.asn1.ASN1Util.oidIntToHex=function(e){var t=function(e){var t=e.toString(16);if(1==t.length)t="0"+t;return t},n=function(e){var n="",o=new Y(e,10),r=o.toString(2),s=7-r.length%7;if(7==s)s=0;for(var a="",d=0;d<s;d++){a+="0"}r=a+r;for(var d=0,p;d<r.length-1;d+=7){p=r.substr(d,7);if(d!=r.length-7)p="1"+p;n+=t(parseInt(p,2))}return n};if(!e.match(/^[0-9.]+$/)){throw"malformed oid string: "+e}var o="",r=e.split("."),s=40*parseInt(r[0])+parseInt(r[1]);o+=t(s);r.splice(0,2);for(var a=0;a<r.length;a++){o+=n(r[a])}return o};pe.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if("undefined"==typeof this.hV||null==this.hV){throw"this.hV is null or undefined."}if(1==this.hV.length%2){throw"value hex must be even length: n="+"".length+",v="+this.hV}var e=this.hV.length/2,t=e.toString(16);if(1==t.length%2){t="0"+t}if(128>e){return t}else{var n=t.length/2;if(15<n){throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16)}return(128+n).toString(16)+t}};this.getEncodedHex=function(){if(null==this.hTLV||this.isModified){this.hV=this.getFreshValueHex();this.hL=this.getLengthHexFromValue();this.hTLV=this.hT+this.hL+this.hV;this.isModified=!1}return this.hTLV};this.getValueHex=function(){this.getEncodedHex();return this.hV};this.getFreshValueHex=function(){return""}};pe.asn1.DERAbstractString=function(e){pe.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s};this.setString=function(e){this.hTLV=null;this.isModified=!0;this.s=e;this.hV=stohex(this.s)};this.setStringHex=function(e){this.hTLV=null;this.isModified=!0;this.s=null;this.hV=e};this.getFreshValueHex=function(){return this.hV};if("undefined"!=typeof e){if("string"==typeof e){this.setString(e)}else if("undefined"!=typeof e.str){this.setString(e.str)}else if("undefined"!=typeof e.hex){this.setStringHex(e.hex)}}};de.lang.extend(pe.asn1.DERAbstractString,pe.asn1.ASN1Object);pe.asn1.DERAbstractTime=function(){pe.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(e){utc=e.getTime()+6e4*e.getTimezoneOffset();var t=new Date(utc);return t};this.formatDate=function(e,t,n){var o=this.zeroPadding,r=this.localDateToUTC(e),i=r.getFullYear()+"";if("utc"==t)i=i.substr(2,2);var a=o(r.getMonth()+1+"",2),d=o(r.getDate()+"",2),p=o(r.getHours()+"",2),g=o(r.getMinutes()+"",2),l=o(r.getSeconds()+"",2),u=i+a+d+p+g+l;if(!0===n){var c=r.getMilliseconds();if(0!=c){var m=o(c+"",3);m=m.replace(/[0]+$/,"");u=u+"."+m}}return u+"Z"};this.zeroPadding=function(e,t){if(e.length>=t)return e;return Array(t-e.length+1).join("0")+e};this.getString=function(){return this.s};this.setString=function(e){this.hTLV=null;this.isModified=!0;this.s=e;this.hV=stohex(e)};this.setByDateValue=function(e,t,n,o,r,i){var s=new Date(Date.UTC(e,t-1,n,o,r,i,0));this.setByDate(s)};this.getFreshValueHex=function(){return this.hV}};de.lang.extend(pe.asn1.DERAbstractTime,pe.asn1.ASN1Object);pe.asn1.DERAbstractStructured=function(e){pe.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(e){this.hTLV=null;this.isModified=!0;this.asn1Array=e};this.appendASN1Object=function(e){this.hTLV=null;this.isModified=!0;this.asn1Array.push(e)};this.asn1Array=[];if("undefined"!=typeof e){if("undefined"!=typeof e.array){this.asn1Array=e.array}}};de.lang.extend(pe.asn1.DERAbstractStructured,pe.asn1.ASN1Object);pe.asn1.DERBoolean=function(){pe.asn1.DERBoolean.superclass.constructor.call(this);this.hT="01";this.hTLV="0101ff"};de.lang.extend(pe.asn1.DERBoolean,pe.asn1.ASN1Object);pe.asn1.DERInteger=function(e){pe.asn1.DERInteger.superclass.constructor.call(this);this.hT="02";this.setByBigInteger=function(e){this.hTLV=null;this.isModified=!0;this.hV=pe.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)};this.setByInteger=function(e){var t=new Y(e+"",10);this.setByBigInteger(t)};this.setValueHex=function(e){this.hV=e};this.getFreshValueHex=function(){return this.hV};if("undefined"!=typeof e){if("undefined"!=typeof e.bigint){this.setByBigInteger(e.bigint)}else if("undefined"!=typeof e.int){this.setByInteger(e.int)}else if("number"==typeof e){this.setByInteger(e)}else if("undefined"!=typeof e.hex){this.setValueHex(e.hex)}}};de.lang.extend(pe.asn1.DERInteger,pe.asn1.ASN1Object);pe.asn1.DERBitString=function(e){if(e!==void 0&&"undefined"!=typeof e.obj){var t=pe.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.getEncodedHex()}pe.asn1.DERBitString.superclass.constructor.call(this);this.hT="03";this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null;this.isModified=!0;this.hV=e};this.setUnusedBitsAndHexValue=function(e,t){if(0>e||7<e){throw"unused bits shall be from 0 to 7: u = "+e}this.hTLV=null;this.isModified=!0;this.hV="0"+e+t};this.setByBinaryString=function(e){e=e.replace(/0+$/,"");var t=8-e.length%8;if(8==t)t=0;for(var n=0;n<=t;n++){e+="0"}for(var o="",n=0;n<e.length-1;n+=8){var r=e.substr(n,8),s=parseInt(r,2).toString(16);if(1==s.length)s="0"+s;o+=s}this.hTLV=null;this.isModified=!0;this.hV="0"+t+o};this.setByBooleanArray=function(e){for(var t="",n=0;n<e.length;n++){if(!0==e[n]){t+="1"}else{t+="0"}}this.setByBinaryString(t)};this.newFalseArray=function(e){for(var t=Array(e),n=0;n<e;n++){t[n]=!1}return t};this.getFreshValueHex=function(){return this.hV};if("undefined"!=typeof e){if("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)){this.setHexValueIncludingUnusedBits(e)}else if("undefined"!=typeof e.hex){this.setHexValueIncludingUnusedBits(e.hex)}else if("undefined"!=typeof e.bin){this.setByBinaryString(e.bin)}else if("undefined"!=typeof e.array){this.setByBooleanArray(e.array)}}};de.lang.extend(pe.asn1.DERBitString,pe.asn1.ASN1Object);pe.asn1.DEROctetString=function(e){if(e!==void 0&&"undefined"!=typeof e.obj){var t=pe.asn1.ASN1Util.newObject(e.obj);e.hex=t.getEncodedHex()}pe.asn1.DEROctetString.superclass.constructor.call(this,e);this.hT="04"};de.lang.extend(pe.asn1.DEROctetString,pe.asn1.DERAbstractString);pe.asn1.DERNull=function(){pe.asn1.DERNull.superclass.constructor.call(this);this.hT="05";this.hTLV="0500"};de.lang.extend(pe.asn1.DERNull,pe.asn1.ASN1Object);pe.asn1.DERObjectIdentifier=function(e){var t=function(e){var t=e.toString(16);if(1==t.length)t="0"+t;return t},n=function(e){var n="",o=new Y(e,10),r=o.toString(2),s=7-r.length%7;if(7==s)s=0;for(var a="",d=0;d<s;d++){a+="0"}r=a+r;for(var d=0,p;d<r.length-1;d+=7){p=r.substr(d,7);if(d!=r.length-7)p="1"+p;n+=t(parseInt(p,2))}return n};pe.asn1.DERObjectIdentifier.superclass.constructor.call(this);this.hT="06";this.setValueHex=function(e){this.hTLV=null;this.isModified=!0;this.s=null;this.hV=e};this.setValueOidString=function(e){if(!e.match(/^[0-9.]+$/)){throw"malformed oid string: "+e}var o="",r=e.split("."),s=40*parseInt(r[0])+parseInt(r[1]);o+=t(s);r.splice(0,2);for(var a=0;a<r.length;a++){o+=n(r[a])}this.hTLV=null;this.isModified=!0;this.s=null;this.hV=o};this.setValueName=function(e){var t=pe.asn1.x509.OID.name2oid(e);if(""!==t){this.setValueOidString(t)}else{throw"DERObjectIdentifier oidName undefined: "+e}};this.getFreshValueHex=function(){return this.hV};if(e!==void 0){if("string"==typeof e){if(e.match(/^[0-2].[0-9.]+$/)){this.setValueOidString(e)}else{this.setValueName(e)}}else if(e.oid!==void 0){this.setValueOidString(e.oid)}else if(e.hex!==void 0){this.setValueHex(e.hex)}else if(e.name!==void 0){this.setValueName(e.name)}}};de.lang.extend(pe.asn1.DERObjectIdentifier,pe.asn1.ASN1Object);pe.asn1.DEREnumerated=function(e){pe.asn1.DEREnumerated.superclass.constructor.call(this);this.hT="0a";this.setByBigInteger=function(e){this.hTLV=null;this.isModified=!0;this.hV=pe.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)};this.setByInteger=function(e){var t=new Y(e+"",10);this.setByBigInteger(t)};this.setValueHex=function(e){this.hV=e};this.getFreshValueHex=function(){return this.hV};if("undefined"!=typeof e){if("undefined"!=typeof e.int){this.setByInteger(e.int)}else if("number"==typeof e){this.setByInteger(e)}else if("undefined"!=typeof e.hex){this.setValueHex(e.hex)}}};de.lang.extend(pe.asn1.DEREnumerated,pe.asn1.ASN1Object);pe.asn1.DERUTF8String=function(e){pe.asn1.DERUTF8String.superclass.constructor.call(this,e);this.hT="0c"};de.lang.extend(pe.asn1.DERUTF8String,pe.asn1.DERAbstractString);pe.asn1.DERNumericString=function(e){pe.asn1.DERNumericString.superclass.constructor.call(this,e);this.hT="12"};de.lang.extend(pe.asn1.DERNumericString,pe.asn1.DERAbstractString);pe.asn1.DERPrintableString=function(e){pe.asn1.DERPrintableString.superclass.constructor.call(this,e);this.hT="13"};de.lang.extend(pe.asn1.DERPrintableString,pe.asn1.DERAbstractString);pe.asn1.DERTeletexString=function(e){pe.asn1.DERTeletexString.superclass.constructor.call(this,e);this.hT="14"};de.lang.extend(pe.asn1.DERTeletexString,pe.asn1.DERAbstractString);pe.asn1.DERIA5String=function(e){pe.asn1.DERIA5String.superclass.constructor.call(this,e);this.hT="16"};de.lang.extend(pe.asn1.DERIA5String,pe.asn1.DERAbstractString);pe.asn1.DERUTCTime=function(e){pe.asn1.DERUTCTime.superclass.constructor.call(this,e);this.hT="17";this.setByDate=function(e){this.hTLV=null;this.isModified=!0;this.date=e;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)};this.getFreshValueHex=function(){if("undefined"==typeof this.date&&"undefined"==typeof this.s){this.date=new Date;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)}return this.hV};if(e!==void 0){if(e.str!==void 0){this.setString(e.str)}else if("string"==typeof e&&e.match(/^[0-9]{12}Z$/)){this.setString(e)}else if(e.hex!==void 0){this.setStringHex(e.hex)}else if(e.date!==void 0){this.setByDate(e.date)}}};de.lang.extend(pe.asn1.DERUTCTime,pe.asn1.DERAbstractTime);pe.asn1.DERGeneralizedTime=function(e){pe.asn1.DERGeneralizedTime.superclass.constructor.call(this,e);this.hT="18";this.withMillis=!1;this.setByDate=function(e){this.hTLV=null;this.isModified=!0;this.date=e;this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)};this.getFreshValueHex=function(){if(this.date===void 0&&this.s===void 0){this.date=new Date;this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)}return this.hV};if(e!==void 0){if(e.str!==void 0){this.setString(e.str)}else if("string"==typeof e&&e.match(/^[0-9]{14}Z$/)){this.setString(e)}else if(e.hex!==void 0){this.setStringHex(e.hex)}else if(e.date!==void 0){this.setByDate(e.date)}if(!0===e.millis){this.withMillis=!0}}};de.lang.extend(pe.asn1.DERGeneralizedTime,pe.asn1.DERAbstractTime);pe.asn1.DERSequence=function(e){pe.asn1.DERSequence.superclass.constructor.call(this,e);this.hT="30";this.getFreshValueHex=function(){for(var e="",t=0,n;t<this.asn1Array.length;t++){n=this.asn1Array[t];e+=n.getEncodedHex()}this.hV=e;return this.hV}};de.lang.extend(pe.asn1.DERSequence,pe.asn1.DERAbstractStructured);pe.asn1.DERSet=function(e){pe.asn1.DERSet.superclass.constructor.call(this,e);this.hT="31";this.sortFlag=!0;this.getFreshValueHex=function(){for(var e=[],t=0,n;t<this.asn1Array.length;t++){n=this.asn1Array[t];e.push(n.getEncodedHex())}if(!0==this.sortFlag)e.sort();this.hV=e.join("");return this.hV};if("undefined"!=typeof e){if("undefined"!=typeof e.sortflag&&!1==e.sortflag)this.sortFlag=!1}};de.lang.extend(pe.asn1.DERSet,pe.asn1.DERAbstractStructured);pe.asn1.DERTaggedObject=function(e){pe.asn1.DERTaggedObject.superclass.constructor.call(this);this.hT="a0";this.hV="";this.isExplicit=!0;this.asn1Object=null;this.setASN1Object=function(e,t,n){this.hT=t;this.isExplicit=e;this.asn1Object=n;if(this.isExplicit){this.hV=this.asn1Object.getEncodedHex();this.hTLV=null;this.isModified=!0}else{this.hV=null;this.hTLV=n.getEncodedHex();this.hTLV=this.hTLV.replace(/^../,t);this.isModified=!1}};this.getFreshValueHex=function(){return this.hV};if("undefined"!=typeof e){if("undefined"!=typeof e.tag){this.hT=e.tag}if("undefined"!=typeof e.explicit){this.isExplicit=e.explicit}if("undefined"!=typeof e.obj){this.asn1Object=e.obj;this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)}}};de.lang.extend(pe.asn1.DERTaggedObject,pe.asn1.ASN1Object);var ge=function(e){c(t,e);function t(n){var o=e.call(this)||this;if(n){if("string"==typeof n){o.parseKey(n)}else if(t.hasPrivateKeyProperty(n)||t.hasPublicKeyProperty(n)){o.parsePropertiesFrom(n)}}return o}t.prototype.parseKey=function(e){try{var t=0,n=0,o=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(e)?j.decode(e):L.unarmor(e),r=F.decode(o);if(3===r.sub.length){r=r.sub[2].sub[0]}if(9===r.sub.length){t=r.sub[1].getHexStringValue();this.n=y(t,16);n=r.sub[2].getHexStringValue();this.e=parseInt(n,16);var i=r.sub[3].getHexStringValue();this.d=y(i,16);var s=r.sub[4].getHexStringValue();this.p=y(s,16);var a=r.sub[5].getHexStringValue();this.q=y(a,16);var d=r.sub[6].getHexStringValue();this.dmp1=y(d,16);var p=r.sub[7].getHexStringValue();this.dmq1=y(p,16);var g=r.sub[8].getHexStringValue();this.coeff=y(g,16)}else if(2===r.sub.length){var l=r.sub[1],u=l.sub[0];t=u.sub[0].getHexStringValue();this.n=y(t,16);n=u.sub[1].getHexStringValue();this.e=parseInt(n,16)}else{return!1}return!0}catch(e){return!1}};t.prototype.getPrivateBaseKey=function(){var e={array:[new pe.asn1.DERInteger({int:0}),new pe.asn1.DERInteger({bigint:this.n}),new pe.asn1.DERInteger({int:this.e}),new pe.asn1.DERInteger({bigint:this.d}),new pe.asn1.DERInteger({bigint:this.p}),new pe.asn1.DERInteger({bigint:this.q}),new pe.asn1.DERInteger({bigint:this.dmp1}),new pe.asn1.DERInteger({bigint:this.dmq1}),new pe.asn1.DERInteger({bigint:this.coeff})]},t=new pe.asn1.DERSequence(e);return t.getEncodedHex()};t.prototype.getPrivateBaseKeyB64=function(){return l(this.getPrivateBaseKey())};t.prototype.getPublicBaseKey=function(){var e=new pe.asn1.DERSequence({array:[new pe.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new pe.asn1.DERNull]}),t=new pe.asn1.DERSequence({array:[new pe.asn1.DERInteger({bigint:this.n}),new pe.asn1.DERInteger({int:this.e})]}),n=new pe.asn1.DERBitString({hex:"00"+t.getEncodedHex()}),o=new pe.asn1.DERSequence({array:[e,n]});return o.getEncodedHex()};t.prototype.getPublicBaseKeyB64=function(){return l(this.getPublicBaseKey())};t.wordwrap=function(e,t){t=t||64;if(!e){return e}var n="(.{1,"+t+"})( +|$\n?)|(.{1,"+t+"})";return e.match(RegExp(n,"g")).join("\n")};t.prototype.getPrivateKey=function(){var e="-----BEGIN RSA PRIVATE KEY-----\n";e+=t.wordwrap(this.getPrivateBaseKeyB64())+"\n";e+="-----END RSA PRIVATE KEY-----";return e};t.prototype.getPublicKey=function(){var e="-----BEGIN PUBLIC KEY-----\n";e+=t.wordwrap(this.getPublicBaseKeyB64())+"\n";e+="-----END PUBLIC KEY-----";return e};t.hasPublicKeyProperty=function(e){e=e||{};return e.hasOwnProperty("n")&&e.hasOwnProperty("e")};t.hasPrivateKeyProperty=function(e){e=e||{};return e.hasOwnProperty("n")&&e.hasOwnProperty("e")&&e.hasOwnProperty("d")&&e.hasOwnProperty("p")&&e.hasOwnProperty("q")&&e.hasOwnProperty("dmp1")&&e.hasOwnProperty("dmq1")&&e.hasOwnProperty("coeff")};t.prototype.parsePropertiesFrom=function(e){this.n=e.n;this.e=e.e;if(e.hasOwnProperty("d")){this.d=e.d;this.p=e.p;this.q=e.q;this.dmp1=e.dmp1;this.dmq1=e.dmq1;this.coeff=e.coeff}};return t}(se),le=function(){function e(e){e=e||{};this.default_key_size=parseInt(e.default_key_size,10)||1024;this.default_public_exponent=e.default_public_exponent||"010001";this.log=e.log||!1;this.key=null}e.prototype.setKey=function(e){if(this.log&&this.key){console.warn("A key was already set, overriding existing.")}this.key=new ge(e)};e.prototype.setPrivateKey=function(e){this.setKey(e)};e.prototype.setPublicKey=function(e){this.setKey(e)};e.prototype.decrypt=function(e){try{return this.getKey().decrypt(u(e))}catch(e){return!1}};e.prototype.encrypt=function(e){try{return l(this.getKey().encrypt(e))}catch(e){return!1}};e.prototype.sign=function(e,t,n){try{return l(this.getKey().sign(e,t,n))}catch(e){return!1}};e.prototype.verify=function(e,t,n){try{return this.getKey().verify(e,u(t),n)}catch(e){return!1}};e.prototype.getKey=function(e){if(!this.key){this.key=new ge;if(e&&"[object Function]"==={}.toString.call(e)){this.key.generateAsync(this.default_key_size,this.default_public_exponent,e);return}this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key};e.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()};e.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()};e.prototype.getPublicKey=function(){return this.getKey().getPublicKey()};e.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()};e.version="3.0.0-rc.1";return e}();window.JSEncrypt=le;e.JSEncrypt=le;e.default=le;Object.defineProperty(e,"__esModule",{value:!0});return e.default});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(e){"use strict";if("function"==typeof define&&define.amd){define ("theme_coursemos/jstree",["jquery"],e)}else if("undefined"!=typeof module&&module.exports){module.exports=e(require("jquery"))}else{e(jQuery)}})(function(_){"use strict";if(_.jstree){return}var e=0,t=!1,a=!1,r=!1,d=[],n=_("script:last").attr("src"),o=window.document,l=window.setImmediate,c=window.Promise;if(!l&&c){l=function(e,t){c.resolve(t).then(e)}}_.jstree={version:"3.3.12",defaults:{plugins:[]},plugins:{},path:n&&-1!==n.indexOf("/")?n.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"};_.jstree.create=function(t,a){var r=new _.jstree.core(++e),d=a;a=_.extend(!0,{},_.jstree.defaults,a);if(d&&d.plugins){a.plugins=d.plugins}_.each(a.plugins,function(e,t){if("core"!==e){r=r.plugin(t,a[t])}});_(t).data("jstree",r);r.init(t,a);return r};_.jstree.destroy=function(){_(".jstree:jstree").jstree("destroy");_(o).off(".jstree")};_.jstree.core=function(e){this._id=e;this._cnt=0;this._wrk=null;this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}};_.jstree.reference=function(e){var t=null,a=null;if(e&&e.id&&(!e.tagName||!e.nodeType)){e=e.id}if(!a||!a.length){try{a=_(e)}catch(e){}}if(!a||!a.length){try{a=_("#"+e.replace(_.jstree.idregex,"\\$&"))}catch(e){}}if(a&&a.length&&(a=a.closest(".jstree")).length&&(a=a.data("jstree"))){t=a}else{_(".jstree").each(function(){var a=_(this).data("jstree");if(a&&a._model.data[e]){t=a;return!1}})}return t};_.fn.jstree=function(e){var t="string"==typeof e,a=Array.prototype.slice.call(arguments,1),r=null;if(!0===e&&!this.length){return!1}this.each(function(){var d=_.jstree.reference(this),n=t&&d?d[e]:null;r=t&&n?n.apply(d,a):null;if(!d&&!t&&(e===void 0||_.isPlainObject(e))){_.jstree.create(this,e)}if(d&&!t||!0===e){r=d||!1}if(null!==r&&r!==void 0){return!1}});return null!==r&&r!==void 0?r:this};_.expr.pseudos.jstree=_.expr.createPseudo(function(){return function(e){return _(e).hasClass("jstree")&&_(e).data("jstree")!==void 0}});_.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:_.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,compute_elements_positions:!1,keyboard:{"ctrl-space":function ctrlSpace(t){t.type="click";_(t.currentTarget).trigger(t)},enter:function enter(t){t.type="click";_(t.currentTarget).trigger(t)},left:function left(t){t.preventDefault();if(this.is_open(t.currentTarget)){this.close_node(t.currentTarget)}else{var e=this.get_parent(t.currentTarget);if(e&&e.id!==_.jstree.root){this.get_node(e,!0).children(".jstree-anchor").trigger("focus")}}},up:function up(t){t.preventDefault();var e=this.get_prev_dom(t.currentTarget);if(e&&e.length){e.children(".jstree-anchor").trigger("focus")}},right:function right(t){t.preventDefault();if(this.is_closed(t.currentTarget)){this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").trigger("focus")})}else if(this.is_open(t.currentTarget)){var e=this.get_node(t.currentTarget,!0).children(".jstree-children")[0];if(e){_(this._firstChild(e)).children(".jstree-anchor").trigger("focus")}}},down:function down(t){t.preventDefault();var e=this.get_next_dom(t.currentTarget);if(e&&e.length){e.children(".jstree-anchor").trigger("focus")}},"*":function _(){this.open_all()},home:function home(t){t.preventDefault();var e=this._firstChild(this.get_container_ul()[0]);if(e){_(e).children(".jstree-anchor").filter(":visible").trigger("focus")}},end:function end(t){t.preventDefault();this.element.find(".jstree-anchor").filter(":visible").last().trigger("focus")},f2:function f2(t){t.preventDefault();this.edit(t.currentTarget)}}};_.jstree.core.prototype={plugin:function plugin(e,t){var a=_.jstree.plugins[e];if(a){this._data[e]={};a.prototype=this;return new a(t,this)}return this},init:function init(e,t){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}};this._model.data[_.jstree.root]={id:_.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}};this.element=_(e).addClass("jstree jstree-"+this._id);this.settings=t;this._data.core.ready=!1;this._data.core.loaded=!1;this._data.core.rtl="rtl"===this.element.css("direction");this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl");this.element.attr("role","tree");if(this.settings.core.multiple){this.element.attr("aria-multiselectable",!0)}if(!this.element.attr("tabindex")){this.element.attr("tabindex","0")}this.bind();this.trigger("init");this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0);this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove();this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading");this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24;this._data.core.node=this._create_prototype_node();this.trigger("loading");this.load_node(_.jstree.root)},destroy:function destroy(e){this.trigger("destroy");if(this._wrk){try{window.URL.revokeObjectURL(this._wrk);this._wrk=null}catch(e){}}if(!e){this.element.empty()}this.teardown()},_create_prototype_node:function _create_prototype_node(){var e=o.createElement("LI"),t,a;e.setAttribute("role","none");t=o.createElement("I");t.className="jstree-icon jstree-ocl";t.setAttribute("role","presentation");e.appendChild(t);t=o.createElement("A");t.className="jstree-anchor";t.setAttribute("href","#");t.setAttribute("tabindex","-1");t.setAttribute("role","treeitem");a=o.createElement("I");a.className="jstree-icon jstree-themeicon";a.setAttribute("role","presentation");t.appendChild(a);e.appendChild(t);t=a=null;return e},_kbevent_to_func:function _kbevent_to_func(t){var e=[];if(t.ctrlKey){e.push("ctrl")}if(t.altKey){e.push("alt")}if(t.shiftKey){e.push("shift")}e.push({8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"}[t.which]||t.which);e=e.sort().join("-").toLowerCase();if("shift-shift"===e||"ctrl-ctrl"===e||"alt-alt"===e){return null}var a=this.settings.core.keyboard,r,d;for(r in a){if(a.hasOwnProperty(r)){d=r;if("-"!==d&&"+"!==d){d=d.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS");d=d.split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase()}if(d===e){return a[r]}}}return null},teardown:function teardown(){this.unbind();this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});this.element=null},bind:function bind(){var t="",a=null,r=0;this.element.on("dblclick.jstree",function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase()){return!0}if(o.selection&&o.selection.empty){o.selection.empty()}else{if(window.getSelection){var e=window.getSelection();try{e.removeAllRanges();e.collapse()}catch(e){}}}}).on("mousedown.jstree",function(t){if(t.target===this.element[0]){t.preventDefault();r=+new Date}}.bind(this)).on("mousedown.jstree",".jstree-ocl",function(t){t.preventDefault()}).on("click.jstree",".jstree-ocl",function(t){this.toggle_node(t.target)}.bind(this)).on("dblclick.jstree",".jstree-anchor",function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase()){return!0}if(this.settings.core.dblclick_toggle){this.toggle_node(t.target)}}.bind(this)).on("click.jstree",".jstree-anchor",function(t){t.preventDefault();if(t.currentTarget!==o.activeElement){_(t.currentTarget).trigger("focus")}this.activate_node(t.currentTarget,t)}.bind(this)).on("keydown.jstree",".jstree-anchor",function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase()){return!0}if(this._data.core.rtl){if(37===t.which){t.which=39}else if(39===t.which){t.which=37}}var e=this._kbevent_to_func(t);if(e){var a=e.call(this,t);if(!1===a||!0===a){return a}}}.bind(this)).on("load_node.jstree",function(t,e){if(e.status){if(e.node.id===_.jstree.root&&!this._data.core.loaded){this._data.core.loaded=!0;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.trigger("loaded")}if(!this._data.core.ready){setTimeout(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){this._data.core.ready=!0;if(this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var e=[],t,a;for(t=0,a=this._data.core.selected.length;t<a;t++){e=e.concat(this._model.data[this._data.core.selected[t]].parents)}e=_.vakata.array_unique(e);for(t=0,a=e.length;t<a;t++){this.open_node(e[t],!1,0)}}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}}.bind(this),0)}}}.bind(this)).on("keypress.jstree",function(r){if(r.target.tagName&&"input"===r.target.tagName.toLowerCase()){return!0}if(a){clearTimeout(a)}a=setTimeout(function(){t=""},500);var e=String.fromCharCode(r.which).toLowerCase(),d=this.element.find(".jstree-anchor").filter(":visible"),n=d.index(o.activeElement)||0,s=!1;t+=e;if(1<t.length){d.slice(n).each(function(e,a){if(0===_(a).text().toLowerCase().indexOf(t)){_(a).trigger("focus");s=!0;return!1}}.bind(this));if(s){return}d.slice(0,n).each(function(e,a){if(0===_(a).text().toLowerCase().indexOf(t)){_(a).trigger("focus");s=!0;return!1}}.bind(this));if(s){return}}if(new RegExp("^"+e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){d.slice(n+1).each(function(t,a){if(_(a).text().toLowerCase().charAt(0)===e){_(a).trigger("focus");s=!0;return!1}}.bind(this));if(s){return}d.slice(0,n+1).each(function(t,a){if(_(a).text().toLowerCase().charAt(0)===e){_(a).trigger("focus");s=!0;return!1}}.bind(this));if(s){}}}.bind(this)).on("init.jstree",function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots;this._data.core.themes.stripes=e.stripes;this._data.core.themes.icons=e.icons;this._data.core.themes.ellipsis=e.ellipsis;this.set_theme(e.name||"default",e.url);this.set_theme_variant(e.variant)}.bind(this)).on("loading.jstree",function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"]();this[this._data.core.themes.icons?"show_icons":"hide_icons"]();this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]();this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()}.bind(this)).on("blur.jstree",".jstree-anchor",function(t){this._data.core.focused=null;_(t.currentTarget).filter(".jstree-hovered").trigger("mouseleave");this.element.attr("tabindex","0")}.bind(this)).on("focus.jstree",".jstree-anchor",function(t){var e=this.get_node(t.currentTarget);if(e&&e.id){this._data.core.focused=e.id}this.element.find(".jstree-hovered").not(t.currentTarget).trigger("mouseleave");_(t.currentTarget).trigger("mouseenter");this.element.attr("tabindex","-1")}.bind(this)).on("focus.jstree",function(){if(500<+new Date-r&&!this._data.core.focused&&this.settings.core.restore_focus){r=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);if(e){e.find("> .jstree-anchor").trigger("focus")}}}.bind(this)).on("mouseenter.jstree",".jstree-anchor",function(t){this.hover_node(t.currentTarget)}.bind(this)).on("mouseleave.jstree",".jstree-anchor",function(t){this.dehover_node(t.currentTarget)}.bind(this))},unbind:function unbind(){this.element.off(".jstree");_(o).off(".jstree-"+this._id)},trigger:function trigger(e,t){if(!t){t={}}t.instance=this;this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function get_container(){return this.element},get_container_ul:function get_container_ul(){return this.element.children(".jstree-children").first()},get_string:function get_string(e){var t=this.settings.core.strings;if(_.vakata.is_function(t)){return t.call(this,e)}if(t&&t[e]){return t[e]}return e},_firstChild:function _firstChild(e){e=e?e.firstChild:null;while(null!==e&&1!==e.nodeType){e=e.nextSibling}return e},_nextSibling:function _nextSibling(e){e=e?e.nextSibling:null;while(null!==e&&1!==e.nodeType){e=e.nextSibling}return e},_previousSibling:function _previousSibling(e){e=e?e.previousSibling:null;while(null!==e&&1!==e.nodeType){e=e.previousSibling}return e},get_node:function get_node(e,t){if(e&&e.id){e=e.id}if(e instanceof _&&e.length&&e[0].id){e=e[0].id}var a;try{if(this._model.data[e]){e=this._model.data[e]}else if("string"==typeof e&&this._model.data[e.replace(/^#/,"")]){e=this._model.data[e.replace(/^#/,"")]}else if("string"==typeof e&&(a=_("#"+e.replace(_.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[a.closest(".jstree-node").attr("id")]){e=this._model.data[a.closest(".jstree-node").attr("id")]}else if((a=this.element.find(e)).length&&this._model.data[a.closest(".jstree-node").attr("id")]){e=this._model.data[a.closest(".jstree-node").attr("id")]}else if((a=this.element.find(e)).length&&a.hasClass("jstree")){e=this._model.data[_.jstree.root]}else{return!1}if(t){e=e.id===_.jstree.root?this.element:_("#"+e.id.replace(_.jstree.idregex,"\\$&"),this.element)}return e}catch(e){return!1}},get_path:function get_path(e,t,a){e=e.parents?e:this.get_node(e);if(!e||e.id===_.jstree.root||!e.parents){return!1}var r,d,n=[];n.push(a?e.id:e.text);for(r=0,d=e.parents.length;r<d;r++){n.push(a?e.parents[r]:this.get_text(e.parents[r]))}n=n.reverse().slice(1);return t?n.join(t):n},get_next_dom:function get_next_dom(e,t){var a;e=this.get_node(e,!0);if(e[0]===this.element[0]){a=this._firstChild(this.get_container_ul()[0]);while(a&&0===a.offsetHeight){a=this._nextSibling(a)}return a?_(a):!1}if(!e||!e.length){return!1}if(t){a=e[0];do{a=this._nextSibling(a)}while(a&&0===a.offsetHeight);return a?_(a):!1}if(e.hasClass("jstree-open")){a=this._firstChild(e.children(".jstree-children")[0]);while(a&&0===a.offsetHeight){a=this._nextSibling(a)}if(null!==a){return _(a)}}a=e[0];do{a=this._nextSibling(a)}while(a&&0===a.offsetHeight);if(null!==a){return _(a)}return e.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function get_prev_dom(e,t){var a;e=this.get_node(e,!0);if(e[0]===this.element[0]){a=this.get_container_ul()[0].lastChild;while(a&&0===a.offsetHeight){a=this._previousSibling(a)}return a?_(a):!1}if(!e||!e.length){return!1}if(t){a=e[0];do{a=this._previousSibling(a)}while(a&&0===a.offsetHeight);return a?_(a):!1}a=e[0];do{a=this._previousSibling(a)}while(a&&0===a.offsetHeight);if(null!==a){e=_(a);while(e.hasClass("jstree-open")){e=e.children(".jstree-children").first().children(".jstree-node:visible:last")}return e}a=e[0].parentNode.parentNode;return a&&a.className&&-1!==a.className.indexOf("jstree-node")?_(a):!1},get_parent:function get_parent(e){e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}return e.parent},get_children_dom:function get_children_dom(e){e=this.get_node(e,!0);if(e[0]===this.element[0]){return this.get_container_ul().children(".jstree-node")}if(!e||!e.length){return!1}return e.children(".jstree-children").children(".jstree-node")},is_parent:function is_parent(e){e=this.get_node(e);return e&&(!1===e.state.loaded||0<e.children.length)},is_loaded:function is_loaded(e){e=this.get_node(e);return e&&e.state.loaded},is_loading:function is_loading(e){e=this.get_node(e);return e&&e.state&&e.state.loading},is_open:function is_open(e){e=this.get_node(e);return e&&e.state.opened},is_closed:function is_closed(e){e=this.get_node(e);return e&&this.is_parent(e)&&!e.state.opened},is_leaf:function is_leaf(e){return!this.is_parent(e)},load_node:function load_node(e,t){var a,r,d,n,s;if(_.vakata.is_array(e)){this._load_nodes(e.slice(),t);return!0}e=this.get_node(e);if(!e){if(t){t.call(this,e,!1)}return!1}if(e.state.loaded){e.state.loaded=!1;for(d=0,n=e.parents.length;d<n;d++){this._model.data[e.parents[d]].children_d=_.vakata.array_filter(this._model.data[e.parents[d]].children_d,function(t){return-1===_.inArray(t,e.children_d)})}for(a=0,r=e.children_d.length;a<r;a++){if(this._model.data[e.children_d[a]].state.selected){s=!0}delete this._model.data[e.children_d[a]]}if(s){this._data.core.selected=_.vakata.array_filter(this._data.core.selected,function(t){return-1===_.inArray(t,e.children_d)})}e.children=[];e.children_d=[];if(s){this.trigger("changed",{action:"load_node",node:e,selected:this._data.core.selected})}}e.state.failed=!1;e.state.loading=!0;this.get_node(e,!0).addClass("jstree-loading").attr("aria-busy",!0);this._load_node(e,function(a){e=this._model.data[e.id];e.state.loading=!1;e.state.loaded=a;e.state.failed=!e.state.loaded;var r=this.get_node(e,!0),d=0,n=0,s=this._model.data,o=!1;for(d=0,n=e.children.length;d<n;d++){if(s[e.children[d]]&&!s[e.children[d]].state.hidden){o=!0;break}}if(e.state.loaded&&r&&r.length){r.removeClass("jstree-closed jstree-open jstree-leaf");if(!o){r.addClass("jstree-leaf")}else{if("#"!==e.id){r.addClass(e.state.opened?"jstree-open":"jstree-closed")}}}r.removeClass("jstree-loading").attr("aria-busy",!1);this.trigger("load_node",{node:e,status:a});if(t){t.call(this,e,a)}}.bind(this));return!0},_load_nodes:function _load_nodes(e,t,a,d){var n=!0,s=function(){this._load_nodes(e,t,!0)},o=this._model.data,l,c,_=[];for(l=0,c=e.length;l<c;l++){if(o[e[l]]&&(!o[e[l]].state.loaded&&!o[e[l]].state.failed||!a&&d)){if(!this.is_loading(e[l])){this.load_node(e[l],s)}n=!1}}if(n){for(l=0,c=e.length;l<c;l++){if(o[e[l]]&&o[e[l]].state.loaded){_.push(e[l])}}if(t&&!t.done){t.call(this,_);t.done=!0}}},load_all:function load_all(e,t){if(!e){e=_.jstree.root}e=this.get_node(e);if(!e){return!1}var a=[],r=this._model.data,d=r[e.id].children_d,n,s;if(e.state&&!e.state.loaded){a.push(e.id)}for(n=0,s=d.length;n<s;n++){if(r[d[n]]&&r[d[n]].state&&!r[d[n]].state.loaded){a.push(d[n])}}if(a.length){this._load_nodes(a,function(){this.load_all(e,t)})}else{if(t){t.call(this,e)}this.trigger("load_all",{node:e})}},_load_node:function _load_node(e,a){var r=this.settings.core.data,d,n=function(){return 3!==this.nodeType&&8!==this.nodeType};if(!r){if(e.id===_.jstree.root){return this._append_html_data(e,this._data.core.original_container_html.clone(!0),function(e){a.call(this,e)})}else{return a.call(this,!1)}}if(_.vakata.is_function(r)){return r.call(this,e,function(t){if(!1===t){a.call(this,!1)}else{this["string"==typeof t?"_append_html_data":"_append_json_data"](e,"string"==typeof t?_(_.parseHTML(t)).filter(n):t,function(e){a.call(this,e)})}}.bind(this))}if("object"===_typeof(r)){if(r.url){r=_.extend(!0,{},r);if(_.vakata.is_function(r.url)){r.url=r.url.call(this,e)}if(_.vakata.is_function(r.data)){r.data=r.data.call(this,e)}return _.ajax(r).done(function(r,d,t){var s=t.getResponseHeader("Content-Type");if(s&&-1!==s.indexOf("json")||"object"===_typeof(r)){return this._append_json_data(e,r,function(e){a.call(this,e)})}if(s&&-1!==s.indexOf("html")||"string"==typeof r){return this._append_html_data(e,_(_.parseHTML(r)).filter(n),function(e){a.call(this,e)})}this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:e.id,xhr:t})};this.settings.core.error.call(this,this._data.core.last_error);return a.call(this,!1)}.bind(this)).fail(function(t){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:e.id,xhr:t})};a.call(this,!1);this.settings.core.error.call(this,this._data.core.last_error)}.bind(this))}if(_.vakata.is_array(r)){d=_.extend(!0,[],r)}else if(_.isPlainObject(r)){d=_.extend(!0,{},r)}else{d=r}if(e.id===_.jstree.root){return this._append_json_data(e,d,function(e){a.call(this,e)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:e.id})};this.settings.core.error.call(this,this._data.core.last_error);return a.call(this,!1)}}if("string"==typeof r){if(e.id===_.jstree.root){return this._append_html_data(e,_(_.parseHTML(r)).filter(n),function(e){a.call(this,e)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:e.id})};this.settings.core.error.call(this,this._data.core.last_error);return a.call(this,!1)}}return a.call(this,!1)},_node_changed:function _node_changed(e){e=this.get_node(e);if(e&&-1===_.inArray(e.id,this._model.changed)){this._model.changed.push(e.id)}},_append_html_data:function _append_html_data(e,t,a){e=this.get_node(e);e.children=[];e.children_d=[];var r=t.is("ul")?t.children():t,d=e.id,n=[],o=[],l=this._model.data,c=l[d],h=this._data.core.selected.length,s,g,p;r.each(function(e,t){s=this._parse_model_from_html(_(t),d,c.parents.concat());if(s){n.push(s);o.push(s);if(l[s].children_d.length){o=o.concat(l[s].children_d)}}}.bind(this));c.children=n;c.children_d=o;for(g=0,p=c.parents.length;g<p;g++){l[c.parents[g]].children_d=l[c.parents[g]].children_d.concat(o)}this.trigger("model",{nodes:o,parent:d});if(d!==_.jstree.root){this._node_changed(d);this.redraw()}else{this.get_container_ul().children(".jstree-initial-node").remove();this.redraw(!0)}if(this._data.core.selected.length!==h){this.trigger("changed",{action:"model",selected:this._data.core.selected})}a.call(this,!0)},_append_json_data:function _append_json_data(e,t,a,r){if(null===this.element){return}e=this.get_node(e);e.children=[];e.children_d=[];if(t.d){t=t.d;if("string"==typeof t){t=JSON.parse(t)}}if(!_.vakata.is_array(t)){t=[t]}var d=null,n={df:this._model.default_state,dat:t,par:e.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},s=this,i=function(e){if(e.data){e=e.data}var t=e.dat,a=e.par,r=[],d=[],n=[],o=e.df,l=e.t_id,c=e.t_cnt,_=e.m,h=_[a],g=e.sel,p,m,u,f,k=function(t,a,r){if(!r){r=[]}else{r=r.concat()}if(a){r.unshift(a)}var d=t.id.toString(),s,l,h,g,p={id:d,text:t.text||"",icon:t.icon!==void 0?t.icon:!0,parent:a,parents:r,children:t.children||[],children_d:t.children_d||[],data:t.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in o){if(o.hasOwnProperty(s)){p.state[s]=o[s]}}if(t&&t.data&&t.data.jstree&&t.data.jstree.icon){p.icon=t.data.jstree.icon}if(p.icon===void 0||null===p.icon||""===p.icon){p.icon=!0}if(t&&t.data){p.data=t.data;if(t.data.jstree){for(s in t.data.jstree){if(t.data.jstree.hasOwnProperty(s)){p.state[s]=t.data.jstree[s]}}}}if(t&&"object"===_typeof(t.state)){for(s in t.state){if(t.state.hasOwnProperty(s)){p.state[s]=t.state[s]}}}if(t&&"object"===_typeof(t.li_attr)){for(s in t.li_attr){if(t.li_attr.hasOwnProperty(s)){p.li_attr[s]=t.li_attr[s]}}}if(!p.li_attr.id){p.li_attr.id=d}if(t&&"object"===_typeof(t.a_attr)){for(s in t.a_attr){if(t.a_attr.hasOwnProperty(s)){p.a_attr[s]=t.a_attr[s]}}}if(t&&t.children&&!0===t.children){p.state.loaded=!1;p.children=[];p.children_d=[]}_[p.id]=p;for(s=0,l=p.children.length;s<l;s++){h=k(_[p.children[s]],p.id,r);g=_[h];p.children_d.push(h);if(g.children_d.length){p.children_d=p.children_d.concat(g.children_d)}}delete t.data;delete t.children;_[p.id].original=t;if(p.state.selected){n.push(p.id)}return p.id},v=function(t,a,r){if(!r){r=[]}else{r=r.concat()}if(a){r.unshift(a)}var d=!1,s,h,g,p,m;do{d="j"+l+"_"+ ++c}while(_[d]);m={id:!1,text:"string"==typeof t?t:"",icon:"object"===_typeof(t)&&t.icon!==void 0?t.icon:!0,parent:a,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in o){if(o.hasOwnProperty(s)){m.state[s]=o[s]}}if(t&&t.id){m.id=t.id.toString()}if(t&&t.text){m.text=t.text}if(t&&t.data&&t.data.jstree&&t.data.jstree.icon){m.icon=t.data.jstree.icon}if(m.icon===void 0||null===m.icon||""===m.icon){m.icon=!0}if(t&&t.data){m.data=t.data;if(t.data.jstree){for(s in t.data.jstree){if(t.data.jstree.hasOwnProperty(s)){m.state[s]=t.data.jstree[s]}}}}if(t&&"object"===_typeof(t.state)){for(s in t.state){if(t.state.hasOwnProperty(s)){m.state[s]=t.state[s]}}}if(t&&"object"===_typeof(t.li_attr)){for(s in t.li_attr){if(t.li_attr.hasOwnProperty(s)){m.li_attr[s]=t.li_attr[s]}}}if(m.li_attr.id&&!m.id){m.id=m.li_attr.id.toString()}if(!m.id){m.id=d}if(!m.li_attr.id){m.li_attr.id=m.id}if(t&&"object"===_typeof(t.a_attr)){for(s in t.a_attr){if(t.a_attr.hasOwnProperty(s)){m.a_attr[s]=t.a_attr[s]}}}if(t&&t.children&&t.children.length){for(s=0,h=t.children.length;s<h;s++){g=v(t.children[s],m.id,r);p=_[g];m.children.push(g);if(p.children_d.length){m.children_d=m.children_d.concat(p.children_d)}}m.children_d=m.children_d.concat(m.children)}if(t&&t.children&&!0===t.children){m.state.loaded=!1;m.children=[];m.children_d=[]}delete t.data;delete t.children;m.original=t;_[m.id]=m;if(m.state.selected){n.push(m.id)}return m.id};if(t.length&&t[0].id!==void 0&&t[0].parent!==void 0){for(m=0,u=t.length;m<u;m++){if(!t[m].children){t[m].children=[]}if(!t[m].state){t[m].state={}}_[t[m].id.toString()]=t[m]}for(m=0,u=t.length;m<u;m++){if(!_[t[m].parent.toString()]){if("undefined"!=typeof s){s._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:t[m].id.toString(),parent:t[m].parent.toString()})};s.settings.core.error.call(s,s._data.core.last_error)}continue}_[t[m].parent.toString()].children.push(t[m].id.toString());h.children_d.push(t[m].id.toString())}for(m=0,u=h.children.length;m<u;m++){p=k(_[h.children[m]],a,h.parents.concat());d.push(p);if(_[p].children_d.length){d=d.concat(_[p].children_d)}}for(m=0,u=h.parents.length;m<u;m++){_[h.parents[m]].children_d=_[h.parents[m]].children_d.concat(d)}f={cnt:c,mod:_,sel:g,par:a,dpc:d,add:n}}else{for(m=0,u=t.length;m<u;m++){p=v(t[m],a,h.parents.concat());if(p){r.push(p);d.push(p);if(_[p].children_d.length){d=d.concat(_[p].children_d)}}}h.children=r;h.children_d=d;for(m=0,u=h.parents.length;m<u;m++){_[h.parents[m]].children_d=_[h.parents[m]].children_d.concat(d)}f={cnt:c,mod:_,sel:g,par:a,dpc:d,add:n}}if("undefined"==typeof window||"undefined"==typeof window.document){postMessage(f)}else{return f}},o=function(e,t){if(null===this.element){return}this._cnt=e.cnt;var d,n=this._model.data;for(d in n){if(n.hasOwnProperty(d)&&n[d].state&&n[d].state.loading&&e.mod[d]){e.mod[d].state.loading=!0}}this._model.data=e.mod;if(t){var o,c=e.add,h=e.sel,r=this._data.core.selected.slice();n=this._model.data;if(h.length!==r.length||_.vakata.array_unique(h.concat(r)).length!==h.length){for(d=0,o=h.length;d<o;d++){if(-1===_.inArray(h[d],c)&&-1===_.inArray(h[d],r)){n[h[d]].state.selected=!1}}for(d=0,o=r.length;d<o;d++){if(-1===_.inArray(r[d],h)){n[r[d]].state.selected=!0}}}}if(e.add.length){this._data.core.selected=this._data.core.selected.concat(e.add)}this.trigger("model",{nodes:e.dpc,parent:e.par});if(e.par!==_.jstree.root){this._node_changed(e.par);this.redraw()}else{this.redraw(!0)}if(e.add.length){this.trigger("changed",{action:"model",selected:this._data.core.selected})}if(!t&&l){l(function(){a.call(s,!0)})}else{a.call(s,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker){try{if(null===this._wrk){this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+i.toString()],{type:"text/javascript"}))}if(!this._data.core.working||r){this._data.core.working=!0;d=new window.Worker(this._wrk);d.onmessage=function(t){o.call(this,t.data,!0);try{d.terminate();d=null}catch(e){}if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=!1}}.bind(this);if(!n.par){if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=!1}}else{d.postMessage(n)}}else{this._data.core.worker_queue.push([e,t,a,!0])}}catch(t){o.call(this,i(n),!1);if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=!1}}}else{o.call(this,i(n),!1)}},_parse_model_from_html:function _parse_model_from_html(t,a,r){if(!r){r=[]}else{r=[].concat(r)}if(a){r.unshift(a)}var d,n,s=this._model.data,o={id:!1,text:!1,icon:!0,parent:a,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},l,h,g;for(l in this._model.default_state){if(this._model.default_state.hasOwnProperty(l)){o.state[l]=this._model.default_state[l]}}h=_.vakata.attributes(t,!0);_.each(h,function(e,t){t=_.vakata.trim(t);if(!t.length){return!0}o.li_attr[e]=t;if("id"===e){o.id=t.toString()}});h=t.children("a").first();if(h.length){h=_.vakata.attributes(h,!0);_.each(h,function(e,t){t=_.vakata.trim(t);if(t.length){o.a_attr[e]=t}})}h=t.children("a").first().length?t.children("a").first().clone():t.clone();h.children("ins, i, ul").remove();h=h.html();h=_("<div></div>").html(h);o.text=this.settings.core.force_text?h.text():h.html();h=t.data();o.data=h?_.extend(!0,{},h):null;o.state.opened=t.hasClass("jstree-open");o.state.selected=t.children("a").hasClass("jstree-clicked");o.state.disabled=t.children("a").hasClass("jstree-disabled");if(o.data&&o.data.jstree){for(l in o.data.jstree){if(o.data.jstree.hasOwnProperty(l)){o.state[l]=o.data.jstree[l]}}}h=t.children("a").children(".jstree-themeicon");if(h.length){o.icon=h.hasClass("jstree-themeicon-hidden")?!1:h.attr("rel")}if(o.state.icon!==void 0){o.icon=o.state.icon}if(o.icon===void 0||null===o.icon||""===o.icon){o.icon=!0}h=t.children("ul").children("li");do{g="j"+this._id+"_"+ ++this._cnt}while(s[g]);o.id=o.li_attr.id?o.li_attr.id.toString():g;if(h.length){h.each(function(e,t){d=this._parse_model_from_html(_(t),o.id,r);n=this._model.data[d];o.children.push(d);if(n.children_d.length){o.children_d=o.children_d.concat(n.children_d)}}.bind(this));o.children_d=o.children_d.concat(o.children)}else{if(t.hasClass("jstree-closed")){o.state.loaded=!1}}if(o.li_attr["class"]){o.li_attr["class"]=o.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")}if(o.a_attr["class"]){o.a_attr["class"]=o.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")}s[o.id]=o;if(o.state.selected){this._data.core.selected.push(o.id)}return o.id},_parse_model_from_flat_json:function _parse_model_from_flat_json(t,a,r){if(!r){r=[]}else{r=r.concat()}if(a){r.unshift(a)}var d=t.id.toString(),n=this._model.data,s=this._model.default_state,o,l,_,h,g={id:d,text:t.text||"",icon:t.icon!==void 0?t.icon:!0,parent:a,parents:r,children:t.children||[],children_d:t.children_d||[],data:t.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in s){if(s.hasOwnProperty(o)){g.state[o]=s[o]}}if(t&&t.data&&t.data.jstree&&t.data.jstree.icon){g.icon=t.data.jstree.icon}if(g.icon===void 0||null===g.icon||""===g.icon){g.icon=!0}if(t&&t.data){g.data=t.data;if(t.data.jstree){for(o in t.data.jstree){if(t.data.jstree.hasOwnProperty(o)){g.state[o]=t.data.jstree[o]}}}}if(t&&"object"===_typeof(t.state)){for(o in t.state){if(t.state.hasOwnProperty(o)){g.state[o]=t.state[o]}}}if(t&&"object"===_typeof(t.li_attr)){for(o in t.li_attr){if(t.li_attr.hasOwnProperty(o)){g.li_attr[o]=t.li_attr[o]}}}if(!g.li_attr.id){g.li_attr.id=d}if(t&&"object"===_typeof(t.a_attr)){for(o in t.a_attr){if(t.a_attr.hasOwnProperty(o)){g.a_attr[o]=t.a_attr[o]}}}if(t&&t.children&&!0===t.children){g.state.loaded=!1;g.children=[];g.children_d=[]}n[g.id]=g;for(o=0,l=g.children.length;o<l;o++){_=this._parse_model_from_flat_json(n[g.children[o]],g.id,r);h=n[_];g.children_d.push(_);if(h.children_d.length){g.children_d=g.children_d.concat(h.children_d)}}delete t.data;delete t.children;n[g.id].original=t;if(g.state.selected){this._data.core.selected.push(g.id)}return g.id},_parse_model_from_json:function _parse_model_from_json(t,a,r){if(!r){r=[]}else{r=r.concat()}if(a){r.unshift(a)}var d=!1,n,s,o,l,_=this._model.data,h=this._model.default_state,g;do{d="j"+this._id+"_"+ ++this._cnt}while(_[d]);g={id:!1,text:"string"==typeof t?t:"",icon:"object"===_typeof(t)&&t.icon!==void 0?t.icon:!0,parent:a,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in h){if(h.hasOwnProperty(n)){g.state[n]=h[n]}}if(t&&t.id){g.id=t.id.toString()}if(t&&t.text){g.text=t.text}if(t&&t.data&&t.data.jstree&&t.data.jstree.icon){g.icon=t.data.jstree.icon}if(g.icon===void 0||null===g.icon||""===g.icon){g.icon=!0}if(t&&t.data){g.data=t.data;if(t.data.jstree){for(n in t.data.jstree){if(t.data.jstree.hasOwnProperty(n)){g.state[n]=t.data.jstree[n]}}}}if(t&&"object"===_typeof(t.state)){for(n in t.state){if(t.state.hasOwnProperty(n)){g.state[n]=t.state[n]}}}if(t&&"object"===_typeof(t.li_attr)){for(n in t.li_attr){if(t.li_attr.hasOwnProperty(n)){g.li_attr[n]=t.li_attr[n]}}}if(g.li_attr.id&&!g.id){g.id=g.li_attr.id.toString()}if(!g.id){g.id=d}if(!g.li_attr.id){g.li_attr.id=g.id}if(t&&"object"===_typeof(t.a_attr)){for(n in t.a_attr){if(t.a_attr.hasOwnProperty(n)){g.a_attr[n]=t.a_attr[n]}}}if(t&&t.children&&t.children.length){for(n=0,s=t.children.length;n<s;n++){o=this._parse_model_from_json(t.children[n],g.id,r);l=_[o];g.children.push(o);if(l.children_d.length){g.children_d=g.children_d.concat(l.children_d)}}g.children_d=g.children.concat(g.children_d)}if(t&&t.children&&!0===t.children){g.state.loaded=!1;g.children=[];g.children_d=[]}delete t.data;delete t.children;g.original=t;_[g.id]=g;if(g.state.selected){this._data.core.selected.push(g.id)}return g.id},_redraw:function _redraw(){var e=this._model.force_full_redraw?this._model.data[_.jstree.root].children.concat([]):this._model.changed.concat([]),t=o.createElement("UL"),a,r,d,n=this._data.core.focused;for(r=0,d=e.length;r<d;r++){a=this.redraw_node(e[r],!0,this._model.force_full_redraw);if(a&&this._model.force_full_redraw){t.appendChild(a)}}if(this._model.force_full_redraw){t.className=this.get_container_ul()[0].className;t.setAttribute("role","group");this.element.empty().append(t)}if(null!==n&&this.settings.core.restore_focus){a=this.get_node(n,!0);if(a&&a.length&&a.children(".jstree-anchor")[0]!==o.activeElement){a.children(".jstree-anchor").trigger("focus")}else{this._data.core.focused=null}}this._model.force_full_redraw=!1;this._model.changed=[];this.trigger("redraw",{nodes:e})},redraw:function redraw(e){if(e){this._model.force_full_redraw=!0}this._redraw()},draw_children:function draw_children(e){var t=this.get_node(e),a=!1,r=!1,d=!1;if(!t){return!1}if(t.id===_.jstree.root){return this.redraw(!0)}e=this.get_node(e,!0);if(!e||!e.length){return!1}e.children(".jstree-children").remove();e=e[0];if(t.children.length&&t.state.loaded){d=o.createElement("UL");d.setAttribute("role","group");d.className="jstree-children";for(a=0,r=t.children.length;a<r;a++){d.appendChild(this.redraw_node(t.children[a],!0,!0))}e.appendChild(d)}},redraw_node:function redraw_node(e,a,r,n){var s=this.get_node(e),h=!1,g=!1,p=!1,u=!1,v=!1,b=!1,y="",x=o,d=this._model.data,m=!1,w=null,C=0,N=0,T=!1,O=!1;if(!s){return!1}if(s.id===_.jstree.root){return this.redraw(!0)}a=a||0===s.children.length;e=!o.querySelector?o.getElementById(s.id):this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(s.id[0])?"\\3"+s.id[0]+" "+s.id.substr(1).replace(_.jstree.idregex,"\\$&"):s.id.replace(_.jstree.idregex,"\\$&")));if(!e){a=!0;if(!r){h=s.parent!==_.jstree.root?_("#"+s.parent.replace(_.jstree.idregex,"\\$&"),this.element)[0]:null;if(null!==h&&(!h||!d[s.parent].state.opened)){return!1}g=_.inArray(s.id,null===h?d[_.jstree.root].children:d[s.parent].children)}}else{e=_(e);if(!r){h=e.parent().parent()[0];if(h===this.element[0]){h=null}g=e.index()}if(!a&&s.children.length&&!e.children(".jstree-children").length){a=!0}if(!a){p=e.children(".jstree-children")[0]}m=e.children(".jstree-anchor")[0]===o.activeElement;e.remove()}e=this._data.core.node.cloneNode(!0);y="jstree-node ";for(u in s.li_attr){if(s.li_attr.hasOwnProperty(u)){if("id"===u){continue}if("class"!==u){e.setAttribute(u,s.li_attr[u])}else{y+=s.li_attr[u]}}}if(!s.a_attr.id){s.a_attr.id=s.id+"_anchor"}e.childNodes[1].setAttribute("aria-selected",!!s.state.selected);e.childNodes[1].setAttribute("aria-level",s.parents.length);if(this.settings.core.compute_elements_positions){e.childNodes[1].setAttribute("aria-setsize",d[s.parent].children.length);e.childNodes[1].setAttribute("aria-posinset",d[s.parent].children.indexOf(s.id)+1)}if(s.state.disabled){e.childNodes[1].setAttribute("aria-disabled",!0)}for(u=0,v=s.children.length;u<v;u++){if(!d[s.children[u]].state.hidden){T=!0;break}}if(null!==s.parent&&d[s.parent]&&!s.state.hidden){u=_.inArray(s.id,d[s.parent].children);O=s.id;if(-1!==u){u++;for(v=d[s.parent].children.length;u<v;u++){if(!d[d[s.parent].children[u]].state.hidden){O=d[s.parent].children[u]}if(O!==s.id){break}}}}if(s.state.hidden){y+=" jstree-hidden"}if(s.state.loading){y+=" jstree-loading"}if(s.state.loaded&&!T){y+=" jstree-leaf"}else{y+=s.state.opened&&s.state.loaded?" jstree-open":" jstree-closed";e.childNodes[1].setAttribute("aria-expanded",s.state.opened&&s.state.loaded)}if(O===s.id){y+=" jstree-last"}e.id=s.id;e.className=y;y=(s.state.selected?" jstree-clicked":"")+(s.state.disabled?" jstree-disabled":"");for(v in s.a_attr){if(s.a_attr.hasOwnProperty(v)){if("href"===v&&"#"===s.a_attr[v]){continue}if("class"!==v){e.childNodes[1].setAttribute(v,s.a_attr[v])}else{y+=" "+s.a_attr[v]}}}if(y.length){e.childNodes[1].className="jstree-anchor "+y}if(s.icon&&!0!==s.icon||!1===s.icon){if(!1===s.icon){e.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden"}else if(-1===s.icon.indexOf("/")&&-1===s.icon.indexOf(".")){e.childNodes[1].childNodes[0].className+=" "+s.icon+" jstree-themeicon-custom"}else{e.childNodes[1].childNodes[0].style.backgroundImage="url(\""+s.icon+"\")";e.childNodes[1].childNodes[0].style.backgroundPosition="center center";e.childNodes[1].childNodes[0].style.backgroundSize="auto";e.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom"}}if(this.settings.core.force_text){e.childNodes[1].appendChild(x.createTextNode(s.text))}else{e.childNodes[1].innerHTML+=s.text}if(a&&s.children.length&&(s.state.opened||n)&&s.state.loaded){b=x.createElement("UL");b.setAttribute("role","group");b.className="jstree-children";for(u=0,v=s.children.length;u<v;u++){b.appendChild(this.redraw_node(s.children[u],a,!0))}e.appendChild(b)}if(p){e.appendChild(p)}if(!r){if(!h){h=this.element[0]}for(u=0,v=h.childNodes.length;u<v;u++){if(h.childNodes[u]&&h.childNodes[u].className&&-1!==h.childNodes[u].className.indexOf("jstree-children")){w=h.childNodes[u];break}}if(!w){w=x.createElement("UL");w.setAttribute("role","group");w.className="jstree-children";h.appendChild(w)}h=w;if(g<h.childNodes.length){h.insertBefore(e,h.childNodes[g])}else{h.appendChild(e)}if(m){C=this.element[0].scrollTop;N=this.element[0].scrollLeft;e.childNodes[1].focus();this.element[0].scrollTop=C;this.element[0].scrollLeft=N}}if(s.state.opened&&!s.state.loaded){s.state.opened=!1;setTimeout(function(){this.open_node(s.id,!1,0)}.bind(this),0)}return e},open_node:function open_node(e,a,r){var n,s,i,o;if(_.vakata.is_array(e)){e=e.slice();for(n=0,s=e.length;n<s;n++){this.open_node(e[n],a,r)}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}r=r===void 0?this.settings.core.animation:r;if(!this.is_closed(e)){if(a){a.call(this,e,!1)}return!1}if(!this.is_loaded(e)){if(this.is_loading(e)){return setTimeout(function(){this.open_node(e,a,r)}.bind(this),500)}this.load_node(e,function(e,t){return t?this.open_node(e,a,r):a?a.call(this,e,!1):!1})}else{i=this.get_node(e,!0);o=this;if(i.length){if(r&&i.children(".jstree-children").length){i.children(".jstree-children").stop(!0,!0)}if(e.children.length&&!this._firstChild(i.children(".jstree-children")[0])){this.draw_children(e)}if(!r){this.trigger("before_open",{node:e});i[0].className=i[0].className.replace("jstree-closed","jstree-open");i[0].childNodes[1].setAttribute("aria-expanded",!0)}else{this.trigger("before_open",{node:e});i.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").children(".jstree-anchor").attr("aria-expanded",!0).end().children(".jstree-children").stop(!0,!0).slideDown(r,function(){this.style.display="";if(o.element){o.trigger("after_open",{node:e})}})}}e.state.opened=!0;if(a){a.call(this,e,!0)}if(!i.length){this.trigger("before_open",{node:e})}this.trigger("open_node",{node:e});if(!r||!i.length){this.trigger("after_open",{node:e})}return!0}},_open_to:function _open_to(e){e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}var t,a,r=e.parents;for(t=0,a=r.length;t<a;t+=1){if(t!==_.jstree.root){this.open_node(r[t],!1,0)}}return _("#"+e.id.replace(_.jstree.idregex,"\\$&"),this.element)},close_node:function close_node(e,a){var r,n,s,i;if(_.vakata.is_array(e)){e=e.slice();for(r=0,n=e.length;r<n;r++){this.close_node(e[r],a)}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}if(this.is_closed(e)){return!1}a=a===void 0?this.settings.core.animation:a;s=this;i=this.get_node(e,!0);e.state.opened=!1;this.trigger("close_node",{node:e});if(!i.length){this.trigger("after_close",{node:e})}else{if(!a){i[0].className=i[0].className.replace("jstree-open","jstree-closed");i.children(".jstree-anchor").attr("aria-expanded",!1);i.children(".jstree-children").remove();this.trigger("after_close",{node:e})}else{i.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").children(".jstree-anchor").attr("aria-expanded",!1).end().children(".jstree-children").stop(!0,!0).slideUp(a,function(){this.style.display="";i.children(".jstree-children").remove();if(s.element){s.trigger("after_close",{node:e})}})}}},toggle_node:function toggle_node(e){var t,a;if(_.vakata.is_array(e)){e=e.slice();for(t=0,a=e.length;t<a;t++){this.toggle_node(e[t])}return!0}if(this.is_closed(e)){return this.open_node(e)}if(this.is_open(e)){return this.close_node(e)}},open_all:function open_all(e,t,a){if(!e){e=_.jstree.root}e=this.get_node(e);if(!e){return!1}var r=e.id===_.jstree.root?this.get_container_ul():this.get_node(e,!0),d,n,s;if(!r.length){for(d=0,n=e.children_d.length;d<n;d++){if(this.is_closed(this._model.data[e.children_d[d]])){this._model.data[e.children_d[d]].state.opened=!0}}return this.trigger("open_all",{node:e})}a=a||r;s=this;r=this.is_closed(e)?r.find(".jstree-closed").addBack():r.find(".jstree-closed");r.each(function(){s.open_node(this,function(e,r){if(r&&this.is_parent(e)){this.open_all(e,t,a)}},t||0)});if(0===a.find(".jstree-closed").length){this.trigger("open_all",{node:this.get_node(a)})}},close_all:function close_all(e,t){if(!e){e=_.jstree.root}e=this.get_node(e);if(!e){return!1}var a=e.id===_.jstree.root?this.get_container_ul():this.get_node(e,!0),r=this,d,n;if(a.length){a=this.is_open(e)?a.find(".jstree-open").addBack():a.find(".jstree-open");_(a.get().reverse()).each(function(){r.close_node(this,t||0)})}for(d=0,n=e.children_d.length;d<n;d++){this._model.data[e.children_d[d]].state.opened=!1}this.trigger("close_all",{node:e})},is_disabled:function is_disabled(e){e=this.get_node(e);return e&&e.state&&e.state.disabled},enable_node:function enable_node(e){var t,a;if(_.vakata.is_array(e)){e=e.slice();for(t=0,a=e.length;t<a;t++){this.enable_node(e[t])}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}e.state.disabled=!1;this.get_node(e,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1);this.trigger("enable_node",{node:e})},disable_node:function disable_node(e){var t,a;if(_.vakata.is_array(e)){e=e.slice();for(t=0,a=e.length;t<a;t++){this.disable_node(e[t])}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}e.state.disabled=!0;this.get_node(e,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0);this.trigger("disable_node",{node:e})},is_hidden:function is_hidden(e){e=this.get_node(e);return!0===e.state.hidden},hide_node:function hide_node(e,t){var a,r;if(_.vakata.is_array(e)){e=e.slice();for(a=0,r=e.length;a<r;a++){this.hide_node(e[a],!0)}if(!t){this.redraw()}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}if(!e.state.hidden){e.state.hidden=!0;this._node_changed(e.parent);if(!t){this.redraw()}this.trigger("hide_node",{node:e})}},show_node:function show_node(e,t){var a,r;if(_.vakata.is_array(e)){e=e.slice();for(a=0,r=e.length;a<r;a++){this.show_node(e[a],!0)}if(!t){this.redraw()}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}if(e.state.hidden){e.state.hidden=!1;this._node_changed(e.parent);if(!t){this.redraw()}this.trigger("show_node",{node:e})}},hide_all:function hide_all(e){var t,a=this._model.data,r=[];for(t in a){if(a.hasOwnProperty(t)&&t!==_.jstree.root&&!a[t].state.hidden){a[t].state.hidden=!0;r.push(t)}}this._model.force_full_redraw=!0;if(!e){this.redraw()}this.trigger("hide_all",{nodes:r});return r},show_all:function show_all(e){var t,a=this._model.data,r=[];for(t in a){if(a.hasOwnProperty(t)&&t!==_.jstree.root&&a[t].state.hidden){a[t].state.hidden=!1;r.push(t)}}this._model.force_full_redraw=!0;if(!e){this.redraw()}this.trigger("show_all",{nodes:r});return r},activate_node:function activate_node(t,a){if(this.is_disabled(t)){return!1}if(!a||"object"!==_typeof(a)){a={}}this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==void 0?this.get_node(this._data.core.last_clicked.id):null;if(this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected){this._data.core.last_clicked=null}if(!this._data.core.last_clicked&&this._data.core.selected.length){this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])}if(!this.settings.core.multiple||!a.metaKey&&!a.ctrlKey&&!a.shiftKey||a.shiftKey&&(!this._data.core.last_clicked||!this.get_parent(t)||this.get_parent(t)!==this._data.core.last_clicked.parent)){if(!this.settings.core.multiple&&(a.metaKey||a.ctrlKey||a.shiftKey)&&this.is_selected(t)){this.deselect_node(t,!1,a)}else{this.deselect_all(!0);this.select_node(t,!1,!1,a);this._data.core.last_clicked=this.get_node(t)}}else{if(a.shiftKey){var r=this.get_node(t).id,d=this._data.core.last_clicked.id,n=this.get_node(this._data.core.last_clicked.parent).children,s=!1,o,l;for(o=0,l=n.length;o<l;o+=1){if(n[o]===r){s=!s}if(n[o]===d){s=!s}if(!this.is_disabled(n[o])&&(s||n[o]===r||n[o]===d)){if(!this.is_hidden(n[o])){this.select_node(n[o],!0,!1,a)}}else{this.deselect_node(n[o],!0,a)}}this.trigger("changed",{action:"select_node",node:this.get_node(t),selected:this._data.core.selected,event:a})}else{if(!this.is_selected(t)){this.select_node(t,!1,!1,a)}else{this.deselect_node(t,!1,a)}}}this.trigger("activate_node",{node:this.get_node(t),event:a})},hover_node:function hover_node(e){e=this.get_node(e,!0);if(!e||!e.length||e.children(".jstree-hovered").length){return!1}var a=this.element.find(".jstree-hovered"),r=this.element;if(a&&a.length){this.dehover_node(a)}e.children(".jstree-anchor").addClass("jstree-hovered");this.trigger("hover_node",{node:this.get_node(e)});setTimeout(function(){r.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function dehover_node(e){e=this.get_node(e,!0);if(!e||!e.length||!e.children(".jstree-hovered").length){return!1}e.children(".jstree-anchor").removeClass("jstree-hovered");this.trigger("dehover_node",{node:this.get_node(e)})},select_node:function select_node(t,a,r,d){var e,n,s;if(_.vakata.is_array(t)){t=t.slice();for(n=0,s=t.length;n<s;n++){this.select_node(t[n],a,r,d)}return!0}t=this.get_node(t);if(!t||t.id===_.jstree.root){return!1}e=this.get_node(t,!0);if(!t.state.selected){t.state.selected=!0;this._data.core.selected.push(t.id);if(!r){e=this._open_to(t)}if(e&&e.length){e.children(".jstree-anchor").addClass("jstree-clicked").attr("aria-selected",!0)}this.trigger("select_node",{node:t,selected:this._data.core.selected,event:d});if(!a){this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:d})}}},deselect_node:function deselect_node(t,a,r){var e,d,n;if(_.vakata.is_array(t)){t=t.slice();for(e=0,d=t.length;e<d;e++){this.deselect_node(t[e],a,r)}return!0}t=this.get_node(t);if(!t||t.id===_.jstree.root){return!1}n=this.get_node(t,!0);if(t.state.selected){t.state.selected=!1;this._data.core.selected=_.vakata.array_remove_item(this._data.core.selected,t.id);if(n.length){n.children(".jstree-anchor").removeClass("jstree-clicked").attr("aria-selected",!1)}this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:r});if(!a){this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:r})}}},select_all:function select_all(e){var t=this._data.core.selected.concat([]),a,r;this._data.core.selected=this._model.data[_.jstree.root].children_d.concat();for(a=0,r=this._data.core.selected.length;a<r;a++){if(this._model.data[this._data.core.selected[a]]){this._model.data[this._data.core.selected[a]].state.selected=!0}}this.redraw(!0);this.trigger("select_all",{selected:this._data.core.selected});if(!e){this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:t})}},deselect_all:function deselect_all(e){var t=this._data.core.selected.concat([]),a,r;for(a=0,r=this._data.core.selected.length;a<r;a++){if(this._model.data[this._data.core.selected[a]]){this._model.data[this._data.core.selected[a]].state.selected=!1}}this._data.core.selected=[];this.element.find(".jstree-clicked").removeClass("jstree-clicked").attr("aria-selected",!1);this.trigger("deselect_all",{selected:this._data.core.selected,node:t});if(!e){this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:t})}},is_selected:function is_selected(e){e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}return e.state.selected},get_selected:function get_selected(e){return e?_.map(this._data.core.selected,function(e){return this.get_node(e)}.bind(this)):this._data.core.selected.slice()},get_top_selected:function get_top_selected(e){var t=this.get_selected(!0),a={},r,d,n,s;for(r=0,d=t.length;r<d;r++){a[t[r].id]=t[r]}for(r=0,d=t.length;r<d;r++){for(n=0,s=t[r].children_d.length;n<s;n++){if(a[t[r].children_d[n]]){delete a[t[r].children_d[n]]}}}t=[];for(r in a){if(a.hasOwnProperty(r)){t.push(r)}}return e?_.map(t,function(e){return this.get_node(e)}.bind(this)):t},get_bottom_selected:function get_bottom_selected(e){var t=this.get_selected(!0),a=[],r,d;for(r=0,d=t.length;r<d;r++){if(!t[r].children.length){a.push(t[r].id)}}return e?_.map(a,function(e){return this.get_node(e)}.bind(this)):a},get_state:function get_state(){var e={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}},t;for(t in this._model.data){if(this._model.data.hasOwnProperty(t)){if(t!==_.jstree.root){if(this._model.data[t].state.loaded&&this.settings.core.loaded_state){e.core.loaded.push(t)}if(this._model.data[t].state.opened){e.core.open.push(t)}if(this._model.data[t].state.selected){e.core.selected.push(t)}}}}return e},set_state:function set_state(e,t){if(e){if(e.core&&e.core.selected&&e.core.initial_selection===void 0){e.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")}if(e.core){var a,r;if(e.core.loaded){if(!this.settings.core.loaded_state||!_.vakata.is_array(e.core.loaded)||!e.core.loaded.length){delete e.core.loaded;this.set_state(e,t)}else{this._load_nodes(e.core.loaded,function(){delete e.core.loaded;this.set_state(e,t)})}return!1}if(e.core.open){if(!_.vakata.is_array(e.core.open)||!e.core.open.length){delete e.core.open;this.set_state(e,t)}else{this._load_nodes(e.core.open,function(a){this.open_node(a,!1,0);delete e.core.open;this.set_state(e,t)})}return!1}if(e.core.scroll){if(e.core.scroll&&e.core.scroll.left!==void 0){this.element.scrollLeft(e.core.scroll.left)}if(e.core.scroll&&e.core.scroll.top!==void 0){this.element.scrollTop(e.core.scroll.top)}delete e.core.scroll;this.set_state(e,t);return!1}if(e.core.selected){a=this;if(e.core.initial_selection===void 0||e.core.initial_selection===this._data.core.selected.concat([]).sort().join(",")){this.deselect_all();_.each(e.core.selected,function(e,t){a.select_node(t,!1,!0)})}delete e.core.initial_selection;delete e.core.selected;this.set_state(e,t);return!1}for(r in e){if(e.hasOwnProperty(r)&&"core"!==r&&-1===_.inArray(r,this.settings.plugins)){delete e[r]}}if(_.isEmptyObject(e.core)){delete e.core;this.set_state(e,t);return!1}}if(_.isEmptyObject(e)){e=null;if(t){t.call(this)}this.trigger("set_state");return!1}return!0}return!1},refresh:function refresh(e,t){this._data.core.state=!0===t?{}:this.get_state();if(t&&_.vakata.is_function(t)){this._data.core.state=t.call(this,this._data.core.state)}this._cnt=0;this._model.data={};this._model.data[_.jstree.root]={id:_.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}};this._data.core.selected=[];this._data.core.last_clicked=null;this._data.core.focused=null;var a=this.get_container_ul()[0].className;if(!e){this.element.html("<ul class='"+a+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading")}this.load_node(_.jstree.root,function(e,t){if(t){this.get_container_ul()[0].className=a;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.set_state(_.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})}this._data.core.state=null})},refresh_node:function refresh_node(e){e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}var t=[],a=[],r=this._data.core.selected.concat([]);a.push(e.id);if(!0===e.state.opened){t.push(e.id)}this.get_node(e,!0).find(".jstree-open").each(function(){a.push(this.id);t.push(this.id)});this._load_nodes(a,function(a){this.open_node(t,!1,0);this.select_node(r);this.trigger("refresh_node",{node:e,nodes:a})}.bind(this),!1,!0)},set_id:function set_id(e,t){e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}var a,r,d=this._model.data,n=e.id;t=t.toString();d[e.parent].children[_.inArray(e.id,d[e.parent].children)]=t;for(a=0,r=e.parents.length;a<r;a++){d[e.parents[a]].children_d[_.inArray(e.id,d[e.parents[a]].children_d)]=t}for(a=0,r=e.children.length;a<r;a++){d[e.children[a]].parent=t}for(a=0,r=e.children_d.length;a<r;a++){d[e.children_d[a]].parents[_.inArray(e.id,d[e.children_d[a]].parents)]=t}a=_.inArray(e.id,this._data.core.selected);if(-1!==a){this._data.core.selected[a]=t}a=this.get_node(e.id,!0);if(a){a.attr("id",t);if(this.element.attr("aria-activedescendant")===e.id){this.element.attr("aria-activedescendant",t)}}delete d[e.id];e.id=t;e.li_attr.id=t;d[t]=e;this.trigger("set_id",{node:e,new:e.id,old:n});return!0},get_text:function get_text(e){e=this.get_node(e);return!e||e.id===_.jstree.root?!1:e.text},set_text:function set_text(e,t){var a,r;if(_.vakata.is_array(e)){e=e.slice();for(a=0,r=e.length;a<r;a++){this.set_text(e[a],t)}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}e.text=t;if(this.get_node(e,!0).length){this.redraw_node(e.id)}this.trigger("set_text",{obj:e,text:t});return!0},get_json:function get_json(e,t,a){e=this.get_node(e||_.jstree.root);if(!e){return!1}if(t&&t.flat&&!a){a=[]}var r={id:e.id,text:e.text,icon:this.get_icon(e),li_attr:_.extend(!0,{},e.li_attr),a_attr:_.extend(!0,{},e.a_attr),state:{},data:t&&t.no_data?!1:_.extend(!0,_.vakata.is_array(e.data)?[]:{},e.data)},d,n;if(t&&t.flat){r.parent=e.parent}else{r.children=[]}if(!t||!t.no_state){for(d in e.state){if(e.state.hasOwnProperty(d)){r.state[d]=e.state[d]}}}else{delete r.state}if(t&&t.no_li_attr){delete r.li_attr}if(t&&t.no_a_attr){delete r.a_attr}if(t&&t.no_id){delete r.id;if(r.li_attr&&r.li_attr.id){delete r.li_attr.id}if(r.a_attr&&r.a_attr.id){delete r.a_attr.id}}if(t&&t.flat&&e.id!==_.jstree.root){a.push(r)}if(!t||!t.no_children){for(d=0,n=e.children.length;d<n;d++){if(t&&t.flat){this.get_json(e.children[d],t,a)}else{r.children.push(this.get_json(e.children[d],t))}}}return t&&t.flat?a:e.id===_.jstree.root?r.children:r},create_node:function create_node(e,t,a,r,d){if(null===e){e=_.jstree.root}e=this.get_node(e);if(!e){return!1}a=a===void 0?"last":a;if(!a.toString().match(/^(before|after)$/)&&!d&&!this.is_loaded(e)){return this.load_node(e,function(){this.create_node(e,t,a,r,!0)})}if(!t){t={text:this.get_string("New node")}}if("string"==typeof t){t={text:t}}else{t=_.extend(!0,{},t)}if(t.text===void 0){t.text=this.get_string("New node")}var n,s,o,l;if(e.id===_.jstree.root){if("before"===a){a="first"}if("after"===a){a="last"}}switch(a){case"before":n=this.get_node(e.parent);a=_.inArray(e.id,n.children);e=n;break;case"after":n=this.get_node(e.parent);a=_.inArray(e.id,n.children)+1;e=n;break;case"inside":case"first":a=0;break;case"last":a=e.children.length;break;default:if(!a){a=0}break;}if(a>e.children.length){a=e.children.length}if(!t.id){t.id=!0}if(!this.check("create_node",t,e,a)){this.settings.core.error.call(this,this._data.core.last_error);return!1}if(!0===t.id){delete t.id}t=this._parse_model_from_json(t,e.id,e.parents.concat());if(!t){return!1}n=this.get_node(t);s=[];s.push(t);s=s.concat(n.children_d);this.trigger("model",{nodes:s,parent:e.id});e.children_d=e.children_d.concat(s);for(o=0,l=e.parents.length;o<l;o++){this._model.data[e.parents[o]].children_d=this._model.data[e.parents[o]].children_d.concat(s)}t=n;n=[];for(o=0,l=e.children.length;o<l;o++){n[o>=a?o+1:o]=e.children[o]}n[a]=t.id;e.children=n;this.redraw_node(e,!0);this.trigger("create_node",{node:this.get_node(t),parent:e.id,position:a});if(r){r.call(this,this.get_node(t))}return t.id},rename_node:function rename_node(e,t){var a,r,d;if(_.vakata.is_array(e)){e=e.slice();for(a=0,r=e.length;a<r;a++){this.rename_node(e[a],t)}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}d=e.text;if(!this.check("rename_node",e,this.get_parent(e),t)){this.settings.core.error.call(this,this._data.core.last_error);return!1}this.set_text(e,t);this.trigger("rename_node",{node:e,text:t,old:d});return!0},delete_node:function delete_node(e){var t,a,r,d,n,s,o,h,g,p,m,u;if(_.vakata.is_array(e)){e=e.slice();for(t=0,a=e.length;t<a;t++){this.delete_node(e[t])}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}r=this.get_node(e.parent);d=_.inArray(e.id,r.children);p=!1;if(!this.check("delete_node",e,r,d)){this.settings.core.error.call(this,this._data.core.last_error);return!1}if(-1!==d){r.children=_.vakata.array_remove(r.children,d)}n=e.children_d.concat([]);n.push(e.id);for(s=0,o=e.parents.length;s<o;s++){this._model.data[e.parents[s]].children_d=_.vakata.array_filter(this._model.data[e.parents[s]].children_d,function(e){return-1===_.inArray(e,n)})}for(h=0,g=n.length;h<g;h++){if(this._model.data[n[h]].state.selected){p=!0;break}}if(p){this._data.core.selected=_.vakata.array_filter(this._data.core.selected,function(e){return-1===_.inArray(e,n)})}this.trigger("delete_node",{node:e,parent:r.id});if(p){this.trigger("changed",{action:"delete_node",node:e,selected:this._data.core.selected,parent:r.id})}for(h=0,g=n.length;h<g;h++){delete this._model.data[n[h]]}if(-1!==_.inArray(this._data.core.focused,n)){this._data.core.focused=null;m=this.element[0].scrollTop;u=this.element[0].scrollLeft;if(r.id===_.jstree.root){if(this._model.data[_.jstree.root].children[0]){this.get_node(this._model.data[_.jstree.root].children[0],!0).children(".jstree-anchor").triger("focus")}}else{this.get_node(r,!0).children(".jstree-anchor").trigger("focus")}this.element[0].scrollTop=m;this.element[0].scrollLeft=u}this.redraw_node(r,!0);return!0},check:function check(e,t,a,r,d){t=t&&t.id?t:this.get_node(t);a=a&&a.id?a:this.get_node(a);var n=e.match(/^move_node|copy_node|create_node$/i)?a:t,s=this.settings.core.check_callback;if("move_node"===e||"copy_node"===e){if((!d||!d.is_multi)&&"move_node"===e&&_.inArray(t.id,a.children)===r){this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:e,pos:r,obj:t&&t.id?t.id:!1,par:a&&a.id?a.id:!1})};return!1}if((!d||!d.is_multi)&&(t.id===a.id||"move_node"===e&&_.inArray(t.id,a.children)===r||-1!==_.inArray(a.id,t.children_d))){this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:e,pos:r,obj:t&&t.id?t.id:!1,par:a&&a.id?a.id:!1})};return!1}}if(n&&n.data){n=n.data}if(n&&n.functions&&(!1===n.functions[e]||!0===n.functions[e])){if(!1===n.functions[e]){this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:t&&t.id?t.id:!1,par:a&&a.id?a.id:!1})}}return n.functions[e]}if(!1===s||_.vakata.is_function(s)&&!1===s.call(this,e,t,a,r,d)||s&&!1===s[e]){this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:t&&t.id?t.id:!1,par:a&&a.id?a.id:!1})};return!1}return!0},last_error:function last_error(){return this._data.core.last_error},move_node:function move_node(e,t,a,r,d,n,s){var o,c,h,g,m,u,f,v,b,y,x,w,C,N;t=this.get_node(t);a=a===void 0?0:a;if(!t){return!1}if(!a.toString().match(/^(before|after)$/)&&!d&&!this.is_loaded(t)){return this.load_node(t,function(){this.move_node(e,t,a,r,!0,!1,s)})}if(_.vakata.is_array(e)){if(1===e.length){e=e[0]}else{for(o=0,c=e.length;o<c;o++){if(b=this.move_node(e[o],t,a,r,d,!1,s)){t=b;a="after"}}this.redraw();return!0}}e=e&&e.id?e:this.get_node(e);if(!e||e.id===_.jstree.root){return!1}h=(e.parent||_.jstree.root).toString();m=!a.toString().match(/^(before|after)$/)||t.id===_.jstree.root?t:this.get_node(t.parent);u=s?s:this._model.data[e.id]?this:_.jstree.reference(e.id);f=!u||!u._id||this._id!==u._id;g=u&&u._id&&h&&u._model.data[h]&&u._model.data[h].children?_.inArray(e.id,u._model.data[h].children):-1;if(u&&u._id){e=u._model.data[e.id]}if(f){if(b=this.copy_node(e,t,a,r,d,!1,s)){if(u){u.delete_node(e)}return b}return!1}if(t.id===_.jstree.root){if("before"===a){a="first"}if("after"===a){a="last"}}switch(a){case"before":a=_.inArray(t.id,m.children);break;case"after":a=_.inArray(t.id,m.children)+1;break;case"inside":case"first":a=0;break;case"last":a=m.children.length;break;default:if(!a){a=0}break;}if(a>m.children.length){a=m.children.length}if(!this.check("move_node",e,m,a,{core:!0,origin:s,is_multi:u&&u._id&&u._id!==this._id,is_foreign:!u||!u._id})){this.settings.core.error.call(this,this._data.core.last_error);return!1}if(e.parent===m.id){v=m.children.concat();b=_.inArray(e.id,v);if(-1!==b){v=_.vakata.array_remove(v,b);if(a>b){a--}}b=[];for(y=0,x=v.length;y<x;y++){b[y>=a?y+1:y]=v[y]}b[a]=e.id;m.children=b;this._node_changed(m.id);this.redraw(m.id===_.jstree.root)}else{b=e.children_d.concat();b.push(e.id);for(y=0,x=e.parents.length;y<x;y++){v=[];N=u._model.data[e.parents[y]].children_d;for(w=0,C=N.length;w<C;w++){if(-1===_.inArray(N[w],b)){v.push(N[w])}}u._model.data[e.parents[y]].children_d=v}u._model.data[h].children=_.vakata.array_remove_item(u._model.data[h].children,e.id);for(y=0,x=m.parents.length;y<x;y++){this._model.data[m.parents[y]].children_d=this._model.data[m.parents[y]].children_d.concat(b)}v=[];for(y=0,x=m.children.length;y<x;y++){v[y>=a?y+1:y]=m.children[y]}v[a]=e.id;m.children=v;m.children_d.push(e.id);m.children_d=m.children_d.concat(e.children_d);e.parent=m.id;b=m.parents.concat();b.unshift(m.id);N=e.parents.length;e.parents=b;b=b.concat();for(y=0,x=e.children_d.length;y<x;y++){this._model.data[e.children_d[y]].parents=this._model.data[e.children_d[y]].parents.slice(0,-1*N);Array.prototype.push.apply(this._model.data[e.children_d[y]].parents,b)}if(h===_.jstree.root||m.id===_.jstree.root){this._model.force_full_redraw=!0}if(!this._model.force_full_redraw){this._node_changed(h);this._node_changed(m.id)}if(!n){this.redraw()}}if(r){r.call(this,e,m,a)}this.trigger("move_node",{node:e,parent:m.id,position:a,old_parent:h,old_position:g,is_multi:u&&u._id&&u._id!==this._id,is_foreign:!u||!u._id,old_instance:u,new_instance:this});return e.id},copy_node:function copy_node(e,t,a,r,d,n,s){var o,l,c,h,g,p,m,u,f,k;t=this.get_node(t);a=a===void 0?0:a;if(!t){return!1}if(!a.toString().match(/^(before|after)$/)&&!d&&!this.is_loaded(t)){return this.load_node(t,function(){this.copy_node(e,t,a,r,!0,!1,s)})}if(_.vakata.is_array(e)){if(1===e.length){e=e[0]}else{for(o=0,l=e.length;o<l;o++){if(h=this.copy_node(e[o],t,a,r,d,!0,s)){t=h;a="after"}}this.redraw();return!0}}e=e&&e.id?e:this.get_node(e);if(!e||e.id===_.jstree.root){return!1}u=(e.parent||_.jstree.root).toString();f=!a.toString().match(/^(before|after)$/)||t.id===_.jstree.root?t:this.get_node(t.parent);k=s?s:this._model.data[e.id]?this:_.jstree.reference(e.id);!k||!k._id||this._id!==k._id;if(k&&k._id){e=k._model.data[e.id]}if(t.id===_.jstree.root){if("before"===a){a="first"}if("after"===a){a="last"}}switch(a){case"before":a=_.inArray(t.id,f.children);break;case"after":a=_.inArray(t.id,f.children)+1;break;case"inside":case"first":a=0;break;case"last":a=f.children.length;break;default:if(!a){a=0}break;}if(a>f.children.length){a=f.children.length}if(!this.check("copy_node",e,f,a,{core:!0,origin:s,is_multi:k&&k._id&&k._id!==this._id,is_foreign:!k||!k._id})){this.settings.core.error.call(this,this._data.core.last_error);return!1}m=k?k.get_json(e,{no_id:!0,no_data:!0,no_state:!0}):e;if(!m){return!1}if(!0===m.id){delete m.id}m=this._parse_model_from_json(m,f.id,f.parents.concat());if(!m){return!1}h=this.get_node(m);if(e&&e.state&&!1===e.state.loaded){h.state.loaded=!1}c=[];c.push(m);c=c.concat(h.children_d);this.trigger("model",{nodes:c,parent:f.id});for(g=0,p=f.parents.length;g<p;g++){this._model.data[f.parents[g]].children_d=this._model.data[f.parents[g]].children_d.concat(c)}c=[];for(g=0,p=f.children.length;g<p;g++){c[g>=a?g+1:g]=f.children[g]}c[a]=h.id;f.children=c;f.children_d.push(h.id);f.children_d=f.children_d.concat(h.children_d);if(f.id===_.jstree.root){this._model.force_full_redraw=!0}if(!this._model.force_full_redraw){this._node_changed(f.id)}if(!n){this.redraw(f.id===_.jstree.root)}if(r){r.call(this,h,f,a)}this.trigger("copy_node",{node:h,original:e,parent:f.id,position:a,old_parent:u,old_position:k&&k._id&&u&&k._model.data[u]&&k._model.data[u].children?_.inArray(e.id,k._model.data[u].children):-1,is_multi:k&&k._id&&k._id!==this._id,is_foreign:!k||!k._id,old_instance:k,new_instance:this});return h.id},cut:function cut(e){if(!e){e=this._data.core.selected.concat()}if(!_.vakata.is_array(e)){e=[e]}if(!e.length){return!1}var d=[],n,s,i;for(s=0,i=e.length;s<i;s++){n=this.get_node(e[s]);if(n&&n.id&&n.id!==_.jstree.root){d.push(n)}}if(!d.length){return!1}t=d;r=this;a="move_node";this.trigger("cut",{node:e})},copy:function copy(e){if(!e){e=this._data.core.selected.concat()}if(!_.vakata.is_array(e)){e=[e]}if(!e.length){return!1}var d=[],n,s,i;for(s=0,i=e.length;s<i;s++){n=this.get_node(e[s]);if(n&&n.id&&n.id!==_.jstree.root){d.push(n)}}if(!d.length){return!1}t=d;r=this;a="copy_node";this.trigger("copy",{node:e})},get_buffer:function get_buffer(){return{mode:a,node:t,inst:r}},can_paste:function can_paste(){return!1!==a&&!1!==t},paste:function paste(e,d){e=this.get_node(e);if(!e||!a||!a.match(/^(copy_node|move_node)$/)||!t){return!1}if(this[a](t,e,d,!1,!1,!1,r)){this.trigger("paste",{parent:e.id,node:t,mode:a})}t=!1;a=!1;r=!1},clear_buffer:function clear_buffer(){t=!1;a=!1;r=!1;this.trigger("clear_buffer")},edit:function edit(r,d,n){var i,l,c,h,g,p,m,e,u,j=!1;r=this.get_node(r);if(!r){return!1}if(!this.check("edit",r,this.get_parent(r))){this.settings.core.error.call(this,this._data.core.last_error);return!1}u=r;d="string"==typeof d?d:r.text;this.set_text(r,"");r=this._open_to(r);u.text=d;i=this._data.core.rtl;l=this.element.width();this._data.core.focused=u.id;c=r.children(".jstree-anchor").trigger("focus");h=_("<span></span>");g=d;p=_("<div></div>",{css:{position:"absolute",top:"-200px",left:i?"0px":"-1000px",visibility:"hidden"}}).appendTo(o.body);m=_("<input />",{value:g,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:function(t){t.stopImmediatePropagation();t.preventDefault();var e=h.children(".jstree-rename-input"),a=e.val(),d=this.settings.core.force_text,s;if(""===a){a=g}p.remove();h.replaceWith(c);h.remove();g=d?g:_("<div></div>").append(_.parseHTML(g)).html();r=this.get_node(r);this.set_text(r,g);s=!!this.rename_node(r,d?_("<div></div>").text(a).text():_("<div></div>").append(_.parseHTML(a)).html());if(!s){this.set_text(r,g)}this._data.core.focused=u.id;setTimeout(function(){var e=this.get_node(u.id,!0);if(e.length){this._data.core.focused=u.id;e.children(".jstree-anchor").trigger("focus")}}.bind(this),0);if(n){n.call(this,u,s,j,a)}m=null}.bind(this),keydown:function keydown(t){var e=t.which;if(27===e){j=!0;this.value=g}if(27===e||13===e||37===e||38===e||39===e||40===e||32===e){t.stopImmediatePropagation()}if(27===e||13===e){t.preventDefault();this.blur()}},click:function click(t){t.stopImmediatePropagation()},mousedown:function mousedown(t){t.stopImmediatePropagation()},keyup:function keyup(){m.width(Math.min(p.text("pW"+this.value).width(),l))},keypress:function keypress(t){if(13===t.which){return!1}}});e={fontFamily:c.css("fontFamily")||"",fontSize:c.css("fontSize")||"",fontWeight:c.css("fontWeight")||"",fontStyle:c.css("fontStyle")||"",fontStretch:c.css("fontStretch")||"",fontVariant:c.css("fontVariant")||"",letterSpacing:c.css("letterSpacing")||"",wordSpacing:c.css("wordSpacing")||""};h.attr("class",c.attr("class")).append(c.contents().clone()).append(m);c.replaceWith(h);p.css(e);m.css(e).width(Math.min(p.text("pW"+m[0].value).width(),l))[0].select();_(o).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){if(m&&t.target!==m){_(m).trigger("blur")}})},set_theme:function set_theme(e,t){if(!e){return!1}if(!0===t){var a=this.settings.core.themes.dir;if(!a){a=_.jstree.path+"/themes"}t=a+"/"+e+"/style.css"}if(t&&-1===_.inArray(t,d)){_("head").append("<link rel=\"stylesheet\" href=\""+t+"\" type=\"text/css\" />");d.push(t)}if(this._data.core.themes.name){this.element.removeClass("jstree-"+this._data.core.themes.name)}this._data.core.themes.name=e;this.element.addClass("jstree-"+e);this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+e+"-responsive");this.trigger("set_theme",{theme:e})},get_theme:function get_theme(){return this._data.core.themes.name},set_theme_variant:function set_theme_variant(e){if(this._data.core.themes.variant){this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}this._data.core.themes.variant=e;if(e){this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}},get_theme_variant:function get_theme_variant(){return this._data.core.themes.variant},show_stripes:function show_stripes(){this._data.core.themes.stripes=!0;this.get_container_ul().addClass("jstree-striped");this.trigger("show_stripes")},hide_stripes:function hide_stripes(){this._data.core.themes.stripes=!1;this.get_container_ul().removeClass("jstree-striped");this.trigger("hide_stripes")},toggle_stripes:function toggle_stripes(){if(this._data.core.themes.stripes){this.hide_stripes()}else{this.show_stripes()}},show_dots:function show_dots(){this._data.core.themes.dots=!0;this.get_container_ul().removeClass("jstree-no-dots");this.trigger("show_dots")},hide_dots:function hide_dots(){this._data.core.themes.dots=!1;this.get_container_ul().addClass("jstree-no-dots");this.trigger("hide_dots")},toggle_dots:function toggle_dots(){if(this._data.core.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function show_icons(){this._data.core.themes.icons=!0;this.get_container_ul().removeClass("jstree-no-icons");this.trigger("show_icons")},hide_icons:function hide_icons(){this._data.core.themes.icons=!1;this.get_container_ul().addClass("jstree-no-icons");this.trigger("hide_icons")},toggle_icons:function toggle_icons(){if(this._data.core.themes.icons){this.hide_icons()}else{this.show_icons()}},show_ellipsis:function show_ellipsis(){this._data.core.themes.ellipsis=!0;this.get_container_ul().addClass("jstree-ellipsis");this.trigger("show_ellipsis")},hide_ellipsis:function hide_ellipsis(){this._data.core.themes.ellipsis=!1;this.get_container_ul().removeClass("jstree-ellipsis");this.trigger("hide_ellipsis")},toggle_ellipsis:function toggle_ellipsis(){if(this._data.core.themes.ellipsis){this.hide_ellipsis()}else{this.show_ellipsis()}},set_icon:function set_icon(e,t){var a,r,d,n;if(_.vakata.is_array(e)){e=e.slice();for(a=0,r=e.length;a<r;a++){this.set_icon(e[a],t)}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}n=e.icon;e.icon=!0===t||null===t||t===void 0||""===t?!0:t;d=this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon");if(!1===t){d.removeClass("jstree-themeicon-custom "+n).css("background","").removeAttr("rel");this.hide_icon(e)}else if(!0===t||null===t||t===void 0||""===t){d.removeClass("jstree-themeicon-custom "+n).css("background","").removeAttr("rel");if(!1===n){this.show_icon(e)}}else if(-1===t.indexOf("/")&&-1===t.indexOf(".")){d.removeClass(n).css("background","");d.addClass(t+" jstree-themeicon-custom").attr("rel",t);if(!1===n){this.show_icon(e)}}else{d.removeClass(n).css("background","");d.addClass("jstree-themeicon-custom").css("background","url('"+t+"') center center no-repeat").attr("rel",t);if(!1===n){this.show_icon(e)}}return!0},get_icon:function get_icon(e){e=this.get_node(e);return!e||e.id===_.jstree.root?!1:e.icon},hide_icon:function hide_icon(e){var t,a;if(_.vakata.is_array(e)){e=e.slice();for(t=0,a=e.length;t<a;t++){this.hide_icon(e[t])}return!0}e=this.get_node(e);if(!e||e===_.jstree.root){return!1}e.icon=!1;this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden");return!0},show_icon:function show_icon(e){var t,a,r;if(_.vakata.is_array(e)){e=e.slice();for(t=0,a=e.length;t<a;t++){this.show_icon(e[t])}return!0}e=this.get_node(e);if(!e||e===_.jstree.root){return!1}r=this.get_node(e,!0);e.icon=r.length?r.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):!0;if(!e.icon){e.icon=!0}r.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden");return!0}};_.vakata={};_.vakata.attributes=function(e,t){e=_(e)[0];var a=t?{}:[];if(e&&e.attributes){_.each(e.attributes,function(e,r){if(-1!==_.inArray(r.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])){return}if(null!==r.value&&""!==_.vakata.trim(r.value)){if(t){a[r.name]=r.value}else{a.push(r.name)}}})}return a};_.vakata.array_unique=function(e){var t=[],a,r,d={};for(a=0,r=e.length;a<r;a++){if(d[e[a]]===void 0){t.push(e[a]);d[e[a]]=!0}}return t};_.vakata.array_remove=function(e,t){e.splice(t,1);return e};_.vakata.array_remove_item=function(e,t){var a=_.inArray(t,e);return-1!==a?_.vakata.array_remove(e,a):e};_.vakata.array_filter=function(t,r,a,n,s){if(t.filter){return t.filter(r,a)}n=[];for(s in t){if(~~s+""==s+""&&0<=s&&r.call(a,t[s],+s,t)){n.push(t[s])}}return n};_.vakata.trim=function(e){return String.prototype.trim?String.prototype.trim.call(e.toString()):e.toString().replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};_.vakata.is_function=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType};_.vakata.is_array=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};if(!Function.prototype.bind){Function.prototype.bind=function(){var e=this,t=arguments[0],a=Array.prototype.slice.call(arguments,1);if("function"!=typeof e){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}return function(){var r=a.concat(Array.prototype.slice.call(arguments));return e.apply(t,r)}}}_.jstree.plugins.changed=function(e,t){var a=[];this.trigger=function(e,r){var d,n;if(!r){r={}}if("changed"===e.replace(".jstree","")){r.changed={selected:[],deselected:[]};var s={};for(d=0,n=a.length;d<n;d++){s[a[d]]=1}for(d=0,n=r.selected.length;d<n;d++){if(!s[r.selected[d]]){r.changed.selected.push(r.selected[d])}else{s[r.selected[d]]=2}}for(d=0,n=a.length;d<n;d++){if(1===s[a[d]]){r.changed.deselected.push(a[d])}}a=r.selected.slice()}t.trigger.call(this,e,r)};this.refresh=function(){a=[];return t.refresh.apply(this,arguments)}};var h=o.createElement("I");h.className="jstree-icon jstree-checkbox";h.setAttribute("role","presentation");_.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0};_.jstree.plugins.checkbox=function(e,t){this.bind=function(){t.bind.call(this);this._data.checkbox.uto=!1;this._data.checkbox.selected=[];if(this.settings.checkbox.three_state){this.settings.checkbox.cascade="up+down+undetermined"}this.element.on("init.jstree",function(){this._data.checkbox.visible=this.settings.checkbox.visible;if(!this.settings.checkbox.keep_selected_style){this.element.addClass("jstree-checkbox-no-clicked")}if(this.settings.checkbox.tie_selection){this.element.addClass("jstree-checkbox-selection")}}.bind(this)).on("loading.jstree",function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()}.bind(this));if(-1!==this.settings.checkbox.cascade.indexOf("undetermined")){this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",function(){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)}this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)}.bind(this))}if(!this.settings.checkbox.tie_selection){this.element.on("model.jstree",function(t,e){var a=this._model.data,r=a[e.parent],d=e.nodes,n,s;for(n=0,s=d.length;n<s;n++){a[d[n]].state.checked=a[d[n]].state.checked||a[d[n]].original&&a[d[n]].original.state&&a[d[n]].original.state.checked;if(a[d[n]].state.checked){this._data.checkbox.selected.push(d[n])}}}.bind(this))}if(-1!==this.settings.checkbox.cascade.indexOf("up")||-1!==this.settings.checkbox.cascade.indexOf("down")){this.element.on("model.jstree",function(a,e){var r=this._model.data,d=r[e.parent],n=e.nodes,o=[],h,g,m,u,f,v,b=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection;if(-1!==b.indexOf("down")){if(d.state[s?"selected":"checked"]){for(g=0,m=n.length;g<m;g++){r[n[g]].state[s?"selected":"checked"]=!0}this._data[s?"core":"checkbox"].selected=this._data[s?"core":"checkbox"].selected.concat(n)}else{for(g=0,m=n.length;g<m;g++){if(r[n[g]].state[s?"selected":"checked"]){for(u=0,f=r[n[g]].children_d.length;u<f;u++){r[r[n[g]].children_d[u]].state[s?"selected":"checked"]=!0}this._data[s?"core":"checkbox"].selected=this._data[s?"core":"checkbox"].selected.concat(r[n[g]].children_d)}}}}if(-1!==b.indexOf("up")){for(g=0,m=d.children_d.length;g<m;g++){if(!r[d.children_d[g]].children.length){o.push(r[d.children_d[g]].parent)}}o=_.vakata.array_unique(o);for(u=0,f=o.length;u<f;u++){d=r[o[u]];while(d&&d.id!==_.jstree.root){h=0;for(g=0,m=d.children.length;g<m;g++){h+=r[d.children[g]].state[s?"selected":"checked"]}if(h===m){d.state[s?"selected":"checked"]=!0;this._data[s?"core":"checkbox"].selected.push(d.id);v=this.get_node(d,!0);if(v&&v.length){v.attr("aria-selected",!0).children(".jstree-anchor").addClass(s?"jstree-clicked":"jstree-checked")}}else{break}d=this.get_node(d.parent)}}}this._data[s?"core":"checkbox"].selected=_.vakata.array_unique(this._data[s?"core":"checkbox"].selected)}.bind(this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",function(a,e){var r=this,d=e.node,n=this._model.data,o=this.get_node(d.parent),l,h,g,p,m=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection,t={},u=this._data[s?"core":"checkbox"].selected;for(l=0,h=u.length;l<h;l++){t[u[l]]=!0}if(-1!==m.indexOf("down")){var f=this._cascade_new_checked_state(d.id,!0),k=d.children_d.concat(d.id);for(l=0,h=k.length;l<h;l++){if(-1<f.indexOf(k[l])){t[k[l]]=!0}else{delete t[k[l]]}}}if(-1!==m.indexOf("up")){while(o&&o.id!==_.jstree.root){g=0;for(l=0,h=o.children.length;l<h;l++){g+=n[o.children[l]].state[s?"selected":"checked"]}if(g===h){o.state[s?"selected":"checked"]=!0;t[o.id]=!0;p=this.get_node(o,!0);if(p&&p.length){p.attr("aria-selected",!0).children(".jstree-anchor").addClass(s?"jstree-clicked":"jstree-checked")}}else{break}o=this.get_node(o.parent)}}u=[];for(l in t){if(t.hasOwnProperty(l)){u.push(l)}}this._data[s?"core":"checkbox"].selected=u}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",function(){var e=this.get_node(_.jstree.root),t=this._model.data,a,r,d;for(a=0,r=e.children_d.length;a<r;a++){d=t[e.children_d[a]];if(d&&d.original&&d.original.state&&d.original.state.undetermined){d.original.state.undetermined=!1}}}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",function(a,e){var r=this,d=e.node,n=this.get_node(d,!0),o,l,c,h=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection,t=this._data[s?"core":"checkbox"].selected,g=d.children_d.concat(d.id);if(-1!==h.indexOf("down")){var p=this._cascade_new_checked_state(d.id,!1);t=_.vakata.array_filter(t,function(e){return-1===g.indexOf(e)||-1<p.indexOf(e)})}if(-1!==h.indexOf("up")&&-1===t.indexOf(d.id)){for(o=0,l=d.parents.length;o<l;o++){c=this._model.data[d.parents[o]];c.state[s?"selected":"checked"]=!1;if(c&&c.original&&c.original.state&&c.original.state.undetermined){c.original.state.undetermined=!1}c=this.get_node(d.parents[o],!0);if(c&&c.length){c.attr("aria-selected",!1).children(".jstree-anchor").removeClass(s?"jstree-clicked":"jstree-checked")}}t=_.vakata.array_filter(t,function(e){return-1===d.parents.indexOf(e)})}this._data[s?"core":"checkbox"].selected=t}.bind(this))}if(-1!==this.settings.checkbox.cascade.indexOf("up")){this.element.on("delete_node.jstree",function(a,e){var r=this.get_node(e.parent),d=this._model.data,n,s,o,l,h=this.settings.checkbox.tie_selection;while(r&&r.id!==_.jstree.root&&!r.state[h?"selected":"checked"]){o=0;for(n=0,s=r.children.length;n<s;n++){o+=d[r.children[n]].state[h?"selected":"checked"]}if(0<s&&o===s){r.state[h?"selected":"checked"]=!0;this._data[h?"core":"checkbox"].selected.push(r.id);l=this.get_node(r,!0);if(l&&l.length){l.attr("aria-selected",!0).children(".jstree-anchor").addClass(h?"jstree-clicked":"jstree-checked")}}else{break}r=this.get_node(r.parent)}}.bind(this)).on("move_node.jstree",function(a,e){var r=e.is_multi,d=e.old_parent,n=this.get_node(e.parent),s=this._model.data,o,l,h,g,m,u=this.settings.checkbox.tie_selection;if(!r){o=this.get_node(d);while(o&&o.id!==_.jstree.root&&!o.state[u?"selected":"checked"]){l=0;for(h=0,g=o.children.length;h<g;h++){l+=s[o.children[h]].state[u?"selected":"checked"]}if(0<g&&l===g){o.state[u?"selected":"checked"]=!0;this._data[u?"core":"checkbox"].selected.push(o.id);m=this.get_node(o,!0);if(m&&m.length){m.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked")}}else{break}o=this.get_node(o.parent)}}o=n;while(o&&o.id!==_.jstree.root){l=0;for(h=0,g=o.children.length;h<g;h++){l+=s[o.children[h]].state[u?"selected":"checked"]}if(l===g){if(!o.state[u?"selected":"checked"]){o.state[u?"selected":"checked"]=!0;this._data[u?"core":"checkbox"].selected.push(o.id);m=this.get_node(o,!0);if(m&&m.length){m.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked")}}}else{if(o.state[u?"selected":"checked"]){o.state[u?"selected":"checked"]=!1;this._data[u?"core":"checkbox"].selected=_.vakata.array_remove_item(this._data[u?"core":"checkbox"].selected,o.id);m=this.get_node(o,!0);if(m&&m.length){m.attr("aria-selected",!1).children(".jstree-anchor").removeClass(u?"jstree-clicked":"jstree-checked")}}else{break}}o=this.get_node(o.parent)}}.bind(this))}};this.get_undetermined=function(e){if(-1===this.settings.checkbox.cascade.indexOf("undetermined")){return[]}var a,d,n,c,h={},o=this._model.data,g=this.settings.checkbox.tie_selection,t=this._data[g?"core":"checkbox"].selected,s=[],p=this,m=[];for(a=0,d=t.length;a<d;a++){if(o[t[a]]&&o[t[a]].parents){for(n=0,c=o[t[a]].parents.length;n<c;n++){if(h[o[t[a]].parents[n]]!==void 0){break}if(o[t[a]].parents[n]!==_.jstree.root){h[o[t[a]].parents[n]]=!0;s.push(o[t[a]].parents[n])}}}}this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var e=p.get_node(this),t;if(!e){return}if(!e.state.loaded){if(e.original&&e.original.state&&e.original.state.undetermined&&!0===e.original.state.undetermined){if(h[e.id]===void 0&&e.id!==_.jstree.root){h[e.id]=!0;s.push(e.id)}for(n=0,c=e.parents.length;n<c;n++){if(h[e.parents[n]]===void 0&&e.parents[n]!==_.jstree.root){h[e.parents[n]]=!0;s.push(e.parents[n])}}}}else{for(a=0,d=e.children_d.length;a<d;a++){t=o[e.children_d[a]];if(!t.state.loaded&&t.original&&t.original.state&&t.original.state.undetermined&&!0===t.original.state.undetermined){if(h[t.id]===void 0&&t.id!==_.jstree.root){h[t.id]=!0;s.push(t.id)}for(n=0,c=t.parents.length;n<c;n++){if(h[t.parents[n]]===void 0&&t.parents[n]!==_.jstree.root){h[t.parents[n]]=!0;s.push(t.parents[n])}}}}}});for(a=0,d=s.length;a<d;a++){if(!o[s[a]].state[g?"selected":"checked"]){m.push(e?o[s[a]]:s[a])}}return m};this._undetermined=function(){if(null===this.element){return}var e=this.get_undetermined(!1),t,a,r;this.element.find(".jstree-undetermined").removeClass("jstree-undetermined");for(t=0,a=e.length;t<a;t++){r=this.get_node(e[t],!0);if(r&&r.length){r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}}};this.redraw_node=function(e,a,r){e=t.redraw_node.apply(this,arguments);if(e){var d,n,s=null,o=null;for(d=0,n=e.childNodes.length;d<n;d++){if(e.childNodes[d]&&e.childNodes[d].className&&-1!==e.childNodes[d].className.indexOf("jstree-anchor")){s=e.childNodes[d];break}}if(s){if(!this.settings.checkbox.tie_selection&&this._model.data[e.id].state.checked){s.className+=" jstree-checked"}o=h.cloneNode(!1);if(this._model.data[e.id].state.checkbox_disabled){o.className+=" jstree-checkbox-disabled"}s.insertBefore(o,s.childNodes[0])}}if(!r&&-1!==this.settings.checkbox.cascade.indexOf("undetermined")){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)}this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)}return e};this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0;this.get_container_ul().removeClass("jstree-no-checkboxes")};this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1;this.get_container_ul().addClass("jstree-no-checkboxes")};this.toggle_checkboxes=function(){if(this._data.core.themes.checkboxes){this.hide_checkboxes()}else{this.show_checkboxes()}};this.is_undetermined=function(e){e=this.get_node(e);var a=this.settings.checkbox.cascade,r,n,s=this.settings.checkbox.tie_selection,t=this._data[s?"core":"checkbox"].selected,d=this._model.data;if(!e||!0===e.state[s?"selected":"checked"]||-1===a.indexOf("undetermined")||-1===a.indexOf("down")&&-1===a.indexOf("up")){return!1}if(!e.state.loaded&&!0===e.original.state.undetermined){return!0}for(r=0,n=e.children_d.length;r<n;r++){if(-1!==_.inArray(e.children_d[r],t)||!d[e.children_d[r]].state.loaded&&d[e.children_d[r]].original.state.undetermined){return!0}}return!1};this.disable_checkbox=function(e){var t,a,r;if(_.vakata.is_array(e)){e=e.slice();for(t=0,a=e.length;t<a;t++){this.disable_checkbox(e[t])}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}r=this.get_node(e,!0);if(!e.state.checkbox_disabled){e.state.checkbox_disabled=!0;if(r&&r.length){r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled")}this.trigger("disable_checkbox",{node:e})}};this.enable_checkbox=function(e){var t,a,r;if(_.vakata.is_array(e)){e=e.slice();for(t=0,a=e.length;t<a;t++){this.enable_checkbox(e[t])}return!0}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}r=this.get_node(e,!0);if(e.state.checkbox_disabled){e.state.checkbox_disabled=!1;if(r&&r.length){r.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled")}this.trigger("enable_checkbox",{node:e})}};this.activate_node=function(a,r){if(_(r.target).hasClass("jstree-checkbox-disabled")){return!1}if(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||_(r.target).hasClass("jstree-checkbox"))){r.ctrlKey=!0}if(this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!_(r.target).hasClass("jstree-checkbox")){return t.activate_node.call(this,a,r)}if(this.is_disabled(a)){return!1}if(this.is_checked(a)){this.uncheck_node(a,r)}else{this.check_node(a,r)}this.trigger("activate_node",{node:this.get_node(a)})};this._cascade_new_checked_state=function(e,a){var r=this,d=this.settings.checkbox.tie_selection,t=this._model.data[e],n=[],s=[],o,l,c;if((this.settings.checkbox.cascade_to_disabled||!t.state.disabled)&&(this.settings.checkbox.cascade_to_hidden||!t.state.hidden)){if(t.children){for(o=0,l=t.children.length;o<l;o++){var _=t.children[o];c=r._cascade_new_checked_state(_,a);n=n.concat(c);if(-1<c.indexOf(_)){s.push(_)}}}var h=r.get_node(t,!0),g=0<s.length&&s.length<t.children.length;if(t.original&&t.original.state&&t.original.state.undetermined){t.original.state.undetermined=g}if(g){t.state[d?"selected":"checked"]=!1;h.attr("aria-selected",!1).children(".jstree-anchor").removeClass(d?"jstree-clicked":"jstree-checked")}else if(a&&s.length===t.children.length){t.state[d?"selected":"checked"]=a;n.push(t.id);h.attr("aria-selected",!0).children(".jstree-anchor").addClass(d?"jstree-clicked":"jstree-checked")}else{t.state[d?"selected":"checked"]=!1;h.attr("aria-selected",!1).children(".jstree-anchor").removeClass(d?"jstree-clicked":"jstree-checked")}}else{c=this.get_checked_descendants(e);if(t.state[d?"selected":"checked"]){c.push(t.id)}n=n.concat(c)}return n};this.get_checked_descendants=function(e){var a=this,r=a.settings.checkbox.tie_selection,t=a._model.data[e];return _.vakata.array_filter(t.children_d,function(e){return a._model.data[e].state[r?"selected":"checked"]})};this.check_node=function(t,a){if(this.settings.checkbox.tie_selection){return this.select_node(t,!1,!0,a)}var e,r,d;if(_.vakata.is_array(t)){t=t.slice();for(r=0,d=t.length;r<d;r++){this.check_node(t[r],a)}return!0}t=this.get_node(t);if(!t||t.id===_.jstree.root){return!1}e=this.get_node(t,!0);if(!t.state.checked){t.state.checked=!0;this._data.checkbox.selected.push(t.id);if(e&&e.length){e.children(".jstree-anchor").addClass("jstree-checked")}this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:a})}};this.uncheck_node=function(t,a){if(this.settings.checkbox.tie_selection){return this.deselect_node(t,!1,a)}var e,r,d;if(_.vakata.is_array(t)){t=t.slice();for(e=0,r=t.length;e<r;e++){this.uncheck_node(t[e],a)}return!0}t=this.get_node(t);if(!t||t.id===_.jstree.root){return!1}d=this.get_node(t,!0);if(t.state.checked){t.state.checked=!1;this._data.checkbox.selected=_.vakata.array_remove_item(this._data.checkbox.selected,t.id);if(d.length){d.children(".jstree-anchor").removeClass("jstree-checked")}this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:a})}};this.check_all=function(){if(this.settings.checkbox.tie_selection){return this.select_all()}var e=this._data.checkbox.selected.concat([]),t,a;this._data.checkbox.selected=this._model.data[_.jstree.root].children_d.concat();for(t=0,a=this._data.checkbox.selected.length;t<a;t++){if(this._model.data[this._data.checkbox.selected[t]]){this._model.data[this._data.checkbox.selected[t]].state.checked=!0}}this.redraw(!0);this.trigger("check_all",{selected:this._data.checkbox.selected})};this.uncheck_all=function(){if(this.settings.checkbox.tie_selection){return this.deselect_all()}var e=this._data.checkbox.selected.concat([]),t,a;for(t=0,a=this._data.checkbox.selected.length;t<a;t++){if(this._model.data[this._data.checkbox.selected[t]]){this._model.data[this._data.checkbox.selected[t]].state.checked=!1}}this._data.checkbox.selected=[];this.element.find(".jstree-checked").removeClass("jstree-checked");this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:e})};this.is_checked=function(e){if(this.settings.checkbox.tie_selection){return this.is_selected(e)}e=this.get_node(e);if(!e||e.id===_.jstree.root){return!1}return e.state.checked};this.get_checked=function(e){if(this.settings.checkbox.tie_selection){return this.get_selected(e)}return e?_.map(this._data.checkbox.selected,function(e){return this.get_node(e)}.bind(this)):this._data.checkbox.selected.slice()};this.get_top_checked=function(e){if(this.settings.checkbox.tie_selection){return this.get_top_selected(e)}var t=this.get_checked(!0),a={},r,d,n,s;for(r=0,d=t.length;r<d;r++){a[t[r].id]=t[r]}for(r=0,d=t.length;r<d;r++){for(n=0,s=t[r].children_d.length;n<s;n++){if(a[t[r].children_d[n]]){delete a[t[r].children_d[n]]}}}t=[];for(r in a){if(a.hasOwnProperty(r)){t.push(r)}}return e?_.map(t,function(e){return this.get_node(e)}.bind(this)):t};this.get_bottom_checked=function(e){if(this.settings.checkbox.tie_selection){return this.get_bottom_selected(e)}var t=this.get_checked(!0),a=[],r,d;for(r=0,d=t.length;r<d;r++){if(!t[r].children.length){a.push(t[r].id)}}return e?_.map(a,function(e){return this.get_node(e)}.bind(this)):a};this.load_node=function(e){var a,r,d;if(!_.vakata.is_array(e)&&!this.settings.checkbox.tie_selection){d=this.get_node(e);if(d&&d.state.loaded){for(a=0,r=d.children_d.length;a<r;a++){if(this._model.data[d.children_d[a]].state.checked){this._data.checkbox.selected=_.vakata.array_remove_item(this._data.checkbox.selected,d.children_d[a])}}}}return t.load_node.apply(this,arguments)};this.get_state=function(){var e=t.get_state.apply(this,arguments);if(this.settings.checkbox.tie_selection){return e}e.checkbox=this._data.checkbox.selected.slice();return e};this.set_state=function(e,a){var r=t.set_state.apply(this,arguments);if(r&&e.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var d=this;_.each(e.checkbox,function(e,t){d.check_node(t)})}delete e.checkbox;this.set_state(e,a);return!1}return r};this.refresh=function(){if(this.settings.checkbox.tie_selection){this._data.checkbox.selected=[]}return t.refresh.apply(this,arguments)}};_.jstree.defaults.conditionalselect=function(){return!0};_.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(a,r){if(this.settings.conditionalselect.call(this,this.get_node(a),r)){return t.activate_node.call(this,a,r)}}};_.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function items(){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function action(e){var t=_.jstree.reference(e.reference),a=t.get_node(e.reference);t.create_node(a,{},"last",function(e){try{t.edit(e)}catch(a){setTimeout(function(){t.edit(e)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function action(e){var t=_.jstree.reference(e.reference),a=t.get_node(e.reference);t.edit(a)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function action(e){var t=_.jstree.reference(e.reference),a=t.get_node(e.reference);if(t.is_selected(a)){t.delete_node(t.get_selected())}else{t.delete_node(a)}}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function action(e){var t=_.jstree.reference(e.reference),a=t.get_node(e.reference);if(t.is_selected(a)){t.cut(t.get_top_selected())}else{t.cut(a)}}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function action(e){var t=_.jstree.reference(e.reference),a=t.get_node(e.reference);if(t.is_selected(a)){t.copy(t.get_top_selected())}else{t.copy(a)}}},paste:{separator_before:!1,icon:!1,_disabled:function _disabled(e){return!_.jstree.reference(e.reference).can_paste()},separator_after:!1,label:"Paste",action:function action(e){var t=_.jstree.reference(e.reference),a=t.get_node(e.reference);t.paste(a)}}}}}}};_.jstree.plugins.contextmenu=function(e,t){this.bind=function(){t.bind.call(this);var a=0,r=null,d,n;this.element.on("init.jstree loading.jstree ready.jstree",function(){this.get_container_ul().addClass("jstree-contextmenu")}.bind(this)).on("contextmenu.jstree",".jstree-anchor",function(t,e){if("input"===t.target.tagName.toLowerCase()){return}t.preventDefault();a=t.ctrlKey?+new Date:0;if(e||r){a=+new Date+1e4}if(r){clearTimeout(r)}if(!this.is_loading(t.currentTarget)){this.show_contextmenu(t.currentTarget,t.pageX,t.pageY,t)}}.bind(this)).on("click.jstree",".jstree-anchor",function(){if(this._data.contextmenu.visible&&(!a||250<+new Date-a)){_.vakata.context.hide()}a=0}.bind(this)).on("touchstart.jstree",".jstree-anchor",function(t){if(!t.originalEvent||!t.originalEvent.changedTouches||!t.originalEvent.changedTouches[0]){return}d=t.originalEvent.changedTouches[0].clientX;n=t.originalEvent.changedTouches[0].clientY;r=setTimeout(function(){_(t.currentTarget).trigger("contextmenu",!0)},750)}).on("touchmove.vakata.jstree",function(t){if(r&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(10<Math.abs(d-t.originalEvent.changedTouches[0].clientX)||10<Math.abs(n-t.originalEvent.changedTouches[0].clientY))){clearTimeout(r);_.vakata.context.hide()}}).on("touchend.vakata.jstree",function(){if(r){clearTimeout(r)}});_(o).on("context_hide.vakata.jstree",function(t,e){this._data.contextmenu.visible=!1;_(e.reference).removeClass("jstree-context")}.bind(this))};this.teardown=function(){if(this._data.contextmenu.visible){_.vakata.context.hide()}_(o).off("context_hide.vakata.jstree");t.teardown.call(this)};this.show_contextmenu=function(t,r,n,l){t=this.get_node(t);if(!t||t.id===_.jstree.root){return!1}var e=this.settings.contextmenu,s=this.get_node(t,!0),d=s.children(".jstree-anchor"),a=!1,c=!1;if(e.show_at_node||r===void 0||n===void 0){a=d.offset();r=a.left;n=a.top+this._data.core.li_height}if(this.settings.contextmenu.select_node&&!this.is_selected(t)){this.activate_node(t,l)}c=e.items;if(_.vakata.is_function(c)){c=c.call(this,t,function(e){this._show_contextmenu(t,r,n,e)}.bind(this))}if(_.isPlainObject(c)){this._show_contextmenu(t,r,n,c)}};this._show_contextmenu=function(e,t,r,n){var s=this.get_node(e,!0),d=s.children(".jstree-anchor");_(o).one("context_show.vakata.jstree",function(t,e){var a="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";_(e.element).addClass(a);d.addClass("jstree-context")}.bind(this));this._data.contextmenu.visible=!0;_.vakata.context.show(d,{x:t,y:r},n);this.trigger("show_contextmenu",{node:e,x:t,y:r})}};(function(t){var a=!1,r={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};t.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function _trigger(e){t(o).triggerHandler("context_"+e+".vakata",{reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}})},_execute:function _execute(e){e=r.items[e];return e&&(!e._disabled||t.vakata.is_function(e._disabled)&&!e._disabled({item:e,reference:r.reference,element:r.element}))&&e.action?e.action.call(null,{item:e,reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}}):!1},_parse:function _parse(e,a){if(!e){return!1}if(!a){r.html="";r.items=[]}var d="",n=!1,s;if(a){d+="<ul>"}t.each(e,function(e,a){if(!a){return!0}r.items.push(a);if(!n&&a.separator_before){d+="<li class='vakata-context-separator'><a href='#' "+(t.vakata.context.settings.icons?"":"class=\"vakata-context-no-icons\"")+">&#160;</a></li>"}n=!1;d+="<li class='"+(a._class||"")+(!0===a._disabled||t.vakata.is_function(a._disabled)&&a._disabled({item:a,reference:r.reference,element:r.element})?" vakata-contextmenu-disabled ":"")+"' "+(a.shortcut?" data-shortcut='"+a.shortcut+"' ":"")+">";d+="<a href='#' rel='"+(r.items.length-1)+"' "+(a.title?"title='"+a.title+"'":"")+">";if(t.vakata.context.settings.icons){d+="<i ";if(a.icon){if(-1!==a.icon.indexOf("/")||-1!==a.icon.indexOf(".")){d+=" style='background:url(\""+a.icon+"\") center center no-repeat' "}else{d+=" class='"+a.icon+"' "}}d+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"}d+=(t.vakata.is_function(a.label)?a.label({item:e,reference:r.reference,element:r.element}):a.label)+(a.shortcut?" <span class=\"vakata-contextmenu-shortcut vakata-contextmenu-shortcut-"+a.shortcut+"\">"+(a.shortcut_label||"")+"</span>":"")+"</a>";if(a.submenu){s=t.vakata.context._parse(a.submenu,!0);if(s){d+=s}}d+="</li>";if(a.separator_after){d+="<li class='vakata-context-separator'><a href='#' "+(t.vakata.context.settings.icons?"":"class=\"vakata-context-no-icons\"")+">&#160;</a></li>";n=!0}});d=d.replace(/<li class\='vakata-context-separator'\><\/li\>$/,"");if(a){d+="</ul>"}if(!a){r.html=d;t.vakata.context._trigger("parse")}return 10<d.length?d:!1},_show_submenu:function _show_submenu(r){r=t(r);if(!r.length||!r.children("ul").length){return}var d=r.children("ul"),e=r.offset().left,n=e+r.outerWidth(),s=r.offset().top,i=d.width(),l=d.height(),c=t(window).width()+t(window).scrollLeft(),_=t(window).height()+t(window).scrollTop();if(a){r[0>n-(i+10+r.outerWidth())?"addClass":"removeClass"]("vakata-context-left")}else{r[n+i>c&&e>c-n?"addClass":"removeClass"]("vakata-context-right")}if(s+l+10>_){d.css("bottom","-1px")}if(r.hasClass("vakata-context-right")){if(e<i){d.css("margin-right",e-i)}}else{if(c-n<i){d.css("margin-left",c-n-i)}}d.show()},show:function show(d,n,s){var i,l,c,_,g,p,m,u;if(r.element&&r.element.length){r.element.width("")}switch(!0){case!n&&!d:return!1;case!!n&&!!d:r.reference=d;r.position_x=n.x;r.position_y=n.y;break;case!n&&!!d:r.reference=d;i=d.offset();r.position_x=i.left+d.outerHeight();r.position_y=i.top;break;case!!n&&!d:r.position_x=n.x;r.position_y=n.y;break;}if(!!d&&!s&&t(d).data("vakata_contextmenu")){s=t(d).data("vakata_contextmenu")}if(t.vakata.context._parse(s)){r.element.html(r.html)}if(r.items.length){r.element.appendTo(o.body);l=r.element;c=r.position_x;_=r.position_y;g=l.width();p=l.height();m=t(window).width()+t(window).scrollLeft();u=t(window).height()+t(window).scrollTop();if(a){c-=l.outerWidth()-t(d).outerWidth();if(c<t(window).scrollLeft()+20){c=t(window).scrollLeft()+20}}if(c+g+20>m){c=m-(g+20)}if(_+p+20>u){_=u-(p+20)}r.element.css({left:c,top:_}).show().find("a").first().trigger("focus").parent().addClass("vakata-context-hover");r.is_visible=!0;t.vakata.context._trigger("show")}},hide:function hide(){if(r.is_visible){r.element.hide().find("ul").hide().end().find(":focus").trigger("blur").end().detach();r.is_visible=!1;t.vakata.context._trigger("hide")}}};t(function(){a="rtl"===t(o.body).css("direction");var d=!1;r.element=t("<ul class='vakata-context'></ul>");r.element.on("mouseenter","li",function(a){a.stopImmediatePropagation();if(t.contains(this,a.relatedTarget)){return}if(d){clearTimeout(d)}r.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end();t(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover");t.vakata.context._show_submenu(this)}).on("mouseleave","li",function(a){if(t.contains(this,a.relatedTarget)){return}t(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(){t(this).find(".vakata-context-hover").removeClass("vakata-context-hover");if(t.vakata.context.settings.hide_onmouseleave){d=setTimeout(function(){return function(){t.vakata.context.hide()}}(this),t.vakata.context.settings.hide_onmouseleave)}}).on("click","a",function(a){a.preventDefault();if(!t(this).trigger("blur").parent().hasClass("vakata-context-disabled")&&!1!==t.vakata.context._execute(t(this).attr("rel"))){t.vakata.context.hide()}}).on("keydown","a",function(a){var e=null;switch(a.which){case 13:case 32:a.type="click";a.preventDefault();t(a.currentTarget).trigger(a);break;case 37:if(r.is_visible){r.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").trigger("focus");a.stopImmediatePropagation();a.preventDefault()}break;case 38:if(r.is_visible){e=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first();if(!e.length){e=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()}e.addClass("vakata-context-hover").children("a").trigger("focus");a.stopImmediatePropagation();a.preventDefault()}break;case 39:if(r.is_visible){r.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").trigger("focus");a.stopImmediatePropagation();a.preventDefault()}break;case 40:if(r.is_visible){e=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first();if(!e.length){e=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()}e.addClass("vakata-context-hover").children("a").trigger("focus");a.stopImmediatePropagation();a.preventDefault()}break;case 27:t.vakata.context.hide();a.preventDefault();break;default:break;}}).on("keydown",function(t){t.preventDefault();var e=r.element.find(".vakata-contextmenu-shortcut-"+t.which).parent();if(e.parent().not(".vakata-context-disabled")){e.trigger("click")}});t(o).on("mousedown.vakata.jstree",function(a){if(r.is_visible&&r.element[0]!==a.target&&!t.contains(r.element[0],a.target)){t.vakata.context.hide()}}).on("context_show.vakata.jstree",function(){r.element.find("li:has(ul)").children("a").addClass("vakata-context-parent");if(a){r.element.addClass("vakata-context-rtl").css("direction","rtl")}r.element.find("ul").hide().end()})})})(_);_.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1};var s,i;_.jstree.plugins.dnd=function(e,t){this.init=function(e,a){t.init.call(this,e,a);this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in o.createElement("span")};this.bind=function(){t.bind.call(this);this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",function(t){if(this.settings.dnd.large_drag_target&&_(t.target).closest(".jstree-node")[0]!==t.currentTarget){return!0}if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!_(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked"))){return!0}var e=this.get_node(t.target),a=this.is_selected(e)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,r=1<a?a+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text){r=_.vakata.html.escape(r)}if(e&&e.id&&e.id!==_.jstree.root&&(1===t.which||"touchstart"===t.type||"dragstart"===t.type)&&(!0===this.settings.dnd.is_draggable||_.vakata.is_function(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,1<a?this.get_top_selected(!0):[e],t))){s={jstree:!0,origin:this,obj:this.get_node(e,!0),nodes:1<a?this.get_top_selected():[e.id]};i=t.currentTarget;if(this.settings.dnd.use_html5){_.vakata.dnd._trigger("start",t,{helper:_(),element:i,data:s})}else{this.element.trigger("mousedown.jstree");return _.vakata.dnd.start(t,s,"<div id=\"jstree-dnd\" class=\"jstree-"+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+"\"><i class=\"jstree-icon jstree-er\"></i>"+r+"<ins class=\"jstree-copy\">+</ins></div>")}}}.bind(this));if(this.settings.dnd.use_html5){this.element.on("dragover.jstree",function(t){t.preventDefault();_.vakata.dnd._trigger("move",t,{helper:_(),element:i,data:s});return!1}).on("drop.jstree",function(t){t.preventDefault();_.vakata.dnd._trigger("stop",t,{helper:_(),element:i,data:s});return!1}.bind(this))}};this.redraw_node=function(e){e=t.redraw_node.apply(this,arguments);if(e&&this.settings.dnd.use_html5){if(this.settings.dnd.large_drag_target){e.setAttribute("draggable",!0)}else{var a,r,d=null;for(a=0,r=e.childNodes.length;a<r;a++){if(e.childNodes[a]&&e.childNodes[a].className&&-1!==e.childNodes[a].className.indexOf("jstree-anchor")){d=e.childNodes[a];break}}if(d){d.setAttribute("draggable",!0)}}}return e}};_(function(){var a=!1,r=!1,d=!1,n=!1,g=_("<div id=\"jstree-marker\">&#160;</div>").hide();_(o).on("dragover.vakata.jstree",function(t){if(i){_.vakata.dnd._trigger("move",t,{helper:_(),element:i,data:s})}}).on("drop.vakata.jstree",function(t){if(i){_.vakata.dnd._trigger("stop",t,{helper:_(),element:i,data:s});i=null;s=null}}).on("dnd_start.vakata.jstree",function(t,e){a=!1;d=!1;if(!e||!e.data||!e.data.jstree){return}g.appendTo(o.body)}).on("dnd_move.vakata.jstree",function(s,e){var m=e.event.target!==d.target;if(n){if(!e.event||"dragover"!==e.event.type||m){clearTimeout(n)}}if(!e||!e.data||!e.data.jstree){return}if(e.event.target.id&&"jstree-marker"===e.event.target.id){return}d=e.event;var u=_.jstree.reference(e.event.target),f=!1,k=!1,v=!1,b,j,y,x,w,C,N,T,O,A,P,S,E,L,K,q,D;if(u&&u._data&&u._data.dnd){g.attr("class","jstree-"+u.get_theme()+(u.settings.core.themes.responsive?" jstree-dnd-responsive":""));K=e.data.origin&&(e.data.origin.settings.dnd.always_copy||e.data.origin.settings.dnd.copy&&(e.event.metaKey||e.event.ctrlKey));e.helper.children().attr("class","jstree-"+u.get_theme()+" jstree-"+u.get_theme()+"-"+u.get_theme_variant()+" "+(u.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[K?"show":"hide"]();if((e.event.target===u.element[0]||e.event.target===u.get_container_ul()[0])&&0===u.get_container_ul().children().length){N=!0;for(T=0,O=e.data.nodes.length;T<O;T++){N=N&&u.check(e.data.origin&&(e.data.origin.settings.dnd.always_copy||e.data.origin.settings.dnd.copy&&(e.event.metaKey||e.event.ctrlKey))?"copy_node":"move_node",e.data.origin&&e.data.origin!==u?e.data.origin.get_node(e.data.nodes[T]):e.data.nodes[T],_.jstree.root,"last",{dnd:!0,ref:u.get_node(_.jstree.root),pos:"i",origin:e.data.origin,is_multi:e.data.origin&&e.data.origin!==u,is_foreign:!e.data.origin});if(!N){break}}if(N){a={ins:u,par:_.jstree.root,pos:"last"};g.hide();e.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");if(e.event.originalEvent&&e.event.originalEvent.dataTransfer){e.event.originalEvent.dataTransfer.dropEffect=K?"copy":"move"}return}}else{f=u.settings.dnd.large_drop_target?_(e.event.target).closest(".jstree-node").children(".jstree-anchor"):_(e.event.target).closest(".jstree-anchor");if(f&&f.length&&f.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")){k=f.offset();v=(e.event.pageY!==void 0?e.event.pageY:e.event.originalEvent.pageY)-k.top;y=f.outerHeight();if(v<y/3){C=["b","i","a"]}else if(v>y-y/3){C=["a","i","b"]}else{C=v>y/2?["i","a","b"]:["i","b","a"]}_.each(C,function(t,d){switch(d){case"b":b=k.left-6;j=k.top;x=u.get_parent(f);w=f.parent().index();D="jstree-below";break;case"i":E=u.settings.dnd.inside_pos;L=u.get_node(f.parent());b=k.left-2;j=k.top+y/2+1;x=L.id;w="first"===E?0:"last"===E?L.children.length:Math.min(E,L.children.length);D="jstree-inside";break;case"a":b=k.left-6;j=k.top+y;x=u.get_parent(f);w=f.parent().index()+1;D="jstree-above";break;}N=!0;for(T=0,O=e.data.nodes.length;T<O;T++){A=e.data.origin&&(e.data.origin.settings.dnd.always_copy||e.data.origin.settings.dnd.copy&&(e.event.metaKey||e.event.ctrlKey))?"copy_node":"move_node";P=w;if("move_node"===A&&"a"===d&&e.data.origin&&e.data.origin===u&&x===u.get_parent(e.data.nodes[T])){S=u.get_node(x);if(P>_.inArray(e.data.nodes[T],S.children)){P-=1}}N=N&&(u&&u.settings&&u.settings.dnd&&!1===u.settings.dnd.check_while_dragging||u.check(A,e.data.origin&&e.data.origin!==u?e.data.origin.get_node(e.data.nodes[T]):e.data.nodes[T],x,P,{dnd:!0,ref:u.get_node(f.parent()),pos:d,origin:e.data.origin,is_multi:e.data.origin&&e.data.origin!==u,is_foreign:!e.data.origin}));if(!N){if(u&&u.last_error){r=u.last_error()}break}}if("i"===d&&f.parent().is(".jstree-closed")&&u.settings.dnd.open_timeout){if(!e.event||"dragover"!==e.event.type||m){if(n){clearTimeout(n)}n=setTimeout(function(e,t){return function(){e.open_node(t)}}(u,f),u.settings.dnd.open_timeout)}}if(N){q=u.get_node(x,!0);if(!q.hasClass(".jstree-dnd-parent")){_(".jstree-dnd-parent").removeClass("jstree-dnd-parent");q.addClass("jstree-dnd-parent")}a={ins:u,par:x,pos:"i"===d&&"last"===E&&0===w&&!u.is_loaded(L)?"last":w};g.css({left:b+"px",top:j+"px"}).show();g.removeClass("jstree-above jstree-inside jstree-below").addClass(D);e.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");if(e.event.originalEvent&&e.event.originalEvent.dataTransfer){e.event.originalEvent.dataTransfer.dropEffect=K?"copy":"move"}r={};C=!0;return!1}});if(!0===C){return}}}}_(".jstree-dnd-parent").removeClass("jstree-dnd-parent");a=!1;e.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er");if(e.event.originalEvent&&e.event.originalEvent.dataTransfer){}g.hide()}).on("dnd_scroll.vakata.jstree",function(t,e){if(!e||!e.data||!e.data.jstree){return}g.hide();a=!1;d=!1;e.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er")}).on("dnd_stop.vakata.jstree",function(t,e){_(".jstree-dnd-parent").removeClass("jstree-dnd-parent");if(n){clearTimeout(n)}if(!e||!e.data||!e.data.jstree){return}g.hide().detach();var s,o,l=[];if(a){for(s=0,o=e.data.nodes.length;s<o;s++){l[s]=e.data.origin?e.data.origin.get_node(e.data.nodes[s]):e.data.nodes[s]}a.ins[e.data.origin&&(e.data.origin.settings.dnd.always_copy||e.data.origin.settings.dnd.copy&&(e.event.metaKey||e.event.ctrlKey))?"copy_node":"move_node"](l,a.par,a.pos,!1,!1,!1,e.data.origin)}else{s=_(e.event.target).closest(".jstree");if(s.length&&r&&r.error&&"check"===r.error){s=s.jstree(!0);if(s){s.settings.core.error.call(this,r)}}}d=!1;a=!1}).on("keyup.jstree keydown.jstree",function(t,e){e=_.vakata.dnd._get();if(e&&e.data&&e.data.jstree){if("keyup"===t.type&&27===t.which){if(n){clearTimeout(n)}a=!1;r=!1;d=!1;n=!1;g.hide().detach();_.vakata.dnd._clean()}else{e.helper.find(".jstree-copy").first()[e.data.origin&&(e.data.origin.settings.dnd.always_copy||e.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"]();if(d){d.metaKey=t.metaKey;d.ctrlKey=t.ctrlKey;_.vakata.dnd._trigger("move",d)}}}})});(function(a){a.vakata.html={div:a("<div></div>"),escape:function escape(e){return a.vakata.html.div.text(e).html()},strip:function strip(e){return a.vakata.html.div.empty().append(a.parseHTML(e)).text()}};var r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};a.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function _trigger(t,r,e){if(e===void 0){e=a.vakata.dnd._get()}e.event=r;a(o).triggerHandler("dnd_"+t+".vakata",e)},_get:function _get(){return{data:r.data,element:r.element,helper:r.helper}},_clean:function _clean(){if(r.helper){r.helper.remove()}if(r.scroll_i){clearInterval(r.scroll_i);r.scroll_i=!1}r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};i=null;a(o).off("mousemove.vakata.jstree touchmove.vakata.jstree",a.vakata.dnd.drag);a(o).off("mouseup.vakata.jstree touchend.vakata.jstree",a.vakata.dnd.stop)},_scroll:function _scroll(e){if(!r.scroll_e||!r.scroll_l&&!r.scroll_t){if(r.scroll_i){clearInterval(r.scroll_i);r.scroll_i=!1}return!1}if(!r.scroll_i){r.scroll_i=setInterval(a.vakata.dnd._scroll,100);return!1}if(!0===e){return!1}var t=r.scroll_e.scrollTop(),d=r.scroll_e.scrollLeft();r.scroll_e.scrollTop(t+r.scroll_t*a.vakata.dnd.settings.scroll_speed);r.scroll_e.scrollLeft(d+r.scroll_l*a.vakata.dnd.settings.scroll_speed);if(t!==r.scroll_e.scrollTop()||d!==r.scroll_e.scrollLeft()){a.vakata.dnd._trigger("scroll",r.scroll_e)}},start:function start(t,e,d){if("touchstart"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]){t.pageX=t.originalEvent.changedTouches[0].pageX;t.pageY=t.originalEvent.changedTouches[0].pageY;t.target=o.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(r.is_drag){a.vakata.dnd.stop({})}try{t.currentTarget.unselectable="on";t.currentTarget.onselectstart=function(){return!1};if(t.currentTarget.style){t.currentTarget.style.touchAction="none";t.currentTarget.style.msTouchAction="none";t.currentTarget.style.MozUserSelect="none"}}catch(e){}r.init_x=t.pageX;r.init_y=t.pageY;r.data=e;r.is_down=!0;r.element=t.currentTarget;r.target=t.target;r.is_touch="touchstart"===t.type;if(!1!==d){r.helper=a("<div id='vakata-dnd'></div>").html(d).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})}a(o).on("mousemove.vakata.jstree touchmove.vakata.jstree",a.vakata.dnd.drag);a(o).on("mouseup.vakata.jstree touchend.vakata.jstree",a.vakata.dnd.stop);return!1},drag:function drag(n){if("touchmove"===n.type&&n.originalEvent&&n.originalEvent.changedTouches&&n.originalEvent.changedTouches[0]){n.pageX=n.originalEvent.changedTouches[0].pageX;n.pageY=n.originalEvent.changedTouches[0].pageY;n.target=o.elementFromPoint(n.originalEvent.changedTouches[0].pageX-window.pageXOffset,n.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(!r.is_down){return}if(!r.is_drag){if(Math.abs(n.pageX-r.init_x)>(r.is_touch?a.vakata.dnd.settings.threshold_touch:a.vakata.dnd.settings.threshold)||Math.abs(n.pageY-r.init_y)>(r.is_touch?a.vakata.dnd.settings.threshold_touch:a.vakata.dnd.settings.threshold)){if(r.helper){r.helper.appendTo(o.body);r.helper_w=r.helper.outerWidth()}r.is_drag=!0;a(r.target).one("click.vakata",!1);a.vakata.dnd._trigger("start",n)}else{return}}var e=!1,t=!1,s=!1,i=!1,l=!1,c=!1,_=!1,h=!1,g=!1,p=!1;r.scroll_t=0;r.scroll_l=0;r.scroll_e=!1;a(a(n.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return /^auto|scroll$/.test(a(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var e=a(this),t=e.offset();if(this.scrollHeight>this.offsetHeight){if(t.top+e.height()-n.pageY<a.vakata.dnd.settings.scroll_proximity){r.scroll_t=1}if(n.pageY-t.top<a.vakata.dnd.settings.scroll_proximity){r.scroll_t=-1}}if(this.scrollWidth>this.offsetWidth){if(t.left+e.width()-n.pageX<a.vakata.dnd.settings.scroll_proximity){r.scroll_l=1}if(n.pageX-t.left<a.vakata.dnd.settings.scroll_proximity){r.scroll_l=-1}}if(r.scroll_t||r.scroll_l){r.scroll_e=a(this);return!1}});if(!r.scroll_e){e=a(o);t=a(window);s=e.height();i=t.height();l=e.width();c=t.width();_=e.scrollTop();h=e.scrollLeft();if(s>i&&n.pageY-_<a.vakata.dnd.settings.scroll_proximity){r.scroll_t=-1}if(s>i&&i-(n.pageY-_)<a.vakata.dnd.settings.scroll_proximity){r.scroll_t=1}if(l>c&&n.pageX-h<a.vakata.dnd.settings.scroll_proximity){r.scroll_l=-1}if(l>c&&c-(n.pageX-h)<a.vakata.dnd.settings.scroll_proximity){r.scroll_l=1}if(r.scroll_t||r.scroll_l){r.scroll_e=e}}if(r.scroll_e){a.vakata.dnd._scroll(!0)}if(r.helper){g=parseInt(n.pageY+a.vakata.dnd.settings.helper_top,10);p=parseInt(n.pageX+a.vakata.dnd.settings.helper_left,10);if(s&&g+25>s){g=s-50}if(l&&p+r.helper_w>l){p=l-(r.helper_w+2)}r.helper.css({left:p+"px",top:g+"px"})}a.vakata.dnd._trigger("move",n);return!1},stop:function stop(t){if("touchend"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]){t.pageX=t.originalEvent.changedTouches[0].pageX;t.pageY=t.originalEvent.changedTouches[0].pageY;t.target=o.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(r.is_drag){if(t.target!==r.target){a(r.target).off("click.vakata")}a.vakata.dnd._trigger("stop",t)}else{if("touchend"===t.type&&t.target===r.target){var e=setTimeout(function(){a(t.target).trigger("click")},100);a(t.target).one("click",function(){if(e){clearTimeout(e)}})}}a.vakata.dnd._clean();return!1}}})(_);_.jstree.defaults.massload=null;_.jstree.plugins.massload=function(e,t){this.init=function(e,a){this._data.massload={};t.init.call(this,e,a)};this._load_nodes=function(e,a,r,d){var n=this.settings.massload,o=[],l=this._model.data,c,h,g;if(!r){for(c=0,h=e.length;c<h;c++){if(!l[e[c]]||!l[e[c]].state.loaded&&!l[e[c]].state.failed||d){o.push(e[c]);g=this.get_node(e[c],!0);if(g&&g.length){g.addClass("jstree-loading").attr("aria-busy",!0)}}}this._data.massload={};if(o.length){if(_.vakata.is_function(n)){return n.call(this,o,function(n){var s,o;if(n){for(s in n){if(n.hasOwnProperty(s)){this._data.massload[s]=n[s]}}}for(s=0,o=e.length;s<o;s++){g=this.get_node(e[s],!0);if(g&&g.length){g.removeClass("jstree-loading").attr("aria-busy",!1)}}t._load_nodes.call(this,e,a,r,d)}.bind(this))}if("object"===_typeof(n)&&n&&n.url){n=_.extend(!0,{},n);if(_.vakata.is_function(n.url)){n.url=n.url.call(this,o)}if(_.vakata.is_function(n.data)){n.data=n.data.call(this,o)}return _.ajax(n).done(function(n){var s,o;if(n){for(s in n){if(n.hasOwnProperty(s)){this._data.massload[s]=n[s]}}}for(s=0,o=e.length;s<o;s++){g=this.get_node(e[s],!0);if(g&&g.length){g.removeClass("jstree-loading").attr("aria-busy",!1)}}t._load_nodes.call(this,e,a,r,d)}.bind(this)).fail(function(){t._load_nodes.call(this,e,a,r,d)}.bind(this))}}}return t._load_nodes.call(this,e,a,r,d)};this._load_node=function(e,a){var r=this._data.massload[e.id],d=null,n;if(r){d=this["string"==typeof r?"_append_html_data":"_append_json_data"](e,"string"==typeof r?_(_.parseHTML(r)).filter(function(){return 3!==this.nodeType}):r,function(e){a.call(this,e)});n=this.get_node(e.id,!0);if(n&&n.length){n.removeClass("jstree-loading").attr("aria-busy",!1)}delete this._data.massload[e.id];return d}return t._load_node.call(this,e,a)}};_.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1};_.jstree.plugins.search=function(e,t){this.bind=function(){t.bind.call(this);this._data.search.str="";this._data.search.dom=_();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=!1;this._data.search.smc=!1;this._data.search.hdn=[];this.element.on("search.jstree",function(t,e){if(this._data.search.som&&e.res.length){var a=this._model.data,r,d,n=[],s,o;for(r=0,d=e.res.length;r<d;r++){if(a[e.res[r]]&&!a[e.res[r]].state.hidden){n.push(e.res[r]);n=n.concat(a[e.res[r]].parents);if(this._data.search.smc){for(s=0,o=a[e.res[r]].children_d.length;s<o;s++){if(a[a[e.res[r]].children_d[s]]&&!a[a[e.res[r]].children_d[s]].state.hidden){n.push(a[e.res[r]].children_d[s])}}}}}n=_.vakata.array_remove_item(_.vakata.array_unique(n),_.jstree.root);this._data.search.hdn=this.hide_all(!0);this.show_node(n,!0);this.redraw(!0)}}.bind(this)).on("clear_search.jstree",function(t,e){if(this._data.search.som&&e.res.length){this.show_node(this._data.search.hdn,!0);this.redraw(!0)}}.bind(this))};this.search=function(e,t,d,n,o,l){if(!1===e||""===_.vakata.trim(e.toString())){return this.clear_search()}n=this.get_node(n);n=n&&n.id?n.id:null;e=e.toString();var c=this.settings.search,s=c.ajax?c.ajax:!1,h=this._model.data,g=null,m=[],r=[],u,k;if(this._data.search.res.length&&!o){this.clear_search()}if(d===void 0){d=c.show_only_matches}if(l===void 0){l=c.show_only_matches_children}if(!t&&!1!==s){if(_.vakata.is_function(s)){return s.call(this,e,function(t){if(t&&t.d){t=t.d}this._load_nodes(!_.vakata.is_array(t)?[]:_.vakata.array_unique(t),function(){this.search(e,!0,d,n,o,l)})}.bind(this),n)}else{s=_.extend({},s);if(!s.data){s.data={}}s.data.str=e;if(n){s.data.inside=n}if(this._data.search.lastRequest){this._data.search.lastRequest.abort()}this._data.search.lastRequest=_.ajax(s).fail(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(s)};this.settings.core.error.call(this,this._data.core.last_error)}.bind(this)).done(function(t){if(t&&t.d){t=t.d}this._load_nodes(!_.vakata.is_array(t)?[]:_.vakata.array_unique(t),function(){this.search(e,!0,d,n,o,l)})}.bind(this));return this._data.search.lastRequest}}if(!o){this._data.search.str=e;this._data.search.dom=_();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=d;this._data.search.smc=l}g=new _.vakata.search(e,!0,{caseSensitive:c.case_sensitive,fuzzy:c.fuzzy});_.each(h[n?n:_.jstree.root].children_d,function(t,a){var d=h[a];if(d.text&&!d.state.hidden&&(!c.search_leaves_only||d.state.loaded&&0===d.children.length)&&(c.search_callback&&c.search_callback.call(this,e,d)||!c.search_callback&&g.search(d.text).isMatch)){m.push(a);r=r.concat(d.parents)}});if(m.length){r=_.vakata.array_unique(r);for(u=0,k=r.length;u<k;u++){if(r[u]!==_.jstree.root&&h[r[u]]&&!0===this.open_node(r[u],null,0)){this._data.search.opn.push(r[u])}}if(!o){this._data.search.dom=_(this.element[0].querySelectorAll("#"+_.map(m,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(_.jstree.idregex,"\\$&"):e.replace(_.jstree.idregex,"\\$&")}).join(", #")));this._data.search.res=m}else{this._data.search.dom=this._data.search.dom.add(_(this.element[0].querySelectorAll("#"+_.map(m,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(_.jstree.idregex,"\\$&"):e.replace(_.jstree.idregex,"\\$&")}).join(", #"))));this._data.search.res=_.vakata.array_unique(this._data.search.res.concat(m))}this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:e,res:this._data.search.res,show_only_matches:d})};this.clear_search=function(){if(this.settings.search.close_opened_onclear){this.close_node(this._data.search.opn,0)}this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res});if(this._data.search.res.length){this._data.search.dom=_(this.element[0].querySelectorAll("#"+_.map(this._data.search.res,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(_.jstree.idregex,"\\$&"):e.replace(_.jstree.idregex,"\\$&")}).join(", #")));this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")}this._data.search.str="";this._data.search.res=[];this._data.search.opn=[];this._data.search.dom=_()};this.redraw_node=function(e){e=t.redraw_node.apply(this,arguments);if(e){if(-1!==_.inArray(e.id,this._data.search.res)){var a,r,d=null;for(a=0,r=e.childNodes.length;a<r;a++){if(e.childNodes[a]&&e.childNodes[a].className&&-1!==e.childNodes[a].className.indexOf("jstree-anchor")){d=e.childNodes[a];break}}if(d){d.className+=" jstree-search"}}}return e}};(function(e){e.vakata.search=function(t,a,r){r=r||{};r=e.extend({},e.vakata.search.defaults,r);if(!1!==r.fuzzy){r.fuzzy=!0}t=r.caseSensitive?t:t.toLowerCase();var d=r.location,n=r.distance,s=r.threshold,o=t.length,l,c,_,h;if(32<o){r.fuzzy=!1}if(r.fuzzy){l=1<<o-1;c=function(){var e={},a=0;for(a=0;a<o;a++){e[t.charAt(a)]=0}for(a=0;a<o;a++){e[t.charAt(a)]|=1<<o-a-1}return e}();_=function(t,e){var a=t/o,r=Math.abs(d-e);if(!n){return r?1:a}return a+r/n}}h=function(e){e=r.caseSensitive?e:e.toLowerCase();if(t===e||-1!==e.indexOf(t)){return{isMatch:!0,score:0}}if(!r.fuzzy){return{isMatch:!1,score:1}}var a,n,h=e.length,g=s,p=e.indexOf(t,d),m,u,f=o+h,k,v,b,y,x,w=1,C=[];if(-1!==p){g=Math.min(_(0,p),g);p=e.lastIndexOf(t,d+o);if(-1!==p){g=Math.min(_(0,p),g)}}p=-1;for(a=0;a<o;a++){m=0;u=f;while(m<u){if(_(a,d+u)<=g){m=u}else{f=u}u=Math.floor((f-m)/2+m)}f=u;v=Math.max(1,d-u+1);b=Math.min(d+u,h)+o;y=Array(b+2);y[b+1]=(1<<a)-1;for(n=b;n>=v;n--){x=c[e.charAt(n-1)];if(0===a){y[n]=(1|y[n+1]<<1)&x}else{y[n]=(1|y[n+1]<<1)&x|(1|(k[n+1]|k[n])<<1)|k[n+1]}if(y[n]&l){w=_(a,n-1);if(w<=g){g=w;p=n-1;C.push(p);if(p>d){v=Math.max(1,2*d-p)}else{break}}}}if(_(a+1,d)>g){break}k=y}return{isMatch:0<=p,score:w}};return!0===a?{search:h}:h(a)};e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}})(_);_.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1};_.jstree.plugins.sort=function(e,t){this.bind=function(){t.bind.call(this);this.element.on("model.jstree",function(t,e){this.sort(e.parent,!0)}.bind(this)).on("rename_node.jstree create_node.jstree",function(t,e){this.sort(e.parent||e.node.parent,!1);this.redraw_node(e.parent||e.node.parent,!0)}.bind(this)).on("move_node.jstree copy_node.jstree",function(t,e){this.sort(e.parent,!1);this.redraw_node(e.parent,!0)}.bind(this))};this.sort=function(e,t){var a,r;e=this.get_node(e);if(e&&e.children&&e.children.length){e.children.sort(this.settings.sort.bind(this));if(t){for(a=0,r=e.children_d.length;a<r;a++){this.sort(e.children_d[a],!1)}}}}};var g=!1;_.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1};_.jstree.plugins.state=function(e,t){this.bind=function(){t.bind.call(this);var e=function(){this.element.on(this.settings.state.events,function(){if(g){clearTimeout(g)}g=setTimeout(function(){this.save_state()}.bind(this),100)}.bind(this));this.trigger("state_ready")}.bind(this);this.element.on("ready.jstree",function(){this.element.one("restore_state.jstree",e);if(!this.restore_state()){e()}}.bind(this))};this.save_state=function(){var e=this.get_state();if(!this.settings.state.preserve_loaded){delete e.core.loaded}var t={state:e,ttl:this.settings.state.ttl,sec:+new Date};_.vakata.storage.set(this.settings.state.key,JSON.stringify(t))};this.restore_state=function(){var t=_.vakata.storage.get(this.settings.state.key);if(!!t){try{t=JSON.parse(t)}catch(e){return!1}}if(!!t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl){return!1}if(!!t&&t.state){t=t.state}if(!!t&&_.vakata.is_function(this.settings.state.filter)){t=this.settings.state.filter.call(this,t)}if(!!t){if(!this.settings.state.preserve_loaded){delete t.core.loaded}this.element.one("set_state.jstree",function(a,e){e.instance.trigger("restore_state",{state:_.extend(!0,{},t)})});this.set_state(t);return!0}return!1};this.clear_state=function(){return _.vakata.storage.del(this.settings.state.key)}};(function(e){e.vakata.storage={set:function set(e,t){return window.localStorage.setItem(e,t)},get:function get(e){return window.localStorage.getItem(e)},del:function del(e){return window.localStorage.removeItem(e)}}})(_);_.jstree.defaults.types={default:{}};_.jstree.defaults.types[_.jstree.root]={};_.jstree.plugins.types=function(e,t){this.init=function(e,a){var r,d;if(a&&a.types&&a.types["default"]){for(r in a.types){if("default"!==r&&r!==_.jstree.root&&a.types.hasOwnProperty(r)){for(d in a.types["default"]){if(a.types["default"].hasOwnProperty(d)&&a.types[r][d]===void 0){a.types[r][d]=a.types["default"][d]}}}}}t.init.call(this,e,a);this._model.data[_.jstree.root].type=_.jstree.root};this.refresh=function(e,a){t.refresh.call(this,e,a);this._model.data[_.jstree.root].type=_.jstree.root};this.bind=function(){this.element.on("model.jstree",function(a,e){var r=this._model.data,d=e.nodes,n=this.settings.types,t,s,o="default",l;for(t=0,s=d.length;t<s;t++){o="default";if(r[d[t]].original&&r[d[t]].original.type&&n[r[d[t]].original.type]){o=r[d[t]].original.type}if(r[d[t]].data&&r[d[t]].data.jstree&&r[d[t]].data.jstree.type&&n[r[d[t]].data.jstree.type]){o=r[d[t]].data.jstree.type}r[d[t]].type=o;if(!0===r[d[t]].icon&&n[o].icon!==void 0){r[d[t]].icon=n[o].icon}if(n[o].li_attr!==void 0&&"object"===_typeof(n[o].li_attr)){for(l in n[o].li_attr){if(n[o].li_attr.hasOwnProperty(l)){if("id"===l){continue}else if(r[d[t]].li_attr[l]===void 0){r[d[t]].li_attr[l]=n[o].li_attr[l]}else if("class"===l){r[d[t]].li_attr["class"]=n[o].li_attr["class"]+" "+r[d[t]].li_attr["class"]}}}}if(n[o].a_attr!==void 0&&"object"===_typeof(n[o].a_attr)){for(l in n[o].a_attr){if(n[o].a_attr.hasOwnProperty(l)){if("id"===l){continue}else if(r[d[t]].a_attr[l]===void 0){r[d[t]].a_attr[l]=n[o].a_attr[l]}else if("href"===l&&"#"===r[d[t]].a_attr[l]){r[d[t]].a_attr.href=n[o].a_attr.href}else if("class"===l){r[d[t]].a_attr["class"]=n[o].a_attr["class"]+" "+r[d[t]].a_attr["class"]}}}}}r[_.jstree.root].type=_.jstree.root}.bind(this));t.bind.call(this)};this.get_json=function(e,a,r){var d,n,s=this._model.data,o=a?_.extend(!0,{},a,{no_id:!1}):{},l=t.get_json.call(this,e,o,r);if(!1===l){return!1}if(_.vakata.is_array(l)){for(d=0,n=l.length;d<n;d++){l[d].type=l[d].id&&s[l[d].id]&&s[l[d].id].type?s[l[d].id].type:"default";if(a&&a.no_id){delete l[d].id;if(l[d].li_attr&&l[d].li_attr.id){delete l[d].li_attr.id}if(l[d].a_attr&&l[d].a_attr.id){delete l[d].a_attr.id}}}}else{l.type=l.id&&s[l.id]&&s[l.id].type?s[l.id].type:"default";if(a&&a.no_id){l=this._delete_ids(l)}}return l};this._delete_ids=function(e){if(_.vakata.is_array(e)){for(var t=0,a=e.length;t<a;t++){e[t]=this._delete_ids(e[t])}return e}delete e.id;if(e.li_attr&&e.li_attr.id){delete e.li_attr.id}if(e.a_attr&&e.a_attr.id){delete e.a_attr.id}if(e.children&&_.vakata.is_array(e.children)){e.children=this._delete_ids(e.children)}return e};this.check=function(e,a,r,n,s){if(!1===t.check.call(this,e,a,r,n,s)){return!1}a=a&&a.id?a:this.get_node(a);r=r&&r.id?r:this.get_node(r);var o=a&&a.id?s&&s.origin?s.origin:_.jstree.reference(a.id):null,l,c,h,g;o=o&&o._model&&o._model.data?o._model.data:null;switch(e){case"create_node":case"move_node":case"copy_node":if("move_node"!==e||-1===_.inArray(a.id,r.children)){l=this.get_rules(r);if(l.max_children!==void 0&&-1!==l.max_children&&l.max_children===r.children.length){this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+e,data:JSON.stringify({chk:e,pos:n,obj:a&&a.id?a.id:!1,par:r&&r.id?r.id:!1})};return!1}if(l.valid_children!==void 0&&-1!==l.valid_children&&-1===_.inArray(a.type||"default",l.valid_children)){this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+e,data:JSON.stringify({chk:e,pos:n,obj:a&&a.id?a.id:!1,par:r&&r.id?r.id:!1})};return!1}if(o&&a.children_d&&a.parents){c=0;for(h=0,g=a.children_d.length;h<g;h++){c=Math.max(c,o[a.children_d[h]].parents.length)}c=c-a.parents.length+1}if(0>=c||c===void 0){c=1}do{if(l.max_depth!==void 0&&-1!==l.max_depth&&l.max_depth<c){this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+e,data:JSON.stringify({chk:e,pos:n,obj:a&&a.id?a.id:!1,par:r&&r.id?r.id:!1})};return!1}r=this.get_node(r.parent);l=this.get_rules(r);c++}while(r)}break;}return!0};this.get_rules=function(e){e=this.get_node(e);if(!e){return!1}var t=this.get_type(e,!0);if(t.max_depth===void 0){t.max_depth=-1}if(t.max_children===void 0){t.max_children=-1}if(t.valid_children===void 0){t.valid_children=-1}return t};this.get_type=function(e,t){e=this.get_node(e);return!e?!1:t?_.extend({type:e.type},this.settings.types[e.type]):e.type};this.set_type=function(e,r){var n=this._model.data,s,i,o,l,c,h,g,p;if(_.vakata.is_array(e)){e=e.slice();for(i=0,o=e.length;i<o;i++){this.set_type(e[i],r)}return!0}s=this.settings.types;e=this.get_node(e);if(!s[r]||!e){return!1}g=this.get_node(e,!0);if(g&&g.length){p=g.children(".jstree-anchor")}l=e.type;c=this.get_icon(e);e.type=r;if(!0===c||!s[l]||s[l].icon!==void 0&&c===s[l].icon){this.set_icon(e,s[r].icon!==void 0?s[r].icon:!0)}if(s[l]&&s[l].li_attr!==void 0&&"object"===_typeof(s[l].li_attr)){for(h in s[l].li_attr){if(s[l].li_attr.hasOwnProperty(h)){if("id"===h){continue}else if("class"===h){n[e.id].li_attr["class"]=(n[e.id].li_attr["class"]||"").replace(s[l].li_attr[h],"");if(g){g.removeClass(s[l].li_attr[h])}}else if(n[e.id].li_attr[h]===s[l].li_attr[h]){n[e.id].li_attr[h]=null;if(g){g.removeAttr(h)}}}}}if(s[l]&&s[l].a_attr!==void 0&&"object"===_typeof(s[l].a_attr)){for(h in s[l].a_attr){if(s[l].a_attr.hasOwnProperty(h)){if("id"===h){continue}else if("class"===h){n[e.id].a_attr["class"]=(n[e.id].a_attr["class"]||"").replace(s[l].a_attr[h],"");if(p){p.removeClass(s[l].a_attr[h])}}else if(n[e.id].a_attr[h]===s[l].a_attr[h]){if("href"===h){n[e.id].a_attr[h]="#";if(p){p.attr("href","#")}}else{delete n[e.id].a_attr[h];if(p){p.removeAttr(h)}}}}}}if(s[r].li_attr!==void 0&&"object"===_typeof(s[r].li_attr)){for(h in s[r].li_attr){if(s[r].li_attr.hasOwnProperty(h)){if("id"===h){continue}else if(n[e.id].li_attr[h]===void 0){n[e.id].li_attr[h]=s[r].li_attr[h];if(g){if("class"===h){g.addClass(s[r].li_attr[h])}else{g.attr(h,s[r].li_attr[h])}}}else if("class"===h){n[e.id].li_attr["class"]=s[r].li_attr[h]+" "+n[e.id].li_attr["class"];if(g){g.addClass(s[r].li_attr[h])}}}}}if(s[r].a_attr!==void 0&&"object"===_typeof(s[r].a_attr)){for(h in s[r].a_attr){if(s[r].a_attr.hasOwnProperty(h)){if("id"===h){continue}else if(n[e.id].a_attr[h]===void 0){n[e.id].a_attr[h]=s[r].a_attr[h];if(p){if("class"===h){p.addClass(s[r].a_attr[h])}else{p.attr(h,s[r].a_attr[h])}}}else if("href"===h&&"#"===n[e.id].a_attr[h]){n[e.id].a_attr.href=s[r].a_attr.href;if(p){p.attr("href",s[r].a_attr.href)}}else if("class"===h){n[e.id].a_attr["class"]=s[r].a_attr["class"]+" "+n[e.id].a_attr["class"];if(p){p.addClass(s[r].a_attr[h])}}}}}return!0}};_.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function duplicate(e,t){return e+" ("+t+")"}};_.jstree.plugins.unique=function(e,a){this.check=function(e,r,d,o,l){if(!1===a.check.call(this,e,r,d,o,l)){return!1}r=r&&r.id?r:this.get_node(r);d=d&&d.id?d:this.get_node(d);if(!d||!d.children){return!0}var h="rename_node"===e?o:r.text,g=[],c=this.settings.unique.case_sensitive,s=this.settings.unique.trim_whitespace,p=this._model.data,m,u,f;for(m=0,u=d.children.length;m<u;m++){f=p[d.children[m]].text;if(!c){f=f.toLowerCase()}if(s){f=f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}g.push(f)}if(!c){h=h.toLowerCase()}if(s){h=h.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}switch(e){case"delete_node":return!0;case"rename_node":f=r.text||"";if(!c){f=f.toLowerCase()}if(s){f=f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}m=-1===_.inArray(h,g)||r.text&&f===h;if(!m){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+h+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:o,obj:r&&r.id?r.id:!1,par:d&&d.id?d.id:!1})}}return m;case"create_node":m=-1===_.inArray(h,g);if(!m){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+h+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:o,obj:r&&r.id?r.id:!1,par:d&&d.id?d.id:!1})}}return m;case"copy_node":m=-1===_.inArray(h,g);if(!m){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+h+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:o,obj:r&&r.id?r.id:!1,par:d&&d.id?d.id:!1})}}return m;case"move_node":m=r.parent===d.id&&(!l||!l.is_multi)||-1===_.inArray(h,g);if(!m){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+h+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:o,obj:r&&r.id?r.id:!1,par:d&&d.id?d.id:!1})}}return m;}return!0};this.create_node=function(e,r,d,o,l){if(!r||r.text===void 0){if(null===e){e=_.jstree.root}e=this.get_node(e);if(!e){return a.create_node.call(this,e,r,d,o,l)}d=d===void 0?"last":d;if(!d.toString().match(/^(before|after)$/)&&!l&&!this.is_loaded(e)){return a.create_node.call(this,e,r,d,o,l)}if(!r){r={}}var c,h,g,p,u,f=this._model.data,m=this.settings.unique.case_sensitive,s=this.settings.unique.trim_whitespace,k=this.settings.unique.duplicate,v;h=c=this.get_string("New node");g=[];for(p=0,u=e.children.length;p<u;p++){v=f[e.children[p]].text;if(!m){v=v.toLowerCase()}if(s){v=v.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}g.push(v)}p=1;v=h;if(!m){v=v.toLowerCase()}if(s){v=v.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}while(-1!==_.inArray(v,g)){h=k.call(this,c,++p).toString();v=h;if(!m){v=v.toLowerCase()}if(s){v=v.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}r.text=h}return a.create_node.call(this,e,r,d,o,l)}};var p=o.createElement("DIV");p.setAttribute("unselectable","on");p.setAttribute("role","presentation");p.className="jstree-wholerow";p.innerHTML="&#160;";_.jstree.plugins.wholerow=function(e,t){this.bind=function(){t.bind.call(this);this.element.on("ready.jstree set_state.jstree",function(){this.hide_dots()}.bind(this)).on("init.jstree loading.jstree ready.jstree",function(){this.get_container_ul().addClass("jstree-wholerow-ul")}.bind(this)).on("deselect_all.jstree",function(){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")}.bind(this)).on("changed.jstree",function(t,e){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var a=!1,r,d;for(r=0,d=e.selected.length;r<d;r++){a=this.get_node(e.selected[r],!0);if(a&&a.length){a.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}}}.bind(this)).on("open_node.jstree",function(t,e){this.get_node(e.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}.bind(this)).on("hover_node.jstree dehover_node.jstree",function(t,e){if("hover_node"===t.type&&this.is_disabled(e.node)){return}this.get_node(e.node,!0).children(".jstree-wholerow")["hover_node"===t.type?"addClass":"removeClass"]("jstree-wholerow-hovered")}.bind(this)).on("contextmenu.jstree",".jstree-wholerow",function(t){if(this._data.contextmenu){t.preventDefault();var e=_.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});_(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(e)}}.bind(this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var e=_.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});_(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(e).trigger("focus")}).on("dblclick.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var e=_.Event("dblclick",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});_(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(e).trigger("focus")}).on("click.jstree",".jstree-leaf > .jstree-ocl",function(t){t.stopImmediatePropagation();var e=_.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});_(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(e).trigger("focus")}.bind(this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",function(t){t.stopImmediatePropagation();if(!this.is_disabled(t.currentTarget)){this.hover_node(t.currentTarget)}return!1}.bind(this)).on("mouseleave.jstree",".jstree-node",function(t){this.dehover_node(t.currentTarget)}.bind(this))};this.teardown=function(){if(this.settings.wholerow){this.element.find(".jstree-wholerow").remove()}t.teardown.call(this)};this.redraw_node=function(e){e=t.redraw_node.apply(this,arguments);if(e){var a=p.cloneNode(!0);if(-1!==_.inArray(e.id,this._data.core.selected)){a.className+=" jstree-wholerow-clicked"}if(this._data.core.focused&&this._data.core.focused===e.id){a.className+=" jstree-wholerow-hovered"}e.insertBefore(a,e.childNodes[0])}return e}};if(window.customElements&&Object&&Object.create){var m=Object.create(HTMLElement.prototype);m.createdCallback=function(){var e={core:{},plugins:[]},t;for(t in _.jstree.plugins){if(_.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]){e.plugins.push(t);if(this.getAttribute(t)&&JSON.parse(this.getAttribute(t))){e[t]=JSON.parse(this.getAttribute(t))}}}for(t in _.jstree.defaults.core){if(_.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]){e.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t)}}_(this).jstree(e)};try{window.customElements.define("vakata-jstree",function(){},{prototype:m})}catch(e){}}});
define ("theme_coursemos/printThis",["jquery"],function(){(function(a){function b(a,b){if(!b)return;a.append(b.jquery?b.clone():b)}function c(b,c,e){var f=c.clone(e.formValues);if(e.formValues){d(c,f,"select, textarea")}if(e.removeScripts){f.find("script").remove()}if(e.printContainer){f.appendTo(b)}else{f.each(function(){a(this).children().appendTo(b)})}}function d(b,c,d){var e=b.find(d);c.find(d).each(function(b,c){a(c).val(e.eq(b).val())})}var e;a.fn.printThis=function(d){e=a.extend({},a.fn.printThis.defaults,d);var f=this instanceof jQuery?this:a(this),g="printThis-"+new Date().getTime();if(window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)){var h="javascript:document.write(\"<head><script>document.domain=\\\""+document.domain+"\\\";</script></head><body></body>\")",i=document.createElement("iframe");i.name="printIframe";i.id=g;i.className="MSIE";document.body.appendChild(i);i.src=h}else{var j=a("<iframe id='"+g+"' name='printIframe' />");j.appendTo("body")}var k=a("#"+g);if(!e.debug)k.css({position:"absolute",width:"0px",height:"0px",left:"-600px",top:"-600px"});if("function"==typeof e.beforePrint){e.beforePrint()}setTimeout(function(){function d(a,b){var c,d;c=a.get(0);c=c.contentWindow||c.contentDocument||c;d=c.document||c.contentDocument||c;d.open();d.write(b);d.close()}if(e.doctypeString){d(k,e.doctypeString)}var h=k.contents(),i=h.find("head"),j=h.find("body"),l=a("base"),m;if(!0===e.base&&0<l.length){m=l.attr("href")}else if("string"==typeof e.base){m=e.base}else{m=document.location.protocol+"//"+document.location.host}i.append("<base href=\""+m+"\">");if(e.importCSS)a("link[rel=stylesheet]").each(function(){var b=a(this).attr("href");if(b){var c=a(this).attr("media")||"all";i.append("<link type='text/css' rel='stylesheet' href='"+b+"' media='"+c+"'>")}});if(e.importStyle)a("style").each(function(){i.append(this.outerHTML)});if(e.pageTitle)i.append("<title>"+e.pageTitle+"</title>");if(e.loadCSS){if(a.isArray(e.loadCSS)){jQuery.each(e.loadCSS,function(){i.append("<link type='text/css' rel='stylesheet' href='"+this+"'>")})}else{i.append("<link type='text/css' rel='stylesheet' href='"+e.loadCSS+"'>")}}var n=a("html")[0];h.find("html").prop("style",n.style.cssText);var o=e.copyTagClasses;if(o){o=!0===o?"bh":o;if(-1!==o.indexOf("b")){j.addClass(a("body")[0].className)}if(-1!==o.indexOf("h")){h.find("html").addClass(n.className)}}b(j,e.header);if(e.canvas){var p=0;f.find("canvas").addBack("canvas").each(function(){a(this).attr("data-printthis",p++)})}c(j,f,e);if(e.canvas){j.find("canvas").each(function(){var b=a(this).data("printthis"),c=a("[data-printthis=\""+b+"\"]");this.getContext("2d").drawImage(c[0],0,0);if(a.isFunction(a.fn.removeAttr)){c.removeAttr("data-printthis")}else{a.each(c,function(a,b){b.removeAttribute("data-printthis")})}})}if(e.removeInline){var q=e.removeInlineSelector||"*";if(a.isFunction(a.removeAttr)){j.find(q).removeAttr("style")}else{j.find(q).attr("style","")}}b(j,e.footer);function g(a,b){var c=a.get(0);c=c.contentWindow||c.contentDocument||c;if("function"==typeof b){if("matchMedia"in c){c.matchMedia("print").addListener(function(a){if(a.matches)b()})}else{c.onbeforeprint=b}}}g(k,e.beforePrint);setTimeout(function(){if(k.hasClass("MSIE")){window.frames.printIframe.focus();i.append("<script>  window.print(); </script>")}else{if(document.queryCommandSupported("print")){k[0].contentWindow.document.execCommand("print",!1,null)}else{k[0].contentWindow.focus();k[0].contentWindow.print()}}if(!e.debug){setTimeout(function(){k.remove()},1e3)}if("function"==typeof e.afterPrint){e.afterPrint()}},e.printDelay)},333)};a.fn.printThis.defaults={debug:!1,importCSS:!0,importStyle:!1,printContainer:!0,loadCSS:"",pageTitle:"",removeInline:!1,removeInlineSelector:"*",printDelay:333,header:null,footer:null,base:!1,formValues:!0,canvas:!1,doctypeString:"<!DOCTYPE html>",removeScripts:!1,copyTagClasses:!1,beforePrintEvent:null,beforePrint:null,afterPrint:null}})(jQuery)});
function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(e){'use strict';if("function"==typeof define&&define.amd){define ("theme_coursemos/slick",["jquery"],e)}else if("undefined"!=typeof exports){module.exports=e(require("jquery"))}else{e(jQuery)}})(function(e){'use strict';var t=window.Slick||{};t=function(){var t=0;function i(i,s){var o=this,n;o.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:e(i),appendDots:e(i),arrows:!0,asNavFor:null,prevArrow:"<button class=\"slick-prev\" aria-label=\"Previous\" type=\"button\">Previous</button>",nextArrow:"<button class=\"slick-next\" aria-label=\"Next\" type=\"button\">Next</button>",autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function customPaging(t,s){return e("<button type=\"button\" />").text(s+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,focusOnChange:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3};o.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,scrolling:!1,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,swiping:!1,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1};e.extend(o,o.initials);o.activeBreakpoint=null;o.animType=null;o.animProp=null;o.breakpoints=[];o.breakpointSettings=[];o.cssTransitions=!1;o.focussed=!1;o.interrupted=!1;o.hidden="hidden";o.paused=!0;o.positionProp=null;o.respondTo=null;o.rowCount=1;o.shouldClick=!0;o.$slider=e(i);o.$slidesCache=null;o.transformType=null;o.transitionType=null;o.visibilityChange="visibilitychange";o.windowWidth=0;o.windowTimer=null;n=e(i).data("slick")||{};o.options=e.extend({},o.defaults,s,n);o.currentSlide=o.options.initialSlide;o.originalSettings=o.options;if("undefined"!=typeof document.mozHidden){o.hidden="mozHidden";o.visibilityChange="mozvisibilitychange"}else if("undefined"!=typeof document.webkitHidden){o.hidden="webkitHidden";o.visibilityChange="webkitvisibilitychange"}o.autoPlay=e.proxy(o.autoPlay,o);o.autoPlayClear=e.proxy(o.autoPlayClear,o);o.autoPlayIterator=e.proxy(o.autoPlayIterator,o);o.changeSlide=e.proxy(o.changeSlide,o);o.clickHandler=e.proxy(o.clickHandler,o);o.selectHandler=e.proxy(o.selectHandler,o);o.setPosition=e.proxy(o.setPosition,o);o.swipeHandler=e.proxy(o.swipeHandler,o);o.dragHandler=e.proxy(o.dragHandler,o);o.keyHandler=e.proxy(o.keyHandler,o);o.instanceUid=t++;o.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/;o.registerBreakpoints();o.init(!0)}return i}();t.prototype.activateADA=function(){var e=this;e.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})};t.prototype.addSlide=t.prototype.slickAdd=function(i,t,s){var o=this;if("boolean"==typeof t){s=t;t=null}else if(0>t||t>=o.slideCount){return!1}o.unload();if("number"==typeof t){if(0===t&&0===o.$slides.length){e(i).appendTo(o.$slideTrack)}else if(s){e(i).insertBefore(o.$slides.eq(t))}else{e(i).insertAfter(o.$slides.eq(t))}}else{if(!0===s){e(i).prependTo(o.$slideTrack)}else{e(i).appendTo(o.$slideTrack)}}o.$slides=o.$slideTrack.children(this.options.slide);o.$slideTrack.children(this.options.slide).detach();o.$slideTrack.append(o.$slides);o.$slides.each(function(i,t){e(t).attr("data-slick-index",i)});o.$slidesCache=o.$slides;o.reinit()};t.prototype.animateHeight=function(){var e=this;if(1===e.options.slidesToShow&&!0===e.options.adaptiveHeight&&!1===e.options.vertical){var i=e.$slides.eq(e.currentSlide).outerHeight(!0);e.$list.animate({height:i},e.options.speed)}};t.prototype.animateSlide=function(i,t){var s={},o=this;o.animateHeight();if(!0===o.options.rtl&&!1===o.options.vertical){i=-i}if(!1===o.transformsEnabled){if(!1===o.options.vertical){o.$slideTrack.animate({left:i},o.options.speed,o.options.easing,t)}else{o.$slideTrack.animate({top:i},o.options.speed,o.options.easing,t)}}else{if(!1===o.cssTransitions){if(!0===o.options.rtl){o.currentLeft=-o.currentLeft}e({animStart:o.currentLeft}).animate({animStart:i},{duration:o.options.speed,easing:o.options.easing,step:function step(e){e=Math.ceil(e);if(!1===o.options.vertical){s[o.animType]="translate("+e+"px, 0px)";o.$slideTrack.css(s)}else{s[o.animType]="translate(0px,"+e+"px)";o.$slideTrack.css(s)}},complete:function complete(){if(t){t.call()}}})}else{o.applyTransition();i=Math.ceil(i);if(!1===o.options.vertical){s[o.animType]="translate3d("+i+"px, 0px, 0px)"}else{s[o.animType]="translate3d(0px,"+i+"px, 0px)"}o.$slideTrack.css(s);if(t){setTimeout(function(){o.disableTransition();t.call()},o.options.speed)}}}};t.prototype.getNavTarget=function(){var i=this,t=i.options.asNavFor;if(t&&null!==t){t=e(t).not(i.$slider)}return t};t.prototype.asNavFor=function(i){var t=this,s=t.getNavTarget();if(null!==s&&"object"===_typeof(s)){s.each(function(){var t=e(this).slick("getSlick");if(!t.unslicked){t.slideHandler(i,!0)}})}};t.prototype.applyTransition=function(e){var i=this,t={};if(!1===i.options.fade){t[i.transitionType]=i.transformType+" "+i.options.speed+"ms "+i.options.cssEase}else{t[i.transitionType]="opacity "+i.options.speed+"ms "+i.options.cssEase}if(!1===i.options.fade){i.$slideTrack.css(t)}else{i.$slides.eq(e).css(t)}};t.prototype.autoPlay=function(){var e=this;e.autoPlayClear();if(e.slideCount>e.options.slidesToShow){e.autoPlayTimer=setInterval(e.autoPlayIterator,e.options.autoplaySpeed)}};t.prototype.autoPlayClear=function(){var e=this;if(e.autoPlayTimer){clearInterval(e.autoPlayTimer)}};t.prototype.autoPlayIterator=function(){var e=this,i=e.currentSlide+e.options.slidesToScroll;if(!e.paused&&!e.interrupted&&!e.focussed){if(!1===e.options.infinite){if(1===e.direction&&e.currentSlide+1===e.slideCount-1){e.direction=0}else if(0===e.direction){i=e.currentSlide-e.options.slidesToScroll;if(0==e.currentSlide-1){e.direction=1}}}e.slideHandler(i)}};t.prototype.buildArrows=function(){var i=this;if(!0===i.options.arrows){i.$prevArrow=e(i.options.prevArrow).addClass("slick-arrow");i.$nextArrow=e(i.options.nextArrow).addClass("slick-arrow");if(i.slideCount>i.options.slidesToShow){i.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex");i.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex");if(i.htmlExpr.test(i.options.prevArrow)){i.$prevArrow.prependTo(i.options.appendArrows)}if(i.htmlExpr.test(i.options.nextArrow)){i.$nextArrow.appendTo(i.options.appendArrows)}if(!0!==i.options.infinite){i.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")}}else{i.$prevArrow.add(i.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"})}}};t.prototype.buildDots=function(){var t=this,s,o;if(!0===t.options.dots&&t.slideCount>t.options.slidesToShow){t.$slider.addClass("slick-dotted");o=e("<ul />").addClass(t.options.dotsClass);for(s=0;s<=t.getDotCount();s+=1){o.append(e("<li />").append(t.options.customPaging.call(this,t,s)))}t.$dots=o.appendTo(t.options.appendDots);t.$dots.find("li").first().addClass("slick-active")}};t.prototype.buildOut=function(){var i=this;i.$slides=i.$slider.children(i.options.slide+":not(.slick-cloned)").addClass("slick-slide");i.slideCount=i.$slides.length;i.$slides.each(function(i,t){e(t).attr("data-slick-index",i).data("originalStyling",e(t).attr("style")||"")});i.$slider.addClass("slick-slider");i.$slideTrack=0===i.slideCount?e("<div class=\"slick-track\"/>").appendTo(i.$slider):i.$slides.wrapAll("<div class=\"slick-track\"/>").parent();i.$list=i.$slideTrack.wrap("<div class=\"slick-list\"/>").parent();i.$slideTrack.css("opacity",0);if(!0===i.options.centerMode||!0===i.options.swipeToSlide){i.options.slidesToScroll=1}e("img[data-lazy]",i.$slider).not("[src]").addClass("slick-loading");i.setupInfinite();i.buildArrows();i.buildDots();i.updateDots();i.setSlideClasses("number"==typeof i.currentSlide?i.currentSlide:0);if(!0===i.options.draggable){i.$list.addClass("draggable")}};t.prototype.buildRows=function(){var e=this,i,t,s,o,n,l,r;o=document.createDocumentFragment();l=e.$slider.children();if(0<e.options.rows){r=e.options.slidesPerRow*e.options.rows;n=Math.ceil(l.length/r);for(i=0;i<n;i++){var d=document.createElement("div");for(t=0;t<e.options.rows;t++){var p=document.createElement("div");for(s=0;s<e.options.slidesPerRow;s++){var u=i*r+(t*e.options.slidesPerRow+s);if(l.get(u)){p.appendChild(l.get(u))}}d.appendChild(p)}o.appendChild(d)}e.$slider.empty().append(o);e.$slider.children().children().children().css({width:100/e.options.slidesPerRow+"%",display:"inline-block"})}};t.prototype.checkResponsive=function(i,t){var s=this,o,n,l,r=!1,d=s.$slider.width(),a=window.innerWidth||e(window).width();if("window"===s.respondTo){l=a}else if("slider"===s.respondTo){l=d}else if("min"===s.respondTo){l=Math.min(a,d)}if(s.options.responsive&&s.options.responsive.length&&null!==s.options.responsive){n=null;for(o in s.breakpoints){if(s.breakpoints.hasOwnProperty(o)){if(!1===s.originalSettings.mobileFirst){if(l<s.breakpoints[o]){n=s.breakpoints[o]}}else{if(l>s.breakpoints[o]){n=s.breakpoints[o]}}}}if(null!==n){if(null!==s.activeBreakpoint){if(n!==s.activeBreakpoint||t){s.activeBreakpoint=n;if("unslick"===s.breakpointSettings[n]){s.unslick(n)}else{s.options=e.extend({},s.originalSettings,s.breakpointSettings[n]);if(!0===i){s.currentSlide=s.options.initialSlide}s.refresh(i)}r=n}}else{s.activeBreakpoint=n;if("unslick"===s.breakpointSettings[n]){s.unslick(n)}else{s.options=e.extend({},s.originalSettings,s.breakpointSettings[n]);if(!0===i){s.currentSlide=s.options.initialSlide}s.refresh(i)}r=n}}else{if(null!==s.activeBreakpoint){s.activeBreakpoint=null;s.options=s.originalSettings;if(!0===i){s.currentSlide=s.options.initialSlide}s.refresh(i);r=n}}if(!i&&!1!==r){s.$slider.trigger("breakpoint",[s,r])}}};t.prototype.changeSlide=function(i,t){var s=this,o=e(i.currentTarget),n,l,r;if(o.is("a")){i.preventDefault()}if(!o.is("li")){o=o.closest("li")}r=0!=s.slideCount%s.options.slidesToScroll;n=r?0:(s.slideCount-s.currentSlide)%s.options.slidesToScroll;switch(i.data.message){case"previous":l=0===n?s.options.slidesToScroll:s.options.slidesToShow-n;if(s.slideCount>s.options.slidesToShow){s.slideHandler(s.currentSlide-l,!1,t)}break;case"next":l=0===n?s.options.slidesToScroll:n;if(s.slideCount>s.options.slidesToShow){s.slideHandler(s.currentSlide+l,!1,t)}break;case"index":var d=0===i.data.index?0:i.data.index||o.index()*s.options.slidesToScroll;s.slideHandler(s.checkNavigable(d),!1,t);o.children().trigger("focus");break;default:}};t.prototype.checkNavigable=function(e){var i=this,t,s;t=i.getNavigableIndexes();s=0;if(e>t[t.length-1]){e=t[t.length-1]}else{for(var o in t){if(e<t[o]){e=s;break}s=t[o]}}return e};t.prototype.cleanUpEvents=function(){var i=this;if(i.options.dots&&null!==i.$dots){e("li",i.$dots).off("click.slick",i.changeSlide).off("mouseenter.slick",e.proxy(i.interrupt,i,!0)).off("mouseleave.slick",e.proxy(i.interrupt,i,!1));if(!0===i.options.accessibility){i.$dots.off("keydown.slick",i.keyHandler)}}i.$slider.off("focus.slick blur.slick");if(!0===i.options.arrows&&i.slideCount>i.options.slidesToShow){i.$prevArrow&&i.$prevArrow.off("click.slick",i.changeSlide);i.$nextArrow&&i.$nextArrow.off("click.slick",i.changeSlide);if(!0===i.options.accessibility){i.$prevArrow&&i.$prevArrow.off("keydown.slick",i.keyHandler);i.$nextArrow&&i.$nextArrow.off("keydown.slick",i.keyHandler)}}i.$list.off("touchstart.slick mousedown.slick",i.swipeHandler);i.$list.off("touchmove.slick mousemove.slick",i.swipeHandler);i.$list.off("touchend.slick mouseup.slick",i.swipeHandler);i.$list.off("touchcancel.slick mouseleave.slick",i.swipeHandler);i.$list.off("click.slick",i.clickHandler);e(document).off(i.visibilityChange,i.visibility);i.cleanUpSlideEvents();if(!0===i.options.accessibility){i.$list.off("keydown.slick",i.keyHandler)}if(!0===i.options.focusOnSelect){e(i.$slideTrack).children().off("click.slick",i.selectHandler)}e(window).off("orientationchange.slick.slick-"+i.instanceUid,i.orientationChange);e(window).off("resize.slick.slick-"+i.instanceUid,i.resize);e("[draggable!=true]",i.$slideTrack).off("dragstart",i.preventDefault);e(window).off("load.slick.slick-"+i.instanceUid,i.setPosition)};t.prototype.cleanUpSlideEvents=function(){var i=this;i.$list.off("mouseenter.slick",e.proxy(i.interrupt,i,!0));i.$list.off("mouseleave.slick",e.proxy(i.interrupt,i,!1))};t.prototype.cleanUpRows=function(){var e=this,i;if(0<e.options.rows){i=e.$slides.children().children();i.removeAttr("style");e.$slider.empty().append(i)}};t.prototype.clickHandler=function(e){var i=this;if(!1===i.shouldClick){e.stopImmediatePropagation();e.stopPropagation();e.preventDefault()}};t.prototype.destroy=function(i){var t=this;t.autoPlayClear();t.touchObject={};t.cleanUpEvents();e(".slick-cloned",t.$slider).detach();if(t.$dots){t.$dots.remove()}if(t.$prevArrow&&t.$prevArrow.length){t.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display","");if(t.htmlExpr.test(t.options.prevArrow)){t.$prevArrow.remove()}}if(t.$nextArrow&&t.$nextArrow.length){t.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display","");if(t.htmlExpr.test(t.options.nextArrow)){t.$nextArrow.remove()}}if(t.$slides){t.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){e(this).attr("style",e(this).data("originalStyling"))});t.$slideTrack.children(this.options.slide).detach();t.$slideTrack.detach();t.$list.detach();t.$slider.append(t.$slides)}t.cleanUpRows();t.$slider.removeClass("slick-slider");t.$slider.removeClass("slick-initialized");t.$slider.removeClass("slick-dotted");t.unslicked=!0;if(!i){t.$slider.trigger("destroy",[t])}};t.prototype.disableTransition=function(e){var i=this,t={};t[i.transitionType]="";if(!1===i.options.fade){i.$slideTrack.css(t)}else{i.$slides.eq(e).css(t)}};t.prototype.fadeSlide=function(e,i){var t=this;if(!1===t.cssTransitions){t.$slides.eq(e).css({zIndex:t.options.zIndex});t.$slides.eq(e).animate({opacity:1},t.options.speed,t.options.easing,i)}else{t.applyTransition(e);t.$slides.eq(e).css({opacity:1,zIndex:t.options.zIndex});if(i){setTimeout(function(){t.disableTransition(e);i.call()},t.options.speed)}}};t.prototype.fadeSlideOut=function(e){var i=this;if(!1===i.cssTransitions){i.$slides.eq(e).animate({opacity:0,zIndex:i.options.zIndex-2},i.options.speed,i.options.easing)}else{i.applyTransition(e);i.$slides.eq(e).css({opacity:0,zIndex:i.options.zIndex-2})}};t.prototype.filterSlides=t.prototype.slickFilter=function(e){var i=this;if(null!==e){i.$slidesCache=i.$slides;i.unload();i.$slideTrack.children(this.options.slide).detach();i.$slidesCache.filter(e).appendTo(i.$slideTrack);i.reinit()}};t.prototype.focusHandler=function(){var i=this;i.$slider.off("focus.slick blur.slick").on("focus.slick","*",function(){var t=e(this);setTimeout(function(){if(i.options.pauseOnFocus){if(t.is(":focus")){i.focussed=!0;i.autoPlay()}}},0)}).on("blur.slick","*",function(){e(this);if(i.options.pauseOnFocus){i.focussed=!1;i.autoPlay()}})};t.prototype.getCurrent=t.prototype.slickCurrentSlide=function(){var e=this;return e.currentSlide};t.prototype.getDotCount=function(){var e=this,i=0,t=0,s=0;if(!0===e.options.infinite){if(e.slideCount<=e.options.slidesToShow){++s}else{while(i<e.slideCount){++s;i=t+e.options.slidesToScroll;t+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow}}}else if(!0===e.options.centerMode){s=e.slideCount}else if(!e.options.asNavFor){s=1+Math.ceil((e.slideCount-e.options.slidesToShow)/e.options.slidesToScroll)}else{while(i<e.slideCount){++s;i=t+e.options.slidesToScroll;t+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow}}return s-1};t.prototype.getLeft=function(e){var i=this,t,s,o=0,n,l;i.slideOffset=0;s=i.$slides.first().outerHeight(!0);if(!0===i.options.infinite){if(i.slideCount>i.options.slidesToShow){i.slideOffset=-1*(i.slideWidth*i.options.slidesToShow);l=-1;if(!0===i.options.vertical&&!0===i.options.centerMode){if(2===i.options.slidesToShow){l=-1.5}else if(1===i.options.slidesToShow){l=-2}}o=s*i.options.slidesToShow*l}if(0!=i.slideCount%i.options.slidesToScroll){if(e+i.options.slidesToScroll>i.slideCount&&i.slideCount>i.options.slidesToShow){if(e>i.slideCount){i.slideOffset=-1*((i.options.slidesToShow-(e-i.slideCount))*i.slideWidth);o=-1*((i.options.slidesToShow-(e-i.slideCount))*s)}else{i.slideOffset=-1*(i.slideCount%i.options.slidesToScroll*i.slideWidth);o=-1*(i.slideCount%i.options.slidesToScroll*s)}}}}else{if(e+i.options.slidesToShow>i.slideCount){i.slideOffset=(e+i.options.slidesToShow-i.slideCount)*i.slideWidth;o=(e+i.options.slidesToShow-i.slideCount)*s}}if(i.slideCount<=i.options.slidesToShow){i.slideOffset=0;o=0}if(!0===i.options.centerMode&&i.slideCount<=i.options.slidesToShow){i.slideOffset=i.slideWidth*Math.floor(i.options.slidesToShow)/2-i.slideWidth*i.slideCount/2}else if(!0===i.options.centerMode&&!0===i.options.infinite){i.slideOffset+=i.slideWidth*Math.floor(i.options.slidesToShow/2)-i.slideWidth}else if(!0===i.options.centerMode){i.slideOffset=0;i.slideOffset+=i.slideWidth*Math.floor(i.options.slidesToShow/2)}if(!1===i.options.vertical){t=-1*(e*i.slideWidth)+i.slideOffset}else{t=-1*(e*s)+o}if(!0===i.options.variableWidth){if(i.slideCount<=i.options.slidesToShow||!1===i.options.infinite){n=i.$slideTrack.children(".slick-slide").eq(e)}else{n=i.$slideTrack.children(".slick-slide").eq(e+i.options.slidesToShow)}if(!0===i.options.rtl){if(n[0]){t=-1*(i.$slideTrack.width()-n[0].offsetLeft-n.width())}else{t=0}}else{t=n[0]?-1*n[0].offsetLeft:0}if(!0===i.options.centerMode){if(i.slideCount<=i.options.slidesToShow||!1===i.options.infinite){n=i.$slideTrack.children(".slick-slide").eq(e)}else{n=i.$slideTrack.children(".slick-slide").eq(e+i.options.slidesToShow+1)}if(!0===i.options.rtl){if(n[0]){t=-1*(i.$slideTrack.width()-n[0].offsetLeft-n.width())}else{t=0}}else{t=n[0]?-1*n[0].offsetLeft:0}t+=(i.$list.width()-n.outerWidth())/2}}return t};t.prototype.getOption=t.prototype.slickGetOption=function(e){var i=this;return i.options[e]};t.prototype.getNavigableIndexes=function(){var e=this,i=0,t=0,s=[],o;if(!1===e.options.infinite){o=e.slideCount}else{i=-1*e.options.slidesToScroll;t=-1*e.options.slidesToScroll;o=2*e.slideCount}while(i<o){s.push(i);i=t+e.options.slidesToScroll;t+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow}return s};t.prototype.getSlick=function(){return this};t.prototype.getSlideCount=function(){var i=this,t,s,o,n;n=!0===i.options.centerMode?Math.floor(i.$list.width()/2):0;o=-1*i.swipeLeft+n;if(!0===i.options.swipeToSlide){i.$slideTrack.find(".slick-slide").each(function(t,n){var l,r,d;l=e(n).outerWidth();r=n.offsetLeft;if(!0!==i.options.centerMode){r+=l/2}d=r+l;if(o<d){s=n;return!1}});t=Math.abs(e(s).attr("data-slick-index")-i.currentSlide)||1;return t}else{return i.options.slidesToScroll}};t.prototype.goTo=t.prototype.slickGoTo=function(e,i){var t=this;t.changeSlide({data:{message:"index",index:parseInt(e)}},i)};t.prototype.init=function(i){var t=this;if(!e(t.$slider).hasClass("slick-initialized")){e(t.$slider).addClass("slick-initialized");t.buildRows();t.buildOut();t.setProps();t.startLoad();t.loadSlider();t.initializeEvents();t.updateArrows();t.updateDots();t.checkResponsive(!0);t.focusHandler()}if(i){t.$slider.trigger("init",[t])}if(!0===t.options.accessibility){t.initADA()}if(t.options.autoplay){t.paused=!1;t.autoPlay()}};t.prototype.initADA=function(){var t=this,s=Math.ceil(t.slideCount/t.options.slidesToShow),o=t.getNavigableIndexes().filter(function(e){return 0<=e&&e<t.slideCount});t.$slides.add(t.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"});if(null!==t.$dots){t.$slides.not(t.$slideTrack.find(".slick-cloned")).each(function(s){var i=o.indexOf(s);e(this).attr({role:"tabpanel",id:"slick-slide"+t.instanceUid+s,tabindex:-1});if(-1!==i){var n="slick-slide-control"+t.instanceUid+i;if(e("#"+n).length){e(this).attr({"aria-describedby":n})}}});t.$dots.attr("role","tablist").find("li").each(function(n){var i=o[n];e(this).attr({role:"presentation"});e(this).find("button").first().attr({role:"tab",id:"slick-slide-control"+t.instanceUid+n,"aria-controls":"slick-slide"+t.instanceUid+i,"aria-label":n+1+" of "+s,"aria-selected":null,tabindex:"-1"})}).eq(t.currentSlide).find("button").attr({"aria-selected":"true",tabindex:"0"}).end()}for(var n=t.currentSlide,l=n+t.options.slidesToShow;n<l;n++){if(t.options.focusOnChange){t.$slides.eq(n).attr({tabindex:"0"})}else{t.$slides.eq(n).removeAttr("tabindex")}}t.activateADA()};t.prototype.initArrowEvents=function(){var e=this;if(!0===e.options.arrows&&e.slideCount>e.options.slidesToShow){e.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},e.changeSlide);e.$nextArrow.off("click.slick").on("click.slick",{message:"next"},e.changeSlide);if(!0===e.options.accessibility){e.$prevArrow.on("keydown.slick",e.keyHandler);e.$nextArrow.on("keydown.slick",e.keyHandler)}}};t.prototype.initDotEvents=function(){var i=this;if(!0===i.options.dots&&i.slideCount>i.options.slidesToShow){e("li",i.$dots).on("click.slick",{message:"index"},i.changeSlide);if(!0===i.options.accessibility){i.$dots.on("keydown.slick",i.keyHandler)}}if(!0===i.options.dots&&!0===i.options.pauseOnDotsHover&&i.slideCount>i.options.slidesToShow){e("li",i.$dots).on("mouseenter.slick",e.proxy(i.interrupt,i,!0)).on("mouseleave.slick",e.proxy(i.interrupt,i,!1))}};t.prototype.initSlideEvents=function(){var i=this;if(i.options.pauseOnHover){i.$list.on("mouseenter.slick",e.proxy(i.interrupt,i,!0));i.$list.on("mouseleave.slick",e.proxy(i.interrupt,i,!1))}};t.prototype.initializeEvents=function(){var i=this;i.initArrowEvents();i.initDotEvents();i.initSlideEvents();i.$list.on("touchstart.slick mousedown.slick",{action:"start"},i.swipeHandler);i.$list.on("touchmove.slick mousemove.slick",{action:"move"},i.swipeHandler);i.$list.on("touchend.slick mouseup.slick",{action:"end"},i.swipeHandler);i.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},i.swipeHandler);i.$list.on("click.slick",i.clickHandler);e(document).on(i.visibilityChange,e.proxy(i.visibility,i));if(!0===i.options.accessibility){i.$list.on("keydown.slick",i.keyHandler)}if(!0===i.options.focusOnSelect){e(i.$slideTrack).children().on("click.slick",i.selectHandler)}e(window).on("orientationchange.slick.slick-"+i.instanceUid,e.proxy(i.orientationChange,i));e(window).on("resize.slick.slick-"+i.instanceUid,e.proxy(i.resize,i));e("[draggable!=true]",i.$slideTrack).on("dragstart",i.preventDefault);e(window).on("load.slick.slick-"+i.instanceUid,i.setPosition);e(i.setPosition)};t.prototype.initUI=function(){var e=this;if(!0===e.options.arrows&&e.slideCount>e.options.slidesToShow){e.$prevArrow.show();e.$nextArrow.show()}if(!0===e.options.dots&&e.slideCount>e.options.slidesToShow){e.$dots.show()}};t.prototype.keyHandler=function(e){var i=this;if(!e.target.tagName.match("TEXTAREA|INPUT|SELECT")){if(37===e.keyCode&&!0===i.options.accessibility){i.changeSlide({data:{message:!0===i.options.rtl?"next":"previous"}})}else if(39===e.keyCode&&!0===i.options.accessibility){i.changeSlide({data:{message:!0===i.options.rtl?"previous":"next"}})}}};t.prototype.lazyLoad=function(){var s=this,o,n,l,r;function t(i){e("img[data-lazy]",i).each(function(){var i=e(this),t=e(this).attr("data-lazy"),o=e(this).attr("data-srcset"),n=e(this).attr("data-sizes")||s.$slider.attr("data-sizes"),l=document.createElement("img");l.onload=function(){i.animate({opacity:0},100,function(){if(o){i.attr("srcset",o);if(n){i.attr("sizes",n)}}i.attr("src",t).animate({opacity:1},200,function(){i.removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading")});s.$slider.trigger("lazyLoaded",[s,i,t])})};l.onerror=function(){i.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error");s.$slider.trigger("lazyLoadError",[s,i,t])};l.src=t})}if(!0===s.options.centerMode){if(!0===s.options.infinite){l=s.currentSlide+(s.options.slidesToShow/2+1);r=l+s.options.slidesToShow+2}else{l=Math.max(0,s.currentSlide-(s.options.slidesToShow/2+1));r=2+(s.options.slidesToShow/2+1)+s.currentSlide}}else{l=s.options.infinite?s.options.slidesToShow+s.currentSlide:s.currentSlide;r=Math.ceil(l+s.options.slidesToShow);if(!0===s.options.fade){if(0<l)l--;if(r<=s.slideCount)r++}}o=s.$slider.find(".slick-slide").slice(l,r);if("anticipated"===s.options.lazyLoad){for(var d=l-1,a=r,p=s.$slider.find(".slick-slide"),c=0;c<s.options.slidesToScroll;c++){if(0>d)d=s.slideCount-1;o=o.add(p.eq(d));o=o.add(p.eq(a));d--;a++}}t(o);if(s.slideCount<=s.options.slidesToShow){n=s.$slider.find(".slick-slide");t(n)}else if(s.currentSlide>=s.slideCount-s.options.slidesToShow){n=s.$slider.find(".slick-cloned").slice(0,s.options.slidesToShow);t(n)}else if(0===s.currentSlide){n=s.$slider.find(".slick-cloned").slice(-1*s.options.slidesToShow);t(n)}};t.prototype.loadSlider=function(){var e=this;e.setPosition();e.$slideTrack.css({opacity:1});e.$slider.removeClass("slick-loading");e.initUI();if("progressive"===e.options.lazyLoad){e.progressiveLazyLoad()}};t.prototype.next=t.prototype.slickNext=function(){var e=this;e.changeSlide({data:{message:"next"}})};t.prototype.orientationChange=function(){var e=this;e.checkResponsive();e.setPosition()};t.prototype.pause=t.prototype.slickPause=function(){var e=this;e.autoPlayClear();e.paused=!0};t.prototype.play=t.prototype.slickPlay=function(){var e=this;e.autoPlay();e.options.autoplay=!0;e.paused=!1;e.focussed=!1;e.interrupted=!1};t.prototype.postSlide=function(i){var t=this;if(!t.unslicked){t.$slider.trigger("afterChange",[t,i]);t.animating=!1;if(t.slideCount>t.options.slidesToShow){t.setPosition()}t.swipeLeft=null;if(t.options.autoplay){t.autoPlay()}if(!0===t.options.accessibility){t.initADA();if(t.options.focusOnChange){var s=e(t.$slides.get(t.currentSlide));s.attr("tabindex",0).focus()}}}};t.prototype.prev=t.prototype.slickPrev=function(){var e=this;e.changeSlide({data:{message:"previous"}})};t.prototype.preventDefault=function(e){e.preventDefault()};t.prototype.progressiveLazyLoad=function(i){i=i||1;var t=this,s=e("img[data-lazy]",t.$slider),o,n,l,r,d;if(s.length){o=s.first();n=o.attr("data-lazy");l=o.attr("data-srcset");r=o.attr("data-sizes")||t.$slider.attr("data-sizes");d=document.createElement("img");d.onload=function(){if(l){o.attr("srcset",l);if(r){o.attr("sizes",r)}}o.attr("src",n).removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading");if(!0===t.options.adaptiveHeight){t.setPosition()}t.$slider.trigger("lazyLoaded",[t,o,n]);t.progressiveLazyLoad()};d.onerror=function(){if(3>i){setTimeout(function(){t.progressiveLazyLoad(i+1)},500)}else{o.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error");t.$slider.trigger("lazyLoadError",[t,o,n]);t.progressiveLazyLoad()}};d.src=n}else{t.$slider.trigger("allImagesLoaded",[t])}};t.prototype.refresh=function(i){var t=this,s,o;o=t.slideCount-t.options.slidesToShow;if(!t.options.infinite&&t.currentSlide>o){t.currentSlide=o}if(t.slideCount<=t.options.slidesToShow){t.currentSlide=0}s=t.currentSlide;t.destroy(!0);e.extend(t,t.initials,{currentSlide:s});t.init();if(!i){t.changeSlide({data:{message:"index",index:s}},!1)}};t.prototype.registerBreakpoints=function(){var i=this,t,s,o,n=i.options.responsive||null;if("array"===e.type(n)&&n.length){i.respondTo=i.options.respondTo||"window";for(t in n){o=i.breakpoints.length-1;if(n.hasOwnProperty(t)){s=n[t].breakpoint;while(0<=o){if(i.breakpoints[o]&&i.breakpoints[o]===s){i.breakpoints.splice(o,1)}o--}i.breakpoints.push(s);i.breakpointSettings[s]=n[t].settings}}i.breakpoints.sort(function(e,t){return i.options.mobileFirst?e-t:t-e})}};t.prototype.reinit=function(){var i=this;i.$slides=i.$slideTrack.children(i.options.slide).addClass("slick-slide");i.slideCount=i.$slides.length;if(i.currentSlide>=i.slideCount&&0!==i.currentSlide){i.currentSlide=i.currentSlide-i.options.slidesToScroll}if(i.slideCount<=i.options.slidesToShow){i.currentSlide=0}i.registerBreakpoints();i.setProps();i.setupInfinite();i.buildArrows();i.updateArrows();i.initArrowEvents();i.buildDots();i.updateDots();i.initDotEvents();i.cleanUpSlideEvents();i.initSlideEvents();i.checkResponsive(!1,!0);if(!0===i.options.focusOnSelect){e(i.$slideTrack).children().on("click.slick",i.selectHandler)}i.setSlideClasses("number"==typeof i.currentSlide?i.currentSlide:0);i.setPosition();i.focusHandler();i.paused=!i.options.autoplay;i.autoPlay();i.$slider.trigger("reInit",[i])};t.prototype.resize=function(){var i=this;if(e(window).width()!==i.windowWidth){clearTimeout(i.windowDelay);i.windowDelay=window.setTimeout(function(){i.windowWidth=e(window).width();i.checkResponsive();if(!i.unslicked){i.setPosition()}},50)}};t.prototype.removeSlide=t.prototype.slickRemove=function(e,i,t){var s=this;if("boolean"==typeof e){i=e;e=!0===i?0:s.slideCount-1}else{e=!0===i?--e:e}if(1>s.slideCount||0>e||e>s.slideCount-1){return!1}s.unload();if(!0===t){s.$slideTrack.children().remove()}else{s.$slideTrack.children(this.options.slide).eq(e).remove()}s.$slides=s.$slideTrack.children(this.options.slide);s.$slideTrack.children(this.options.slide).detach();s.$slideTrack.append(s.$slides);s.$slidesCache=s.$slides;s.reinit()};t.prototype.setCSS=function(e){var i=this,t={},s,o;if(!0===i.options.rtl){e=-e}s="left"==i.positionProp?Math.ceil(e)+"px":"0px";o="top"==i.positionProp?Math.ceil(e)+"px":"0px";t[i.positionProp]=e;if(!1===i.transformsEnabled){i.$slideTrack.css(t)}else{t={};if(!1===i.cssTransitions){t[i.animType]="translate("+s+", "+o+")";i.$slideTrack.css(t)}else{t[i.animType]="translate3d("+s+", "+o+", 0px)";i.$slideTrack.css(t)}}};t.prototype.setDimensions=function(){var e=this;if(!1===e.options.vertical){if(!0===e.options.centerMode){e.$list.css({padding:"0px "+e.options.centerPadding})}}else{e.$list.height(e.$slides.first().outerHeight(!0)*e.options.slidesToShow);if(!0===e.options.centerMode){e.$list.css({padding:e.options.centerPadding+" 0px"})}}e.listWidth=e.$list.width();e.listHeight=e.$list.height();if(!1===e.options.vertical&&!1===e.options.variableWidth){e.slideWidth=Math.ceil(e.listWidth/e.options.slidesToShow);e.$slideTrack.width(Math.ceil(e.slideWidth*e.$slideTrack.children(".slick-slide").length))}else if(!0===e.options.variableWidth){e.$slideTrack.width(5e3*e.slideCount)}else{e.slideWidth=Math.ceil(e.listWidth);e.$slideTrack.height(Math.ceil(e.$slides.first().outerHeight(!0)*e.$slideTrack.children(".slick-slide").length))}var i=e.$slides.first().outerWidth(!0)-e.$slides.first().width();if(!1===e.options.variableWidth)e.$slideTrack.children(".slick-slide").width(e.slideWidth-i)};t.prototype.setFade=function(){var i=this,t;i.$slides.each(function(s,o){t=-1*(i.slideWidth*s);if(!0===i.options.rtl){e(o).css({position:"relative",right:t,top:0,zIndex:i.options.zIndex-2,opacity:0})}else{e(o).css({position:"relative",left:t,top:0,zIndex:i.options.zIndex-2,opacity:0})}});i.$slides.eq(i.currentSlide).css({zIndex:i.options.zIndex-1,opacity:1})};t.prototype.setHeight=function(){var e=this;if(1===e.options.slidesToShow&&!0===e.options.adaptiveHeight&&!1===e.options.vertical){var i=e.$slides.eq(e.currentSlide).outerHeight(!0);e.$list.css("height",i)}};t.prototype.setOption=t.prototype.slickSetOption=function(){var i=this,t,s,o,n,r=!1,d;if("object"===e.type(arguments[0])){o=arguments[0];r=arguments[1];d="multiple"}else if("string"===e.type(arguments[0])){o=arguments[0];n=arguments[1];r=arguments[2];if("responsive"===arguments[0]&&"array"===e.type(arguments[1])){d="responsive"}else if("undefined"!=typeof arguments[1]){d="single"}}if("single"===d){i.options[o]=n}else if("multiple"===d){e.each(o,function(e,t){i.options[e]=t})}else if("responsive"===d){for(s in n){if("array"!==e.type(i.options.responsive)){i.options.responsive=[n[s]]}else{t=i.options.responsive.length-1;while(0<=t){if(i.options.responsive[t].breakpoint===n[s].breakpoint){i.options.responsive.splice(t,1)}t--}i.options.responsive.push(n[s])}}}if(r){i.unload();i.reinit()}};t.prototype.setPosition=function(){var e=this;e.setDimensions();e.setHeight();if(!1===e.options.fade){e.setCSS(e.getLeft(e.currentSlide))}else{e.setFade()}e.$slider.trigger("setPosition",[e])};t.prototype.setProps=function(){var e=this,i=document.body.style;e.positionProp=!0===e.options.vertical?"top":"left";if("top"===e.positionProp){e.$slider.addClass("slick-vertical")}else{e.$slider.removeClass("slick-vertical")}if(i.WebkitTransition!==void 0||i.MozTransition!==void 0||i.msTransition!==void 0){if(!0===e.options.useCSS){e.cssTransitions=!0}}if(e.options.fade){if("number"==typeof e.options.zIndex){if(3>e.options.zIndex){e.options.zIndex=3}}else{e.options.zIndex=e.defaults.zIndex}}if(i.OTransform!==void 0){e.animType="OTransform";e.transformType="-o-transform";e.transitionType="OTransition";if(i.perspectiveProperty===void 0&&i.webkitPerspective===void 0)e.animType=!1}if(i.MozTransform!==void 0){e.animType="MozTransform";e.transformType="-moz-transform";e.transitionType="MozTransition";if(i.perspectiveProperty===void 0&&i.MozPerspective===void 0)e.animType=!1}if(i.webkitTransform!==void 0){e.animType="webkitTransform";e.transformType="-webkit-transform";e.transitionType="webkitTransition";if(i.perspectiveProperty===void 0&&i.webkitPerspective===void 0)e.animType=!1}if(i.msTransform!==void 0){e.animType="msTransform";e.transformType="-ms-transform";e.transitionType="msTransition";if(i.msTransform===void 0)e.animType=!1}if(i.transform!==void 0&&!1!==e.animType){e.animType="transform";e.transformType="transform";e.transitionType="transition"}e.transformsEnabled=e.options.useTransform&&null!==e.animType&&!1!==e.animType};t.prototype.setSlideClasses=function(e){var i=this,t,s,o,n;s=i.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true");i.$slides.eq(e).addClass("slick-current");if(!0===i.options.centerMode){var l=0==i.options.slidesToShow%2?1:0;t=Math.floor(i.options.slidesToShow/2);if(!0===i.options.infinite){if(e>=t&&e<=i.slideCount-1-t){i.$slides.slice(e-t+l,e+t+1).addClass("slick-active").attr("aria-hidden","false")}else{o=i.options.slidesToShow+e;s.slice(o-t+1+l,o+t+2).addClass("slick-active").attr("aria-hidden","false")}if(0===e){s.eq(i.options.slidesToShow+i.slideCount+1).addClass("slick-center")}else if(e===i.slideCount-1){s.eq(i.options.slidesToShow).addClass("slick-center")}}i.$slides.eq(e).addClass("slick-center")}else{if(0<=e&&e<=i.slideCount-i.options.slidesToShow){i.$slides.slice(e,e+i.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false")}else if(s.length<=i.options.slidesToShow){s.addClass("slick-active").attr("aria-hidden","false")}else{n=i.slideCount%i.options.slidesToShow;o=!0===i.options.infinite?i.options.slidesToShow+e:e;if(i.options.slidesToShow==i.options.slidesToScroll&&i.slideCount-e<i.options.slidesToShow){s.slice(o-(i.options.slidesToShow-n),o+n).addClass("slick-active").attr("aria-hidden","false")}else{s.slice(o,o+i.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false")}}}if("ondemand"===i.options.lazyLoad||"anticipated"===i.options.lazyLoad){i.lazyLoad()}};t.prototype.setupInfinite=function(){var t=this,s,o,n;if(!0===t.options.fade){t.options.centerMode=!1}if(!0===t.options.infinite&&!1===t.options.fade){o=null;if(t.slideCount>t.options.slidesToShow){if(!0===t.options.centerMode){n=t.options.slidesToShow+1}else{n=t.options.slidesToShow}for(s=t.slideCount;s>t.slideCount-n;s-=1){o=s-1;e(t.$slides[o]).clone(!0).attr("id","").attr("data-slick-index",o-t.slideCount).prependTo(t.$slideTrack).addClass("slick-cloned")}for(s=0;s<n+t.slideCount;s+=1){o=s;e(t.$slides[o]).clone(!0).attr("id","").attr("data-slick-index",o+t.slideCount).appendTo(t.$slideTrack).addClass("slick-cloned")}t.$slideTrack.find(".slick-cloned").find("[id]").each(function(){e(this).attr("id","")})}}};t.prototype.interrupt=function(e){var i=this;if(!e){i.autoPlay()}i.interrupted=e};t.prototype.selectHandler=function(i){var t=this,s=e(i.target).is(".slick-slide")?e(i.target):e(i.target).parents(".slick-slide"),o=parseInt(s.attr("data-slick-index"));if(!o)o=0;if(t.slideCount<=t.options.slidesToShow){t.slideHandler(o,!1,!0);return}t.slideHandler(o)};t.prototype.slideHandler=function(e,i,t){var s,o,n,l,r=null,d=this,a;i=i||!1;if(!0===d.animating&&!0===d.options.waitForAnimate){return}if(!0===d.options.fade&&d.currentSlide===e){return}if(!1===i){d.asNavFor(e)}s=e;r=d.getLeft(s);l=d.getLeft(d.currentSlide);d.currentLeft=null===d.swipeLeft?l:d.swipeLeft;if(!1===d.options.infinite&&!1===d.options.centerMode&&(0>e||e>d.getDotCount()*d.options.slidesToScroll)){if(!1===d.options.fade){s=d.currentSlide;if(!0!==t&&d.slideCount>d.options.slidesToShow){d.animateSlide(l,function(){d.postSlide(s)})}else{d.postSlide(s)}}return}else if(!1===d.options.infinite&&!0===d.options.centerMode&&(0>e||e>d.slideCount-d.options.slidesToScroll)){if(!1===d.options.fade){s=d.currentSlide;if(!0!==t&&d.slideCount>d.options.slidesToShow){d.animateSlide(l,function(){d.postSlide(s)})}else{d.postSlide(s)}}return}if(d.options.autoplay){clearInterval(d.autoPlayTimer)}if(0>s){if(0!=d.slideCount%d.options.slidesToScroll){o=d.slideCount-d.slideCount%d.options.slidesToScroll}else{o=d.slideCount+s}}else if(s>=d.slideCount){if(0!=d.slideCount%d.options.slidesToScroll){o=0}else{o=s-d.slideCount}}else{o=s}d.animating=!0;d.$slider.trigger("beforeChange",[d,d.currentSlide,o]);n=d.currentSlide;d.currentSlide=o;d.setSlideClasses(d.currentSlide);if(d.options.asNavFor){a=d.getNavTarget();a=a.slick("getSlick");if(a.slideCount<=a.options.slidesToShow){a.setSlideClasses(d.currentSlide)}}d.updateDots();d.updateArrows();if(!0===d.options.fade){if(!0!==t){d.fadeSlideOut(n);d.fadeSlide(o,function(){d.postSlide(o)})}else{d.postSlide(o)}d.animateHeight();return}if(!0!==t&&d.slideCount>d.options.slidesToShow){d.animateSlide(r,function(){d.postSlide(o)})}else{d.postSlide(o)}};t.prototype.startLoad=function(){var e=this;if(!0===e.options.arrows&&e.slideCount>e.options.slidesToShow){e.$prevArrow.hide();e.$nextArrow.hide()}if(!0===e.options.dots&&e.slideCount>e.options.slidesToShow){e.$dots.hide()}e.$slider.addClass("slick-loading")};t.prototype.swipeDirection=function(){var e,i,t,s,o=this;e=o.touchObject.startX-o.touchObject.curX;i=o.touchObject.startY-o.touchObject.curY;t=Math.atan2(i,e);s=Math.round(180*t/Math.PI);if(0>s){s=360-Math.abs(s)}if(45>=s&&0<=s){return!1===o.options.rtl?"left":"right"}if(360>=s&&315<=s){return!1===o.options.rtl?"left":"right"}if(135<=s&&225>=s){return!1===o.options.rtl?"right":"left"}if(!0===o.options.verticalSwiping){if(35<=s&&135>=s){return"down"}else{return"up"}}return"vertical"};t.prototype.swipeEnd=function(){var e=this,i,t;e.dragging=!1;e.swiping=!1;if(e.scrolling){e.scrolling=!1;return!1}e.interrupted=!1;e.shouldClick=10<e.touchObject.swipeLength?!1:!0;if(e.touchObject.curX===void 0){return!1}if(!0===e.touchObject.edgeHit){e.$slider.trigger("edge",[e,e.swipeDirection()])}if(e.touchObject.swipeLength>=e.touchObject.minSwipe){t=e.swipeDirection();switch(t){case"left":case"down":i=e.options.swipeToSlide?e.checkNavigable(e.currentSlide+e.getSlideCount()):e.currentSlide+e.getSlideCount();e.currentDirection=0;break;case"right":case"up":i=e.options.swipeToSlide?e.checkNavigable(e.currentSlide-e.getSlideCount()):e.currentSlide-e.getSlideCount();e.currentDirection=1;break;default:}if("vertical"!=t){e.slideHandler(i);e.touchObject={};e.$slider.trigger("swipe",[e,t])}}else{if(e.touchObject.startX!==e.touchObject.curX){e.slideHandler(e.currentSlide);e.touchObject={}}}};t.prototype.swipeHandler=function(e){var i=this;if(!1===i.options.swipe||"ontouchend"in document&&!1===i.options.swipe){return}else if(!1===i.options.draggable&&-1!==e.type.indexOf("mouse")){return}i.touchObject.fingerCount=e.originalEvent&&e.originalEvent.touches!==void 0?e.originalEvent.touches.length:1;i.touchObject.minSwipe=i.listWidth/i.options.touchThreshold;if(!0===i.options.verticalSwiping){i.touchObject.minSwipe=i.listHeight/i.options.touchThreshold}switch(e.data.action){case"start":i.swipeStart(e);break;case"move":i.swipeMove(e);break;case"end":i.swipeEnd(e);break;}};t.prototype.swipeMove=function(e){var i=this,t,s,o,n,l,r;l=e.originalEvent!==void 0?e.originalEvent.touches:null;if(!i.dragging||i.scrolling||l&&1!==l.length){return!1}t=i.getLeft(i.currentSlide);i.touchObject.curX=l!==void 0?l[0].pageX:e.clientX;i.touchObject.curY=l!==void 0?l[0].pageY:e.clientY;i.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(i.touchObject.curX-i.touchObject.startX,2)));r=Math.round(Math.sqrt(Math.pow(i.touchObject.curY-i.touchObject.startY,2)));if(!i.options.verticalSwiping&&!i.swiping&&4<r){i.scrolling=!0;return!1}if(!0===i.options.verticalSwiping){i.touchObject.swipeLength=r}s=i.swipeDirection();if(e.originalEvent!==void 0&&4<i.touchObject.swipeLength){i.swiping=!0;e.preventDefault()}n=(!1===i.options.rtl?1:-1)*(i.touchObject.curX>i.touchObject.startX?1:-1);if(!0===i.options.verticalSwiping){n=i.touchObject.curY>i.touchObject.startY?1:-1}o=i.touchObject.swipeLength;i.touchObject.edgeHit=!1;if(!1===i.options.infinite){if(0===i.currentSlide&&"right"===s||i.currentSlide>=i.getDotCount()&&"left"===s){o=i.touchObject.swipeLength*i.options.edgeFriction;i.touchObject.edgeHit=!0}}if(!1===i.options.vertical){i.swipeLeft=t+o*n}else{i.swipeLeft=t+o*(i.$list.height()/i.listWidth)*n}if(!0===i.options.verticalSwiping){i.swipeLeft=t+o*n}if(!0===i.options.fade||!1===i.options.touchMove){return!1}if(!0===i.animating){i.swipeLeft=null;return!1}i.setCSS(i.swipeLeft)};t.prototype.swipeStart=function(e){var i=this,t;i.interrupted=!0;if(1!==i.touchObject.fingerCount||i.slideCount<=i.options.slidesToShow){i.touchObject={};return!1}if(e.originalEvent!==void 0&&e.originalEvent.touches!==void 0){t=e.originalEvent.touches[0]}i.touchObject.startX=i.touchObject.curX=t!==void 0?t.pageX:e.clientX;i.touchObject.startY=i.touchObject.curY=t!==void 0?t.pageY:e.clientY;i.dragging=!0};t.prototype.unfilterSlides=t.prototype.slickUnfilter=function(){var e=this;if(null!==e.$slidesCache){e.unload();e.$slideTrack.children(this.options.slide).detach();e.$slidesCache.appendTo(e.$slideTrack);e.reinit()}};t.prototype.unload=function(){var i=this;e(".slick-cloned",i.$slider).remove();if(i.$dots){i.$dots.remove()}if(i.$prevArrow&&i.htmlExpr.test(i.options.prevArrow)){i.$prevArrow.remove()}if(i.$nextArrow&&i.htmlExpr.test(i.options.nextArrow)){i.$nextArrow.remove()}i.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")};t.prototype.unslick=function(e){var i=this;i.$slider.trigger("unslick",[i,e]);i.destroy()};t.prototype.updateArrows=function(){var e=this;Math.floor(e.options.slidesToShow/2);if(!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&!e.options.infinite){e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false");e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false");if(0===e.currentSlide){e.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true");e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")}else if(e.currentSlide>=e.slideCount-e.options.slidesToShow&&!1===e.options.centerMode){e.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true");e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")}else if(e.currentSlide>=e.slideCount-1&&!0===e.options.centerMode){e.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true");e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")}}};t.prototype.updateDots=function(){var e=this;if(null!==e.$dots){e.$dots.find("li").removeClass("slick-active").end();e.$dots.find("li").eq(Math.floor(e.currentSlide/e.options.slidesToScroll)).addClass("slick-active")}};t.prototype.visibility=function(){var e=this;if(e.options.autoplay){if(document[e.hidden]){e.interrupted=!0}else{e.interrupted=!1}}};e.fn.slick=function(){var e=this,s=arguments[0],o=Array.prototype.slice.call(arguments,1),n=e.length,l,r;for(l=0;l<n;l++){if("object"==_typeof(s)||"undefined"==typeof s)e[l].slick=new t(e[l],s);else r=e[l].slick[s].apply(e[l].slick,o);if("undefined"!=typeof r)return r}return e}});
define ("theme_coursemos/strings",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable"],function(a,b,c){return{management:function(d){a("form.form-validate").validate({submitHandler:function submitHandler(b){a(b).find(":disabled").removeAttr("disabled");a.ajax({data:a(b).serialize(),url:d,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});a(".btn-string-add").click(function(){var b=a(this).data("type");a("#modal-family .modal-title .modal-title-changetype").text(M.util.get_string("add","core"));a("#modal-family form").each(function(){this.reset()});a("#modal-family form input[name='"+coursemostype+"']").val("insert");a("#modal-family form input[name='type']").val(b);a("#modal-family").modal("show")});a(".btn-string-update").click(function(){var b=a(this).data("id");a.ajax({data:coursemostype+"=view&id="+b,url:d,success:function success(b){if(b.code==mesg.success){a("#modal-family .modal-title .modal-title-changetype").text(M.util.get_string("edit","core"));a("#modal-family form input[name='"+coursemostype+"']").val("update");coursemosBindElement(a("#modal-family form"),b.result);a.each(b.result.valueJsonDecode,function(b,c){a("#modal-family form [name='lang-"+b+"']").val(c)})}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}});a("#modal-family").modal("show")});a(".btn-string-delete").each(function(){var e=a(this),f=e.data("id"),g=e.closest(".sites"),h=g.find(".site-title").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("family_confirm_delete","theme_coursemos",h)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(c){c.preventDefault();a.ajax({data:coursemostype+"=delete&id="+f,url:d,success:function success(a){if(a.code==mesg.success){g.remove();b.hide()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});var e=a(".family-box .family-sites").sortable({handle:".moveicon",containerPath:".family-sites",containerSelector:".family-sites",onDrop:function onDrop(b,c,f){f(b,c);var g=null,h=c.target.data("type");a.each(a(".family-box .family-sites"),function(b,c){if(h==a(c).data("type")){g=b}});var i=e.sortable("serialize").get();if(i.hasOwnProperty(g)){var j=JSON.stringify(i[g],null," ");a.ajax({data:coursemostype+"=sortorder&type="+h+"&json="+j,url:d,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}}})}}});
define ("theme_coursemos/timer.jquery",["jquery"],function(a){(function(a){var c={};function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};a[d].call(e.exports,e,e.exports,b);e.loaded=!0;return e.exports}b.m=a;b.c=c;b.p="";return b(0)})([function(b,c,d){'use strict';var f=d(1),g=e(f),h=d(2),i=e(h);function e(a){return a&&a.__esModule?a:{default:a}}(function(){a.fn.timer=function(b){b=b||"start";return this.each(function(){if(!(a.data(this,i.default.PLUGIN_NAME)instanceof g.default)){a.data(this,i.default.PLUGIN_NAME,new g.default(this,b))}var c=a.data(this,i.default.PLUGIN_NAME);if("string"==typeof b){if("function"==typeof c[b]){c[b]()}}else{c.start()}})}})()},function(b,c,d){'use strict';Object.defineProperty(c,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}(),h=d(2),i=e(h),j=d(3),k=e(j);function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}var l=function(){function b(c,d){f(this,b);this.element=c;this.originalConfig=a.extend({},d);this.totalSeconds=0;this.intervalId=null;this.html="html";if("INPUT"===c.tagName||"TEXTAREA"===c.tagName){this.html="val"}this.config=k.default.getDefaultConfig();if(d.duration){d.duration=k.default.durationTimeToSeconds(d.duration)}if("string"!=typeof d){this.config=a.extend(this.config,d)}if(this.config.seconds){this.totalSeconds=this.config.seconds}if(this.config.editable){k.default.makeEditable(this)}this.startTime=k.default.unixSeconds()-this.totalSeconds;if(this.config.duration&&this.config.repeat&&1e3>this.config.updateFrequency){this.config.updateFrequency=1e3}if(this.config.countdown){if(!this.config.duration){throw new Error("Countdown option set without duration!")}if(this.config.editable){throw new Error("Cannot set editable on a countdown timer!")}this.config.startTime=k.default.unixSeconds()-this.config.duration;this.totalSeconds=this.config.duration}}g(b,[{key:"start",value:function(){if(this.state!==i.default.TIMER_RUNNING){k.default.setState(this,i.default.TIMER_RUNNING);this.render();this.intervalId=setInterval(k.default.intervalHandler.bind(null,this),this.config.updateFrequency)}}},{key:"pause",value:function(){if(this.state===i.default.TIMER_RUNNING){k.default.setState(this,i.default.TIMER_PAUSED);clearInterval(this.intervalId)}}},{key:"resume",value:function(){if(this.state===i.default.TIMER_PAUSED){k.default.setState(this,i.default.TIMER_RUNNING);if(this.config.countdown){this.startTime=k.default.unixSeconds()-this.config.duration+this.totalSeconds}else{this.startTime=k.default.unixSeconds()-this.totalSeconds}this.intervalId=setInterval(k.default.intervalHandler.bind(null,this),this.config.updateFrequency)}}},{key:"remove",value:function(){clearInterval(this.intervalId);a(this.element).data(i.default.PLUGIN_NAME,null)}},{key:"reset",value:function(){var b=this.element,c=this.originalConfig;this.remove();a(b).timer(c)}},{key:"render",value:function(){if(this.config.format){a(this.element)[this.html](k.default.secondsToFormattedTime(this.totalSeconds,this.config.format))}else{a(this.element)[this.html](k.default.secondsToPrettyTime(this.totalSeconds))}a(this.element).data("seconds",this.totalSeconds);if(this.config.loginSession){if(this.config.loginSessionCallback){this.config.loginSessionCallback()}}}}]);return b}();c.default=l;return c.default},function(a,b){'use strict';Object.defineProperty(b,"__esModule",{value:!0});b.default={PLUGIN_NAME:"timer",TIMER_RUNNING:"running",TIMER_PAUSED:"paused",DAYINSECONDS:86400,THIRTYSIXHUNDRED:3600,SIXTY:60,TEN:10}},function(b,c,d){'use strict';Object.defineProperty(c,"__esModule",{value:!0});var e=d(2),f=function(a){return a&&a.__esModule?a:{default:a}}(e);var g=function(){var a=0>=arguments.length||arguments[0]===void 0?0:arguments[0],b=0,c=0,d=Math.floor(a/f.default.SIXTY),e=d,g=void 0;if(a>=f.default.DAYINSECONDS){b=Math.floor(a/f.default.DAYINSECONDS)}if(a>=f.default.THIRTYSIXHUNDRED){c=Math.floor(a%f.default.DAYINSECONDS/f.default.THIRTYSIXHUNDRED)}if(a>=f.default.SIXTY){e=Math.floor(a%f.default.THIRTYSIXHUNDRED/f.default.SIXTY)}g=a%f.default.SIXTY;return{days:b,hours:c,minutes:e,totalMinutes:d,seconds:g,totalSeconds:a}},h=function(a){a=parseInt(a,10);if(10>a){return"0"+a}return a},i=function(){return Math.round(Date.now()/1e3)},j=function(a){var b=void 0,c=void 0;if(0<a.indexOf("sec")){c=+a.replace(/\ssec/g,"")}else if(0<a.indexOf("min")){a=a.replace(/\smin/g,"");b=a.split(":");c=+(b[0]*f.default.SIXTY)+ +b[1]}else if(a.match(/\d{1,2}:\d{2}:\d{2}:\d{2}/)){b=a.split(":");c=+(b[0]*f.default.DAYINSECONDS)+ +(b[1]*f.default.THIRTYSIXHUNDRED)+ +(b[2]*f.default.SIXTY)+ +b[3]}else if(a.match(/\d{1,2}:\d{2}:\d{2}/)){b=a.split(":");c=+(b[0]*f.default.THIRTYSIXHUNDRED)+ +(b[1]*f.default.SIXTY)+ +b[2]}return c},k=function(b,c){b.state=c;a(b.element).data("state",c)};c.default={getDefaultConfig:function(){return{seconds:0,editable:!1,duration:null,callback:function(){console.log("Time up!")},repeat:!1,countdown:!1,format:null,updateFrequency:500,loginSession:!1,loginSessionCallback:function(){}}},unixSeconds:i,secondsToPrettyTime:function(a){var b=g(a);if(b.days){return b.days+":"+h(b.hours)+":"+h(b.minutes)+":"+h(b.seconds)}if(b.hours){return b.hours+":"+h(b.minutes)+":"+h(b.seconds)}var c="";if(b.minutes){c=b.minutes+":"+h(b.seconds)+" min"}else{c=b.seconds+" sec"}return c},secondsToFormattedTime:function(a,b){var c=g(a),d=[{identifier:"%d",value:c.days},{identifier:"%h",value:c.hours},{identifier:"%m",value:c.minutes},{identifier:"%s",value:c.seconds},{identifier:"%g",value:c.totalMinutes},{identifier:"%t",value:c.totalSeconds},{identifier:"%D",value:h(c.days)},{identifier:"%H",value:h(c.hours)},{identifier:"%M",value:h(c.minutes)},{identifier:"%S",value:h(c.seconds)},{identifier:"%G",value:h(c.totalMinutes)},{identifier:"%T",value:h(c.totalSeconds)}];d.forEach(function(a){b=b.replace(a.identifier,a.value)});return b},durationTimeToSeconds:function(a){if(!a){throw new Error("durationTimeToSeconds expects a string argument!")}if(!isNaN(+a)){return a}a=a.toLowerCase();var b=a.match(/\d{1,2}d/),c=a.match(/\d{1,2}h/),d=a.match(/\d{1,2}m/),e=a.match(/\d{1,2}s/);if(!b&&!c&&!d&&!e){throw new Error("Invalid string passed in durationTimeToSeconds!")}var g=0;if(b){g+=+(b[0].replace("d","")*f.default.DAYINSECONDS)}if(c){g+=+(c[0].replace("h","")*f.default.THIRTYSIXHUNDRED)}if(d){g+=+d[0].replace("m","")*f.default.SIXTY}if(e){g+=+e[0].replace("s","")}return g},prettyTimeToSeconds:j,setState:k,makeEditable:function(b){a(b.element).on("focus",function(){b.pause()});a(b.element).on("blur",function(){b.totalSeconds=j(a(b.element)[b.html]());b.resume()})},intervalHandler:function(b){b.totalSeconds=i()-b.startTime;if(b.config.countdown){b.totalSeconds=b.config.duration-b.totalSeconds;if(0===b.totalSeconds){clearInterval(b.intervalId);k(b,f.default.TIMER_STOPPED);b.config.callback();a(b.element).data("seconds")}b.render();return}b.render();if(!b.config.duration){return}if(0<b.totalSeconds&&0==b.totalSeconds%b.config.duration){if(b.config.callback){b.config.callback()}if(!b.config.repeat){clearInterval(b.intervalId);k(b,f.default.TIMER_STOPPED);b.config.duration=null}}}}}])});
define ("theme_coursemos/univ",["jquery"],function(a){return{init:function(){a("#page-lnb .site-menus .xncommons-cmaker").click(function(){return!0})}}});
define ("local_agreement/agreement",["jquery","core/modal_factory","core/modal_events"],function(a,b,c){var d={pluginname:"local_agreement"};d.index=function(f,g,h,i){a(".local-agreement .btn-agreement").each(function(){var e=a(this),j=e.closest(".card").find("button.btn-link").text(),k=e.closest(".agreement-buttons"),l=k.data("agreementid"),m=a(this).data("status"),n="",o="",p="";if(m==h){n="primary";p=M.util.get_string("agree",d.pluginname)}else if(m==i){n="danger";p=M.util.get_string("not_agree",d.pluginname)}o="<span class=\"text-"+n+"\">"+p+"</span>";b.create({type:b.types.SAVE_CANCEL,title:j,body:M.util.get_string("confirm_agree",d.pluginname,o)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-"+n).text(p);b.getRoot().on(c.save,function(c){c.preventDefault();var d=coursemostype+"=userAgree&status="+m+"&agreementid="+l+"&courseid="+f;showSubmitProgress();a.ajax({url:g,data:d,success:function success(c){hideSubmitProgress();if(c.code==mesg.success){b.hide();if(""!=c.redirect){location.replace(c.redirect)}else{k.html(c.html);var d=k.closest(".accordion");d.find(".card-header .btn-link").addClass("collapsed");d.find(".card-body").removeClass("show");if(0<c.nextid){var e=a("#accordion-"+c.nextid).offset();a("html").animate({scrollTop:e.top},400)}}}else{alert(c.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})})};return d});
define ("local_agreement/asiteAgreement",["jquery","core/modal_factory","core/modal_events","theme_coursemos/jquery.filedownload"],function(a,b,c){var d={pluginname:"local_agreement"};d.index=function(f){a(".asite-agreement .form-result .btn-delete").each(function(){var e=a(this),g=e.closest("tr"),h=g.data("id"),i=g.data("name");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_delete",d.pluginname,i)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({url:f,data:coursemostype+"=delete&id="+h,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})});a(".asite-agreement .form-result .btn-visible").each(function(){var e=a(this),g=e.closest("tr"),h=g.data("id"),i=g.data("name"),j,k,l,m=1;if("1"==e.data("visible")){j="visible_n";k="confirm_visible_n";l="btn-danger";m=0}else{j="visible_y";k="confirm_visible_y";l="btn-info"}b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string(j,d.pluginname),body:M.util.get_string(k,d.pluginname,i)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass(l).text(M.util.get_string(j,d.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({url:f,data:coursemostype+"=visible&id="+h+"&visible="+m,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})})};d.modlAgreement=function(b,c,d,e,f,g){showSubmitProgress();var h=coursemostype+"=agreementLists&courseid="+e+"&year="+c+"&semester="+d+"&isdeletemode="+f+"&checkmode="+g;a.ajax({url:b,data:h,success:function success(b){hideSubmitProgress();if(b.code==mesg.success){a(".modal-agreement-lists .modal-body .table tbody").empty().append(b.html);a(".modal-agreement-lists").modal("show")}else{alert(b.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})};d.courses=function(b,c,e){a(".asite-agreement .btn-select-agreement").click(function(){var f=a(this).data("courseid");d.modlAgreement(b,c,e,f,0,0)});a(document).on("click",".modal-agreement-lists .modal-body .table tbody .btn-select",function(){if(!a(this).is(":disabled")){var c=a(this),d=c.closest("tr"),e=d.data("agreementid"),f=d.data("courseid");showSubmitProgress();a.ajax({url:b,data:coursemostype+"=selectAgreement&courseid="+f+"&agreementid="+e,success:function success(b){hideSubmitProgress();if(b.code==mesg.success){c.removeClass("btn-select").addClass("btn-select-cancel").removeClass("btn-primary").addClass("btn-danger").text(M.util.get_string("delete","core")).blur();var d="<span class=\"badge badge-info badge-agreement-"+e+"\">"+b.agreementName+"</span>";a(".table-course-agreements tr.course-"+f+" .td-agreement").append(a(d))}else{alert(b.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}});a(document).on("click",".modal-agreement-lists .modal-body .table tbody .btn-select-cancel",function(){if(!a(this).is(":disabled")){var c=a(this),d=c.closest("tr"),e=d.data("agreementid"),f=d.data("courseid");showSubmitProgress();a.ajax({url:b,data:coursemostype+"=cancelAgreement&courseid="+f+"&agreementid="+e,success:function success(b){hideSubmitProgress();if(b.code==mesg.success){c.removeClass("btn-select-cancel").addClass("btn-select").removeClass("btn-danger").addClass("btn-primary").text(M.util.get_string("select","core")).blur();a(".table-course-agreements tr.course-"+f+" .td-agreement .badge-agreement-"+e).remove()}else{alert(b.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}});a(".asite-agreement .table-course-agreements .allchecked").click(function(){var b=a(this).is(":checked");a(".asite-agreement .table-course-agreements input:checkbox.chk_course").each(function(){if(!a(this).is(":disabled")){this.checked=b}})});a(".asite-agreement .form-agreement .btn-check-add").click(function(){if(d.minCheck()){d.modlAgreement(b,c,e,0,0,1)}else{alert(M.util.get_string("min_check","local_ubion",1))}});a(".asite-agreement .form-agreement .btn-check-delete").click(function(){if(d.minCheck()){d.modlAgreement(b,c,e,0,1,1)}else{alert(M.util.get_string("min_check","local_ubion",1))}});a(document).on("click",".modal-agreement-lists .modal-body .table tbody .btn-select-check",function(){d.checkAction(a(this),"selectAgreementCheck")});a(document).on("click",".modal-agreement-lists .modal-body .table tbody .btn-select-cancel-check",function(){d.checkAction(a(this),"cancelAgreementCheck")})};d.minCheck=function(){var b=a(".asite-agreement .table-course-agreements input:checkbox.chk_course:checked");if(0<b.length){return!0}else{return!1}};d.checkAction=function(b,c){if(!b.is(":disabled")){var d=b.closest("tr"),e=d.data("agreementid");a(".asite-agreement .form-agreement input[name=\""+coursemostype+"\"]").val(c);a(".asite-agreement .form-agreement input[name=\"agreementid\"]").val(e);showSubmitProgress();a.ajax({url:a(".asite-agreement .form-agreement").attr("action"),data:a(".asite-agreement .form-agreement").serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}};d.report=function(b){a(".asite-agreement .table-course-agreements .btn-count").click(function(){var c=a(this).data("type"),d=a(this).data("agreementid"),e=a(this).data("courseid");showSubmitProgress();a.ajax({url:b,data:coursemostype+"=counts&agreementid="+d+"&courseid="+e+"&type="+c,success:function success(b){hideSubmitProgress();if(b.code==mesg.success){a(".modal-agreement-users .modal-title").text(b.title);a(".modal-agreement-users .modal-body tbody").empty().html(b.html);a(".modal-agreement-users").modal("show")}else{alert(b.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});a(".asite-agreement .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})};d.alertMessage=function(a,b){var c="";if(0===a.status){c="Not connect.\n Verify Network."}else if(404==a.status){c="Requested page not found. [404]"}else if(500==a.status){c="Internal Server Error [500]."}else if("parsererror"===b){c="Requested JSON parse failed."}else if("timeout"===b){c="Time out error."}else if("abort"===b){c="Ajax request aborted."}else{c="Uncaught Error.\n"+a.responseText}alert(c)};return d});
define ("local_ubassessment/category",["jquery","core/modal_factory","core/modal_events","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable"],function(a,b,c){var d={pluginname:"local_ubassessment"};d.index=function(){var e=a(".local-ubassessment-category .modal-form"),f=e.find(".form-validate"),g=f.find("input[name=\""+coursemostype+"\"]");a(".local-ubassessment-category .btn-add").click(function(){e.find("form").each(function(){this.reset()});e.find(".modal-title").text(M.util.get_string("category_add",d.pluginname));g.val("insert");e.modal("show")});a(".local-ubassessment-category .btn-modify").click(function(){var b=a(this).closest("tr").data("id");a.ajax({url:a(f).attr("action"),data:coursemostype+"=view&id="+b,success:function success(a){if(a.code==mesg.success){e.find(".modal-title").text(a.title);g.val("update");f.find("input[name=\"id\"]").val(b);f.find("input[name=\"name\"]").val(a.name);f.find("input[name=\"name_eng\"]").val(a.nameEng);e.modal("show")}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});a(".local-ubassessment-category .btn-delete").each(function(){var e=a(this),g=e.closest("tr"),h=g.data("id"),i=g.find(".category-name-main").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("category_delete",d.pluginname,i),body:M.util.get_string("confirm_delete",d.pluginname,i)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:a(f).attr("action"),data:coursemostype+"=delete&id="+h,success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})});f.validate({submitHandler:function submitHandler(b){showSubmitProgress();a.ajax({url:a(b).attr("action"),data:a(b).serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}});var h=a(".local-ubassessment-category .table-coursemos-sortable");h.sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",placeholder:"<tr class=\"placeholder\"/>",handle:".cursor-move",onDrop:function onDrop(b,c,d){d(b,c);var e=c.el.find("> tbody"),g=parseInt(e.data("startnumber"));e.find("tr").each(function(){a(this).find("td.td-number").text(g);g++});var i=h.sortable("serialize").get(),j=JSON.stringify(i,null," ");a.ajax({data:coursemostype+"=sortorder&json="+j,url:a(f).attr("action"),success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}});a(".local-ubassessment-category .btn-check-delete").click(function(){var f=a(".local-ubassessment-category .form-table"),g=a(".local-ubassessment-category .target-category:checked").length;if(0<g){var h=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_category_delete_multi",d.pluginname,g)},h).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:f.attr("action"),data:f.serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});h.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}})};return d});
define ("local_ubassessment/course",["jquery","core/modal_factory","core/modal_events","local_ubassessment/template","local_ubassessment/item","local_ubassessment/result","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable"],function(a,b,c,d,e,f){var g={pluginname:"local_ubassessment",isItemImport:!1};g.index=function(h,i){a(".local-ubassessment-course .btn-preview").click(function(){var b=a(this).closest("tr").data("id");d.preview(b,a(this).data("lang"),h)});var j="confirm_course_delete_multi",k="confirm_delete";if(a(".local-ubassessment-course").hasClass("local-ubassessment-evaluation")){j="confirm_allcourse_delete_multi";k="confirm_allcourse_delete"}a(".local-ubassessment-course .btn-delete").each(function(){var d=a(this),e=d.closest("tr"),f=e.data("id"),i=e.find(".survey-name-main").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("survey_delete",g.pluginname,i),body:M.util.get_string(k,g.pluginname,i)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:h,data:coursemostype+"=delete&id="+f,success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})});a(".local-ubassessment .btn-check-delete").click(function(){var d=a(".local-ubassessment .form-table"),e=a(".local-ubassessment .target-ids:checked").length;if(0<e){var f=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string(j,g.pluginname,e)},f).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:h,data:d.serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});f.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}});a(".local-ubassessment-course .btn-detail").click(function(){var b=a(this).closest("tr").data("id");f.modalResult(b,i,h)});a(".local-ubassessment-course .btn-participants").click(function(){var b=a(this).closest("tr").data("id"),c=a(this).data("type");f.participants(b,i,c,h)})};g.edit=function(b){a(".local-ubassessment-course .form-validate").validate({submitHandler:function submitHandler(b){var c=a(b.timeopen).val(),d=a(b.timeclose).val();if(c>d){alert(M.util.get_string("survey_period_check",g.pluginname,c));return!1}return!0}});var c=a(".local-ubassessment-course select[name=\"templateid\"]");c.change(function(){if(""!=a(this).val()){a(".local-ubassessment-course .btn-preview").removeClass("d-none")}else{a(".local-ubassessment-course .btn-preview").addClass("d-none")}});a(".local-ubassessment-course .btn-preview").click(function(){var e=c.val();d.preview(e,a(this).data("lang"),b)})};g.item=function(f,h,i){e.action=i;a(".local-ubassessment-course-item .btn-item-add").click(function(){var b=a(this).data("itemtype");e.formNew(b,0,0,f)});a(".local-ubassessment-course-item .btn-edit").click(function(){var b=a(this).closest("tr").data("id");e.formUpdate(b,0,0,f)});a(".local-ubassessment-course-item .btn-item-import").click(function(){a.ajax({url:i,data:coursemostype+"=itemImportForm&assessmentid="+f,success:function success(a){if(a.code==mesg.success){d.itemImport({assessmentid:f},a,i)}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});a(".local-ubassessment-course-item .btn-delete").each(function(){var d=a(this),e=d.closest("tr"),f=e.data("id"),h=e.find(".item-name-main"),j=h.text(),k=h.html();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("item_delete",g.pluginname,j),body:M.util.get_string("confirm_delete",g.pluginname,k)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:i,data:coursemostype+"=delete&id="+f,success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})});a(".local-ubassessment-course-item .btn-check-delete").click(function(){var d=a(".local-ubassessment-course-item .form-table"),e=a(".local-ubassessment-course-item .target-item:checked").length;if(0<e){var f=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_item_delete_multi",g.pluginname,e)},f).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:i,data:d.serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});f.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}});a(".local-ubassessment-course-item .btn-preview").click(function(){d.preview(f,a(this).data("lang"),h)});var j=a(".local-ubassessment-course-item .table-coursemos-sortable");j.sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",handle:".cursor-move",placeholder:"<tr class=\"placeholder\"/>",onDrop:function onDrop(b,c,d){d(b,c);var e=c.el.find("> tbody"),f=parseInt(e.data("startnumber"));e.find("tr").each(function(){a(this).find("td.td-number").text(f);f++});var g=j.sortable("serialize").get(),h=JSON.stringify(g,null," ");a.ajax({data:coursemostype+"=sortorder&json="+h,url:i,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}});a(".local-ubassessment-course-item .btn-item-referral").click(function(){g.referralModal(f,h,"","","",1)})};g.referralModal=function(b,c,d,e,f,h){var i=coursemostype+"=referral&assessmentid="+b;if(""!=d){i+="&type="+d}if(""!=e){i+="&keyfield="+e}if(""!=f){i+="&keyword="+f}if(""!=h){i+="&page="+h}g.showSearchProgress();a.ajax({url:c,data:i,success:function success(a){hideSubmitProgress();if(a.code==mesg.success){g.referralModalSetting(b,a.html,c)}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})};g.showSearchProgress=function(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("search_message","local_ubion"))};g.showSubmitProgress=function(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("loading","theme_coursemos"))};g.referralModalSetting=function(f,h,i){var j=a(".local-ubassessment-course-item .modal-referral");j.find(".modal-html").html(h);j.on("hidden.bs.modal",function(a){a.preventDefault();if(g.isItemImport){location.reload()}});var k=j.find(".form-search");k.submit(function(){g.showSearchProgress();a.ajax({url:i,data:d.serializeString({},a(this)),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){g.referralModalSetting(f,a.html,i)}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}});return!1});j.find("input[name=\"type\"]").change(function(){g.referralModal(f,i,a(this).val(),"","",1)});k.find(".btn-search-cancel").click(function(){g.referralModal(f,i,j.find("input[name=\"type\"]:checked").val(),"","",1)});j.find(".form-result .pagination .page-link").click(function(){var b=a(this).data("pagenum");k.find("input[name='page']").val(b);k.trigger("submit");return!1});var l=j.find(".form-referral-table"),m=l.find("input[name=\"ids[]\"]");l.find("thead input.all-checked").click(function(){var b=a(this).is(":checked");m.each(function(){if(!a(this).is(":disabled")){this.checked=b}})});var n=l.find("input[name=\"type\"]").val();l.find(".btn-preview").click(function(){var b=a(this).closest("tr");g.showSearchProgress();a.ajax({url:i,data:coursemostype+"=referralPreview&type="+n+"&id="+b.data("id"),success:function success(b){hideSubmitProgress();if(b.code==mesg.success){var c=a(".local-ubassessment .modal-preview");c.find(".modal-title").text(b.title);c.find(".container-fluid").html(b.html);c.modal("show");c.find(".modal-body").scrollTop(0)}else{alert(b.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});l.find(".btn-item-all-import").each(function(){var d=a(this),f=d.closest("tr"),e=f.find(".name-main").html();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("template_import",g.pluginname),body:M.util.get_string("confirm_referral_template_import",g.pluginname,e)},d).done(function(b){b.setSaveButtonText(M.util.get_string("template_import",g.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();g.showSubmitProgress();a.ajax({url:i,data:l.serialize()+"&id="+f.data("id"),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){if(""!=a.errorMessage){alert(a.errorMessage)}location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})});l.find(".btn-item-view").click(function(){var e=a(this).closest("tr"),h=e.data("id");g.showSearchProgress();a.ajax({url:i,data:coursemostype+"=itemView&type="+n+"&assessmentid="+f+"&id="+h,success:function success(e){hideSubmitProgress();if(e.code==mesg.success){var h=a(".local-ubassessment .modal-referral-item");h.find(".modal-title").text(e.title);h.find(".modal-html").html(e.html);var j=h.find(".form-referral-item"),k=h.find("tbody input[name=\"ids[]\"]");h.find("thead input.all-checked").click(function(){var b=a(this).is(":checked");k.each(function(){if(!a(this).is(":disabled")){this.checked=b}})});h.find("tfoot .btn-check-import").click(function(){var e=k.filter(":checked"),l=e.length;if(0<l){var m="<ul class=\"ml-4\">";e.each(function(){m+="<li>"+a(this).closest("tr").find(".name-main").html()+"</li>"});m+="</ul>";var n=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("template_import",g.pluginname),body:M.util.get_string("confirm_template_import",g.pluginname,{cnt:l,lists:m})},n).done(function(b){b.setSaveButtonText(M.util.get_string("template_import",g.pluginname));b.getRoot().on(c.save,function(c){c.preventDefault();g.showSubmitProgress();a.ajax({url:i,data:d.serializeString({assessmentid:f},j),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){g.isItemImport=!0;if(""!=a.errorMessage){alert(a.errorMessage)}b.hide();g.importCompleteModal(h)}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});n.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}});h.modal("show")}else{alert(e.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});j.modal("show")};g.importCompleteModal=function(d){var e=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("template_import_complete",g.pluginname),body:M.util.get_string("confirm_referral_import_complete",g.pluginname)},e).done(function(b){b.setSaveButtonText(M.util.get_string("template_import_further",g.pluginname));a(b.footer).find("[data-action=\"cancel\"]").text(M.util.get_string("close","local_ubion"));b.getRoot().on(c.save,function(a){a.preventDefault();d.modal("hide");b.hide()});b.getRoot().on(c.cancel,function(){location.reload()})});e.trigger("click")};g.statistics=function(b){a(".local-ubassessment-statistics .btn-preview").click(function(){var c=a(this).closest("tr").data("id");d.preview(c,a(this).data("lang"),b)});a(".local-ubassessment-statistics .btn-detail").click(function(){var c=a(this).closest("tr").data("id"),d=a(this).data("courseid");f.modalResult(c,d,b)});a(".local-ubassessment-statistics .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})};return g});
define ("local_ubassessment/form",["jquery","core/templates","theme_coursemos/printThis","theme_coursemos/jquery.validate"],function(a,b){var c={pluginname:"local_ubassessment",allChecked:function(b,c){a(".local-ubassessment "+b).click(function(){var b=a(this).is(":checked");a(".local-ubassessment "+c).each(function(){if(!a(this).is(":disabled")){this.checked=b}})})}};c.searchAllChecked=function(b,d,e){var f=a(".local-ubassessment input[type='checkbox'][name^='"+b+"']"),g=a(".local-ubassessment input[type='checkbox'][name='"+b+"']:first");c.searchAllCheckeTypes(f,g.is(":checked"),d,e);f.click(function(){var b=!0;if(a(this).val()==d){b=a(this).is(":checked");f.prop("checked",b)}else{f.each(function(c,e){if(a(e).val()!=d&&b&&!a(e).prop("checked")){b=!1}});g.prop("checked",b)}c.searchAllCheckeTypes(f,b,d,e)})};c.searchAllCheckeTypes=function(b,c,d,e){if(e){if(c){b.each(function(b,c){if(a(c).val()!=d){a(c).prop("checked","checked")}})}else{b.each(function(b,c){a(c).prop("disabled",!1)})}}};c.print=function(b,c,d){a(b).click(function(){a(c).printThis({loadCSS:d,printDelay:700})})};c.respond=function(c){var d=a("."+c);d.validate({submitHandler:function submitHandler(){showSubmitProgress();return!0}});d.find(".itemtype-choice .form-check-input").change(function(){var c=a(this).closest(".form-element");if(0==c.find(".btn-check-reset").length){b.render("local_ubassessment/item/choice_reset",{}).then(function(a){if(0==c.find(".btn-check-reset").length){c.append(a)}return!0}).fail(function(){return!1})}var d=c.find(".form-control-answer");if(0<d.length){if(0<c.find(".form-check-input-answer:checked").length){d.removeClass("d-none").removeAttr("disabled")}else{d.addClass("d-none").attr("disabled","disabled")}}if(0==c.find(".form-check-input:checked").length){c.find(".btn-check-reset").remove()}});a(document).on("click",".itemtype-choice .btn-check-reset",function(){a(this).closest(".form-element").find(".form-check-input").prop("checked",!1);a(this).closest(".form-element").find(".form-control-answer").addClass("d-none").attr("disabled","disabled");a(this).remove()})};return c});
define ("local_ubassessment/item",["jquery","core/modal_factory","core/modal_events","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable","theme_coursemos/bootstrap-select"],function(a,b,c){var d={action:"",modal:a(".modal-form"),modalForm:a(".modal-form .form-validate"),modalValidate:null,pluginname:"local_ubassessment"};d.index=function(f){d.action=f;var g=a(".local-ubassessment-item .form-search select[name=\"categoryid\"]");a(".local-ubassessment-item .btn-item-add").click(function(){var b=g.val(),c=a(this).data("itemtype");d.formNew(c,b,0,0)});a(".local-ubassessment-item .btn-edit").click(function(){var b=a(this).closest("tr").data("id");d.formUpdate(b,0,0,0)});a(".local-ubassessment-item .btn-delete").each(function(){var e=a(this),f=e.closest("tr"),g=f.data("id"),h=f.find(".item-name-main"),i=h.text(),j=h.html();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("item_delete",d.pluginname,i),body:M.util.get_string("confirm_delete",d.pluginname,j)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:d.action,data:coursemostype+"=delete&id="+g,success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})});a(".local-ubassessment-item .btn-check-delete").click(function(){var g=a(".local-ubassessment-item .form-table"),h=a(".local-ubassessment-item .target-item:checked").length;if(0<h){var i=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_item_delete_multi",d.pluginname,h)},i).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:f,data:g.serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){if(""!=a.errorMessage){alert(a.errorMessage)}location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});i.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}});if(""!=g.val()){var h=a(".local-ubassessment-item .table-coursemos-sortable");h.sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",handle:".cursor-move",placeholder:"<tr class=\"placeholder\"/>",onDrop:function onDrop(b,c,e){e(b,c);var f=c.el.find("> tbody"),g=parseInt(f.data("startnumber"));f.find("tr").each(function(){a(this).find("td.td-number").text(g);g++});var i=h.sortable("serialize").get(),j=JSON.stringify(i,null," ");a.ajax({data:coursemostype+"=sortorder&json="+j,url:d.action,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}})}};d.adminIndex=function(f){d.action=f;a(".local-ubassessment-choice .btn-add").click(function(){d.formNew(a(this).data("type"),0,0)});a(".local-ubassessment-choice .btn-edit").click(function(){var b=a(this).closest("tr").data("id");d.formUpdate(b,0,0)});a(".local-ubassessment-choice .btn-delete").each(function(){var e=a(this),f=e.closest("tr"),g=f.data("id"),h=f.find(".choice-name-main").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("item_delete",d.pluginname,h),body:M.util.get_string("confirm_delete",d.pluginname,h)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:d.action,data:coursemostype+"=delete&id="+g,success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})});var g=a(".local-ubassessment-choice .table-coursemos-sortable");g.sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",handle:".cursor-move",placeholder:"<tr class=\"placeholder\"/>",onDrop:function onDrop(b,c,e){e(b,c);var f=c.el.find("> tbody"),h=parseInt(f.data("startnumber"));f.find("tr").each(function(){a(this).find("td.td-number").text(h);h++});var i=g.sortable("serialize").get(),j=JSON.stringify(i,null," ");a.ajax({data:coursemostype+"=sortorder&json="+j,url:d.action,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}});a(".local-ubassessment-choice .btn-check-delete").click(function(){var g=a(".local-ubassessment-choice .form-table"),h=a(".local-ubassessment-choice .target-choice:checked").length;if(0<h){var i=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_item_delete_multi",d.pluginname,h)},i).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:f,data:g.serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){if(""!=a.errorMessage){alert(a.errorMessage)}location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});i.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}})};d.validate=function(b){d.modalValidate=b.validate({submitHandler:function submitHandler(b){showSubmitProgress();a.ajax({url:a(b).attr("action"),data:a(b).serialize(),success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"))}});return!1}})};d.formNew=function(b,c,e,f){var g="";if(0<c){g="&categoryid="+c}if(0<e){g="&templateid="+e}if(0<f){g="&assessmentid="+f}a.ajax({url:d.action,data:coursemostype+"=getForm&type="+b+g,success:function success(a){if(a.code==mesg.success){d.modalFormSetting(a.title,a.html);d.modal.modal("show")}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})};d.formUpdate=function(b,c,e,f){var g="";if(0<c){g="&categoryid="+c}if(0<e){g="&templateid="+e}if(0<f){g="&assessmentid="+f}a.ajax({url:d.action,data:coursemostype+"=getForm&id="+b+g,success:function success(a){if(a.code==mesg.success){d.modalFormSetting(a.title,a.html);d.modal.modal("show")}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})};d.modalFormTable=function(){return d.modalForm.find(".table-choice")};d.modalFormSetting=function(b,c){d.modal.find(".modal-title").text(b);d.modalForm.html(c);d.modalForm.find("select[name=\"categoryid\"]").selectpicker({style:"btn-default"});var e=d.modalForm.find("select[name=\"scale\"]"),f=d.modalForm.find("select[name=\"isanswer\"]");e.change(function(){var b=null,c=a(this).val();d.modalFormTable().find("tbody tr").each(function(){b=parseInt(a(this).data("index"));if(b>c){if(!a(this).hasClass("hidden")){a(this).addClass("hidden")}}else{a(this).removeClass("hidden")}});d.buttonRowDelete(f)});d.buttonRowDelete(f);a(document).on("click",".modal-form .btn-row-delete",function(){var a=parseInt(e.val());d.modalFormTable().find("tr[data-index=\""+a+"\"]").addClass("hidden");a-=1;e.val(a);d.buttonRowDelete(f)});var g=d.modalForm.find("select[name=\"mincheck\"]"),h=d.modalForm.find("select[name=\"maxcheck\"]");d.modalForm.find("input[name=\"ismulticheck\"]").change(function(){var b=a(this).val();if("1"==b){g.removeAttr("disabled");h.removeAttr("disabled")}else{g.attr("disabled","disabled");h.attr("disabled","disabled")}});if(null!==d.modalValidate){d.modalValidate.destroy()}d.modalForm.find("select[name=\"isanswer\"]").change(function(){d.scoreDiabled(a(this))});var i=a(".modal-choice");d.modalForm.find(".btn-choice-import").click(function(){a.ajax({url:d.action,data:coursemostype+"=choiceImportLists",success:function success(a){if(a.code==mesg.success){i.find(".table-choice tbody").empty().append(a.html);i.modal("show")}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});a(document).on("click",".modal-choice .btn-import-select",function(){a.ajax({url:d.action,data:coursemostype+"=setChoiceImport&id="+a(this).data("id"),success:function success(a){if(a.code==mesg.success){var b=d.modalForm.find("select[name=\"isanswer\"]"),c=b.val(),f=e.val();d.modalFormTable().html(a.html);if(f!=a.count){e.val(a.count);e.trigger("change")}if(c!=a.isanswer){b.val(a.isanswer);b.trigger("change")}i.modal("hide")}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});d.validate(d.modalForm)};d.buttonRowDelete=function(a){var b=d.modalFormTable();b.find(".btn-row-delete").addClass("hidden");var c=b.find("tr:not(.hidden):last").data("index");b.find("tr[data-index=\""+c+"\"] .btn-row-delete").removeClass("hidden");if(a!==void 0){d.scoreDiabled(a)}};d.scoreDiabled=function(a){if(a!==void 0){var b=d.modalFormTable();b.find(".form-control-score").removeAttr("disabled","disabled");if("1"==a.val()){var c=b.find("tr:not(.hidden):last").data("index");b.find("tr[data-index=\""+c+"\"] .form-control-score").attr("disabled","disabled")}}};return d});
define ("local_ubassessment/result",["jquery","local_ubassessment/form","local_ubassessment/template","theme_coursemos/printThis","theme_coursemos/jquery.filedownload"],function(a,b,c){var d={pluginname:"local_ubassessment"};d.index=function(b,c){a(".local-ubassessment-result .btn-detail").click(function(){var e=a(this).closest("tr").data("courseid");d.modalResult(b,e,c)});a(".local-ubassessment-result .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})};d.modalResult=function(c,d,e){a.ajax({url:e,data:coursemostype+"=respondStatistics&id="+c+"&courseid="+d,success:function success(c){if(c.code==mesg.success){a(".local-ubassessment .modal-result-detail .modal-body-content").html(c.html);a(".local-ubassessment .modal-result-detail .modal-title").text(c.title);a(".local-ubassessment .modal-result-detail").modal("show");b.print(".local-ubassessment .modal-result-detail .btn-print",".local-ubassessment .modal-result-detail .local-ubassessment-result-detail",M.cfg.wwwroot+"/local/ubion/Asite/modules/assessment/course/print.css");a(".local-ubassessment .modal-result-detail .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})}else{alert(c.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})};d.participants=function(b,c,e,f){a.ajax({url:f,data:coursemostype+"=participants&id="+b+"&courseid="+c+"&type="+e,success:function success(a){if(a.code==mesg.success){d.participantModal({id:b,courseid:c,type:e},a,f)}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})};d.participantModal=function(b,e,f){var g=a(".local-ubassessment .modal-participants");g.find(".modal-title").text(e.title);g.find(".modal-html").html(e.html);var h=g.find(".form-search");h.submit(function(){a.ajax({url:f,data:c.serializeString(b,a(this)),success:function success(a){if(a.code==mesg.success){d.participantModal(b,a,f)}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}});return!1});h.find(".btn-search-cancel").click(function(){h.find("input[name=\"keyword\"]").val("");h.trigger("submit");return!1});g.find(".form-result .pagination .page-link").click(function(){var b=a(this).data("pagenum");h.find("input[name='page']").val(b);h.trigger("submit");return!1});g.find(".btn-participant-detail").click(function(){var b=a(this).data("id");a.ajax({url:f,data:coursemostype+"=participantView&id="+b,success:function success(b){if(b.code==mesg.success){var c=a(".local-ubassessment .modal-participant-view");c.find(".modal-title").text(b.title);c.find(".modal-html").html(b.html);c.modal("show");c.find(".modal-body").scrollTop(0)}else{alert(b.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});g.modal("show");g.find(".modal-body").scrollTop(0)};return d});
define ("local_ubassessment/site",["jquery","core/modal_factory","core/modal_events","local_ubassessment/template","local_ubassessment/item","local_ubassessment/result","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable"],function(a,b,c,d,e,f){var g={pluginname:"local_ubassessment"};g.index=function(h,i){a(".local-ubassessment-site .btn-preview").click(function(){var b=a(this).closest("tr").data("id");d.preview(b,a(this).data("lang"),h)});a(".local-ubassessment-site .btn-delete").each(function(){var d=a(this),e=d.closest("tr"),f=e.data("id"),i=e.find(".survey-name-main").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("survey_delete",g.pluginname,i),body:M.util.get_string("confirm_delete",g.pluginname,i)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:h,data:coursemostype+"=delete&id="+f,success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})});a(".local-ubassessment .btn-check-delete").click(function(){var d=a(".local-ubassessment .form-table"),e=a(".local-ubassessment .target-ids:checked").length;if(0<e){var f=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_course_delete_multi",g.pluginname,e)},f).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:h,data:d.serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});f.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}});a(".local-ubassessment-site .btn-detail").click(function(){var b=a(this).closest("tr").data("id");f.modalResult(b,i,h)});a(".local-ubassessment-site .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})};g.edit=function(b){a(".local-ubassessment-site .form-validate").validate({submitHandler:function submitHandler(b){var c=a(b.timeopen).val(),d=a(b.timeclose).val();if(c>d){alert(M.util.get_string("survey_period_check",g.pluginname,c));return!1}return!0}});var c=a(".local-ubassessment-site select[name=\"templateid\"]");c.change(function(){if(""!=a(this).val()){a(".local-ubassessment-site .btn-preview").removeClass("d-none")}else{a(".local-ubassessment-site .btn-preview").addClass("d-none")}});a(".local-ubassessment-site .btn-preview").click(function(){var e=c.val();d.preview(e,a(this).data("lang"),b)})};return g});
define ("local_ubassessment/template",["jquery","core/modal_factory","core/modal_events","local_ubassessment/item","local_ubassessment/form","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable","theme_coursemos/bootstrap-select"],function(a,b,c,d,e){var f={pluginname:"local_ubassessment"};f.index=function(d){var e=a(".local-ubassessment-template .modal-form"),g=e.find(".form-validate"),h=g.find("input[name=\""+coursemostype+"\"]");a(".local-ubassessment-template .btn-add").click(function(){e.find("form").each(function(){this.reset()});e.find(".modal-title").text(M.util.get_string("template_add",f.pluginname));h.val("insert");e.modal("show")});a(".local-ubassessment-template .btn-edit").click(function(){var b=a(this).closest("tr").data("id");a.ajax({url:a(g).attr("action"),data:coursemostype+"=view&id="+b,success:function success(a){if(a.code==mesg.success){e.find(".modal-title").text(a.title);h.val("update");g.find("input[name=\"id\"]").val(b);g.find("input[name=\"name\"]").val(a.name);g.find("input[name=\"name_eng\"]").val(a.nameEng);e.modal("show")}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});a(".local-ubassessment-template .btn-delete").each(function(){var d=a(this),e=d.closest("tr"),h=e.data("id"),i=e.find(".template-name-main").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("item_delete",f.pluginname,i),body:M.util.get_string("confirm_delete",f.pluginname,i)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:a(g).attr("action"),data:coursemostype+"=delete&id="+h,success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})});g.validate({submitHandler:function submitHandler(b){showSubmitProgress();a.ajax({url:a(b).attr("action"),data:a(b).serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}});var i=a(".local-ubassessment-template .table-coursemos-sortable");i.sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",placeholder:"<tr class=\"placeholder\"/>",handle:".cursor-move",onDrop:function onDrop(b,c,d){d(b,c);var e=c.el.find("> tbody"),f=parseInt(e.data("startnumber"));e.find("tr").each(function(){a(this).find("td.td-number").text(f);f++});var h=i.sortable("serialize").get(),j=JSON.stringify(h,null," ");a.ajax({data:coursemostype+"=sortorder&json="+j,url:a(g).attr("action"),success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}});a(".local-ubassessment-template .btn-check-delete").click(function(){var d=a(".local-ubassessment-template .form-table"),e=a(".local-ubassessment-template .target-template:checked").length;if(0<e){var g=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_template_delete_multi",f.pluginname,e)},g).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:d.attr("action"),data:d.serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});g.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}});a(".local-ubassessment .btn-preview").click(function(){var b=a(this).closest("tr").data("id"),c=a(this).data("lang");f.preview(b,c,d)})};f.item=function(g){d.action=g;var h=a(".local-ubassessment-template-item .form-table input[name=\"templateid\"]").val();a(".local-ubassessment-template-item .btn-item-add").click(function(){var b=a(this).data("itemtype");d.formNew(b,0,h,0)});a(".local-ubassessment-template-item .btn-edit").click(function(){var b=a(this).closest("tr").data("id");d.formUpdate(b,0,h,0)});a(".local-ubassessment-template-item .btn-delete").each(function(){var d=a(this),e=d.closest("tr"),h=e.data("id"),i=e.find(".item-name-main"),j=i.text(),k=i.html();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("item_delete",f.pluginname,j),body:M.util.get_string("confirm_delete",f.pluginname,k)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:g,data:coursemostype+"=delete&id="+h,success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})});var i=a(".local-ubassessment-template-item .table-coursemos-sortable");i.sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",handle:".cursor-move",placeholder:"<tr class=\"placeholder\"/>",onDrop:function onDrop(b,c,d){d(b,c);var e=c.el.find("> tbody"),f=parseInt(e.data("startnumber"));e.find("tr").each(function(){a(this).find("td.td-number").text(f);f++});var h=i.sortable("serialize").get(),j=JSON.stringify(h,null," ");a.ajax({data:coursemostype+"=sortorder&json="+j,url:g,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}});a(".local-ubassessment-template-item .btn-check-delete").click(function(){var d=a(".local-ubassessment-template-item .form-table"),e=a(".local-ubassessment-template-item .target-item:checked").length;if(0<e){var g=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_item_delete_multi",f.pluginname,e)},g).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:d.attr("action"),data:d.serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){if(""!=a.errorMessage){alert(a.errorMessage)}location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});g.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}});a(".local-ubassessment-template-item .btn-item-import").click(function(){var b=a(this).data("templateid");a.ajax({url:g,data:coursemostype+"=itemImportForm&templateid="+b,success:function success(a){if(a.code==mesg.success){f.itemImport({templateid:b},a,g)}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});a(".local-ubassessment-template-item .btn-preview").click(function(){var b=a(this).data("id"),c=a(this).data("lang");f.preview(b,c,g)})};f.itemImport=function(d,e,g){var h=a(".local-ubassessment .modal-item-import");h.find(".modal-html").html(e.html);h.find(".modal-html").find("select[name=\"categoryid\"]").selectpicker({style:"btn-default",container:"body"});var i=h.find(".form-search");i.submit(function(){a.ajax({url:g,data:f.serializeString(d,a(this)),success:function success(a){if(a.code==mesg.success){f.itemImport(d,a,g)}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}});return!1});i.find(".btn-search-cancel").click(function(){i.find("input:not([type=hidden]):not([type=submit]), select").val("");i.trigger("submit");return!1});h.find(".form-result .pagination .page-link").click(function(){var b=a(this).data("pagenum");i.find("input[name='page']").val(b);i.trigger("submit");return!1});a(".local-ubassessment .modal-item-import .all-checked").click(function(){var b=a(this).is(":checked");a(".local-ubassessment .modal-item-import .target-item").each(function(){if(!a(this).is(":disabled")){this.checked=b}})});var j=a(".local-ubassessment .form-template-item-table");a(".local-ubassessment .btn-check-import").click(function(){var e=j.find(".target-item:checked"),h=e.length;if(0<h){var i="<ul class=\"ml-4\">";e.each(function(){i+="<li>"+a(this).closest("tr").find(".item-name-main").html()+"</li>"});i+="</ul>";var k=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("template_import",f.pluginname),body:M.util.get_string("confirm_template_import",f.pluginname,{cnt:h,lists:i})},k).done(function(b){b.setSaveButtonText(M.util.get_string("template_import",f.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:g,data:f.serializeString(d,j),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){if(""!=a.errorMessage){alert(a.errorMessage)}location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});k.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}});h.modal("show");h.find(".modal-body").scrollTop(0)};f.serializeAndDecode=function(b){return a.map(b.serializeArray(),function(a){return[a.name,decodeURIComponent(a.value)].join("=")}).join("&")};f.serializeString=function(b,c){var d=f.serializeAndDecode(c),e="",g="";a.each(b,function(a,b){e+=g+a+"="+b;g="&"});if(""!=d){var h="";if(""!=e){h="&"}e+=h+d}return e};f.preview=function(b,c,d){var f=a(".local-ubassessment .modal-preview");a.ajax({url:d,data:coursemostype+"=preview&id="+b+"&lang="+c,success:function success(a){if(a.code==mesg.success){f.find(".modal-title").text(a.title);f.find(".container-fluid").html(a.html);f.modal("show");f.find(".modal-body").scrollTop(0);e.respond("form-respond")}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})};return f});
define ("local_ubassistant/assistant",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap"],function(a,b,c){var d={pluginname:"local_ubassistant",index:function(){a(".local_ubassistant .form-control-autosubmit").change(function(){a(".local_ubassistant .form-search").submit()})}};d.history=function(f){a(".modal-modify").modal({show:!1});a(".btn-modify").click(function(){var b=a(this).data("id"),c=a(this).data("courseid"),d={courseid:c,id:b};d[coursemostype]="view";a.ajax({data:d,url:f,success:function success(d){if(d.code==mesg.success){a(".modal-modify input[name='id']").val(b);a(".modal-modify input[name='courseid']").val(c);a(".modal-modify input[name='user_phone']").val(d.phone);a(".modal-modify").modal("show")}else{alert(d.msg)}}});return!1});a(".btn-delete").each(function(){var g=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete",d.pluginname),body:M.util.get_string("confirm_delete_subscribe",d.pluginname)},g).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete",d.pluginname));b.getRoot().on(c.save,function(a){a.preventDefault();var b=g.data("id"),c={id:b};c[coursemostype]="delete";formSubmit(f,c)})})})};d.regist=function(e,f){a(".modal-modify").modal({show:!1});a(".btn-modify").click(function(){var b=a(this).data("id"),c={courseid:e,id:b};c[coursemostype]="view";a.ajax({data:c,url:f,success:function success(c){if(c.code==mesg.success){a(".modal-modify input[name='id']").val(b);a(".modal-modify input[name='user_phone']").val(c.phone);a(".modal-modify").modal("show")}else{alert(c.msg)}}});return!1});var g=a(".btn-delete");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete",d.pluginname),body:M.util.get_string("confirm_delete_subscribe",d.pluginname)},g).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete",d.pluginname));b.getRoot().on(c.save,function(a){a.preventDefault();var b=g.data("id"),c={id:b};c[coursemostype]="delete";formSubmit(f,c)})})};d.approve=function(f,g,h,i,j){a(".local_ubassistant .btn-approve").each(function(){var g=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("approval_manage",d.pluginname),body:M.util.get_string("confirm_approval",d.pluginname)},g).done(function(a){a.setSaveButtonText(M.util.get_string("approval",d.pluginname));a.getRoot().on(c.save,function(a){a.preventDefault();var b=g.data("id"),c=g.data("courseid"),d={id:b,courseid:c,isbatch:h};d[coursemostype]="approve";formSubmit(f,d)})})});a(".local_ubassistant .btn-approve-cancel").each(function(){var g=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("approval_manage",d.pluginname),body:M.util.get_string("confirm_approval_cancel",d.pluginname)},g).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("approval_cancel",d.pluginname));b.getRoot().on(c.save,function(a){a.preventDefault();var b=g.data("id"),c=g.data("courseid"),d={id:b,courseid:c,isbatch:h};d[coursemostype]="approveCancel";formSubmit(f,d)})})});a(".local_ubassistant .btn-delete").each(function(){var k=a(this),l=k.data("type"),m="confirm_delete",n=1,o="delete";if("approveDeleteCancel"==l){m="confirm_delete_cancel";n=0;o="delete_cancel"}b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string(o,d.pluginname),body:M.util.get_string(m,d.pluginname)},k).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string(o,d.pluginname));b.getRoot().on(c.save,function(a){a.preventDefault();var b=k.data("id"),c=k.data("courseid"),d={id:b,courseid:c,type:n,isdeletenoview:g,isbatch:h,year:i,semester:j};d[coursemostype]="approveDelete";formSubmit(f,d)})})})};d.open=function(){a("#open_year, #open_semester").change(function(){a("#open_form").submit()})};d.irregular=function(){a("#irregular_year").change(function(){a("#irregular_form").submit()})};return d});
function _typeof2(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof2=function(a){return typeof a}}else{_typeof2=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof2(a)}(function(a,b){if("object"===("undefined"==typeof exports?"undefined":_typeof2(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof2(module)))module.exports=b();else if("function"==typeof define&&define.amd)define ("local_ubeclass/clipboard",[],b);else if("object"===("undefined"==typeof exports?"undefined":_typeof2(exports)))exports.ClipboardJS=b();else a.ClipboardJS=b()})(this,function(){return function(a){var c={};function b(d){if(c[d]){return c[d].exports}var e=c[d]={i:d,l:!1,exports:{}};a[d].call(e.exports,e,e.exports,b);e.l=!0;return e.exports}b.m=a;b.c=c;b.i=function(a){return a};b.d=function(a,c,d){if(!b.o(a,c)){Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})}};b.n=function(a){var c=a&&a.__esModule?function(){return a["default"]}:function(){return a};b.d(c,"a",c);return c};b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};b.p="";return b(b.s=3)}([function(a,b,c){var d,e,f;(function(g,h){!(e=[a,c(7)],d=h,f="function"==typeof d?d.apply(b,e):d,void 0!==f&&(a.exports=f))})(this,function(a,b){'use strict';var d=function(a){return a&&a.__esModule?a:{default:a}}(b);var e="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(a){return _typeof2(a)}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":_typeof2(a)};function c(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}var f=function(){function a(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}(),g=function(){function a(b){c(this,a);this.resolveOptions(b);this.initSelection()}f(a,[{key:"resolveOptions",value:function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};this.action=a.action;this.container=a.container;this.emitter=a.emitter;this.target=a.target;this.text=a.text;this.trigger=a.trigger;this.selectedText=""}},{key:"initSelection",value:function(){if(this.text){this.selectFake()}else if(this.target){this.selectTarget()}}},{key:"selectFake",value:function(){var a=this,b="rtl"==document.documentElement.getAttribute("dir");this.removeFake();this.fakeHandlerCallback=function(){return a.removeFake()};this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0;this.fakeElem=document.createElement("textarea");this.fakeElem.style.fontSize="12pt";this.fakeElem.style.border="0";this.fakeElem.style.padding="0";this.fakeElem.style.margin="0";this.fakeElem.style.position="absolute";this.fakeElem.style[b?"right":"left"]="-9999px";var c=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=c+"px";this.fakeElem.setAttribute("readonly","");this.fakeElem.value=this.text;this.container.appendChild(this.fakeElem);this.selectedText=(0,d.default)(this.fakeElem);this.copyText()}},{key:"removeFake",value:function(){if(this.fakeHandler){this.container.removeEventListener("click",this.fakeHandlerCallback);this.fakeHandler=null;this.fakeHandlerCallback=null}if(this.fakeElem){this.container.removeChild(this.fakeElem);this.fakeElem=null}}},{key:"selectTarget",value:function(){this.selectedText=(0,d.default)(this.target);this.copyText()}},{key:"copyText",value:function(){var a;try{a=document.execCommand(this.action)}catch(b){a=!1}this.handleResult(a)}},{key:"handleResult",value:function(a){this.emitter.emit(a?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){if(this.trigger){this.trigger.focus()}window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"copy";this._action=a;if("copy"!==this._action&&"cut"!==this._action){throw new Error("Invalid \"action\" value, use either \"copy\" or \"cut\"")}},get:function(){return this._action}},{key:"target",set:function(a){if(a!==void 0){if(a&&"object"===("undefined"==typeof a?"undefined":e(a))&&1===a.nodeType){if("copy"===this.action&&a.hasAttribute("disabled")){throw new Error("Invalid \"target\" attribute. Please use \"readonly\" instead of \"disabled\" attribute")}if("cut"===this.action&&(a.hasAttribute("readonly")||a.hasAttribute("disabled"))){throw new Error("Invalid \"target\" attribute. You can't cut text from elements with \"readonly\" or \"disabled\" attributes")}this._target=a}else{throw new Error("Invalid \"target\" value, use a valid Element")}}},get:function(){return this._target}}]);return a}();a.exports=g})},function(a,b,c){var g=c(6),h=c(5);function d(a,b,c){a.addEventListener(b,c);return{destroy:function destroy(){a.removeEventListener(b,c)}}}function e(a,b,c){Array.prototype.forEach.call(a,function(a){a.addEventListener(b,c)});return{destroy:function destroy(){Array.prototype.forEach.call(a,function(a){a.removeEventListener(b,c)})}}}function f(a,b,c){return h(document.body,a,b,c)}a.exports=function(a,b,c){if(!a&&!b&&!c){throw new Error("Missing required arguments")}if(!g.string(b)){throw new TypeError("Second argument must be a String")}if(!g.fn(c)){throw new TypeError("Third argument must be a Function")}if(g.node(a)){return d(a,b,c)}else if(g.nodeList(a)){return e(a,b,c)}else if(g.string(a)){return f(a,b,c)}else{throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}}},function(a){function b(){}b.prototype={on:function on(a,b,c){var d=this.e||(this.e={});(d[a]||(d[a]=[])).push({fn:b,ctx:c});return this},once:function once(a,b,c){var e=this;function d(){e.off(a,d);b.apply(c,arguments)}d._=b;return this.on(a,d,c)},emit:function emit(a){var b=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),d=0,e=c.length;for(d;d<e;d++){c[d].fn.apply(c[d].ctx,b)}return this},off:function off(a,b){var c=this.e||(this.e={}),d=c[a],e=[];if(d&&b){for(var f=0,g=d.length;f<g;f++){if(d[f].fn!==b&&d[f].fn._!==b)e.push(d[f])}}e.length?c[a]=e:delete c[a];return this}};a.exports=b},function(a,b,c){var d,e,f;(function(g,h){!(e=[a,c(0),c(2),c(1)],d=h,f="function"==typeof d?d.apply(b,e):d,void 0!==f&&(a.exports=f))})(this,function(a,b,c,d){'use strict';var j=e(b),k=e(c),l=e(d);function e(a){return a&&a.__esModule?a:{default:a}}var m="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(a){return _typeof2(a)}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":_typeof2(a)};function f(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}var n=function(){function a(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function g(a,b){if(!a){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return b&&("object"===_typeof2(b)||"function"==typeof b)?b:a}function h(a,b){if("function"!=typeof b&&null!==b){throw new TypeError("Super expression must either be null or a function, not "+_typeof2(b))}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}var o=function(a){h(b,a);function b(a,c){f(this,b);var d=g(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.resolveOptions(c);d.listenClick(a);return d}n(b,[{key:"resolveOptions",value:function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};this.action="function"==typeof a.action?a.action:this.defaultAction;this.target="function"==typeof a.target?a.target:this.defaultTarget;this.text="function"==typeof a.text?a.text:this.defaultText;this.container="object"===m(a.container)?a.container:document.body}},{key:"listenClick",value:function(a){var b=this;this.listener=(0,l.default)(a,"click",function(a){return b.onClick(a)})}},{key:"onClick",value:function(a){var b=a.delegateTarget||a.currentTarget;if(this.clipboardAction){this.clipboardAction=null}this.clipboardAction=new j.default({action:this.action(b),target:this.target(b),text:this.text(b),container:this.container,trigger:b,emitter:this})}},{key:"defaultAction",value:function(a){return i("action",a)}},{key:"defaultTarget",value:function(a){var b=i("target",a);if(b){return document.querySelector(b)}}},{key:"defaultText",value:function(a){return i("text",a)}},{key:"destroy",value:function(){this.listener.destroy();if(this.clipboardAction){this.clipboardAction.destroy();this.clipboardAction=null}}}],[{key:"isSupported",value:function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:["copy","cut"],b="string"==typeof a?[a]:a,c=!!document.queryCommandSupported;b.forEach(function(a){c=c&&!!document.queryCommandSupported(a)});return c}}]);return b}(k.default);function i(a,b){var c="data-clipboard-"+a;if(!b.hasAttribute(c)){return}return b.getAttribute(c)}a.exports=o})},function(a){if("undefined"!=typeof Element&&!Element.prototype.matches){var b=Element.prototype;b.matches=b.matchesSelector||b.mozMatchesSelector||b.msMatchesSelector||b.oMatchesSelector||b.webkitMatchesSelector}a.exports=function(a,b){while(a&&a.nodeType!==9){if("function"==typeof a.matches&&a.matches(b)){return a}a=a.parentNode}}},function(a,b,c){var f=c(4);function d(a,b,c,d,f){var g=e.apply(this,arguments);a.addEventListener(c,g,f);return{destroy:function destroy(){a.removeEventListener(c,g,f)}}}function e(a,b,c,d){return function(c){c.delegateTarget=f(c.target,b);if(c.delegateTarget){d.call(a,c)}}}a.exports=function(a,b,c,e,f){if("function"==typeof a.addEventListener){return d.apply(null,arguments)}if("function"==typeof c){return d.bind(null,document).apply(null,arguments)}if("string"==typeof a){a=document.querySelectorAll(a)}return Array.prototype.map.call(a,function(a){return d(a,b,c,e,f)})}},function(a,b){b.node=function(a){return a!==void 0&&a instanceof HTMLElement&&1===a.nodeType};b.nodeList=function(a){var c=Object.prototype.toString.call(a);return a!==void 0&&("[object NodeList]"===c||"[object HTMLCollection]"===c)&&"length"in a&&(0===a.length||b.node(a[0]))};b.string=function(a){return"string"==typeof a||a instanceof String};b.fn=function(a){var b=Object.prototype.toString.call(a);return"[object Function]"===b}},function(a){a.exports=function(a){var b;if("SELECT"===a.nodeName){a.focus();b=a.value}else if("INPUT"===a.nodeName||"TEXTAREA"===a.nodeName){var c=a.hasAttribute("readonly");if(!c){a.setAttribute("readonly","")}a.select();a.setSelectionRange(0,a.value.length);if(!c){a.removeAttribute("readonly")}b=a.value}else{if(a.hasAttribute("contenteditable")){a.focus()}var d=window.getSelection(),e=document.createRange();e.selectNodeContents(a);d.removeAllRanges();d.addRange(e);b=d.toString()}return b}}])});
define ("local_ubeclass/eclass",["jquery","core/modal_factory","core/modal_events","local_ubeclass/clipboard","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable"],function(a,b,c,d){var e={pluginname:"local_ubeclass"};e.index=function(){a(".ubeclass .form-search .form-control-autosubmit").change(function(){a(".ubeclass .form-search").submit()});a(".ubeclass .btn-enrol-course").each(function(){var d=a(this),f=d.closest("tr").find(".coursename").text(),g=a(".ubeclass .form-enrol");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("btn_request",e.pluginname),body:M.util.get_string("confirm_enrol",e.pluginname,f)},d).done(function(b){b.setSaveButtonText(M.util.get_string("btn_request",e.pluginname));b.getRoot().on(c.save,function(b){g.find("input[name='id']").val(d.data("id"));b.preventDefault();a.ajax({url:g.attr("action"),data:g.serialize(),success:function success(){location.reload()},error:function error(a,b,c){alert(a.status+" : "+c)}})})})})};e.request=function(b){a("#id_public").change(function(){a(".ubeclass input[type='radio'][name='approve']").removeAttr("checked");if(0==a(this).val()){a("#id_approve_0").attr("disabled","disabled");a("#id_approve_2").prop("checked",!0)}else{a("#id_approve_0").removeAttr("disabled");if(b){a("#id_approve_"+b).prop("checked",!0)}else{a("#id_approve_0").prop("checked",!0)}}});a(".ubeclass .btn-clipboard").tooltip();a(".ubeclass .btn-clipboard").on("hide.bs.tooltip",function(){a(this).attr("data-original-title","Copy")});var c=new d(".ubeclass .btn-clipboard");c.on("success",function(b){b.clearSelection();var c=a(b.trigger).attr("aria-describedby");a("#"+c+" .tooltip-inner").text("Copied")})};e.my=function(){a(".ubeclass .btn-course-delete").each(function(){var d=a(this),f=d.closest("tr").find(".coursename").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_delete",e.pluginname,f)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a(".ubeclass .delete_form input[name='"+coursemostype+"']").val("delete");a(".ubeclass .delete_form input[name='id']").val(d.data("id"));a(".ubeclass .delete_form").submit();showSubmitProgress()})})});a(".ubeclass .btn-enrol-delete").each(function(){var d=a(this),f=d.closest("tr").find(".coursename").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("btn_request_cancel",e.pluginname),body:M.util.get_string("confirm_enrol_apply_cancel",e.pluginname,f)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("btn_request_cancel",e.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();a(".ubeclass .delete_form input[name='"+coursemostype+"']").val("enrolCancel");a(".ubeclass .delete_form input[name='id']").val(d.data("id"));a(".ubeclass .delete_form").submit();showSubmitProgress()})})});a(".ubeclass .btn-enrol-cancel").each(function(){var d=a(this),f=d.closest("tr").find(".coursename").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("btn_cancel",e.pluginname),body:M.util.get_string("confirm_enrol_cancel",e.pluginname,f)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("btn_cancel",e.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();a(".ubeclass .delete_form input[name='"+coursemostype+"']").val("enrolCancel");a(".ubeclass .delete_form input[name='id']").val(d.data("id"));a(".ubeclass .delete_form").submit();showSubmitProgress()})})});a(".ubeclass .btn-clipboard").tooltip();a(".ubeclass .btn-clipboard").on("hide.bs.tooltip",function(){a(this).attr("data-original-title","Copy")});var f=new d(".ubeclass .btn-clipboard");f.on("success",function(b){b.clearSelection();var c=a(b.trigger).attr("aria-describedby");a("#"+c+" .tooltip-inner").text("Copied")})};e.approve=function(){a(".ubeclass .form-search .form-control-autosubmit").change(function(){a(".ubeclass .form-search").submit()});a(".ubeclass .btn-approval").each(function(){var d=a(this),f="approval",g=d.data("type"),h="confirm_approval",i="approval",j=!1;if("unenrol"==g){f="approval_cancel";h="confirm_approval_cancel";i="approvalCancel";j=!0}b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string(f,e.pluginname),body:M.util.get_string(h,e.pluginname)},d).done(function(b){var g=a(b.footer).find("[data-action=\"save\"]");g.text(M.util.get_string(f,e.pluginname));if(j){g.addClass("btn-danger")}b.getRoot().on(c.save,function(b){b.preventDefault();a(".ubeclass .form-enrol input[name='"+coursemostype+"']").val(i);a(".ubeclass .form-enrol input[name='id']").val(d.data("id"));a(".ubeclass .form-enrol").submit();showSubmitProgress()})})});a(".ubeclass .btn-user-batch").click(function(){a("#batch-modal").modal("show")});a(".form-validate").validate({submitHandler:function submitHandler(b){a("#batch-modal .btn-submit").attr("disabled","disabled");b.submit()}})};e.apply=function(){var d=a(".ubeclass .form-eclass"),f=d.find(".form-control-coursename").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("btn_apply",e.pluginname),body:M.util.get_string("confirm_enrol",e.pluginname,f)},a(".ubeclass .btn-apply")).done(function(b){a(b.footer).find("[data-action=\"save\"]").text(M.util.get_string("btn_apply",e.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({url:d.attr("action"),data:d.serialize(),success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})});b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("btn_cancel",e.pluginname),body:M.util.get_string("confirm_enrol_apply_cancel",e.pluginname,f)},a(".ubeclass .btn-apply-cancel")).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("btn_cancel",e.pluginname));b.getRoot().on(c.save,function(a){a.preventDefault();d.submit()})})};e.admin=function(){a(".ubeclass .form-search .form-control-autosubmit").change(function(){a(".ubeclass .form-search").submit()});a(".ubeclass .btn-delete").each(function(){var d=a(this),f=d.closest("tr").find(".td-coursename").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_delete",e.pluginname,f)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a("#hidden-form input[name='id']").val(d.data("id"));a("#hidden-form input[name='"+coursemostype+"']").val("delete");a("#hidden-form").submit()})})});a(".ubeclass .btn-open").each(function(){var d=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("open_yn",e.pluginname),body:M.util.get_string("confirm_open",e.pluginname)},d).done(function(b){b.setSaveButtonText(M.util.get_string("open_y",e.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();d.attr("disabled","disabled");a("#hidden-form input[name='id']").val(d.data("id"));a("#hidden-form input[name='"+coursemostype+"']").val("open");a("#hidden-form").submit()})})});a(".ubeclass .btn-open-cancel").each(function(){var d=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("open_yn",e.pluginname),body:M.util.get_string("confirm_open_cancel",e.pluginname)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("open_cancel",e.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();d.attr("disabled","disabled");a("#hidden-form input[name='id']").val(d.data("id"));a("#hidden-form input[name='"+coursemostype+"']").val("openCancel");a("#hidden-form").submit()})})});a(".ubeclass .btn-batch").click(function(){a("#batch-modal").modal();a("#batch-modal input[name='id']").val(a(this).attr("data-courseid"))});a(".ubeclass .form-batch").validate()};return e});
define ("local_ubencourage/encourage",["jquery","core/modal_factory","core/modal_events"],function(a,b,c){var d={action:M.cfg.wwwroot+"/local/ubencourage/action.php"};d.index=function(f,g){a(".local-ubencourage select[name=\"cmid\"]").change(function(){a(this).closest("form").submit()});if(0<g){b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("encourage_excution","local_ubencourage"),body:M.util.get_string("encourage_excution_confirm","local_ubencourage")},a(".local-ubencourage  .btn-encourage:not(\".disabled\")")).done(function(b){b.setSaveButtonText(M.util.get_string("encourage_excution","local_ubencourage"));b.getRoot().on(c.save,function(c){c.preventDefault();showSubmitProgress();a.ajax({url:d.action,data:coursemostype+"=moduleEncourage&id="+f+"&cmid="+g,success:function success(a){hideSubmitProgress();if(a.code==mesg.success){b.hide();location.href=a.href}else{alert(a.msg);location.reload()}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})}a(".local-ubencourage input.all-checked").click(function(){var b=a(this).is(":checked");a(".local-ubencourage input:checkbox.userids").each(function(){if(!a(this).is(":disabled")){this.checked=b}})});var h=a(".local-ubencourage .sendForm-form");h.submit(function(){var b=a(".local-ubencourage input:checkbox.userids:checked");if(0<b.length){var c=h.find("select[name=\"sendtype\"]").val();h.attr("action",c);b.each(function(){a(this).clone().attr("type","hidden").appendTo(h)});return!0}else{alert(M.util.get_string("min_user","local_ubion"));return!1}})};d.log=function(b){a(".local-ubencourage .form-control-autosubmit").change(function(){a(this).closest("form").submit()});a(".local-ubencourage .btn-user-lists").click(function(){var c=a(this).data("id");showSubmitProgress();a.ajax({url:d.action,data:coursemostype+"=userLists&id="+b+"&eid="+c,success:function success(b){hideSubmitProgress();if(b.code==mesg.success){var c=a(".local-ubencourage .modal-user-lists");c.find(".tbody").html(b.html);c.find(".modal-title").html(b.title);c.modal("show")}else{alert(b.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})};return d});
define ("local_ubion/asiteAuth",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a,b,c){return{index:function(d){a(".asite-auth .form-search").validate();a(".asite-auth .btn-delete").each(function(){var e=a(this),f=e.closest("tr").data("id"),g=e.closest("tr").data("groupname"),h=e.closest("tr").data("fullname");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("adminauth_confirm_user","local_ubion",{groupname:g,fullname:h})},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=delete&id="+f,url:d,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})})},write:function(){a(".asite-auth .table-auth-users .form-control-user-all").click(function(){var b=a(this).is(":checked");a(".asite-auth .table-auth-users input[name='users[]']").prop("checked",b)});a(".asite-auth .form-search").validate();a(".asite-auth .form-auth-users").validate({submitHandler:function submitHandler(b){var c=a(".asite-auth .table-auth-users input[name='users[]']:checked").length;if(0<c){b.submit()}else{alert(M.util.get_string("min_user","local_ubion"))}return!1}})},group:function(d){a(".asite-auth .btn-delete").each(function(){var e=a(this),f=e.closest("tr").data("id"),g=e.closest("tr").data("name");b.create({type:b.types.SAVE_CANCEL,title:g,body:M.util.get_string("adminauth_confirm_group","local_ubion",g)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(c){c.preventDefault();a.ajax({data:coursemostype+"=groupDelete&id="+f,url:d,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg);b.hide()}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})})},groupWrite:function(){a(".asite-auth .form-groups").validate({submitHandler:function submitHandler(a){a.submit()}});a(".asite-auth input[name='auth[]']").change(function(){var b=a(this).is(":checked"),c=a(this).closest("tr"),d=c.data("parent");if(d===void 0){a(".asite-auth .form-groups tr[data-parent='"+c.data("parentid")+"'] input[name='auth[]']").prop("checked",b)}else{var e=a(".asite-auth .form-groups .tr-"+d).find("input[name='auth[]']");if(!e.is(":checked")){e.prop("checked",!0)}if(!b){if(0==a(".asite-auth .form-groups tr[data-parent='"+d+"'] input[name='auth[]']:checked").length){a(".asite-auth .form-groups .tr-"+d).find("input[name='auth[]']").prop("checked",!1)}}}})}}});
define ("local_ubion/asiteBackground",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable"],function(a,b,c){return{index:function(d){a(".asite-course-background .btn-delete").each(function(){var e=a(this),f=e.closest("tr").data("id"),g=M.util.get_string("delete","core");b.create({type:b.types.SAVE_CANCEL,title:g,body:M.util.get_string("course_background_confirm_delete","local_ubion")},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=delete&id="+f,url:d,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});a(".asite-course-background .table-coursemos-sortable").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",handle:".cursor-move",placeholder:"<tr class=\"placeholder\"/>",onDrop:function onDrop(b,c,e){e(b,c);var f=a(".asite-course-background .table-coursemos-sortable").sortable("serialize").get(),g=JSON.stringify(f,null," ");a.ajax({data:coursemostype+"=sortorder&json="+g,url:d,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}})}}});
define ("local_ubion/asiteClassify",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable"],function(a,b,c){return{index:function(d){a(".form-search .form-control-coursetype").change(function(){a(".form-search").submit()});a(".btn-add-classify").click(function(){a("#modal-classify .modal-title").text(M.util.get_string("classify_add","local_ubion"));a("#modal-classify form input[name='"+coursemostype+"']").val("insert");a("#modal-classify .form-modal-classify").each(function(){this.reset()});a("#modal-classify form select[name='course_type']").removeAttr("disabled");a("#modal-classify").modal("show")});a(".btn-update").click(function(){var b=a(this).closest("tr").data("id");a.ajax({data:coursemostype+"=view&id="+b,url:d,success:function success(b){if(b.code==mesg.success){a("#modal-classify .modal-title").text(M.util.get_string("classify_edit","local_ubion"));a("#modal-classify form input[name='"+coursemostype+"']").val("update");coursemosBindElement(a("#modal-classify form"),b.result);a("#modal-classify form select[name='course_type']").attr("disabled","disabled");a.each(b.result.valueJsonDecode,function(b,c){a("#modal-classify form [name='lang-"+b+"']").val(c)})}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}});a("#modal-classify").modal("show")});a(".btn-delete").each(function(){var e=a(this),f=e.closest("tr"),g=f.data("id"),h=f.find(".classify-name").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("classify_delete_confirm","local_ubion",h)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=delete&id="+g,url:d,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});a(".all_checked").click(function(){var b=a(this).is(":checked");a(".asite-site-classify .form-control-clsf").not(":disabled").prop("checked",b)});a(".btn-checked-delete").click(function(){var d=a(".asite-site-classify .form-control-clsf:checked").length;if(0<d){var e=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("classify_delete_confirm_multiple","local_ubion",d)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a(".asite-site-classify .form-classify").submit()})});e.trigger("click")}else{alert(M.util.get_string("classify_no_checked","local_ubion"))}return!1});var e=a(".form-classify .table-classify").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",handle:".moveicon",placeholder:"<tr class=\"placeholder\"/>",onDrop:function onDrop(b,c,f){f(b,c);var g=e.sortable("serialize").get(0),h=JSON.stringify(g);a.ajax({data:coursemostype+"=sortorder&json="+h,url:d,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});a(".form-modal-classify").validate()}}});
define ("local_ubion/asiteContents",["jquery","core/modal_factory","core/modal_events","theme_coursemos/jquery.validate"],function(a,b,c){var d={};d.init=function(b){a(".asite-contents .form-result .all-checked").click(function(){var b=a(this).is(":checked");a(".asite-contents .form-result input[name='ids[]']").each(function(){if(!a(this).is(":disabled")){this.checked=b}})});a(".asite-contents .btn-userchange").click(function(){var b=a(this).closest("tr").data("id");d.userChangeModal(b,!1)});a(".asite-contents .btn-check-userchange").click(function(){var b=a(this).closest("form").find("input[name='ids[]']:checked").map(function(){return a(this).val()}).toArray(),c=d.checkCount();if(0<c){d.userChangeModal(b,!0)}else{alert(M.util.get_string("min_check","local_ubion",1))}});var c=a(".asite-contents .form-control-institution"),e=a(".asite-contents .form-control-department");if(c.val()==b){e.prop("disabled",!0)}else{e.prop("disabled",!1)}c.change(function(){var c=a(this).closest("form").attr("action"),d=a(this).val();e.find("option").remove();e.append("<option value=\""+b+"\">All</option>");if(d!=b){e.prop("disabled",!1);a.ajax({data:coursemostype+"=departments&institution="+d,url:c,success:function success(b){if(b.code==mesg.success){a.each(b.depts,function(a,b){e.append("<option value=\""+b.dept_code+"\">"+b.department+"</option>")})}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}else{e.prop("disabled",!0)}});a(".asite-contents .btn-user-share").click(function(){var b=a(this).closest("tr").data("id");d.userShareModal(b,!1)});a(".asite-contents .btn-check-user-share").click(function(){var b=a(this).closest("form").find("input[name='ids[]']:checked").map(function(){return a(this).val()}).toArray(),c=d.checkCount();if(0<c){d.userShareModal(b,!0)}else{alert(M.util.get_string("min_check","local_ubion",1))}})};d.checkCount=function(){return a(".asite-contents .form-result input[name='ids[]']:checked").length};d.userChangeModal=function(f,g){a(".asite-contents #modal-userchange form").each(function(){this.reset();a(".asite-contents #modal-userchange .form-result").addClass("hidden")});a(".asite-contents #modal-userchange").on("shown.bs.modal",function(){a(".asite-contents #modal-userchange .form-control-keyword").focus()});a(".asite-contents #modal-userchange .form-search").data("validator",null);a(".asite-contents #modal-userchange .form-search").unbind("validate");a(".asite-contents #modal-userchange .form-search").validate({submitHandler:function submitHandler(){a.ajax({url:a(".asite-contents #modal-userchange .form-search").attr("action"),data:a(".asite-contents #modal-userchange .form-search").serialize(),success:function success(e){if(e.code==mesg.success){a(".asite-contents #modal-userchange .form-result").removeClass("hidden");a(".asite-contents #modal-userchange .form-result tbody.tbody").empty();a(".asite-contents #modal-userchange .form-result tbody.tbody").html(e.html);a(".asite-contents #modal-userchange .form-result .form-result-paginginfo").html(e.pagingInfo);a(".asite-contents #modal-userchange .form-result .paging-html").html(e.pagingHtml);a(".asite-contents #modal-userchange .paging-html .page-link:not([href='#'])").click(function(){var b=a(this).data("pagenum");a(".asite-contents #modal-userchange .form-search input[name='page']").val(b);a(".asite-contents #modal-userchange .form-search").submit();return!1});a(".asite-contents #modal-userchange .form-result .btn-select").each(function(){var e=a(this),h=e.closest("tr");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("user_change","local_ubion"),body:M.util.get_string("contents_user_change","local_ubion",h.data("name"))},e).done(function(b){b.setSaveButtonText(M.util.get_string("user_change","local_ubion"));b.getRoot().on(c.save,function(c){c.preventDefault();var e=coursemostype+"=userChange&id="+f+"&userid="+h.data("id");if(g){e=coursemostype+"=userChanges";a.each(f,function(a,b){e+="&ids[]="+b});e+="&userid="+h.data("id")}a.ajax({url:a(".asite-contents #modal-userchange .form-search").attr("action"),data:e,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg);b.hide();d.checkModalOpenClass()}}})});b.getRoot().on(c.cancel,function(){d.checkModalOpenClass()})})})}else{alert(e.msg)}}});return!1}});a(".asite-contents #modal-userchange").modal("show")};d.userShareModal=function(e,f){var g=a(".asite-contents #modal-usershare .card-share-users"),h=a(".asite-contents #modal-usershare .form-search").attr("action");if(f){g.html("").parent().hide()}else{a.ajax({url:h,data:coursemostype+"=shareUsers&contentid="+e,success:function success(a){if(a.code==mesg.success){if(""!=a.usersHtml){g.html(a.usersHtml).parent().show()}else{g.html("").parent().hide()}}else{alert(a.msg)}}})}a(document).on("click",".asite-contents .badge-user-delete",function(){var d=a(this),f=d.data("userid"),i=d.data("contentid"),j=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_user_delete","local_ubion",d.text())},j).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(c){c.preventDefault();a.ajax({url:h,data:coursemostype+"=shareUserDelete&contentid="+i+"&userid="+f,success:function success(a){if(a.code==mesg.success){d.remove();b.hide();if(""==g.html()){g.parent().hide()}}else{alert(a.msg)}}})})});j.trigger("click")});a(".asite-contents #modal-usershare form").each(function(){this.reset();a(".asite-contents #modal-usershare .form-result").addClass("hidden")});a(".asite-contents #modal-usershare").on("shown.bs.modal",function(){a(".asite-contents #modal-usershare .form-control-keyword").focus()});a(".asite-contents #modal-usershare").on("hide.bs.modal",function(){location.reload()});a(".asite-contents #modal-usershare .form-search").data("validator",null);a(".asite-contents #modal-usershare .form-search").unbind("validate");a(".asite-contents #modal-usershare .form-search").validate({submitHandler:function submitHandler(){a.ajax({url:h,data:a(".asite-contents #modal-usershare .form-search").serialize()+"&ischeckbox=1",success:function success(b){if(b.code==mesg.success){a(".asite-contents #modal-usershare .form-result").removeClass("hidden");a(".asite-contents #modal-usershare .form-result tbody.tbody").empty();a(".asite-contents #modal-usershare .form-result tbody.tbody").html(b.html);a(".asite-contents #modal-usershare .form-result .form-result-paginginfo").html(b.pagingInfo);a(".asite-contents #modal-usershare .form-result .paging-html").html(b.pagingHtml);a(".asite-contents #modal-usershare .form-result input[name='allcheck']").click(function(){var b=a(this).is(":checked");a(".asite-contents #modal-usershare .form-result input[name='userids[]']").each(function(){if(!a(this).is(":disabled")){this.checked=b}})});a(".asite-contents #modal-usershare .paging-html .page-link:not([href='#'])").click(function(){var b=a(this).data("pagenum");a(".asite-contents #modal-usershare .form-search input[name='page']").val(b);a(".asite-contents #modal-usershare .form-search").submit();return!1});a(".asite-contents #modal-usershare .form-result .btn-select").each(function(){var b=a(this),c=b.closest("tr"),i=[c.data("id")],j=c.data("name");d.shareUserConfirm(h,e,f,b,i,j,g)});a(".asite-contents .btn-check-user-share-users").click(function(){var b=a(this),c=a(this).closest("form").find("input[name='userids[]']:checked"),i=c.map(function(){return a(this).val()}).toArray(),j=c.map(function(){return a(this).closest("tr").data("name")}).toArray();if(0<i.length){d.shareUserConfirm(h,e,f,b,i,j.join(", "),g)}else{alert(M.util.get_string("min_check","local_ubion",1))}})}else{alert(b.msg)}}});return!1}});a(".asite-contents #modal-usershare").modal("show")};d.shareUserConfirm=function(f,g,h,i,j,k,l){var m="",n="";a.each(j,function(a,b){m+=n+"userids[]="+b;n="&"});b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("contents_user_share","local_ubion"),body:M.util.get_string("contents_user_add","local_ubion",k)},i).done(function(b){b.setSaveButtonText(M.util.get_string("add","core"));b.getRoot().on(c.save,function(c){c.preventDefault();var e=coursemostype+"=shareUserAdd&id="+g;if(h){e=coursemostype+"=shareUserAdds";a.each(g,function(a,b){e+="&ids[]="+b})}e+="&"+m;a.ajax({url:f,data:e,success:function success(a){if(a.code==mesg.success){if(h){location.reload()}else{if(""!=a.userBadge&&!h){l.append(a.userBadge).parent().show()}b.hide()}}else{alert(a.msg);b.hide();d.checkModalOpenClass()}}})});b.getRoot().on(c.cancel,function(){d.checkModalOpenClass()})})};d.checkModalOpenClass=function(){setTimeout(function(){if(!a("body").hasClass("modal-open")){a("body").addClass("modal-open")}},100)};d.delete=function(d){a(".asite-contents .form-result .btn-delete").each(function(){var e=a(this),f=e.closest("tr").data("id"),g=e.closest("form");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:d},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(c){c.preventDefault();showSubmitProgress();a.ajax({type:"post",url:g.attr("action"),data:coursemostype+"=delete&id="+f,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg);b.hide();hideSubmitProgress()}return!1}})})})})};d.checkDelete=function(e){a(".asite-contents .btn-check-delete").click(function(){var f=a(this).closest("form"),g=d.checkCount();if(0<g){var h=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("contents_check_delete","local_ubion",{count:g,name:e})},h).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(c){c.preventDefault();showSubmitProgress();a.ajax({type:"post",url:f.attr("action"),data:f.serialize(),success:function success(a){alert(a.msg);if(a.code==mesg.success){location.replace(location.href)}else{b.hide();hideSubmitProgress()}return!1}})})});h.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}})};return d});
define ("local_ubion/asiteContentsEContents",["jquery","local_ubion/asiteContents","mod_econtents/management","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a,b,c){return{init:function(d){c.modal();a(".asite-contents-econtents .form-result .btn-modify").click(function(){var b=a(this).closest("tr").data("id");c.modalMove(d+"?id="+b+"&iscoursemosadmin=1")});a(".asite-contents-econtents .form-result .btn-preview").click(function(){var b=a(this).closest("tr").data("id"),c=window.open(a(this).attr("data-url"),"PREVIEWWIN_"+b,"width="+a(this).attr("data-width")+",height="+a(this).attr("data-height")+",toolbar=No,location=No,scrollbars=no,status=No,resizable=yes");c.focus()});b.checkDelete(M.util.get_string("pluginname","econtents"));b.delete(M.util.get_string("confirm_select_delete","econtents"))}}});
define ("local_ubion/asiteContentsVod",["jquery","local_ubion/asiteContents","mod_vod/management","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a,b,c){return{init:function(d){c.init(d);c.modal();a(".asite-contents-vod .form-result .btn-modify").click(function(){var b=a(this).closest("tr").data("id");c.modalView(b,1)});b.checkDelete(M.util.get_string("pluginname","vod"));b.delete(M.util.get_string("confirm_vod_delete","vod"))}}});
define ("local_ubion/asiteCourse",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a,b,c){var d={};d.searchForm=function(b,c){var e=a(".form-control-group-code"),f=a(".form-control-dept-code-01"),g=a(".form-control-dept-code-02"),h=a(".form-control-dept-code-03"),i=a(".form-control-dept-code-04");e.change(function(){var e=a(this).val();f.find("option").remove();f.append("<option value=\""+c+"\">All</option>");d.deptDisabled(g,!1);d.deptDisabled(h,!1);d.deptDisabled(i,!1);var j=a(this).closest(".col-dept"),k=a(j).data("year"),l=a(j).data("semester");a.ajax({data:coursemostype+"=deptCode01&year="+k+"&semester="+l+"&group_code="+e,url:b,success:function success(b){if(b.code==mesg.success){a.each(b.depts,function(a,b){f.append("<option value=\""+b.dept_code_01+"\">"+b.dept_name_01+"</option>")})}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})});f.change(function(){var e=a(this).val();g.find("option").remove();g.append("<option value=\""+c+"\">All</option>");d.deptDisabled(h,!1);d.deptDisabled(i,!1);if(e!=c){g.prop("disabled",!1);var f=a(this).closest(".col-dept"),j=a(f).data("year"),k=a(f).data("semester");a.ajax({data:coursemostype+"=deptCode02&year="+j+"&semester="+k+"&dept_code_01="+e,url:b,success:function success(b){if(b.code==mesg.success){a.each(b.depts,function(a,b){g.append("<option value=\""+b.dept_code_02+"\">"+b.dept_name_02+"</option>")});d.deptDisabled(g,!0)}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}else{d.deptDisabled(g,!1)}});if(0<h.length){g.change(function(){var e=a(this).val();h.find("option").remove();h.append("<option value=\""+c+"\">All</option>");d.deptDisabled(i,!1);if(e!=c){var g=a(this).closest(".col-dept"),j=a(g).data("year"),k=a(g).data("semester"),l=coursemostype+"=deptCode03&year="+j+"&semester="+k+"&dept_code_01="+f.val()+"&dept_code_02="+e;a.ajax({data:l,url:b,success:function success(b){if(b.code==mesg.success){a.each(b.depts,function(a,b){h.append("<option value=\""+b.dept_code_03+"\">"+b.dept_name_03+"</option>")});d.deptDisabled(h,!0)}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}else{d.deptDisabled(h,!1)}})}if(0<i.length){h.change(function(){var e=a(this).val();i.find("option").remove();i.append("<option value=\""+c+"\">All</option>");if(e!=c){var h=a(this).closest(".col-dept"),j=a(h).data("year"),k=a(h).data("semester"),l=coursemostype+"=deptCode04&year="+j+"&semester="+k+"&dept_code_01="+f.val()+"&dept_code_02="+g.val()+"&dept_code_03="+e;a.ajax({data:l,url:b,success:function success(b){if(b.code==mesg.success){a.each(b.depts,function(a,b){i.append("<option value=\""+b.dept_code_03+"\">"+b.dept_name_03+"</option>")});d.deptDisabled(i,!0)}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}else{d.deptDisabled(i,!1)}})}};d.deptDisabled=function(a,b){if(0<a.length){if(b){a.show()}else{a.hide()}}};d.regular=function(d,e){a(".btn-course-detail").click(function(){var b=a(this).data("id");if(0<b){a.ajax({data:coursemostype+"=courseDetail&id="+b,url:d,success:function success(b){if(b.code==mesg.success){a("#modal-course-detail .modal-title .fullname").text(b.fullname);a("#modal-course-detail .modal-body").html(b.html);a("#modal-course-detail").modal("show")}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}else{alert(M.util.get_string("courseidnotfound","local_ubion"))}});a(".btn-opencourse").each(function(){var e=a(this),f=e.data("id"),g=e.data("type"),h="course_open_confirm";if("openCancel"==g){h="course_open_confirm_cancel"}b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("course_open_setting","local_ubion"),body:M.util.get_string(h,"local_ubion")},e).done(function(b){b.setSaveButtonText(M.util.get_string("confirm","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=open&id="+f+"&opentype="+g,url:d,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});a(".btn-visible").each(function(){var e=a(this),f=e.data("id"),g=e.data("type"),h="course_visible_confirm";if("1"==g){h="course_visible_confirm_cancel"}b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("course_visible","local_ubion"),body:M.util.get_string(h,"local_ubion")},e).done(function(b){b.setSaveButtonText(M.util.get_string("confirm","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=visible&id="+f+"&visibletype="+g,url:d,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});a(".btn-tooltip").tooltip();a(".btn-combine").click(function(){a("#modal-combined input[name='courseid']").val(a(this).data("id"));a("#modal-combined").modal("show")});a(".btn-new-combine").click(function(){if(0<a("#modal-combined .table-search-courses .checkbox-courses:checked").length){formSubmit(e,a("#modal-combined form").serialize()+"&combinetype=newCombine")}else{alert(M.util.get_string("combine_notselect","local_ubion"))}});a(".btn-add-combine").click(function(){if(0<a("#modal-combined .table-search-courses .checkbox-courses:checked").length){formSubmit(e,a("#modal-combined form").serialize()+"&combinetype=addCombine")}else{alert(M.util.get_string("combine_notselect","local_ubion"))}});a("#modal-combined").on("show.bs.modal",function(){a("#modal-combined form").each(function(){this.reset()});a("#modal-combined .table-search-courses tbody").empty();a("#modal-combined .table-search-courses tbody").append(a("<tr>").append(a("<td colspan=\"2\">").text(M.util.get_string("combine_course_search","local_ubion"))));var e=a("#modal-combined input[name='courseid']").val();a.ajax({url:d,data:coursemostype+"=combineCourses&id="+e,type:"post",success:function success(g){if(g.code==mesg.success){a("#modal-combined .text-coursename").text(g.name);a("#modal-combined .text-professors").text(g.professors);if(0<g.allCombinedCount){a("#modal-combined .btn-add-combine").show();a("#modal-combined .table-combine-courses").closest(".form-group").show();a("#modal-combined .table-combine-courses tbody").empty();if(0<g.combineCount){a.each(g.combineCourses,function(b,d){var c=a("<tr>"),e=d.coursename+"<button type=\"button\" data-id=\""+d.id+"\" class=\"ml-2 btn btn-sm btn-danger pull-right btn-combined-cancel\">"+M.util.get_string("combine_course_cancel","local_ubion")+"</button >";c.append(a("<td>").html(e));a("#modal-combined .table-combine-courses tbody").append(c)});a(".btn-combined-cancel").each(function(){var g=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("combine_course_cancel","local_ubion"),body:M.util.get_string("combine_course_confirm_cancel","local_ubion")},g).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("combine_course_cancel","local_ubion"));b.getRoot().on(c.save,function(c){c.preventDefault();a.ajax({url:d,data:coursemostype+"=combineCancel&id="+g.data("id"),type:"post",success:function success(a){if(a.code==mesg.success){var c=g.closest("tbody");g.closest("tr").remove();if(0==c.find("tr").length){f(e)}}b.hide();alert(a.msg);return!1}})})})})}else{f(e)}}else{a("#modal-combined .table-combine-courses").closest(".form-group").hide();a("#modal-combined .btn-add-combine").hide()}return!1}else{alert(g.msg);return!1}}})});a("#modal-combined").on("shown.bs.modal",function(){a("#modal-combined .modal-body").scrollTop(0)});function f(f){var g=M.util.get_string("combine_course_student_all_delete","local_ubion"),h=a("<tr>"),e=a("<td>");e.append("<p class=\"text-danger\">"+M.util.get_string("combine_course_all_canceled","local_ubion")+"</p>");e.append("<button type=\"button\" class=\"btn btn-sm btn-default btn-user-reset mr-2\">"+g+"</button>");e.append("<button type=\"button\" class=\"btn btn-sm btn-danger btn-combine-delete\">"+M.util.get_string("combine_course_cancel","local_ubion")+"</button>");h.append(e);a("#modal-combined .table-combine-courses tbody").append(h);b.create({type:b.types.SAVE_CANCEL,title:g,body:M.util.get_string("combine_course_confirm_all_delete_student","local_ubion")},a(".btn-user-reset")).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(g);b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:d,data:coursemostype+"=combineUserReset&id="+f,type:"post",success:function success(a){if(a.code==mesg.success){location.reload()}else{hideSubmitProgress()}}})})});b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("combine_course_cancel","local_ubion"),body:M.util.get_string("combine_course_confirm_cancel_delete","local_ubion")},a(".btn-combine-delete")).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("combine_course_cancel","local_ubion"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:d,data:coursemostype+"=combineDelete&id="+f,type:"post",success:function success(a){if(a.code==mesg.success){location.reload()}else{hideSubmitProgress()}return!1}})})})}a("#modal-combined form").validate({submitHandler:function submitHandler(b){a.ajax({url:d,data:a(b).serialize(),type:"post",success:function success(b){if(b.code==mesg.success){a("#modal-combined .table-search-courses tbody").empty();if(0<b.count){a.each(b.courses,function(b,d){var c=a("<tr>"),e=d.isDisabled?" disabled=\"disabled\"":"";c.append(a("<td class='text-center'>").html("<input type=\"checkbox\" name=\"courses[]\" class=\"checkbox-courses\" "+e+" value=\""+d.id+"\" />"));c.append(a("<td>").html(d.name));a("#modal-combined .table-search-courses tbody").append(c)})}else{a("#modal-combined .table-search-courses tbody").append("<tr><td colspan=\"2\" class=\"text-danger\">"+M.util.get_string("no_courses","local_ubion")+"</td></tr>")}a("#modal-combined [data-toggle='tooltip']").tooltip()}else{alert(b.msg);return!1}return!1}});return!1}});a("#modal-combined .checkbox-all").click(function(){var b=a(this).is(":checked");a("#modal-combined .table-search-courses .checkbox-courses").each(function(){if(!a(this).is(":disabled")){this.checked=b}})});a(".btn-combined-users").each(function(){var f=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("course_student_sync","local_ubion"),body:M.util.get_string("combine_course_confirm_user","local_ubion")},f).done(function(b){b.setSaveButtonText(M.util.get_string("course_student_sync","local_ubion"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:d,data:coursemostype+"=combinedUsers&courseid="+f.data("id"),type:"post",success:function success(a){if(a.code==mesg.success){alert(M.util.get_string("combine_sync_success","local_ubion"));location.reload()}else{hideSubmitProgress();alert(a.msg)}return!1}})})})})};d.batch=function(e,f,g){a(".asite-course .table-courses input[name='all']").click(function(){var b=a(this).is(":checked");a(".asite-course .table-courses input[name='courseids[]']").not(":disabled").prop("checked",b)});a(".asite-course .btn-startdate").click(function(){if(d.batchMinCourse()){a("#modal-startdate").modal("show")}});a(".asite-course .btn-studydate").click(function(){if(d.batchMinCourse()){a("#modal-studydate").modal("show")}});a(".asite-course .btn-onlineattendance").click(function(){if(d.batchMinCourse()){a("#modal-onlineattendance").modal("show")}});a(".asite-course .btn-progress").click(function(){if(d.batchMinCourse()){a("#modal-progress").modal("show")}});a("#modal-startdate .form-modal").validate({submitHandler:function submitHandler(a){d.batchAddCourseElements(a);return!0}});a("#modal-studydate .form-modal").validate({submitHandler:function submitHandler(b){var c=a(b.startdate).val(),e=a(b.enddate).val();if(c>e){alert(M.util.get_string("study_startend_error","local_ubion",e));return!1}else{d.batchAddCourseElements(b)}return!0}});a("#modal-onlineattendance .form-modal").validate({submitHandler:function submitHandler(f){var g=!0,h="",i=null;a("#modal-onlineattendance .form-modal .table-sections tr.section").each(function(){var b=a(this).data("section"),c=a(this).find("input[name=\"start_time_"+b+"\"]"),d=a(this).find("input[name=\"end_time_"+b+"\"]"),f=a(this).find("input[name=\"attendance_percent_"+b+"\"]"),j=c.val(),k=d.val(),l=parseInt(f.val());if(e){var m=a(this).find("input[name=\"lateness_time_"+b+"\"]"),n=a(this).find("input[name=\"lateness_percent_"+b+"\"]"),o=m.val(),p=parseInt(n.val())}if(""!=h&&j<h){alert(M.util.get_string("error_oldate","local_ubonattend",h));c.focus();g=!1;return!1}if(k<j){alert(M.util.get_string("error_oldate2","local_ubonattend",j));d.focus();g=!1;return!1}if(e){if(l<p){alert(M.util.get_string("error_percent","local_ubonattend"));f.focus();g=!1;return!1}if(o<k){alert(M.util.get_string("error_oldate3","local_ubonattend",k));m.focus();g=!1;return!1}}if(0>p){alert(M.util.get_string("error_percent2","local_ubonattend"));n.focus();g=!1;return!1}if(i){var q=i.data("section"),r=i.find("input[name=\"end_time_"+q+"\"]").val();if(r>k){alert(M.util.get_string("error_oldate4","local_ubonattend",r));d.focus();g=!1;return!1}if(e){var s=i.find("input[name=\"lateness_time_"+q+"\"]").val();if(s>o){alert(M.util.get_string("error_oldate5","local_ubonattend",s));m.focus();g=!1;return!1}}}h=j;i=a(this)});if(g){var j=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("tab_setting","local_ubonattend"),body:M.util.get_string("confirm_section_change","local_ubonattend")},j).done(function(b){b.getRoot().on(c.save,function(b){d.batchAddCourseElements(f);b.preventDefault();a("#modal-onlineattendance .form-modal button[type='submit']").attr("disabled","disalbed");showSubmitProgress();f.submit()})});j.trigger("click")}return!1}});a("#modal-onlineattendance select[name='used']").change(function(){var b=a(this).val(),c=a("#modal-onlineattendance .form-group-online-attendance");if("0"==b){c.addClass("hidden")}else{c.removeClass("hidden")}});a("#modal-progress .form-modal").validate({submitHandler:function submitHandler(a){d.batchAddCourseElements(a);return!0}});a(".asite-course .btn-sectionname").click(function(){if(d.batchMinCourse()){a("#modal-sectionname").modal("show")}});a("#modal-sectionname .reset-sectionname").click(function(){var b=a(this).is(":checked");a("#modal-sectionname .sectionname-reset").not(":disabled").each(function(){a(this).prop("checked",b);d.sectionNameDisabled(a(this))})});a("#modal-sectionname .sectionname-reset").change(function(){d.sectionNameDisabled(a(this))});a("#modal-sectionname .form-modal").validate({submitHandler:function submitHandler(a){d.batchAddCourseElements(a);return!0}});a(".asite-course .btn-courseformat").click(function(){if(d.batchMinCourse()){a("#modal-courseformat").modal("show")}});a("#modal-courseformat .form-modal select[name=\"format\"]").change(function(){var b=a(this).val(),c=coursemostype+"=formatchange&format="+b+"&sesskey="+M.cfg.sesskey+"&year="+f+"&semester="+g;a.ajax({data:c,url:a("#modal-courseformat .form-modal").attr("action"),success:function success(b){if(b.code==mesg.success){a("#modal-courseformat .form-modal .course-format-options").html(b.html)}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})});a(document).on("click","#modal-courseformat .form-modal input.control-disabled",function(){var b=a(this),c=b.closest(".col-form-control"),d=c.find(".form-control-item");if(b.is(":checked")){d.attr("disabled","disabled")}else{d.removeAttr("disabled")}});a("#modal-courseformat .form-modal").validate({submitHandler:function submitHandler(a){d.batchAddCourseElements(a);return!0}})};d.sectionNameDisabled=function(a){var b=a.closest("tr"),c=b.find(".sectionname");if(a.is(":checked")){c.attr("disabled","disabled")}else{c.removeAttr("disabled")}};d.batchMinCourse=function(){var b=!1;if(0<a(".asite-course .form-result .table-courses input[name='courseids[]']:checked").length){b=!0}else{alert(M.util.get_string("min_check","local_ubion",1))}return b};d.batchAddCourseElements=function(b){if(d.batchMinCourse()){a(".asite-course .form-result .table-courses input[name='courseids[]']:checked").each(function(c,d){a(b).append("<input type=\"hidden\" name=\"courseids[]\" value=\""+a(d).val()+"\" />")});if(0==a(b).find("input[name='sesskey']").length){a(b).append("<input type=\"hidden\" name=\"sesskey\" value=\""+M.cfg.sesskey+"\" />")}}return!0};d.combine=function(){a(".form-course-combined").validate({submitHandler:function submitHandler(d){var e=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("course_combine","local_ubion"),body:M.util.get_string("combine_course_confirm","local_ubion")},e).done(function(b){b.setSaveButtonText(M.util.get_string("course_combine","local_ubion"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a(".form-course-combined .btn-new-combined-course").attr("disabled","dislabed");a(".form-course-combined .btn-add-combined-course").attr("disabled","dislabed");d.submit()})});e.trigger("click")}})};return d});
define ("local_ubion/asiteHaksa",["jquery","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a){var b={};b.init=function(){a(".form-search.form-validate").validate({submitHandler:function submitHandler(c){a(".form-search button[type='submit'], .form-search input[type='submit']").attr("disabled",!0);b.searchSubmit();c.submit()}});a(".btn-demon-sync").click(function(){a("#haksaSyncForm input[name='allsync']").val(a(this).attr("data-allsync"));var b=a(this).data("id");if(0<b){a("#haksaSyncForm input[name='id']").val(b)}a("#haksaSyncForm").submit();return!1});a("#haksaSyncForm").validate({submitHandler:function submitHandler(b){var c=a(b.allsync).val();if(1==c){if(!confirm(a("#haksaSyncForm .allSync1Message").text().replace(/\\n/g,"\n"))){return!1}}else{if(!confirm(a("#haksaSyncForm .allSync0Message").text().replace(/\\n/g,"\n"))){return!1}}a("#modal-haksa-popup").modal({show:!0,keyboard:!1,backdrop:!0});a("#modal-haksa-popup").on("hide.bs.modal",function(){return!1});b.submit();return!1}});a("#view-log").on("hidden",function(){a(this).removeData("modal");a(this).find(".modal-body").html("<p>Loading\u2026</p>")});a("#view-log").on("show.bs.modal",function(b){var c=a(b.relatedTarget);a("#view-log .modal-body").load(c.attr("data-url"))})};b.dashboard=function(){a(".form-select-semester .form-control-semester").change(function(){location.href=location.pathname+"?id="+a(this).val()})};b.member=function(c){a(".btn-member-detail").click(function(){var d=a(this).closest("tr").data("memberkey");if(d){b.searchSubmit();a.ajax({data:coursemostype+"=memberCompareView&memberkey="+d,url:c,success:function success(b){hideSubmitProgress();if(b.code==mesg.success){a("#modal-haksainfo .modal-title .fullname").text(b.fullname);a("#modal-haksainfo .modal-body").html(b.html);a("#modal-haksainfo").modal("show")}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}else{alert("\uD559\uBC88 \uC815\uBCF4\uB97C \uCC3E\uC744\uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}});a(".btn-person-sync").click(function(){var d=a(this).data("fullname");if(confirm("["+d+"] \uC0AC\uC6A9\uC790\uB97C \uB3D9\uAE30\uD654 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){var e=a(this).closest("tr").data("memberkey");if(e){b.saveSubmit();a.ajax({data:coursemostype+"=memberCompare&memberkey="+e,url:c,success:function success(a){if(a.code==mesg.success){location.reload()}else{hideSubmitProgress();alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}else{alert("\uD559\uBC88 \uC815\uBCF4\uB97C \uCC3E\uC744\uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}}})};b.category=function(b){a(".form-category-insert").validate({submitHandler:function submitHandler(a){showSubmitProgress();a.submit()}});a(".form-validate").validate();a(".btn-current-semester").click(function(){var c=a(this).attr("data-num"),d=a(this).attr("data-name");if(confirm("["+d+"] \uD604\uC7AC\uD559\uAE30\uB85C \uC124\uC815\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){var e={id:c};e[coursemostype]="currentSemester";formSubmit(b,e)}});a(".btn-setting").click(function(){a("#modal-haksa-setting form").each(function(){this.reset()});var c=a(this).attr("data-num");if(0<c){a.ajax({data:coursemostype+"=categoryView&id="+c,url:b,success:function success(b){if(b.code==mesg.success){a("#modal-haksa-setting [name='id']").val(b.haksa.id);if(null!==b.haksa.printtype){a("#modal-haksa-setting [name='printtype']").val(b.haksa.printtype).prop("selected",!0)}a("#modal-haksa-setting [name='course_start']").val(b.haksa.course_start_ymd);a("#modal-haksa-setting [name='course_end']").val(b.haksa.course_end_ymd);a("#modal-haksa-setting [name='course_week']").val(b.haksa.weeks);a("#modal-haksa-setting [name='course_sync'][value='"+b.haksa.sync+"']").prop("checked",!0);a("#modal-haksa-setting").modal("show")}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});a(".btn-haksa-delete").click(function(){var c=a(this).attr("data-num"),d=a(this).attr("data-name");if(confirm("["+d+"] \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?\n\uD574\uB2F9 \uD559\uAE30 \uC0AD\uC81C\uC2DC \uC2E4\uC81C \uAC15\uC88C \uC0AD\uC81C\uB294 \uC774\uB8E8\uC5B4\uC9C0\uC9C0 \uC54A\uC73C\uBA70 \uD559\uAE30 \uC124\uC815 \uBAA9\uB85D\uC5D0\uC11C\uB9CC \uC0AD\uC81C\uB429\uB2C8\uB2E4.")){var e={id:c};e[coursemostype]="categoryDelete";formSubmit(b,e)}})};b.course=function(c,d){var f=a(".form-control-year").val(),g=a(".form-control-semester").val(),h=a(".form-control-dept01"),i=a(".form-control-dept02");if(h.val()==d){i.prop("disabled",!0)}else{i.prop("disabled",!1)}h.change(function(){var b=a(this).val();i.find("option").remove();i.append("<option value=\""+d+"\">All</option>");if(b!=d){i.prop("disabled",!1);a.ajax({data:coursemostype+"=courseDeptCode02List&dept_code_01="+b+"&year="+f+"&semester="+g,url:c,success:function success(b){if(b.code==mesg.success){a.each(b.deptList,function(a,b){i.append("<option value=\""+b.dept_code_02+"\">"+b.dept_name_02+"</option>")})}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}else{i.prop("disabled",!0)}});a(".btn-course-detail").click(function(){var d=a(this).closest("tr"),e="";a.each(d.data(),function(a,b){e+="&"+a+"="+b});b.searchSubmit();a.ajax({data:coursemostype+"=courseCompareView"+e,url:c,success:function success(b){hideSubmitProgress();if(b.code==mesg.success){a("#modal-haksainfo .modal-title .fullname").text(b.fullname);a("#modal-haksainfo .modal-body").html(b.html);a("#modal-haksainfo").modal("show")}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})});a(".btn-course-sync").click(function(){var d=a(this).closest("tr").data("coursename");if(confirm("["+d+"] \uAC15\uC88C\uB97C \uB3D9\uAE30\uD654 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){var e=a(this).closest("tr"),f="";a.each(e.data(),function(a,b){f+="&"+a+"="+b});b.saveSubmit();a.ajax({data:coursemostype+"=courseCompare"+f,url:c,success:function success(a){if(a.code==mesg.success){location.reload()}else{hideSubmitProgress();alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});a(".btn-professor-sync").click(function(){e(a(this),"professor")});a(".btn-student-sync").click(function(){e(a(this),"student")});function e(d,e){var f=a(d).closest("tr").data("coursename"),g="\uAD50\uC218";if("student"==e){g="\uC218\uAC15\uC0DD"}var h="["+f+"] \uAC15\uC88C "+g+" \uB3D9\uAE30\uD654 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?";if(confirm(h)){var i=a(d).closest("tr"),j="";a.each(i.data(),function(a,b){j+="&"+a+"="+b});b.saveSubmit();a.ajax({data:coursemostype+"=courseProfessorStudentCompare"+j+"&synctype="+e,url:c,success:function success(a){if(a.code==mesg.success){location.reload()}else{hideSubmitProgress();alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}}a(".btn-user-view").click(function(){var d=a(this).closest("tr").data("coursename"),e=a(this).data("role"),f=a(this).closest("tr"),g="";a.each(f.data(),function(a,b){g+="&"+a+"="+b});b.saveSubmit();a.ajax({data:coursemostype+"=courseUsers&usertype="+e+g,url:c,success:function success(b){hideSubmitProgress();if(b.code==mesg.success){a("#modal-haksa-users .modal-title .coursename").text(d);a("#modal-haksa-users .modal-title .typename").text(b.typeName);a("#modal-haksa-users .modal-body").html(b.html);a("#modal-haksa-users").modal("show")}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})});a(".btn-course-grade-category").click(function(){var d=a(this).closest("tr"),e="";a.each(d.data(),function(a,b){e+="&"+a+"="+b});b.searchSubmit();a.ajax({data:coursemostype+"=courseGradeCategoryCompareView"+e,url:c,success:function success(b){hideSubmitProgress();if(b.code==mesg.success){a("#modal-haksa-course-category .modal-title .coursename").text(b.fullname);a("#modal-haksa-course-category .modal-body").html(b.html);a("#modal-haksa-course-category").modal("show")}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})});a(".btn-course-category-sync").click(function(){var d=a(this).closest("tr").data("coursename");if(confirm("["+d+"] \uC131\uC801 \uCE74\uD14C\uACE0\uB9AC\uB97C \uB3D9\uAE30\uD654 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){var e=a(this).closest("tr"),f="";a.each(e.data(),function(a,b){f+="&"+a+"="+b});b.saveSubmit();a.ajax({data:coursemostype+"=courseGradeCategoryCompare"+f,url:c,success:function success(a){if(a.code==mesg.success){location.reload()}else{hideSubmitProgress();alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}})};b.professorStudent=function(c){a(".btn-person-sync").click(function(){if(confirm("\uC0AC\uC6A9\uC790 \uB3D9\uAE30\uD654 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){var d=a(this).data("memberkey");if(d){b.saveSubmit();a.ajax({data:coursemostype+"=memberCompare&memberkey="+d,url:c,success:function success(a){if(a.code==mesg.success){location.reload()}else{hideSubmitProgress();alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}else{alert("\uD559\uBC88 \uC815\uBCF4\uB97C \uCC3E\uC744\uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}}});a(".btn-course-sync").click(function(){var d=a(this).closest("tr").data("coursename");if(confirm("["+d+"] \uAC15\uC88C\uB97C \uB3D9\uAE30\uD654 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){var e=a(this).closest("tr"),f="";a.each(e.data(),function(a,b){f+="&"+a+"="+b});b.saveSubmit();a.ajax({data:coursemostype+"=courseCompare"+f,url:c,success:function success(a){if(a.code==mesg.success){location.reload()}else{hideSubmitProgress();alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});a(".btn-professor-sync").click(function(){var d=a(this).data("year"),e=a(this).data("semester"),f=a(this).data("memberkey");if(confirm("["+f+"] \uAD50\uBC88/\uD559\uBC88 \uC0AC\uC6A9\uC790\uC5D0 \uB300\uD574 \uC218\uAC15 \uB3D9\uAE30\uD654 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){b.saveSubmit();a.ajax({data:coursemostype+"=professorCompare&year="+d+"&semester="+e+"&memberkey="+f,url:c,success:function success(a){if(a.code==mesg.success){location.reload()}else{hideSubmitProgress();alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});a(".btn-student-sync").click(function(){var d=a(this).data("year"),e=a(this).data("semester"),f=a(this).data("memberkey");if(confirm("["+f+"] \uAD50\uBC88/\uD559\uBC88 \uC0AC\uC6A9\uC790\uC5D0 \uB300\uD574 \uC218\uAC15 \uB3D9\uAE30\uD654 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){b.saveSubmit();a.ajax({data:coursemostype+"=studentCompare&year="+d+"&semester="+e+"&memberkey="+f,url:c,success:function success(a){if(a.code==mesg.success){location.reload()}else{hideSubmitProgress();alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}})};b.setting=function(b){a(".btn-force-cron").click(function(){if(!confirm("\uC790\uB3D9 \uB3D9\uAE30\uD654\uB97C \uC9C0\uAE08 \uBC14\uB85C \uC2E4\uD589 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){return!1}return!0});a(".btn-sync-reset").click(function(){a.ajax({data:coursemostype+"=syncReset",url:b,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})};b.searchSubmit=function(){a("#ajax_loading_message .save_msg").text(M.util.get_string("loading_search","theme_coursemos"));showSubmitProgress()};b.saveSubmit=function(){a("#ajax_loading_message .save_msg").text(M.util.get_string("loading","theme_coursemos"));showSubmitProgress()};return b});
define ("local_ubion/asiteIrregular",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable"],function(a,b,c){return{index:function(d){a(".btn-course-default").click(function(){var b=a(this).data("id");if(0<b){a.ajax({data:coursemostype+"=courseDetail&id="+b,url:d,success:function success(b){if(b.code==mesg.success){a("#modal-course-detail .modal-title .fullname").text(b.fullname);a("#modal-course-detail .modal-body").html(b.html);a("#modal-course-detail").modal("show")}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}else{alert(M.util.get_string("courseidnotfound","error"))}});a(".btn-opencourse").each(function(){var e=a(this),f=e.data("id"),g=e.data("type"),h="course_open_confirm";if("openCancel"==g){h="course_open_confirm_cancel"}b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("course_open_setting","local_ubion"),body:M.util.get_string(h,"local_ubion")},e).done(function(b){b.setSaveButtonText(M.util.get_string("confirm","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=open&id="+f+"&opentype="+g,url:d,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});a(".btn-visible").each(function(){var e=a(this),f=e.data("id"),g=e.data("type"),h="course_visible_confirm";if("1"==g){h="course_visible_confirm_cancel"}b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("course_visible","local_ubion"),body:M.util.get_string(h,"local_ubion")},e).done(function(b){b.setSaveButtonText(M.util.get_string("confirm","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=visible&id="+f+"&visibletype="+g,url:d,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})})},batch:function(){a(".form-validate").validate()}}});
define ("local_ubion/asiteLogs",["jquery","core/templates","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery.filedownload"],function(a){var b={init:function(){a(".asite-logs .btn-detail").click(function(){var b=a(this).closest("tr"),c=b.find(".activity-detail").clone().removeClass("d-none").wrapAll("<div/>").parent().html();a("#modal-detail .modal-title").text(b.find(".activity-name").text());a("#modal-detail .modal-body").html(c);a("#modal-detail").modal("show")});a(".asite-logs .modal").on("shown.bs.modal",function(b){a(b.currentTarget).find(".modal-body").scrollTop(0)});a(document).on("click",".card-tabs .nav-link",function(){a(".card-tabs .nav-link").removeClass("active");a(this).addClass("active");var b=a(this).closest(".card-tabs"),c=a(this).data("type"),d=4;if("undefined"!==a(this).data("colcount")){d=a(this).data("colcount")}var e="col-sm-6 col-lg-4 col-xl-3",f="col-lg-6 col-xl-"+d;if("detail"==c){b.addClass("card-tabs-detail");b.find(".col-nopadding").removeClass(e).addClass(f)}else{b.removeClass("card-tabs-detail");b.find(".col-nopadding").removeClass(f).addClass(e)}});a(".asite-logs .form-result-paging-buttons .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})}};b.assign=function(c){a(".asite-logs .btn-submissions").click(function(){var d=a(this).data("cmid");a.ajax({url:c,data:coursemostype+"=tracking&cmid="+d,success:function success(a){if(a.code==mesg.success){b.setModalHtml(a)}else{alert(a.msg)}}})});a(document).on("click",".btn-tracking-user",function(){a.ajax({url:c,data:coursemostype+"=trackingUser&userid="+a(this).data("userid")+"&cmid="+a(this).closest("table").data("cmid"),success:function success(b){if(b.code==mesg.success){a("#modal-tracking-user .modal-title").html(b.title);a("#modal-tracking-user .modal-body").html(b.html);a("#modal-tracking-user").modal("show")}else{alert(b.msg)}}})})};b.quiz=function(c){a(".asite-logs .btn-attempt-count").click(function(){var d=a(this).data("state"),e=a(this).data("cmid");a.ajax({url:c,data:coursemostype+"=tracking&state="+d+"&cmid="+e,success:function success(a){if(a.code==mesg.success){b.setModalHtml(a)}else{alert(a.msg)}}})});a(document).on("click",".btn-tracking-user",function(){a.ajax({url:c,data:coursemostype+"=trackingUser&userid="+a(this).data("userid")+"&cmid="+a(this).closest("table").data("cmid")+"&attemptid="+a(this).data("attemptid"),success:function success(b){if(b.code==mesg.success){a("#modal-tracking-user .modal-title").html(b.title);a("#modal-tracking-user .modal-body").html(b.html);a("#modal-tracking-user").modal("show")}else{alert(b.msg)}}})})};b.progress=function(c){a(".asite-logs .btn-count").click(function(){var d=a(this).data("cmid");a.ajax({url:c,data:coursemostype+"=tracking&status="+status+"&cmid="+d,success:function success(a){if(a.code==mesg.success){b.setModalHtml(a)}else{alert(a.msg)}}})});a(document).on("click",".btn-tracking-user",function(){a.ajax({url:c,data:coursemostype+"=trackingUser&userid="+a(this).data("userid")+"&cmid="+a(this).closest("table").data("cmid")+"&attemptid="+a(this).data("attemptid"),success:function success(b){if(b.code==mesg.success){a("#modal-tracking-user .modal-title").html(b.title);a("#modal-tracking-user .modal-body").html(b.html);a("#modal-tracking-user [data-toggle='tooltip']").tooltip();a("#modal-tracking-user").modal("show")}else{alert(b.msg)}}})});a(document).on("click",".btn-log-detail",function(){var b=a(this).data("courseid"),d=a(this).data("cmid"),e=a(this).data("userid"),f=coursemostype+"=detailLog&courseid="+b+"&userid="+e+"&cmid="+d;a.ajax({data:f,url:c,success:function success(b){if(b.code==mesg.success){var c="modal-track-detail";if(b.isVideoMeeting){c="modal-track-detail-video-meeting"}a("#"+c+" .modal-title").text(b.title);a("#"+c+" .trackid").html(b.trackid);a("#"+c+" .table-trackdetail tbody").html(b.html);a("#"+c).modal("show");a("#"+c+" .modal-body").scrollTop(0)}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}});return!1});a(".asite-logs .btn-xncommons-playtime-edit").click(function(){var b=a(this).data("id"),d=coursemostype+"=xncommonsInfo&xncommonsid="+b;a.ajax({url:c,data:d,success:function success(b){if(b.code==mesg.success){a("#modal-tracking-playtime .form-control-contentid").text(b.info.contentid);a("#modal-tracking-playtime .form-control-oldplaytime").text(b.info.playtime);a("#modal-tracking-playtime input[name=\"id\"]").val(b.info.id);a("#modal-tracking-playtime input[name=\"playtime\"]").val(b.info.playtime);a("#modal-tracking-playtime .text-playtime").text(b.info.playtimeGMDate);a("#modal-tracking-playtime").modal("show")}else{alert(b.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});a("#modal-tracking-playtime input[name=\"playtime\"]").on("input propertychange change",function(){var c=b.gmdate(a(this).val());a("#modal-tracking-playtime .text-playtime").text(c)});a("#modal-tracking-playtime form").validate({submitHandler:function submitHandler(d){var e=a("#modal-tracking-playtime .text-playtime").text(),f=a("#modal-tracking-playtime .form-control-oldplaytime").text(),g=confirm(M.util.get_string("playtime_edit_confirm","xncommons",{old:b.gmdate(f),new:e}));if(g){showSubmitProgress();a.ajax({url:c,data:a(d).serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}return!1}})};b.gmdate=function(a){var b=Math.floor(a%60),c=Math.floor(a/60%60),d=Math.floor(a/3600%24),e="";if(0<d){d=10>d?"0"+d:d;e=e+d+":"}c=10>c?"0"+c:c;b=10>b?"0"+b:b;e+=c+":"+b;return e};b.setModalHtml=function(c){a("#modal-tracking .modal-title").html(c.title);a("#modal-tracking .modal-body").html(c.html);var d=0,e=a("#modal-tracking .modal-body .row-course-module-info");if(0<e.length){d=e.outerHeight()}a("#modal-tracking .modal-body").scrollTop(d);a.each(c.params,function(b,c){if("keyfield"==b||"ls"==b||"status"==b){a("#modal-tracking .modal-body select[name='"+b+"'] > option[value='"+c+"']").prop("selected",!0)}else{a("#modal-tracking .modal-body input[name='"+b+"']").val(c)}});a(".asite-logs #modal-tracking .form-user-search .form-control-autosubmit").change(function(){a(".asite-logs .form-user-search").submit()});a(".asite-logs #modal-tracking .pagination .page-link").click(function(){var b=a(this).data("pagenum");a("#modal-tracking .modal-body input[name='page']").val(b);a(".asite-logs .form-user-search").submit();return!1});if(""!=a("#modal-tracking .modal-body input[name='keyword']").val()){a("#modal-tracking .modal-body .btn-search-cancel").removeClass("d-none")}a("#modal-tracking .modal-body .btn-search-cancel").click(function(){a("#modal-tracking .modal-body input[name='keyword']").val("");a(".asite-logs .form-user-search").submit()});a("#modal-tracking").modal("show");a("#modal-tracking [data-toggle='tooltip']").tooltip();a(".asite-logs #modal-tracking .form-user-search").validate({submitHandler:function submitHandler(c){a.ajax({url:a(".asite-logs .form-user-search").attr("action"),data:a(c).serialize(),success:function success(a){if(a.code==mesg.success){b.setModalHtml(a)}else{alert(a.msg)}return!1}});return!1}})};return b});
define ("local_ubion/asiteMember",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a,b,c){return{index:function(d,e,f){var g=a(".form-control-institution"),h=a(".form-control-department");if(g.val()==e){h.prop("disabled",!0)}else{h.prop("disabled",!1)}g.change(function(){var b=a(this).val();h.find("option").remove();h.append("<option value=\""+e+"\">All</option>");if(b!=e){h.prop("disabled",!1);a.ajax({data:coursemostype+"=departments&institution="+b,url:d,success:function success(b){if(b.code==mesg.success){a.each(b.depts,function(a,b){h.append("<option value=\""+b.dept_code+"\">"+b.department+"</option>")})}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}else{h.prop("disabled",!0)}});a(".btn-user-detail").click(function(){var b=a(this).data("id");a.ajax({data:coursemostype+"=userDetail&id="+b,url:d,success:function success(b){if(b.code==mesg.success){a("#modal-user-detail .modal-title .fullname").text(b.fullname);a("#modal-user-detail .modal-body").html(b.html);a("#modal-user-detail").modal("show")}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})});a(".btn-enrol").click(function(){var b=a(this).data("id");window.open(f+"?id="+b,"asite_userenrol_"+b,"width=600, height=800, scrollbars=1")});a(".btn-log").click(function(){var b=a(this).data("id");window.open(a(this).attr("href"),"asite_log_"+b,"width=1300, height=800, scrollbars=1");return!1});a(".btn-aslogin").each(function(){var d=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("loginas","core"),body:M.util.get_string("as_login","local_ubion",d.data("username"))},d).done(function(a){a.setSaveButtonText(M.util.get_string("login","core"));a.getRoot().on(c.save,function(a){a.preventDefault();location.href=d.attr("href")})})});a(".btn-unlockuser").click(function(){var b=a(this),c=b.data("id");a.ajax({url:d,data:coursemostype+"=unlock&id="+c,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})},userBatch:function(){a("#add_form").validate({submitHandler:function submitHandler(b){a("#add_form .btn-submit").prop("disabled",!0);showSubmitProgress();b.submit()}})}}});
define ("local_ubion/asitePrivacy",["jquery","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery.filedownload"],function(a){return{index:function(){a(".asite-privacy .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})}}});
define ("local_ubion/asiteSite",["jquery","theme_coursemos/chart","theme_coursemos/bootstrap"],function(a,b){var c={};c.log=function(d,e){a(".asite-site-log .btn-useragent").popover({content:function content(){return a(this).closest("td").find(".popover-html").html()}});a(".asite-site-log .btn-data").click(function(){a(".asite-site-log .modal-data .modal-body-content").html(a(this).closest("td").find(".popover-html").html());a(".asite-site-log .modal-data").modal("show")});for(var f=[],g=0;g<=d.length;g++){f.push(c.randomColor(.5))}var h=!1,j=document.getElementById("myChart");if(null!==j){var k=j.getContext("2d");if(0<e.length){h=!0;new b(k,{type:"bar",data:{labels:d,datasets:[{data:e,backgroundColor:f}]},options:{legend:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}}if(!h){a("#myChart").hide()}};c.randomColor=function(a){var b=Math.round,c=Math.random;return"rgba("+b(c()*255)+","+b(c()*255)+","+b(c()*255)+","+a+")"};c.share=function(b){a(".asite-site-share-index .btn-share-courses").click(function(){var c=a(this).data("id");if(0<c){a.ajax({url:b,data:coursemostype+"=modules&id="+c,success:function success(b){if(b.code==mesg.success){a(".asite-site-share-index .modal-modules table tbody").html(b.html);a(".asite-site-share-index .modal-modules").modal("show")}else{alert(b.msg)}}})}return!1})};return c});
define ("local_ubion/asiteStats",["jquery","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery.filedownload"],function(a){var b={};b.dept=function(c){a(".form-search .form-control-year, .form-search .form-control-semester").change(function(){var d=a(".form-search .form-control-year").val(),e=a(".form-search .form-control-semester").val();a.ajax({url:c,data:coursemostype+"=groupCode&sesskey="+M.cfg.sesskey+"&year="+d+"&semester="+e,type:"post",success:function success(c){if(c.code==mesg.success){b.resetGroupCode();b.resetAllDept(1);a.each(c.group_codes,function(b,c){a(".form-control-groupcode").append("<option value=\""+c.group_code+"\">"+c.group_name+"</option>")})}else{alert(c.msg);return!1}return!0}});return!1});a(".form-search .form-control-groupcode").change(function(){var d=a(".form-search .form-control-year").val(),e=a(".form-search .form-control-semester").val(),f=a(this).val();if(""==f){b.resetAllDept(1)}else{a.ajax({url:c,data:coursemostype+"=dept01&sesskey="+M.cfg.sesskey+"&year="+d+"&semester="+e+"&group_code="+f,type:"post",success:function success(c){if(c.code==mesg.success){b.resetAllDept(1);a.each(c.depts,function(b,c){a(".form-control-dept01").append("<option value=\""+c.dept_code_01+"\">"+c.dept_name_01+"</option>")});a(".form-control-dept01").removeAttr("disabled")}else{alert(c.msg);return!1}return!0}})}return!1});a(".form-search .form-control-dept01").change(function(){var d=a(".form-search .form-control-year").val(),e=a(".form-search .form-control-semester").val(),f=a(".form-search .form-control-groupcode").val(),g=a(this).val();if(""==g){b.resetAllDept(2)}else{a.ajax({url:c,data:coursemostype+"=dept02&sesskey="+M.cfg.sesskey+"&year="+d+"&semester="+e+"&group_code="+f+"&dept_code_01="+g,type:"post",success:function success(c){if(c.code==mesg.success){b.resetAllDept(2);a.each(c.depts,function(b,c){a(".form-control-dept02").append("<option value=\""+c.dept_code_02+"\">"+c.dept_name_02+"</option>")});a(".form-control-dept02").removeAttr("disabled")}else{alert(c.msg);return!1}return!0}})}return!1})};b.resetAllDept=function(b){for(var c=b;4>=c;c++){if(0<a(".form-search .form-control-dept0"+c).length){a(".form-search .form-control-dept0"+c).find("option").remove();a(".form-search .form-control-dept0"+c).attr("disabled","disabled").append("<option value=\"\">ALL</option>")}}};b.resetGroupCode=function(){a(".form-control-groupcode option").remove();a(".form-control-groupcode").append("<option value=\"\">ALL</option>")};b.resetDept01=function(){a(".form-control-dept01 option").remove();a(".form-control-dept01").append("<option value=\"\">ALL</option>")};b.index=function(){a(".form-search .btn-excel").click(function(){var b=a(this).attr("href"),c=a(".form-search").serialize(),d="?";if(0<=b.indexOf("?")){d="&"}b+=d+c;a.fileDownload(b,{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})};b.progress=function(){a(".asite-stats .btn-popup").click(function(){var b=a(this).data("activity"),c=a(".asite-stats .form-hidden").attr("action"),d=a(".asite-stats .form-hidden input[name='year']").val(),e=a(".asite-stats .form-hidden input[name='semester']").val(),f=a(".asite-stats .form-hidden input[name='startdate']").val(),g=a(".asite-stats .form-hidden input[name='enddate']").val();window.open(c+"?year="+d+"&semester="+e+"&activity="+b+"&startdate="+f+"&enddate="+g,"stats_activity","width=1024, height=768")})};return b});
define ("local_ubion/assign",["jquery","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a){var b={best:function(b){a(".path-mod-assign .btn-assign-best").click(function(){window.open(M.cfg.wwwroot+"/local/ubion/mod/assign/best.php?id="+b,"assign_best","width=800, height=600, scrollbars=1")})},bestView:function(b){a(".path-mod-assign .btn-assign-best-view").click(function(){window.open(M.cfg.wwwroot+"/local/ubion/mod/assign/best_view.php?id="+b,"assign_best","width=800, height=600, scrollbars=1")})},bestForm:function(){a(".local-ubion-mod-assign .form-validate").validate({submitHandler:function submitHandler(b){var c=a(".local-ubion-mod-assign .form-validate input[name='oldbestcount']").val();if(0==c){if(0<a(".local-ubion-mod-assign .form-validate input[name='submissions[]']:checked").length){b.submit()}else{alert(M.util.get_string("assign_best_noselected","local_ubion"));return!1}}else{b.submit()}return!1}})},bestPopup:function(){a(".local-ubion-mod-assign .btn-close").click(function(){window.close()})}};b.comment=function(){a("#id_gradeheader .btn-feedback").click(function(){var c=a(this).data("userid");if(0<a(".path-mod-assign .modal-comment").length){a(".path-mod-assign .modal-comment").remove()}var d=b.commentModal(c,0);a(".path-mod-assign").append(d);a(".path-mod-assign .modal-comment").modal("show")})};b.commentQuick=function(c){a(".quickgradingform .btn-comment-"+c).click(function(){if(0<a(".path-mod-assign .modal-comment").length){a(".path-mod-assign .modal-comment").remove()}var d=b.commentModal(c,1);a(".path-mod-assign").append(d);a(".path-mod-assign .modal-comment").modal("show")})};b.commentGrade=function(c){a("#page-mod-assign-grade [data-comment='comment']").removeClass("btn-default").removeClass("btn-secondary").addClass("btn-info");a("#page-mod-assign-grade [data-comment='comment']").click(function(){if(0<a(".path-mod-assign .modal-comment").length){a(".path-mod-assign .modal-comment").remove()}var d=b.commentModal(c,0);a(".path-mod-assign").append(d);a(".path-mod-assign .modal-comment").modal("show")})};b.commentModal=function(a,b){var c="";c="<div class=\"modal modal-comment\" tabindex=\"-1\" role=\"dialog\">";c+="<div class=\"modal-dialog modal-xl\" role=\"document\">";c+="<div class=\"modal-content\">";c+="<div class=\"modal-header\">";c+="<h5 class=\"modal-title\">"+M.util.get_string("assign_feedback_load","local_ubion")+"</h5>";c+="<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">";c+="<span aria-hidden=\"true\">&times;</span>";c+="</button>";c+="</div>";c+="<div class=\"modal-body\">";c+="<iframe id=\"iframe-comment\" src=\""+M.cfg.wwwroot+"/local/ubion/mod/assign/comment_my.php?userid="+a+"&quick="+b+"\"></iframe>";c+="</div>";c+="</div>";c+="</div>";c+="</div>";return c};b.commentMy=function(c,d){b.apply(c,d);a(".local-ubion-mod-assign-comment .btn-delete").click(function(){if(confirm(M.util.get_string("assign_confirm_delete","local-ubion"))){var b={id:a(this).data("id"),userid:c,quick:d,deletesubmit:1};b[coursemostype]="delete";formSubmit(location.pathname,b)}})};b.commentLatest=function(a,c){b.apply(a,c)};b.apply=function(c,d){a(".local-ubion-mod-assign-comment .btn-apply").click(function(){var e=a(this).data("id"),f=a(".local-ubion-mod-assign-comment .comment-"+e).html();if(d){var g=a("#quickgrade_comments_"+c,parent.document),h=g.val();if(h!=f){g.parent().addClass("quickgrademodified")}g.val(f)}else{a("#id_assignfeedbackcomments_editoreditable",parent.document).html(f);a("#id_assignfeedbackcomments_editor",parent.document).val(f)}b.feedbackModalHide()});a(".local-ubion-mod-assign-comment .btn-apply-all").click(function(){var c=a(this).data("id"),d=a(".local-ubion-mod-assign-comment .comment-"+c).html(),e=a(".quickgradingform textarea.quickgrade",parent.document),f=e.val();if(f!=d){e.parent().addClass("quickgrademodified")}e.val(d);b.feedbackModalHide()})};b.commentAdd=function(){a(".local-ubion-mod-assign-comment .form-comment").validate({submitHander:function submitHander(b){a(b.courseid).val(a(".mform input[name='id']",parent.document).val());b.submit()}})};b.feedbackModalHide=function(){if(0<a(".path-mod-assign .modal-comment",parent.document).length){window.parent.$(".path-mod-assign .modal-comment").modal("hide")}else{a(".path-mod-assign .modal-comment").modal("hide")}};return b});
define ("local_ubion/code",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable"],function(a,b,c){var d={allChecked:function(b,c){a(".asite-code "+b).click(function(){var b=a(this).is(":checked");a(".asite-code "+c).each(function(){if(!a(this).is(":disabled")){this.checked=b}})})}};d.index=function(f){var g=a(".asite-code .modal-code"),h=g.find(".modal-form"),i=a(".asite-code .form-code"),j=i.find(".table-coursemos-sortable");a(".asite-code .btn-add").click(function(){g.find(".modal-title").text(M.util.get_string("code_add","local_ubion"));h.each(function(){this.reset()});h.find("input[name='"+coursemostype+"']").val("insert");d.readonly(h,!1);g.on("shown.bs.modal",function(){var a=h.find("input[name=\"code\"]");if(0<a.length){a.focus()}});g.modal("show")});a(".asite-code .btn-edit").click(function(){var b=a(this).closest("form"),c=a(this).closest("tr").data("id");a.ajax({url:b.attr("action"),data:coursemostype+"=view&id="+c+"&ctype="+f,success:function success(a){if(a.code==mesg.success){g.find(".modal-title").text(a.title);h.find("input[name='id']").val(c);h.find("input[name='"+coursemostype+"']").val("update");coursemosBindElement(h,a.data,[]);if(a.data.isdefault){d.readonly(h,!0)}g.modal("show")}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})});a(".asite-code .form-validate").validate({submitHandler:function submitHandler(b){showSubmitProgress();a(b).find("[disabled=\"disabled\"]").removeAttr("disabled");a.ajax({url:b.action,data:d.serializeAndDecode(a(b)),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}});a(".asite-code .btn-delete").each(function(){var d=a(this),g=a(this).closest("form"),h=a(this).closest("tr"),i=h.data("id");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("code_confirm_delete","local_ubion",{code:h.find(".code-code").text(),name:h.find(".code-name").text()})},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:g.attr("action"),data:coursemostype+"=delete&id="+i+"&ctype="+f,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})});a(".asite-code .btn-checked-delete").click(function(){var d=a(".asite-code .form-code .chk-ids:checked").length;if(0<d){var e=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("code_confirm_checkdelete","local_ubion",d)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({url:i.attr("action"),data:i.serialize(),success:function success(a){hideSubmitProgress();if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});e.trigger("click")}else{alert(M.util.get_string("min_check","local_ubion",1))}});j.sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",handle:".moveicon",placeholder:"<tr class=\"placeholder\"/>",onDrop:function onDrop(b,c,d){d(b,c);var e=c.el.find("> tbody"),f=1;e.find("tr").each(function(){a(this).find("td.td-number").text(f);f++});var g=j.sortable("serialize").get(),h=JSON.stringify(g,null," ");a.ajax({data:coursemostype+"=sortorder&json="+h,url:i.attr("action"),success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(){alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})}})};d.readonly=function(b,c){var d;a.each(["code","depth"],function(a,e){d=b.find("input[name='"+e+"'], select[name='"+e+"']");if(c){d.attr("disabled","disabled")}else{d.removeAttr("disabled")}})};d.serializeAndDecode=function(b){return a.map(b.serializeArray(),function(a){return[a.name,decodeURIComponent(a.value)].join("=")}).join("&")};return d});
define ("local_ubion/course",["jquery","core/event","core/modal_factory","core/modal_events","theme_coursemos/jquery.validate"],function(a,b,c,d){var f={isSectionConfirm:!1,settingForm:function(b){c.create({type:c.types.SAVE_CANCEL,title:M.util.get_string("course_section_sync","local_ubion"),body:M.util.get_string("course_section_sync_confirm","local_ubion")},a("#id_btn-section-summary-sync")).done(function(c){c.setSaveButtonText(M.util.get_string("course_section_sync","local_ubion"));c.getRoot().on(d.save,function(d){d.preventDefault();showSubmitProgress();a.ajax({url:"setting.php",data:coursemostype+"=sectionSummarySync&courseid="+b,success:function success(a){if(a.code==mesg.success){alert(a.msg);location.href=M.cfg.wwwroot+"/course/view.php?id="+b}else{alert(a.msg)}c.hide();hideSubmitProgress()},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})});c.create({type:c.types.SAVE_CANCEL,title:M.util.get_string("course_grade_category_sync","local_ubion"),body:M.util.get_string("course_grade_category_sync_confirm","local_ubion")},a("#id_btn-grade-category-sync")).done(function(c){c.setSaveButtonText(M.util.get_string("course_grade_category_sync","local_ubion"));c.getRoot().on(d.save,function(d){d.preventDefault();showSubmitProgress();a.ajax({url:"setting.php",data:coursemostype+"=gradeCategorySync&courseid="+b,success:function success(a){if(a.code==mesg.success){alert(a.msg);location.href=M.cfg.wwwroot+"/grade/edit/tree/index.php?id="+b}else{alert(a.msg)}c.hide();hideSubmitProgress()},error:function error(){hideSubmitProgress();alert(M.util.get_string("ajax_error","local_ubion"));location.reload()}})})})}};f.modForm=function(){a("#id_section").change(function(){a("#id_updatesection").trigger("click");return!1});a(".mform[action=\"modedit.php\"]").submit(function(b){var e=!0;if("undefined"!=typeof skipClientValidation){e=!skipClientValidation}var g=a(b.target).find("input[name=\"update\"]").val(),h=a("#id_section"),i="modform_section_confirm",j=0==h.val()?!0:!1;if(0<g){if(0!=h.data("section")&&j){j=!0;i="modform_section_change_confirm"}else{j=!1}}if(j&&e){if(!f.isSectionConfirm){var k=a("<button type=\"button\"></button>"),l=a("#id_section option:selected").text();c.create({type:c.types.SAVE_CANCEL,title:M.util.get_string("modform_section","local_ubion"),body:M.util.get_string(i,"local_ubion",l)},k).done(function(c){c.setSaveButtonText(M.util.get_string("confirm","core"));c.getRoot().on(d.save,function(){f.isSectionConfirm=!0;a(b.target).submit()});c.getRoot().on(d.cancel,function(){h.focus()})});k.trigger("click");b.preventDefault();b.stopPropagation();b.stopImmediatePropagation();return!1}}return!0})};f.syllabus=function(b,c){a(".local-ubion-course-syllabus .btn-syllabus-link").click(function(){window.open(a(this).attr("href"),"syllabus","width="+b+", height="+c+", scrollbars=yes");return!1})};return f});
define ("local_ubion/finalGrade",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery.filedownload"],function(a,b,c){var d={overrideClass:"form-control-override",setting:function(d){b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("grade_setting_reset","local_ubion"),body:M.util.get_string("grade_setting_reset_confirm","local_ubion")},a(".local-ubion-finalgrade .btn-setting-reset")).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("grade_setting_reset","local_ubion"));b.getRoot().on(c.save,function(b){b.preventDefault();var c=coursemostype+"=settingReset&id="+d;a.ajax({url:"action.php",data:c,success:function success(a){if(a.code==mesg.success){location.replace(a.href)}else{alert(a.msg)}}})})})},default:function(){a(".form-default-setting .form-change-save").change(function(){a.ajax({url:a(".form-default-setting").attr("action"),data:a(".form-default-setting").serialize(),success:function success(a){if(a.code!=mesg.success){alert(a.msg)}}})})}};d.index=function(f){a(".local-ubion-finalgrade .btn-grade-reflect").each(function(){var d=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("grade_reflect","local_ubion"),body:M.util.get_string("grade_reflect_confirm","local_ubion")},d).done(function(a){a.setSaveButtonText(M.util.get_string("grade_reflect","local_ubion"));a.getRoot().on(c.save,function(a){a.preventDefault();showSubmitProgress();var b={id:f};b[coursemostype]="reflect";formSubmit("action.php",b)})})});a(".local-ubion-finalgrade .btn-grade-log").click(function(){a(".local-ubion-finalgrade .modal-log").modal("show")});a(".local-ubion-finalgrade .form-search .form-control-autosubmit").change(function(){a(".local-ubion-finalgrade .form-search").submit()});a(".local-ubion-finalgrade .table-finalgrade select.form-control").change(function(){d.checkGradeOverride(a(this))});a(".local-ubion-finalgrade .btn-grade-override").click(function(){a(".local-ubion-finalgrade .table-finalgrade select.form-control").each(function(){d.checkGradeOverride(a(this))});var e=a(".local-ubion-finalgrade .table-finalgrade ."+d.overrideClass).length;if(0<e){var f=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("grade_finalgrade","local_ubion"),body:M.util.get_string("grade_override_user","local_ubion",e)},f).done(function(b){b.setSaveButtonText(M.util.get_string("grade_override_save","local_ubion"));b.getRoot().on(c.save,function(b){b.preventDefault();a(".local-ubion-finalgrade .table-finalgrade select.form-control").each(function(){if(!a(this).hasClass(d.overrideClass)){a(this).attr("disabled","disalbed")}});a(".local-ubion-finalgrade .form-finalgrade").submit()})});f.trigger("click")}else{alert(M.util.get_string("grade_override_user_noselect","local_ubion"));return!1}return!1});a(".local-ubion-finalgrade .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})};d.checkGradeOverride=function(b){var c=a(b).val(),e=a(b).closest("tr"),f=a(b).data("userid"),g=e.find(".user-letter-"+f).text(),h=e.find(".input-oldvalue-"+f).val();if(c!=g||c!=h){if(!a(b).hasClass(d.overrideClass)){a(b).addClass(d.overrideClass)}}else{a(b).removeClass(d.overrideClass)}};d.letterEdit=function(b,c){a(".local-ubion-finalgrade .form-validate").validate();a(".local-ubion-finalgrade .btn-letter-add").click(function(){var d=a(".local-ubion-finalgrade .table-letter tbody tr:last").data("rownum"),e=1;if(d!==void 0){e=parseInt(d)+1}var f=a("<tr>").attr("data-rownum",e),g=a("<td>").addClass("text-center"),h=a("<input>").attr("type","text").attr("name","letter_"+e).attr("value","").attr("class","required form-control form-control-letter").attr("placeholder",M.util.get_string("grade_letter","local_ubion"));h.rules("add",{required:!0});g.append(h);f.append(g);g=a("<td>").addClass("text-center").html(c);f.append(g);g=a("<td>").addClass("text-center");h=a("<input>").attr("type","number").attr("name","letter_grade_"+e).attr("value","").attr("class","required number form-control form-control-grade").attr("min",0).attr("max",100).attr("placeholder",b);g.append(h).append("<span class=\"percent\"> %</span>");f.append(g);g=a("<td>").addClass("text-center");h=a("<button>").attr("type","button").attr("class","btn btn-danger btn-sm btn-delete").text(M.util.get_string("delete","core"));h.click(function(){a(this).closest("tr").remove()});g.append(h);f.append(g);a(".local-ubion-finalgrade .table-letter tbody:last").append(f);a(".local-ubion-finalgrade .table-letter tbody input[name='letter_"+e+"']").focus()});a(".local-ubion-finalgrade .btn-delete").click(function(){a(this).closest("tr").remove()})};return d});
define ("local_ubion/gradeCategoryManagement",["jquery","core/modal_factory","core/modal_events","theme_coursemos/jquery.validate","theme_coursemos/bootstrap"],function(a,b,c){var d={elDelete:".local-ubion-grade-category .table-grade-category .btn-delete",elGradeMax:".local-ubion-grade-category .table-grade-category input[data-name=\"grademax\"]",elTotalGrade:".local-ubion-grade-category .table-grade-category .total-grademax",elSave:".local-ubion-grade-category .table-grade-category .btn-all-save",elSaveTooltip:".local-ubion-grade-category .table-grade-category .all-save-tooltip"};d.index=function(f,g,h,i){a(".local-ubion-grade-category .form-grade-category-all").validate();var j=1;a(".local-ubion-grade-category .btn-add").click(function(){var b=a(".local-ubion-grade-category .table-grade-category tbody"),c=b.find("tr.tr-default").clone();c.removeAttr("class");c.find("input").each(function(b,c){a(c).removeAttr("readonly");a(c).attr("name","new_"+a(c).data("name")+"["+j+"]");if("checkbox"==a(c).attr("type")){a(c).prop("checked",!1)}});b.append(c);c.find("input:first").focus();j++});a(document).on("click",d.elDelete,function(){var e=a(this),j=e.closest("tr"),k=j.find("input[data-name=\"categoryname\"]").val();if(""!=k){var l=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("grade_category_confirm_delete","local_ubion",k)},l).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(a){a.preventDefault();j.remove();b.hide();d.checkSumGrade(f,g,h,i)})});l.trigger("click")}else{j.remove()}});a(document).on("keyup",d.elGradeMax,function(){d.checkSumGrade(f,g,h,i)});d.checkSumGrade(f,g,h,i);a(document).on("click",d.elGradeMax,function(){if(""!==a(this).val()){a(this).select();a(this).focus()}})};d.checkSumGrade=function(b,c,e,f){var g=0,h=!0,i=a(d.elTotalGrade),j=a(d.elSave),k=a(d.elSaveTooltip);a(d.elGradeMax).each(function(){var d=a(this).val(),e=!0,f=null;if(""!=d){d=parseFloat(d);if(d>c){f=M.util.get_string("grade_category_valid_max","local_ubion",c)}else if(d<b){f=M.util.get_string("grade_category_valid_min","local_ubion",b)}else{e=!1}if(e){alert(f);a(this).val("0");a(this).select();a(this).focus();h=!1;return!1}else{g+=parseFloat(a(this).val())}}return!0});if(h){if(g!=e){i.removeClass("text-primary").addClass("text-danger");j.attr("disabled","disabled");k.tooltip()}else{i.removeClass("text-danger").addClass("text-primary");j.removeAttr("disabled");k.tooltip("dispose")}i.text(g.toFixed(f))}};return{index:d.index}});
define ("local_ubion/user",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery-sortable"],function(a,b,c){return{index:function(){a(".course-regular .form-search select[name='year']").change(function(){var b=a(this).val();if("-1"==b){a(".course-regular .form-search select[name='semester'] option:eq(0)").prop("selected","selected");a(".course-regular .form-search select[name='semester']").attr("disabled","disabled")}else{a(".course-regular .form-search select[name='semester']").removeAttr("disabled")}})},mycourseSetting:function(b,c,d){a(".local-ubion-user-mycourse-setting .table-coursemos-sortable").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",handle:".i-move",placeholder:"<tr class=\"placeholder\"/>",onDrop:function onDrop(c,d,e){e(c,d);var f="",g="",h=d.el.find("> tbody");h.find("tr").each(function(){var b=a(this).data("courseid");if(b){f+=g+b;g="^"}});var i=coursemostype+"=courseSortable&courseidx="+f;a.ajax({url:b,data:i,type:"post",success:function success(a){if(a.code!=mesg.success){alert(a.msg)}}})}});a(".local-ubion-user-mycourse-setting .btn-course-view").click(function(){var e=a(this),f=e.closest("tr"),g=f.data("courseid"),h=e.attr("data-visible");a.ajax({url:b,data:coursemostype+"=mycourseVisible&courseid="+g+"&visible="+h,type:"post",success:function success(a){if(a.code==mesg.success){if(1==h){e.attr("data-visible",0).removeClass(c).addClass(d).text(M.util.get_string("screen_view_hide","local_ubion"));e.closest("tr").addClass("disabled")}else{e.attr("data-visible",1).removeClass(d).addClass(c).text(M.util.get_string("screen_view_show","local_ubion"));e.closest("tr").not(".disabled-coursehide").removeClass("disabled")}}else{alert(a.msg)}}})})},edit:function(){a("#page-user-edit .btn-usersync").click(function(){var d=a(this),e=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("user_sync","auth_univ"),body:M.util.get_string("user_sync_confirm","auth_univ")},e).done(function(a){a.setSaveButtonText(M.util.get_string("user_sync","auth_univ"));a.getRoot().on(c.save,function(a){a.preventDefault();var b={userid:d.data("userid")};b[coursemostype]="userSync";formSubmit("editAction.php",b)})});e.trigger("click")})}}});
define ("local_ubmanual/manual",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap"],function(a,b,c){return{modForm:function(){a(".local-ubmanual-edit .mform button[data-default-type]").each(function(){var d=a(this);b.create({type:b.types.SAVE_CANCEL,title:a(d).text(),body:M.util.get_string("confirm_default_manual","local_ubmanual")},d).done(function(b){b.setSaveButtonText(M.util.get_string("apply","local_ubmanual"));b.getRoot().on(c.save,function(b){b.preventDefault();a("#id_updateManual"+a(d).data("default-type")).trigger("click")})})})}}});
define ("local_ubmenu/menu",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable"],function(a,b,c){var d={pluginname:"local_ubmenu"};d.management=function(f){var m=a(".local-ubmenu-management ul.menu").sortable({handle:".moveicon",onDrop:function onDrop(b,c,d){d(b,c);if(c.el.closest("ul").hasClass("menu")){if(0==b.find("ul").length){b.append("<ul></ul>")}}else{if(0<b.find("ul").length){b.find("ul").remove()}}a(".local-ubmenu-management .div-save").show()},isValidTarget:function isValidTarget(a,b){if(0<a.find("li").length){if(b.target.hasClass("menu")||b.target.hasClass("menu-container")){return!0}else{return!1}}return!0}});a(".btn-menu-add").click(function(){a("#modal-menu .modal-title").text(M.util.get_string("add",d.pluginname));a("#modal-menu form").each(function(){this.reset()});a("#modal-menu form input[name='parentid']").val("");a("#modal-menu form input[name='"+coursemostype+"']").val("insert");h();j();l();a("#modal-menu .form-group-collapseyn").show();a("#modal-menu").modal("show")});a("form.form-validate").validate({submitHandler:function submitHandler(b){a(b).find(":disabled").removeAttr("disabled");a.ajax({data:a(b).serialize(),url:M.cfg.wwwroot+"/local/ubmenu/action.php",success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});a(".local-ubmenu-management .btn-menu-insert").click(function(){if(a(this).closest("ul").hasClass("menu")){var b=a(this).closest("li").data("id");a("#modal-menu form").each(function(){this.reset()});a("#modal-menu form input[name='"+coursemostype+"']").val("insert");a("#modal-menu form input[name='parentid']").val(b);j();l();a("#modal-menu").modal("show")}else{alert(M.util.get_string("notsubmenu",d.pluginname))}});a(".local-ubmenu-management .btn-menu-update").click(function(){var b=a(this).closest("li").data("id"),c=a(this).closest("ul").hasClass("menu");a.ajax({data:coursemostype+"=view&id="+b+"&courseid="+f,url:M.cfg.wwwroot+"/local/ubmenu/action.php",success:function success(b){if(b.code==mesg.success){a("#modal-menu .modal-title").text(M.util.get_string("modify_title",d.pluginname,b.menu.fullname));a("#modal-menu form input[name='"+coursemostype+"']").val("update");j();if(c){k()}else{l()}coursemosBindElement(a("#modal-menu form"),b.menu,["courseid"]);a.each(b.menu.nameJsonDecode,function(b,c){a("#modal-menu form [name='lang-"+b+"']").val(c)});if(1<f){if(0==b.menu.courseid){i()}}}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}});a("#modal-menu").modal("show")});a(".local-ubmenu-management .btn-menu-delete").each(function(){var e=a(this),g=e.closest("li");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("delete_confirm",d.pluginname,g.find("> .menu-name").text())},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(c){c.preventDefault();a.ajax({data:coursemostype+"=delete&id="+g.data("id")+"&courseid="+f,url:M.cfg.wwwroot+"/local/ubmenu/action.php",success:function success(a){if(a.code==mesg.success){g.remove();b.hide()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});a(".local-ubmenu-management .btn-menu-save").click(function(){var b=m.sortable("serialize").get(),c=JSON.stringify(b,null," ");a.ajax({data:coursemostype+"=sortorder&courseid="+f+"&json="+c,url:M.cfg.wwwroot+"/local/ubmenu/action.php",success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})});a(".content-submenu .nav-submenu .nav-link").each(function(){var b=g(a(this).attr("href"),"courseid"),c=!1;if(1==f){c=null===b?!0:!1}else if(0==f){c=b==f?!0:!1}if(c){a(this).addClass("active")}else{a(this).removeClass("active")}var e=1==f?"menu_site":"menu_course";e=M.util.get_string(e,d.pluginname);a(".content-breadcrumb h2").text(e)});function g(a,b){return(RegExp(b+"=(.+?)(&|$)").exec(a)||["",null])[1]}function h(){a("#modal-menu form input[name='name']").removeAttr("disabled");a("#modal-menu form input[name='url']").removeAttr("disabled");a("#modal-menu form input[name='blank']").removeAttr("disabled");a("#modal-menu form input[name='viewlevel']").removeAttr("disabled");a("#modal-menu form input[name='collapse']").removeAttr("disabled")}function i(){a("#modal-menu .form-group-name").hide();a("#modal-menu .form-group-url").hide();a("#modal-menu .form-group-viewlevel").hide();a("#modal-menu .form-group-collapseyn").hide()}function j(){a("#modal-menu .form-group-name").show();a("#modal-menu .form-group-url").show();a("#modal-menu .form-group-viewlevel").show();a("#modal-menu .form-group-useyn").show();a("#modal-menu .form-group-collapseyn").show()}function k(){a("#modal-menu .form-group-collapseyn").show()}function l(){a("#modal-menu .form-group-collapseyn").hide()}};d.syllabus=function(b,c){a(".block-coursemos-menu a.syllabus").click(function(){window.open(a(this).attr("href"),"syllabus","width="+b+", height="+c+", scrollbars=yes");return!1})};return d});
define ("local_uboffattend/attendance",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/timer.jquery","theme_coursemos/jquery.filedownload","theme_coursemos/jquery.tableHeadFixer","theme_coursemos/bootstrap-datepicker"],function(a,b,c){var d={pluginname:"local_uboffattend"};d.index=function(e,f,g,h){a("#attendance_week").change(function(){var b={},c=location.search.substring(1),d;while(d=/([^&=]+)=([^&]*)/g.exec(c)){b[decodeURIComponent(d[1])]=decodeURIComponent(d[2])}b.week=a(this).val();b.period="";location.search=a.param(b)});a("#attendance_period").change(function(){location_search("period",a(this).val())});a(".local-uboffattend .form-search .form-control-listsize").change(function(){location_search("ls",a(this).val())});a(".local-uboffattend .form-search .form-control-group").change(function(){location_search("groupid",a(this).val())});a(".local-uboffattend .form-search .search").click(function(){var b={},c=location.search.substring(1),d;while(d=/([^&=]+)=([^&]*)/g.exec(c)){b[decodeURIComponent(d[1])]=decodeURIComponent(d[2])}b.keyfield=a(".local-uboffattend .form-search .keyfield").val();b.keyword=a(".local-uboffattend .form-search input[name='keyword']").val();location.search=a.param(b)});a(".local-uboffattend .form-search .btn-search-cancel").click(function(){var b={},c=location.search.substring(1),d;while(d=/([^&=]+)=([^&]*)/g.exec(c)){b[decodeURIComponent(d[1])]=decodeURIComponent(d[2])}b.keyfield="";b.keyword="";location.search=a.param(b)});a(".local-uboffattend .form-batch").validate({submitHandler:function submitHandler(f){var g="";if("99"==f.allstatus.value){g=M.util.get_string("attendance_reset_confirm",d.pluginname)}else{var h=a(f).find("[name=\"allstatus\"]:checked").parent().find(".form-check-label").text();g=M.util.get_string("confirm_batch_message",d.pluginname,h)}var i=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("batch_process",d.pluginname),body:g},i).done(function(b){b.setSaveButtonText(M.util.get_string("batch_process",d.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({data:a(f).serialize(),url:a(f).attr("action"),success:function success(a){if(a.code==mesg.success){alert(a.msg);location.replace(a.returnurl)}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})});i.trigger("click");return!1}});a(".local-uboffattend .form-user-attendance").validate({submitHandler:function submitHandler(f){var g=a(".local-uboffattend .table-uboffattend tbody tr").length,h=a("input[name^=user_status]:checked").length;if(0<h){var i=g-h;if(0<i){var j=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("attendance_status",d.pluginname),body:M.util.get_string("not_selected_user_confirm",d.pluginname,i)},j).done(function(a){a.getRoot().on(c.save,function(a){a.preventDefault();f.submit()})});j.trigger("click")}else{f.submit()}}else{alert(M.util.get_string("not_selected_user",d.pluginname))}return!1}});a(".local-uboffattend .form-user-attendance input."+h).change(function(){var b=a(this).attr("name").replace(/[^0-9]/g,""),c=coursemostype+"=status&userid="+b+"&attid="+f+"&id="+e+"&status="+a(this).val();a.ajax({data:c,url:g,success:function success(){return!0},error:function error(a,b,c){alert(a.status+" : "+c)}});return!1})};d.week=function(f,g,h){a(".week_manage .btn-add").click(function(){a(".modal-week form").each(function(){this.reset()});a(".modal-week form input[name='"+coursemostype+"']").val("insert");var b=M.util.get_string("week_add",d.pluginname);a(".modal-week .modal-header h3").text(b);a(".modal-week .modal-footer .btn-week-addmodify").text(b);a(".modal-week").modal("show")});a(".week_manage .btn-update").click(function(){a(".modal-week form").each(function(){this.reset()});var b=M.util.get_string("week_modify",d.pluginname);a(".modal-week .modal-header h3").text(b);a(".modal-week .modal-footer .btn-week-addmodify").text(b);var c=a(this).closest("tr"),e=c.data("id");if(e){var f=a("#week_name_"+e).text();a("#week_name").val(f);a(".modal-week form input[name='attid']").val(e);a(".modal-week form input[name='"+coursemostype+"']").val("update");a(".modal-week .form-datepicker").val(c.data("week"));var g=c.data("supplement");if(1==g){a(".modal-week form input[name='supplement']").prop("checked",!0)}a(".modal-week form select[name='period']").val(c.data("period"))}a(".modal-week").modal("show")});a(".week_manage .btn-delete").each(function(){var e=a(this),f=a(this).closest("tr"),g=f.data("id"),i=f.data("weekname"),j=f.data("period");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_week_delete",d.pluginname,{week:i,period:j})},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a(".modal-week form input[name='attid']").val(g);a(".modal-week form input[name='"+coursemostype+"']").val("delete");a.ajax({data:a(".modal-week form").serialize(),url:h,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg)}}})})})});b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("week_reset",d.pluginname),body:M.util.get_string("confirm_week_reset",d.pluginname)},a(".week_manage .btn-week-reset")).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("week_reset",d.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=reset&id="+f,url:h,success:function success(a){if(a.code==mesg.success){location.replace(a.href)}else{alert(a.msg)}}})})});a(".modal-week .form-validate").validate({submitHandler:function submitHandler(b){a.ajax({data:a(b).serialize(),url:h,success:function success(b){if(b.code==mesg.success){a(".modal-week").modal("hide");location.replace(location.href)}else{alert(b.msg)}}});return!1},invalidHandler:function invalidHandler(){hideSubmitProgress()}})};d.grade=function(){a(".grade_form form").validate()};d.report=function(f,g,h,i){a(".local-uboffattend .form-search .form-control-listsize").change(function(){location_search("ls",a(this).val())});a(".local-uboffattend .form-search .form-control-group").change(function(){location_search("groupid",a(this).val())});a(".local-uboffattend .autoscroll .table").tableHeadFixer({head:!1,left:4});b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("apply_grade",d.pluginname),body:M.util.get_string("confirm_apply_grade",d.pluginname)},a(".local-uboffattend .excel .btn-apply-grade")).done(function(b){b.setSaveButtonText(M.util.get_string("apply_grade",d.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();var c=coursemostype+"=applyGrade&id="+f;a.ajax({data:c,url:i,type:"post",success:function success(b){if(b.code==mesg.success){if(0<b.error_lists.length){var c="",d="";a.each(b.error_lists,function(a,b){c=d+b+c;d="\n"});alert(c)}location.replace(location.href)}else{hideSubmitProgress();alert(b.msg)}}})})});a(".local-uboffattend .btn-auto-attempt").click(function(){var b=a(this).attr("data-userid"),c=a(this).attr("data-attid");a.ajax({data:coursemostype+"=autoUserAttempt&id="+f+"&attid="+c+"&userid="+b+"&sesskey="+M.cfg.sesskey,url:i,type:"post",success:function success(b){if(b.code==mesg.success){a("#modal-user-attemp .table tbody").empty();a("#modal-user-attemp .table tbody").append(b.html);a("#modal-user-attemp").modal("show")}else{alert(b.msg)}}})});a(".local-uboffattend .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1});a(".local-uboffattend .table-attendance td").addClass("td-title-55")};d.my=function(b,c){a(".table-my-attendance .btn-auto-attempt").click(function(){var d=a(this).attr("data-attid");a.ajax({data:coursemostype+"=autoUserAttempt&id="+b+"&attid="+d+"&sesskey="+M.cfg.sesskey,url:c,type:"post",success:function success(b){if(b.code==mesg.success){a("#modal-user-attemp .table tbody").empty();a("#modal-user-attemp .table tbody").append(b.html);a("#modal-user-attemp").modal("show")}else{alert(b.msg)}}})})};d.settingWeek=function(b){a(".form-attendance-setting").validate({submitHandler:function submitHandler(){var c=coursemostype+"=setting&"+a(".form-attendance-setting").serialize();formSubmit(b,c)}});a(".btn-preview").click(function(){if(a(".form-attendance-setting").valid()){var c=coursemostype+"=preview&"+a(".form-attendance-setting").serialize();a.ajax({data:c,url:b,success:function success(b){if(b.code==mesg.success){a("#modal-preview .tbody").empty();a("#modal-preview .tbody").append(b.html);a("#modal-preview").modal("show")}else{alert(b.msg)}}})}return!1})};return d});
define ("local_uboffattend/autoattendance",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/timer.jquery"],function(a,b,c){var d={pluginname:"local_uboffattend"};d.index=function(f,g,h){if(0<a(".local-uboffattend .form-group-autoattendance .help-time").length){var i=a(".local-uboffattend .form-group-autoattendance .help-time").attr("data-duration"),j=a(".local-uboffattend .form-group-autoattendance .help-time").attr("data-format");a(".local-uboffattend .form-group-autoattendance .help-time .time").timer({countdown:!0,duration:i,format:j,callback:function callback(){var b=a(".local-uboffattend .form-group-autoattendance .btn-auto-attendance-end").attr("data-autoid");a(".local-uboffattend .form-group-autoattendance .btn-auto-attendance-end").remove();a(".local-uboffattend .form-group-autoattendance .help-inline").remove();a(".local-uboffattend .form-group-autoattendance .col-xs-10").append("<div class=\"help-block help-block-noelement\"><span class= \"text-info\" > "+M.util.get_string("auto_attendance_end_complete",d.pluginname)+"</span></div >");a.ajax({data:coursemostype+"=autoAttemptTimeEnd&sesskey="+M.cfg.sesskey+"&id="+f+"&autoid="+b,url:h,success:function success(b){if(b.code==mesg.success){a("#modal-auto-attendance-result .help-total span").text(b.countInfo.total);a("#modal-auto-attendance-result .help-attendance span").text(b.countInfo.attendance);a("#modal-auto-attendance-result .help-absence span").text(b.countInfo.absence);a("#modal-auto-attendance-result").modal("show")}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}})}a(".local-uboffattend .form-group-autoattendance .btn-auto-attendance").click(function(){a("#modal-auto-attendance-setting").modal("show")});a("#modal-auto-attendance-setting .form-validate").validate({submitHandler:function submitHandler(b){showSubmitProgress();a.ajax({data:a(b).serialize(),url:h,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{hideSubmitProgress();alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}});return!1}});var k=a(".local-uboffattend .form-group-autoattendance .btn-auto-attendance-end");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("auto_attendance_end",d.pluginname),body:M.util.get_string("auto_attendance_end_confirm",d.pluginname)},k).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("auto_attendance_end",d.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();var c=k.data("autoid");a.ajax({data:coursemostype+"=autoAttemptEnd&id="+f+"&autoid="+c,url:h,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}location.replace(location.href)},error:function error(a,b,c){alert(a.status+" : "+c)}})})});a("#modal-auto-attendance-result").on("hidden.bs.modal",function(){location.replace(location.href)});a(".local-uboffattend .btn-auto-attempt").click(function(){var b=a(this).attr("data-userid");a.ajax({data:coursemostype+"=autoUserAttempt&id="+f+"&attid="+g+"&userid="+b+"&sesskey="+M.cfg.sesskey,url:h,type:"post",success:function success(b){if(b.code==mesg.success){a("#modal-user-attemp .table tbody").empty();a("#modal-user-attemp .table tbody").append(b.html);a("#modal-user-attemp").modal("show")}else{alert(b.msg)}}})})};d.answer=function(){var b=a(".local-uboffattend-auto .help-time").attr("data-duration"),c=a(".local-uboffattend-auto .help-time").attr("data-format");a(".local-uboffattend-auto .help-time .time").timer({countdown:!0,duration:b,format:c,callback:function callback(){location.replace(location.href)}});a(".local-uboffattend-auto .form-validate").validate();a(".local-uboffattend-auto .form-validate input[name='authkey']").focus()};d.manage=function(f,g,h,i,j){function k(b){var c=a(b.target);c.removeClass("btn-override, btn-info").addClass("btn-override-cancel, btn-danger").text(M.util.get_string("override_attendance_cancel",d.pluginname));c.off("click");var e=c.attr("data-userid"),f=c.attr("data-autoid");m(e,f,i);c.on("click",l)}function l(b){var c=a(b.target);c.removeClass("btn-override-cancel, btn-danger").addClass("btn-override, btn-info").text(M.util.get_string("override_attendance",d.pluginname));c.off("click");var e=c.attr("data-userid"),f=c.attr("data-autoid");m(e,f,j);c.on("click",k)}function m(b,c,d){a.ajax({data:coursemostype+"=autoStatusOverride&id="+f+"&attid="+h+"&autoid="+c+"&userid="+b+"&status="+d+"&sesskey="+M.cfg.sesskey,url:g,type:"post",success:function success(a){if(a.code!=mesg.success){alert(a.msg)}}});a("#modal-users .input-refresh").val(1)}a(".local-uboffattend-auto .btn-users").click(function(){var b=a(this).attr("data-autoid"),c=a(this).attr("data-viewtype");a.ajax({data:coursemostype+"=autoAttemptResult&id="+f+"&attid="+h+"&viewtype="+c+"&autoid="+b+"&sesskey="+M.cfg.sesskey,url:g,type:"post",success:function success(b){if(b.code==mesg.success){a("#modal-users .modal-title").text(b.title);a("#modal-users .modal-body .row-users").empty();a("#modal-users .modal-body .row-users").append(b.html);a("#modal-users .btn-override").on("click",k);a("#modal-users .btn-override-cancel").on("click",l);a("#modal-users").modal("show")}else{alert(b.msg)}}})});a("#modal-users").on("hidden.bs.modal",function(){var b=a("#modal-users .input-refresh").val();if(1==b){location.replace(location.href)}});a(".local-uboffattend-auto .btn-attempt-delete").each(function(){var i=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("auto_attendance_attempt_delete_confirm",d.pluginname,i.data("attempt"))},i).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();var c=i.data("autoid");a.ajax({data:coursemostype+"=autoAttemptDelete&id="+f+"&attid="+h+"&autoid="+c+"&sesskey="+M.cfg.sesskey,url:g,type:"post",succes:function succes(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg)}}})})})})};return d});
define ("local_ubonattend/attendance",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery.filedownload","theme_coursemos/jquery.tableHeadFixer"],function(a,b,c){var d={pluginname:"local_ubonattend"};d.report=function(f,g,h,i){a(".local-ubonattend .form-search .form-control-listsize").change(function(){location_search("ls",a(this).val())});a(".local-ubonattend .form-search .form-control-group").change(function(){location_search("groupid",a(this).val())});a(".local-ubonattend .table-online-attendance").tableHeadFixer({head:!1,left:g});a(".local-ubonattend .btn-excel").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1});b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("apply_grade",d.pluginname),body:M.util.get_string("confirm_apply_grade",d.pluginname)},a(".local-ubonattend .btn-apply-grade")).done(function(b){b.setSaveButtonText(M.util.get_string("apply_grade",d.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();var c=coursemostype+"=applyGrade&id="+f;a.ajax({data:c,url:h,type:"post",success:function success(b){if(b.code==mesg.success){if(0<b.error_lists.length){var c="",d="";a.each(b.error_lists,function(a,b){c=d+b+c;d="\n"});alert(c)}location.replace(location.href)}else{hideSubmitProgress();alert(b.msg)}}})})});var j="<div class=\"tooltip\" role=\"tooltip\"><div class=\"arrow\"></div><div class=\"tooltip-inner progress-reulsts ";if(0<i)j+=" islate";j+="\"></div></div>";a(".progress_tooltip").tooltip({html:!0,template:j})};d.userStatus=function(f,g,h){a(".local-ubonattend .modal-attempt").on("shown.bs.modal",function(){a(".local-ubonattend .modal-attempt [data-toggle='tooltip']").tooltip()});a("#modal-track-detail").on("shown.bs.modal",function(){a("#modal-track-detail [data-toggle='tooltip']").tooltip()});a(".local-ubonattend .btn-attempt").not(".disabled").click(function(){var b=a(this).data("cmid");if(b){var c=coursemostype+"=attempts&id="+f+"&userid="+g+"&cmid="+b;a.ajax({data:c,url:h,success:function success(b){if(b.code==mesg.success){var c=".modal-attempt";if(b.isVideoMeeting){c=".modal-attempt-video-meeting"}a(".local-ubonattend "+c+" .modal-title").text(b.title);a(".local-ubonattend "+c+" .moduleInfoTable").html(b.moduleInfoTable);a(".local-ubonattend "+c+" .table-progress-lists tbody").html(b.html);a(".local-ubonattend "+c+" .cumulative-title").html(b.cumulativeTitle);a(".local-ubonattend "+c+" .cumulative-help").attr("data-original-title",b.cumulativeHelp);a(".local-ubonattend "+c).modal("show");a(".local-ubonattend "+c+" .modal-body").scrollTop(0)}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});a(".local-ubonattend .btn-detail").not(".disabled").click(function(){var b=a(this).data("cmid");if(b){var c=coursemostype+"=details&id="+f+"&userid="+g+"&cmid="+b;a.ajax({data:c,url:h,success:function success(b){if(b.code==mesg.success){var c="modal-track-detail";if(b.isVideoMeeting){c="modal-track-detail-video-meeting"}a("#"+c+" .modal-title").text(b.title);a("#"+c+" .moduleInfoTable").html(b.moduleInfoTable);a("#"+c+" .trackid").html(b.trackid);a("#"+c+" .table-trackdetail tbody").html(b.html);a("#"+c+" [data-toggle=\"tooltip\"]").tooltip();a("#"+c).modal("show");a("#"+c+" .modal-body").scrollTop(0)}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});a(".local-ubonattend .btn-recognition").each(function(){var e=a(this),i=a(this).data("cmid"),j=a(this).data("recognition");if(a.isNumeric(j)){var k=a(this).text(),l="confirm_recognition_y",m=!1,n=k;if("0"==j){l="confirm_recognition_n";m=!0;n=e.data("statusname")}b.create({type:b.types.SAVE_CANCEL,title:k,body:M.util.get_string(l,d.pluginname,n)},e).done(function(b){var d=a(b.footer).find("[data-action=\"save\"]");d.text(k);if(m){d.addClass("btn-danger")}b.getRoot().on(c.save,function(b){b.preventDefault();var c=coursemostype+"=recognition&id="+f+"&userid="+g+"&cmid="+i+"&recognition="+j;a.ajax({data:c,url:h,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})}});a(".local-ubonattend .btn-section-recognition").each(function(){var e=a(this),i=a(this).data("sectionid"),j=a(this).data("recognition");if(a.isNumeric(j)){var k=a(this).text(),l="confirm_recognition_y_color",m=!1,n=a(this).data("color");if("0"==j){l=M.util.get_string("confirm_recognition_n",d.pluginname,e.data("statusname"));m=!0}else{l=M.util.get_string("confirm_recognition_y_color",d.pluginname,{color:n,text:k})}b.create({type:b.types.SAVE_CANCEL,title:k,body:l},e).done(function(b){var d=a(b.footer).find("[data-action=\"save\"]");d.text(k);if(m){d.addClass("btn-danger")}else{d.addClass("btn-"+n)}b.getRoot().on(c.save,function(b){b.preventDefault();var c=coursemostype+"=sectionRecognition&id="+f+"&userid="+g+"&sectionid="+i+"&recognition="+j;a.ajax({data:c,url:h,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})}})};d.grade=function(){a(".local-ubonattend .form-grade").validate()};d.setting=function(e,f,g){a(".local-ubonattend .form-setting").validate({submitHandler:function submitHandler(f){var g=!0,h="";a(".local-ubonattend .form-setting .table-sections tr.section").each(function(){var b=a(this).data("section"),c=a(this).find("input[name=\"start_time_"+b+"\"]"),d=a(this).find("input[name=\"end_time_"+b+"\"]"),f=a(this).find("input[name=\"attendance_percent_"+b+"\"]"),i=c.val(),j=d.val(),k=parseInt(f.val());if(e){var l=a(this).find("input[name=\"lateness_time_"+b+"\"]"),m=a(this).find("input[name=\"lateness_percent_"+b+"\"]"),n=l.val(),o=parseInt(m.val())}if(""!=h&&i<h){alert(M.util.get_string("error_oldate","local_ubonattend",h));c.focus();g=!1;return!1}if(j<i){alert(M.util.get_string("error_oldate2","local_ubonattend",i));d.focus();g=!1;return!1}if(e){if(k<o){alert(M.util.get_string("error_percent","local_ubonattend"));f.focus();g=!1;return!1}if(n<j){alert(M.util.get_string("error_oldate3","local_ubonattend",j));l.focus();g=!1;return!1}}if(0>o){alert(M.util.get_string("error_percent2","local_ubonattend"));m.focus();g=!1;return!1}h=i});if(g){var i=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("tab_setting",d.pluginname),body:M.util.get_string("confirm_section_change",d.pluginname)},i).done(function(b){b.getRoot().on(c.save,function(b){b.preventDefault();a(".local-ubonattend .form-setting .btn-save").attr("disabled","disalbed");showSubmitProgress();f.submit()})});i.trigger("click")}return!1}});a(".local-ubonattend .btn-force").each(function(){var e=a(this),h=e.closest("tr").data("section"),i=e.closest("tr").data("sectionid"),j=e.data("force"),k,l="",m=!1;switch(j){case f.absence:k=M.util.get_string("absence","local_uboffattend");l="force_absence";break;case f.attendance:k=M.util.get_string("attendance","local_uboffattend");l="force_attendance";break;default:k=M.util.get_string("force_batch_cancel",d.pluginname);l="force_cancel";m=!0;break;}b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("attendance_week_batch",d.pluginname),body:M.util.get_string("confirm_force",d.pluginname,{section:h,status:k})},e).done(function(b){var e=a(b.footer).find("[data-action=\"save\"]");e.text(M.util.get_string(l,d.pluginname));if(m){e.removeClass("btn-primary").addClass("btn-danger")}b.getRoot().on(c.save,function(b){b.preventDefault();var c=a(".form-setting input[name='id']").val(),d=coursemostype+"=sectionForce&id="+c+"&sectionid="+i+"&force="+j;a.ajax({url:g,data:d,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg)}}})})})})};d.sync=function(b){a(document).on("click","#period_sync_btn",function(){var c=a("tr.text-color-blue").length,d=a("tr.text-color-green").length;if(1>c&&1>d){alert("\uB3D9\uAE30\uD654 \uAC00\uB2A5\uD55C \uAC15\uC758 \uC790\uB8CC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4!");return}if(confirm("\uC8FC\uCC28 \uB3D9\uAE30\uD654\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){a(this).hide();window.location.href="/local/ubonattend/sync.php?id="+b}})};return d});
define ("local_ubonline/base",["jquery","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a){return{init:function(){a(".asite-online .form-search .form-control-autosubmit").change(function(){a(this).closest(".form-search").submit()})}}});
define ("local_ubonline/certform",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery-sortable","theme_coursemos/jquery.filedownload"],function(a,b,c){return{index:function(d){a(".asite-online-certform .btn-delete").each(function(){var e=a(this),f=e.closest("tr"),g=f.data("name"),h=f.data("id");b.create({type:b.types.SAVE_CANCEL,title:g,body:M.util.get_string("confirm_delete_certform","local_ubonline",g)},e).done(function(b){var e=a(b.footer),f=e.find("[data-action=\"save\"]");f.addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=delete&id="+h,url:d,success:function success(a){if(a.code==mesg.success){location.href=a.href}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});a(".asite-online-certform .table-coursemos-sortable").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",handle:".cursor-move",placeholder:"<tr class=\"placeholder\"/>",onDrop:function onDrop(b,c,e){e(b,c);var f=a(".asite-online-certform .table-coursemos-sortable").sortable("serialize").get(),g=JSON.stringify(f,null," ");a.ajax({data:coursemostype+"=sortorder&json="+g,url:d,success:function success(a){if(a.code!=mesg.success){alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});a(".asite-online-certform .btn-preview").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("certificate_ing","local_ubonline"))},successCallback:function successCallback(){hideSubmitProgress()},failCallback:function failCallback(){hideSubmitProgress()}});return!1})}}});
define ("local_ubonline/classify",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a,b,c){return{index:function(d){a(".asite-online .btn-delete").each(function(){var f=a(this),g=f.data("name");b.create({type:b.types.SAVE_CANCEL,title:g,body:M.util.get_string("confirm_delete_classify","local_ubonline",g)},f).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=classifyDelete&id="+f.data("id"),url:d,success:function success(a){if(a.code==mesg.success){location.href=a.href}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})})}}});
define ("local_ubonline/curriculum",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a,b,c){return{index:function(d){a(".asite-online .btn-delete").each(function(){var f=a(this),g=f.data("name");b.create({type:b.types.SAVE_CANCEL,title:g,body:M.util.get_string("confirm_delete_curriculum","local_ubonline",g)},f).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=curriculumDelete&id="+f.data("id"),url:d,success:function success(a){if(a.code==mesg.success){location.href=a.href}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})})},subadmin:function(d,f){a(".asite-online .btn-subadmin-delete").each(function(){var d=a(this),e=d.data("name");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_subadmin_delete","local_ubonline",e)},d).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=subAdminDelete&id="+d.data("id"),url:f,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});a(".asite-online .btn-subadmin-add").each(function(){var e=a(this),g=e.closest("tr").data("fullname"),h=e.closest("tr").data("username"),i=e.closest("tr").data("userid");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("add","core"),body:M.util.get_string("confirm_subadmin_add","local_ubonline",{fullname:g,username:h})},e).done(function(b){b.setSaveButtonText(M.util.get_string("add","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=subAdminAdd&curriculumid="+d+"&userid="+i,url:f,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});a(".asite-online .form-search").validate()}}});
define ("local_ubonline/enrol",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery.filedownload","theme_coursemos/bootstrap-select"],function(b,c,d){var e={base:function(a,c){b(".asite-online .form-control-curriculum").change(function(){b(".asite-online .form-search select[name='courseid']").val("");b.ajax({data:coursemostype+"=curriculumCourses&curriculumid="+b(this).val(),url:c,success:function success(a){if(a.code==mesg.success){var d=b(".asite-online .form-search select[name='courseid']");d.find("option:not(:first)").remove();b.each(a.courses,function(a,b){d.append("<option value='"+b.id+"'>"+b.fullname+"</option>")});d.selectpicker("refresh")}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}});return!1});b(".asite-online .form-users .form-control-user-all").click(function(){var a=b(this).is(":checked");b(".asite-online .form-users input[name='userids[]']").prop("checked",a)});b(".asite-online .btn-excel").click(function(){b.fileDownload(b(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();b("#ajax_loading_message .save_msg").text(M.util.get_string("excel_message","local_ubion"))},successCallback:function successCallback(){hideSubmitProgress()}});return!1})}};e.index=function(a,f){b(".asite-online .btn-detail").click(function(){var c=b(this).closest("tr").data("id");b.ajax({data:coursemostype+"=userInfo&courseid="+a+"&userid="+c,url:f,success:function success(a){if(a.code==mesg.success){b("#modal-userinfo .photo").html(a.userInfo.photo);b("#modal-userinfo .dl-userprofile .department").html(a.userInfo.department);b("#modal-userinfo .dl-userprofile .fullname").text(a.userInfo.fullname);b("#modal-userinfo .dl-userprofile .username").text(a.userInfo.username);b("#modal-userinfo .dl-userprofile .email").text(a.userInfo.email);b("#modal-userinfo .dl-userprofile .phone2").text(a.userInfo.phone2);b("#modal-userinfo input[name='userid']").val(a.userInfo.id);b("#modal-userinfo select[name='enrol']").val(a.userInfo.enrol);b("#modal-userinfo input[name='cost']").val(a.userInfo.cost);b("#modal-userinfo select[name='pay_method']").val(a.userInfo.pay_method);b("#modal-userinfo select[name='accept']").val(a.userInfo.accept);b("#modal-userinfo select[name='refund']").val(a.userInfo.refund);b("#modal-userinfo input[name='refund_msg']").val(a.userInfo.refund_msg);b("#modal-userinfo").modal("show")}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})});b("#modal-userinfo .form-validate").validate({submitHandler:function submitHandler(a){b.ajax({data:b(a).serialize(),url:a.action,success:function success(a){if(a.code==mesg.success){alert(a.msg);location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}});return!1}});b(".asite-online .form-users .btn-selected-user").click(function(){if(e.checkedUsers()){var a=b(this).attr("data-select");b("#modal-select-batch input[name='change_type']").val(a);b("#modal-select-batch").on("show.bs.modal",function(){b("#modal-select-batch .form-group").not(".form-group-save").each(function(){if(b(this).hasClass(a)){b(this).show();b(this).find("select").removeAttr("disabled")}else{b(this).hide();b(this).find("select").attr("disabled","disabled")}})}).modal("show")}});b("#modal-select-batch .form-validate").validate({submitHandler:function submitHandler(a){var g=b(".asite-online .form-users").serialize(),h=b(a).serialize(),i=e.checkedUsers();if(i){var j=b("<button type=\"button\"></button>");c.create({type:c.types.SAVE_CANCEL,title:M.util.get_string("selected_user","local_ubonline"),body:M.util.get_string("confirm_selected_change","local_ubonline",i)},j).done(function(a){a.getRoot().on(d.save,function(a){a.preventDefault();b.ajax({url:f,data:g+"&"+h,type:"post",success:function success(a){if(a.code==mesg.success){alert(a.msg);location.reload()}else{alert(a.msg)}return!1}})})});j.trigger("click");return!1}return!1}});b(".asite-online .btn-batch").click(function(){b("#modal-batch").modal("show")});b(".asite-online .btn-delete").each(function(){var e=b(this),g=e.closest("tr"),h=g.data("fullname"),i=g.data("id");c.create({type:c.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_user_delete","local_ubonline",h)},e).done(function(c){b(c.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));c.getRoot().on(d.save,function(c){c.preventDefault();b.ajax({data:coursemostype+"=delete&courseid="+a+"&userid="+i,url:f,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});b(".asite-online .btn-selected-delete").click(function(){var g=e.checkedUsers();if(g){var h=b("<button type='button'></button>");c.create({type:c.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_selectuser_delete","local_ubonline",g)},h).done(function(c){b(c.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));c.getRoot().on(d.save,function(c){c.preventDefault();var d=b(".asite-online .form-users").serialize();b.ajax({data:coursemostype+"=selectDelete&courseid="+a+"&"+d,url:f,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})});h.trigger("click")}})};e.cert=function(a,f){b(".asite-online .btn-tooltip").tooltip();b(".asite-online .btn-detail").click(function(){var c=b(this).closest("tr").data("id");b.ajax({data:coursemostype+"=userInfo&courseid="+a+"&userid="+c,url:f,success:function success(a){if(a.code==mesg.success){b("#modal-userinfo .photo").html(a.userInfo.photo);b("#modal-userinfo .dl-userprofile .department").html(a.userInfo.department);b("#modal-userinfo .dl-userprofile .fullname").text(a.userInfo.fullname);b("#modal-userinfo .dl-userprofile .username").text(a.userInfo.username);b("#modal-userinfo .dl-userprofile .email").text(a.userInfo.email);b("#modal-userinfo .dl-userprofile .phone2").text(a.userInfo.phone2);b("#modal-userinfo input[name='userid']").val(a.userInfo.id);b("#modal-userinfo select[name='cert']").val(a.userInfo.cert);b("#modal-userinfo").modal("show")}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})});b("#modal-userinfo .form-validate").validate({submitHandler:function submitHandler(a){b.ajax({data:b(a).serialize(),url:a.action,success:function success(a){if(a.code==mesg.success){alert(a.msg);location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}});return!1}});b(".asite-online .btn-selected-user").click(function(){var g=e.checkedUsers();if(g){var h=b(".asite-online .form-users tfoot select[name=\"cert\"] option:selected");if(""==h.val()){alert(M.util.get_string("cert_not_select","local_ubonline"));b(".asite-online .form-users tfoot select[name=\"cert\"]").focus();return!1}var i={count:g,cert:h.text()},j=b("<button type='button'></button>");c.create({type:c.types.SAVE_CANCEL,title:M.util.get_string("cert_yn","local_ubonline"),body:M.util.get_string("confirm_selected_change_cert","local_ubonline",i)},j).done(function(c){c.setSaveButtonText(M.util.get_string("save","local_ubion"));c.getRoot().on(d.save,function(c){c.preventDefault();var d=b(".asite-online .form-users").serialize();b.ajax({data:coursemostype+"=selectCertUpdate&courseid="+a+"&"+d,url:f,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})});j.trigger("click")}return!1});c.create({type:c.types.SAVE_CANCEL,title:M.util.get_string("autocert","local_ubonline"),body:M.util.get_string("confirm_autocert","local_ubonline")},b(".asite-online .btn-autocert")).done(function(c){c.setSaveButtonText(M.util.get_string("autocert","local_ubonline"));c.getRoot().on(d.save,function(c){c.preventDefault();b.ajax({data:coursemostype+"=autoCert&courseid="+a,url:f,success:function success(a){if(a.code==mesg.success){alert(a.msg);location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})});b(".asite-online .btn-cert").click(function(){b.fileDownload(b(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();b("#ajax_loading_message .save_msg").text(M.util.get_string("certificate_ing","local_ubonline"))},successCallback:function successCallback(){hideSubmitProgress()},failCallback:function failCallback(){hideSubmitProgress()}});return!1})};e.checkedUsers=function(){var a=b(".asite-online .form-users input[name='userids[]']:checkbox:checked").length;if(0<a){return a}else{alert(M.util.get_string("no_selected_user","local_ubonline"));return!1}};return e});
define ("local_ubonline/index",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate","theme_coursemos/jquery.ellipsis","theme_coursemos/jquery.filedownload"],function(a,b,c){var d={pluginname:"local_ubonline",index:function(){a(".local-ubonline .course-lists .row-item .row-item-info .coursename a").ellipsis({lines:"auto",ellipClass:"ellip",responsive:!0})}};d.view=function(f,g){a(".local-ubonline-view .btn-enrol-wait").popover({placement:"top",trigger:"hover",html:!0});var h=a(".local-ubonline-view .btn-enrol"),i=h.closest(".course-intro").find(".name").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("enroll",d.pluginname),body:M.util.get_string("confirm_enrol",d.pluginname,i)},h).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-primary").text(M.util.get_string("enroll",d.pluginname));b.getRoot().on(c.save,function(c){c.preventDefault();a.ajax({data:coursemostype+"=enrol&id="+f,url:g,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg);b.hide()}},error:function error(a,b,c){alert(a.status+" : "+c)}})})});h=a(".local-ubonline-view .btn-enrol-cancel");i=h.closest(".course-intro").find(".name").text();b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("enrol_cancel",d.pluginname),body:M.util.get_string("confirm_enrol_cancel",d.pluginname,i)},h).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("enrol_cancel",d.pluginname));b.getRoot().on(c.save,function(b){b.preventDefault();a.ajax({data:coursemostype+"=enrolCancel&id="+f,url:g,success:function success(a){if(a.code==mesg.success){location.reload()}else{alert(a.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})};d.history=function(){a(".local-ubonline-history .btn-cert").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("certificate_ing",d.pluginname))},successCallback:function successCallback(){hideSubmitProgress()},failCallback:function failCallback(){hideSubmitProgress()}});return!1})};d.my=function(){a(".local-ubonline-my .btn-certificate").click(function(){a.fileDownload(a(this).prop("href"),{prepareCallback:function prepareCallback(){showSubmitProgress();a("#ajax_loading_message .save_msg").text(M.util.get_string("certificate_ing",d.pluginname))},successCallback:function successCallback(){hideSubmitProgress()},failCallback:function failCallback(){hideSubmitProgress()}});return!1})};return d});
define ("local_ubonline/xth",["jquery","core/modal_factory","core/modal_events","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a,b,c){var d={};d.index=function(f){a(".asite-online .btn-copy").each(function(){var d=a(this),e=d.closest("tr").data("name"),g=d.closest("tr").data("id");b.create({type:b.types.SAVE_CANCEL,title:e,body:M.util.get_string("confirm_copy_xth","local_ubonline",e)},d).done(function(b){b.setSaveButtonText(M.util.get_string("copy","core"));b.getRoot().on(c.save,function(b){b.preventDefault();a(".asite-online .form-xth-copy input[name='id']").val(g);a(".asite-online .form-xth-copy").attr("action",f).trigger("submit")})})});a(".asite-online .form-xth-copy").validate({submitHandler:function submitHandler(a){showSubmitProgress();a.submit()}});a(".asite-online .btn-delete").each(function(){var e=a(this),g=e.closest("tr").data("name"),h=e.closest("tr").data("id");b.create({type:b.types.SAVE_CANCEL,title:g,body:M.util.get_string("confirm_delete_xth","local_ubonline",g)},e).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();showSubmitProgress();a.ajax({data:coursemostype+"=xthDelete&id="+h,url:f,success:function success(a){if(a.code==mesg.success){location.href=a.href}else{d.alert(a.msg);hideSubmitProgress()}},error:function error(a,b,c){alert(a.status+" : "+c)}})})})})};d.edit=function(b){a(".asite-online .mform").submit(function(){a(this).find("input[name='certificate_type']").removeAttr("disabled");a("#id_startnum").removeAttr("disabled");a("#id_padnum").removeAttr("disabled");a("#id_certno").removeAttr("disabled");a("#id_datetype").removeAttr("disabled");return!0});a(".asite-online select[name='curriculumid']").change(function(){var c=a(this).val();if(0<c){a.ajax({data:coursemostype+"=curriculuminfo&id="+c,url:b,success:function success(b){if(b.code==mesg.success){a(".asite-online input[name='kor_name']").val(b.info.kor_name);a(".asite-online input[name='eng_name']").val(b.info.eng_name);a(".asite-online select[name='xth_semester']").val(b.info.max_semester);a(".asite-online input[name='certificate_type'][value='"+b.info.default_certificate+"']").prop("checked",!0)}else{d.alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}});c(a(".asite-online input[type='checkbox'][data-usertype='0']").is(":checked"));a(".asite-online input[type='checkbox'][name^='usertypes']").click(function(){var b=!0;if("0"==a(this).data("usertype")){b=a(this).is(":checked");a(".asite-online input[type='checkbox'][name^='usertypes']").prop("checked",b)}else{a(".asite-online input[type='checkbox'][name^='usertypes']").each(function(c,d){if(0!=a(d).data("usertype")&&b&&!a(d).prop("checked")){b=!1}});a(".asite-online input[type='checkbox'][data-usertype='0']").prop("checked",b)}c(b)});function c(b){if(b){a(".asite-online input[type='checkbox'][name^='usertypes']").each(function(b,c){if(0!=a(c).data("usertype")){a(c).prop("disabled","disabled")}})}else{a(".asite-online input[type='checkbox'][name^='usertypes']").each(function(b,c){a(c).prop("disabled",!1)})}}};d.alert=function(a){if(0<=a.indexOf("\\n")){a=a.replace(/\\n/g,"\n")}alert(a)};return d});
define ("local_ubsend/email",["jquery","local_ubsend/form","theme_coursemos/jquery.validate"],function(a){return{send:function(b){a(".local_ubsend .form-send").validate({ignore:null,submitHandler:function submitHandler(b){if(0<a(".form-send input[name='tousers[]']:checked").length){a(".form-send button[type='submit']").attr("disabled","disabled");showSubmitProgress();b.submit()}else{alert(M.util.get_string("min_user","local_ubion"))}return!1}});a("#edit-"+b).rules("add","required");a("#edit-"+b).attr("placeholder",M.util.get_string("email_content","local_ubsend"))}}});
define ("local_ubsend/form",["jquery","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a){a(".local_ubsend .form-send .btn-group-checked .btn-group-tooltip").tooltip({container:"body",trigger:"hover"});a(".local_ubsend .form-send .btn-group-checked .btn-group-checked").click(function(){a(this).closest("fieldset").find("input[name='tousers[]']").not(":disabled").each(function(){this.checked=!0})});a(".local_ubsend .form-send .btn-group-checked .btn-group-unchecked").click(function(){a(this).closest("fieldset").find("input[name='tousers[]']").not(":disabled").each(function(){this.checked=!1})});a(".local_ubsend .form-send .btn-collapsed-expanded").click(function(){a(".local_ubsend .form-send").toggleClass("nomaxheight")});a(".form-search .select-autosubmit").change(function(){a(".form-search").submit()});a(".local_ubsend .form-search .btn-allchecked").click(function(){a(".form-send input[name='tousers[]']").not(":disabled").each(function(){this.checked=!0})});a(".local_ubsend .form-search .btn-unchecked").click(function(){a(".form-send input[name='tousers[]']").not(":disabled").each(function(){this.checked=!1})})});
define ("local_ubsend/message",["jquery","core/modal_factory","core/modal_events","core/templates","local_ubsend/form","theme_coursemos/jquery.validate"],function(a,b,c,d){var e={page:1,isPageLoad:!1,isLastPage:!1};e.index=function(d){a(".local-ubsend-message .form-search .form-control-auto").change(function(){a(".local-ubsend-message .form-search").submit()});a(".local-ubsend-message .tools .btn-delete").each(function(){var f=a(this),g=a(this).data("username");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_all_delete","local_ubsend",g)},f).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();var c=coursemostype+"=deleteAll&id="+f.data("id")+"&mtype="+f.data("mtype");a.ajax({url:d,data:c,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg)}return!0},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});a(".local-ubsend-message .btn-mycontacts").click(function(){var b=0;if(0<a(".local-ubsend-message .form-search select[name='courseid']").length){b=a(".local-ubsend-message .form-search select[name='courseid']").val()}e.mycontact(d,b,1,"")})};e.mycontact=function(b,c,d,f){var g=coursemostype+"=myContacts&courseid="+c+"&page="+d+"&keyword="+f;a.ajax({url:b,data:g,success:function success(d){if(d.code==mesg.success){a(".local-ubsend-message .modal-mycontacts .modal-body").html(d.html);a(".local-ubsend-message .modal-mycontacts").modal("show");a(".local-ubsend-message .modal-mycontacts .contacts form").submit(function(){var d=a(".local-ubsend-message .modal-mycontacts .contacts input[name='keyword']").val();e.mycontact(b,c,1,d);return!1});a(".local-ubsend-message .modal-mycontacts .page-link").click(function(){e.mycontact(b,c,a(this).data("pagenum"),f);return!1})}else{alert(d.msg)}return!0},error:function error(a,b,c){alert(a.status+" : "+c)}})};e.send=function(){a(".local_ubsend .form-send").validate({ignore:null,submitHandler:function submitHandler(b){if(0<a(".form-send input[name='tousers[]']:checked").length){a(".form-send button[type='submit']").attr("disabled","disabled");showSubmitProgress();b.submit()}else{alert(M.util.get_string("min_user","local_ubion"));return!1}return!1}})};e.message=function(d,f,g){a(".local-ubsend-message .form-validate").validate();a(".local-ubsend-message .form-control-message").focus();e.isLastPage=g;e.viewRefresh();var h=a(".local-ubsend-message .message-history").offset().top;a(window).scroll(function(){if(a(window).scrollTop()<h&&!e.isPageLoad&&!e.isLastPage){e.scrollDisabled();e.isPageLoad=!0;e.page++;var b=coursemostype+"=messages&userid="+d+"&page="+e.page;a.ajax({url:f,data:b,success:function success(b){if(b.code==mesg.success){var c=a(".local-ubsend-message .message-history .messages .message-fromto").first();a(".local-ubsend-message .message-history .messages").prepend(b.html);e.viewRefresh();a(document).scrollTop(c.offset().top);e.isPageLoad=!1;e.isLastPage=b.isLastPage;e.scrollDisabledUnset()}else{alert(b.msg)}},error:function error(a,b,c){alert(a.status+" : "+c)}})}return!1});a(".local-ubsend-message .btn-contact").click(function(){var b=coursemostype+"=contact&userid="+d+"&type="+a(this).attr("data-type"),c=a(this).attr("data-type"),e=a(this);a.ajax({url:f,data:b,success:function success(a){if(a.code==mesg.success){if("add"==c){e.attr("data-type","delete").removeClass("btn-default").addClass("btn-danger");e.text(M.util.get_string("removecontact","message"))}else{e.attr("data-type","add").addClass("btn-default").removeClass("btn-danger");e.text(M.util.get_string("addcontact","message"))}}else{alert(a.msg)}return!0},error:function error(a,b,c){alert(a.status+" : "+c)}})});a(document).on("click",".local-ubsend-message .btn-day-delete",function(){var g=a(this),h=g.closest(".day").find(".dayname").text(),i=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string("confirm_day_delete","local_ubsend",h)},i).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();var c=coursemostype+"=dayDelete&userid="+d+"&day="+g.data("day");a.ajax({url:f,data:c,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg)}return!0},error:function error(a,b,c){alert(a.status+" : "+c)}})})});i.trigger("click");return!1});a(document).on("click",".local-ubsend-message .btn-send-cancel",function(){var g=a(this),h=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("btn_message_cancel","local_ubsend"),body:M.util.get_string("confirm_message_cancel","local_ubsend")},h).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("btn_message_cancel","local_ubsend"));b.getRoot().on(c.save,function(b){b.preventDefault();var c=coursemostype+"=sendCancel&id="+g.data("id")+"&touserid="+d;a.ajax({url:f,data:c,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg)}return!0},error:function error(a,b,c){alert(a.status+" : "+c)}})})});h.trigger("click")});a(document).on("click",".local-ubsend-message .btn-delete",function(){var d=a(this),e=d.closest(".message-fromto"),g="confirm_message_delete";if(e.hasClass("from")){if(0<e.find(".notread").length){g="confirm_message_delete_tonoread"}}var h=a("<button type=\"button\"></button>");b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("delete","core"),body:M.util.get_string(g,"local_ubsend")},h).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("delete","core"));b.getRoot().on(c.save,function(b){b.preventDefault();var c=coursemostype+"=delete&messageuserid="+d.data("messageuserid");a.ajax({url:f,data:c,success:function success(a){if(a.code==mesg.success){location.replace(location.href)}else{alert(a.msg)}return!0},error:function error(a,b,c){alert(a.status+" : "+c)}})})});h.trigger("click")})};e.scrollDisabled=function(){a(document).on("mousewheel.disableScroll DOMMouseScroll.disableScroll touchmove.disableScroll",function(a){a.preventDefault()});a(document).on("keydown.disableScroll",function(a){for(var b=[32,33,34,35,36,37,38,39,40],c=0;c<b.length;c++){if(a.keyCode===b[c]){a.preventDefault();return}}})};e.scrollDisabledUnset=function(){a(document).off(".disableScroll")};e.viewRefresh=function(){a(".local-ubsend-message .message-history .heading").remove();var b="";a(".local-ubsend-message .message-history .message-fromto").each(function(){var c=a(this),e=a(this).data("timecreated"),f=new Date(1e3*e),g=f.getFullYear()+""+f.getMonth()+""+f.getDate();if(b!=g){d.render("local_ubsend/message/_dayheading",{timecreated:e}).then(function(a){c.before(a);return!0}).fail(function(a){console.log(a)});b=g}})};e.gmessage=function(d,f){a(".local-ubsend-message .btn-send-cancel").each(function(){var g=a(this);b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("btn_message_cancel","local_ubsend"),body:M.util.get_string("confirm_message_cancel","local_ubsend")},g).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("btn_message_cancel","local_ubsend"));b.getRoot().on(c.save,function(c){c.preventDefault();var e=coursemostype+"=sendCancel&id="+d+"&touserid="+g.data("touserid");a.ajax({url:f,data:e,success:function success(a){if(a.code==mesg.success){g.closest(".col-user").remove()}else{alert(a.msg)}b.hide();return!0},error:function error(a,b,c){alert(a.status+" : "+c)}})})})});b.create({type:b.types.SAVE_CANCEL,title:M.util.get_string("btn_message_cancel","local_ubsend"),body:M.util.get_string("confirm_message_all_cancel","local_ubsend")},a(".local-ubsend-message .btn-send-all-cancel")).done(function(b){a(b.footer).find("[data-action=\"save\"]").addClass("btn-danger").text(M.util.get_string("btn_message_cancel","local_ubsend"));b.getRoot().on(c.save,function(b){b.preventDefault();var c=coursemostype+"=sendAllCancel&id="+d;a.ajax({url:f,data:c,success:function success(a){if(a.code==mesg.success){location.href=a.href}else{alert(a.msg)}return!0},error:function error(a,b,c){alert(a.status+" : "+c)}})})})};return e});
define ("local_ubsend/sms",["jquery","local_ubsend/form","theme_coursemos/jquery.validate"],function(a){var b={hanglebytes:2};b.send=function(d,e,f,g){b.hanglebytes=parseInt(f);a(".local_ubsend .form-send").validate({submitHandler:function submitHandler(b){if(0<a(".form-send input[name='tousers[]']:checked").length){if(!g){var c=a(b.sms_from).val();if(!/^01([0|1|6|7|8|9]?)-?([0-9]{3,4})-?([0-9]{4})$/.test(c)&&!/^(0(2|3[1-3]|4[1-4]|5[1-5]|6[1-4]|70))-?(\d{3,4})-?(\d{4})$/.test(c)){alert(M.util.get_string("sms_invalid_phone_number","local_ubsend"));return!1}}a(".form-send button[type='submit']").attr("disabled","disabled");showSubmitProgress();b.submit()}else{alert(M.util.get_string("min_user","local_ubion"))}return!1}});a(".form-send .btn-reset").click(function(){a(".form-send .form-control-sms").val("")});if(e){var h=b.checkbytes(a(".form-send .form-control-sms").val());a(".form-send .bytes .now").text(h)}if(0<d){a(".form-send .form-control-sms").keyup(function(f){var e=a(f.target),g=e.val(),h=b.checkbytes(g);a(".form-send .bytes .now").text(h);if(h>d){for(var j=g+"",k=0,l=0,m;l<g.length;l++){m=escape(g.charAt(l));if(1==m.length){k++}else if(-1!=m.indexOf("%u")){k+=b.hanglebytes}else if(-1!=m.indexOf("%")){k+=m.length/3}if(k>d){j=j.substring(0,l);break}}e.val(j);e.trigger("keyup")}})}a(".form-send .btn-char").click(function(){var b=a(".form-send .form-control-sms");b=b[0];var c=a(this).text();if(document.selection){b.focus();var d=document.selection.createRange();d.text=c;b.focus()}else if(b.selectionStart||"0"==b.selectionStart){var e=b.selectionStart,f=b.selectionEnd,g=b.scrollTop,h=b.value.substring(0,e)+c+b.value.substring(f,b.value.length);b.value=h;b.focus();b.selectionStart=e+c.length;b.selectionEnd=e+c.length;b.scrollTop=g}else{b.value+=c;b.focus()}a(".form-send .form-control-sms").trigger("keyup")})};b.checkbytes=function(a){for(var d=0,e=0,f;e<a.length;e++){f=escape(a.charAt(e));if(1==f.length){d++}else if(-1!=f.indexOf("%u")){d+=b.hanglebytes}else if(-1!=f.indexOf("%")){d+=f.length/3}}return d};return b});
define ("local_ubsend/userCheckSend",["jquery","theme_coursemos/bootstrap","theme_coursemos/jquery.validate"],function(a){return{init:function(b){a("."+b+" .sendForm-user-allchecked").click(function(){var c=a(this).is(":checked");a("."+b+" input:checkbox.sendForm-users").each(function(){if(!a(this).is(":disabled")){this.checked=c}})});var c=a("."+b+" .sendForm-form");c.submit(function(){var d=a("."+b+" input:checkbox.sendForm-users:checked");if(0<d.length){var e=c.find("select[name=\"sendtype\"]").val();c.attr("action",e);d.each(function(){a(this).clone().attr("type","hidden").appendTo(c)});return!0}else{alert(M.util.get_string("min_user","local_ubion"));return!1}})}}});
define ("assignfeedback_copykillerbridge/bridge",["jquery"],function(a){return{init:function(b,c,d,e){var f=!0;if(""==b){alert(M.util.get_string("url_script_empty","plagiarism_copykillerbridge"));f=!1}if(""==c){alert(M.util.get_string("url_bridge_empty","plagiarism_copykillerbridge"));f=!1}if(!0==f){a.getScript(b,function(){CopykillerBridge.setUrl(M.cfg.wwwroot+c);if("ko"!=e){e="en"}CopykillerBridge.setLang(e);CopykillerBridge.initGetCopykillerInfo(".total-copy-ratio",d)})}}}});
define ("forumreport_summary/filters",["exports","jquery","core/popper","core/custom_interaction_events","forumreport_summary/selectors","core/yui","core/ajax","core/key_codes"],function(a,b,c,d,e,f,g,h){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=i(b);c=i(c);d=i(d);e=i(e);f=i(f);g=i(g);h=i(h);function i(a){return a&&a.__esModule?a:{default:a}}var j=function(a){var i=(0,b.default)(a);(0,b.default)(document).ready(function(){(0,b.default)(".loading-icon").hide();(0,b.default)("#summaryreport").removeClass("hidden")});var j=function(a,b){var c=document.forms.filtersform.action,d;if(a){a.preventDefault();var e=c.split("?"),f=e[1],g=b.split("&"),h="",i=[],j=[];f.split("&").forEach(function(a){var b=a.split("=");i.push(b[0]);j.push(b[1])});g.forEach(function(a){var b=a.split("="),c=i.indexOf(b[0]);if(-1<c){j[c]=b[1]}else{i.push(b[0]);j.push(b[1])}});i.forEach(function(a,b){h+="&".concat(a,"=").concat(j[b])});d=e[0]+"?"+h.substr(1)}else{d=c}document.forms.filtersform.action=d;document.forms.filtersform.submit()};(0,b.default)(".resettable").on("click","a",function(a){j(a,a.target.search.substr(1))});(0,b.default)("thead").on("click","a",function(a){j(a,a.target.search.substr(1))});(0,b.default)(".pagination").on("click","a",function(a){j(a,a.target.search.substr(1))});if(document.forms.selectperpage){document.forms.selectperpage.onsubmit=function(a){var b="perpage="+document.forms.selectperpage.elements.perpage.value;j(a,b)}}var k=document.getElementById("summaryreport").querySelector("form.dataformatselector");if(k){k.onsubmit=function(a){var b=k.querySelector("#downloadtype_download").value,c="download=".concat(b),d=document.forms.filtersform.action;j(a,c);document.forms.filtersform.action=d}}var l=function(a){f.default.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()});(0,b.default)(a).addClass("hidden");j(!1)},m=function(a){var b=document.querySelector(a),d=document.querySelector(e.default.filters.date.calendar);d.style.removeProperty("z-index");new c.default(b,d,{placement:"bottom"})},n=function(a,b){b.classList.add("hidden");b.setAttribute("data-openfilter","false");a.classList.add("btn-primary");a.classList.remove("btn-outline-primary");a.setAttribute("aria-expanded",!1)};i.on(d.default.events.activate,e.default.filters.group.selectall,function(){var b=a.querySelectorAll(e.default.filters.group.checkbox+":not(:checked)");b.forEach(function(a){a.checked=!0})});i.on(d.default.events.activate,e.default.filters.group.clear,function(){var b=a.querySelectorAll(e.default.filters.group.checkbox+":checked");b.forEach(function(a){a.checked=!1})});i.on(d.default.events.activate,e.default.filters.group.trigger,function(){var b=a.querySelector(e.default.filters.group.trigger),d=a.querySelector(e.default.filters.group.popover);new c.default(b,d,{placement:"bottom"});d.classList.remove("hidden");d.setAttribute("data-openfilter","true");b.classList.add("btn-outline-primary");b.classList.remove("btn-primary");b.setAttribute("aria-expanded",!0);var f=function(a){if(a.target.id!==b.id&&d!==a.target.closest("[data-openfilter=\"true\"]")&&("undefined"==typeof a.keyCode||a.keyCode===h.default.enter||a.keyCode===h.default.space)){n(b,d);document.removeEventListener("click",f);document.removeEventListener("keyup",f);document.removeEventListener("keyup",g)}};document.addEventListener("click",f);document.addEventListener("keyup",f);var g=function(a){if(a.keyCode===h.default.escape){n(b,d);document.removeEventListener("keyup",g);document.removeEventListener("click",f)}};document.addEventListener("keyup",g)});i.on(d.default.events.activate,e.default.filters.group.save,function(){var b=a.querySelectorAll(e.default.filters.group.checkbox);b.forEach(function(a){var b=document.forms.filtersform,c=a.getAttribute("data-saveid");b.querySelector("#".concat(c)).checked=a.checked});l("#filter-groups-popover")});document.querySelectorAll(e.default.filters.exportlink.link).forEach(function(a){a.addEventListener("click",function(a){document.forms.exportlinkform.action=a.target.dataset.url;document.forms.exportlinkform.submit()})});i.on(d.default.events.activate,e.default.filters.date.trigger,function(){var b=a.querySelector(e.default.filters.date.trigger),d=a.querySelector(e.default.filters.date.popover);new c.default(b,d,{placement:"bottom"});d.classList.remove("hidden");d.setAttribute("data-openfilter","true");d.querySelector("[name=\"filterdatefrompopover[enabled]\"]").focus();b.classList.add("btn-outline-primary");b.classList.remove("btn-primary");b.setAttribute("aria-expanded",!0);var f=function(a){if(a.target.id!==b.id&&d!==a.target.closest("[data-openfilter=\"true\"]")&&("undefined"==typeof a.keyCode||a.keyCode===h.default.enter||a.keyCode===h.default.space)){n(b,d);document.removeEventListener("click",f);document.removeEventListener("keyup",f);document.removeEventListener("keyup",g)}};document.addEventListener("click",f);document.addEventListener("keyup",f);var g=function(a){if(a.keyCode===h.default.escape){n(b,d);document.removeEventListener("keyup",g);document.removeEventListener("click",f)}};document.addEventListener("keyup",g)});i.on(d.default.events.activate,e.default.filters.date.save,function(){var b=document.forms.filtersform,c=a.querySelector(e.default.filters.date.popover),d=c.querySelector("[name=\"filterdatefrompopover[enabled]\"]").checked?1:0,f=c.querySelector("[name=\"filterdatetopopover[enabled]\"]").checked?1:0;if(!d&&!f){b.elements["datefrom[timestamp]"].value=0;b.elements["datefrom[enabled]"].value=d;b.elements["dateto[timestamp]"].value=0;b.elements["dateto[enabled]"].value=f;l("#filter-dates-popover")}else{var h={data:[]};if(d){h.data.push({key:"from",year:c.querySelector("[name=\"filterdatefrompopover[year]\"]").value,month:c.querySelector("[name=\"filterdatefrompopover[month]\"]").value,day:c.querySelector("[name=\"filterdatefrompopover[day]\"]").value,hour:0,minute:0})}if(f){h.data.push({key:"to",year:c.querySelector("[name=\"filterdatetopopover[year]\"]").value,month:c.querySelector("[name=\"filterdatetopopover[month]\"]").value,day:c.querySelector("[name=\"filterdatetopopover[day]\"]").value,hour:23,minute:59})}g.default.call([{methodname:"core_calendar_get_timestamps",args:h}])[0].done(function(a){var c=0,e=0;a.timestamps.forEach(function(a){if("from"===a.key){c=a.timestamp}else if("to"===a.key){e=a.timestamp}});if(0<e&&c>e){var g=document.getElementById("dates-filter-warning");g.classList.remove("hidden");g.classList.add("d-block")}else{b.elements["datefrom[timestamp]"].value=c;b.elements["datefrom[enabled]"].value=d;b.elements["dateto[timestamp]"].value=e;b.elements["dateto[enabled]"].value=f;l("#filter-dates-popover")}})}});i.on(d.default.events.activate,e.default.filters.date.calendariconfrom,function(){m(e.default.filters.date.calendariconfrom)});i.on(d.default.events.activate,e.default.filters.date.calendariconto,function(){m(e.default.filters.date.calendariconto)})};a.init=j});
define ("forumreport_summary/selectors",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;a.default={filters:{group:{checkbox:"[data-region=\"filter-groups\"] input[type=\"checkbox\"]",clear:"[data-region=\"filter-groups\"] .filter-clear",popover:"#filter-groups-popover",save:"[data-region=\"filter-groups\"] .filter-save",selectall:"[data-region=\"filter-groups\"] .select-all",trigger:"#filter-groups-button"},date:{calendar:"#dateselector-calendar-panel",calendariconfrom:"#id_filterdatefrompopover_calendar",calendariconto:"#id_filterdatetopopover_calendar",popover:"#filter-dates-popover",save:"[data-region=\"filter-dates\"] .filter-save",trigger:"#filter-dates-button"},exportlink:{link:"#summaryreport #forumreport_summary_table button.export-link"}}};return a.default});
define ("quizaccess_seb/managetemplates",["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){var e={removeTemplate:function removeTemplate(b){b.preventDefault();var e=a(b.currentTarget).attr("href");c.get_strings([{key:"confirmtemplateremovaltitle",component:"quizaccess_seb"},{key:"confirmtemplateremovalquestion",component:"quizaccess_seb"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).then(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){window.location=e})}).catch()},setup:function setup(){a("body").delegate("[data-action=\"delete\"]","click",e.removeTemplate)}};return{setup:e.setup}});
